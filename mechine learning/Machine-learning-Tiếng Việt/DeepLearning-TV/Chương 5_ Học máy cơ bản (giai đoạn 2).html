<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Chương 5: Học máy cơ bản (giai đoạn 2) - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-5-Học-máy-cơ-bản-giai-đoạn-2"><a class="anchor hidden-xs" href="#Chương-5-Học-máy-cơ-bản-giai-đoạn-2" title="Chương-5-Học-máy-cơ-bản-giai-đoạn-2"><span class="octicon octicon-link"></span></a>Chương 5: Học máy cơ bản (giai đoạn 2)</h1><h2 id="543-Phương-sai-và-sai-số-chuẩn"><a class="anchor hidden-xs" href="#543-Phương-sai-và-sai-số-chuẩn" title="543-Phương-sai-và-sai-số-chuẩn"><span class="octicon octicon-link"></span></a>5.4.3 Phương sai và sai số chuẩn</h2><p>Một thuộc tính khác của hàm ước lượng mà ta có thể muốn xét tới là mức độ biến thiên của nó khi nó là một hàm của mẫu dữ liệu. Giống như khi tính toán kỳ vọng của một ước lượng để xác định độ chệch của nó, ta có thể tính toán phương sai của ước lượng đó. Phương sai của một ước lượng chỉ đơn giản là phương sai</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtable" id="MJXp-Span-2"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-5"><span class="MJXp-mi" id="MJXp-Span-6">V</span><span class="MJXp-mi" id="MJXp-Span-7">a</span><span class="MJXp-mi" id="MJXp-Span-8">r</span></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-munderover" id="MJXp-Span-11"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\mathrm{Var} (\hat{\theta}) \tag{5.45} </script></span></p><p>trong đó biến ngẫu nhiên là tập huấn luyện. Ngoài ra, căn bậc hai của phương sai được gọi là <strong>sai số chuẩn</strong> (standard error), ký hiệu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi" id="MJXp-Span-17">S</span><span class="MJXp-mi" id="MJXp-Span-18">E</span></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-20"><span class="MJXp-munderover" id="MJXp-Span-21"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-2-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-2">\mathrm{SE} (\hat{\theta})</script></span>.</p><p>Phương sai, hoặc sai số chuẩn của một ước lượng cung cấp cho ta một thước đo mức độ biến thiên của một ước lượng mà ta tính toán từ dữ liệu khi tái lấy mẫu bộ dữ liệu đó một cách độc lập từ quá trình sinh dữ liệu cơ sở. Cũng giống như việc ta muốn có một ước lượng với độ chệch nhỏ, ta cũng muốn ước lượng này có phương sai nhỏ.</p><p>Khi tính toán bất kỳ thống kê nào với một số lượng mẫu hữu hạn, kết quả ước lượng tham số của ta là bất định, theo nghĩa là có thể ta sẽ thu được các mẫu khác hẳn từ cùng một phân phối và do đó các thống kê của chúng cũng sẽ khác. Mức độ biến thiên kì vọng trong bất kì hàm ước lượng nào chính là một nguồn gây sai số mà chúng ta muốn định lượng.</p><p>Sai số chuẩn của giá trị trung bình được tính như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-25"><span class="MJXp-mtable" id="MJXp-Span-26"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-27" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-28" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-29"><span class="MJXp-mi" id="MJXp-Span-30">S</span><span class="MJXp-mi" id="MJXp-Span-31">E</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mrow" id="MJXp-Span-34" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-35"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-38" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-41"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 326%; margin-top: 0.043em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-42"><span class="MJXp-mi" id="MJXp-Span-43">V</span><span class="MJXp-mi" id="MJXp-Span-44">a</span><span class="MJXp-mi" id="MJXp-Span-45">r</span></span><span class="MJXp-mrow" id="MJXp-Span-46"><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.617em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.467em; margin-left: -0.17em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-48"><span><span class="MJXp-mtr" id="MJXp-Span-49" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-50" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-51" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-52">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-54"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-60" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-56" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">i</span><span class="MJXp-mo" id="MJXp-Span-58">=</span><span class="MJXp-mn" id="MJXp-Span-59">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-64" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-65">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">i</span><span class="MJXp-mo" id="MJXp-Span-67">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.617em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.467em; margin-left: -0.17em;">]</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-70" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">σ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msqrt" id="MJXp-Span-72"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">m</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\mathrm{SE} (\hat \mu_m) = \sqrt{\mathrm{Var} \begin{bmatrix}\frac{1}{m} \sum \limits_{i = 1}^{m}x^{(i)}\end{bmatrix} } = \frac{\sigma}{\sqrt{m}}, \tag{5.46}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-78" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-4-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-4">\sigma^2</script></span> là phương sai thực sự của mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-82" style="vertical-align: 0.5em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-5-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-5">x^i</script></span>. Sai số chuẩn thường được ước lượng bằng cách sử dụng một ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">σ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-6-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-6">\sigma</script></span>. Không may mắn là cả căn bậc hai của phương sai mẫu, lẫn căn bậc hai của ước lượng không chệch của phương sai đều không thể tạo ra một ước lượng không chệch cho độ lệch chuẩn. Cả hai cách tiếp cận này đều có xu hướng tạo ra một ước lượng có giá trị thấp hơn độ lệch chuẩn thực sự nhưng chúng vẫn được sử dụng trong thực tiễn. Căn bậc hai ước lượng không chệch của phương sai sẽ gần với độ lệch chuẩn hơn. Đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-7-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-7">m</script></span> lớn, đại lượng xấp xỉ này trở nên khá phù hợp.</p><p>Sai số chuẩn của giá trị trung bình rất hữu ích trong các thí nghiệm học máy. Chúng ta thường ước lượng sai số tổng quát hóa bằng cách tính trung bình mẫu của sai số trên tập kiểm thử. Số lượng mẫu trong tập kiểm thử quyết định độ chính xác của ước lượng này. <em>Định lý giới hạn trung tâm</em> (central limit theorem) cho ta biết rằng giá trị trung bình sẽ được phân bố theo một phân phối xấp xỉ chuẩn. Áp dụng định lý này, chúng ta có thể sử dụng sai số chuẩn để tính xác suất mà kỳ vọng thực sự rơi vào bất kỳ khoảng được chọn nào. Chẳng hạn, khoảng tin cậy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mn" id="MJXp-Span-88">95</span><span class="MJXp-mi" id="MJXp-Span-89">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-8-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-8">95\%</script></span> xung quanh giá trị trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mrow" id="MJXp-Span-92" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-93"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">μ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-96" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">m</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-9-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-9">\hat \mu_{m}</script></span> là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-98"><span class="MJXp-mtable" id="MJXp-Span-99"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-100" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-101" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mrow" id="MJXp-Span-104" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-105"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-108" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-110">1</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-112">96</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-114"><span class="MJXp-mi" id="MJXp-Span-115">S</span><span class="MJXp-mi" id="MJXp-Span-116">E</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mrow" id="MJXp-Span-119" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-120"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-126">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-127"><span class="MJXp-mrow" id="MJXp-Span-128" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-129"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-132" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-134">1</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-136">96</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-138"><span class="MJXp-mi" id="MJXp-Span-139">S</span><span class="MJXp-mi" id="MJXp-Span-140">E</span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mrow" id="MJXp-Span-143" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-144"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">(\hat \mu_m− 1,96\times \mathrm{SE} (\hat \mu_m),\space \hat \mu_m+ 1,96\times \mathrm{SE} (\hat \mu_m)), \tag{5.47}</script></span></p><p>theo phân phối chuẩn với trung bình là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mrow" id="MJXp-Span-153" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-154"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">μ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">m</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-11-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-11">\hat \mu_{m}</script></span> và phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mrow" id="MJXp-Span-160"><span class="MJXp-mi" id="MJXp-Span-161">S</span><span class="MJXp-mi" id="MJXp-Span-162">E</span></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-164"><span class="MJXp-mrow" id="MJXp-Span-165" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-166"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">μ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-169" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-170"><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-172" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-12-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-12">\mathrm{SE} (\hat \mu_m)^2</script></span>. Trong các thí nghiệm học máy, người ta thường nói thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-13-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-13">A</script></span> tốt hơn thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-14-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-14">B</script></span> nếu cận trên của khoảng tin cậy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mn" id="MJXp-Span-178">95</span><span class="MJXp-mi" id="MJXp-Span-179">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-15">95\%</script></span> cho sai số của thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-16">A</script></span> nhỏ hơn cận dưới của khoảng tin cậy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mn" id="MJXp-Span-183">95</span><span class="MJXp-mi" id="MJXp-Span-184">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-17">95\%</script></span> cho sai số của thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-18">B</script></span>.</p><p><strong>Ví dụ về phân phối Bernoulli:</strong> Một lần nữa ta xem xét một tập hợp các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-187"><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-191" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-192">(</span><span class="MJXp-mn" id="MJXp-Span-193">1</span><span class="MJXp-mo" id="MJXp-Span-194">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-202" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-203">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">m</span><span class="MJXp-mo" id="MJXp-Span-205">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">\{x^{(1)},. . . , x^{(m)}\}</script></span> được lấy độc lập từ cùng một phân phối Bernoulli (nhớ lại rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">P</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-212" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-213">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">i</span><span class="MJXp-mo" id="MJXp-Span-215">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">θ</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-222" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-225" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-226">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">i</span><span class="MJXp-mo" id="MJXp-Span-228">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-230">1</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">θ</span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-235" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-236">(</span><span class="MJXp-mn" id="MJXp-Span-237">1</span><span class="MJXp-mo" id="MJXp-Span-238">–</span><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-241" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-242">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">i</span><span class="MJXp-mo" id="MJXp-Span-244">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-245">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">P (x^{(i)}; \theta) = \theta^{x^{(i)}} (1− \theta)^{(1 – x^{(i)})}</script></span>). Lần này ta quan tâm đến vấn đề tính toán phương sai của ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-msubsup" id="MJXp-Span-247"><span class="MJXp-mrow" id="MJXp-Span-248" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-249"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-252" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-254" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-255">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">i</span><span class="MJXp-mo" id="MJXp-Span-261">=</span><span class="MJXp-mn" id="MJXp-Span-262">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-267" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-268">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">i</span><span class="MJXp-mo" id="MJXp-Span-270">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-21">\hat \theta_m = \frac{1}{m}\sum_{i = 1}^{m} x^{(i)}</script></span> .</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-271"><span class="MJXp-mtable" id="MJXp-Span-272"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-273" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-274" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mi" id="MJXp-Span-276">V</span><span class="MJXp-mi" id="MJXp-Span-277">a</span><span class="MJXp-mi" id="MJXp-Span-278">r</span></span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mrow" id="MJXp-Span-281" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-282"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-287" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-288"></span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-290" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-291"><span class="MJXp-mi" id="MJXp-Span-292">V</span><span class="MJXp-mi" id="MJXp-Span-293">a</span><span class="MJXp-mi" id="MJXp-Span-294">r</span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-296" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-297">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-299"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-305" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-301" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">i</span><span class="MJXp-mo" id="MJXp-Span-303">=</span><span class="MJXp-mn" id="MJXp-Span-304">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-309" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-310">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">i</span><span class="MJXp-mo" id="MJXp-Span-312">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-314" style="padding-left: 0.278em; text-align: left;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-315" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-316" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-317" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-318"></span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-320" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-321" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-322">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-325" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-326"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-332" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-328" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">i</span><span class="MJXp-mo" id="MJXp-Span-330">=</span><span class="MJXp-mn" id="MJXp-Span-331">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-334"><span class="MJXp-mi" id="MJXp-Span-335">V</span><span class="MJXp-mi" id="MJXp-Span-336">a</span><span class="MJXp-mi" id="MJXp-Span-337">r</span></span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-341" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-342">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">i</span><span class="MJXp-mo" id="MJXp-Span-344">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-346" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-347" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-348" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-349" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-350"></span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-352" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-353" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-354">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-357" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-358"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-364" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-360" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">i</span><span class="MJXp-mo" id="MJXp-Span-362">=</span><span class="MJXp-mn" id="MJXp-Span-363">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">θ</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-368">1</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">θ</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-372" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-373" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-374" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-375" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-376"></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-378" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-379" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-380">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-383" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">θ</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-387">1</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">θ</span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-391" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-392" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-393" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-394" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-395"></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-397" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-398" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-399">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">m</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">θ</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-403">1</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">θ</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-407" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">\begin{eqnarray}\mathrm{Var}(\hat \theta_m)
&=&\mathrm{Var}(\frac{1}{m} \sum \limits_{i = 1}^{m}x^{(i)}) &\tag{5.48}\\
&=&\frac{1}{m^2}\sum \limits_{i=1}^{m} \mathrm{Var}(x^{(i)}) &\tag{5.49} \\
&=& \frac{1}{m^2}\sum \limits_{i=1}^{m}\theta(1-\theta) &\tag{5.50} \\
&=&\frac{1}{m^2}m\theta(1-\theta) &\tag{5.51} \\
&=&\frac{1}{m} \theta(1-\theta) &\tag{5.52} \\
\end{eqnarray}</script></span></p><p>Phương sai của ước lượng giảm xuống theo một hàm số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">m</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">m</script></span> là số lượng mẫu trong tập dữ liệu. Đây là một tính chất chung của các ước lượng phổ biến mà chúng ta sẽ quay lại khi thảo luận về tính nhất quán ở phần 5.4.5.</p><h2 id="544-Đánh-đổi-giữa-độ-chệch-và-phương-sai-để-cực-tiểu-hóa-trung-bình-của-bình-phương-sai-số"><a class="anchor hidden-xs" href="#544-Đánh-đổi-giữa-độ-chệch-và-phương-sai-để-cực-tiểu-hóa-trung-bình-của-bình-phương-sai-số" title="544-Đánh-đổi-giữa-độ-chệch-và-phương-sai-để-cực-tiểu-hóa-trung-bình-của-bình-phương-sai-số"><span class="octicon octicon-link"></span></a>5.4.4 Đánh đổi giữa độ chệch và phương sai để cực tiểu hóa trung bình của bình phương sai số.</h2><p>Độ chệch và phương sai đo lường hai nguồn sai số khác nhau trong một ước lượng. Độ chệch đo độ lệch kì vọng từ giá trị thực của hàm hoặc tham số. Mặt khác, phương sai cho phép đo độ lệch từ ước lượng kì vọng mà bất kỳ phép lấy mẫu cụ thể nào của dữ liệu có khả năng gây ra.</p><p>Điều gì sẽ xảy ra khi ta phải đưa ra một lựa chọn giữa hai ước lượng, một với độ chệch lớn hơn và một với phương sai lớn hơn? Chẳng hạn, giả sử ta muốn xấp xỉ hàm số được đưa ra trong hình 5.2 và ta chỉ được chọn lựa giữa một mô hình có độ chệch lớn và một mô hình có phương sai lớn. Ta sẽ chọn như thế nào?</p><p>Cách phổ biến nhất để đối mặt với sự đánh đổi này là sử dụng kiểm chứng chéo. Theo kinh nghiệm, kiểm chứng chéo là phương pháp rất thành công trên nhiều tác vụ thực tế. Ngoài ra, ta cũng có thể so sánh <strong>sai số bình phương trung bình</strong> của các các ước lượng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-412"><span class="MJXp-mtable" id="MJXp-Span-413"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-414" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-415" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mi" id="MJXp-Span-417">M</span><span class="MJXp-mi" id="MJXp-Span-418">S</span><span class="MJXp-mi" id="MJXp-Span-419">E</span></span></span><span class="MJXp-mtd" id="MJXp-Span-420" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-421"></span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-423" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-424"><span class="MJXp-mi" id="MJXp-Span-425">E</span></span><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mrow" id="MJXp-Span-429" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-430"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-433" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">θ</span><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-438" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-440" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-441" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-442" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-443"></span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-445" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-446"><span class="MJXp-mi" id="MJXp-Span-447">B</span><span class="MJXp-mi" id="MJXp-Span-448">i</span><span class="MJXp-mi" id="MJXp-Span-449">a</span><span class="MJXp-mi" id="MJXp-Span-450">s</span></span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-452"><span class="MJXp-mrow" id="MJXp-Span-453" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-454"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-457" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-458"><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-460" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mi" id="MJXp-Span-463">V</span><span class="MJXp-mi" id="MJXp-Span-464">a</span><span class="MJXp-mi" id="MJXp-Span-465">r</span></span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-467"><span class="MJXp-mrow" id="MJXp-Span-468" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-469"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-472" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">\begin{eqnarray}\mathrm{MSE} &=&\mathrm{E}[(\hat \theta_m− \theta)^2] \tag{5.53} \\
&=& \mathrm{Bias} (\hat \theta_m)^2+ \mathrm{Var} (\hat \theta_m) \tag{5.54} \end{eqnarray}</script></span></p><p>Sai số bình phương trung bình đo lường độ lệch kì vọng tổng thể - theo nghĩa bình phương của sai số - giữa ước lượng và giá trị thực của tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26">\theta</script></span>. Từ phương trình 5.54, rõ ràng việc đánh giá sai số bình phương trung bình kết hợp chặt chẽ cả độ chệch và phương sai. Các ước lượng ta mong muốn là các ước lượng có sai số bình phương trung bình nhỏ, và đó là những ước lượng có thể kiểm soát sự cân bằng giữa phương sai và độ chệch.</p><p>Sự liên hệ giữa độ chệch và phương sai có mối liên quan chặt chẽ tới các khái niệm dung lượng, quá khớp và vị khớp trong học máy. Khi sai số tổng quát hóa được đo bởi sai số bình phương trung bình (trong đó độ chệch và phương sai là các thành phần có ảnh hưởng tới sai số tổng quát hóa), việc tăng dung lượng có xu hướng làm tăng phương sai và giảm độ chệch. Điều này được minh họa trong hình 5.6, khi chúng ta lại thấy đường cong hình chữ U của sai số tổng quát hóa với vai trò là một hàm của dung lượng.</p><p><img src="https://i.imgur.com/iqq9FrT.png" alt=""></p><blockquote>
<p><em>Hình 5.6</em>: Khi dung lượng của mô hình tăng (trên trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-27">x</script></span>), độ chệch (đường chấm xanh dương) có xu hướng giảm và phương sai (đường gạch đứt màu lục) có xu hướng tăng, chúng phối hợp tạo nên đường cong chữ U biểu diễn sai số tổng quát hóa (đường đỏ đậm). Nếu ta tăng giảm dung lượng theo trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">x</script></span>, sẽ tồn tại giá trị dung lượng tối ưu, sao cho mô hình sẽ vị khớp nếu dung lượng thấp hơn giá trị này, và sẽ quá khớp nếu dung lượng cao hơn giá trị này. Mối quan hệ này tương tự như mối quan hệ giữa dung lượng, vị khớp, quá khớp, đã bàn đến trong phần 5.2 và hình 5.3.</p>
</blockquote><h2 id="545-Tính-nhất-quán"><a class="anchor hidden-xs" href="#545-Tính-nhất-quán" title="545-Tính-nhất-quán"><span class="octicon octicon-link"></span></a>5.4.5 Tính nhất quán</h2><p>Cho đến thời điểm này, chúng ta đã thảo luận về các thuộc tính của các ước lượng khác nhau cho một tập huấn luyện kích thước cố định. Thông thường, ta cũng quan tâm đến hành vi của một ước lượng khi số lượng dữ liệu huấn luyện tăng lên. Cụ thể, khi số lượng điểm dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">m</script></span> trong bộ dữ liệu tăng lên, ước lượng điểm của ta sẽ hội tụ đến giá trị thực của các tham số tương ứng. Nói một cách chặt chẽ hơn, ta sẽ muốn</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-482"><span class="MJXp-mtable" id="MJXp-Span-483"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-484" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-485" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-486"><span class="MJXp-mrow" id="MJXp-Span-487" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-488">p</span><span class="MJXp-mspace" id="MJXp-Span-489" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-490">l</span><span class="MJXp-mi" id="MJXp-Span-491">i</span><span class="MJXp-mi" id="MJXp-Span-492">m</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-493" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">m</span><span class="MJXp-mo" id="MJXp-Span-495">→</span><span class="MJXp-mi" id="MJXp-Span-496">∞</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mrow" id="MJXp-Span-498" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-499"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-502" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">θ</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\mathrm{p\,lim}_{m \rightarrow \infty} \hat \theta_m = \theta. \tag{5.55} </script></span></p><p>Ký hiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mrow" id="MJXp-Span-507"><span class="MJXp-mi" id="MJXp-Span-508">p</span><span class="MJXp-mspace" id="MJXp-Span-509" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-510">l</span><span class="MJXp-mi" id="MJXp-Span-511">i</span><span class="MJXp-mi" id="MJXp-Span-512">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">\mathrm {p\,lim}</script></span> biểu thị sự hội tụ theo xác suất, có nghĩa là đối với bất kỳ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">ϵ</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-516">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">\epsilon > 0</script></span> nào, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">P</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-520"><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mrow" id="MJXp-Span-523" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-524"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-527" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">θ</span><span class="MJXp-mrow" id="MJXp-Span-530"><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">ϵ</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-536">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">P (|\hat \theta_m− \theta|> \epsilon) \rightarrow 0</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">m</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi" id="MJXp-Span-540">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">m \rightarrow \infty</script></span>. Điều kiện được mô tả bởi phương trình (5.55) được gọi là <strong>tính nhất quán</strong> (consistency). Đôi khi, nó được gọi là tính nhất quán yếu; tương ứng, tính nhất quán mạnh đề cập đến sự hội tụ <strong>gần như chắc chắn</strong> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mrow" id="MJXp-Span-542"><span class="MJXp-munderover" id="MJXp-Span-543"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">θ</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">\hat \theta</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-546"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-547">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">\boldsymbol{\theta}</script></span>. <strong>Hội tụ gần như chắc chắn</strong> (almost sure convergency) của một chuỗi các biến ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-548"><span class="MJXp-msubsup" id="MJXp-Span-549"><span class="MJXp-mrow" id="MJXp-Span-550" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-551">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-552" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-553">(</span><span class="MJXp-mn" id="MJXp-Span-554">1</span><span class="MJXp-mo" id="MJXp-Span-555">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-557"><span class="MJXp-mrow" id="MJXp-Span-558" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-559">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-560" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-561">(</span><span class="MJXp-mn" id="MJXp-Span-562">2</span><span class="MJXp-mo" id="MJXp-Span-563">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">\mathbf{x}^{(1)},\mathbf{x}^{(2)}, \dots</script></span> tới một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">x</script></span> xảy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">p</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-576"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.333em; margin-right: 0.05em;">lim</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-578" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">m</span><span class="MJXp-mo" id="MJXp-Span-580">→</span><span class="MJXp-mi" id="MJXp-Span-581">∞</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mrow" id="MJXp-Span-583" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-584">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-585" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-586">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">m</span><span class="MJXp-mo" id="MJXp-Span-588">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">x</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-593">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">p (\lim_{m \rightarrow \infty} \mathbf{x}^{(m)} = x) = 1</script></span>.</p><p>Tính nhất quán đảm bảo rằng độ chệch do hàm ước lượng gây ra sẽ giảm đi khi số lượng mẫu dữ liệu tăng lên. Tuy nhiên, điều ngược lại không đúng - một hàm ước lượng không chệch về mặt tiệm cận không có nghĩa là nó có tính nhất quán. Ví dụ, xét phép ước lượng tham số trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">\mu</script></span> của một phân phối chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mrow" id="MJXp-Span-597"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-598">N</span></span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">x</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">μ</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-606" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">\mathcal{N} (x; \mu, \sigma^2)</script></span> với một tập dữ liệu bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">m</script></span> mẫu: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-610"><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-614" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-615">(</span><span class="MJXp-mn" id="MJXp-Span-616">1</span><span class="MJXp-mo" id="MJXp-Span-617">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-625" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-626">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">m</span><span class="MJXp-mo" id="MJXp-Span-628">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">\{x^{(1)},. . . , x^{(m)}\}</script></span>. Chúng ta có thể sử dụng mẫu đầu tiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-630"><span class="MJXp-msubsup" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-633" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-634">(</span><span class="MJXp-mn" id="MJXp-Span-635">1</span><span class="MJXp-mo" id="MJXp-Span-636">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">x^{(1)}</script></span> của tập dữ liệu như một ước lượng không chệch: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mrow" id="MJXp-Span-638"><span class="MJXp-munderover" id="MJXp-Span-639"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-641" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-645" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-646">(</span><span class="MJXp-mn" id="MJXp-Span-647">1</span><span class="MJXp-mo" id="MJXp-Span-648">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">\hat \theta = x^{(1)}</script></span>. Trong trường hợp đó, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mrow" id="MJXp-Span-650"><span class="MJXp-mi undefined" id="MJXp-Span-651">E</span></span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mrow" id="MJXp-Span-654" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-655"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">\mathbb{E} (\hat \theta_m) = \theta</script></span>, vì vậy ước lượng là không chệch cho dù có bao nhiêu điểm dữ liệu được quan sát đi chăng nữa. Hiển nhiên, điều này mang ý nghĩa ước lượng là không chệch theo tiệm cận. Tuy nhiên, đây không phải là một ước lượng nhất quán vì nó không thỏa mãn trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mrow" id="MJXp-Span-664" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-665"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">θ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-668" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">\hat\theta_m \rightarrow \theta</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">m</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi" id="MJXp-Span-674">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">m \rightarrow \infty</script></span>.</p><h1 id="55-Ước-lượng-hợp-lý-cực-đại"><a class="anchor hidden-xs" href="#55-Ước-lượng-hợp-lý-cực-đại" title="55-Ước-lượng-hợp-lý-cực-đại"><span class="octicon octicon-link"></span></a>5.5 Ước lượng hợp lý cực đại</h1><p>Chúng ta đã xem xét một số định nghĩa của các ước lượng phổ biến và phân tích các tính chất của chúng. Nhưng những ước lượng này từ đâu mà có? Thay vì đoán mò một vài hàm có thể tạo ra một ước lượng tốt rồi sau đó phân tích độ chệch và phương sai của nó, ta cần có một số nguyên lý để từ đó có thể suy ra các hàm cụ thể mà chúng có thể là các ước lượng tốt cho các mô hình khác nhau.</p><p>Một trong những nguyên tắc phổ biến nhất đó là <em>ước lượng hợp lý cực đại</em> (maximum likelihood estimation).</p><p>Xét một tập hợp gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mrow" id="MJXp-Span-678"><span class="MJXp-mi undefined" id="MJXp-Span-679">X</span></span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-684" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-685">(</span><span class="MJXp-mn" id="MJXp-Span-686">1</span><span class="MJXp-mo" id="MJXp-Span-687">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-691"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-692" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-693" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-694">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">m</span><span class="MJXp-mo" id="MJXp-Span-696">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">\mathbb{X} = \{\boldsymbol x^{(1)},\dots , \boldsymbol x^{(m)}\}</script></span> được lấy độc lập từ một phân phối sinh dữ liệu thực sự nhưng chưa biết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-701" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-707"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-708">x</span></span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">p_{data}(\mathbf{x})</script></span>.</p><p>Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-714">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-717">x</span></span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-719">θ</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">p_{\text{model}} (\mathbf{x};\boldsymbol{\theta})</script></span> là một họ phân phối xác suất trên cùng không gian được tham số hóa bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-721"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-722">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">\boldsymbol{\theta}</script></span>. Nói cách khác, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-726" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-727">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-729">x</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-731">θ</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">p_{\text{model}}(\boldsymbol{x}; \boldsymbol{\theta})</script></span> ánh xạ bất kỳ một mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-734">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\boldsymbol{x}</script></span> nào tới một số thực ước lượng xác suất thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-735"><span class="MJXp-msubsup" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-738" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-739">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-741">x</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">p_{\text{data}}(\boldsymbol{x})</script></span>.</p><p>Ước lượng hợp lý tối đa cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-744">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">\boldsymbol{\theta}</script></span> sau đó được định nghĩa như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-745"><span class="MJXp-mtable" id="MJXp-Span-746"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-747" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-748" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-749"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-750" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-751" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-752">ML</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-753" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-754"></span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-756" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-757">arg</span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-759"><span><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-761" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-762">θ</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-766">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-768"><span class="MJXp-mi undefined" id="MJXp-Span-769">X</span></span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-771">θ</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-773" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-774" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-775" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-776"></span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-778" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-779">arg</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-781"><span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-783" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-784">θ</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-785"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-791" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-787" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">i</span><span class="MJXp-mo" id="MJXp-Span-789">=</span><span class="MJXp-mn" id="MJXp-Span-790">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-795" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-796">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-800" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-801">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">i</span><span class="MJXp-mo" id="MJXp-Span-803">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-805">θ</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-58">\begin{eqnarray}\boldsymbol{\theta}_{\text {ML}} &=& \arg \max_{\boldsymbol\theta} p_{\text{model}} (\mathbb{X}; \boldsymbol{\theta}) \tag{5.56} \\
& = & \arg \max_{\boldsymbol\theta}\prod \limits_{i=1}^{m} p_{\text{model}} (\boldsymbol x^{(i)};\boldsymbol{\theta})\tag{5.57}\end{eqnarray}</script></span></p><p>Kết quả này là tích của nhiều xác suất, vì thế có thể gây ra bất tiện bởi nhiều lý do. Chẳng hạn, nó có xu hướng gây ra thấp luồng. Để thu được một bài toán tối ưu tương đương nhưng thuận tiện cho việc giải quyết hơn, ta thấy rằng việc lấy logarit của hàm hợp lý không thay đổi giá trị tối đa của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-807"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-808">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">\boldsymbol{\theta}</script></span> nhưng lại dễ dàng biến đổi một tích thành một tổng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-809"><span class="MJXp-mtable" id="MJXp-Span-810"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-811" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-812" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-815" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-819">arg</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-821"><span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-823" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-824">θ</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-825"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-831" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-827" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">i</span><span class="MJXp-mo" id="MJXp-Span-829">=</span><span class="MJXp-mn" id="MJXp-Span-830">1</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-833">log</span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-835">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-838" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-839">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-841"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-842" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-843" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-846">θ</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">\boldsymbol{\theta}_{ML} = \arg \max_{\boldsymbol{\boldsymbol{\theta}}} \sum \limits_{i=1}^{m} \log \space p_{\text{model}}(\boldsymbol{x}^{i}; \boldsymbol{\theta}).  \tag{5.58}</script></span></p><p>Vì hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-849"><span class="MJXp-mi" id="MJXp-Span-850">arg</span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\arg\max</script></span> không thay đổi khi ta tái cân chỉnh tỉ lệ hàm chi phí (tức là nhân với một tỉ số không đổi) nên ta có thể chia hàm chi phí cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">m</script></span> để thu được một biểu thức của giá trị kỳ vọng đối với phân phối thực nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-855"><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mrow" id="MJXp-Span-857" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-858"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-861" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-862">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">\hat p_{\text{data}}</script></span> xác định bởi dữ liệu huấn luyện:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-863"><span class="MJXp-mtable" id="MJXp-Span-864"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-865" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-866" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-868" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-873">arg</span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-875"><span><span class="MJXp-mo" id="MJXp-Span-876" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-877" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-878">θ</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-879"><span class="MJXp-mrow" id="MJXp-Span-880" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-881">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-882" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-883"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-884">x</span></span><span class="MJXp-mo" id="MJXp-Span-885">∼</span><span class="MJXp-msubsup" id="MJXp-Span-886"><span class="MJXp-mrow" id="MJXp-Span-887" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-888"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-890" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-891" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-892">data</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-893"><span class="MJXp-mi" id="MJXp-Span-894">l</span><span class="MJXp-mi" id="MJXp-Span-895">o</span><span class="MJXp-mi" id="MJXp-Span-896">g</span></span><span class="MJXp-mtext" id="MJXp-Span-897">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-900" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-901">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-903">x</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-905">θ</span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">\boldsymbol{\theta}_{ML} = \arg \max_{\boldsymbol{\theta}}\mathbb{E}_{\mathbf{x}∼\hat p_{\text{data}} } \mathrm{log}~ p_{\text{model}} (\boldsymbol{x};\boldsymbol{\theta}). \tag{5.59}</script></span></p><p>Một cách để diễn giải phương pháp ước lượng hợp lý cực đại là xem nó như một quá trình tối thiểu hóa sự sai khác giữa phân phối thực nghiệm, xác định bởi tập huấn luyện và phân phối của mô hình với mức độ sai khác giữa hai phân phối được đo bằng <em>độ phân kỳ Kullback–Leibler</em> (KL divergence). Độ phân kỳ Kullback–Leibler được tính như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-908"><span class="MJXp-mtable" id="MJXp-Span-909"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-910" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-911" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-914" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mrow" id="MJXp-Span-919" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-920"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-923" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-924">data</span></span></span><span class="MJXp-mrow" id="MJXp-Span-925"><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-927"><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-931" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-932">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-935"><span class="MJXp-mrow" id="MJXp-Span-936" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-937">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-938" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-939"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-940">x</span></span><span class="MJXp-mo" id="MJXp-Span-941">∼</span><span class="MJXp-msubsup" id="MJXp-Span-942"><span class="MJXp-mrow" id="MJXp-Span-943" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-944"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-946" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-947" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-948">data</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-950"><span class="MJXp-mi" id="MJXp-Span-951">l</span><span class="MJXp-mi" id="MJXp-Span-952">o</span><span class="MJXp-mi" id="MJXp-Span-953">g</span></span><span class="MJXp-mtext" id="MJXp-Span-954">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-955"><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mrow" id="MJXp-Span-957" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-958"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-961" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">a</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-967">x</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-970"><span class="MJXp-mi" id="MJXp-Span-971">l</span><span class="MJXp-mi" id="MJXp-Span-972">o</span><span class="MJXp-mi" id="MJXp-Span-973">g</span></span><span class="MJXp-mtext" id="MJXp-Span-974">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-977" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-978">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-980">x</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">D_{KL} (\hat p_{\text{data}}||p_{\text{model}}) = \mathbb{E}_{\mathbf x∼\hat p_{\text{data}}} [\mathrm{log}~{\hat p_{data}} (\boldsymbol x) - \mathrm{log}~ p_{\text{model}} (\boldsymbol x)]. \tag { 5.60}</script></span></p><blockquote>
<p><em><strong>ND</strong></em>: Độ phân kì Kullback–Leibler được mô tả chi tiết hơn trong hình 2.10</p>
</blockquote><p>Số hạng bên trái là một hàm chỉ ứng với quá trình sinh dữ liệu chứ không phải là mô hình. Có nghĩa là khi ta huấn luyện mô hình để cực tiểu hóa độ phân kỳ Kullback–Leibler, chúng ta chỉ cần cực tiểu hóa</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-984"><span class="MJXp-mtable" id="MJXp-Span-985"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-986" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-987" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mrow" id="MJXp-Span-990" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-991">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-992" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-993"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-994">x</span></span><span class="MJXp-mo" id="MJXp-Span-995">∼</span><span class="MJXp-msubsup" id="MJXp-Span-996"><span class="MJXp-mrow" id="MJXp-Span-997" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-998"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1001" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1002">data</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-1004"><span class="MJXp-mi" id="MJXp-Span-1005">log</span></span><span class="MJXp-mtext" id="MJXp-Span-1006">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1009" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1010">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1012">x</span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">-\mathbb{E}_{\mathbf{x}∼\hat p_{\text{data}}} [\mathrm{\log}~ p_{\text{model}} (\boldsymbol x)], \tag{5.61}</script></span></p><p>việc này cũng tương đương với tìm cực đại trong phương trình (5.59).</p><p>Cực tiểu hóa độ phân kỳ Kullback–Leibler tương ứng với cực tiểu hóa entropy chéo giữa các phân phối. Nhiều tác giả sử dụng thuật ngữ “entropy chéo” để chỉ cụ thể <em>hàm đối của logarit hợp lý</em> (negative log-likelihood) của một phân phối Bernoulli hoặc phân phối softmax, nhưng đó là một sai lầm trong cách dùng thuật ngữ. Bất kỳ hàm mất mát nào có bao gồm một hàm đối của logarit hợp lý đều là một entropy chéo giữa phân phối thực nghiệm xác định bởi tập huấn luyện và phân phối xác suất xác định bởi mô hình. Ví dụ, sai số bình phương trung bình là entropy chéo giữa phân phối thực nghiệm và một mô hình Gauss.</p><p>Do đó, chúng ta có thể coi ước lượng hợp lý cực đại là một nỗ lực khiến cho phân phối của mô hình khớp với phân phối thực nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-msubsup" id="MJXp-Span-1017"><span class="MJXp-mrow" id="MJXp-Span-1018" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1019"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1023">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">\hat p_{\text{data}}</script></span>, và lý tưởng nhất là khớp với phân phối sinh dữ liệu thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1027" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1028">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">p_{\text{data}}</script></span>, nhưng trong thực tế ta không thể trực tiếp tiếp cập phân phối này.</p><p>Trong khi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1030">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">\boldsymbol{\theta}</script></span> tối ưu là giống nhau bất kể việc chúng ta sẽ cực đại hóa hàm hợp lý hay cực tiểu hóa hóa độ phân kỳ Kullback–Leibler, thì giá trị của các hàm mục tiêu là khác nhau. Ta thường coi cả hai là những quá trình tối thiểu hóa hàm chi phí. Do đó, cực đại hóa hàm hợp lý trở thành cực tiểu hóa hàm đối của logarit hợp lý, hay tương đương cực tiểu hóa entropy chéo. Quan điểm coi hợp lý cực đại như là phân kỳ Kullback–Leibler cực tiểu trở nên hữu ích trong trường hợp này bởi vì ta đã biết phân kỳ Kullback–Leibler có giá trị nhỏ nhất là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mn" id="MJXp-Span-1032">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">0</script></span>. Hàm đối của logarit hợp lý trong thực tế có thể trở thành số âm khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1034">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">\boldsymbol{x}</script></span> là giá trị thực.</p><h2 id="551-Logarit-hợp-lý-có-điều-kiện-và-sai-số-bình-phương-trung-bình"><a class="anchor hidden-xs" href="#551-Logarit-hợp-lý-có-điều-kiện-và-sai-số-bình-phương-trung-bình" title="551-Logarit-hợp-lý-có-điều-kiện-và-sai-số-bình-phương-trung-bình"><span class="octicon octicon-link"></span></a>5.5.1 Logarit hợp lý có điều kiện và sai số bình phương trung bình</h2><p>Ta có thể dễ dàng tổng quát hóa <em>ước lượng hợp lý cực đại</em> (maximum likelihood estimator) để ước lượng một xác suất có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">P</span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1039">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1040"><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1043">x</span></span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1045">θ</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">P(\mathbf{y}|\mathbf{x};\boldsymbol{\theta})</script></span> để dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1047"><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1049">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">\mathbf{y}</script></span> khi đã biết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mrow" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1052">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">\mathbf{x}</script></span>. Trong thực tế, bước biến đổi này được dùng rất phổ biến vì nó là cơ sở cho hầu hết các phương pháp học có giám sát. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1054">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol{X}</script></span> biểu diễn tất cả các đầu vào và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1056">Y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">\boldsymbol{Y}</script></span> là tất cả các nhãn mà chúng ta quan sát được, thì ước lượng hợp lý cực đại có điều kiện là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1057"><span class="MJXp-mtable" id="MJXp-Span-1058"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1059" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1060" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1062" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1063" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1064">ML</span></span></span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1066">arg</span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-1068"><span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1070" style="margin-left: 0px;">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">P</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1073">Y</span><span class="MJXp-mrow" id="MJXp-Span-1074"><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1076">X</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1078">θ</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">\boldsymbol{\theta}_{\text{ML}}=\arg \max_\boldsymbol{\theta}P(\boldsymbol{Y}|\boldsymbol{X};\boldsymbol{\theta}) \tag{5.62}</script></span></p><p>Nếu các mẫu của chúng ta là phân phối độc lập và giống nhau, biểu thức trên có thể tách ra thành:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1080"><span class="MJXp-mtable" id="MJXp-Span-1081"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1082" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1083" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1086" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1087">ML</span></span></span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1089">arg</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-1091"><span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1093" style="margin-left: 0px;">θ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1094"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1100" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1096" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">i</span><span class="MJXp-mo" id="MJXp-Span-1098">=</span><span class="MJXp-mn" id="MJXp-Span-1099">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1102"><span class="MJXp-mi" id="MJXp-Span-1103">l</span><span class="MJXp-mi" id="MJXp-Span-1104">o</span><span class="MJXp-mi" id="MJXp-Span-1105">g</span></span><span class="MJXp-mtext" id="MJXp-Span-1106">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">P</span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1111" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1112">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">i</span><span class="MJXp-mo" id="MJXp-Span-1114">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1115"><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1118" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1119" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1120">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">i</span><span class="MJXp-mo" id="MJXp-Span-1122">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1124">θ</span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-78">\boldsymbol{\theta}_{\text{ML}}=\arg \max_\boldsymbol{\theta}\sum_{i=1}^{m}\mathrm {log}\  P(\boldsymbol{y}^{(i)}|\boldsymbol{x}^{(i)};\boldsymbol{\theta}) \tag{5.63}</script></span></p><p><strong>Ví dụ về hồi quy tuyến tính dưới góc nhìn hợp lý cực đại:</strong>. Hồi quy tuyến tính, được giới thiệu ở phần 5.1.4, có thể xem là một quá trình hợp lý cực đại. Như đã nói, chúng ta sử dụng hồi quy tuyến tính như là một thuật toán để học cách lấy dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1127">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">\boldsymbol{x}</script></span>, từ đó sinh một đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-mrow" id="MJXp-Span-1129"><span class="MJXp-munderover" id="MJXp-Span-1130"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">\hat{y}</script></span>. Phép ánh xạ từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1133"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1134">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">\boldsymbol{x}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1135"><span class="MJXp-mrow" id="MJXp-Span-1136"><span class="MJXp-munderover" id="MJXp-Span-1137"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">\hat{y}</script></span> được chọn để cực tiểu hóa sai số bình phương trung bình, một tiêu chuẩn mà ta đã đưa ra ít nhiều mang tính tùy ý. Bây giờ chúng ta sẽ xem xét lại mô hình hồi quy tuyến tính từ góc nhìn của ước lượng hợp lý cực đại. Thay vì sinh ra một nhãn dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mrow" id="MJXp-Span-1141"><span class="MJXp-munderover" id="MJXp-Span-1142"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">\hat{y}</script></span>, ta coi mô hình trên như là một cách tạo ra phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">p</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">y</span><span class="MJXp-mtext" id="MJXp-Span-1149">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1150"><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1153">x</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">p(y\ |\ \boldsymbol{x})</script></span>. Hình dung rằng với một tập huấn luyện lớn vô hạn, ta có thể quan sát thấy vài mẫu dữ liệu huấn luyện có giá trị đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1156">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">\boldsymbol{x}</script></span> giống nhau nhưng lại cho ra các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">y</script></span> khác nhau. Mục tiêu của phương pháp học giờ đây là làm cho phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">p</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">y</span><span class="MJXp-mtext" id="MJXp-Span-1163">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1164"><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1166">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1167">x</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">p(y\ |\ \boldsymbol x)</script></span> khớp với tất cả các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">y</script></span> khác nhau trên sao cho chúng đều tương thích với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1172">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">\boldsymbol{x}</script></span>. Để suy ra giải thuật hồi quy tuyến tính ban đầu, ta định nghĩa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">p</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">y</span><span class="MJXp-mtext" id="MJXp-Span-1177">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1178"><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1180">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1181">x</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1184"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1185">N</span></span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">y</span><span class="MJXp-mtext" id="MJXp-Span-1188">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1190">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1191"><span class="MJXp-munderover" id="MJXp-Span-1192"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1196">x</span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1198">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1199">w</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1204" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">p(y\ |\ \boldsymbol{x})=\mathcal{N}(y\ ;\ \widehat{y}(\boldsymbol{x},\ \boldsymbol{w}),\sigma^2)</script></span>. Với hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1206"><span class="MJXp-mrow" id="MJXp-Span-1207"><span class="MJXp-munderover" id="MJXp-Span-1208"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1212">x</span><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1214">w</span><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">\hat{y}(\boldsymbol{x};\boldsymbol{w})</script></span> là một dự đoán của giá trị trung bình của phân phối chuẩn. Trong ví dụ này, ta giả sử rằng phương sai được cố định là một vài hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1216"><span class="MJXp-msubsup" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1219" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">\sigma^2</script></span> đã chọn từ trước. Ta sẽ thấy rằng cách chọn dạng của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">p</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">y</span><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1225"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1227">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1228">x</span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">p(y\ |\ \boldsymbol{x})</script></span> khiến cho quá trình ước lượng hợp lý cực đại tương đương với thuật toán học tập ta đã xây dựng trước đó. Vì các mẫu dữ liệu được giả định là phân phối độc lập và giống nhau, hàm logarit hợp lý có điều kiện (phương trình (5.63)) sẽ trở thành:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1230"><span class="MJXp-mtable" id="MJXp-Span-1231"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1232" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1233" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1234"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1236" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">i</span><span class="MJXp-mo" id="MJXp-Span-1238">=</span><span class="MJXp-mn" id="MJXp-Span-1239">1</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-1241">log</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">p</span><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1248" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1249">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">i</span><span class="MJXp-mo" id="MJXp-Span-1251">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1256" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1257">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">i</span><span class="MJXp-mo" id="MJXp-Span-1259">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1261">θ</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">\sum_{i=1}^m\log{p(y^{(i)}|\boldsymbol{x}^{(i)},\boldsymbol{\theta})} \tag{5.64}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1263"><span class="MJXp-mtable" id="MJXp-Span-1264"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1265" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1266" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">m</span><span class="MJXp-mi" id="MJXp-Span-1270">log</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">σ</span></span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1275" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1277">2</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-1278">log</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1281">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">π</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1285"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1291" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1287" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">i</span><span class="MJXp-mo" id="MJXp-Span-1289">=</span><span class="MJXp-mn" id="MJXp-Span-1290">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1293" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1294"><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1296"><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1298"><span class="MJXp-mrow" id="MJXp-Span-1299" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1300"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1303" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1304">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">i</span><span class="MJXp-mo" id="MJXp-Span-1306">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1310" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1311">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">i</span><span class="MJXp-mo" id="MJXp-Span-1313">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1314"><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1316"><span class="MJXp-mrow" id="MJXp-Span-1317" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1319" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1320">2</span><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1323" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-95">=-m\log{\sigma}-\frac{m}{2}\log(2\pi)-\sum_{i=1}^{m}\frac{||\widehat{y}^{(i)}-y^{(i)}||^2}{2\sigma^2}, \tag{5.65}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-msubsup" id="MJXp-Span-1326"><span class="MJXp-mrow" id="MJXp-Span-1327" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1328"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1331" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1332">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">i</span><span class="MJXp-mo" id="MJXp-Span-1334">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">\hat{y}^{(i)}</script></span> là đầu ra của hồi quy tuyến tính ứng với đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-msubsup" id="MJXp-Span-1336"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1337" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1338" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1339">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">i</span><span class="MJXp-mo" id="MJXp-Span-1341">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">\boldsymbol{x}^{(i)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">m</script></span> là số lượng mẫu huấn luyện. So sánh logarit hợp lý với sai số bình phương trung bình,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1344"><span class="MJXp-mtable" id="MJXp-Span-1345"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1346" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1347" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1348"><span class="MJXp-mi" id="MJXp-Span-1349">M</span><span class="MJXp-mi" id="MJXp-Span-1350">S</span><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi" id="MJXp-Span-1352" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;"><span class="MJXp-mi" id="MJXp-Span-1354">t</span><span class="MJXp-mi" id="MJXp-Span-1355">r</span><span class="MJXp-mi" id="MJXp-Span-1356">a</span><span class="MJXp-mi" id="MJXp-Span-1357">i</span><span class="MJXp-mi" id="MJXp-Span-1358">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1360" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1361">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1363"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1369" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1365" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">i</span><span class="MJXp-mo" id="MJXp-Span-1367">=</span><span class="MJXp-mn" id="MJXp-Span-1368">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1371"><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1373"><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1375"><span class="MJXp-mrow" id="MJXp-Span-1376" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1377"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1380" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1381">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">i</span><span class="MJXp-mo" id="MJXp-Span-1383">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1387" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1388">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">i</span><span class="MJXp-mo" id="MJXp-Span-1390">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1391"><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1393"><span class="MJXp-mrow" id="MJXp-Span-1394" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1396" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">\mathrm{MSE_{train}}=\frac{1}{m}\sum_{i=1}^{m}||\widehat{y}^{(i)}-y^{(i)}||^2, \tag{5.66}</script></span></p><p>ta có thể thấy ngay rằng việc cực đại hóa giá trị logarit hàm hợp lý theo tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1399">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\boldsymbol{w}</script></span> cho ra ước lượng của tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1401">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">\boldsymbol{w}</script></span> giống như khi cực tiểu hóa sai số bình phương trung bình. Hai tiêu chuẩn có các giá trị khác nhau nhưng lại có cùng nghiệm tối ưu. Điều này giải thích lí do ta có thể sử dụng sai số bình phương trung bình như một quá trình ước lượng hợp lý cực đại. Chúng ta sẽ thấy ước lượng sử dụng hợp lý cực đại có nhiều tính chất hữu dụng.</p><h2 id="552-Các-tính-chất-của-phương-pháp-hợp-lý-cực-đại"><a class="anchor hidden-xs" href="#552-Các-tính-chất-của-phương-pháp-hợp-lý-cực-đại" title="552-Các-tính-chất-của-phương-pháp-hợp-lý-cực-đại"><span class="octicon octicon-link"></span></a>5.5.2 Các tính chất của phương pháp hợp lý cực đại</h2><p>Ưu điểm chính của ước lượng sử dụng hợp lý cực đại là nó tiệm cận với ước lượng tốt nhất khi số mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">m</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi" id="MJXp-Span-1405">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">m\rightarrow \infty</script></span>, về mặt tốc độ hội tụ khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">m</script></span> tăng lên.</p><p>Với các điều kiện phù hợp, ước lượng sử dụng hợp lý cực đại có tính nhất quán (xem mục 5.4.5 ở trên), có nghĩa là khi số mẫu huấn luyện tiến tới vô cùng, ước lượng hợp lý cực đại của tham số sẽ hội tụ đến giá trị đúng của tham số. Các điều kiện cần thiết là:</p><ul>
<li>
<p>Phân phối thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-msubsup" id="MJXp-Span-1409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1411" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1412">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">p_{\text{data}}</script></span> phải nằm ở trong họ mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1413"><span class="MJXp-msubsup" id="MJXp-Span-1414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1416" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1417">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1421">θ</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">p_{\text{model}}(\cdot;\boldsymbol{\theta}).</script></span> Nếu không, không ước lượng nào có thể xác định được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1424"><span class="MJXp-msubsup" id="MJXp-Span-1425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1427" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1428">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">p_{\text{data}}</script></span>.</p>
</li>
<li>
<p>Phân phối thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1429"><span class="MJXp-msubsup" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1432" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1433">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">p_{\text{data}}</script></span> phải tương ứng chính xác với đúng một giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1434"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1435">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">\boldsymbol{\theta}</script></span>. Nếu không, ước lượng hợp lý cực đại có thể tìm được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-msubsup" id="MJXp-Span-1437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1439" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1440">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">p_{\text{data}},</script></span> nhưng sẽ không thể xác định giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1442"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1443">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\boldsymbol{\theta}</script></span> được dùng cho quá trình sinh dữ liệu.</p>
</li>
</ul><p>Vẫn còn những phương pháp quy nạp khác bên cạnh ước lượng hợp lý cực đại, nhiều phương pháp trong số đó cũng thoả mãn tính chất của ước lượng nhất quán. Tuy nhiên, các ước lượng nhất quán khác nhau có thể có <strong>tính hiệu quả thống kê</strong> (statistical efficiency) khác nhau, có nghĩa là một ước lượng nhất quán có thể đạt được sai số tổng quát hóa thấp hơn với một số lượng mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">m</script></span> cố định, nói cách khác, ước lượng đó có thể chỉ cần một số lượng mẫu ít hơn để đạt được một mức sai số tổng quát hóa cố định.</p><p>Tính hiệu quả thống kê thường được nghiên cứu trong <strong>trường hợp có tham số</strong> (parametric case) (chẳng hạn như trong hồi quy tuyến tính), ở đó mục đích của chúng ta là ước lượng giá trị của tham số (với giả định rằng giá trị thực của tham số là có thể xác định), chứ không phải giá trị của hàm. Một cách để đo lường sự tương quan giữa ước lượng của chúng ta với với giá trị thực của tham số là tính kỳ vọng của sai số bình phương trung bình, tính bình phương của hiệu giữa tham số ước lượng và giá trị thực của tham số, với kỳ vọng lấy trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">m</script></span> mẫu huấn luyện từ phân phối sinh dữ liệu. Sai số bình phương trung bình này giảm khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">m</script></span> tăng, và với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">m</script></span> lớn, cận dưới Cramér-Rao [Rao, 1945; Cramér, 1946] chỉ ra rằng không có ước lượng nhất quán nào có sai số bình phương trung bình thấp hơn ước lượng hợp lý cực đại.</p><p>Vì những lý do trên (tính nhất quán và tính hiệu quả), hợp lý cực đại thường được lựa chọn cho ước lượng trong học máy. Khi số lượng mẫu đủ nhỏ để dẫn tới hiện tượng quá khớp, các phương pháp kiểm soát như suy giảm trọng số có thể được dùng để thu được một phiên bản hiệu chỉnh của hợp lý cực đai có phương sai nhỏ hơn khi tập dữ liệu huấn luyện có giới hạn.</p><h1 id="56-Thống-kê-Bayes"><a class="anchor hidden-xs" href="#56-Thống-kê-Bayes" title="56-Thống-kê-Bayes"><span class="octicon octicon-link"></span></a>5.6 Thống kê Bayes</h1><p>Cho đến nay, chúng ta đã thảo luận về <strong>thống kê tần suất</strong> (frequentist statistics) và các phương pháp tiếp cận dựa trên việc ước lượng một giá trị đơn lẻ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1453">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\boldsymbol{\theta}</script></span>, sau đó thực hiện tất cả các dự đoán tiếp theo dựa trên chỉ một ước lượng đó. Một cách tiếp cận khác là xem xét tất cả các giá trị có thể nhận của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1455">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">\boldsymbol{\theta}</script></span> khi đưa ra dự đoán. Ý tưởng đó chính là nội dung của <strong>thống kê Bayes</strong> (Bayesian statistics).</p><p>Như đã thảo luận trong phần 5.4.1, quan điểm của trường phái tần suất là: giá trị thực của tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1457">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">\boldsymbol{\theta}</script></span> là một số cố định nhưng chưa được biết trước, trong khi ước lượng điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mrow" id="MJXp-Span-1459"><span class="MJXp-munderover" id="MJXp-Span-1460"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1461">θ</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">\hat{\boldsymbol{\theta}}</script></span> là một biến ngẫu nhiên bởi nó là hàm của một tập dữ liệu ngẫu nhiên.</p><p>Quan điểm Bayes về thống kê là khá khác biệt. Thống kê Bayes sử dụng xác suất để phán ánh mức độ chắc chắn trong các trạng thái của tri thức. Tập dữ liệu là những quan sát trực tiếp và do đó nó không ngẫu nhiên. Mặt khác, giá trị thực <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1464">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">\boldsymbol{\theta}</script></span> của tham số là chưa biết hoặc bất định và vì vậy nó được biểu diễn như một biến ngẫu nhiên.</p><p>Trước khi quan sát dữ liệu, chúng ta biểu diễn các tri thức về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1465"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1466">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">\boldsymbol{\theta}</script></span> bằng cách sử dụng <strong>phân phối xác suất tiên nghiệm</strong> (prior probability distribution) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">p</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1470">θ</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">p(\boldsymbol{\theta})</script></span> (đôi khi được gọi đơn giản là “tiên nghiệm” - the prior). Nói chung, người thực hành học máy thường chọn một phân phối tiên nghiệm khá rộng (tức là, có entropy cao) để phản ánh mức độ bất định cao của giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1473">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">\boldsymbol{\theta}</script></span> trước khi quan sát bất kỳ dữ liệu nào. Ví dụ, người ta có thể giả định trước rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1474"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1475">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">\boldsymbol{\theta}</script></span> nằm trong một phạm vi hoặc một vùng không gian hữu hạn và được phân phối đều. Trong khi nhiều tiên nghiệm khác lại ưu tiên các giải pháp “đơn giản” hơn (chẳng hạn như các hệ số có độ lớn nhỏ hơn, hoặc một hàm gần như là một hằng số).</p><p>Xét một tập dữ liệu mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1476"><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1480" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1481">(</span><span class="MJXp-mn" id="MJXp-Span-1482">1</span><span class="MJXp-mo" id="MJXp-Span-1483">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1491" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-1493" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">\{ x^{(1)},...,x^{m}\}</script></span>. Ta có thể xác định tác động của dữ liệu đối với dự đoán của chúng ta về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1495">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">\boldsymbol{\theta}</script></span> bằng cách kết hợp các hàm hợp lý của dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">p</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1501" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1502">(</span><span class="MJXp-mn" id="MJXp-Span-1503">1</span><span class="MJXp-mo" id="MJXp-Span-1504">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1511" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1512">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">m</span><span class="MJXp-mo" id="MJXp-Span-1514">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1515">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1516"><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1518">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1519">θ</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">p(x^{(1)},...x^{(m)}\ |\ \boldsymbol{\theta})</script></span> với tiên nghiệm của chúng ta theo quy tắc Bayes:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1521"><span class="MJXp-mtable" id="MJXp-Span-1522"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1523" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1524" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">p</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1527">θ</span><span class="MJXp-mtext" id="MJXp-Span-1528">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1529"><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1531">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1534" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1535">(</span><span class="MJXp-mn" id="MJXp-Span-1536">1</span><span class="MJXp-mo" id="MJXp-Span-1537">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-1542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1544" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1545">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">m</span><span class="MJXp-mo" id="MJXp-Span-1547">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1550" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">p</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1555" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1556">(</span><span class="MJXp-mn" id="MJXp-Span-1557">1</span><span class="MJXp-mo" id="MJXp-Span-1558">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1566" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1567">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">m</span><span class="MJXp-mo" id="MJXp-Span-1569">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1570">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1571"><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1573">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1574">θ</span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">p</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1578">θ</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">p</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1584" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1585">(</span><span class="MJXp-mn" id="MJXp-Span-1586">1</span><span class="MJXp-mo" id="MJXp-Span-1587">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1595" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1596">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">m</span><span class="MJXp-mo" id="MJXp-Span-1598">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-127">p(\boldsymbol{\theta}\ |\ x^{(1)},...x^{(m)})=\frac{p(x^{(1)},...,x^{(m)}\ |\ \boldsymbol{\theta})p(\boldsymbol{\theta})}{p(x^{(1)},...,x^{(m)})} \tag{5.67}</script></span></p><p>Trong các tình huống mà ước lượng Bayes thường được sử dụng, tiên nghiệm thường là một phân phối tương đối đồng đều hoặc phân phối Gauss với entropy cao, và các dữ liệu được quan sát thường gây ra việc phân phối hậu nghiệm bị mất mát entropy và tập trung xung quanh một số ít giá trị tham số có khả năng cao xảy ra.</p><p>Liên quan đến ước lượng hợp lý cực đại, ước lượng sử dụng Bayes mang lại hai điểm khác biệt quan trọng. Thứ nhất, không giống như cách tiếp cận hợp lý cực đại, đưa ra dự đoán bằng cách sử dụng một ước lượng điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1601">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">\boldsymbol{\theta}</script></span>, phương pháp Bayes dự đoán bằng cách sử dụng phân phối đầy đủ đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1602"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1603">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol{\theta}</script></span>. Ví dụ, sau khi quan sát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">m</script></span> mẫu, phân phối dự đoán trên mẫu dữ liệu tiếp theo, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1606"><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1609" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1610">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">m</span><span class="MJXp-mo" id="MJXp-Span-1612">+</span><span class="MJXp-mn" id="MJXp-Span-1613">1</span><span class="MJXp-mo" id="MJXp-Span-1614">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">x^{(m+1)}</script></span>, được cho bởi công thức:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1615"><span class="MJXp-mtable" id="MJXp-Span-1616"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1617" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1618" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">p</span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1623" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1624">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">m</span><span class="MJXp-mo" id="MJXp-Span-1626">+</span><span class="MJXp-mn" id="MJXp-Span-1627">1</span><span class="MJXp-mo" id="MJXp-Span-1628">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1633" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1634">(</span><span class="MJXp-mn" id="MJXp-Span-1635">1</span><span class="MJXp-mo" id="MJXp-Span-1636">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1644" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1645">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">m</span><span class="MJXp-mo" id="MJXp-Span-1647">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">p</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1655" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1656">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">m</span><span class="MJXp-mo" id="MJXp-Span-1658">+</span><span class="MJXp-mn" id="MJXp-Span-1659">1</span><span class="MJXp-mo" id="MJXp-Span-1660">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1661">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1662"><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1664">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1665">θ</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1667">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">p</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1670">θ</span><span class="MJXp-mtext" id="MJXp-Span-1671">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1672"><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1674">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1677" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1678">(</span><span class="MJXp-mn" id="MJXp-Span-1679">1</span><span class="MJXp-mo" id="MJXp-Span-1680">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1688" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1689">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">m</span><span class="MJXp-mo" id="MJXp-Span-1691">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">d</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1695">θ</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-132">p(x^{(m+1)}|x^{(1)},...,x^{(m)})=\int p(x^{(m+1)}\ | \ \boldsymbol{\theta})\ p(\boldsymbol{\theta}\ |\ x^{(1)},...,x^{(m)})\ d\boldsymbol{\theta} \tag{5.68}</script></span></p><p>Ở đây, mỗi giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1696"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1697">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">\boldsymbol{\theta}</script></span> với mật độ xác suất dương góp phần vào việc dự đoán mẫu tiếp theo, với trọng số bằng chính mật độ hậu nghiệm. Sau khi quan sát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1698"><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1702" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1703">(</span><span class="MJXp-mn" id="MJXp-Span-1704">1</span><span class="MJXp-mo" id="MJXp-Span-1705">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1710" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1713" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1714">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">m</span><span class="MJXp-mo" id="MJXp-Span-1716">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">\{ x^{(1)},...,x^{(m)} \}</script></span>, nếu chúng ta vẫn còn không chắc chắn về giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1718"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1719">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">\boldsymbol{\theta}</script></span>, thì sự không chắc chắn này được kết hợp trực tiếp vào bất kỳ dự đoán nào mà chúng ta có thể thực hiện.</p><p>Trong phần 5.4, chúng ta đã thảo luận về cách trường phái tần suất giải quyết sự bất định trong một ước lượng điểm cho trước của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1721">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">\boldsymbol{\theta}</script></span> thông qua việc đánh giá phương sai của nó. Phương sai của ước lượng là một sự đánh giá rằng ước lượng có thể thay đổi như thế nào khi ta thay đổi cách lấy mẫu của dữ liệu quan sát được. Lý giải cho câu hỏi về cách trường phái Bayes xử lý sự bất định trong ước lượng chỉ đơn giản là lấy tích phân trên ước lượng đó, việc này có xu hướng giúp ta tránh khỏi hiện tượng quá khớp. Dĩ nhiên , phép lấy tích phân như vậy chỉ là một ứng dụng của các định luật xác suất, giúp phương pháp Bayes trở nên dễ diễn giải hơn, trong khi các công cụ mà trường phái tần suất sử dụng cho việc xây dựng một ước lượng lại dựa trên sự quyết định chỉ nhằm để tổng hợp mọi tri thức trong tập dữ liệu bằng một điểm ước lượng duy nhất.</p><p>Sự khác biệt quan trọng thứ hai giữa cách tiếp cận Bayes với việc ước lượng sử dụng cách tiếp cận hợp lý cực đại là do sự đóng góp của phân phối Bayes tiên nghiệm. Tiên nghiệm gây ảnh hưởng thông qua việc chuyển dịch mật độ khối xác suất về phía các vùng của không gian tham số được ưu tiên từ trước. Trong thực tế, tiên nghiệm thường được dùng để thể hiện sự ưu tiên dành cho các mô hình đơn giản hoặc trơn tru hơn. Các nhà phê bình theo hướng tiếp cận Bayes cho rằng tiên nghiệm là nguồn gốc của đánh giá chủ quan của con người gây tác động đến các dự đoán.</p><p>Các phương pháp Bayes thường tổng quát hóa tốt hơn đối với dữ liệu huấn luyện hữu hạn nhưng lại thường chịu chi phí tính toán cao khi số lượng mẫu huấn luyện lớn.</p><p><strong>Ví dụ về hồi quy tuyến tính theo hướng Bayes:</strong> Ở đây, ta xét phương pháp ước lượng Bayes để học các tham số của mô hình hồi quy tuyến tính. Trong hồi quy tuyến tính, ta cần học một ánh xạ tuyến tính từ một vector đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1723">x</span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1725"><span class="MJXp-mrow" id="MJXp-Span-1726" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1727">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1728" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol x \in \mathbb R^n</script></span> để dự đoán giá trị của một đại lượng vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">y</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi undefined" id="MJXp-Span-1733">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">y\in \mathbb R</script></span>. Dự đoán này được tham số hóa bởi vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1735">w</span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1737"><span class="MJXp-mrow" id="MJXp-Span-1738" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1739">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">\boldsymbol w \in \mathbb R^n</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1753"><span class="MJXp-mtable" id="MJXp-Span-1754"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1755" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1756" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1757"><span class="MJXp-munderover" id="MJXp-Span-1758"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1763" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1764" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1765">x</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">\hat{y}=\boldsymbol{w}^\intercal\boldsymbol{x}. \tag{5.69}</script></span></p><p>Cho trước một tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">m</script></span> mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1769"><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1771"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1772" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1773" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1774">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1778" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1779">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">(\boldsymbol{X}^{\text{(train)}},\boldsymbol{y}^{\text{(train)}})</script></span>, ta có thể biểu diễn dự đoán của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">y</script></span> trên toàn tập huấn luyện dưới dạng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1783"><span class="MJXp-mtable" id="MJXp-Span-1784"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1785" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1786" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mrow" id="MJXp-Span-1788" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1789"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1790">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1792" style="vertical-align: 0.524em;"><span class="MJXp-mtext" id="MJXp-Span-1793">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1796" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1797" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1798">(train)</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1799">w</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-144">\hat{\boldsymbol{y}}^{\text{(train)}}=\boldsymbol{X}^{\text{(train)}}\boldsymbol{w} \tag{5.70}</script></span></p><p>Biểu diễn dưới dạng một phân phối Gauss có điều kiện đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1800"><span class="MJXp-msubsup" id="MJXp-Span-1801"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1802" style="margin-right: 0.05em;">y</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1803" style="vertical-align: 0.5em;">(train)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">\boldsymbol y^\text{(train)}</script></span>, ta được:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1804"><span class="MJXp-mtable" id="MJXp-Span-1805"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1806" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1807" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">p</span><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1811" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1812" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1813">(train)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1814">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1815"><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1817">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1818"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1819" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1820" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1821">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1823">w</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1825" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1826"></span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1828"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1829">N</span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1831"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1832" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1833" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1834">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-1836"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1837" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1838" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1839">(train)</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1840">w</span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1842">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1843">I</span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1845" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1846" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1847" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1848"></span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mrow" id="MJXp-Span-1850"><span class="MJXp-mi" id="MJXp-Span-1851">e</span><span class="MJXp-mi" id="MJXp-Span-1852">x</span><span class="MJXp-mi" id="MJXp-Span-1853">p</span></span><span class="MJXp-mo" id="MJXp-Span-1854" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1855" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1857">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1858">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1860"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1861" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1862" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1863">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1866" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1867" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1868">(train)</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1869">w</span><span class="MJXp-msubsup" id="MJXp-Span-1870"><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1872" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1875" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1876" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1877">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1879"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1880" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1881" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1882">(train)</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1883">w</span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-146">\begin{align}
p(\boldsymbol{y}^{\text{(train)}}\ |\ \boldsymbol{X}^{\text{(train)}},\boldsymbol{w})&=\mathcal{N}(\boldsymbol{y}^{\text{(train)}};\boldsymbol{X}^{\text{(train)}}\boldsymbol{w},\ \boldsymbol{I}) \tag{5.71}
\\
&\propto \mathrm {exp}(\frac{-1}{2}(\boldsymbol{y}^{\text{(train)}}-\boldsymbol{X}^{\text{(train)}}\boldsymbol{w})^\intercal(\boldsymbol{y}^{\text{(train)}}-\boldsymbol{X}^{\text{(train)}}\boldsymbol{w})), \tag{5.72}
\end{align}</script></span></p><p>trong đó, ta dựa trên công thức chuẩn của sai số bình phương trung bình với giả sử rằng phương sai của phân phối Gauss trên biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">y</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1889"><span class="MJXp-mn" id="MJXp-Span-1890">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">1</script></span>. Từ nay về sau, để kí hiệu đơn giản hơn, ta viết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1891"><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1893"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1894" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1895" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1896">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1901">(train)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">(\boldsymbol{X}^{\text{(train)}},\boldsymbol{y}^{\text{(train)}})</script></span> đơn giản là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1905">X</span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1907">y</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">(\boldsymbol{X},\boldsymbol{y})</script></span>.</p><p>Để xác định phân phối hậu nghiệm dựa trên vector tham số mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1910">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">\boldsymbol{w}</script></span>, trước tiên chúng ta cần xác định được phân phối tiên nghiệm. Tiên nghiệm sẽ thể hiện dự đoán “ngây thơ” của chúng ta về giá trị của các tham số, mặc dù đôi khi việc dự đoán tiên nghiệm về các tham số của mô hình là rất khó hoặc không có cơ sở. Trong thực tế, ta thường giả định bằng một phân phối khá rộng, thể hiện mức độ bất định cao đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1912">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\boldsymbol{\theta}</script></span>. Riêng với các tham số có giá trị thực, ta thường sử dụng một phân phối Gauss như một phân phối tiên nghiệm:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1913"><span class="MJXp-mtable" id="MJXp-Span-1914"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1915" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1916" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">p</span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1919">w</span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">N</span><span class="MJXp-mo" id="MJXp-Span-1923" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1924">w</span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1926">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1930" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1931">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1932"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1933" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1934" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1936" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mrow" id="MJXp-Span-1937"><span class="MJXp-mi" id="MJXp-Span-1938">e</span><span class="MJXp-mi" id="MJXp-Span-1939">x</span><span class="MJXp-mi" id="MJXp-Span-1940">p</span></span><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1942" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1943" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1944">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1945">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1947">w</span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1949"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1950" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1951" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-1952"><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1954" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-1955"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1956" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1958"><span class="MJXp-mo" id="MJXp-Span-1959">−</span><span class="MJXp-mn" id="MJXp-Span-1960">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1957">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1962">w</span><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1964"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1965" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1966" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-153">p(\boldsymbol{w})=N(\boldsymbol{w};\ \boldsymbol{\mu}_0,\ \boldsymbol{\Lambda}_0)\propto \mathrm{exp}(-\frac{1}{2}(\boldsymbol{w}-\boldsymbol{\mu}_0)^\intercal\boldsymbol{\Lambda}_0^{-1}(\boldsymbol{w}-\boldsymbol{\mu}_0)) \tag{5.73}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1969"><span class="MJXp-msubsup" id="MJXp-Span-1970"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1971" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1972" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">\boldsymbol{\mu}_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-msubsup" id="MJXp-Span-1974"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1975" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1976" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">\boldsymbol{\Lambda}_0</script></span> lần lượt là vector kì vọng và hiệp phương sai của phân phối tiên nghiệm.<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1977"><span class="MJXp-msubsup" id="MJXp-Span-1978"><span class="MJXp-mi" id="MJXp-Span-1979" style="margin-right: 0.05em;"></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1980" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1981">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">^{1}</script></span></p><blockquote>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1982"><span class="MJXp-msubsup" id="MJXp-Span-1983"><span class="MJXp-mi" id="MJXp-Span-1984" style="margin-right: 0.05em;"></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1985" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1986">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">^{1}</script></span> Trừ những trường hợp đặc biệt, chúng tôi giả định ma trận hiệp phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1987"><span class="MJXp-msubsup" id="MJXp-Span-1988"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1989" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1990" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1992">diag</span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1994"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1995" style="margin-right: 0.05em;">λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1996" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1997">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1998" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">\boldsymbol{\Lambda}_0=\text{diag}(\boldsymbol{\lambda}_{0})</script></span></p>
</blockquote><p>Sau khi đã có chỉ định phân phối tiên nghiệm, ta có thể tiếp tục xác định phân phối <em>hậu nghiệm</em> (posterior) đối với các tham số mô hình:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1999"><span class="MJXp-mtable" id="MJXp-Span-2000"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2001" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2002" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">p</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2005">w</span><span class="MJXp-mtext" id="MJXp-Span-2006">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2007"><span class="MJXp-mo" id="MJXp-Span-2008" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2009">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2010">X</span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2012">y</span><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2014" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2015"></span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">p</span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2019">y</span><span class="MJXp-mtext" id="MJXp-Span-2020">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2021"><span class="MJXp-mo" id="MJXp-Span-2022" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2023">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2024">X</span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2026">w</span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">p</span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2030">w</span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2032" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2033" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2034" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2035"></span><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi" id="MJXp-Span-2037">exp</span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2039"><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-2041" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2042">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2043">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2045">y</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2047">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2048">w</span><span class="MJXp-msubsup" id="MJXp-Span-2049"><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2051" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2053">y</span><span class="MJXp-mo" id="MJXp-Span-2054" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2055">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2056">w</span><span class="MJXp-mo" id="MJXp-Span-2057" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi" id="MJXp-Span-2059">exp</span><span class="MJXp-mo" id="MJXp-Span-2060" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2061"><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mo" id="MJXp-Span-2063" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-2064" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2065">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2066">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2068">w</span><span class="MJXp-mo" id="MJXp-Span-2069" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2070"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2071" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2072" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-2073"><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2075" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2077" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2079"><span class="MJXp-mo" id="MJXp-Span-2080">−</span><span class="MJXp-mn" id="MJXp-Span-2081">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2078">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2083">w</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2086" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2087" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2089" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2090" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2091" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2092" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2093"></span><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi" id="MJXp-Span-2095">exp</span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2097"><span class="MJXp-mo" id="MJXp-Span-2098" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-2100" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2101">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2102">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2105">2</span><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2107" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2108" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2109">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2110">w</span><span class="MJXp-mo" id="MJXp-Span-2111" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2112"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2113" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2114" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2115"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2116" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2117" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2118">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2119">w</span><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2121"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2122" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2123" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2124"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2125" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2127"><span class="MJXp-mo" id="MJXp-Span-2128">−</span><span class="MJXp-mn" id="MJXp-Span-2129">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2126">0</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2130">w</span><span class="MJXp-mo" id="MJXp-Span-2131" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2132">2</span><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2134" style="margin-right: 0.05em;">μ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2136">⊺</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2135">0</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2137"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2138" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2140"><span class="MJXp-mo" id="MJXp-Span-2141">−</span><span class="MJXp-mn" id="MJXp-Span-2142">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2139">0</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2143">w</span><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2145" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-159">\begin{align}
p(\boldsymbol{w}\ |\ \boldsymbol{X},\boldsymbol{y})&\propto p(\boldsymbol{y}\ |\ \boldsymbol{X},\boldsymbol{w})p(\boldsymbol{w}) \tag{5.74} 
\\
&\propto \exp\left (\frac{1}{2}(\boldsymbol{y} -\boldsymbol{Xw})^\intercal(\boldsymbol{y}-\boldsymbol{Xw})\right)\exp\left ( -\frac{1}{2}(\boldsymbol{w}-\boldsymbol{\mu}_0)^\intercal\boldsymbol{\Lambda}_0^{-1}(\boldsymbol{w}-\boldsymbol{\mu}_0)\right)\tag{5.75}
\\
&\propto \exp\left(-\frac{1}{2}(-2\boldsymbol{y}^\intercal \boldsymbol{Xw}+\boldsymbol{w}^\intercal \boldsymbol{X}^\intercal \boldsymbol{Xw} + \boldsymbol{w}^\intercal\boldsymbol{\Lambda}_0^{-1}\boldsymbol{w}-2\boldsymbol{\mu}_0^\intercal\boldsymbol{\Lambda}_0^{-1}\boldsymbol{w})\right)\tag{5.76}
\end{align}</script></span></p><p>Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2146"><span class="MJXp-msubsup" id="MJXp-Span-2147"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2148" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2149" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2152"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2153" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2154" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2155">X</span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2157"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2158" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2160"><span class="MJXp-mo" id="MJXp-Span-2161">−</span><span class="MJXp-mn" id="MJXp-Span-2162">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2159">0</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2163"><span class="MJXp-mo" id="MJXp-Span-2164" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2165" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2166">−</span><span class="MJXp-mn" id="MJXp-Span-2167">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">\boldsymbol{\Lambda}_m=(\boldsymbol{X}^\intercal \boldsymbol{X} + \boldsymbol{\Lambda}_0^{-1})^{-1}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2168"><span class="MJXp-msubsup" id="MJXp-Span-2169"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2170" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2171" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2174" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2175" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2177"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2178" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2179" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2180">y</span><span class="MJXp-mo" id="MJXp-Span-2181" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2182"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2183" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2185"><span class="MJXp-mo" id="MJXp-Span-2186">−</span><span class="MJXp-mn" id="MJXp-Span-2187">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2184">0</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2188"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2189" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2190" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{\mu}_m = \boldsymbol{\Lambda}_m(\boldsymbol{X}^\intercal\boldsymbol{y} + \boldsymbol{\Lambda}_0^{-1}\boldsymbol{\mu}_0)</script></span>. Lúc này hậu nghiệm có thể viết lại dưới dạng một phân phối Gauss:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2192"><span class="MJXp-mtable" id="MJXp-Span-2193"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2194" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2195" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">p</span><span class="MJXp-mo" id="MJXp-Span-2197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2198">w</span><span class="MJXp-mrow" id="MJXp-Span-2199"><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2201">X</span><span class="MJXp-mo" id="MJXp-Span-2202" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2203">y</span><span class="MJXp-mo" id="MJXp-Span-2204" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2205" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2206"></span><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi" id="MJXp-Span-2208">exp</span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2210"><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-2213" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2214">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2215">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2217">w</span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2220" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2221" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-2222"><span class="MJXp-mo" id="MJXp-Span-2223" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2224" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2225"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2226" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2228"><span class="MJXp-mo" id="MJXp-Span-2229">−</span><span class="MJXp-mn" id="MJXp-Span-2230">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2232">w</span><span class="MJXp-mo" id="MJXp-Span-2233" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2235" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2236" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2239" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2240">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2241">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2243" style="margin-right: 0.05em;">μ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2245">⊺</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2246"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2247" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2249"><span class="MJXp-mo" id="MJXp-Span-2250">−</span><span class="MJXp-mn" id="MJXp-Span-2251">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2252"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2253" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2254" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2255" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2256" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2257" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2258" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2259"></span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi" id="MJXp-Span-2261">exp</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-2265" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2266">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2267">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2269">w</span><span class="MJXp-mo" id="MJXp-Span-2270" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2271"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2272" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2273" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-2274"><span class="MJXp-mo" id="MJXp-Span-2275" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2276" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2277"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2278" style="margin-right: 0.05em;">Λ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2280"><span class="MJXp-mo" id="MJXp-Span-2281">−</span><span class="MJXp-mn" id="MJXp-Span-2282">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2284">w</span><span class="MJXp-mo" id="MJXp-Span-2285" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2287" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2288" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-162">\begin{align}
p(\boldsymbol{w}|\boldsymbol{X},\boldsymbol{y}) &\propto \exp\left( -\frac{1}{2}(\boldsymbol{w}-\boldsymbol{\mu}_m)^\intercal \boldsymbol{\Lambda}_m^{-1}(\boldsymbol{w}-\boldsymbol{\mu}_m) +\frac{1}{2}\boldsymbol{\mu}_m^\intercal\boldsymbol{\Lambda}_m^{-1}\boldsymbol{\mu}_m\right)\tag{5.77}
\\
&\propto \exp(-\frac{1}{2}(\boldsymbol{w}-\boldsymbol{\mu}_m)^\intercal\boldsymbol{\Lambda}_m^{-1}(\boldsymbol{w}-\boldsymbol{\mu}_m))\tag{5.78}
\end{align}</script></span></p><p>Có thể bỏ qua tất cả các thành phần không chứa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2291"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2292">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{w}</script></span> bởi phân phối cần được chuẩn hóa để có tích phân bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2293"><span class="MJXp-mn" id="MJXp-Span-2294">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">1</script></span>. Cách chuẩn hóa một phân phối Gauss đa biến đã được thể hiện tại phương trình (3.23).</p><p>Biểu thức hậu nghiệm đã gợi cho ta thấy đôi điều về hiệu quả của suy luận Bayes. Trong hầu hết trường hợp, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2295"><span class="MJXp-msubsup" id="MJXp-Span-2296"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2297" style="margin-right: 0.05em;">μ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2298" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">\boldsymbol{\mu}_0</script></span> được đặt bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2299"><span class="MJXp-mn MJXp-bold" id="MJXp-Span-2300">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">\boldsymbol{0}</script></span>. Nếu đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2301"><span class="MJXp-msubsup" id="MJXp-Span-2302"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2303" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2304" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2306" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2307">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308">α</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2309">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">\boldsymbol{\Lambda}_0=\frac{1}{\alpha}\boldsymbol{I}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2310"><span class="MJXp-msubsup" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2312" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2313" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">\boldsymbol{\mu}_m</script></span> sẽ cho cùng một ước lượng thu được của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2314"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2315">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">\boldsymbol{w}</script></span> khi ta áp dụng phương pháp hồi quy tuyến tính theo tần suất với mức phạt suy giảm trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">α</span><span class="MJXp-msubsup" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2319" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2320" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2321">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">\alpha \boldsymbol{w}^\intercal\boldsymbol{w}</script></span>. Một điều khác biệt đó là ước lượng Bayes là vô định khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\alpha</script></span> được bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2324"><span class="MJXp-mn" id="MJXp-Span-2325">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">0</script></span> – nghĩa là ta không được phép bắt đầu học suy luận Bayes với phân phối tiên nghiệm đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2326"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2327">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">\boldsymbol{w}</script></span> có độ rộng vô hạn. Một khác biệt quan trọng hơn nữa đó là ước lượng Bayes còn cho ta một ma trận hiệp phương sai, thể hiện toàn bộ các khả năng giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2329">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\boldsymbol{w}</script></span> có thể nhận, chứ không đơn thuần chỉ đưa ra ước tính của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2330"><span class="MJXp-msubsup" id="MJXp-Span-2331"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2332" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2333" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\boldsymbol{\mu}_m</script></span>.</p><h2 id="561-Ước-lượng-hậu-nghiệm-cực-đại"><a class="anchor hidden-xs" href="#561-Ước-lượng-hậu-nghiệm-cực-đại" title="561-Ước-lượng-hậu-nghiệm-cực-đại"><span class="octicon octicon-link"></span></a>5.6.1 Ước lượng hậu nghiệm cực đại</h2><p>Trong khi phần lớn các cách tiếp cận cơ bản là đưa ra dự đoán bằng cách sử dụng một phân phối hậu nghiệm Bayes đầy đủ với tham số  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2335">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">\boldsymbol{\theta}</script></span>, nhưng nhiều khi ta vẫn cần một ước lượng điểm tối ưu duy nhất. Lý do chính cho điều này là các phép toán liên quan đến hậu nghiệm Bayes đối với các mô hình thú vị nhất lại có chi phí tính toán vô cùng lớn, và một ước lượng điểm cho phép ta xấp xỉ với chi phí chấp nhận được. Để thu được ước lượng điểm như vậy, thay vì chỉ đưa ra một ước lượng hợp lý cực đại, ta có thể tận dụng phương pháp Bayes bằng cách dùng phân phối tiên nghiệm tác động đến việc lựa chọn điểm ước lượng. Một trong những cách thức phù hợp để thực hiện điều này là chọn ước lượng điểm có <strong>cực đại xác suất hậu nghiệm</strong> (maximum a posteriori - MAP). Ước lượng hậu nghiệm cực đại sẽ tìm ra một điểm mà tại đó xác suất hậu nghiệm đạt cực đại (hay là mật độ xác suất cực đại đối với trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2336"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2337">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">\boldsymbol{\theta}</script></span> liên tục):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2338"><span class="MJXp-mtable" id="MJXp-Span-2339"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2340" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2341" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2342"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2343" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2344" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">P</span></span></span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2349">arg</span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-2351"><span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2353" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2354">θ</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">p</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2358">θ</span><span class="MJXp-mtext" id="MJXp-Span-2359">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2360"><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2362">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2363">x</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2366">arg</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-2368"><span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2370" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2371">θ</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2372">log</span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">p</span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2377">x</span><span class="MJXp-mtext" id="MJXp-Span-2378">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2379"><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2381">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2382">θ</span><span class="MJXp-mo" id="MJXp-Span-2383" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-2385">log</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2387">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">p</span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2390">θ</span><span class="MJXp-mo" id="MJXp-Span-2391" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-178">\boldsymbol{\theta}_{MAP} = \arg \max_{\boldsymbol{\theta}}\  p(\boldsymbol{\theta}\ |\  \boldsymbol{x}) = \arg \max_{\boldsymbol{\theta}} \log\ p(\boldsymbol{x}\ |\ \boldsymbol{\theta}) + \log\ p(\boldsymbol{\theta})\tag{5.79}</script></span></p><p>Có thể thấy, ở vế phải của công thức, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2392"><span class="MJXp-mi" id="MJXp-Span-2393">log</span><span class="MJXp-mo" id="MJXp-Span-2394" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">p</span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2398">x</span><span class="MJXp-mrow" id="MJXp-Span-2399"><span class="MJXp-mo" id="MJXp-Span-2400" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2401">θ</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">\log\ p(\boldsymbol{x}|\boldsymbol{\theta})</script></span> chính là logarit của hàm hợp lý còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2403"><span class="MJXp-mi" id="MJXp-Span-2404">log</span><span class="MJXp-mo" id="MJXp-Span-2405" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407">p</span><span class="MJXp-mo" id="MJXp-Span-2408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2409">θ</span><span class="MJXp-mo" id="MJXp-Span-2410" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">\log\ p(\boldsymbol{\theta})</script></span> tương ứng với phân phối tiên nghiệm.</p><p>Xét ví dụ một mô hình hồi quy tuyến tính với tiên nghiệm là một phân phối chuẩn của trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2411"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2412">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">\boldsymbol{w}</script></span>. Nếu tiên nghiệm này có dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2413"><span class="MJXp-mrow" id="MJXp-Span-2414"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2415">N</span></span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2417">w</span><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-2419">0</span><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-2421" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2422">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">λ</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2424"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2425" style="margin-right: 0.05em;">I</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2426" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">\mathcal{N}(\boldsymbol{w};\boldsymbol{0},\frac{1}{\lambda}\boldsymbol{I}^2)</script></span> thì số hạng logarit của tiên nghiệm trong (5.79) sẽ trở thành đại lượng phạt suy giảm trọng số quen thuộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429">λ</span><span class="MJXp-msubsup" id="MJXp-Span-2430"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2431" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2432" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2433">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">\lambda \boldsymbol{w}^\intercal\boldsymbol{w}</script></span>, cộng thêm một đại lượng không phụ thuộc vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2435">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">\boldsymbol{w}</script></span> và đại lượng này sẽ không ảnh hưởng đến quá trình huấn luyện. Do đó, suy diễn ước lượng hậu nghiệm cực đại bằng phương pháp Bayes với trọng số tuân theo tiên nghiệm có phân phối chuẩn sẽ tương đương với phương pháp sử dụng suy giảm trọng số.</p><p>Tương tự với suy diễn Bayes đầy đủ, ưu điểm của suy diễn ước lượng hậu nghiệm cực đại bằng phương pháp Bayes là nó có thể tận dụng được những thông tin mà tiên nghiệm mang lại, đây là những thông tin không thể tìm thấy trong tập huấn luyện. Những thông tin bổ sung này giúp giảm phương sai của ước lượng điểm hậu nghiệm cực đại (so với ước lượng hợp lý cực đại). Tuy nhiên, cái giá phải trả là độ chệch sẽ tăng lên.</p><p>Ngoài ra, có nhiều phương pháp ước lượng sử dụng cơ chế kiểm soát, chẳng hạn như ước lượng hợp lý cực đại sử dụng suy giảm trọng số, có thể được diễn giải dưới dạng xấp xỉ ước lượng hậu nghiệm cực đại trong suy diễn Bayes. Quan điểm này có thể áp dụng khi cơ chế kiểm soát bao gồm việc cộng thêm vào hàm mục tiêu một đại lượng tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-mi" id="MJXp-Span-2437">log</span><span class="MJXp-mo" id="MJXp-Span-2438" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2439" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2440">θ</span><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">\log(\boldsymbol{\theta})</script></span>. Tuy nhiên, không phải mọi mức phạt của cơ chế kiểm soát đều tương đương với suy diễn ước lượng hậu nghiệm cực đại bằng phương pháp Bayes. Ví dụ, một số đại lượng kiểm soát có thể không phải là logarit của phân phối xác suất. Một số đại lượng kiểm soát khác lại phụ thuộc vào dữ liệu, rõ ràng phân phối xác suất tiên nghiệm không thể thoả mãn điều này.</p><p>Suy diễn ước lượng hậu nghiệm cực đại bằng phương pháp Bayes cung cấp một phương pháp đơn giản để thiết kế những đại lượng kiểm soát phức tạp, nhưng có thể diễn giải được. Ví dụ, một mức phạt phức tạp hơn có thể được suy ra từ tiên nghiệm là hỗn hợp các phân phối chuẩn thay vì chỉ là một phân phối chuẩn duy nhất [Nowlan and Hilton, 1992].</p><h1 id="57-Các-thuật-toán-học-có-giám-sát"><a class="anchor hidden-xs" href="#57-Các-thuật-toán-học-có-giám-sát" title="57-Các-thuật-toán-học-có-giám-sát"><span class="octicon octicon-link"></span></a>5.7 Các thuật toán học có giám sát</h1><p>Như đã được thảo luận trong phần 5.1.3, các thuật toán học có giám sát, nói chung, là các thuật toán học được mối liên kết giữa một đầu vào và một đầu ra, khi biết một tập huấn luyện bao gồm tập các mẫu dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2442"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2443">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">\boldsymbol{x}</script></span> và đầu ra tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2444"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2445">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">\boldsymbol{y}</script></span>. Trong nhiều trường hợp, việc tự động thu thập đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2446"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2447">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\boldsymbol{y}</script></span> là rất khó khăn và buộc phải được cung cấp bởi một người “giám sát”, tuy vậy thuật ngữ “học có giám sát” vẫn được sử dụng kể cả trong trường hợp nhãn huấn luyện được thu thập hoàn toàn tự động.</p><h2 id="571-Học-có-giám-sát-dựa-trên-xác-suất"><a class="anchor hidden-xs" href="#571-Học-có-giám-sát-dựa-trên-xác-suất" title="571-Học-có-giám-sát-dựa-trên-xác-suất"><span class="octicon octicon-link"></span></a>5.7.1 Học có giám sát dựa trên xác suất</h2><p>Phần lớn các thuật toán học có giám sát được giới thiệu trong quyển sách này dựa trên việc ước lượng một phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">p</span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">y</span><span class="MJXp-mrow" id="MJXp-Span-2452"><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2454">x</span><span class="MJXp-mo" id="MJXp-Span-2455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">p(y|\boldsymbol{x})</script></span>. Chúng ta có thể làm việc này đơn giản bằng cách sử dụng ước lượng hợp lý cực đại để tìm ra vector tham số tốt nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2456"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2457">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">\boldsymbol{\theta}</script></span> cho họ phân phối có tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">p</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">y</span><span class="MJXp-mrow" id="MJXp-Span-2462"><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2464">x</span><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2466">θ</span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">p(y|\boldsymbol{x};\boldsymbol{\theta})</script></span>.</p><p>Ta đã biết rằng hồi quy tuyến tính cũng thuộc họ</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2468"><span class="MJXp-mtable" id="MJXp-Span-2469"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2470" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2471" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">p</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">y</span><span class="MJXp-mtext" id="MJXp-Span-2475">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2476"><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2478">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2479">x</span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2481">θ</span><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2485">N</span></span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487">y</span><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-2489"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2490" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2491" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2492">x</span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2494">I</span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-192">p(y\ |\ \boldsymbol{x};\boldsymbol{\theta}) = \mathcal{N}(y;\boldsymbol{\theta}^\intercal\boldsymbol{x},\boldsymbol{I}). \tag{5.80}</script></span></p><p>Ta có thể tổng quát hóa hồi quy tuyến tính để phục vụ bài toán phân loại bằng cách định nghĩa một họ các phân phối xác suất khác. Nếu chỉ có hai lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2497"><span class="MJXp-mn" id="MJXp-Span-2498">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2499"><span class="MJXp-mn" id="MJXp-Span-2500">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">1</script></span>, ta chỉ cần chỉ định xác suất của một trong hai lớp. Xác suất của lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-mn" id="MJXp-Span-2502">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">1</script></span> xác định xác suất của lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2503"><span class="MJXp-mn" id="MJXp-Span-2504">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">0</script></span>, bởi vì tổng của hai giá trị này luôn luôn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2505"><span class="MJXp-mn" id="MJXp-Span-2506">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">1</script></span>.</p><p>Phân phối chuẩn đối với các biến thực mà chúng ta đã dùng cho hồi quy tuyến tính được tham số hóa theo một đại lượng trung bình. Ta có thể gán bất kỳ giá trị nào cho đại lượng trung bình này. Xây dựng một phân phối đối với các biến nhị phân thì không đơn giản như vậy, vấn đề phát sinh là trung bình của chúng luôn phải nằm giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2507"><span class="MJXp-mn" id="MJXp-Span-2508">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2509"><span class="MJXp-mn" id="MJXp-Span-2510">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">1</script></span>. Một cách giải quyết vấn đề này đó là sử dụng hàm logit chữ S để ép đầu ra của hàm tuyến tính thành nằm trong khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2511"><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2513">0</span><span class="MJXp-mo" id="MJXp-Span-2514" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2515">1</span><span class="MJXp-mo" id="MJXp-Span-2516" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">(0,1)</script></span> và coi giá trị này như một xác suất:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2517"><span class="MJXp-mtable" id="MJXp-Span-2518"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2519" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2520" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">p</span><span class="MJXp-mo" id="MJXp-Span-2522" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">y</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2525">1</span><span class="MJXp-mtext" id="MJXp-Span-2526">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2527"><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2529">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2530">x</span><span class="MJXp-mo" id="MJXp-Span-2531" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2532">θ</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">σ</span><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2538" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2539" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2540">x</span><span class="MJXp-mo" id="MJXp-Span-2541" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-201">p(y=1\ |\ \boldsymbol{x};\boldsymbol{\theta}) = \sigma(\boldsymbol{\theta}^\intercal\boldsymbol{x})\tag{5.81}</script></span></p><p>Cách tiếp cận này được gọi là <strong>hồi quy logit</strong> (logistic regression).</p><p>Trong trường hợp hồi quy tuyến tính, ta có thể tìm được trọng số tối ưu bằng cách giải các phương trình chuẩn. Với hồi quy logit, mọi việc khó khăn hơn một chút. Không có một lời giải dạng đóng nào cho trọng số tối ưu. Thay vào đó, ta phải tìm nó bằng cách tối đa hóa logarit của hàm hợp lý. Ta có thể tìm các trọng số này bằng cách sử dụng trượt gradient để tối thiểu hóa đối số của logarit hàm hợp lý.</p><p>Về cơ bản, mọi bài toán học có giám sát đều có thể giải quyết bởi cùng một chiến lược như trên, bằng cách viết ra họ tham số trong phân phối xác suất có điều kiện đối với biến đầu vào và đầu ra phù hợp.</p><h2 id="572-Máy-vector-hỗ-trợ"><a class="anchor hidden-xs" href="#572-Máy-vector-hỗ-trợ" title="572-Máy-vector-hỗ-trợ"><span class="octicon octicon-link"></span></a>5.7.2 Máy vector hỗ trợ</h2><p>Một trong những phương pháp có ảnh hưởng nhất trong học có giám sát là <em>máy vector hỗ trợ</em> (Support Vector Machine - SVM) [Boser et al., 1992; Cortes and Vapnik, 1995]. Giống như hồi quy logit, mô hình này cũng được định hướng bởi một hàm tuyến tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2542"><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2544" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2545" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2546">x</span><span class="MJXp-mo" id="MJXp-Span-2547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">\boldsymbol{w}^\intercal\boldsymbol{x}+b</script></span>. Nhưng khác với hồi quy logit ở chỗ đầu ra cùa máy vector hỗ trợ không phải là xác suất, mà chỉ là định danh của lớp. Máy vector hỗ trợ dự đoán rằng đó là lớp dương khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2549"><span class="MJXp-msubsup" id="MJXp-Span-2550"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2551" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2552" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2553">x</span><span class="MJXp-mo" id="MJXp-Span-2554" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">\boldsymbol{w}^\intercal\boldsymbol{x}+b</script></span> là dương, và là lớp âm khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2556"><span class="MJXp-msubsup" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2558" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2559" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2560">x</span><span class="MJXp-mo" id="MJXp-Span-2561" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">\boldsymbol{w}^\intercal\boldsymbol{x}+b</script></span> là âm.</p><p>Một trong những phát kiến quan trọng nhất liên quan tới máy vector hỗ trợ đó là <strong>thủ thuật chọn hàm lõi</strong> (kernel trick). Thủ thuật chọn hàm lõi bắt nguồn từ nhận xét rằng rất nhiều các thuật toán học máy có thể chỉ cần viết dưới dạng tích vô hướng giữa các mẫu dữ liệu. Ví dụ, ta có thể chứng minh rằng hàm tuyến tính được dùng trong máy vector hỗ trợ có thể viết lại như sau</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2563"><span class="MJXp-mtable" id="MJXp-Span-2564"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2565" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2566" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2567"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2568" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2569" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2570">x</span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572">b</span><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574">b</span><span class="MJXp-mo" id="MJXp-Span-2575" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2576"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2582" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2583">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2578" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">i</span><span class="MJXp-mo" id="MJXp-Span-2580">=</span><span class="MJXp-mn" id="MJXp-Span-2581">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2586" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-2587"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2588" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2589" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2590"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2591" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2592" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2593">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594">i</span><span class="MJXp-mo" id="MJXp-Span-2595">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-205">\boldsymbol{w}^\intercal\boldsymbol{x}+b = b + \sum^{m}_{i=1}\alpha_i\boldsymbol{x}^\intercal \boldsymbol{x}^{(i)},\tag{5.82}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2597"><span class="MJXp-msubsup" id="MJXp-Span-2598"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2599" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2600" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2601">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2602">i</span><span class="MJXp-mo" id="MJXp-Span-2603">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">\boldsymbol{x}^{(i)}</script></span> là một mẫu huấn luyện và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">\alpha</script></span> là vector hệ số. Viết lại thuật toán học tập  theo cách này cho phép ta thay thế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2606"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2607">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">\boldsymbol{x}</script></span> bằng đầu ra của một hàm đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2611">x</span><span class="MJXp-mo" id="MJXp-Span-2612" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">\phi(\boldsymbol{x})</script></span>, và toàn bộ phép tích vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2613"><span class="MJXp-msubsup" id="MJXp-Span-2614"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2615" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2616" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-2617"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2618" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2619" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2620">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">i</span><span class="MJXp-mo" id="MJXp-Span-2622">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">\boldsymbol{x}^\intercal \boldsymbol{x}^{(i)}</script></span> bằng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2624">k</span><span class="MJXp-mo" id="MJXp-Span-2625" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2626">x</span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2629" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2630" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2631">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">i</span><span class="MJXp-mo" id="MJXp-Span-2633">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2635" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2636">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2637" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2638">x</span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2643"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2644" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2645" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2646">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">i</span><span class="MJXp-mo" id="MJXp-Span-2648">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2649" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">k(\boldsymbol{x},\boldsymbol{x}^{(i)}) = \phi(\boldsymbol{x})\cdot\phi(\boldsymbol{x}^{(i)})</script></span> gọi là <strong>hàm lõi</strong> (kernel function). Toán tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2650"><span class="MJXp-mo" id="MJXp-Span-2651" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">\cdot</script></span> biểu thị một phép nhân vô hướng, tương đương với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2655">x</span><span class="MJXp-msubsup" id="MJXp-Span-2656"><span class="MJXp-mo" id="MJXp-Span-2657" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2658" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2661"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2662" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2663" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2664">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665">i</span><span class="MJXp-mo" id="MJXp-Span-2666">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">\phi(\boldsymbol{x})^\intercal\phi(\boldsymbol{x}^{(i)})</script></span>. Trong một vài không gian đặc trưng, không phải lúc nào phép nhân vector vô hướng cũng được thực hiện theo định nghĩa. Trong không gian vô hạn chiều, ta buộc phải sử dụng một số kiểu nhân vô hướng khác, ví dụ như nhân vô hướng dựa trên phép tích phân thay vì phép cộng. Chi tiết cụ thể của các phép nhân vô hướng kiểu này nằm ngoài phạm vi của sách.</p><p>Sau khi thay thế phép tích vô hướng bằng hàm lõi, ta có thể đưa ra dự đoán bằng cách sử dụng hàm</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2668"><span class="MJXp-mtable" id="MJXp-Span-2669"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2670" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2671" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672">f</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2674">x</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2676" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677">b</span><span class="MJXp-mo" id="MJXp-Span-2678" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2679"><span><span class="MJXp-mo" id="MJXp-Span-2680" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2681" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2682">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2685" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2686">k</span><span class="MJXp-mo" id="MJXp-Span-2687" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2688">x</span><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2690"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2691" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2692" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2693">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694">i</span><span class="MJXp-mo" id="MJXp-Span-2695">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2696" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-214">f(\boldsymbol{x})=b+\sum_{i}\alpha_ik(\boldsymbol{x},\boldsymbol{x}^{(i)}) \tag{5.83}</script></span></p><p>Đối với biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2697"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2698">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">\boldsymbol{x}</script></span> thì đây là một hàm phi tuyến tính, nhưng mối quan hệ giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2701" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2702">x</span><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">\phi(\boldsymbol{x})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705">f</span><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2707">x</span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">f(\boldsymbol{x})</script></span> là tuyến tính. Hàm lõi tương đương với việc tiền xử lý dữ liệu bằng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2712">x</span><span class="MJXp-mo" id="MJXp-Span-2713" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">\phi(\boldsymbol{x})</script></span>, sau đó học một mô hình tuyến tính trên không gian dữ liệu mới.</p><p>Thủ thuật chọn hàm lõi là một công cụ mạnh mẽ bởi hai lý do. Thứ nhất, nó cho phép ta học một mô hình phi tuyến tính đối với biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2714"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2715">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\boldsymbol{x}</script></span> sử dụng các kỹ thuật tối ưu lồi để đảm bảo thủ tục học sẽ hội tụ nhanh. Ta có thể thực hiện điều này bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2719">x</span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">\phi(\boldsymbol{x})</script></span> là cố định và ta chỉ cần tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2721"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2722">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">\boldsymbol{\alpha}</script></span>, tức là, thuật toán tối ưu coi hàm quyết định là tuyến tính trong một không gian khác. Thứ hai, hàm lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">k</script></span> cho phép một cài đặt hiệu quả hơn đáng kể về mặt tính toán so với chỉ đơn giản là xây dựng hai vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2727" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2728">x</span><span class="MJXp-mo" id="MJXp-Span-2729" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">\phi(\boldsymbol{x})</script></span> rồi tiến hành lấy tích vô hướng (phương pháp tuần tự).</p><p>Trong một số trường hợp, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2732" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2733">x</span><span class="MJXp-mo" id="MJXp-Span-2734" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">\phi(\boldsymbol{x})</script></span> có thể có số chiều vô hạn, dẫn đến việc chi phí tính toán của các phương pháp thực hiện tuần tự cũng là vô hạn. Trong nhiều trường hợp, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736">k</span><span class="MJXp-mo" id="MJXp-Span-2737" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2738">x</span><span class="MJXp-mo" id="MJXp-Span-2739" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2740"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2741" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2742" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2743" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">k(\boldsymbol{x},\boldsymbol{x}^\prime)</script></span> là một hàm phi tuyến tính và có chi phí tính toán nhỏ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2744"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2745">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">\boldsymbol{x}</script></span>, ngay cả khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2748" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2749">x</span><span class="MJXp-mo" id="MJXp-Span-2750" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\phi(\boldsymbol{x})</script></span> có chi phí tính toán cực lớn. Xét ví dụ một không gian đặc trưng vô hạn chiều với một hàm lõi dễ tính toán, chúng ta xây dựng một hàm ánh xạ đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754">x</span><span class="MJXp-mo" id="MJXp-Span-2755" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">\phi(x)</script></span> đối với các số nguyên không âm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2757">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">x</script></span>. Ánh xạ này trả về một vector gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">x</script></span> giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2760"><span class="MJXp-mn" id="MJXp-Span-2761">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">1</script></span> và theo sau là vô hạn giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2762"><span class="MJXp-mn" id="MJXp-Span-2763">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">0</script></span>. Hàm lõi có thể viết thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">k</span><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">x</span><span class="MJXp-mo" id="MJXp-Span-2768" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2771" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2772">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">i</span><span class="MJXp-mo" id="MJXp-Span-2774">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2776" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2777" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779">x</span><span class="MJXp-mo" id="MJXp-Span-2780" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2783" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2784">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2785">i</span><span class="MJXp-mo" id="MJXp-Span-2786">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2787" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">k(x,x^{(i)}) = \min(x,x^{(i)})</script></span>, hoàn toàn tương đương với tích vô hướng tương ứng của hai vector có số chiều vô hạn.</p><p>Hàm lõi được sử dụng nhiều nhất là <strong>lõi Gauss</strong> (Gaussian kernel):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2788"><span class="MJXp-mtable" id="MJXp-Span-2789"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2790" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2791" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">k</span><span class="MJXp-mo" id="MJXp-Span-2793" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2794">u</span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2796">v</span><span class="MJXp-mo" id="MJXp-Span-2797" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2798" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2799"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2800">N</span></span><span class="MJXp-mo" id="MJXp-Span-2801" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2802">u</span><span class="MJXp-mo" id="MJXp-Span-2803" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2804">v</span><span class="MJXp-mo" id="MJXp-Span-2805" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-2806">0</span><span class="MJXp-mo" id="MJXp-Span-2807" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2810" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2811">I</span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2813" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-234">k(\boldsymbol{u},\boldsymbol{v})=\mathcal{N}(\boldsymbol{u}-\boldsymbol{v}; 0,\sigma^2\boldsymbol{I}),\tag{5.84} </script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2814"><span class="MJXp-mrow" id="MJXp-Span-2815"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2816">N</span></span><span class="MJXp-mo" id="MJXp-Span-2817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2818">x</span><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2820">μ</span><span class="MJXp-mo" id="MJXp-Span-2821" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2822">Σ</span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">\mathcal{N}(\boldsymbol{x}; \boldsymbol{\mu},\boldsymbol{\Sigma})</script></span> chính là mật độ của phân phối chuẩn. Hàm lõi này còn được gọi là lõi <em>hàm cơ sở xuyên tâm</em> (radial basis function - RBF), bởi vì bởi vì giá trị của nó giảm dọc theo các tia trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2825">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">\boldsymbol{v}</script></span> bắt nguồn từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2827">u</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">\boldsymbol{u}</script></span>. Lõi Gauss tương ứng với một phép tích vô hướng trong một không gian vô hạn chiều, tuy nhiên việc tìm ra không gian này phức tạp hơn không gian trong ví dụ về lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2830">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">min</script></span> với các số nguyên đã được giới thiệu ở trên.</p><p>Có thể xem lõi Gauss như một loại <strong>khớp bản mẫu</strong> (template matching). Một mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2832"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2833">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">\boldsymbol{x}</script></span> với nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">y</script></span> trở thành một bản mẫu cho lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">y</script></span>. Khi một điểm dữ liệu kiểm thử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2838"><span class="MJXp-msubsup" id="MJXp-Span-2839"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2840" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2841" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\boldsymbol{x}^\prime</script></span> gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2843">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">\boldsymbol{x}</script></span> theo khoảng cách Euclid, lõi Gauss có một phản hồi mạnh, biểu thị rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2844"><span class="MJXp-msubsup" id="MJXp-Span-2845"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2846" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2847" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">\boldsymbol{x}^\prime</script></span> rất tương đồng với bản mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2848"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2849">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">\boldsymbol{x}</script></span>. Sau đó, mô hình gán một trọng số lớn cho nhãn huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">y</script></span> tương ứng. Sau cùng, dự đoán sẽ là kết hợp của nhiều nhãn huấn luyện, được đánh trọng số theo độ tương tự của các mẫu huấn luyện tương ứng.</p><p>Máy vector hỗ trợ không phải thuật toán duy nhất được tăng cường sức mạnh nhờ thủ thuật chọn hàm lõi. Rất nhiều mô hình tuyến tính cũng có thể được cải thiện bằng kỹ thuật này.Tất cả các thuật toán sử dụng thủ thuật chọn hàm lõi đều được gọi chung là <strong>máy lõi</strong> (kernel machine) hay <strong>phương pháp lõi</strong> (kernel method) [Williams and Rasmussen, 1996; Schölkopf et al., 1999].</p><p>Một nhược điểm lớn của các máy lõi nói chung đó là chi phí tính toán hàm quyết định là tuyến tính theo số lượng mẫu dữ liệu huấn luyện bởi vì mẫu huấn luyện thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">i</script></span> của tập huấn luyện sẽ đóng góp một lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2854"><span class="MJXp-msubsup" id="MJXp-Span-2855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2857" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858">k</span><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2860">x</span><span class="MJXp-mo" id="MJXp-Span-2861" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2862"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2863" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2864" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2865">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">i</span><span class="MJXp-mo" id="MJXp-Span-2867">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">\alpha_ik(\boldsymbol{x},\boldsymbol{x}^{(i)})</script></span> vào hàm quyết định. Máy vector hỗ trợ có thể giảm thiểu điều này bằng cách học ra một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2869"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2870">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">\boldsymbol{\alpha}</script></span> với phần lớn phần tử có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2871"><span class="MJXp-mn" id="MJXp-Span-2872">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">0</script></span>. Để phân loại một mẫu dữ liệu mới, ta chỉ cần tính hàm lõi cho các mẫu huấn luyện tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2873"><span class="MJXp-msubsup" id="MJXp-Span-2874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2876" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">\alpha_i</script></span> khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2877"><span class="MJXp-mn" id="MJXp-Span-2878">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">0</script></span>. Các mẫu huấn luyện như vậy được gọi là các <strong>vector hỗ trợ</strong> (support vector).</p><p>Các máy lõi cũng có chi phí tính toán lớn khi tập dữ liệu huấn luyện lớn. Chúng tôi sẽ trở lại với vấn đề này ở mục 5.9. Các máy lõi với các hàm lõi chung gặp khó khăn trong việc khái quát hóa dữ liệu, với lý do ở sẽ được giải thích ở phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2879"><span class="MJXp-mn" id="MJXp-Span-2880">5.11</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">5.11</script></span>. Nguyên dạng của học sâu hiện đại ban đầu được thiết kế để vượt qua những nhược điểm của máy lõi như đã nêu. Sự phục hưng của học sâu bắt nguồn từ khi Hilton và cộng sự (2006) chứng minh rằng mạng neuron có thể vượt qua hiệu suất của máy vector hỗ trợ với hàm lõi là hàm cơ sở xuyên tâm trong bài toán MNIST.</p><h2 id="573-Các-thuật-toán-học-có-giám-sát-đơn-giản-khác"><a class="anchor hidden-xs" href="#573-Các-thuật-toán-học-có-giám-sát-đơn-giản-khác" title="573-Các-thuật-toán-học-có-giám-sát-đơn-giản-khác"><span class="octicon octicon-link"></span></a>5.7.3 Các thuật toán học có giám sát đơn giản khác</h2><p>Chúng tôi đã từng giới thiệu một cách ngắn gọn về một thuật toán học có giám sát khác không dựa trên xác suất, đó là hồi quy điểm gần nhất. Tổng quát hơn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">k</script></span> điểm gần nhất có thể được sử dụng cho cả hai bài toán: phân lớp và hồi quy. Là một thuật toán học phi tham số, thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">k</script></span> điểm gần nhất không bị hạn chế bởi một số lượng tham số cố định. Chúng ta nhắc đến thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">k</script></span> điểm gần nhất vì nó mang tính chất không có tham số thay vì là thuật toán thực thi một hàm đơn giản của dữ liệu huấn luyện.  Trong thực tế, thuật toán này thậm chí còn không có quá trình huấn luyện hoặc một tiến trình học nào cả. Thay vào đó, ở giai đoạn kiểm thử, khi muốn tìm đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">y</script></span> của một mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2889"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2890">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">\boldsymbol{x}</script></span> mới, ta sẽ tìm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">k</script></span> điểm gần nhất của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2893"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2894">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">\boldsymbol{x}</script></span> trong tập dữ liệu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2895"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2896">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">\boldsymbol{X}</script></span>. Đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2898">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-262">y</script></span> của thuật toán chính là giá trị trung bình của các đầu ra ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">k</script></span> điểm gần nhất vừa tìm được. Thuật toán này về cơ bản là có thể áp dụng cho bất kỳ loại bài toán học có giám sát nào mà ta xác định được giá trị trung bình của các giá trị đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">y</script></span>. Trong bài toán phân lớp, chúng ta có thể lấy giá trị trung bình thông qua các vector <em>mã hóa đơn trội</em> (one-hot code) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2903"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2904">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-265">\boldsymbol{c}</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2905"><span class="MJXp-msubsup" id="MJXp-Span-2906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2908" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2909" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2910">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">c_y = 1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2911"><span class="MJXp-msubsup" id="MJXp-Span-2912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2914" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2915" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2916">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">c_i = 0</script></span> với tất cả các giá trị khác của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-268-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-268">i</script></span>. Sau đó, ta có thể diễn giải mã hóa đơn trội như là phân phối xác suất của các lớp. Là một thuật toán học không tham số, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-269">k</script></span> điểm gần nhất có thể có dung lượng lớn. Chẳng hạn, giả sử rằng có một bài toán phân loại đa lớp và một thang đo hiệu năng với hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2921"><span class="MJXp-mn" id="MJXp-Span-2922">0</span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2924">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-270">0-1</script></span>. Trong thiết lập này, thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2925"><span class="MJXp-mn" id="MJXp-Span-2926">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-271">1</script></span>-điểm gần nhất hội tụ tới giá trị gấp đôi sai số Bayes khi số lượng các mẫu trong tập huấn luyện tiến tới vô cùng. Phần sai số vượt quá sai số Bayes gây bởi việc chọn ngẫu nhiên duy nhất một lân cận trong trường hợp có nhiều điểm cùng là điểm gần nhất. Khi tập huấn luyện là vô hạn, mọi điểm dữ liệu kiểm thử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2927"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2928">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-272">\boldsymbol{x}</script></span> sẽ có một tập vô số các lân cận có khoảng cách bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2929"><span class="MJXp-mn" id="MJXp-Span-2930">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-273-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-273">0</script></span>. Nếu chúng ta cho phép thuật toán sử dụng tất cả những lân cận này tham gia bình chọn giá trị đầu ra của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2931"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2932">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-274">\boldsymbol{x}</script></span> thay vì chọn ngẫu nhiên một trong số những lân cận đó, thì thủ tục này sẽ hội tụ tới tỉ lệ sai số Bayes. Dung lượng lớn của mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-275-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-275">k</script></span> điểm gần nhất cho phép thuật toán đạt được độ chính xác cao với một tập huấn luyện lớn, nhưng cũng là nguyên nhân khiến nó có chi phí tính toán lớn, và khả năng tổng quát hóa có thể rất tệ khi tập huấn luyện là hữu hạn. Một điểm yếu của thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-276">k</script></span> điểm gần nhất là nó không thể nhận biết được liệu có đặc trưng nào có tính phân biên rõ ràng hơn đặc trưng khác. Ví dụ, hãy tưởng tượng chúng ta có một bài toán hồi quy với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2937"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2938">x</span><span class="MJXp-mo" id="MJXp-Span-2939" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-2940"><span class="MJXp-mrow" id="MJXp-Span-2941" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2942">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2943" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-2944">100</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-277">\boldsymbol{x} \in \mathbb{R}^{100}</script></span> lấy ngẫu nhiên từ một phân phối Gauss đẳng hướng, nhưng chỉ có một biến duy nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2945"><span class="MJXp-msubsup" id="MJXp-Span-2946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2948" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-278">x_1</script></span> có liên quan đến đầu ra. Giả sử rằng biến này trực tiếp mã hóa đầu ra, nghĩa là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">y</span><span class="MJXp-mo" id="MJXp-Span-2951" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2954" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-279-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-279">y = x_1</script></span> trong mọi trường hợp. Hồi quy điểm gần nhất không thể phát hiện được mô hình đơn giản này. Điểm gần nhất của hầu hết các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2955"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2956">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-280">\boldsymbol{x}</script></span> sẽ được xác định bởi các đặc trưng từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2957"><span class="MJXp-msubsup" id="MJXp-Span-2958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2960" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-281">x_2</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2961"><span class="MJXp-msubsup" id="MJXp-Span-2962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2964" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2965">100</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-282">x_{100}</script></span>, chứ không phải bởi duy nhất đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2966"><span class="MJXp-msubsup" id="MJXp-Span-2967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2968" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2969" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-283">x_1</script></span>. Do đó, đầu ra của thuật toán đối với các tập huấn luyện nhỏ về cơ bản sẽ là ngẫu nhiên.</p><p>Một loại thuật toán học tập khác có thể chia nhỏ dữ liệu đầu vào thành các vùng và có các tham số riêng biệt cho mỗi vùng được gọi là <strong>cây quyết định</strong> (decision tree) [Breiman et al., 1984] và nhiều biến thể của nó. Như được mô tả trong hình 5.7, mỗi nút của cây quyết định được liên kết với một vùng trong không gian đầu vào, và các <em>nút trong</em> (internal node) chia nhỏ vùng đó thành một tiểu vùng cho mỗi nút con của nút trong đó (thường bằng cách sử dụng lát cắt dọc theo trục). Do đó, không gian được phân chia thành các vùng không chồng lấn, với sự tương quan một-một giữa các nút lá và các vùng đầu vào. Mỗi nút lá thường ánh xạ mọi điểm trong vùng đầu vào của nó tới cùng một đầu ra. Cây quyết định thường được huấn luyện bằng các thuật toán chuyên biệt, nhưng phần này nằm ngoài phạm vi của cuốn sách. Thuật toán học tập này có thể được coi là phi tham số nếu nó được phép học một cây với kích thước tùy ý. Nhưng trong thực tế, cây quyết định thường được kiểm soát với các ràng buộc về kích thước, biến chúng thành các mô hình có tham số. Ta thường sử dụng các cây quyết định có các lát cắt dọc trục và đầu ra không đổi bên trong mỗi nút. Các cây này gặp khó khăn trong quyết một số bài toán dễ dàng, ngay cả đối với hồi quy logit. Ví dụ, chúng ta có một bài toán hai lớp, và lớp dương tương ứng với trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2970"><span class="MJXp-msubsup" id="MJXp-Span-2971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2973" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2974" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-2975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2976" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2977" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-284-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-284">x_2 > x_1</script></span>, ranh giới quyết định không song song với các trục. Do đó cây quyết định sẽ phải ước lượng biên quyết định thông qua nhiều nút, bằng việc cài đặt một hàm bước nhảy, đi qua đi lại hàm quyết định thực sự bằng các bước dọc theo trục.</p><p>Như ta đã thấy, các thuật toán dự đoán thông qua điểm gần nhất và cây quyết định có nhiều khuyết điểm. Tuy nhiên, chúng lại hữu ích khi tài nguyên tính toán bị hạn chế. Ta cũng có thể hiểu một cách trực quan về các thuật toán phức tạp hơn bằng những điểm giống và khác nhau giữa những thuật toán phức tạp và các thuật toán cơ sở như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2979">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-285">k</script></span> điểm gần nhất hoặc cây quyết định.</p><p>Bạn đọc có thể tham khảo Murphy (2012), Bishop (2006), Hastie et al. (2001) hoặc các cuốn sách  về học máy khác để biết hiểu rõ hơn về các thuật toán học có giám sát truyền thống.</p><p><img src="https://i.imgur.com/8Z6CCag.png" alt=""></p><blockquote>
<p>Hình 5.7: Lược đồ mô tả cách thức hoạt động của cây quyết định. (<em>Hình phía trên</em>) Mỗi nút của cây chọn đầu vào để gửi cho nút con của nó: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2980"><span class="MJXp-mn" id="MJXp-Span-2981">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-286">0</script></span> ở nút trái và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-mn" id="MJXp-Span-2983">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-287">1</script></span> ở nút phải. Các nút trong được vẽ bằng hình tròn, và hình vuông đối với các nút lá. Mỗi nút được hiển thị bằng một chuỗi nhị phân tương ứng với vị trí của nó trong cây, thu được bằng việc thêm một bit vào chuỗi nhị phân định dạng của nút cha (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2984"><span class="MJXp-mn" id="MJXp-Span-2985">0</span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-288">0 =</script></span> cho nút trái, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2987"><span class="MJXp-mn" id="MJXp-Span-2988">1</span><span class="MJXp-mo" id="MJXp-Span-2989" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-289">1 =</script></span> cho nút phải). (<em>Hình phía dưới</em>) Cây phân chia không gian thành các vùng. Mặt phẳng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2990"><span class="MJXp-mn" id="MJXp-Span-2991">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-290">2</script></span> chiều này chỉ ra cách một cây quyết định có thể phân chia không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2992"><span class="MJXp-msubsup" id="MJXp-Span-2993"><span class="MJXp-mrow" id="MJXp-Span-2994" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2995">R</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2996" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-291">\mathbb{R}^2</script></span>. Các nút của cây được vẽ trong mặt phẳng, với mỗi nút trong được vẽ dọc theo đường phân chia mà nó sử dụng để phân loại các mẫu, và các nút lá được vẽ ở trung tâm của vùng các mẫu dữ liệu mà chúng nhận. Kết quả của sự phân chia trên là một hàm hằng số từng phần, mỗi phần tương ứng một lá. Mỗi lá yêu cầu ít nhất một mẫu huấn luyện để xác định, vì vậy cây quyết định không thể học một hàm mà có nhiều cực đại địa phương hơn số lượng các mẫu huấn luyện.</p>
</blockquote><h1 id="58-Các-thuật-toán-học-không-giám-sát"><a class="anchor hidden-xs" href="#58-Các-thuật-toán-học-không-giám-sát" title="58-Các-thuật-toán-học-không-giám-sát"><span class="octicon octicon-link"></span></a>5.8 Các thuật toán học không giám sát</h1><p>Ta đã biết trong phần 5.1.3 rằng các thuật toán không giám sát là những thuật toán chỉ dựa trên những “đặc trưng” chứ không phải một tín hiệu giám sát. Sự khác biệt giữa thuật toán có giám sát và không giám sát không được định nghĩa một cách hình thức và rõ ràng, bởi không có một phép thử khách quan nào để phân biệt liệu một giá trị là một đặc trưng hay là một nhãn được cung cấp bởi giám sát viên. Nói một cách nôm na, học không giám sát đề cập đến hầu hết các nỗ lực để trích xuất thông tin từ một phân phối mà không yêu cầu nhân lực để gán nhãn các mẫu. Thuật ngữ này thường được kết hợp với vấn đề ước lượng mật độ, với mục đích học để lấy mẫu từ một phân phối, học để khử nhiễu dữ liệu sinh bởi một số phân phối nào đó, tìm kiếm một một mô phỏng gần giống với dữ liệu, hoặc phân cụm dữ liệu thành các nhóm các mẫu có liên quan với nhau.</p><p>Một bài toán học không giám sát cổ điển là xác định biểu diễn “tốt nhất” của dữ liệu. Cụm từ “tốt nhất” có thể mang nhiều nghĩa khác nhau, nhưng nói chung chúng ta đang tìm kiếm một cách biểu diễn bảo tồn nhiều thông tin của mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2997"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2998">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-292">\boldsymbol{x}</script></span> nhất có thể, trong khi tuân theo một số mức phạt hoặc ràng buộc nhằm đảm bảo rằng biểu diễn này đơn giản hơn hoặc dễ tiếp cận hơn chính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2999"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3000">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-293">\boldsymbol{x}</script></span>.</p><p>Có nhiều cách để xác định một dạng biểu diễn đơn giản hơn. Ba trong số những cách thông dụng nhất bao gồm biểu diễn với số chiều nhỏ hơn, biểu diễn thưa và biểu diễn độc lập. Phép biểu diễn với số chiều nhỏ hơn cố gắng nén nhiều thông tin nhất có thể của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3001"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3002">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-294">\boldsymbol{x}</script></span> trong một biểu diễn nhỏ hơn. Các biểu diễn thưa [Barlow, 1989; Olshausen and Field, 1996; Hinton and Ghahramani, 1997] nhúng tập dữ liệu vào một biểu diễn mà hầu hết các phần tử của nó có giá trị bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3003"><span class="MJXp-mn" id="MJXp-Span-3004">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-295-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-295">0</script></span>. Việc sử dụng các biểu diễn thưa thường đòi hỏi việc gia tăng kích thước của biểu diễn, với mục đích không bỏ qua quá nhiều thông tin khi phần lớn các giá trị của biểu diễn có giá trị bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3005"><span class="MJXp-mn" id="MJXp-Span-3006">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-296">0</script></span>. Điều này dẫn đến cấu trúc tổng thể của nó có xu hướng phân phối dữ liệu dọc theo các trục của không gian biểu diễn. Cuối cùng, các biểu diễn độc lập cố gắng phân tách các nguồn gây ra sự biến đổi đằng sau phân phối dữ liệu sao cho các chiều của biểu diễn là độc lập về mặt thống kê.</p><p>Tất nhiên, ba tiêu chí này chắc chắn không loại trừ lẫn nhau. Các biểu diễn với số chiều nhỏ hơn thường tạo ra các phần tử có sự phụ thuộc kém hoặc yếu hơn so với dữ liệu có số chiều cao ban đầu. Điều này là do việc giảm kích cỡ của biểu diễn được thực hiện bằng việc tìm và loại bỏ sự dư thừa. Xác định và loại bỏ nhiều dư thừa cho phép thuật toán giảm chiều nén dữ liệu được nhiều hơn đồng thời loại bỏ ít thông tin hơn.</p><p>Khái niệm về biểu diễn là một trong những chủ đề trung tâm của học sâu và do đó là một trong những chủ đề trọng tâm trong cuốn sách này. Trong phần này, chúng tôi sẽ phát triển một số ví dụ đơn giản của các thuật toán học biểu diễn. Các thuật toán ví dụ này cùng nhau cho thấy cách vận hành cả ba tiêu chí trên. Hầu hết các chương còn lại giới thiệu các thuật toán học biểu diễn khác để phát triển các tiêu chí này theo những cách khác nhau, hoặc giới thiệu các tiêu chí khác.</p><h2 id="581-Phân-tích-thành-phần-chính"><a class="anchor hidden-xs" href="#581-Phân-tích-thành-phần-chính" title="581-Phân-tích-thành-phần-chính"><span class="octicon octicon-link"></span></a>5.8.1 Phân tích thành phần chính</h2><p>Trong phần 2.12, chúng ta đã thấy rằng thuật toán phân tích thành phần chính là một cách nén dữ liệu. Ta cũng có thể xem đây như một thuật toán học không giám sát để học cách biểu diễn dữ liệu. Biểu diễn này dựa trên hai trong số các tiêu chí cho một biểu diễn đơn giản được mô tả ở trên. Phân tích thành phần chính học một biểu diễn có số chiều thấp hơn so với đầu vào ban đầu. Nó cũng học một biểu diễn mà các phần tử của chúng không có mối tương quan tuyến tính với nhau. Đây là bước đầu tiên hướng tới tiêu chí học các biểu diễn mà các thành phần của nó độc lập về mặt thống kê. Để đạt được sự độc lập hoàn toàn, một thuật toán học biểu diễn cũng phải loại bỏ các mối quan hệ phi tuyến tính giữa các biến.</p><p>Phân tích thành phần chính học một phép biến đổi trực giao và tuyến tính của dữ liệu để chiếu một đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3008">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-297">\boldsymbol{x}</script></span> thành một biểu diễn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3009"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3010">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-298">\boldsymbol{z}</script></span> như được trình bày trong hình 5.8. Trong phần 2.12, ta đã thấy rằng chúng ta có thể học một biểu diễn một chiều cho phép tái tạo lại dữ liệu gốc tốt nhất (theo nghĩa sai số bình phương trung bình thấp nhất) và rằng biểu diễn này thực tế tương ứng với thành phần chính thứ nhất của dữ liệu. Do đó, chúng ta có thể sử dụng thuật toán phân tích thành phần chính như là một phương pháp giảm chiều đơn giản và hiệu quả để giữ thông tin trong dữ liệu nhiều nhất có thể (vẫn được đo bằng bình phương sai số tái thiết nhỏ nhất). Trong phần tiếp theo, chúng ta sẽ nghiên cứu xem biểu diễn phân tích thành phần chính khử tính tương quan của biểu diễn dữ liệu gốc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3011"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3012">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-299">\boldsymbol{X}</script></span> như thế nào.</p><p><img src="https://i.imgur.com/9K5IulQ.png" alt=""></p><blockquote>
<p>Hình 5.8: Phân tích thành phần chính học một phép chiếu tuyến tính cho phép điều chỉnh trục của không gian mới theo hướng của phương sai lớn nhất. (<em>Hình bên trái</em>) Dữ liệu gốc bao gồm các mẫu dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3014">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-300">\boldsymbol{x}</script></span>. Trong không gian này, hướng của phương sai có thể khác hướng của trục không gian. (<em>Hình bên trái</em>) Biểu diễn dữ liệu đã biến đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3015"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3016">z</span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3019" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3020" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3021">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-301">\boldsymbol{z} = \boldsymbol{x}^\intercal\boldsymbol{W}</script></span>, dữ liệu này biến thiên nhiều nhất dọc theo trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3022"><span class="MJXp-msubsup" id="MJXp-Span-3023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3024" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3025" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-302">z_1</script></span>. Hướng biến thiên nhiều thứ hai theo trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3026"><span class="MJXp-msubsup" id="MJXp-Span-3027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3029" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-303">z_2</script></span>.</p>
</blockquote><p>Xét ma trận thiết kế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3030"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3031">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-304">\boldsymbol{X}</script></span> với kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033">m</span><span class="MJXp-mo" id="MJXp-Span-3034" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-305">m \times n</script></span>. Giả sử rằng dữ liệu có kỳ vọng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3036"><span class="MJXp-mn" id="MJXp-Span-3037">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-306">0</script></span>, tức là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3038"><span class="MJXp-mrow" id="MJXp-Span-3039"><span class="MJXp-mi undefined" id="MJXp-Span-3040">E</span></span><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3042">X</span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3045">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-307">\mathbb{E}[\boldsymbol{X}] = 0</script></span>. Nếu dữ liệu không có kỳ vọng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-mn" id="MJXp-Span-3047">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-308">0</script></span>, ta có thể dễ dàng chuẩn hóa bằng cách trừ tất cả các phần tử của ma trận cho kỳ vọng trong bước tiền xử lý.</p><p>Ma trận hiệp phương sai mẫu không chệch ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3048"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3049">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-309-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-309">\boldsymbol{X}</script></span> được biểu diễn bởi công thức:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3050"><span class="MJXp-mtable" id="MJXp-Span-3051"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3052" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3053" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-3054"><span class="MJXp-mi" id="MJXp-Span-3055">V</span><span class="MJXp-mi" id="MJXp-Span-3056">a</span><span class="MJXp-mi" id="MJXp-Span-3057">r</span></span><span class="MJXp-mo" id="MJXp-Span-3058" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3059">x</span><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3062" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3063">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">m</span><span class="MJXp-mo" id="MJXp-Span-3065" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3066">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3067"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3068" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3069" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3070">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3071">X</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-310-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-310">\begin{equation}
  \mathrm{Var}[\boldsymbol{x}] = \frac{1}{m - 1}\boldsymbol{X}^{\intercal}\boldsymbol{X}
  \tag{5.85}
\end{equation}</script></span></p><p>Phân tích thành phần chính tìm một biểu diễn (thông qua biến đổi tuyến tính) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3072"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3073">z</span><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3075"><span class="MJXp-mrow" id="MJXp-Span-3076" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3077">W</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3078" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3079">⊺</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-311-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-311">\boldsymbol{z} = \boldsymbol{{W}^{\intercal}}x</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mrow" id="MJXp-Span-3082"><span class="MJXp-mi" id="MJXp-Span-3083">V</span><span class="MJXp-mi" id="MJXp-Span-3084">a</span><span class="MJXp-mi" id="MJXp-Span-3085">r</span></span><span class="MJXp-mo" id="MJXp-Span-3086" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3087">z</span><span class="MJXp-mo" id="MJXp-Span-3088" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-312">\mathrm{Var}[\boldsymbol{z}]</script></span> là một ma trận đường chéo.</p><p>Trong mục 2.12, chúng ta thấy rằng những thành phần chính của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3089"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3090">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-313">\boldsymbol{X}</script></span> được xác định bởi vector riêng của ma trận vuông <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3091"><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3094" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3095">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3096">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-314">\boldsymbol{X}^{\intercal}\boldsymbol{X}</script></span>. Từ góc nhìn này, ta có</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3097"><span class="MJXp-mtable" id="MJXp-Span-3098"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3099" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3100" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3101"><span class="MJXp-mrow" id="MJXp-Span-3102" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3103">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3104" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3105">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3106">X</span><span class="MJXp-mo" id="MJXp-Span-3107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3108">W</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3109">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-3110"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3111" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3112" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-315-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-315">\begin{equation}
  \boldsymbol{{X}^{\intercal}X} = \boldsymbol{W}\boldsymbol{\Lambda}\boldsymbol{W}^\intercal.
  \tag{5.86}
\end{equation}</script></span></p><p>Trong phần này, ta sẽ khai thác một cách khác để xác định các thành phần chính. Các thành phần chính có thể thu được qua <em>phân tích giá trị suy biến</em> (singular value decomposition - SVD). Cụ thể hơn, chúng chính là vector suy biến phải của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3114"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3115">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-316">\boldsymbol{X}</script></span>. Để thấy được điều này, ta ký hiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3116"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3117">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-317">\boldsymbol{W}</script></span> là các vector suy biến phải trong phép phân tích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3118"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3119">X</span><span class="MJXp-mo" id="MJXp-Span-3120" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3121">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3122">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3123"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3124" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3125" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3126">⊺</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-318">\boldsymbol{X} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{W}^{\intercal}</script></span>. Từ đó tìm lại được phương trình vector riêng ban đầu với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3127"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3128">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-319">\boldsymbol{W}</script></span> là hệ cơ sở các vector riêng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3129"><span class="MJXp-mtable" id="MJXp-Span-3130"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3131" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3132" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3133"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3134" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3135" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3136">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3137">X</span><span class="MJXp-mo" id="MJXp-Span-3138" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3140">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3141">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3142"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3143" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3144" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3145">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3146"><span class="MJXp-mo" id="MJXp-Span-3147" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3148" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3149">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3150">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3151">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3152"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3153" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3154" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3155">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-3156" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3157">W</span><span class="MJXp-msubsup" id="MJXp-Span-3158"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3159" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3160" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3161"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3162" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3163" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-320-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-320">\begin{equation}
   \boldsymbol{X}^{\intercal}\boldsymbol{X} = (\boldsymbol{U}\boldsymbol{\Sigma}
   \boldsymbol{W}^{\intercal})^{\intercal}\boldsymbol{U}\boldsymbol{\Sigma}
   \boldsymbol{W}^{\intercal} = \boldsymbol{W}\boldsymbol{\Sigma}^2
   \boldsymbol{W}^\intercal. \tag{5.87}
\end{equation}</script></span></p><p>Phân tích giá trị suy biến giúp ta thấy rằng kết quả của phân tích thành phần chính là một ma trận đường chéo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3165"><span class="MJXp-mrow" id="MJXp-Span-3166"><span class="MJXp-mi" id="MJXp-Span-3167">V</span><span class="MJXp-mi" id="MJXp-Span-3168">a</span><span class="MJXp-mi" id="MJXp-Span-3169">r</span></span><span class="MJXp-mo" id="MJXp-Span-3170" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3171">z</span><span class="MJXp-mo" id="MJXp-Span-3172" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-321-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-321">\mathrm{Var}[z]</script></span>. Sử dụng phân tích giá trị suy biến của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3173"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3174">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-322-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-322">\boldsymbol{X}</script></span>, ta có thể diễn tả phương sai của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3175"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3176">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-323-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-323">\boldsymbol{X}</script></span> như sau:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3177"><span class="MJXp-mtable" id="MJXp-Span-3178"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3179" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3180" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-3181"><span class="MJXp-mi" id="MJXp-Span-3182">V</span><span class="MJXp-mi" id="MJXp-Span-3183">a</span><span class="MJXp-mi" id="MJXp-Span-3184">r</span><span class="MJXp-mo" id="MJXp-Span-3185" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3186">x</span><span class="MJXp-mo" id="MJXp-Span-3187" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtd" id="MJXp-Span-3188" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3189"></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3191" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3192">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3193">m</span><span class="MJXp-mo" id="MJXp-Span-3194" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3195">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3196"><span class="MJXp-mrow" id="MJXp-Span-3197" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3198">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3199" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3200">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3201">X</span></span><span class="MJXp-mtd" id="MJXp-Span-3202" style="padding-left: 2em; text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3203" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3204" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3205" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3206"></span><span class="MJXp-mo" id="MJXp-Span-3207" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3208" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3209">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">m</span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3212">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3214">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3215">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3216"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3217" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3218" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3219">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3220"><span class="MJXp-mo" id="MJXp-Span-3221" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3222" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3223">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3224">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3225">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3226"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3227" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3228" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3229">⊺</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3230" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3231" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3232" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3233"></span><span class="MJXp-mo" id="MJXp-Span-3234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3235" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3236">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237">m</span><span class="MJXp-mo" id="MJXp-Span-3238" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3239">1</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3240">W</span><span class="MJXp-msubsup" id="MJXp-Span-3241"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3242" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3243" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3244">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3245"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3246" style="margin-right: 0.05em;">U</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3247" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3248">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3249">U</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3250">Σ</span><span class="MJXp-msubsup" id="MJXp-Span-3251"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3252" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3253" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3254">⊺</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3255" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3256" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3257" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3258"></span><span class="MJXp-mo" id="MJXp-Span-3259" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3260" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3261">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262">m</span><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3264">1</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3265">W</span><span class="MJXp-msubsup" id="MJXp-Span-3266"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3267" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3268" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3269"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3270" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3271" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3272">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-3273" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-324-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-324">\begin{align*}
  \mathrm{Var[\boldsymbol{x}]} &= \frac{1}{m - 1}\boldsymbol{{X}^{\intercal}X} &\tag{5.88} \\
  &= \frac{1}{m - 1}(\boldsymbol{U}\boldsymbol{\Sigma}
  \boldsymbol{W}^{\intercal})^{\intercal}\boldsymbol{U}\boldsymbol{\Sigma}
  \boldsymbol{W}^{\intercal} \tag{5.89} \\
  &= \frac{1}{m - 1}\boldsymbol{W}\boldsymbol{\Sigma}^{\intercal}\boldsymbol{U}^{\intercal}
  \boldsymbol{U \Sigma}\boldsymbol{W}^{\intercal} \tag{5.90} \\
  &= \frac{1}{m - 1}\boldsymbol{W}\boldsymbol{\Sigma}^2 \boldsymbol{W}^{\intercal}, \tag{5.91}
\end{align*}</script></span></p><p>trong đó dấu bằng ở (5.91) xảy ra do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3274"><span class="MJXp-msubsup" id="MJXp-Span-3275"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3276" style="margin-right: 0.05em;">U</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3277" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3278">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3279">U</span><span class="MJXp-mo" id="MJXp-Span-3280" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3281">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-325-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-325">\boldsymbol{U}^{\intercal}\boldsymbol{U} = \boldsymbol{I}</script></span> bởi ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3282"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3283">U</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-326-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-326">\boldsymbol{U}</script></span> của phép phân tích giá trị suy biến, theo định nghĩa, là trực giao. Điều này cho thấy hiệp phương sai của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3285">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-327-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-327">z</script></span> là một ma trận đường chéo như yêu cầu:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3286"><span class="MJXp-mtable" id="MJXp-Span-3287"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3288" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3289" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mi" id="MJXp-Span-3291">V</span><span class="MJXp-mi" id="MJXp-Span-3292">a</span><span class="MJXp-mi" id="MJXp-Span-3293">r</span><span class="MJXp-mo" id="MJXp-Span-3294" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3295">z</span><span class="MJXp-mo" id="MJXp-Span-3296" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtd" id="MJXp-Span-3297" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3298"></span><span class="MJXp-mo" id="MJXp-Span-3299" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3300" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3301">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302">m</span><span class="MJXp-mo" id="MJXp-Span-3303" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3304">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3305"><span class="MJXp-mrow" id="MJXp-Span-3306" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3307">Z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3308" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3309">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3310">Z</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3311" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3312" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3313" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3314"></span><span class="MJXp-mo" id="MJXp-Span-3315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3316" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3317">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3318">m</span><span class="MJXp-mo" id="MJXp-Span-3319" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3320">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3321"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3322" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3323" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3324">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3325"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3326" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3327" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3328">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3329">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3330">W</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3331" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3332" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3333" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3334"></span><span class="MJXp-mo" id="MJXp-Span-3335" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3336" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3337">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3338">m</span><span class="MJXp-mo" id="MJXp-Span-3339" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3340">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3341"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3342" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3343" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3344">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3345">W</span><span class="MJXp-msubsup" id="MJXp-Span-3346"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3347" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mn MJXp-bold MJXp-script" id="MJXp-Span-3348" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3349"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3350" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-3351" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3352">W</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3353" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3354" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3355" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3356"></span><span class="MJXp-mo" id="MJXp-Span-3357" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3358" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3359">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">m</span><span class="MJXp-mo" id="MJXp-Span-3361" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3362">1</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3363"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3364" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mn MJXp-bold MJXp-script" id="MJXp-Span-3365" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-328-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-328">\begin{align*}
  \mathrm{Var[\boldsymbol{z}]} &= \frac{1}{m - 1}\boldsymbol{{Z}^{\intercal}Z} \tag{5.92} \\
  &= \frac{1}{m - 1}\boldsymbol{W^{\intercal}X^{\intercal}XW} \tag{5.93}\\
  &= \frac{1}{m - 1}\boldsymbol{W^{\intercal}W \Sigma^2 W^\intercal W} \tag{5.94} \\
  &= \frac{1}{m - 1}\boldsymbol{\Sigma^2}  \tag{5.95}
\end{align*}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3366"><span class="MJXp-msubsup" id="MJXp-Span-3367"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3368" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-3369" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3370">W</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3371" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3372">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-329-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-329">\boldsymbol{W^\intercal W = I}</script></span> theo định nghĩa của phân tích giá trị suy biến.</p><p>Phân tích trên cho thấy rằng khi ta chiếu dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3373"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3374">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-330-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-330">\boldsymbol{x}</script></span> xuống <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3375"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3376">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-331-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-331">\boldsymbol{z}</script></span> qua phép biển đổi tuyến tính với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3377"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3378">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-332-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-332">\boldsymbol{W}</script></span>, kết quả biểu diễn có một ma trận hiệp phương sai là ma trận đường chéo (được cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3379"><span class="MJXp-msubsup" id="MJXp-Span-3380"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3381" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mn MJXp-bold MJXp-script" id="MJXp-Span-3382" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-333-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-333">\boldsymbol{\Sigma^2}</script></span>), từ đó ngay lập tức ta thấy được các phần tử của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3383"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3384">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-334-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-334">\boldsymbol{z}</script></span> không tương quan lẫn nhau.</p><p>Khả năng biến đổi dữ liệu thành biểu diễn mới trong đó các phần tử không tương quan lẫn nhau là đặc tính cực kỳ quan trọng của phân tích thành phần chính. Đây là một ví dụ đơn giản cho cho một phép biểu diễn có gắng <em>tách các biến tố</em> trong dữ liệu. Đối với phân tích thành phần chính, cách nó thực hiện quá trình bóc tách này là tìm một phép quay của không gian dữ liệu đầu vào (được mô tả bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3385"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3386">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-335-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-335">\boldsymbol{W}</script></span>) mà hướng các trục chính của phương sai theo hệ cơ sở của không gian biểu diễn mới gắn liền với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3387"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3388">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-336-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-336">\boldsymbol{z}</script></span>.</p><p>Trong khi tương quan là một dạng phụ thuộc quan trọng giữa các phần tử trong dữ liệu, ta cũng quan tâm đến việc học cách biểu diễn có thể bóc tách các dạng phụ thuộc phức tạp hơn giữa các đặc trưng. Để làm được điều này, ta cần nhiều hơn so với những gì có thể làm được với biến đổi tuyến tính đơn giản.</p><h2 id="582-Phân-cụm-k-means"><a class="anchor hidden-xs" href="#582-Phân-cụm-k-means" title="582-Phân-cụm-k-means"><span class="octicon octicon-link"></span></a>5.8.2 Phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-337-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-337">k</script></span>-means</h2><p>Một ví dụ đơn giản khác của học biểu diễn là phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3392">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-338-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-338">k</script></span>-means. Thuật toán phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-339-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-339">k</script></span>-means chia tập huấn luyện thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3396">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-340-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-340">k</script></span> cụm dữ liệu khác nhau, mỗi cụm là các phần tử gần nhau. Vì vậy, chúng ta có thể hiểu rằng thuật toán này sẽ cung cấp vector <em>mã hóa đơn trội</em> (one-hot encode) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3397"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3398">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-341-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-341">\boldsymbol{h}</script></span> có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3400">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-342-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-342">k</script></span> chiều biểu diễn dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3401"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3402">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-343-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-343">\boldsymbol{x}</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3403"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3404">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-344-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-344">\boldsymbol{x}</script></span> thuộc cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3406">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-345-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-345">i</script></span> thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3407"><span class="MJXp-msubsup" id="MJXp-Span-3408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3409" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3410" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3411" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3412">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-346-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-346">h_i = 1</script></span>, và tất cả các giá trị còn lại trong vector biểu diễn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3413"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3414">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-347-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-347">\boldsymbol{h}</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3415"><span class="MJXp-mn" id="MJXp-Span-3416">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-348-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-348">0</script></span>.</p><p>Mã hóa đơn trội thu được từ phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3418">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-349-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-349">k</script></span>-means là một ví dụ của biểu diễn thưa, vì phần lớn các phần tử có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3419"><span class="MJXp-mn" id="MJXp-Span-3420">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-350-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-350">0</script></span> với mỗi đầu vào. Sau này, ta sẽ phát triển các thuật toán khác có thể học được biểu diễn thưa một cách linh hoạt hơn, mà ở đó có thể có nhiều hơn một phần tử có giá trị khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3421"><span class="MJXp-mn" id="MJXp-Span-3422">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-351-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-351">0</script></span> cho mỗi đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3423"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3424">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-352-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-352">\boldsymbol{x}</script></span>. Mã hóa đơn trội là trường hợp cực đoan của biểu diễn thưa, bởi nó làm mất rất nhiều lợi ích của một phép biểu diễn phân tán. Tuy nhiên, mã hóa đơn trội vẫn thể hiện một số lợi thế về mặt thống kê (nó truyền đạt một cách tự nhiên ý tưởng rằng các phần tử trong cùng một cụm là giống nhau), và nó mang lại lợi thế về tính toán vì toàn bộ biểu diễn được thể hiện bởi một số nguyên duy nhất.</p><p>Thuật toán phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3426">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-353-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-353">k</script></span>-means bắt đầu bằng việc khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3428">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-354-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-354">k</script></span> trọng tâm khác nhau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3429"><span class="MJXp-mo" id="MJXp-Span-3430" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-3431"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3432" style="margin-right: 0.05em;">μ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3433" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3434">(</span><span class="MJXp-mn" id="MJXp-Span-3435">1</span><span class="MJXp-mo" id="MJXp-Span-3436">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3437" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3438" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3439" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3440"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3441" style="margin-right: 0.05em;">μ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3442" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3443">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3444">k</span><span class="MJXp-mo" id="MJXp-Span-3445">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3446" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-355-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-355">\{\boldsymbol{\mu}^{(1)}, \dots, \boldsymbol{\mu}^{(k)}\}</script></span> ứng với những giá trị khác nhau, sau đó lặp đi lặp lại hai bước khác nhau cho đến khi hội tụ. Ở bước đầu tiên, mỗi mẫu huấn luyện được gắn với cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3448">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-356-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-356">i</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-357-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-357">i</script></span> là chỉ số của trọng tâm gần nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3451"><span class="MJXp-msubsup" id="MJXp-Span-3452"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3453" style="margin-right: 0.05em;">μ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3454" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3455">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3456">i</span><span class="MJXp-mo" id="MJXp-Span-3457">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-358-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-358">\boldsymbol{\mu}^{(i)}</script></span>. Ở bước còn lại, mỗi trọng tâm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3458"><span class="MJXp-msubsup" id="MJXp-Span-3459"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3460" style="margin-right: 0.05em;">μ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3461" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3462">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3463">i</span><span class="MJXp-mo" id="MJXp-Span-3464">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-359-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-359">\boldsymbol{\mu}^{(i)}</script></span> được cập nhật bằng giá trị trung bình của tất cả mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3465"><span class="MJXp-msubsup" id="MJXp-Span-3466"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3467" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3468" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3469">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3470">j</span><span class="MJXp-mo" id="MJXp-Span-3471">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-360-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-360">\boldsymbol{x}^{(j)}</script></span> được phân vào cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-361-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-361">i</script></span>.</p><p>Một khó khăn gắn liền với các bài toán phân cụm là vấn đề mập mờ, theo nghĩa là không có một tiêu chuẩn đơn lẻ nào có thể đánh giá một cách phân cụm dữ liệu thể hiện trong thực tế là tốt hay không tốt. Chúng ta có thể đánh giá các đặc tính của phân cụm, ví dụ như khoảng cách Euclid trung bình từ trọng tâm của một cụm đến các phần tử còn lại trong cụm đó. Nó thể hiện khả năng tái tạo lại dữ liệu huấn luyện từ các phép phân cụm. Tuy nhiên, chúng ta vẫn không biết các phép gán tương thích với các tính chất mong muốn trong thực tế như thế nào. Ngoài ra, có thể có nhiều cách phân cụm khác nhau và tất cả chúng đều tương thích tốt với một tính chất nào đó trong thực tế. Chúng ta có thể tìm một cách phân cụm liên quan đến một đặc trưng nhưng lại thu được một phân cụm khác, có kết quả tương đương nhưng không liên quan đến tác vụ của chúng ta. Ví dụ, giả sử ta chạy hai thuật phân cụm để tìm hai cụm trên dữ liệu gồm hình ảnh của xe tải đỏ, xe hơi đỏ, xe tải xám và xe hơi xám. Nếu ta yêu cầu mỗi thuật tìm hai cụm, một thuật có thể phân thành hai cụm gồm một cụm xe hơi và một cụm xe tải, thuật toán còn lại thì phân thành hai cụm gồm một cụm phương tiện giao thông màu đỏ và một cụm gồm phương tiện giao thông màu xám. Giả sử chúng ta chạy một thuật phân cụm thứ ba có khả năng tự xác định số cụm. Thuật toán này có thể phân các mẫu dữ liệu thành bốn cụm: xe hơi đỏ, xe tải đỏ, xe hơi xám, xe tải xám. Thuật toán phân loại mới này ít nhất đã xác định thông tin về cả hai đặc tính, nhưng có thể đã mất một số thông tin về sự tương đồng. Xe hơi đỏ ở cụm khác cụm xe hơi xám cũng có ý nghĩa tương đương với việc chúng khác cụm xe tải xám. Kết quả phân cụm không cho thấy việc xe hơi đỏ giống với xe hơi xám hơn là xe tải xám. Tất cả những gì ta biết là chúng khác nhau ở cả hai đặc tính.</p><p>Những vấn đề này làm rõ một số lí do mà chúng ta nghiêng về biểu diễn phân tán hơn biểu diễn đơn trội. Biểu diễn phân tán có thể có hai đặc tính cho mỗi loại phương tiện: một thể hiện màu sắc và một thể hiện rằng phương tiện đó là xe hơi hay xe tải. Tuy việc tìm ra phép biểu diễn phân tán tối ưu vẫn chưa thực sự rõ ràng (làm cách nào để một thuật toán học tập có thể xác định liệu hai đặc tính chúng ta quan tâm là màu sắc và phân loại xe hơi-xe tải hay là nhà sản xuất hoặc tuổi của phương tiện), nhưng có nhiều đặc tính làm giảm gánh nặng của thuật toán trong việc dự đoán tính chất duy nhất chúng ta quan tâm là gì, và cho chúng ta khả năng đánh giá sự tương đồng giữa các đối tượng một cách chi tiết hơn bằng cách so sánh nhiều đặc tính với nhau thay vì chỉ thử xem một đặc tính có phù hợp hay không.</p><h1 id="59-Trượt-Gradient-ngẫu-nhiên"><a class="anchor hidden-xs" href="#59-Trượt-Gradient-ngẫu-nhiên" title="59-Trượt-Gradient-ngẫu-nhiên"><span class="octicon octicon-link"></span></a>5.9 Trượt Gradient ngẫu nhiên</h1><p>Gần như mọi công cụ của học sâu được tiếp sức bởi một thuật toán cực kỳ quan trọng: trượt gradient ngẫu nhiên. Trượt gradient ngẫu nhiên là mở rộng của thuật toán trượt gradient được giới thiệu trong mục 4.3.</p><p>Một vấn đề muôn thuở của học máy đó là nó cần tập huấn luyện lớn để có thể tổng quát hóa tốt, nhưng tập huấn luyện lớn cũng đồng nghĩa với việc chi phí tính toán lớn hơn.</p><p>Hàm chi phí sử dụng bởi thuật toán học máy thường là tổng của tất cả hàm mất mát của từng mẫu huấn luyện. Ví dụ, hàm đối logarit của hàm hợp lý với phân phối có điều kiện của tập huấn luyện có thể viết dưới dạng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3474"><span class="MJXp-mtable" id="MJXp-Span-3475"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3476" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3477" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478">J</span><span class="MJXp-mo" id="MJXp-Span-3479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3480">θ</span><span class="MJXp-mo" id="MJXp-Span-3481" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3483"><span class="MJXp-mrow" id="MJXp-Span-3484" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3485">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3486" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3487">x</span><span class="MJXp-mo" id="MJXp-Span-3488">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3489">y</span><span class="MJXp-mspace" id="MJXp-Span-3490" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3491">∼</span><span class="MJXp-mspace" id="MJXp-Span-3492" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3493"><span class="MJXp-mrow" id="MJXp-Span-3494" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3495"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3497" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3496">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3498" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-3499"><span class="MJXp-mi" id="MJXp-Span-3500">d</span><span class="MJXp-mi" id="MJXp-Span-3501">a</span><span class="MJXp-mi" id="MJXp-Span-3502">t</span><span class="MJXp-mi" id="MJXp-Span-3503">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3504">L</span><span class="MJXp-mo" id="MJXp-Span-3505" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3506">x</span><span class="MJXp-mo" id="MJXp-Span-3507" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3508">y</span><span class="MJXp-mo" id="MJXp-Span-3509" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3510">θ</span><span class="MJXp-mo" id="MJXp-Span-3511" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3512" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3513" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3514">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3516"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3522" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3523">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3517" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3518" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3519">i</span><span class="MJXp-mo" id="MJXp-Span-3520">=</span><span class="MJXp-mn" id="MJXp-Span-3521">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3524">L</span><span class="MJXp-mo" id="MJXp-Span-3525" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3526"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3527" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3528" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3529">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3530">i</span><span class="MJXp-mo" id="MJXp-Span-3531">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3532" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3534" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3535" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3536">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537">i</span><span class="MJXp-mo" id="MJXp-Span-3538">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3539" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3540">θ</span><span class="MJXp-mo" id="MJXp-Span-3541" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-362-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-362">\begin{equation}
  J(\boldsymbol{\theta}) = \mathbb{E}_{\boldsymbol{x}, y \,\sim\, \hat{p}_{\mathrm{data}}} L(\boldsymbol{x}, y, \boldsymbol{\theta}) = \frac{1}{m}\sum^{m}_{i = 1}L(\boldsymbol{x}^{(i)}, y^{(i)}, \boldsymbol{\theta}), \tag{5.96}
\end{equation}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3544">L</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-363-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-363">L</script></span> là hàm mất mát cho từng mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546">L</span><span class="MJXp-mo" id="MJXp-Span-3547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3548">x</span><span class="MJXp-mo" id="MJXp-Span-3549" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3550">y</span><span class="MJXp-mo" id="MJXp-Span-3551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3552">θ</span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3554" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3555" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-3556">log</span><span class="MJXp-mo" id="MJXp-Span-3557" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3559">p</span><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">y</span><span class="MJXp-mrow" id="MJXp-Span-3562"><span class="MJXp-mo" id="MJXp-Span-3563" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3564">x</span><span class="MJXp-mo" id="MJXp-Span-3565" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3566">θ</span><span class="MJXp-mo" id="MJXp-Span-3567" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-364-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-364">L(\boldsymbol{x}, y, \boldsymbol{\theta}) = -\log{p(y|\boldsymbol{x}; \boldsymbol{\theta})}</script></span>.</p><p>Với những hàm chi phí cộng tính này, để thực hiện trượt gradient, ta cần tính:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3568"><span class="MJXp-mtable" id="MJXp-Span-3569"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3570" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3571" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3572"><span class="MJXp-mi" id="MJXp-Span-3573" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3574" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3575">θ</span></span></span><span class="MJXp-mspace" id="MJXp-Span-3576" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">J</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3579">θ</span><span class="MJXp-mo" id="MJXp-Span-3580" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3581" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3582" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3583">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3584">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3585"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3591" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3586" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3587" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3588">i</span><span class="MJXp-mo" id="MJXp-Span-3589">=</span><span class="MJXp-mn" id="MJXp-Span-3590">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3593"><span class="MJXp-mi" id="MJXp-Span-3594" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3595" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3596">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3597">L</span><span class="MJXp-mo" id="MJXp-Span-3598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3599"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3600" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3601" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3602">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3603">i</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-3604">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3605" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3608" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3609">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3610">i</span><span class="MJXp-mo" id="MJXp-Span-3611">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3612" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3613">θ</span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-365-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-365">\begin{equation}
  \nabla_{\boldsymbol\theta}\,J(\boldsymbol{\theta}) = \frac{1}{m}\sum^{m}_{i = 1}\nabla_{\boldsymbol\theta}L(\boldsymbol{x^{(i)}}, y^{(i)}, \boldsymbol{\theta}) \tag{5.97}
\end{equation}</script></span></p><p>Chi phí tính toán cho quá trình này là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3616">O</span><span class="MJXp-mo" id="MJXp-Span-3617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3618">m</span><span class="MJXp-mo" id="MJXp-Span-3619" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-366-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-366">O(m)</script></span>. Khi tập huấn luyện lên đến hàng tỉ mẫu, chi phí quá trình cho một bước trượt gradient sẽ cực kỳ lâu và tốn kém.</p><p>Một nhận xét sắc bén của trượt gradient ngẫu nhiên đó là gradient trong phương trình (5.97) là một kỳ vọng. Giá trị kỳ vọng này có thể được tính xấp xỉ bằng cách sử dụng một tập dữ liệu nhỏ. Cụ thể hơn, ở mỗi bước của thuật toán, ta có thể lấy mẫu một <strong>lô nhỏ</strong> (mini-batch) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3620"><span class="MJXp-mrow" id="MJXp-Span-3621"><span class="MJXp-mi undefined" id="MJXp-Span-3622">B</span></span><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-3625"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3626" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3627" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3628">(</span><span class="MJXp-mn" id="MJXp-Span-3629">1</span><span class="MJXp-mo" id="MJXp-Span-3630">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3631" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3632" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3633" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3634"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3635" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3636" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3637">(</span><span class="MJXp-msup" id="MJXp-Span-3638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639" style="margin-right: 0.05em;">m</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3640" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3641">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3642" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-367-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-367">\mathbb{B} = \{\boldsymbol{x}^{(1)}, \dots, \boldsymbol{x}^{(m')}\}</script></span> gồm các mẫu được lấy ngẫu nhiên đồng đều từ tập huấn luyện. Kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3643"><span class="MJXp-msubsup" id="MJXp-Span-3644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3645" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-3646" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-368-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-368">m^\prime</script></span> của lô nhỏ thường được chọn là một số tương đối nhỏ các mẫu dữ liệu, có giá trị từ một đến vài trăm. Quan trọng hơn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3647"><span class="MJXp-msubsup" id="MJXp-Span-3648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-3650" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-369-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-369">m^\prime</script></span> thường được giữ nguyên ngay cả khi tập huấn luyện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3652">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-370-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-370">m</script></span> tăng lên. Ta có thể thực hiện quá trình khớp một tập huấn luyện với hàng tỉ mẫu bằng các cập nhật được tính toán trên chỉ khoảng một trăm mẫu.</p><p>Ước lượng của gradient khi đó có dạng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3653"><span class="MJXp-mtable" id="MJXp-Span-3654"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3655" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3656" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3657">g</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3659" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3660">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-3661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3662" style="margin-right: 0.05em;">m</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3663" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3664"><span class="MJXp-mi" id="MJXp-Span-3665" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3666" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3667">θ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-3668"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3674" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-3675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676" style="margin-right: 0.05em;">m</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3677" style="vertical-align: 0.5em;">′</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3669" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3670" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3671">i</span><span class="MJXp-mo" id="MJXp-Span-3672">=</span><span class="MJXp-mn" id="MJXp-Span-3673">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3678">L</span><span class="MJXp-mo" id="MJXp-Span-3679" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3680"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3681" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3682" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3683">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684">i</span><span class="MJXp-mo" id="MJXp-Span-3685">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3688" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3689" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3690">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3691">i</span><span class="MJXp-mo" id="MJXp-Span-3692">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3693" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3694">θ</span><span class="MJXp-mo" id="MJXp-Span-3695" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-371-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-371">\begin{equation}
  \boldsymbol{g} = \frac{1}{m'}\nabla_{\boldsymbol{\theta}}\sum^{m'}_{i = 1}L(\boldsymbol{x}^{(i)}, y^{(i)}, \boldsymbol{\theta}) \tag{5.98}
\end{equation}</script></span><br>
sử dụng các mẫu từ lô nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3696"><span class="MJXp-mrow" id="MJXp-Span-3697"><span class="MJXp-mi undefined" id="MJXp-Span-3698">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-372-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-372">\mathbb{B}</script></span>. Thuật toán trượt gradient ngẫu nhiên sau đó trượt theo gradient vừa ước lượng để "xuống đồi"<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3699"><span class="MJXp-mtable" id="MJXp-Span-3700"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3701" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3702" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3703">θ</span><span class="MJXp-mo" id="MJXp-Span-3704" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3705">θ</span><span class="MJXp-mo" id="MJXp-Span-3706" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3707">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3708">g</span><span class="MJXp-mo" id="MJXp-Span-3709" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-373-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-373">\begin{equation}
  \boldsymbol{\theta} \leftarrow \boldsymbol{\theta} - \epsilon \boldsymbol{g}, \tag{5.99}
\end{equation}</script></span><br>
trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-374-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-374">\epsilon</script></span> là tốc độ học.</p><p>Trượt gradient nói chung thường bị đánh giá là chậm hoặc không ổn định. Trong quá khứ, việc ứng dụng trượt gradient trong các vấn đề tối ưu hóa hàm không lồi thường bị cho là điên rồ và vô ích. Ngày nay, chúng ta biết rằng các mô hình học máy được mô tả ở phần II hoạt động rất tốt khi được huấn luyện với trượt gradient. Thuật toán tối ưu có thể không đảm bảo khả năng sẽ dừng ở điểm cực tiểu cục bộ trong khoảng thời gian cho phép, nhưng việc nó thường tìm ra điểm mà ở đó hàm chi phí có giá trị rất thấp trong thời gian đủ nhanh cũng là rất hữu dụng rồi.</p><p>Trượt gradient ngẫu nhiên có rất nhiều ứng dụng ngoài các vấn đề trong học sâu. Nó là cách chủ yếu để huấn luyện các mô hình tuyến tính trong tập dữ liệu khổng lồ. Với mô hình có kích thước không đổi, chi phí của mỗi cập nhật trượt gradient ngẫu nhiên thường không phụ thuộc vào kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3713">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-375-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-375">m</script></span> của tập huấn luyện. Trong thực tế, chúng ta thường dùng mô hình lớn hơn khi kích thước của tập huấn luyện tăng lên, tuy nhiên điều này là không bắt buộc. Số lần cập nhật trước khi hội tụ thường tăng lên theo kích thước của tập huấn luyện. Tuy nhiên, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3715">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-376-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-376">m</script></span> tiến đến vô cùng, mô hình sẽ dần hội tụ về dạng có sai số kiểm thử tốt (thấp) nhất trước khi trượt gradient ngẫu nhiên chạy hết trên từng mẫu của tập huấn luyện. Việc tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3717">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-377-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-377">m</script></span> sẽ không làm tăng thời gian huấn luyện cần thiết để đạt được mô hình có sai số kiểm thử thấp nhất của mô hình. Từ góc nhìn này, ta có thể cho rằng chi phí để huấn luyện một mô hình với SGD là tiệm cận với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">O</span><span class="MJXp-mo" id="MJXp-Span-3720" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3721">1</span><span class="MJXp-mo" id="MJXp-Span-3722" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-378-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-378">O(1)</script></span> theo biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3724">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-379-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-379">m</script></span>.</p><p>Trước khi học sâu xuất hiện, phương pháp chủ yếu để học các mô hình phi tuyến tính là sử dụng thủ thuật hàm lõi kết hợp với một mô hình tuyến tính. Nhiều thuật toán học hàm lõi yêu cầu xây dựng một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726">m</span><span class="MJXp-mo" id="MJXp-Span-3727" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-380-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-380">m \times m</script></span>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3729"><span class="MJXp-msubsup" id="MJXp-Span-3730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3731" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3732" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3733">i</span><span class="MJXp-mo" id="MJXp-Span-3734">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3735">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-3736" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737">k</span><span class="MJXp-mo" id="MJXp-Span-3738" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3739"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3740" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3741" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3742">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">i</span><span class="MJXp-mo" id="MJXp-Span-3744">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3745" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3746"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3747" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3748" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3749">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3750">j</span><span class="MJXp-mo" id="MJXp-Span-3751">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3752" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-381-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-381">G_{i, j} = k(\boldsymbol{x}^{(i)}, \boldsymbol{x}^{(j)})</script></span>. Xây dựng ma trận này có chi phí là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3754">O</span><span class="MJXp-mo" id="MJXp-Span-3755" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3758" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3759" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-382-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-382">O(m^2)</script></span>, một điều rõ ràng là không mong muốn với những tập dữ liệu có hàng tỉ mẫu. Từ năm 2006, học sâu đã bắt đầu được quan tâm trong giới nghiên cứu nhờ khả năng tổng quát những mẫu mới tốt hơn những thuật toán cạnh tranh khi huấn luyện trên tập dữ liệu có kích thước trung bình với khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3760"><span class="MJXp-mn" id="MJXp-Span-3761">10.000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-383-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-383">10.000</script></span> mẫu. Không lâu sau đó, học sâu tiếp tục nhận được sự quan tâm từ giới công nghiệp nhờ khả năng nâng quy mô huấn luyện mô hình phi tuyến tính trên tập dữ liệu lớn.</p><p>Trượt gradient ngẫu nhiên và những cải tiến của nó sẽ được miêu tả chi tiết trong chương 8.</p><h1 id="510-Xây-dựng-một-thuật-toán-học-máy"><a class="anchor hidden-xs" href="#510-Xây-dựng-một-thuật-toán-học-máy" title="510-Xây-dựng-một-thuật-toán-học-máy"><span class="octicon octicon-link"></span></a>5.10 Xây dựng một thuật toán học máy</h1><p>Gần như mọi thuật toán học sâu đều có thể được mô tả bằng một công thức khá đơn giản: kết hợp đặc điểm của một tập dữ liệu, một hàm chi phí, một phương pháp tối ưu hóa và một mô hình.</p><p>Ví dụ, thuật toán hồi quy tuyến tính kết hợp giữa một tập dữ liệu gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3762"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3763">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-384-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-384">\boldsymbol{X}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3764"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3765">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-385-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-385">\boldsymbol{y}</script></span>, hàm chi phí<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3766"><span class="MJXp-mtable" id="MJXp-Span-3767"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3768" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3769" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3770">J</span><span class="MJXp-mo" id="MJXp-Span-3771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3772">w</span><span class="MJXp-mo" id="MJXp-Span-3773" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3774">b</span><span class="MJXp-mo" id="MJXp-Span-3775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3776" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3777" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3778"><span class="MJXp-mrow" id="MJXp-Span-3779" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3780">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3781" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-3782"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3783">x</span></span><span class="MJXp-mo" id="MJXp-Span-3784">,</span><span class="MJXp-mtext" id="MJXp-Span-3785">y</span><span class="MJXp-mo" id="MJXp-Span-3786">∼</span><span class="MJXp-msubsup" id="MJXp-Span-3787"><span class="MJXp-mrow" id="MJXp-Span-3788" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3789"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3791" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3790">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3792" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3793">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3795">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3796">a</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3797">log</span><span class="MJXp-mo" id="MJXp-Span-3798" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3800" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3801" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-3802">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-3803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3804">y</span><span class="MJXp-mrow" id="MJXp-Span-3805"><span class="MJXp-mo" id="MJXp-Span-3806" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3807">x</span><span class="MJXp-mo" id="MJXp-Span-3808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3809" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-386-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-386">J(\boldsymbol{w},b)=-\mathbb{E}_{\mathbf{x},\text{y}\sim\hat{p}_{data}}\log p_{\text{model}}(y|\boldsymbol{x}),\tag{5.100}</script></span><br>
mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3810"><span class="MJXp-msubsup" id="MJXp-Span-3811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3812" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3813" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-3814">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-3815" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">y</span><span class="MJXp-mrow" id="MJXp-Span-3817"><span class="MJXp-mo" id="MJXp-Span-3818" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3819">x</span><span class="MJXp-mo" id="MJXp-Span-3820" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3821" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3822"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3823">N</span></span><span class="MJXp-mo" id="MJXp-Span-3824" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3825">y</span><span class="MJXp-mo" id="MJXp-Span-3826" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3827"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3828" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3829" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3830">w</span><span class="MJXp-mo" id="MJXp-Span-3831" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3832">b</span><span class="MJXp-mo" id="MJXp-Span-3833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3834">1</span><span class="MJXp-mo" id="MJXp-Span-3835" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-387-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-387">p_{\text{model}}(y|\boldsymbol{x})=\mathcal{N}(y;\boldsymbol{x}^\intercal\boldsymbol{w}+b,1)</script></span>, và trong phần lớn trường hợp, thuật toán tối ưu hóa được định nghĩa bằng cách tìm tham số mà tại đó gradient của hàm chi phí bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3836"><span class="MJXp-mn" id="MJXp-Span-3837">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-388-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-388">0</script></span> thông qua các phương trình chuẩn.</p><p>Nhận thấy rằng ta có thể thay thế bất kì thành phần nào ở trên một cách gần như độc lập với các thành phần khác, từ đó ta có thể tạo ra rất nhiều loại thuật toán.</p><p>Hàm chi phí thường chứa ít nhất một đại lượng đóng vai trò giúp quá trình học thực hiện ước lượng thống kê. Hàm chi phí phổ biến nhất là hàm đối của logarit hàm hợp lý, sao cho quá trình cực tiểu hóa hàm chi phí sẽ dẫn đến kết quả là ước lượng khi sử dụng hợp lý cực đại.</p><p>Hàm chi phí có thể chứa bao gồm đại lượng khác, chẳng hạn như các số hạng kiểm soát. Ví dụ, ta có thể thêm suy giảm trọng số vào hàm chi phí của hồi quy tuyến tính để thu được<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3838"><span class="MJXp-mtable" id="MJXp-Span-3839"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3840" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3841" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3842">J</span><span class="MJXp-mo" id="MJXp-Span-3843" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3844">w</span><span class="MJXp-mo" id="MJXp-Span-3845" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">b</span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3848" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3849">λ</span><span class="MJXp-mrow" id="MJXp-Span-3850"><span class="MJXp-mo" id="MJXp-Span-3851" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-3852"><span class="MJXp-mo" id="MJXp-Span-3853" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3854">w</span><span class="MJXp-mrow" id="MJXp-Span-3855"><span class="MJXp-mo" id="MJXp-Span-3856" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3857"><span class="MJXp-mrow" id="MJXp-Span-3858" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3859" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3861">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3860">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3862" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3863"><span class="MJXp-mrow" id="MJXp-Span-3864" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3865">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3866" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-3867"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3868">x</span></span><span class="MJXp-mo" id="MJXp-Span-3869">,</span><span class="MJXp-mrow" id="MJXp-Span-3870"><span class="MJXp-mi" id="MJXp-Span-3871">y</span></span><span class="MJXp-mo" id="MJXp-Span-3872">∼</span><span class="MJXp-msubsup" id="MJXp-Span-3873"><span class="MJXp-mrow" id="MJXp-Span-3874" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3875"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3877" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3876">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3878" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3879">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3881">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3882">a</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3883">log</span><span class="MJXp-mo" id="MJXp-Span-3884" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3886" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3887" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-3888">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-3889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3890">y</span><span class="MJXp-mrow" id="MJXp-Span-3891"><span class="MJXp-mo" id="MJXp-Span-3892" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3893">x</span><span class="MJXp-mo" id="MJXp-Span-3894" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3895" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-389-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-389">J(\boldsymbol{w},b)=\lambda||\boldsymbol{w}||^2_2-\mathbb{E}_{\mathbf{x},\mathrm{y}\sim\hat{p}_{data}}\log p_{\text{model}}(y|\boldsymbol{x}).\tag{5.101}</script></span></p><p>Hàm này vẫn cho phép ta thu được lời giải tối ưu ở dạng công thức đóng.</p><p>Nếu ta thay đổi mô hình thành dạng phi tuyến tính thì hầu hết các hàm chi phí đều không còn được tối ưu ở dạng đóng. Điều này này đòi hỏi ta phải chọn một phương pháp tối ưu theo vòng lặp, chẳng hạn như trượt gradient.</p><p>Công thức chung để xây dựng thuật toán học bằng việc kết hợp các mô hình, hàm chi phí và thuật toán tối ưu có thể được sử dụng cho các phương thức học có giám sát hoặc không giám sát. Ví dụ về hồi quy tuyến tính cho thấy cách mà công thức này áp dụng cho bài toán học có giám sát. Đối với học không giám sát, ta có thể định nghĩa một tập dữ liệu chỉ chứa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3896"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3897">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-390-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-390">\boldsymbol{X}</script></span> và cung cấp một hàm chi phí và mô hình không giám sát phù hợp. Ví dụ, ta có thể thu được vector phân tích thành phần chính đầu tiên bằng cách chỉ rõ hàm mất mát là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3898"><span class="MJXp-mtable" id="MJXp-Span-3899"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3900" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3901" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3902">J</span><span class="MJXp-mo" id="MJXp-Span-3903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3904">w</span><span class="MJXp-mo" id="MJXp-Span-3905" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3906" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3907"><span class="MJXp-mrow" id="MJXp-Span-3908" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3909">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3910" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-3911"><span class="MJXp-mi" id="MJXp-Span-3912">x</span></span><span class="MJXp-mo" id="MJXp-Span-3913">∼</span><span class="MJXp-msubsup" id="MJXp-Span-3914"><span class="MJXp-mrow" id="MJXp-Span-3915" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3916"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3918" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3917">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3919" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-3920">data</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3921"><span class="MJXp-mo" id="MJXp-Span-3922" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-3923"><span class="MJXp-mo" id="MJXp-Span-3924" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3925">x</span><span class="MJXp-mo" id="MJXp-Span-3926" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3927">r</span><span class="MJXp-mo" id="MJXp-Span-3928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3929">x</span><span class="MJXp-mo" id="MJXp-Span-3930" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3931">w</span><span class="MJXp-mo" id="MJXp-Span-3932" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-3933"><span class="MJXp-mo" id="MJXp-Span-3934" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3935"><span class="MJXp-mrow" id="MJXp-Span-3936" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3937" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3939">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3938">2</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-391-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-391">J(\boldsymbol{w})=\mathbb{E}_{\mathrm x\sim \hat{p}_{\text{data}}}||\boldsymbol{x}-r(\boldsymbol{x};\boldsymbol{w})||^2_2\tag{5.102}</script></span></p><p>trong khi mô hình được định nghĩa để thu được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3940"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3941">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-392-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-392">\boldsymbol{w}</script></span> có chuẩn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3942"><span class="MJXp-mn" id="MJXp-Span-3943">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-393-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-393">1</script></span> và hàm khôi phục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3945">r</span><span class="MJXp-mo" id="MJXp-Span-3946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3947">x</span><span class="MJXp-mo" id="MJXp-Span-3948" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3949" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3950"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3951" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3952" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3953">x</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3954">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-394-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-394">r(\boldsymbol{x})=\boldsymbol{w}^\intercal\boldsymbol{xw}</script></span>.</p><p>Trong một số trường hợp, hàm chi phí có thể là một hàm mà về mặt tính toán ta không thể định trị được. Khi đó, ta vẫn có thể tối thiểu hóa nó một cách gần đúng bằng phương pháp tối ưu theo vòng lặp chừng nào ta còn có thể xấp xỉ các gradient của hàm.</p><p>Hầu hết các thuật toán học máy đều có thể sử dụng công thức ở trên, mặc dù không phải trường hợp nào công thức này cũng rõ ràng. Với một thuật toán học máy có vẻ rất độc đáo hoặc do ai đó tự thiết kế, ta vẫn thường có thể coi như nó được tạo ra bằng một phép tối ưu đặc biệt. Một số mô hình như cây quyết định hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-395-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-395">k</script></span>-means cần phải có phép tối ưu đặc biệt vì hàm chi phí của chúng có các vùng phẳng, vốn không phù hợp để cực tiểu hóa bằng các phép tối ưu dựa trên gradient. Việc đưa hầu hết các thuật toán học máy về công thức chung này giúp ta nhìn nhận các thuật toán khác nhau như một phần của sự phân loại các phương pháp thực hiện những tác vụ có liên quan, hơn là một danh sách dài các thuật toán mà mỗi trong số đó lại có các cách giải thích cách thức hoạt động riêng biệt.</p><h1 id="511-Những-thách-thức-thúc-đẩy-sự-phát-triển-của-học-sâu"><a class="anchor hidden-xs" href="#511-Những-thách-thức-thúc-đẩy-sự-phát-triển-của-học-sâu" title="511-Những-thách-thức-thúc-đẩy-sự-phát-triển-của-học-sâu"><span class="octicon octicon-link"></span></a>5.11 Những thách thức thúc đẩy sự phát triển của học sâu</h1><p>Các thuật toán học máy đơn giản được mô tả ở chương này hoạt động tốt cho một loạt các bài toán quan trọng. Dù vậy, chúng vẫn chưa giải quyết được các vấn đề trọng tâm của trí tuệ nhân tạo, chẳng hạn là nhận biết giọng nói hay nhận dạng vật thể.</p><p>Sự phát triển của học sâu đã được thúc đẩy một phần từ những thất bại của các thuật toán truyền thống trong việc đạt được sự tổng quát hóa tốt trong các tác vụ trí tuệ nhân tạo.</p><p>Phần này thảo luận về việc những thách thức trong việc tổng quát hóa các mẫu dữ liệu mới sẽ trở nên khó khăn gấp bội như thế nào khi làm việc với dữ liệu nhiều chiều, và việc các cơ chế được sử dụng để tổng quát hóa trong học máy truyền thống là chưa đủ để học các hàm phức tạp trong không gian đa chiều. Những không gian này yêu cầu khối lượng tính toán khá lớn, và học sâu được thiết kế với mục đích chính là để giải quyết những thách thức như vậy.</p><h2 id="5111-Hiểm-họa-số-chiều-lớn"><a class="anchor hidden-xs" href="#5111-Hiểm-họa-số-chiều-lớn" title="5111-Hiểm-họa-số-chiều-lớn"><span class="octicon octicon-link"></span></a>5.11.1 Hiểm họa số chiều lớn</h2><p>Nhiều vấn đề của học máy sẽ trở nên cực kì khó khăn khi dữ liệu có nhiều chiều. Hiện tượng này được gọi là <strong>hiểm họa số chiều lớn</strong> (the curse of dimensionality). Mối quan tâm cụ thể ở đây là số lượng cấu hình khác nhau có thể có của một tập hợp các biến sẽ tăng theo cấp số mũ khi số lượng các biến tăng lên.</p><p>Hiểm họa số chiều lớn xảy ra ở rất nhiều lĩnh vực trong ngành khoa học máy tính, đặc biệt là học máy.</p><p><img src="https://i.imgur.com/EjJSk74.jpg" alt=""></p><blockquote>
<p>Hình 5.9: Khi số chiều của dữ liệu tăng lên (từ trái qua phải), số lượng cấu hình cần xét đến có thể tăng theo cấp số mũ. <em>(Hình bên trái)</em> Trong ví dụ một chiều này, ta có một biến mà ở đó chỉ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3957"><span class="MJXp-mn" id="MJXp-Span-3958">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-396-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-396">10</script></span> vùng cần quan tâm để phân biệt. Khi có đủ số lượng mẫu rơi vào mỗi vùng (mỗi vùng được thể hiện bằng một ô vuông), các thuật toán học tập có thể dễ dàng tổng quát hóa một cách chính xác. Một cách tổng quát hóa đơn giản là ước lượng giá trị của hàm đích trong mỗi vùng (và có thể nội suy giữa các vùng lân cận). <em>(Hình ở giữa)</em> Với dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3959"><span class="MJXp-mn" id="MJXp-Span-3960">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-397-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-397">2</script></span> chiều, việc phân biệt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3961"><span class="MJXp-mn" id="MJXp-Span-3962">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-398-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-398">10</script></span> giá trị khác nhau của mỗi biến sẽ trở nên khó khăn hơn. Ta phải theo dõi đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3963"><span class="MJXp-mn" id="MJXp-Span-3964">10</span><span class="MJXp-mo" id="MJXp-Span-3965" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-3966">10</span><span class="MJXp-mo" id="MJXp-Span-3967" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3968">100</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-399-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-399">10 \times 10 = 100</script></span> vùng, và cần ít nhất chừng đó mẫu để phủ hết các vùng này. <em>(Hình bên phải)</em> Khi tăng số chiều lên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3969"><span class="MJXp-mn" id="MJXp-Span-3970">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-400-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-400">3</script></span>, số vùng sẽ là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3971"><span class="MJXp-msubsup" id="MJXp-Span-3972"><span class="MJXp-mn" id="MJXp-Span-3973" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3974" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-3975" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3976">1.000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-401-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-401">10^3 = 1.000</script></span> và cũng cần ít nhất chừng đó mẫu. Một cách tổng quát, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3978">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-402-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-402">d</script></span> chiều và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3980">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-403-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-403">v</script></span> giá trị, ta sẽ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3982">O</span><span class="MJXp-mo" id="MJXp-Span-3983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3985" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3986" style="vertical-align: 0.5em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-3987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-404-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-404">O(v^d)</script></span> vùng và mẫu để phân biệt các giá trị trên mỗi trục tọa độ. Đây là một ví dụ về hiểm họa số chiều lớn. Hình ảnh được cung cấp bởi Nicolas Chapados.</p>
</blockquote><p>Một thách thức đặt ra bởi hiểm họa số chiều lớn là thách thức về thống kê. Như mô tả trong hình 5.9, thách thức về thống kê xuất hiện khi số lượng cấu hình cần xem xét của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3988"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3989">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-405-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-405">\boldsymbol{x}</script></span> lớn hơn rất nhiều so với số lượng mẫu huấn luyện. Để hiểu vấn đề này, xét không gian đầu vào được tổ chức thành dạng lưới như trong ví dụ trên. Ta có thể mô tả không gian số chiều nhỏ với một lượng nhỏ các ô và hầu hết đều chứa dữ liệu. Khi tổng quát cho một điểm dữ liệu mới, ta có thể dễ dàng biết cần phải làm gì thông qua kiểm thử các mẫu huấn luyện nằm trong cùng ô với đầu vào mới đó. Ví dụ, nếu cần ước lượng mật độ xác suất ở một điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3990"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3991">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-406-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-406">\boldsymbol{x}</script></span> nào đó, ta có thể chỉ cần trả về số mẫu huấn luyện nằm trong cùng đơn vị thể tích với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3992"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3993">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-407-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-407">\boldsymbol{x}</script></span>, chia cho tổng số mẫu huấn luyện. Nếu muốn phân loại một mẫu, ta có thể trả về lớp có số mẫu huấn luyện nhiều nhất trong cùng một ô.</p><p>Còn nếu cần thực hiện phép hồi quy, ta chỉ cần tính trung bình các giá trị đích của các mẫu quan sát được trong ô đó. Còn những ô không chứa mẫu thì sao? Vì trong không gian nhiều chiều, số lượng cấu hình là cực lớn, hơn rất nhiều so với số mẫu ta có, thường thì một ô sẽ không có mẫu dữ liệu nào nằm trong đó. Liệu ta có thể kết luận gì về những cấu hình mới này? Nhiều thuật toán học máy truyền thống chỉ đơn giản là giả định rằng đầu ra tại một điểm mới nên xấp xỉ đầu ra tại điểm huấn luyện gần nhất.</p><h2 id="5112-Tính-bất-biến-cục-bộ-và-cơ-chế-kiểm-soát-độ-trơn"><a class="anchor hidden-xs" href="#5112-Tính-bất-biến-cục-bộ-và-cơ-chế-kiểm-soát-độ-trơn" title="5112-Tính-bất-biến-cục-bộ-và-cơ-chế-kiểm-soát-độ-trơn"><span class="octicon octicon-link"></span></a>5.11.2 Tính bất biến cục bộ và cơ chế kiểm soát độ trơn</h2><p>Để tổng quát hóa tốt, các thuật toán học máy cần được dẫn dắt bởi các kinh nghiệm tiên đề về loại hàm mà chúng sẽ học. Chúng ta đã thấy những tiên nghiệm này được kết hợp như dưới dạng các phân bố xác suất của các tham số trong mô hình. Nói một cách tương đối hơn, ta có thể cho rằng kinh nghiệm tiên nghiệm ảnh hưởng đến chính hàm ta cần học một cách trực tiếp, và chỉ ảnh hưởng các tham số mô hình một cách gián tiếp. Sự ảnh hưởng gián tiếp này là do mối quan hệ giữa hàm và các tham số đó. Ngoài ra, ta đã thảo luận về kinh nghiệm tiên đề như một cách chọn ngầm định các thuật toán có tính thiên vị một lớp hàm nào đó hơn các lớp khác, mặc dù sự thiên vị này có thể không được diễn tả (hay thậm chí là không thể diễn tả) bằng một phân phối xác suất biểu diễn mức độ tin tưởng của ta đối với các hàm khác nhau.</p><p>Trong số rất nhiều “tiên nghiệm” ngầm định được sử dụng rộng rãi, người ta quan tâm nhiều đến <strong>tiên nghiệm về tính trơn</strong> (smoothness prior), hay <strong>tiên nghiệm về tính bất biến cục bộ</strong> (local constancy prior). Những tiên nghiệm này cho rằng hàm mà chúng ta cần học không nên thay đổi quá nhiều trong một khoảng nhỏ.</p><p>Nhiều thuật toán đơn giản hơn chủ yếu dựa vào tiên nghiệm này để tổng quát hóa tốt hơn, nhưng cũng vì thế mà chúng không thể mở rộng để giải quyết những thách thức thống kê trong trí tuệ nhân tạo. Xuyên suốt cuốn sách này, chúng tôi mô tả cách mà học sâu đưa ra những tiên nghiệm (tường minh hoặc ngầm định) bổ sung để giảm sai số tổng quát hóa trong những tác vụ phức tạp. Ở đây, chúng tôi sẽ giải thích tại sao chỉ một mình tiên nghiệm về tính trơn là không đủ để giải quyết những tác vụ này.</p><p>Có nhiều cách khác nhau để diễn tả một cách ngầm định hoặc tường minh rằng hàm học tập cần có tính trơn hoặc bất biến cục bộ. Tất cả những phương pháp khác nhau này được thiết kế để khuyến khích quá trình học tìm ra một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3994"><span class="MJXp-msubsup" id="MJXp-Span-3995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3996" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3997" style="vertical-align: 0.5em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-408-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-408">f^*</script></span> thỏa mãn điều kiện sau</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3998"><span class="MJXp-mtable" id="MJXp-Span-3999"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4000" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4001" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-4002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4004" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-4005" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4006">x</span><span class="MJXp-mo" id="MJXp-Span-4007" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4008" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-msubsup" id="MJXp-Span-4009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4010" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4011" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-4012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4013">x</span><span class="MJXp-mo" id="MJXp-Span-4014" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4015">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4016" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-409-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-409">f^*(\boldsymbol{x})\approx f^*(\boldsymbol{x}+\epsilon) \tag{5.103} </script></span></p><p>với hầu hết các cấu hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4017"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4018">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-410-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-410">\boldsymbol{x}</script></span> và thay đổi nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4020">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-411-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-411">\epsilon</script></span>. Nói cách khác, nếu ta biết được một câu trả lời tốt cho một đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4021"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4022">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-412-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-412">\boldsymbol{x}</script></span> (chẳng hạn, nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4023"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4024">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-413-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-413">\boldsymbol{x}</script></span> là một mẫu đã được gán nhãn), thì nó cũng có thể là câu trả lời tốt cho các điểm lân cận của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4025"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4026">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-414-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-414">\boldsymbol{x}</script></span>. Nếu có một số câu trả lời tốt cho một số điểm lân cận nhau, ta có thể kết hợp chúng lại (dưới dạng trung bình cộng hoặc nội suy) để đưa ra một câu trả lời tương đồng với những câu trả lời trên càng nhiều càng tốt.</p><p>Một ví dụ cực đoan về hướng tiếp cận bất biến cục bộ là họ các thuật toán học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4028">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-415-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-415">k</script></span> điểm gần nhất. Những bộ dự đoán này là bất biến trên mỗi vùng chứa tất cả các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4030">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-416-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-416">\boldsymbol{x}</script></span> mà có cùng tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4032">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-417-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-417">k</script></span> điểm gần nhất trong tập huấn luyện. Với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4034">k</span><span class="MJXp-mo" id="MJXp-Span-4035" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4036">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-418-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-418">k=1</script></span>, số vùng có thể phân tách không thể lớn hơn số mẫu dữ liệu trong tập huấn luyện.</p><p>Trong khi thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4038">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-419-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-419">k</script></span> điểm gần nhất tính toán đầu ra dựa vào những mẫu dữ liệu nằm lân cận nó thì hầu hết các máy lõi nội suy giữa các giá trị đầu ra của tập huấn luyện gắn với những điểm lân cận. Một lớp hàm lõi quan trọng là họ các <strong>hàm lõi cục bộ</strong> (local kernel), trong đó giá trị của kernel <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4040">k</span><span class="MJXp-mo" id="MJXp-Span-4041" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4042">u</span><span class="MJXp-mo" id="MJXp-Span-4043" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4044">v</span><span class="MJXp-mo" id="MJXp-Span-4045" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-420-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-420">k(\boldsymbol u, \boldsymbol v)</script></span> là lớn khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4046"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4047">u</span><span class="MJXp-mo" id="MJXp-Span-4048" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4049">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-421-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-421">\boldsymbol u = \boldsymbol v</script></span> và giảm dần khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4050"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4051">u</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-422-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-422">\boldsymbol u</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4052"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4053">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-423-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-423">\boldsymbol v</script></span> càng xa nhau. Một hàm lõi cục bộ có thể được coi như một hàm tính độ tương đồng thực hiện việc ghép bản mẫu, bằng cách đo lường mức độ tương tự giữa một mẫu kiểm thử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4054"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4055">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-424-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-424">\boldsymbol x</script></span> với mỗi mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4056"><span class="MJXp-msubsup" id="MJXp-Span-4057"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4058" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4059" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4060">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4061">i</span><span class="MJXp-mo" id="MJXp-Span-4062">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-425-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-425">\boldsymbol x^{(i)}</script></span>. Nhiều động lực của học sâu hiện đại được thúc đẩy từ việc tìm hiểu các giới hạn của phương pháp ghép bản mẫu cục bộ và cách thức các mô hình học sâu có thể xử lý thành công những trường hợp mà các phương pháp ghép bản mẫu cục bộ thất bại [Bengio et al., 2006b].</p><p>Các cây quyết định cũng có những giới hạn của phương pháp học dựa trên tính trơn, bởi lẽ chúng chia nhỏ không gian đầu vào thành các vùng với số lượng bằng số lá của cây và sử dụng một tham số (hoặc đôi khi là nhiều hơn một tham số đối với các mở rộng của cây quyết định) phân tách trong mỗi vùng. Nếu hàm mục tiêu yêu cầu một cây với ít nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4064">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-426-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-426">n</script></span> lá để được biểu diễn một cách chính xác, thì cần tối thiểu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4066">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-427-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-427">n</script></span> mẫu để khớp cái cây đó, và một bội số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-428-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-428">n</script></span> các mẫu huấn luyện để đạt được mức độ tin cậy thống kê nào đó ở kết quả dự đoán.</p><p>Nhìn chung, để phân biệt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4070">O</span><span class="MJXp-mo" id="MJXp-Span-4071" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4072">k</span><span class="MJXp-mo" id="MJXp-Span-4073" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-429-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-429">O(k)</script></span> vùng trong không gian mẫu, tất cả những phương pháp này đòi hỏi cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4075">O</span><span class="MJXp-mo" id="MJXp-Span-4076" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4077">k</span><span class="MJXp-mo" id="MJXp-Span-4078" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-430-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-430">O(k)</script></span> mẫu. Thông thường sẽ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4080">O</span><span class="MJXp-mo" id="MJXp-Span-4081" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4082">k</span><span class="MJXp-mo" id="MJXp-Span-4083" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-431-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-431">O(k)</script></span> tham số, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4085">O</span><span class="MJXp-mo" id="MJXp-Span-4086" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4087">1</span><span class="MJXp-mo" id="MJXp-Span-4088" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-432-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-432">O(1)</script></span> tham số gắn với mỗi vùng trong số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4090">O</span><span class="MJXp-mo" id="MJXp-Span-4091" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4092">k</span><span class="MJXp-mo" id="MJXp-Span-4093" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-433-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-433">O(k)</script></span> vùng. Trong thuật toán điểm gần nhất, ở đó mỗi mẫu huấn luyện có thể được sử dụng để định nghĩa tối đa một vùng, được minh họa trong hình 5.10.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4094"><span class="MJXp-mspace" id="MJXp-Span-4095" style="width: 23.622em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-434-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-434">\hspace{10 cm}</script></span><br>
<img src="https://i.imgur.com/bx2euyI.png" alt=""></p><blockquote>
<p>Hình 5.10: Minh họa cách giải thuật điểm gần nhất chia không gian đầu vào thành các vùng. Một mẫu huấn luyện (được biểu diễn bằng một đường tròn) bên trong mỗi vùng xác định biên của vùng (được biểu diễn bằng các đường kẻ). Giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-435-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-435">y</script></span> ứng tới mỗi mẫu xác định giá trị đầu ra cho tất cả các điểm trong vùng tương ứng. Những vùng được định nghĩa bởi phép so khớp với điểm gần nhất tạo nên một cấu trúc hình học được gọi là <em>lược đồ Voronoi</em> (Voronoi diagram). Số lượng các vùng tiếp giáp này không thể tăng nhanh hơn số mẫu huấn luyện. Mặc dù hình này minh họa hoạt động cụ thể của giải thuật điểm gần nhất nhưng những thuật toán học máy khác chỉ dựa trên tiên nghiệm về tính trơn cục bộ để khái quát hóa cũng có hành vi tương tự: mỗi mẫu huấn luyện chỉ cung cấp cho thuật toán học về cách tổng quát hóa trong một số vùng lân cận xung quanh mẫu huấn luyện đó.</p>
</blockquote><p>Liệu có một cách biểu diễn một hàm phức tạp có nhiều vùng cần được phân biệt hơn số mẫu huấn luyện không? Rõ ràng, chỉ giả định về tính trơn của hàm không cho phép thuật toán học tập làm điều đó. Ví dụ, hình dung rằng hàm cần học có dạng một bàn cờ. Một bàn cờ có nhiều biến thể nhưng chúng có chung một cấu trúc đơn giản. Tưởng tượng xem điều gì xảy ra khi mà số lượng mẫu huấn luyện nhỏ hơn đáng kể số lượng các ô vuông trắng và đen trên bàn cờ. Chỉ dựa trên khái quát hóa cục bộ và tính trơn hay tiên đề về tính bất biến cục bộ, thuật toán học tập có thể đảm bảo đoán đúng màu của một điểm mới nếu nó nằm trong cùng ô bàn cờ với một mẫu huấn luyện. Nhưng sẽ không có gì đảm bảo rằng thuật toán học tập có thể mở rộng chính xác đối với các điểm nằm trên ô vuông không có mẫu huấn luyện. Chỉ với tiên đề này, thông tin duy nhất mà một mẫu cho ta biết là màu của ô bàn cờ chứa nó, và cách duy nhất để biết được màu chính xác của cả bản cờ là phủ mỗi ô của nó với ít nhất một mẫu huấn luyện.</p><p>Giả thiết về tính trơn và các thuật toán học tập không có tham số gắn với nó sẽ hoạt động rất tốt khi có đủ mẫu huấn luyện để thuật toán học tập quan sát các điểm nằm trên hầu hết các đỉnh và các điểm nằm dưới hầu hết các thung lũng của hàm ta cần học. Điều này thường đúng khi mà hàm được học là đủ trơn và biến thiên trong số chiều đủ thấp. Trong trường hợp số chiều lớn, ngay cả một hàm trơn cũng có thể thay đổi mượt mà nhưng theo một cách khác nhau theo mỗi chiều. Ngoài ra, nếu đặc tính của hàm này khác nhau tại nhiều vùng, việc mô tả nó thông qua một tập các mẫu huấn luyện sẽ trở nên rất phức tạp. Nếu một hàm là phức tạp (chẳng hạn như muốn phân biệt một số lượng các vùng rất lớn so với số mẫu huấn luyện), liệu ta có thể khái quát hóa tốt hay không?</p><p>Câu trả lời cho cả hai câu hỏi này - liệu ta có thể biểu diễn một hàm phức tạp hiệu quả, và liệu hàm ước lượng có thể tổng quát hóa tốt cho các giá trị đầu vào mới - là có. Lí do chính là đối với một số lượng lớn các vùng, chẳng hạn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4099">O</span><span class="MJXp-mo" id="MJXp-Span-4100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4101"><span class="MJXp-mn" id="MJXp-Span-4102" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4103" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-4104" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-436-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-436">O(2^k)</script></span>, có thể được xác định với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4106">O</span><span class="MJXp-mo" id="MJXp-Span-4107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4108">k</span><span class="MJXp-mo" id="MJXp-Span-4109" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-437-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-437">O(k)</script></span> mẫu huấn luyện miễn là ta đưa vào một vài mối liên hệ giữa các vùng thông qua các giả thiết bổ sung về phân phối sinh dữ liệu thực tế. Với cách này, ta có thể khái quát hóa một cách không cục bộ [Bengio and Monperrus, 2005; Bengio et al., 2006c]. Rất nhiều các thuật toán học sâu khác nhau cung cấp các giả thiết khá hợp lý một cách ngầm định hoặc tường minh cho một loạt các tác vụ trí tuệ nhân tạo để nắm bắt những lợi thế này.</p><p>Những cách tiếp cận khác đối với học máy thường đặt ra các giả định mạnh hơn và cụ thể cho từng tác vụ. Ví dụ, ta có thể dễ dàng giải quyết tác vụ bàn cờ phía trên bằng cách đưa vào giả định rằng hàm cần học có tính chu kỳ. Thông thường, ta sẽ không đưa các giả định mạnh và cụ thể cho từng tác vụ như vậy vào mạng neuron nhân tạo để chúng có thể tổng quát hóa nhiều cấu trúc khác nhau hơn. Các tác vụ trí tuệ nhân tạo có cấu trúc quá phức tạp để có thể mô tả bằng những tính chất đơn giản, có các đặc tính được chỉ định một cách thủ công như chu kỳ, vì vậy ta cần các thuật toán học thể hiện các giả định có mục đích chung chung hơn. Ý tưởng cốt lõi trong học sâu là giả định rằng dữ liệu được tạo ra bởi <em>sự tổng hợp các các thành tố</em> (composition of factors) hoặc các <em>đặc trưng</em> (feature), tiềm năng ở nhiều cấp độ trong một hệ thống phân cấp. Nhiều giả định chung tương tự khác có thể cải thiện các thuật toán học sâu hơn nữa. Những giả định này cho phép lợi ích ta nhận được, trong mối quan hệ giữa số lượng mẫu huấn luyện và số vùng có thể phân biệt được, tăng theo cấp số mũ. Chúng tôi sẽ mô tả những lợi ích tăng theo cấp số mũ này trong phần 6.4.1, 15.4 và 15.5. Các lợi ích này đạt được nhờ việc sử dụng các biển diễn phân tán đa tầng để đối phó với những thách thức theo cấp số mũ gây bởi hiểm họa số chiều lớn.</p><h2 id="5113-Học-đa-tạp"><a class="anchor hidden-xs" href="#5113-Học-đa-tạp" title="5113-Học-đa-tạp"><span class="octicon octicon-link"></span></a>5.11.3 Học đa tạp</h2><p>Một khái niệm quan trọng làm nền tảng cho nhiều ý tưởng trong học máy là <em>đa tạp</em> (manifold).</p><p>Một <strong>đa tạp</strong> là một vùng liên thông. Về mặt toán học, nó là một tập hợp các điểm liên kết với một lân cận xung quanh mỗi điểm. Từ một điểm bất kì, đa tạp, về mặt cục bộ, giống như một không gian Euclid. Trong cuộc sống hàng ngày, chúng ta thường nghĩ bề mặt của Trái Đất là một mặt phẳng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4110"><span class="MJXp-mn" id="MJXp-Span-4111">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-438-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-438">2</script></span> chiều, nhưng thực tế nó là một đa tạp hình cầu trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4112"><span class="MJXp-mn" id="MJXp-Span-4113">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-439-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-439">3</script></span> chiều.</p><p>Khái niệm về một lân cận xung quanh mỗi điểm ngụ ý sự tồn tại của các phép biến hình được áp dụng để di chuyển trên đa tạp từ một vị trí đến một vị trí lân cận. Trong ví dụ bề mặt Trái Đất là một đa tạp, một người có thể đi về phía Đông, Tây, Nam, hoặc Bắc.</p><blockquote>
<p><em><strong>ND</strong></em>: Xem thêm về đa tạp <a href="https://diendantoanhoc.net/intercalic/169757-gi%C6%A1%CC%81i-thi%C3%AA%CC%A3u-v%C3%AA%CC%80-%C4%91%C6%B0%C6%A1%CC%80ng-cong-va%CC%80-%C4%91a-ta%CC%A3p/" target="_blank" rel="noopener">tại đây</a>.</p>
</blockquote><p>Mặc dù chúng ta có một khái niệm toán học chính thức để diễn tả ý nghĩa của từ “đa tạp”, nhưng trong học máy, nó được sử dụng một cách đại khái để chỉ định một tập hợp các điểm liên thông với nhau mà ta có thể xấp xỉ gần đúng chỉ bằng việc xét một số lượng nhỏ bậc tự do, hoặc số chiều, được nhúng trong một không gian nhiều chiều. Mỗi chiều tương ứng với một phương biến thiên cục bộ. Hình 5.11 cho ta thấy ví dụ về tập huấn luyện nằm gần đa tạp một chiều được nhúng trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4114"><span class="MJXp-mn" id="MJXp-Span-4115">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-440-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-440">2</script></span> chiều. Trong phạm vi của học máy, chúng ta cho phép số chiều của đa tạp thay đổi từ một điểm tới một điểm khác. Điều này thường xảy ra khi một đa tạp tự giao cắt với chính nó. Chẳng hạn, xét một đa tạp có dạng hình số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4116"><span class="MJXp-mn" id="MJXp-Span-4117">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-441-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-441">8</script></span>. Đa tạp này là một chiều ở hầu hết mọi nơi, duy chỉ có điểm nằm ở vùng giao cắt tại trung tâm đa tạp là có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4118"><span class="MJXp-mn" id="MJXp-Span-4119">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-442-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-442">2</script></span> chiều.</p><p><img src="https://i.imgur.com/f1cGq8J.png" alt=""></p><blockquote>
<p>Hình 5.11: Dữ liệu được lấy mẫu từ một phân phối trong một không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4120"><span class="MJXp-mn" id="MJXp-Span-4121">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-443-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-443">2</script></span> chiều mà thực tế được tập trung gần một đa tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4122"><span class="MJXp-mn" id="MJXp-Span-4123">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-444-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-444">1</script></span> chiều, có hình dạng một dây xoắn. Đường liền mạch biểu thị phần đa tạp mà thuật toán học cần luận ra.</p>
</blockquote><p>Nhiều bài toán học máy có vẻ như vô vọng nếu chúng ta mong đợi thuật toán học máy phải học các hàm với các biến thiên theo mọi hướng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4124"><span class="MJXp-msubsup" id="MJXp-Span-4125"><span class="MJXp-mrow" id="MJXp-Span-4126" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4127">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4128" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-445-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-445">\mathbb R^n</script></span>. Các thuật toán <em>học đa tạp</em> (manifold learning) vượt qua trở ngại này bằng cách giả định rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4129"><span class="MJXp-msubsup" id="MJXp-Span-4130"><span class="MJXp-mrow" id="MJXp-Span-4131" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4132">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4133" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-446-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-446">\mathbb R^n</script></span> chứa hầu hết những dữ liệu đầu vào không hợp lệ, và các điểm đầu vào ta quan tâm chỉ xuất hiện dọc theo một tập các đa tạp chứa một tập con các điểm, với các biến thiên cần quan tâm ở đầu ra của hàm cần học chỉ xảy ra dọc theo đa tạp, hoặc các biến thiên cần quan tâm chỉ xảy ra khi chúng ta chuyển từ một đa tạp này sang một đa tạp khác. Học đa tạp được đưa vào trong trường hợp dữ liệu liên tục và học không giám sát, mặc dù ý tưởng tập trung xác suất này có thể được tổng quát hóa cho cả dữ liệu rời rạc và trong học có giám sát: giả định chính ở đây vẫn là khối xác suất được tập trung cao độ.</p><p>Giả định rằng dữ liệu nằm trên đa tạp ít chiều có thể không phải lúc nào cũng đúng hoặc hữu dụng. Chúng tôi cho rằng trong phạm vi của các tác vụ trí tuệ nhân tạo, ví dụ như trong xử lý ảnh, âm thanh hay văn bản, thì giả định về đa tạp ít nhất cũng gần đúng. Bằng chứng cho giả định này đến từ hai cách nhìn nhận.</p><p>Cách nhìn nhận thứ nhất ủng hộ <strong>giả thuyết đa tạp</strong> (manifold hypothesis), đó là phân phối xác suất của hình ảnh, chuỗi văn bản và âm thanh trong đời thực có tính tập trung cao. <em>Nhiễu đồng đều</em> (uniform noise) về cơ bản không bao giờ giống với dữ liệu đầu vào có cấu trúc từ những miền này.  Thay vào đó, hình 5.12 cho thấy các điểm được lấy mẫu đồng đều nhìn rất giống với các mô thức tĩnh được biểu thị trên màn hình tivi khi không có tín hiệu sóng. Tương tự, nếu bạn soạn thảo một tài liệu bằng cách chọn ra các chữ cái một cách đồng đều và ngẫu nhiên, thì xác suất mà bạn có được một văn bản có ý nghĩa là bao nhiêu? Câu trả lời là gần như bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4134"><span class="MJXp-mn" id="MJXp-Span-4135">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-447-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-447">0</script></span>, bởi vì hầu hết các chuỗi chữ cái dài đều không tương đồng với các chuỗi ngôn ngữ tự nhiên: phân phối của chuỗi ngôn ngữ tự nhiên chiếm một thể tích rất nhỏ trong tổng không gian của các chuỗi chữ cái.</p><p><img src="https://i.imgur.com/3z5Wtji.png" alt=""></p><blockquote>
<p>Hình 5.12 Lấy mẫu ảnh theo phân phối đồng đều (bằng cách lấy ra mỗi điểm ảnh ngẫu nhiên theo một phân phối đều) sẽ cho ra các ảnh nhiễu. Mặc dù xác suất tạo ra một bức ảnh có nghĩa là lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4136"><span class="MJXp-mn" id="MJXp-Span-4137">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-448-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-448">0</script></span>, nhưng chúng tôi chưa từng quan sát được hiện tượng này xảy ra trong thực tế. Điều này gợi ý cho ta rằng những bức ảnh xuất hiện trong các ứng dụng trí tuệ nhân tạo chỉ chiếm một tỷ lệ không đáng kể trong thể tích của không gian các hình ảnh.</p>
</blockquote><p>Tất nhiên, những phân phối có xác suất tập trung là chưa đủ để diễn tả việc dữ liệu nằm trên một số lượng nhỏ đa tạp. Ta cũng cần làm rõ rằng những mẫu dữ liệu ta gặp phải được liên kết với nhau bằng những mẫu khác, trong đó mỗi mẫu được bao quanh bởi các mẫu dữ liệu rất tương đồng mà ta có thể tiếp cận bằng cách áp dụng các phép biến hình để di chuyển trên đa tạp. Cách nhìn nhận thứ hai hỗ trợ cho giả thuyết đa tạp đó là chúng ta có thể tưởng tượng ra những vùng lân cận và phép biến hình, ít nhất là trên cục bộ. Xét trường hợp với các bức ảnh, ta có thể nghĩ ra nhiều phép biến hình khả thi cho phép lần theo dấu vết của một đa tạp trong không gian các hình ảnh: chúng ta có thể dần dần điều chỉnh độ sáng hoặc tối của ảnh, từ từ di chuyển hay xoay các vật thể trong ảnh, dần thay đổi màu trên bề mặt các vật thể, và nhiều phép biến hình khác nữa. Hầu hết các ứng dụng đều bao gồm nhiều đa tạp khác nhau. Ví dụ, đa tạp của các bức ảnh chụp khuôn mặt con người có thể không liên kết với đa tạp của các bức ảnh chụp khuôn mặt con mèo.</p><p>Những thí nghiệm này cho ta nhiều lý do trực quan giúp hỗ trợ cho giả thuyết đa tạp. Nhiều thí nghiệm chặt chẽ hơn [Cayton, 2005; Narayanan and Mitter, 2010; Schölkopf et al., 1998; Roweis and Saul, 2000; Tenenbaum et al., 2000; Brand, 2003; Belkin and Niyogi, 2003; Donoho and Grimes, 2003; Weinberger and Saul, 2004] hỗ trợ giả thuyết này trên nhiều bộ dữ liệu được quan tâm trong lĩnh vực trí tuệ nhân tạo.</p><p>Khi dữ liệu nằm trên một đa tạp số chiều thấp, các thuật toán học máy có thể biểu diễn dữ liệu một cách tự nhiên nhất dựa vào các tọa độ của đa tạp, thay vì các tọa độ trong tập hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4138"><span class="MJXp-msubsup" id="MJXp-Span-4139"><span class="MJXp-mrow" id="MJXp-Span-4140" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4141">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4142" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-449-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-449">\mathbb R^n</script></span>. Trong cuộc sống hàng ngày, ta có thể giả định các con đường bộ là các đa tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4143"><span class="MJXp-mn" id="MJXp-Span-4144">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-450-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-450">1</script></span> chiều được nhúng trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4145"><span class="MJXp-mn" id="MJXp-Span-4146">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-451-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-451">3</script></span> chiều. Chúng ta đưa ra chỉ dẫn để đi tới các địa điểm cụ thể dựa trên các số nhà dọc theo con đường <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4147"><span class="MJXp-mn" id="MJXp-Span-4148">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-452-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-452">1</script></span> chiều, chứ không phải dựa trên các tọa độ trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4149"><span class="MJXp-mn" id="MJXp-Span-4150">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-453-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-453">3</script></span> chiều. Việc trích xuất những tọa độ đa tạp này là một thách thức, nhưng lại có tiềm năng cải thiện được rất nhiều các thuật toán học máy. Quy tắc căn bản này được áp dụng trong nhiều ngữ cảnh. Hình 5.13 cho thấy cấu trúc đa tạp của một bộ dữ liệu bao gồm các khuôn mặt. Đến cuối cuốn sách này, chúng tôi sẽ phát triển các phương pháp cần thiết để học những cấu trúc đa tạp như vậy. Trong hình 20.6, ta sẽ thấy cách một thuật toán học máy hoàn thành mục tiêu này như nào.</p><p><img src="https://i.imgur.com/8K2l9QC.png" alt=""></p><blockquote>
<p>Hình 5.3:  Các mẫu huấn luyện thu được từ Bộ dữ liệu khuôn mặt Đa góc nhìn QMUL [Gong et al., 2000], trong đó các đối tượng được yêu cầu di chuyển khuôn mặt theo cách nhất định để biểu diễn đa tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4151"><span class="MJXp-mn" id="MJXp-Span-4152">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-454-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-454">2</script></span> chiều tương ứng với hai góc quay. Chúng ta muốn các thuật toán học có khả năng khám phá và xử lý các tọa độ đa tạp. Hình 20.60 minh họa một quá trình như vậy.</p>
</blockquote><p>Phần I kết thúc ở đây, chúng tôi đã điểm qua những khái niệm cơ bản trong toán học và học máy sẽ đi theo ta xuyên suốt các phần còn lại của cuốn sách. Bây giờ các bạn đã được chuẩn bị một cách đầy đủ để tiếp tục nghiên cứu về học sâu.</p><hr><p>Người dịch: Pham Dinh Khanh, Tran Hoang Son, Nguyen Thanh Chinh, Soan Duong, Ngoc Tien Phan, HieuDC, Xuan Tu, NguyenTT, dzu.gidiel, linux, Hung Le, LA</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-5-Học-máy-cơ-bản-giai-đoạn-2" title="Chương 5: Học máy cơ bản (giai đoạn 2)">Chương 5: Học máy cơ bản (giai đoạn 2)</a><ul class="nav">
<li><a href="#543-Phương-sai-và-sai-số-chuẩn" title="5.4.3 Phương sai và sai số chuẩn">5.4.3 Phương sai và sai số chuẩn</a></li>
<li><a href="#544-Đánh-đổi-giữa-độ-chệch-và-phương-sai-để-cực-tiểu-hóa-trung-bình-của-bình-phương-sai-số" title="5.4.4 Đánh đổi giữa độ chệch và phương sai để cực tiểu hóa trung bình của bình phương sai số.">5.4.4 Đánh đổi giữa độ chệch và phương sai để cực tiểu hóa trung bình của bình phương sai số.</a></li>
<li><a href="#545-Tính-nhất-quán" title="5.4.5 Tính nhất quán">5.4.5 Tính nhất quán</a></li>
</ul>
</li>
<li><a href="#55-Ước-lượng-hợp-lý-cực-đại" title="5.5 Ước lượng hợp lý cực đại">5.5 Ước lượng hợp lý cực đại</a><ul class="nav">
<li><a href="#551-Logarit-hợp-lý-có-điều-kiện-và-sai-số-bình-phương-trung-bình" title="5.5.1 Logarit hợp lý có điều kiện và sai số bình phương trung bình">5.5.1 Logarit hợp lý có điều kiện và sai số bình phương trung bình</a></li>
<li><a href="#552-Các-tính-chất-của-phương-pháp-hợp-lý-cực-đại" title="5.5.2 Các tính chất của phương pháp hợp lý cực đại">5.5.2 Các tính chất của phương pháp hợp lý cực đại</a></li>
</ul>
</li>
<li><a href="#56-Thống-kê-Bayes" title="5.6 Thống kê Bayes">5.6 Thống kê Bayes</a><ul class="nav">
<li><a href="#561-Ước-lượng-hậu-nghiệm-cực-đại" title="5.6.1 Ước lượng hậu nghiệm cực đại">5.6.1 Ước lượng hậu nghiệm cực đại</a></li>
</ul>
</li>
<li><a href="#57-Các-thuật-toán-học-có-giám-sát" title="5.7 Các thuật toán học có giám sát">5.7 Các thuật toán học có giám sát</a><ul class="nav">
<li><a href="#571-Học-có-giám-sát-dựa-trên-xác-suất" title="5.7.1 Học có giám sát dựa trên xác suất">5.7.1 Học có giám sát dựa trên xác suất</a></li>
<li><a href="#572-Máy-vector-hỗ-trợ" title="5.7.2 Máy vector hỗ trợ">5.7.2 Máy vector hỗ trợ</a></li>
<li><a href="#573-Các-thuật-toán-học-có-giám-sát-đơn-giản-khác" title="5.7.3 Các thuật toán học có giám sát đơn giản khác">5.7.3 Các thuật toán học có giám sát đơn giản khác</a></li>
</ul>
</li>
<li><a href="#58-Các-thuật-toán-học-không-giám-sát" title="5.8 Các thuật toán học không giám sát">5.8 Các thuật toán học không giám sát</a><ul class="nav">
<li><a href="#581-Phân-tích-thành-phần-chính" title="5.8.1 Phân tích thành phần chính">5.8.1 Phân tích thành phần chính</a></li>
<li><a href="#582-Phân-cụm-k-means" title="5.8.2 Phân cụm kk-means">5.8.2 Phân cụm kk-means</a></li>
</ul>
</li>
<li><a href="#59-Trượt-Gradient-ngẫu-nhiên" title="5.9 Trượt Gradient ngẫu nhiên">5.9 Trượt Gradient ngẫu nhiên</a></li>
<li><a href="#510-Xây-dựng-một-thuật-toán-học-máy" title="5.10 Xây dựng một thuật toán học máy">5.10 Xây dựng một thuật toán học máy</a></li>
<li><a href="#511-Những-thách-thức-thúc-đẩy-sự-phát-triển-của-học-sâu" title="5.11 Những thách thức thúc đẩy sự phát triển của học sâu">5.11 Những thách thức thúc đẩy sự phát triển của học sâu</a><ul class="nav">
<li><a href="#5111-Hiểm-họa-số-chiều-lớn" title="5.11.1 Hiểm họa số chiều lớn">5.11.1 Hiểm họa số chiều lớn</a></li>
<li><a href="#5112-Tính-bất-biến-cục-bộ-và-cơ-chế-kiểm-soát-độ-trơn" title="5.11.2 Tính bất biến cục bộ và cơ chế kiểm soát độ trơn">5.11.2 Tính bất biến cục bộ và cơ chế kiểm soát độ trơn</a></li>
<li><a href="#5113-Học-đa-tạp" title="5.11.3 Học đa tạp">5.11.3 Học đa tạp</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-5-Học-máy-cơ-bản-giai-đoạn-2" title="Chương 5: Học máy cơ bản (giai đoạn 2)">Chương 5: Học máy cơ bản (giai đoạn 2)</a><ul class="nav">
<li><a href="#543-Phương-sai-và-sai-số-chuẩn" title="5.4.3 Phương sai và sai số chuẩn">5.4.3 Phương sai và sai số chuẩn</a></li>
<li><a href="#544-Đánh-đổi-giữa-độ-chệch-và-phương-sai-để-cực-tiểu-hóa-trung-bình-của-bình-phương-sai-số" title="5.4.4 Đánh đổi giữa độ chệch và phương sai để cực tiểu hóa trung bình của bình phương sai số.">5.4.4 Đánh đổi giữa độ chệch và phương sai để cực tiểu hóa trung bình của bình phương sai số.</a></li>
<li><a href="#545-Tính-nhất-quán" title="5.4.5 Tính nhất quán">5.4.5 Tính nhất quán</a></li>
</ul>
</li>
<li><a href="#55-Ước-lượng-hợp-lý-cực-đại" title="5.5 Ước lượng hợp lý cực đại">5.5 Ước lượng hợp lý cực đại</a><ul class="nav">
<li><a href="#551-Logarit-hợp-lý-có-điều-kiện-và-sai-số-bình-phương-trung-bình" title="5.5.1 Logarit hợp lý có điều kiện và sai số bình phương trung bình">5.5.1 Logarit hợp lý có điều kiện và sai số bình phương trung bình</a></li>
<li><a href="#552-Các-tính-chất-của-phương-pháp-hợp-lý-cực-đại" title="5.5.2 Các tính chất của phương pháp hợp lý cực đại">5.5.2 Các tính chất của phương pháp hợp lý cực đại</a></li>
</ul>
</li>
<li><a href="#56-Thống-kê-Bayes" title="5.6 Thống kê Bayes">5.6 Thống kê Bayes</a><ul class="nav">
<li><a href="#561-Ước-lượng-hậu-nghiệm-cực-đại" title="5.6.1 Ước lượng hậu nghiệm cực đại">5.6.1 Ước lượng hậu nghiệm cực đại</a></li>
</ul>
</li>
<li><a href="#57-Các-thuật-toán-học-có-giám-sát" title="5.7 Các thuật toán học có giám sát">5.7 Các thuật toán học có giám sát</a><ul class="nav">
<li><a href="#571-Học-có-giám-sát-dựa-trên-xác-suất" title="5.7.1 Học có giám sát dựa trên xác suất">5.7.1 Học có giám sát dựa trên xác suất</a></li>
<li><a href="#572-Máy-vector-hỗ-trợ" title="5.7.2 Máy vector hỗ trợ">5.7.2 Máy vector hỗ trợ</a></li>
<li><a href="#573-Các-thuật-toán-học-có-giám-sát-đơn-giản-khác" title="5.7.3 Các thuật toán học có giám sát đơn giản khác">5.7.3 Các thuật toán học có giám sát đơn giản khác</a></li>
</ul>
</li>
<li><a href="#58-Các-thuật-toán-học-không-giám-sát" title="5.8 Các thuật toán học không giám sát">5.8 Các thuật toán học không giám sát</a><ul class="nav">
<li><a href="#581-Phân-tích-thành-phần-chính" title="5.8.1 Phân tích thành phần chính">5.8.1 Phân tích thành phần chính</a></li>
<li><a href="#582-Phân-cụm-k-means" title="5.8.2 Phân cụm kk-means">5.8.2 Phân cụm kk-means</a></li>
</ul>
</li>
<li><a href="#59-Trượt-Gradient-ngẫu-nhiên" title="5.9 Trượt Gradient ngẫu nhiên">5.9 Trượt Gradient ngẫu nhiên</a></li>
<li><a href="#510-Xây-dựng-một-thuật-toán-học-máy" title="5.10 Xây dựng một thuật toán học máy">5.10 Xây dựng một thuật toán học máy</a></li>
<li><a href="#511-Những-thách-thức-thúc-đẩy-sự-phát-triển-của-học-sâu" title="5.11 Những thách thức thúc đẩy sự phát triển của học sâu">5.11 Những thách thức thúc đẩy sự phát triển của học sâu</a><ul class="nav">
<li><a href="#5111-Hiểm-họa-số-chiều-lớn" title="5.11.1 Hiểm họa số chiều lớn">5.11.1 Hiểm họa số chiều lớn</a></li>
<li><a href="#5112-Tính-bất-biến-cục-bộ-và-cơ-chế-kiểm-soát-độ-trơn" title="5.11.2 Tính bất biến cục bộ và cơ chế kiểm soát độ trơn">5.11.2 Tính bất biến cục bộ và cơ chế kiểm soát độ trơn</a></li>
<li><a href="#5113-Học-đa-tạp" title="5.11.3 Học đa tạp">5.11.3 Học đa tạp</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
