<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-9-Các-mạng-tích-chập-giai-đoạn-2">Chương 9: Các mạng tích chập (giai đoạn 2)</h1><p>Giả sử ta cần huấn luyện một mạng tích chập có sự tham gia của phép tích chập theo bước bằng ngăn xếp lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-3">K</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_SansSerif;">K</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\mathsf{K}</script></span> áp dụng cho ảnh đa kênh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4"><span class="MJXp-mrow" id="MJXp-Span-5"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-6">V</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-7"><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_SansSerif;">V</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\mathsf{V}</script></span> với sải chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">s</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">s</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">s</script></span> như định nghĩa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">c</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-12"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-13">K</span></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-15"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-16">V</span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">s</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-22" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">c(\mathsf{K}, \mathsf{V}, s)</script></span> trong phương trình 9.8. Giả sử ta muốn cực tiểu hoá một hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">J</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-24">V</span></span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-27">K</span></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-36" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">J(\mathsf{V}, \mathsf{K})</script></span> nào đó. Trong quá trình lan truyền thuận, ta sẽ cần sử dụng chính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">c</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">c</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">c</script></span> để tính đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-33">Z</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-44"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_SansSerif;">Z</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\mathsf{Z}</script></span>. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mrow" id="MJXp-Span-35"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-36">Z</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-49"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_SansSerif;">Z</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\mathsf{Z}</script></span> sau đó được lan truyền xuyên suốt toàn bộ phần còn lại của mạng và được sử dụng để tính toán hàm chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">J</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">J</script></span>. Trong quá trình lan truyền ngược, ta sẽ nhận được một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mrow" id="MJXp-Span-40"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-41">G</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-57"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_SansSerif;">G</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\mathsf{G}</script></span> sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mrow" id="MJXp-Span-44" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-45">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-46" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">i</span><span class="MJXp-mo" id="MJXp-Span-48">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">j</span><span class="MJXp-mo" id="MJXp-Span-50">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-53" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-54">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-55">∂</span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mrow" id="MJXp-Span-57" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-58">Z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-59" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">i</span><span class="MJXp-mo" id="MJXp-Span-61">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">j</span><span class="MJXp-mo" id="MJXp-Span-63">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">k</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">J</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-67"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-68">V</span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-70"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-71">K</span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-62"><span class="msubsup" id="MathJax-Span-63"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_SansSerif;">G</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-75" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.213em;"><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.78em, 4.367em, -999.997em); top: -3.553em; left: 50%; margin-left: -0.913em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-80"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: MathJax_SansSerif;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.434em;"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-86" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-87" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-88" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-89" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.94em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.942em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-96" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\mathsf{G}_{ i , j , k } = \frac { \partial } { \partial \mathsf{Z} _ { i , j , k } } J (\mathsf{V} , \mathsf{K})</script></span>.</p><p>Để huấn luyện mạng này ta cần tính các đạo hàm theo những trọng số trong lõi. Để làm được điều đó, ta có thể sử dụng hàm số  sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-73"><span class="MJXp-mtable" id="MJXp-Span-74"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-75" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-76" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">g</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-79"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-80">G</span></span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-82"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-83">V</span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">s</span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-88" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">i</span><span class="MJXp-mo" id="MJXp-Span-90">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">j</span><span class="MJXp-mo" id="MJXp-Span-92">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">k</span><span class="MJXp-mo" id="MJXp-Span-94">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">l</span></span></span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-97" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-98">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-99">∂</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mrow" id="MJXp-Span-101" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-102">K</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span><span class="MJXp-mo" id="MJXp-Span-105">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">j</span><span class="MJXp-mo" id="MJXp-Span-107">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">k</span><span class="MJXp-mo" id="MJXp-Span-109">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">l</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">J</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-113"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-114">V</span></span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-116"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-117">K</span></span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-120"><span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-122" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">m</span><span class="MJXp-mo" id="MJXp-Span-124">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">n</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mrow" id="MJXp-Span-127" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-128">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-129" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">i</span><span class="MJXp-mo" id="MJXp-Span-131">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">m</span><span class="MJXp-mo" id="MJXp-Span-133">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mrow" id="MJXp-Span-136" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-137">V</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">j</span><span class="MJXp-mo" id="MJXp-Span-140">,</span><span class="MJXp-mspace" id="MJXp-Span-141" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-142">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">m</span><span class="MJXp-mo" id="MJXp-Span-144">−</span><span class="MJXp-mn" id="MJXp-Span-145">1</span><span class="MJXp-mo" id="MJXp-Span-146">)</span><span class="MJXp-mo" id="MJXp-Span-147">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">s</span><span class="MJXp-mo" id="MJXp-Span-149">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">k</span><span class="MJXp-mo" id="MJXp-Span-151">,</span><span class="MJXp-mspace" id="MJXp-Span-152" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-153">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span><span class="MJXp-mo" id="MJXp-Span-155">−</span><span class="MJXp-mn" id="MJXp-Span-156">1</span><span class="MJXp-mo" id="MJXp-Span-157">)</span><span class="MJXp-mo" id="MJXp-Span-158">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">s</span><span class="MJXp-mo" id="MJXp-Span-160">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">l</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-101"><span class="mtable" id="MathJax-Span-102" style="min-width: 34.863em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 34.863em;"><span style="display: inline-block; position: absolute; width: 28.182em; height: 0px; clip: rect(-1.721em, 1028.18em, 1.242em, -999.997em); top: 0em; left: 50%; margin-left: -14.06em;"><span style="position: absolute; clip: rect(2.266em, 1028.18em, 5.229em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 28.182em; height: 0px;"><span style="position: absolute; clip: rect(2.427em, 1028.18em, 5.445em, -999.997em); top: -4.2em; left: 50%; margin-left: -14.06em;"><span class="mtd" id="MathJax-Span-106"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_SansSerif;">G</span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-114" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="msubsup" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.38em;"><span class="texatom" id="MathJax-Span-121"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-131" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1003.02em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -1.506em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-135"><span style="display: inline-block; position: relative; width: 2.481em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_SansSerif;">K</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1003.18em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.182em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-154" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-159" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1001.24em, 4.367em, -999.997em); top: -2.961em; left: 0.11em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-166" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_SansSerif;">G</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-170"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 9.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_SansSerif;">V</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-185" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-196" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.129em, 1002.48em, 0.218em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.2em; right: 0em;"><span class="mtd" id="mjx-eqn-9.11"><span class="mrow" id="MathJax-Span-104"><span class="mtext" id="MathJax-Span-105" style="font-family: MathJax_Main;">(9.11)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-12"> g ( \mathsf { G } , \mathsf { V } , s ) _ { i , j , k , l } = \frac { \partial } { \partial \mathsf { K } _ { i , j , k , l } } J ( \mathsf { V } , \mathsf { K } ) = \sum _ { m , n } \mathsf { G } _ { i , m , n } \mathsf { V } _ { j ,\, ( m - 1 ) \times s + k ,\, ( n - 1 ) \times s + l } \tag{9.11}</script></span></p><p>Nếu tầng này không phải tầng dưới cùng của mạng, ta cần tính gradient tương ứng đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-164">V</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-207"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_SansSerif;">V</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\mathsf{V}</script></span> để lan truyền ngược sai số xuống tầng dưới. Ta có thể sử dụng hàm:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-165"><span class="MJXp-mtable" id="MJXp-Span-166"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-167" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-168" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">h</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-171"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-172">K</span></span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-174"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-175">G</span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">s</span><span class="MJXp-msubsup" id="MJXp-Span-178"><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-180" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">i</span><span class="MJXp-mo" id="MJXp-Span-182">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">j</span><span class="MJXp-mo" id="MJXp-Span-184">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">k</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-186" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-187"></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-189" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-190">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-191">∂</span><span class="MJXp-msubsup" id="MJXp-Span-192"><span class="MJXp-mrow" id="MJXp-Span-193" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-194">V</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-195" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">i</span><span class="MJXp-mo" id="MJXp-Span-197">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">j</span><span class="MJXp-mo" id="MJXp-Span-199">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">k</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">J</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-203"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-204">V</span></span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-206"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-207">K</span></span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-209" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-210" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-211" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-212"></span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-214"><span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-216" style="margin-left: 0px;"><span class="MJXp-mfrac" id="MJXp-Span-217"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">l</span><span class="MJXp-mo" id="MJXp-Span-220">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">m</span><span class="MJXp-mspace" id="MJXp-Span-222" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">v</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mo" id="MJXp-Span-225">ớ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">i</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">l</span><span class="MJXp-mo" id="MJXp-Span-230">−</span><span class="MJXp-mn" id="MJXp-Span-231">1</span><span class="MJXp-mo" id="MJXp-Span-232">)</span><span class="MJXp-mo" id="MJXp-Span-233">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">s</span><span class="MJXp-mo" id="MJXp-Span-235">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">m</span><span class="MJXp-mo" id="MJXp-Span-237">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">j</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-239" style="width: 1em; height: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-240"><span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-242" style="margin-left: 0px;"><span class="MJXp-mfrac" id="MJXp-Span-243"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">n</span><span class="MJXp-mo" id="MJXp-Span-246">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">p</span><span class="MJXp-mspace" id="MJXp-Span-248" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">v</span><span class="MJXp-mrow" id="MJXp-Span-250"><span class="MJXp-mo" id="MJXp-Span-251">ớ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">i</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-253"><span class="MJXp-mo" id="MJXp-Span-254">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">n</span><span class="MJXp-mo" id="MJXp-Span-256">−</span><span class="MJXp-mn" id="MJXp-Span-257">1</span><span class="MJXp-mo" id="MJXp-Span-258">)</span><span class="MJXp-mo" id="MJXp-Span-259">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">s</span><span class="MJXp-mo" id="MJXp-Span-261">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">p</span><span class="MJXp-mo" id="MJXp-Span-263">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">k</span></span></span></span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-265"><span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-267" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">q</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mrow" id="MJXp-Span-270" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-271">K</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">q</span><span class="MJXp-mo" id="MJXp-Span-274">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">i</span><span class="MJXp-mo" id="MJXp-Span-276">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">m</span><span class="MJXp-mo" id="MJXp-Span-278">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">p</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mrow" id="MJXp-Span-281" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-282">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">q</span><span class="MJXp-mo" id="MJXp-Span-285">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">l</span><span class="MJXp-mo" id="MJXp-Span-287">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-212"><span class="mtable" id="MathJax-Span-213" style="min-width: 28.613em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.613em;"><span style="display: inline-block; position: absolute; width: 21.932em; height: 0px; clip: rect(-3.176em, 1021.82em, 2.697em, -999.997em); top: 0em; left: 50%; margin-left: -10.935em;"><span style="position: absolute; clip: rect(1.457em, 1005.45em, 4.744em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.445em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1005.45em, 4.421em, -999.997em); top: -5.601em; right: 0em;"><span class="mtd" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-225" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_SansSerif;">G</span></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.38em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -3.392em; right: 0em;"><span class="mtd" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1016.38em, 9.216em, -999.997em); top: -6.517em; left: 5.445em;"><span style="display: inline-block; position: relative; width: 16.49em; height: 0px;"><span style="position: absolute; clip: rect(2.427em, 1007.38em, 5.121em, -999.997em); top: -5.601em; left: 0em;"><span class="mtd" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241"></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-243" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1002.59em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -1.29em;"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-247"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_SansSerif;">V</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.75em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.751em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_SansSerif;">V</span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-264" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_SansSerif;">K</span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1016.38em, 6.037em, -999.997em); top: -3.392em; left: 0em;"><span class="mtd" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275"></span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-277" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 3.451em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 1.026em;"><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1003.45em, 4.69em, -999.997em); top: -2.584em; left: 0em;"><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mfrac" id="MathJax-Span-281"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.451em, 1001.57em, 4.259em, -999.997em); top: -4.362em; left: 50%; margin-left: -0.752em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-size: 50%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-284" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-285" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span class="mspace" id="MathJax-Span-286" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-287" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: normal; font-weight: normal;">ớ</span></span></span></span><span class="mi" id="MathJax-Span-291" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1003.24em, 4.259em, -999.997em); top: -3.715em; left: 50%; margin-left: -1.614em;"><span class="mrow" id="MathJax-Span-292"><span class="mo" id="MathJax-Span-293" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-294" style="font-size: 50%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-295" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-296" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-297" style="font-size: 50%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-298" style="font-size: 50%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-299" style="font-size: 50%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-300" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-301" style="font-size: 50%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-302" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-303" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mspace" id="MathJax-Span-304" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span><span class="munderover" id="MathJax-Span-305" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 1.026em;"><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1003.45em, 4.69em, -999.997em); top: -2.584em; left: 0em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mfrac" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.451em, 1001.51em, 4.259em, -999.997em); top: -4.362em; left: 50%; margin-left: -0.752em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-312" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-313" style="font-size: 50%; font-family: MathJax_Math-italic;">p</span><span class="mspace" id="MathJax-Span-314" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-315" style="font-size: 50%; font-family: MathJax_Math-italic;">v</span><span class="texatom" id="MathJax-Span-316"><span class="mrow" id="MathJax-Span-317"><span class="mo" id="MathJax-Span-318" style="font-size: 50%;"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: normal; font-weight: normal;">ớ</span></span></span></span><span class="mi" id="MathJax-Span-319" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1003.24em, 4.259em, -999.997em); top: -3.715em; left: 50%; margin-left: -1.614em;"><span class="mrow" id="MathJax-Span-320"><span class="mo" id="MathJax-Span-321" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-322" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-323" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-324" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-325" style="font-size: 50%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-326" style="font-size: 50%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-327" style="font-size: 50%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-328" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-329" style="font-size: 50%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-330" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-331" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-332" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.367em, -999.997em); top: -2.961em; left: 0.541em;"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-337" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.912em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-338"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_SansSerif;">K</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-341"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-350"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-351"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_SansSerif;">G</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.522em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-2.53em, 1002.48em, 1.026em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -5.601em; right: 0em;"><span class="mtd" id="mjx-eqn-9.12"><span class="mrow" id="MathJax-Span-215"><span class="mtext" id="MathJax-Span-216" style="font-family: MathJax_Main;">(9.12)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.392em; right: 0em;"><span class="mtd" id="mjx-eqn-9.13"><span class="mrow" id="MathJax-Span-269"><span class="mtext" id="MathJax-Span-270" style="font-family: MathJax_Main;">(9.13)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">\begin{align}
h(\mathsf{K}, \mathsf{G}, s)_{i,j,k} &= \frac{\partial } {\partial\mathsf{V}_{i, j,k }} J(\mathsf{V}, \mathsf {K}) \tag{9.12}
\\
&= \sum_{l,m\,với\atop(l - 1) \times s + m = j }\quad \sum _ { n , p \, với \atop  (n-1) \times s + p = k } \sum _ { q } \mathsf{K} _ { q , i , m , p } \mathsf{G} _ { q , l , n }.\tag{9.13}
\end{align}</script></span></p><p><em>Mạng tự mã hóa</em> (autoencoder network), được trình bày trong chương 14, là loại mạng lan truyền thuận được huấn luyện để sao chép đầu vào của mạng sang đầu ra của mạng. Một ví dụ đơn giản chính là thuật toán phân tích thành phần chính (PCA), nó đưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-291">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-15">\boldsymbol { x }</script></span> làm đầu vào của một mô hình khôi phục xấp xỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-292"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-293">r</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-16">\boldsymbol {r}</script></span> bằng cách sử dụng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-297" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-298">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-299">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-300">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-17">\boldsymbol { W } ^ { \top } \boldsymbol { W } \boldsymbol { x }</script></span>. Các bộ tự mã hoá tổng quát thường sử dụng phép nhân với chuyển vị của ma trận trọng số giống như cách thuật toán phân tích thành phần chính (PCA) làm. Để làm cho các mô hình như vậy có tính tích chập, ta có thể sử dụng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-18">h</script></span> để thực hiện phép chuyển vị của toán tử tích chập. Giả sử ta có các đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-303"><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-305">H</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">\mathsf{H}</script></span> có cùng định dạng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mrow" id="MJXp-Span-307"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-308">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">\mathsf{Z}</script></span> và ta định nghĩa một mô hình khôi phục:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-309"><span class="MJXp-mtable" id="MJXp-Span-310"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-311" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-312" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-314">R</span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">h</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-318"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-319">K</span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-321"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-322">H</span></span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">s</span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-21"> \mathsf { R } = h ( \mathsf { K } , \mathsf { H } , s ) \tag{9.14}</script></span></p><p>Để huấn luyện bộ tự mã hóa, ta sẽ nhận được gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mrow" id="MJXp-Span-327"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-328">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-22">\mathsf {R}</script></span> có dạng một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mrow" id="MJXp-Span-330"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-331">E</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">\mathsf {E}</script></span>. Để huấn luyện bộ giải mã, ta cần tính gradient tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mrow" id="MJXp-Span-333"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-334">K</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">\mathsf {K}</script></span>.  Gradient này giả sử là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">g</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-338"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-339">H</span></span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-341"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-342">E</span></span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">s</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-25">g (\mathsf {H}, \mathsf {E}, s)</script></span>. Để huấn luyện bộ mã hoá, ta cần tính gradient tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-348">H</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26">\mathsf {H}</script></span>. Gradient này giả sử là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">c</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-353">K</span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-355"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-356">E</span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">s</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-27">c (\mathsf {K}, \mathsf {E}, s)</script></span>. Ta cũng có thể tính vi phân thông qua <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">g</script></span> bằng cách sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">c</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">h</script></span>, nhưng các toán tử này không cần thiết cho thuật toán lan truyền ngược trên bất kỳ kiến trúc mạng chuẩn nào.</p><p>Nhìn chung, ta không chỉ sử dụng toán tử tuyến tính để chuyển đổi các đầu vào thành các đầu ra trong một tầng tích chập. Ta thường sẽ cộng thêm hệ số tự do cho mỗi kết quả đầu ra trước khi sử dụng toán tử phi tuyến tính. Điều này đặt ra câu hỏi về cách dùng chung tham số giữa các hệ số tự do. Đối với các tầng kết nối cục bộ, ta sẽ gán cho mỗi đơn vị một hệ số tự do của riêng nó. Đối với tích chập xếp chồng, theo lẽ tự nhiên, ta sẽ dùng chung các hệ số tự do theo cùng cách xếp chồng của các lỗi chập. Đối với các tầng tích chập, thông thường sẽ có một hệ số tự do ứng với mỗi kênh của đầu ra và hệ số tự do này sẽ được dùng chung trên tất cả các vị trí không gian trong của ánh xạ tích chập. Tuy nhiên, nếu đầu vào có kích thước cố định biết trước, ta cũng có thể học hệ số tự do riêng biệt cho từng vị trí của ánh xạ đầu ra. Việc tách rời các hệ số tự do như vậy có thể làm giảm hiệu quả thống kê của mô hình một chút nhưng nó cho phép mô hình điều chỉnh các khác biệt trong thống kê hình ảnh ở các vị trí khác nhau. Ví dụ, khi sử dụng kĩ thuật đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mn" id="MJXp-Span-367">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">0</script></span> kiểu ngầm định, các đơn vị phát hiện (detector unit) ở cạnh biên của ảnh nhận được tổng đầu vào ít hơn và có thể cần các hệ số tự do lớn hơn.</p><h1 id="96-Các-đầu-ra-có-cấu-trúc">9.6 Các đầu ra có cấu trúc</h1><p>Các mạng tích chập có thể được sử dụng để xuất ra một đối tượng có cấu trúc số chiều lớn, thay vì chỉ dự đoán nhãn của lớp cho tác vụ phân loại hoặc một giá trị thực cho tác vụ hồi quy. Thông thường, đối tượng này chỉ là một tensor, được tạo ra bởi một tầng tích chập tiêu chuẩn. Ví dụ, mô hình này có thể tạo ra một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-370">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">\mathsf{S}</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mrow" id="MJXp-Span-373" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-374">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-375" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">i</span><span class="MJXp-mo" id="MJXp-Span-377">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">j</span><span class="MJXp-mo" id="MJXp-Span-379">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">k</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">\mathsf{S} _ { i , j , k }</script></span> là xác suất mà điểm ảnh đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">j</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">k</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">(j, k)</script></span> của mạng thuộc lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">i</script></span>. Điều này cho phép mô hình gán nhãn mọi điểm ảnh trong một bức ảnh và vẽ ra các mặt nạ chính xác tuân theo phác hoạ của từng đối tượng riêng lẻ.</p><p>Một vấn đề thường nảy sinh đó là kích thước đầu ra có thể nhỏ hơn kích thước đầu vào, như trong hình 9.13. Trong các loại kiến trúc thường dùng để phân loại một đối tượng duy nhất trong một bức ảnh, sự suy giảm lớn nhất về kích thước không gian của mạng đến từ việc sử dụng các tầng gộp với sải chập lớn. Để tạo ra một ánh xạ đầu ra có cùng kích thước với đầu vào, người ta có thể tránh dùng phép gộp [Jain et al., 2007]. Một chiến lược đơn giản khác là tạo ra một lưới các nhãn có độ phân giải thấp hơn [Pinheiro and Collobert, 2014, 2015]. Cuối cùng, về nguyên tắc, người ta có thể sử dụng một toán tử gộp với sải chập đơn vị (sải độ dài bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-mn" id="MJXp-Span-390">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">1</script></span>).</p><p>Một chiến lược cho việc gán nhãn từng điểm ảnh trong ảnh là tạo ra dự đoán giá trị ban đầu các nhãn của hình ảnh, sau đó tinh chỉnh lại giá trị dự này bằng cách sử dụng tương tác giữa các điểm ảnh lân cận nhau. Lặp lại bước tinh chỉnh này nhiều lần tương tự như việc sử dụng cùng một phép tích chập cho mỗi tầng, dùng chung trọng số giữa các tầng cuối cùng của mạng [Jain et al., 2007]. Điều này khiến cho một chuỗi các tính toán thực hiện bởi các tầng tích chập liên tiếp dùng chung trọng số với nhau hành xử như một dạng mạng truy hồi đặc biệt [Pinheiro and Collobert, 2014, 2015]. Hình 9.17 biểu diễn kiến trúc của một mạng tích chập truy hồi như vậy.</p><p><img src="https://i.imgur.com/FJb1Ppj.png" alt=""></p><blockquote>
<p>Hình 9.17: Một ví dụ về mạng tích chập truy hồi sử dụng cho mục đích gán nhãn điểm ảnh. Dữ liệu đầu vào là một tensor ảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mrow" id="MJXp-Span-392"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-393">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">\mathsf{X}</script></span>, với các trục tương ứng với hàng, cột và số kênh màu (đỏ, lục, lam) của ảnh. Mục đích là để tạo ra một tensor các nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-394"><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-munderover" id="MJXp-Span-396"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">Y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">\hat { Y }</script></span>, cùng với một phân phối xác suất của các nhãn cho mỗi điểm ảnh. Tensor này có trục tương ứng với hàng, cột của ảnh và các lớp khác nhau. Thay vì xuất ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mrow" id="MJXp-Span-400"><span class="MJXp-munderover" id="MJXp-Span-401"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">Y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">\hat{ Y }</script></span> trong chỉ một lượt, mạng truy hồi lặp lại việc tinh chỉnh ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-404"><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-munderover" id="MJXp-Span-406"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">Y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">\hat { Y }</script></span> của nó bằng cách sử dụng ước lượng trước đó của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-409"><span class="MJXp-mrow" id="MJXp-Span-410"><span class="MJXp-munderover" id="MJXp-Span-411"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">Y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">\hat { Y }</script></span> làm đầu vào để tạo ra ước lượng mới. Các thông số giống hệt nhau được dùng cho mỗi lần cập nhật ước lượng, và ước lượng đó có thể được tinh chỉnh bao nhiêu lần tùy thích. Tensor lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mrow" id="MJXp-Span-415"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-416">U</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">\mathsf{U}</script></span> được sử dụng ở mỗi bước để tính toán các biểu diễn ẩn (hidden representation) trong hình ảnh đầu vào. Tensor lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-419">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">\mathsf{V}</script></span> được dùng để tạo ra một ước lượng cho các nhãn từ các giá trị ẩn đã biết. Tại tất cả các bước trừ bước đầu tiên, các lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-422">W</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">\mathsf{W}</script></span> được nhân chập với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mrow" id="MJXp-Span-424"><span class="MJXp-munderover" id="MJXp-Span-425"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">Y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">\hat { Y }</script></span> để trở thành đầu vào cho tầng ẩn. Ở bước đầu tiên, số hạng này được thay thế bằng giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mn" id="MJXp-Span-429">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">0</script></span>. Bởi các bước cùng sử dụng một bộ tham số, đây là một ví dụ cho mạng truy hồi, sẽ được mô tả ở chương 10.</p>
</blockquote><p>Khi đã đưa ra dự đoán cho mỗi điểm ảnh, ta có thể sử dụng nhiều phương pháp khác nhau để tiếp tục xử lý các dự đoán này nhằm thu được một hình ảnh đã được phân thành các vùng [Briggman et al., 2009; Turaga et al., 2010; Farabet et al., 2013]. Ý tưởng chung của các phương pháp này đó là giả định về việc các nhóm lớn của các điểm ảnh kề nhau thường có xu hướng được gán chung một nhãn. Các mô hình đồ thị có thể mô tả các mối quan hệ về mặt xác suất giữa các điểm ảnh lân cận. Ngoài ra, mạng tích chập có thể được huấn luyện để cực đại hoá một xấp xỉ của hàm mục tiêu của mô hình đồ thị trên [Ning et al., 2005; Thompson et al., 2014].</p><h1 id="97-Các-kiểu-dữ-liệu">9.7 Các kiểu dữ liệu</h1><p>The data used with a convolutional network usually consist of several channels,each channel being the observation of a diﬀerent quantity at some point in spaceor time. See table 9.1 for examples of data types with diﬀerent dimensionalitiesand number of channels.For an example of convolutional networks applied to video, see Chen et al.(2010).</p><p>Dữ liệu được sử dụng trong mạng tích chập thường bao gồm nhiều kênh, mỗi kênh là một quan sát về một đại lượng khác nhau tại một một điểm nào đó trong không gian hoặc thời gian. Bảng 9.1 trình bày một số ví dụ về các kiểu dữ liệu với số chiều và số lượng kênh khác nhau.</p><table>
<thead>
<tr>
<th></th>
<th style="text-align:left">Đơn kênh</th>
<th style="text-align:left">Đa kênh</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mn" id="MJXp-Span-431">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">1</script></span> chiều</td>
<td style="text-align:left">Hình dạng sóng âm thanh: phép tích chập được thực hiên theo trục thời gian. Ta rời rạc hóa thời gian và đo cường độ của sóng tại mỗi bước thời gian.</td>
<td style="text-align:left">Dữ liệu khung xương động: ảnh động <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-mn" id="MJXp-Span-433">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">3</script></span> chiều của các nhân vật trên máy tính được tạo ra bằng cách thay đổi tư thế của một “khung xương” theo thời gian. Tại mỗi thời điểm, tư thế của nhân vật được biểu diễn bằng một đặc tả về các góc của mỗi khớp trong khung xương nhân vật. Mỗi kênh trong dữ liệu mà ta đưa vào mô hình tích chập đại diện cho góc của một trục khớp.</td>
</tr>
<tr>
<td><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mn" id="MJXp-Span-435">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">2</script></span> chiều</td>
<td style="text-align:left">Dữ liệu âm thanh đã được xử lý trước bằng phép biến đổi Fourier: Ta có thể biến đổi dạng sóng âm thanh thành một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mn" id="MJXp-Span-437">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">2</script></span> chiều với các hàng tương ứng với các tần số khác nhau và các cột tương ứng với các thời điểm khác nhau. Sử dụng phép tích chập theo thời gian làm cho mô hình đẳng biến đối với phép tịnh tiến theo thời gian. Sử dụng phép tích chập dọc theo trục tần số làm cho mô hình đẳng biến với tần số, sao cho cùng một giai điệu chơi trong các quãng tám khác nhau sẽ tạo ra cùng một biểu diễn nhưng ở một độ cao khác nhau trong đầu ra của mạng.</td>
<td style="text-align:left">Dữ liệu hình ảnh màu: Một kênh chứa các điểm ảnh màu đỏ, một kênh chứa các điểm ảnh màu lục và một kênh chứa các điểm ảnh màu lam. Lõi tích chập di chuyển qua cả trục tung lẫn trục hoành của hình ảnh, tạo ra tính đẳng biến đối với tịnh tiến theo cả hai hướng.</td>
</tr>
<tr>
<td><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mn" id="MJXp-Span-439">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">3</script></span> chiều</td>
<td style="text-align:left">Dữ liệu kiểu thể tích: Một nguồn dữ liệu phổ biến dạng này là các hình ảnh y khoa, chẳng hạn như ảnh chụp cắt lớp vi tính (quét CT).</td>
<td style="text-align:left">Dữ liệu video màu: Một trục đại diện cho thời gian, một trục đại diện cho chiều cao của khung hình video và một trục đại diện chiều rộng của khung hình video.</td>
</tr>
</tbody>
</table><blockquote>
<p><em>Bảng 9.1:</em> Các ví dụ về các định dạng dữ liệu khác nhau có thể được sử dụng với các mạng tích chập.</p>
</blockquote><p>Trong công trình của Chen và đồng nghiệp (2010) có các ví dụ về các mạng tích chập áp dụng cho video.</p><p>Cho đến phần này, ta mới chỉ thảo luận về trường hợp mà mọi mẫu trong dữ liệu huấn luyện và dữ liệu kiểm thử có cùng kích thước không gian. Một ưu điểm của các mạng tích chập là chúng còn có thể xử lý các đầu vào có kích thước không gian khác nhau. Những dạng đầu vào kiểu này cơ bản không thể biểu diễn được bằng các mạng neuron truyền thống dựa trên phép nhân ma trận. Đó cũng là một lý do thuyết phục chúng ta nên dùng mạng tích chập ngay cả khi chi phí tính toán và vấn đề quá khớp không đáng ngại.</p><p>Ví dụ, xét một tập ảnh trong đó mỗi ảnh có chiều rộng và chiều cao khác nhau. Gần như ta sẽ không thể tìm ra một cách để mô hình hoá đầu vào như vậy với một ma trận trọng số có kích thước cố định. Trong trường hợp này, sử dụng phép tích chập lại rất đơn giản; lõi chập được áp dụng một cách đơn giản với số lần khác nhau tùy theo kích thướng đầu vào, kích thước đầu ra cũng thay đổi tương ứng. Phép tích chập có thể được xem như là phép nhân ma trận; cùng một lõi tích chập có thể tạo ra một kích thước khác nhau của khối ma trận tuần hoàn cho mỗi kích thước đầu vào. Đôi khi, đầu ra cũng như đầu vào của mạng được phép có kích thước linh hoạt, ví dụ như trong tác vụ gán nhãn cho mỗi điểm ảnh của đầu vào. Trong trường hợp này, không cần phải thực hiện thêm tác vụ nào nữa. Trong một số trường hợp khác, mạng phải tạo ra đầu ra có kích thước cố định, chẳng hạn như khi ta muốn gán một nhãn duy nhất cho toàn bộ hình ảnh. Khi đó ta phải thực hiện một số bước thiết kế bổ sung, như chèn một tầng gộp có kích thước vùng gộp tỷ lệ thuận với với kích thước của đầu vào để kiểm soát đầu ra của tầng gộp có một kích thước cố định. Một số ví dụ về chiến lược tinh chỉnh này được mô tả trong hình 9.11.</p><p>Lưu ý rằng việc sử dụng phép tích chập để xử lý các đầu vào có kích thước thay đổi chỉ có ý nghĩa khi sự thay đổi kích thước của đầu vào đến từ việc chúng chứa số lượng quan sát thay đổi của cùng một đối tượng - ghi nhận các quan sát có kích thước khác nhau theo thời gian, có độ rộng khác nhau trong không gian, … Phép tích chập không có ý nghĩa trong trường hợp sự thay đổi về kích thước của đầu vào đến từ việc nó có thể tùy ý bao gồm các loại quan sát khác nhau. Ví dụ, khi xử lý quá các đơn dự tuyển của sinh viên, và các đặc trưng ta cần bao gồm cả điểm quá trình lẫn điểm thi chuẩn hóa kiến thức, nhưng không phải tất cả người nộp đơn đều làm bài kiểm tra chuẩn hoá kiến thức, và vì thế nên việc tính tích chập với cùng một trọng số cho cả hai đặc trưng trên là không hợp lý.</p><h1 id="98-Các-thuật-toán-tích-chập-hiệu-quả">9.8 Các thuật toán tích chập hiệu quả</h1><p>Các ứng dụng sử dụng mạng tích chập hiện đại thường bao gồm các mạng có thể chứa tới hơn một triệu đơn vị. Do đó, các cách thực thi giúp khai thác một cách tối ưu các nguồn tài nguyên tính toán song song, như sẽ thảo luận ở phần 12.1, là cực kì cần thiết. Tuy nhiên, trong nhiều trường hợp, ta cũng có thể tăng tốc độ tính toán tích chập bằng cách lựa chọn một thuật toán tích chập phù hợp.</p><p>Phép tích chập sẽ tương đương với việc chuyển đổi cả đầu vào và lõi sang <em>miền tần số</em> (frequency domain) sử dụng phép biến đổi Fourier, thực hiện phép nhân theo từng điểm của hai tín hiệu, sau đó chuyển đổi ngược lại về miền thời gian bằng phép biến đổi Fourier nghịch đảo. Với  một vài bài toán có kích thước nhất định, phương pháp này có thể nhanh hơn phương pháp thực thi đơn thuần sử dụng phép tích chập rời rạc.</p><p>Khi một lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">d</script></span>-chiều có thể được mô tả như một tích ngoài (outer product) của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">d</script></span> vector, với mỗi vector trên một chiều, lõi này được gọi là khả phân (separable). Khi một lõi có tính khả phân, việc sử dụng tích chập đơn thuần sẽ không hiệu quả. Nó sẽ tương đương với việc kết hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">d</script></span> phép tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mn" id="MJXp-Span-447">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">1</script></span> chiều đối với từng vector này. Phương pháp kết hợp sẽ nhanh hơn đáng kể so với một tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">d</script></span> chiều với tích ngoài của chúng. Lõi cũng sẽ nhận ít tham số hơn khi biểu diễn bằng các vector. Nếu lõi bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">w</script></span> phần tử ở mỗi chiều thì phép tích chập đa chiều đơn thuần sẽ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">O</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-457" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-458" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">O(w^{\,d})</script></span> thời gian chạy và dung lượng bộ nhớ tham số, trong khi phép tích chập  khả phân chỉ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">O</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">w</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">d</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">O(w \times d)</script></span> thời gian chạy và dung lượng bộ nhớ tham số. Tất nhiên là không phải tất cả các phép tích chập đều có thể biểu diễn được bằng cách này.</p><blockquote>
<p><em><strong>ND</strong></em>: Tích ngoài (outer product) của hai vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-470">u</span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-473">v</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">\mathbf{u},\mathbf{v}</script></span> là ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-msubsup" id="MJXp-Span-475"><span class="MJXp-mrow" id="MJXp-Span-476" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-477">u</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-478" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mrow" id="MJXp-Span-479"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-480">v</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\mathbf{u}^T\mathbf{v}</script></span>. Phép toàn này không có tính giao hoán.</p>
</blockquote><p>Nghiên cứu tìm ra những cách thực hiện phép tích chập hoặc phép tích chập xấp xỉ nhanh hơn mà không ảnh hưởng tới độ chính xác của mô hình là một hướng nghiên cứu sôi động hiện nay. Thậm chí các kỹ thuật nâng cao độ hiệu quả của chỉ riêng lan truyền thuận đa tầng thôi cũng đã có ích rồi bởi vì trong tuỳ chỉnh của ứng dụng đã thương mại hoá, đa số các tài nguyên tính toán được dùng cho việc triển khai mô hình thay vì huấn luyện mô hình</p><h1 id="99-Các-đặc-trưng-ngẫu-nhiên-hoặc-không-giám-sát">9.9 Các đặc trưng ngẫu nhiên hoặc không giám sát</h1><p>Thông thường, phần tốn kém nhất trong việc huấn luyện mạng neuron tích chập là học các đặc trưng. Tầng đầu ra thường tương đối không tốn kém bởi số lượng đặc trưng đầu vào của tầng này sau khi trải qua nhiều tầng gộp, là khá nhỏ. Khi thực hiện việc huấn luyện có giám sát với trượt gradient, mọi bước trượt gradient đều yêu cầu hoàn thành quá trình tính toán lan truyền thuận và lan truyền nghịch qua toàn bộ mạng. Một cách để giảm thiểu chi phí của việc huấn luyện mạng tích chập là sử dụng các đặc trưng không được huấn luyện theo kiểu có giám sát.</p><p>Có ba chiến lược cơ bản để tạo ra các lõi chập mà không cần sử dụng học có giám sát. Một trong số đó là khởi tạo ngẫu nhiên. Một cách khác là thiết kế thủ công, ví dụ, thiết lập từng lõi để xác định các cạnh biên ở một hướng hoặc tỉ lệ cụ thể. Cuối cùng, ta có thể học các lõi bằng một tiêu chuẩn không giám sát. Ví dụ, [Coates et al., 2011] áp dụng phân cụm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">k</script></span>-means đối với các <em>mảnh</em> (patch) các hình ảnh nhỏ , sau đó sử dụng từng trọng tâmlàm (centroid) đã học được làm lõi chập. Trong Phần III, ta sẽ mô tả nhiều hướng tiếp cận học không giám sát hơn. Học các đặc trưng với một tiêu chuẩn không giám sát cho phép chúng được xác định một cách tách biệt khỏi tầng phân lớp ở đỉnh của mô hình. Sau đó ta có thể trích xuất các đặc trưng cho toàn bộ tập huấn luyện chỉ trong một lần, về cơ bản, xây dựng một tập huấn luyện mới cho tầng cuối cùng. Học tầng cuối cùng sau đó chỉ là bài toán tối ưu lồi, giả định rằng tầng cuối cùng là hồi quy logit hoặc máy vector hỗ trợ (SVM).</p><p>Các bộ lọc ngẫu nhiên thường cho kết quả tốt đáng ngạc nhiên đối với mạng tích chập [Jarrett et al., 2009; Saxe et al., 2011; Pinto et al., 2011; Cox and Pinto, 2011]. Công trình của Saxe và đồng nghệp (2011) cho thấy rằng những tầng chứa phép tích chập theo sau bởi một tầng gộp có tính chọn lọc tần số và trở nên bất biến với phép tịnh tiến khi được gán các trọng số ngẫu nhiên. Họ lập luận rằng cách này cho ta một phương pháp ít tốn kém để lựa chọn kiến trúc của mạng tích chập: đầu tiên, đánh giá hiệu suất của một số kiến trúc mạng tích chập bằng cách chỉ huấn luyện tầng cuối cùng, sau đó chọn ra cái tốt nhất trong số những kiến trúc này và huấn luyện toàn bộ kiến trúc bằng một hướng tiếp cận có tốn kém hơn.</p><p>Một hướng tiếp cận vừa phải sẽ là học các đặc trưng, nhưng bằng cách sử dụng các phương thức không yêu cầu cả lan truyền thuận và nghịch đầy đủ tại mỗi bước trượt gradient. Với những mạng perceptron đa tầng, ta sử dụng tiền huấn luyện tham lam theo từng tầng, huấn luyện tầng đầu tiên một cách cô lập, sau đó trích xuất tất cả các đặc trưng từ tầng đầu tiên một lần duy nhất, tiếp theo, huấn luyện tầng thứ hai một cách cô lập với những đặc trưng đó, và cứ tiếp tục như thế. Trong chương 8, ta đã tìm hiểu cách thực hiện tiền huấn luyện tham lam theo từng tầng có giám sát, và trong phần III sẽ mở rộng quy trình này sử dụng tiêu chuẩn không giám sát tại mỗi tầng. Một ví dụ kinh điểm của tiền huấn luyện tham lam theo từng tầng của một mô hình tích chập là mạng phân phối đa tầng tích chập (convolutional deep belief network) [Lee et al., 2009]. Các mạng tích chập giúp ta có thể thực hiện chiến lược tiền huấn luyện vượt xa khả năng mà các mạng perceptron đa tầng có thể làm đưọc. Thay vì huấn luyện toàn bộ tầng tích chập tại một thời điểm, ta có thể huấn luyện một mô hình theo từng mảnh nhỏ, như Coates và đồng nghiệp (2011) đã làm với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">k</script></span>-means. Sau đó ta có thể sử dụng các tham số từ mô hình theo mảnh nhỏ này để xác định các lõi của tầng tích chập.  Điều này có nghĩa là có thể sử dụng học không giám sát để huấn luyện mạng tích chập mà <em>không bao giờ cần phải sử dụng tích chập trong quá trình huấn luyện</em>. Với cách tiếp cận này, ta có thể huấn luyện các mô hình lớn và tiêu tốn tài nguyên tính toán chỉ trong khâu suy luận (inference) [Ranzato et al., 2007b; Jarrett et al.,2009; Kavukcuoglu et al., 2010; Coates et al., 2013]. Cách tiếp cận này phổ biến từ khoảng năm 2007 đến năm 2013, khi các tập dữ liệu có nhãn còn nhỏ và sức mạnh tính toán còn giới hạn. Ngày nay, hầu hết các mạng tích chập được huấn luyện một cách hoàn toàn có giám sát, sử dụng lan truyền thuận và nghịch khắp toàn bộ mạng theo từng bước lặp huấn luyện.</p><p>Giống như các phương pháp tiếp cận khác cho bài toán tiền huấn luyện không giám sát, rất khó để tách bạch nguyên nhân của những ích lợi mà phương pháp này mang lại. Tiền huấn luyện không giám sát có thể cho ta một số cách kiểm soát liên quan đến huấn luyện có giám sát, hoặc chỉ đơn giản chỉ là cho phép ta huấn luyện các kiến trúc lớn hơn nhiều bởi vì nó giúp giảm chi phí tính toán của quy tắc học.</p><h1 id="910-Nền-tảng-thần-kinh-học-của-mạng-tích-chập">9.10 Nền tảng thần kinh học của mạng tích chập</h1><p>Mạng tích chập có lẽ là câu chuyện thành công vĩ đại nhất về trí thông minh nhân tạo lấy cảm hứng từ sinh học. Mặc dù mạng tích chập cũng được dẫn lối bởi nhiều lĩnh vực khác nhưng các nguyên tắc thiết kế chủ chốt của mạng được rút ra chính từ khoa học thần kinh.</p><p>Lịch sử của mạng tích chập bắt đầu với các thí nghiệm khoa học thần kinh khá lâu trước khi các mô hình tính toán có liên quan được phát triển. Hai nhà thần kinh học David Hubel và Torsten Wiesel đã cộng tác trong nhiều năm trời để xác định ra các cơ sở cơ bản nhất về cách mà hệ thống thị giác của loài động vật có vú hoạt động [Hubel and Wiesel, 1959, 1962, 1968]. Thành tựu của họ cuối cùng đã được công nhận bằng giải Nobel. Khám phá của họ đã mang đến nguồn cảm hứng to lớn cho các mô hình học sâu đương thời dựa trên việc ghi lại hoạt động của các neuron riêng lẻ ở mèo. Họ quan sát cách neuron trong não mèo phản ứng với những hình ảnh chiếu ở những vị trí chính xác trên màn hình đặt trước mặt nó. Họ phát hiện ra rằng các neuron trong hệ thống thị giác ban đầu phản ứng mạnh mẽ nhất với các mô thức ánh sáng cụ thể, như các thanh định hướng chính xác, nhưng hầu như không phản ứng mấy với các mô thức khác.</p><p>Thành quả của họ đã giúp mô tả nhiều khía cạnh của chức năng não, vượt quá phạm vi của cuốn sách này. Từ quan điểm của học sâu, ta có thể tập trung vào một góc nhìn đơn giản, minh hoạ về chức năng của não.</p><p>Theo quan điểm đơn giản này, ta tập trung vào phần não bộ có tên gọi là V1, còn được gọi là <em>vỏ não thị giác sơ cấp</em> (primary visual cortex). V1 là vùng đầu tiên của bộ não bắt đầu thực hiện việc xử lý cấp cao các tín hiệu thị giác truyền vào. Trong góc nhìn minh hoạ này, hình ảnh được hình thành bởi ánh sáng đến mắt và kích thích võng mạc, mô nhạy cảm với ánh sáng ở phía sau của mắt. Các neuron trong võng mạc thực hiện một số tiền xử lý đơn giản của hình ảnh nhưng không thay đổi đáng kể cách nó được biểu diễn. Hình ảnh sau đó đi qua dây thần kinh thị giác và một vùng não được gọi là <em>hạt nhân di truyền biên</em> (lateral geniculate nucleus - LGN). Vai trò chính, theo những gì ta quan tâm ở đây, của cả hai vùng kết cấu chủ yếu chỉ mang tín hiệu từ mắt đến V1, nằm ở phía sau đầu.</p><p>Một tầng mạng tích chập được thiết kế để nắm bắt ba thuộc tính của V1:</p><ol>
<li>
<p>V1 được sắp xếp trong một ánh xạ không gian. Nó thực ra có cấu trúc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-485"><span class="MJXp-mn" id="MJXp-Span-486">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">2</script></span> chiều, phản chiếu cấu trúc của hình ảnh trong võng mạc. Ví dụ, ánh sáng đến nửa dưới của võng mạc chỉ ảnh hưởng tới một nửa tương ứng của V1. Các mạng tích chập nắm bắt thuộc tính này bằng các đặc trưng được định nghĩa dưới dạng ánh xạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mn" id="MJXp-Span-488">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">2</script></span> chiều.</p>
</li>
<li>
<p>V1 chứa nhiều <em>tế bào đơn giản</em>. Hoạt động của một tế bào đơn giản có phạm vi được biểu thị bởi một hàm tuyến tính của hình ảnh trong một phạm vi tiếp nhận cục bộ. Các đơn vị phát hiện của một mạng tích chập được thiết kế để mô phỏng các đặc tính này của các tế bào đơn giản.</p>
</li>
<li>
<p>V1 cũng chứa nhiều tế bào phức tạp. Những tế bào này phản ứng với các đặc trưng tương tự với các đặc trưng được phát hiện bởi các tế bào đơn giản, nhưng các tế bào phức tạp lại bất biến đối với các dịch chuyển nhỏ về vị trí của đặc trưng. Điều này truyền cảm hứng cho các đơn vị gộp của mạng tích chập. Các tế bào phức tạp cũng bất biến đối với một số thay đổi về ánh sáng vốn không thể bị nắm bắt chỉ bởi gộp  các vị trí không gian. Những bất biến này đã truyền cảm hứng cho một số chiến lược gộp kênh chéo trong các mạng tích chập, chẳng hạn như các đơn vị đầu ra cực đại [Goodfellow et al., 2013a].</p>
</li>
</ol><p>Mặc dù gần như chỉ biết về V1 nhưng người ta tin rằng các nguyên tắc cơ bản y hệt cũng được áp dụng vào các vùng khác của hệ thống thị giác. Trong góc nhìn đơng giản của ta về hệ thống thị giác, chiến lược cơ bản của việc phát hiện theo sau bởi phép gộp được áp dụng lặp đi lặp lại khi ta tiến sâu hơn vào não. Khi đi qua nhiều tầng kết cấu của não, cuối cùng ta sẽ tìm ra được các tế bào phản ứng với một số khái niệm cụ thể và bất biến đối với nhiều phép biến đổi đầu vào. Những tế bào này được đặt biệt danh là “tế bào bà ngoại” (grandmother cells) - ý tưởng là một người có thể có một neuron kích hoạt khi nhìn thấy hình ảnh của bà ngoại, bất kể bà ấy có xuất hiện ở bên trái hay bên phải của ảnh, chụp cận cảnh khuôn mặt hay phóng to thu nhỏ toàn bộ người, cho dù bà ấy có được chiếu sáng hoặc ở trong bóng tối.</p><p>Những tế bào này đã được chứng minh là thực sự tồn tại trong não người, trong một vùng gọi là thùy thái dương trung tâm [Quiroga et al., 2005]. Các nhà nghiên cứu đã kiểm tra liệu các neuron riêng lẻ có phản ứng với ảnh của những người nổi tiếng hay không. Họ đã tìm thấy thứ được gọi là “neuron Halle Berry”, một neuron riêng lẻ được kích hoạt bởi khái niệm về Halle Berry. Tế bào thần kinh này kích phát khi một người nhìn thấy ảnh của Halle Berry, một bản vẽ Halle Berry, hoặc thậm chí văn bản có chứa cụm từ “Halle Berry.” Tất nhiên, điều này không liên quan gì đến bản thân Halle Berry; cũng có các neuron khác đáp lại sự hiện diện của Bill Clinton, Jennifer Aniston, vân vân.</p><p>Các neuron thùy thái dương trung tâm này tổng quát hơn các mô hình mạng tích chập hiện đại, vốn sẽ không tự động khái quát hóa để xác định một người hoặc đối tượng khi đọc tên của nó. Thứ tương tự nhất với tầng cuối cùng của một mạng tích chập của các đặc trưng là một vùng não được gọi là <em>võ não phía dưới của thùy thái dương</em> (inferotemporal cortex) (IT). Khi nhìn thấy một vật thể, thông tin từ võng mạc, thông qua LGN, đến V1, sau đó chuyển sang V2, sau đó là V4, IT. Điều này xảy ra trong 100 mili giây đầu tiên khi nhìn thoáng qua vật thể. Nếu được phép tiếp tục nhìn vào vật thể trong thời gian dài hơn, thì thông tin sẽ bắt đầu truyền ngược vì não sử dụng phản hồi từ trên xuống để cập nhật các kích hoạt ở các vùng não cấp thấp hơn. Tuy nhiên, nếu ta làm gián đoạn tầm nhìn của người đó và chỉ quan sát các tỷ lệ kích phát xảy ra do sự kích hoạt lan truyền thuận trong 100 mili giây đầu tiên gây ra, thì IT tương tự như mạng tích chập. Các mạng tích chập có thể dự đoán tỷ lệ kích phát IT và thực hiện tương tự như con người (có giới hạn thời gian) đối với các tác vụ nhận dạng vật thể [DiCarlo, 2013].</p><p>Điều đó nói lên rằng, có rất nhiều sự khác biệt giữa các mạng tích chập và hệ thống thị giác của loài động vật có vú. Một số trong số những khác biệt này được các nhà thần kinh học tính toán hiểu rất rõ nhưng nằm ngoài phạm vi của cuốn sách của ta. Một số khác biệt khác thì chưa được biết đến, bởi vì nhiều câu hỏi cơ bản về cách hệ thống thị giác của loài động vật có vú hoạt động vẫn còn là ẩn số. Một vài điểm tóm lược như sau:</p><ul>
<li>
<p>Mắt người hầu như có độ phân giải rất thấp, ngoại trừ một mảnh nhỏ gọi là <em>hố thị giác</em> (fovea). Hố thị giác chỉ quan sát một khu vực có kích thước bằng độ dài móng tay cái. Mặc dù ta cảm thấy mình có thể nhìn thấy toàn bộ khung cảnh ở độ phân giải cao, thật ra đây chỉ là một ảo tưởng được tạo ra bởi phần tiềm thức của bộ não, khi nó chắp vá những cái nhìn lướt qua của các khu vực nhỏ. Hầu hết các mạng tích chập thực sự nhận được một lướng lớn hình ảnh có độ phân giải cao làm đầu vào. Bộ não con người thực hiện một số chuyển động mắt gọi là <em>liếc nhanh</em> (saccade) để nhìn thoáng qua những phần nổi bật hoặc liên quan nhất của khung cảnh. Kết hợp các cơ chế tập trung (attention mechanism) tương tự vào các mô hình học tập sâu là một hướng nghiên cứu tích cực. Trong bối cảnh học sâu, các cơ chế tập trung trở nên thành công nhất trong lĩnh vực xử lý ngôn ngữ tự nhiên, như được mô tả trong phần 12.4.5.1. Một số mô hình thị giác với các cơ chế hố thị giác đã được phát triển nhưng cho đến nay vẫn chưa trở thành hướng tiếp cận thống trị [Larochelle and Hinton, 2010; Denil et al., 2012].</p>
</li>
<li>
<p>Hệ thống thị giác của con người được tích hợp với nhiều giác quan khác, ví dụ như thính giác, và các yếu tố như tâm trạng và suy nghĩ. Mạng tích chập cho đến nay là chỉ hoàn toàn là về thị giác.</p>
</li>
<li>
<p>Hệ thống thị giác của con người làm nhiều hơn việc chỉ nhận biết các vật thể. Nó có thể hiểu được toàn cảnh, bao gồm nhiều vật thể và mối quan hệ giữa các vật thể, và nó xử lý tốt thông tin hình học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-mn" id="MJXp-Span-490">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-66">3</script></span> chiều cần thiết cho cơ thể để giao tiếp với vạn vật. Mạng tích chập đã được áp dụng vào một vài trong số những vấn đề này nhưng các ứng dụng vẫn chỉ đang ở giai đoạn sơ khai.</p>
</li>
<li>
<p>Ngay cả những vùng não đơn giản như V1 cũng bị ảnh hưởng mạnh mẽ bởi phản hồi từ các vùng bậc cao. Phản hồi đã được khám phá rộng rãi trong các mô hình mạng neuron nhưng chưa được chứng minh là có một cải tiến thuyết phục nào.</p>
</li>
<li>
<p>Khi IT lan truyền thuận kích phát nắm bắt được lượng thông tin tương tự như các đặc trưng trong mạng tích chập, ta không rõ rằng các tính toán trung gian giống nhau như thế nào. Não có thể sử dụng các hàm số kích hoạt và gộp rất khác. Có lẽ biểu thị hàm kích hoạt của một neuron riêng lẻ bằng một phản hồi tuyến tính đơn lẻ không hẳn là đã tốt. Một mô hình gần đây của V1 có liên quan đến nhiều bộ lọc bậc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-mn" id="MJXp-Span-492">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">2</script></span> cho mỗi neuron (Rust et al., 2005). Thực tế hình ảnh minh hoạ của ta về “các tế bào đơn giản” và “các tế bào phức tạp” có thể tạo ra một sự phân biệt không tồn tại; các tế bào đơn giản và các tế bào phức tạp có thể là cùng một loại tế bào nhưng “các tham số” của chúng kích hoạt một dải hành vi liên tục trải rộng từ mức ta gọi là “đơn giản” đến mức mà ta gọi là “phức tạp”.</p>
</li>
</ul><p>Điều đáng nói là khoa học thần kinh chỉ cho ta biết tương đối ít về cách làm thế nào để huấn luyện mạng tích chập. Các kiến trúc mô hình với chia sẻ tham số trên nhiều vị trí không gian khởi nguồn từ các mô hình kết nối thị giác ban đầu [Marr and Poggio, 1976], nhưng các mô hình này không sử dụng thuật toán lan truyền nghịch và trượt gradient hiện đại. Ví dụ, neocognitron [Fukushima, 1980] kết hợp hầu hết các yếu tố thiết kế kiến trúc mô hình của mạng tích chập hiện đại nhưng dựa trên một thuật toán phân cụm không giám sát theo từng tầng.</p><p>Lang và Hinton (1988) đã giới thiệu việc sử dụng mạng lan truyền nghịch để huấn luyện <em>mạng neuron có trì hoãn</em> (time-delay neural network - TDNN). Theo thuật ngữ đương đại, mạng neuron có trì hoãn là mạng tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-493"><span class="MJXp-mn" id="MJXp-Span-494">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">1</script></span> chiều được áp dụng cho chuỗi thời gian. Lan truyền nghịch được áp dụng vào các mô hình này không lấy cảm hứng từ bất kỳ quan sát thần kinh nào và được một số người coi là không hợp lý về mặt sinh học. Tiếp nối thành công của quá trình huấn luyện dựa trên lan truyền nghịch của mạng neuron có trì hoãn, [LeCun et al., 1989] đã phát triển mạng tích chập hiện đại bằng cách áp dụng cùng một thuật toán huấn luyện cho phép tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-495"><span class="MJXp-mn" id="MJXp-Span-496">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">2</script></span> chiều được áp dụng cho hình ảnh.</p><p>Đến nay, ta đã hiểu cách các tế bào đơn giản gần như tuyến tính và chọn lọc đối với các đặc trưng nhất định, các tế bào phức tạp phi tuyến tính hơn và trở nên bất biến trước một số phép biến đổi của các đặc trưng tế bào đơn giản và xếp chồng thành các tầng xen kẽ khả năng chọn lọc và tính bất biến với nhau, có thể sinh ra các tế bào “bà ngoại” cho các hiện tượng cụ thể. Ta vẫn chưa mô tả được chính xác những gì mà các tế bào riêng lẻ này phát hiện được. Trong một mạng phi tuyến tính đa tầng, sẽ khó để có thể hiểu được chức năng của các tế bào riêng biệt. Các tế bào đơn giản trong tầng đầu tiên dễ phân tích hơn vì phản hồi của chúng được điều khiển bởi hàm tuyến tính. Trong một mạng neuron nhân tạo, ta chỉ có thể hiển thị hình ảnh của lõi chập để xem các kênh tương ứng nào của mạng tích chập sẽ phản hồi. Trong một mạng neuron sinh học, ta không có quyền truy cập vào trọng số. Thay vào đó, ta đặt một điện cực vào neuron, hiển thị một số mẫu hình ảnh nhiễu trắng ở phía trước võng mạc của động vật và ghi lại cách mỗi mẫu trong số này làm cho neuron kích hoạt. Sau đó ta có thể khớp một mô hình tuyến tính với những phản hồi này để đạt được xấp xỉ của các trọng số thuộc neuron. Cách tiếp cận này được gọi là tương quan nghịch đảo [Ringach and Shapley, 2004].</p><p>Tương quan ngược cho ta thấy rằng hầu hết các tế bào V1 có trọng số được mô tả bởi các <em>hàm Gabor</em>. Hàm Gabor mô tả trọng số tại điểm ảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-mn" id="MJXp-Span-498">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">2</script></span> chiều. Ta có thể hình dung một hình ảnh như là một hàm của các tọa độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mn" id="MJXp-Span-500">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">2</script></span> chiều, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">I</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">x</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">y</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">I (x, y)</script></span>. Tương tự như vậy, một tế bào đơn giản có thể xem như việc lấy mẫu hình ảnh tại một tập hợp các tọa độ, được định nghĩa bởi tập hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mrow" id="MJXp-Span-509"><span class="MJXp-mi undefined" id="MJXp-Span-510">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">\mathbb{X}</script></span> các tọa độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">x</script></span> và tập hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-513"><span class="MJXp-mrow" id="MJXp-Span-514"><span class="MJXp-mi undefined" id="MJXp-Span-515">Y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">\mathbb{Y}</script></span> tọa độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">y</script></span>, sau đó áp dụng trọng số cũng là một hàm của vị trí, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">w</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">x</span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">y</span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">w (x, y)</script></span>. Từ góc nhìn này, phản ứng của một tế bào đơn giản đối với một hình ảnh được cho bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-525"><span class="MJXp-mtable" id="MJXp-Span-526"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-527" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-528" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">s</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">I</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-534"><span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-536" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">x</span><span class="MJXp-mo" id="MJXp-Span-538">∈</span><span class="MJXp-mrow" id="MJXp-Span-539"><span class="MJXp-mi undefined" id="MJXp-Span-540">X</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-541"><span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-543" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">y</span><span class="MJXp-mo" id="MJXp-Span-545">∈</span><span class="MJXp-mrow" id="MJXp-Span-546"><span class="MJXp-mi undefined" id="MJXp-Span-547">Y</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">w</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">x</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">y</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">I</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">x</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">y</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-78"> s(I) = \sum_{x \in \mathbb{X}}  \sum_{y \in \mathbb{Y}}w(x,y)I(x,y), \tag{9.15}</script></span></p><p>Cụ thể, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">w</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">x</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">y</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">w(x, y)</script></span> có dạng hàm Gabor:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-568"><span class="MJXp-mtable" id="MJXp-Span-569"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-570" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-571" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">w</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">x</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">y</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">α</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-582" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">f</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">ϕ</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-594" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-598" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">τ</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">α</span><span class="MJXp-mi" id="MJXp-Span-604">exp</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-610" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-613" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-614">′</span><span class="MJXp-mrow" id="MJXp-Span-615"><span class="MJXp-mn" id="MJXp-Span-616">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-620" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-623" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-624">′</span><span class="MJXp-mrow" id="MJXp-Span-625"><span class="MJXp-mn" id="MJXp-Span-626">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-628">cos</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">f</span><span class="MJXp-msup" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-634" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">ϕ</span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">w(x,y;\alpha,\beta_x,\beta_y,f,\phi,x_0,y_0,\tau) = \alpha \exp(-\beta_x x'^{2} -\beta_y y'^{2}) \cos(fx'+\phi),
\tag{9.16}</script></span></p><p>trong đó</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-639"><span class="MJXp-mtable" id="MJXp-Span-640"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-641" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-642" style="text-align: center;"><span class="MJXp-msup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-645" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">x</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-652" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-654">cos</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">τ</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">y</span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-667">sin</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">τ</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-81"> x' = (x - x_0)\cos(\tau) + (y-y_0)\sin(\tau) \tag{9.17}</script></span></p><p>và</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-672"><span class="MJXp-mtable" id="MJXp-Span-673"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-674" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-675" style="text-align: center;"><span class="MJXp-msup" id="MJXp-Span-676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-678" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">x</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-686" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-688">sin</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">τ</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">y</span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-699" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-701">cos</span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">τ</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-82">y' = -(x-x_0)\sin(\tau) + (y-y_0)\cos(\tau) \tag{9.18}</script></span></p><p>Ở đây <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">α</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-711" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-715" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">f</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">ϕ</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-723" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-727" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">\alpha , \beta_x , \beta_y , f , \phi , x_0 , y_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">\tau</script></span> là các tham số kiểm soát các thuộc tính của hàm Gabor. Hình 9.18 cho thấy một số ví dụ về các hàm Gabor với các thiệt lập khác nhau của các tham số này.</p><p><img src="https://i.imgur.com/fEQR3Yq.png" alt=""></p><blockquote>
<p>Hình 9.18: Các hàm Gabor với nhiều thiết lập tham số khác nhau. Màu trắng biểu thị trọng số dương lớn, màu đen biểu thị trọng số âm lớn và màu xám nền tương ứng với trọng số bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-730"><span class="MJXp-mn" id="MJXp-Span-731">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">0</script></span>. <em>(Hình bên trái)</em> Các hàm Gabor có các giá trị khác nhau của các tham số điều khiển hệ tọa độ: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-msubsup" id="MJXp-Span-733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-735" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">x_0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-msubsup" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-739" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">y_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">\tau</script></span>. Mỗi hàm Gabor trong lưới này được gán giá trị là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-742"><span class="MJXp-msubsup" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-745" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">x_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-746"><span class="MJXp-msubsup" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-749" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">y_0</script></span> tương ứng với vị trí của nó trong lưới, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">\tau</script></span> được chọn để mỗi bộ lọc Gabor nhạy cảm với hướng toả ra từ trung tâm của lưới. Đối với hai hình còn lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-752"><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-755" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">x_0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-756"><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-759" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">y_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">\tau</script></span> được gán là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mn" id="MJXp-Span-763">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">0</script></span>. <em>(Hình ở giữa)</em> Hàm Gabor với các tham số tỉ lệ Gauss khác nhau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-764"><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mrow" id="MJXp-Span-766" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-768" style="vertical-align: -0.4em;">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">β_x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-769"><span class="MJXp-msubsup" id="MJXp-Span-770"><span class="MJXp-mrow" id="MJXp-Span-771" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-773" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">β_y</script></span>. Các hàm Gabor được sắp xếp theo chiều rộng tăng (giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-msubsup" id="MJXp-Span-775"><span class="MJXp-mrow" id="MJXp-Span-776" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-778" style="vertical-align: -0.4em;">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">β_x</script></span>) khi ta di chuyển từ trái qua phải và tăng chiều cao (giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mrow" id="MJXp-Span-781" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-783" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">β_y</script></span>) khi ta di chuyển từ trên xuống dưới. Đối với hai hình còn lại, giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">β</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\beta</script></span> được cố định bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mn" id="MJXp-Span-787">1.5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">1.5</script></span> lần chiều rộng của ảnh. <em>(Hình bên phải)</em> Hàm Gabor với các thông số dạng hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">sin</script></span> khác nhau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">f</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">ϕ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">\phi</script></span>. Khi ta di chuyển từ trên xuống dưới, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">f</script></span> tăng lên, và khi ta dịch chuyển từ trái sang phải, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">ϕ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\phi</script></span> tăng lên. Đối với hai hình còn lại, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">\theta</script></span> được gán bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mn" id="MJXp-Span-803">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">f</script></span> được được cố định bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-mn" id="MJXp-Span-807">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">5</script></span> lần chiều rộng của ảnh.</p>
</blockquote><p>Các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-808"><span class="MJXp-msubsup" id="MJXp-Span-809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-811" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">x_0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-815" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">y_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">\tau</script></span> định nghĩa một hệ tọa độ. Ta dịch chuyển và xoay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">y</script></span> để tạo thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-msup" id="MJXp-Span-823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-825" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">x'</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-msup" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-829" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">y'</script></span>. Cụ thể, tế bào đơn giản sẽ phản hồi các đặc trưng hình ảnh tập trung tại điểm (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-830"><span class="MJXp-msubsup" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-833" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">x_0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-msubsup" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-837" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">y_0</script></span>) và nó sẽ phản ứng với những thay đổi về độ sáng khi ta di chuyển dọc theo một đường thẳng được xoay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">\tau</script></span> radian từ phương ngang.</p><p>Là một hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-msup" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-843" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">x'</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-844"><span class="MJXp-msup" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-847" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">y'</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">w</script></span> sau đó phản ứng với những thay đổi về độ sáng khi ta di chuyển dọc theo trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-msup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-853" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">x'</script></span>. Nó có hai yếu tố quan trọng: một là hàm Gauss, hai là hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-854"><span class="MJXp-mi" id="MJXp-Span-855">cos</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">\cos</script></span>.</p><p>Nhân tử Gauss <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">α</span><span class="MJXp-mi" id="MJXp-Span-858">exp</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mrow" id="MJXp-Span-863" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-865" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-868" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-869">′</span><span class="MJXp-mn" id="MJXp-Span-870">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-872"><span class="MJXp-mrow" id="MJXp-Span-873" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-875" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-msubsup" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-878" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-879">′</span><span class="MJXp-mn" id="MJXp-Span-880">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">\alpha\exp(− β_xx'^2− β_yy'^2)</script></span> có thể xem như là một <em>số hạng chặn cửa</em> (gating term) đảm bảo rằng tế bào đơn giản sẽ chỉ phản ứng với các giá trị gần khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-882"><span class="MJXp-msup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-885" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">x'</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-msup" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-889" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">y'</script></span> đều bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-mn" id="MJXp-Span-891">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">0</script></span>, nói cách khác, gần trung tâm của phạm vi tiếp nhận của tế bào. Nhân tử tỉ lệ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\alpha</script></span> điều chỉnh tổng độ lớn các phản ứng của tế bào đơn giản, trong khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-msubsup" id="MJXp-Span-895"><span class="MJXp-mrow" id="MJXp-Span-896" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-898" style="vertical-align: -0.4em;">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">β_x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mrow" id="MJXp-Span-901" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">β</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-903" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">β_y</script></span> kiểm soát tốc độ suy giảm phạm vi tiếp nhận của nó.</p><p>Nhân tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">s</span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">f</span><span class="MJXp-msup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-912" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">ϕ</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">cos(fx'+ \phi)</script></span> điều khiển cách một tế bào đơn phản ứng với sự thay đổi độ sáng dọc theo trục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-msup" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-919" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">x'</script></span>. Tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">f</script></span> điều khiển tần số của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-922"><span class="MJXp-mi" id="MJXp-Span-923">cos</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">\cos</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">ϕ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">\phi</script></span> điều khiển pha trống của nó.</p><p>Cùng với nhau, góc nhìn minh hoạ của các tế bào đơn giản có ý nghĩa rằng một tế bào đơn giản phản ứng với tần số không gian cụ thể của độ sáng theo một hướng cụ thể tại một vị trí cụ thể. Các tế bào đơn được kích thích nhất khi sóng của ánh sáng trong hình ảnh có cùng pha với các trọng số. Điều này xảy ra khi hình ảnh sáng với các trọng số là dương và tối với các trọng số là âm. Các tế bào đơn giản hầu hết bị hạn chế khi sóng của ánh sáng hoàn toàn lệch pha với các trọng số — khi hình ảnh tối với các trọng số là dương và sáng với các trọng số là âm.</p><p>Góc nhìn minh hoạ của một tế bào phức tạp đó là: nó tính chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-926"><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-929" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">L^2</script></span> của vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-930"><span class="MJXp-mn" id="MJXp-Span-931">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">2</script></span> chiều chứa hai phản hồi của hai tế bào đơn giản: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">c</span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">I</span><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-938"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale8" style="font-size: 201%; margin-top: 0.07em; margin-left: -0.109em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.089em solid;"></span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-941" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">I</span><span class="MJXp-msubsup" id="MJXp-Span-944"><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-946" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-950" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">I</span><span class="MJXp-msubsup" id="MJXp-Span-953"><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-955" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">c(I) =\sqrt{s_0(I)^2+ s_1(I)^2}</script></span>. Một trường hợp đặc biệt quan trọng xảy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-msubsup" id="MJXp-Span-957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-959" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">s_1</script></span> có cùng những tham số giống như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-msubsup" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-963" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">s_0</script></span> ngoại trừ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">ϕ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">\phi</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">ϕ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">\phi</script></span> được thiết lập sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-968"><span class="MJXp-msubsup" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-971" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">s_1</script></span> lệch pha <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-972"><span class="MJXp-mn" id="MJXp-Span-973">1</span><span class="MJXp-mrow" id="MJXp-Span-974"><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-976">4</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">1/4</script></span> chu kỳ so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-msubsup" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-980" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">s_0</script></span>. Trong trường hợp này, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-981"><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">s_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">s_1</script></span> tạo thành cặp cầu phương. Một tế bào phức tạp được xác định theo cách này sẽ phản ứng khi hình ảnh đã được căn chỉnh trọng số lại kiểu Gauss <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">I</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">x</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">y</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-996">exp</span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1002" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1005" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1009" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1012" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">I (x, y) \exp (−\beta_xx^2 − \beta_yy^2)</script></span> chứa một sóng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">sin</script></span> có biên độ cao với tần số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">f</script></span> theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">\tau</script></span> gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1026" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">(x_0, y_0)</script></span>, <em>bất chấp độ lệch pha ban đầu của sóng này</em>. Nói cách khác, tế bào phức tạp bất biến trước các tịnh tiến nhỏ của hình ảnh theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">τ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">\tau</script></span>, hoặc đổi dấu hình ảnh (thay thế màu đen bằng màu trắng và ngược lại).</p><p>Sự liên đới nổi bật nhất giữa khoa học thần kinh và học máy xuất phát từ việc so sánh trực quan các đặc trưng học được bởi các mô hình học máy với những đặc trưng được sử dụng bởi V1. Olshausen và Field (1996) đã chỉ ra rằng một thuật toán học không giám sát đơn giản, mã hóa thưa, học các đặc trưng với các trường tiếp nhận tương tự như các tế bào đơn giản. Kể từ đó, ta đã tìm ra một loạt đa dạng các thuật toán học thống kê học các đặc trưng với các hàm giống Gabor khi áp dụng cho các hình ảnh tự nhiên. Hầu hết các thuật toán học sâuH có tính chất này, chúng học các đặc trưng này trong tầng đầu tiên. Hình 9.19 sẽ cho thấy một số ví dụ. Do có rất nhiều thuật toán học tập khác nhau học bộ phát hiện cạnh biên, rất khó để kết luận rằng một thuật toán học cụ thể nào đó là mô hình “đúng đắn” của não khi chỉ dựa trên các đặc trưng mà nó học đưọc (mặc dù nó chắc chắn là một dấu hiệu xấu nếu thuật toán <em>không</em> học được một số bộ phát hiện cạnh biên khi áp dụng vào các hình ảnh tự nhiên). Những đặc trưng này là một phần quan trọng của cấu trúc thống kê của các hình ảnh tự nhiên và có thể được phục hồi bằng nhiều cách tiếp cận khác nhau với mô hình hoá thống kê. Xem công trình Hyvärinen và đồng nghiệp (2009) để lượt qua mảng thống kê hình ảnh tự nhiên.</p><p><img src="https://i.imgur.com/HpQBuTG.png" alt=""></p><blockquote>
<p>Hình 9.19: Nhiều thuật toán học máy học các đặc trưng giúp phát hiện các cạnh biên hoặc các màu sắc cụ thể của các cạnh biên khi áp dụng cho các hình ảnh tự nhiên. Các bộ phát hiện đặc trưng này gợi nhớ đến các hàm Gabor có trong võ não thị giác sơ cấp. <em>(Hình bên trái)</em> Trọng số học được bởi thuật toán học không giám sát (mã hóa thưa nhọn-và-bằng) được áp dụng cho các mảnh hình ảnh nhỏ. <em>(Hình bên phải)</em> Các lõi chập học được bởi tầng đầu tiên của một mạng tích chập đầu ra cực đại có giám sát đầy đủ. Các cặp bộ lọc gần kề ảnh hưởng đến cùng một đơn vị đầu ra cực đại.</p>
</blockquote><h1 id="911-Mạng-tích-chập-và-lịch-sử-của-học-sâu">9.11 Mạng tích chập và lịch sử của học sâu</h1><p>Mạng tích chập đã đóng một vai trò quan trọng trong lịch sử của học sâu. Đây là một ví dụ điển hình cho việc ứng dụng thành công những hiểu biết từ nghiên cứu não bộ rồi áp dụng cho các ứng dụng học máy. Cũng có một số mô hình học sâu đầu tiên cho kết quả tốt, khá lâu trước khi các mô hình học sâu được xem là khả thi. Mạng tích chập cũng là một trong số những mạng neuron đầu tiên giải quyết các ứng dụng thương mại quan trọng và vẫn đang đi đầu trong các ứng dụng thương mại về học sâu hiện nay. Ví dụ, trong thập niên 1990, nhóm nghiên cứu neuron tại AT&amp;T đã phát triển một mạng tích chập để kiểm tra các tấm séc [LeCun et al., 1998b]. Vào cuối những năm 1990, hệ thống này được tập đoàn NRC triển khai và đã đọc trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-mn" id="MJXp-Span-1035">10</span><span class="MJXp-mi" id="MJXp-Span-1036">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">10\%</script></span> tổng số lượng séc ở Hoa Kỳ. Sau đó, một số hệ thống nhân dạng ký tự quang học (OCR) và nhận dạng chữ viết tay dựa trên các mạng tích chập đã được Microsoft triển khai [Simard et al., 2003]. Xem chương 12 để biết thêm chi tiết về các ứng dụng như vậy và các ứng dụng hiện đại hơn của mạng tích chập. Xem công trình của Lecun và đồng nghiệp (2010) để hiểu lịch sử cặn kẽ hơn của mạng tích chập đến năm 2010.</p><p>Mạng tích chập cũng được sử dụng để giành chiến thắng trong nhiều cuộc thi. Các mối quan tâm về thương mại hoá học sâu bắt đầu khi Krizhevsky  và đồng nghiệp (2012) chiến thắng cuộc thi nhận dạng vật thể ImageNet. Tuy nhiên, việc mạng tích chập được sử dụng để giành chiến thắng trong các cuộc thi học máy và thị giác máy tính khác có ảnh hưởng ít hơn so với các năm trước.</p><p>Mạng tích chập là một trong số những mạng đa tầng đầu tiên hoạt động khi huấn luyện cùng thuật toán lan truyền ngược. Ta không hoàn toàn hiểu rõ rằng vì sao các mạng tích chập lại thành công khi các mạng lan truyền ngược tổng quát đã bị xem là thất bại. Có thể đơn giản vì các mạng tích chập hiệu quả về mặt tính toán hơn các mạng liên kết đầy đủ, do đó nó dễ dàng chạy nhiều thử nghiệm, tinh chỉnh việc triển khai và tinh chỉnh các siêu tham số hơn. Các mạng lớn hơn cũng có vẻ dễ huấn luyện hơn. Với phần cứng hiện đại, các mạng liên kết đầy đủ lớn hơn có vẻ thực hiện khá tốt đối với nhiều tác vụ, ngay cả khi sử dụng các tập dữ liệu có sẵn và hàm kích hoạt vốn phổ biến trong suốt khoảng thời gian khi mạng liên kết đầy đủ bị cho là không hoạt động tốt. Có thể rào cản chính đối với sự thành công của mạng neuron là tâm lý (người ta không mong đợi rằng mạng neuron hoạt động được, vì vậy họ đã không đầu tư đủ nghiêm túc để sử dụng được mạng neuron). Dù thế nào đi chăng nữa, thật may mắn là các mạng tích chập đã hoạt động tốt từ nhiều thập kỷ trước. Bằng nhiều cách, chúng đã thắp lên ngọn đuốc cho toàn bộ phần còn lại của học sâu và mở đường cho việc đón nhận mạng neuron nói chung.</p><p>Mạng tích chập cho ta một cách để chuyên biệt hóa các mạng neuron để trở nên hữu hiệu với dữ liệu có cấu trúc liên kết dạng lưới rõ ràng và mở rộng các mô hình như vậy lên quy mô cực lớn. Cách tiếp cận này là cách thành công nhất trong cấu trúc liên kết hình ảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1037"><span class="MJXp-mn" id="MJXp-Span-1038">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">2</script></span> chiều. Để xử lý dữ liệu tuần tự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-mn" id="MJXp-Span-1040">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">1</script></span> chiều, ta sẽ quay sang một kiểu chuyên biệt mạnh mẽ khác của mạng neuron: mạng neuron truy hồi.</p><hr><p>Người dịch: Thomas Nguyễn, Thu.Nguyen, Vân, Dương Nguyễn, Hùng Lê, Phát Võ, LA, Linux, lhlong, Xuân Tú</p></div>