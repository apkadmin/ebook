<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Chương 4 
Tính toán số  - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-4-Tính-toán-số-"><a class="anchor hidden-xs" href="#Chương-4-Tính-toán-số-" title="Chương-4-Tính-toán-số-"><span class="octicon octicon-link"></span></a><center>Chương 4 <br>
Tính toán số </center></h1><p><strong>Các vấn đề còn tồn đọng:</strong><br>
Thống nhất:</p><ul>
<li>quy luật chuỗi vs quy tắc dây chuyền (trong glossary)</li>
</ul><hr><p>Các thuật toán học máy thường yêu cầu một khối lượng tính toán rất lớn. Các thuật toán này giải các bài toán tính toán bằng cách thực hiện cập nhật các tham số qua rất nhiều vòng lặp thay vì đưa ra một công thức tính toán cho kết quả cuối cùng. Các phép toán chủ yếu là tối ưu hoá (tìm giá trị của đối số để cực đại hoá hoặc cực tiểu hoá giá trị của một hàm số) và giải các hệ phương trình tuyến tính. Ngay cả việc đánh giá một hàm số đơn giản liên quan tới số thực trên máy tính cũng là một bài toán khó, vì số thực không thể được biểu diễn chính xác với một lượng bộ nhớ hữu hạn.</p><h1 id="41-Tràn-luồng-và-thấp-luồng"><a class="anchor hidden-xs" href="#41-Tràn-luồng-và-thấp-luồng" title="41-Tràn-luồng-và-thấp-luồng"><span class="octicon octicon-link"></span></a>4.1 Tràn luồng và thấp luồng</h1><p>Khó khăn cơ bản nhất trong việc thực hiện tính toán trên máy tính là chúng ta cần biểu diễn các số thực vô hạn với một mô thức bit hữu hạn. Điều đó có nghĩa là, với hầu hết các số thực, ta chấp nhận một lượng sai số khi biểu diễn xấp xỉ số thực trên máy tính. Trong nhiều trường hợp, sai số này chính là sai số làm tròn. Tuy nhiên, việc làm tròn số lại gây ra vấn đề, đặc biệt là khi kết hợp nhiều bước tính toán, nhiều sai số nhỏ hợp sức gây ra sai số đủ lớn để khiến các thuật toán thất bại trong thực tế dù nó hoàn toàn đúng trên lý thuyết nếu chúng ta không tính đến vấn đề này khi thiết kế.</p><p>Có một dạng lỗi làm tròn rất nguy hiểm là <em>thấp luồng</em> (underflow). Thấp luồng xảy ra khi các số gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">0</span></span></span><script type="math/tex" id="MathJax-Element-1">0</script></span> được làm tròn thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mn" id="MJXp-Span-4">0</span></span></span><script type="math/tex" id="MathJax-Element-2">0</script></span>. Nhiều hàm sẽ thay đổi tính chất một cách căn bản khi đầu vào là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">0</span></span></span><script type="math/tex" id="MathJax-Element-3">0</script></span>, thay vì là một số dương rất nhỏ. Ví dụ, ta thường tránh phép chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mn" id="MJXp-Span-8">0</span></span></span><script type="math/tex" id="MathJax-Element-4">0</script></span> (một số môi trường phần mềm sẽ sinh ra <em>ngoại lệ</em> (exception) khi trường hợp này xảy ra, một số khác sẽ trả về giá trị NaN) hoặc phép lấy logarit của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mn" id="MJXp-Span-10">0</span></span></span><script type="math/tex" id="MathJax-Element-5">0</script></span> (đầu ra thường được coi là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-13">∞</span></span></span><script type="math/tex" id="MathJax-Element-6">-\infty</script></span>, sau đó nó sẽ trở thành NaN nếu nó được sử dụng trong các phép tính số học tiếp theo đó).</p><blockquote>
<p><em><strong>ND</strong></em>: NaN là viết tắt của Not a Number, nghĩa là không-phải-số.</p>
</blockquote><p>Một dạng lỗi cũng rất nguy hiểm khác là <em>tràn luồng</em> (overflow). Tràn luồng xảy ra khi các số với giá trị rất lớn bị xấp xỉ thành  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi" id="MJXp-Span-15">∞</span></span></span><script type="math/tex" id="MathJax-Element-7">\infty</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-18">∞</span></span></span><script type="math/tex" id="MathJax-Element-8">-\infty</script></span>. Các phép tính số học sau đó sẽ quy các giá trị vô hạn này thành NaN.</p><p>Một ví dụ về một hàm số cần phải được bình ổn để tránh tràn luồng và thấp luồng là hàm softmax. Hàm softmax thường được dùng để dự đoán các xác suất trong một một phân bố multinoulli (phân phối phạm trù, được nhắc đến trong chương 3). Hàm softmax được định nghĩa như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-19"><span class="MJXp-mtable" id="MJXp-Span-20"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-21" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-22" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mi" id="MJXp-Span-24">s</span><span class="MJXp-mi" id="MJXp-Span-25">o</span><span class="MJXp-mi" id="MJXp-Span-26">f</span><span class="MJXp-mi" id="MJXp-Span-27">t</span><span class="MJXp-mi" id="MJXp-Span-28">m</span><span class="MJXp-mi" id="MJXp-Span-29">a</span><span class="MJXp-mi" id="MJXp-Span-30">x</span></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-32">x</span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-37" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-38">exp</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-43" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">n</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">j</span><span class="MJXp-mo" id="MJXp-Span-49">=</span><span class="MJXp-mn" id="MJXp-Span-50">1</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-53">exp</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9">\mathrm{softmax}(\boldsymbol{x})_i = \frac{\exp(x_i)}{\sum_{j=1}^{n} \exp(x_j)} \tag{4.1}</script></span></p><p>Xét trường hợp khi tất cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-10">x_i</script></span> đều có giá trị bằng một hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">c</span></span></span><script type="math/tex" id="MathJax-Element-11">c</script></span>. Về mặt giải tích, ta dễ thấy tất cả đầu ra của hàm đều bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-mfrac" id="MJXp-Span-67" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-68">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">n</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-12">\frac{1}{n}</script></span> . Nhưng về mặt số học, điều này có thể không xảy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">c</span></span></span><script type="math/tex" id="MathJax-Element-13">c</script></span> có trị tuyệt đối cực lớn. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">c</span></span></span><script type="math/tex" id="MathJax-Element-14">c</script></span> rất âm, thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi" id="MJXp-Span-75">exp</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">c</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-15">\exp(c)</script></span> sẽ bị thấp luồng. Điều này dẫn tới việc mẫu số của hàm softmax sẽ bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mn" id="MJXp-Span-81">0</span></span></span><script type="math/tex" id="MathJax-Element-16">0</script></span> và kết quả của hàm là vô định. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">c</span></span></span><script type="math/tex" id="MathJax-Element-17">c</script></span> rất dương, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mi" id="MJXp-Span-85">exp</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">c</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">\exp(c)</script></span> sẽ bị tràn luồng và kết quả của hàm cũng là vô định. Cả hai vấn đề này đều có thể giải quyết được bằng cách tính gián tiếp hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mi" id="MJXp-Span-92">s</span><span class="MJXp-mi" id="MJXp-Span-93">o</span><span class="MJXp-mi" id="MJXp-Span-94">f</span><span class="MJXp-mi" id="MJXp-Span-95">t</span><span class="MJXp-mi" id="MJXp-Span-96">m</span><span class="MJXp-mi" id="MJXp-Span-97">a</span><span class="MJXp-mi" id="MJXp-Span-98">x</span></span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-100">x</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-19">\mathrm{softmax}(\boldsymbol x)</script></span> thông qua hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mrow" id="MJXp-Span-103"><span class="MJXp-mi" id="MJXp-Span-104">s</span><span class="MJXp-mi" id="MJXp-Span-105">o</span><span class="MJXp-mi" id="MJXp-Span-106">f</span><span class="MJXp-mi" id="MJXp-Span-107">t</span><span class="MJXp-mi" id="MJXp-Span-108">m</span><span class="MJXp-mi" id="MJXp-Span-109">a</span><span class="MJXp-mi" id="MJXp-Span-110">x</span></span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-112">z</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-20">\mathrm{softmax}(\boldsymbol z)</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-122">z</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-124">x</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-21">\boldsymbol z = \boldsymbol x - \max_i x_i</script></span>. Một vài biến đổi đại số đơn giản chỉ ra rằng giá trị của hàm softmax không bị thay đổi về mặt giải tích khi ta cộng hoặc trừ vector đầu vào với một đại lượng vô hướng (chẳng hạn như hằng số). Khi trừ các phần tử của vector cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mrow" id="MJXp-Span-133"><span class="MJXp-mi" id="MJXp-Span-134">m</span><span class="MJXp-mi" id="MJXp-Span-135">a</span><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi" id="MJXp-Span-137" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-141" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-22">\mathrm{max_i} x_i</script></span>, giá trị đối số lớn nhất của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">p</span></span></span><script type="math/tex" id="MathJax-Element-23">exp</script></span> sẽ là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mn" id="MJXp-Span-147">0</span></span></span><script type="math/tex" id="MathJax-Element-24">0</script></span>. Điều này loại bỏ nguy cơ bị tràn luồng. Tương tự, khi mẫu số của hàm  có ít nhất một thành phần có giá trị bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mn" id="MJXp-Span-149">1</span></span></span><script type="math/tex" id="MathJax-Element-25">1</script></span> (ứng với trường hợp đối số của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">p</span></span></span><script type="math/tex" id="MathJax-Element-26">exp</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mn" id="MJXp-Span-155">0</span></span></span><script type="math/tex" id="MathJax-Element-27">0</script></span> nói trên), ta sẽ loại bỏ khả năng mẫu số bị thấp luồng gây bởi phép chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mn" id="MJXp-Span-157">0</span></span></span><script type="math/tex" id="MathJax-Element-28">0</script></span>.</p><p>Tuy nhiên, vẫn tồn tại một vấn đề nhỏ. Thấp luồng ở tử số vẫn có thể khiến giá trị của cả biểu thức bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mn" id="MJXp-Span-159">0</span></span></span><script type="math/tex" id="MathJax-Element-29">0</script></span>. Có nghĩa là nếu ta tính toán giá trị của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mi" id="MJXp-Span-161">log</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mi" id="MJXp-Span-164">s</span><span class="MJXp-mi" id="MJXp-Span-165">o</span><span class="MJXp-mi" id="MJXp-Span-166">f</span><span class="MJXp-mi" id="MJXp-Span-167">t</span><span class="MJXp-mi" id="MJXp-Span-168">m</span><span class="MJXp-mi" id="MJXp-Span-169">a</span><span class="MJXp-mi" id="MJXp-Span-170">x</span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-172">x</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-30">\log \mathrm{softmax}(\boldsymbol x)</script></span> bằng cách tính giá trị hàm softmax trước rồi thực hiện phép lấy logarit, ta có thể sẽ thu được kết quả sai là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-176">∞</span></span></span><script type="math/tex" id="MathJax-Element-31">-\infty</script></span>. Thay vào đó, ta cần cài đặt một hàm riêng để tính toán hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mi" id="MJXp-Span-178">log</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mi" id="MJXp-Span-181">s</span><span class="MJXp-mi" id="MJXp-Span-182">o</span><span class="MJXp-mi" id="MJXp-Span-183">f</span><span class="MJXp-mi" id="MJXp-Span-184">t</span><span class="MJXp-mi" id="MJXp-Span-185">m</span><span class="MJXp-mi" id="MJXp-Span-186">a</span><span class="MJXp-mi" id="MJXp-Span-187">x</span></span></span></span><script type="math/tex" id="MathJax-Element-32">\log \mathrm{softmax}</script></span> theo một cách bình ổn kết quả về mặt số học hơn. Ta có thể bình ổn hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="MJXp-mi" id="MJXp-Span-189">log</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-191"><span class="MJXp-mi" id="MJXp-Span-192">s</span><span class="MJXp-mi" id="MJXp-Span-193">o</span><span class="MJXp-mi" id="MJXp-Span-194">f</span><span class="MJXp-mi" id="MJXp-Span-195">t</span><span class="MJXp-mi" id="MJXp-Span-196">m</span><span class="MJXp-mi" id="MJXp-Span-197">a</span><span class="MJXp-mi" id="MJXp-Span-198">x</span></span></span></span><script type="math/tex" id="MathJax-Element-33">\log \mathrm{softmax}</script></span> bằng kĩ thuật tương tự đã dùng với hàm softmax.</p><p>Trong phần lớn cuốn sách này, chúng tôi sẽ không liệt kê cụ thể tất cả những vấn đề liên quan tới tính toán số trong thực thi nhiều thuật toán nêu ra trong sách. Những nhà phát triển các thư viện bậc thấp cần quan tâm tới các vấn đề liên quan tới tính toán số khi lập trình các thuật toán học sâu. Hầu hết độc giả của cuốn sách này có thể đơn giản chỉ dựa vào các thư viện bậc thấp đã cung cấp các cách cài đặt ổn định. Trong vài trường hợp, ta có thể cài đặt một thuật toán mới và các thư viện bậc thấp sẽ tự bình ổn kết quả của thuật toán đó. Ví dụ, Theano [Bergstra et al., 2010; Bastien et al., 2012] là một thư viện tự động phát hiện và bình ổn nhiều biểu thức không ổn định về mặt tính toán số thường gặp khi nghiên cứu học sâu.</p><h1 id="42-Tính-kém-điều-hòa"><a class="anchor hidden-xs" href="#42-Tính-kém-điều-hòa" title="42-Tính-kém-điều-hòa"><span class="octicon octicon-link"></span></a>4.2 Tính kém điều hòa</h1><p>Tính điều hòa, nói đến mức độ thay đổi đầu ra của hàm tương ứng khi biến đầu vào có những thay đổi nhỏ. Những hàm thay đổi nhanh khi biến đầu vào chỉ biến động một chút sẽ gây ra vấn đề trong hệ thống tính toán, bởi các sai số làm tròn của đầu vào có thể dẫn đến những thay đổi lớn ở đầu ra.</p><p>Xét hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">f</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-202">x</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-205"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-206" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-207" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-208">−</span><span class="MJXp-mn" id="MJXp-Span-209">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-210">x</span></span></span><script type="math/tex" id="MathJax-Element-34">f(\boldsymbol x)=\boldsymbol A ^ {-1} \boldsymbol x</script></span>. Khi ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-212">A</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-214"><span class="MJXp-mrow" id="MJXp-Span-215" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-216">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-217" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-218">n</span><span class="MJXp-mo" id="MJXp-Span-219">×</span><span class="MJXp-mi" id="MJXp-Span-220">n</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">\boldsymbol{A} \in \mathbb{R}^{\rm n\times n}</script></span> có một phép phân tích giá trị riêng, <em>hệ số điều hòa</em> (condition number) của nó là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-221"><span class="MJXp-mtable" id="MJXp-Span-222"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-223" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-224" style="text-align: center;"><span class="MJXp-munder" id="MJXp-Span-225"><span><span class="MJXp-mi" id="MJXp-Span-226">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227" style="margin-left: 0px;">i</span><span class="MJXp-mo" id="MJXp-Span-228">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.095em;">|</span></span><span class="MJXp-mtable" id="MJXp-Span-232"><span><span class="MJXp-mtr" id="MJXp-Span-233" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-234" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-235" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-238" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.095em;">|</span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-36">\underset{i, j}{\operatorname{max}} \begin{vmatrix}\frac{\lambda_i}{\lambda_j}\end{vmatrix} \tag{4.2}</script></span></p><p>Đây là tỉ số giữa giá trị tuyệt đối của giá trị riêng lớn nhất và nhỏ nhất. Khi tỉ số này lớn, phép lấy ma trận nghịch đảo cực kì nhạy cảm với sai số của đầu vào.</p><p>Sự nhạy cảm này là tính chất nội tại của ma trận, chứ không phải kết quả của sai số làm tròn khi nghịch đảo ma trận. Các ma trận kém điều hòa sẽ khuếch đại những sai số tồn tại trước đó khi ta thực hiện phép nhân với ma trận nghịch đảo thực sự. Trong thực tế, sai số sẽ càng nghiêm trọng hơn bởi các sai số liên quan tới tính toán số trong quá trình tính nghịch đảo.</p><h1 id="43-Tối-ưu-dựa-trên-gradient"><a class="anchor hidden-xs" href="#43-Tối-ưu-dựa-trên-gradient" title="43-Tối-ưu-dựa-trên-gradient"><span class="octicon octicon-link"></span></a>4.3 Tối ưu dựa trên gradient</h1><p>Phần lớn các thuật toán học sâu đều liên quan tới tối ưu theo cách này hay cách khác. Tối ưu là tác vụ cực tiểu hóa hoặc cực đại hóa hàm  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">f</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-246">x</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-37">f(\boldsymbol x)</script></span> bằng cách thay đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-249">x</span></span></span><script type="math/tex" id="MathJax-Element-38">\boldsymbol x</script></span>. Ta thường đưa các bài toán tối ưu về dạng cực tiểu hóa hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">f</span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-253">x</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-39">f(\boldsymbol x)</script></span>. Ta có thể giải quyết bài toán tìm cực đại thông qua một thuật toán tìm cực tiểu bằng cách cực tiểu hoá hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">f</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-259">x</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">-f(\boldsymbol x)</script></span>.</p><p>Các hàm ta cần cực tiểu hóa hoặc cực đại hóa được gọi là <em>hàm mục tiêu</em> (objective function), hoặc <em>tiêu chuẩn</em> (criterion). Khi ta cực tiểu hoá chúng, hàm này còn có thể gọi là <em>hàm chi phí</em> (cost function), <em>hàm mất mát</em> (loss function) hay <em>hàm sai số</em> (error function). Trong cuốn sách này, các thuật ngữ trên có thể được dùng thay thế nhau nhưng đều mang ý nghĩa tương đương, mặc dù một số tài liệu khác về học máy sử dụng những thuật ngữ này với ý nghĩa khác nhau.</p><p>Ta thường kí hiệu giá trị của đối số để hàm số đạt cực đại hoặc cực tiểu bằng dấu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span></span></span><script type="math/tex" id="MathJax-Element-41">*</script></span>. Ví dụ, ta có thể kí hiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-263"><span class="MJXp-msubsup" id="MJXp-Span-264"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-265" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-266" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-268">arg</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">f</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-273">x</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">\boldsymbol{x}^* = \arg \min f(\boldsymbol{x})</script></span>.</p><p>Chúng tôi ngầm định rằng độc giả đã quen thuộc với các phép tính vi tích phân, nhưng chúng tôi vẫn sẽ điểm qua một số khái niệm về các phép tính vi tích phân liên quan tới bài toán tối ưu hóa.</p><p>Giả sử, ta có hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">y</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">f</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">x</span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-43">y = f(x)</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">x</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">y</span></span></span><script type="math/tex" id="MathJax-Element-44">x,y</script></span> đều là số thực. Đạo hàm của hàm này được kí hiệu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-289" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-290">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">x</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-45">f^{\prime}(x)</script></span> hay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mfrac" id="MJXp-Span-295" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">x</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-46">\frac{dy}{dx}</script></span>. Đạo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-303" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-304">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">x</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-47">f^{\prime}(x)</script></span> cho ta biết độ dốc của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">f</span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">x</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-48">f(x)</script></span> tại điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">x</span></span></span><script type="math/tex" id="MathJax-Element-49">x</script></span>. Nói cách khác, nó cho ta biết sự thay đổi của hàm tương ứng với sự thay đổi rất nhỏ của biến: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">f</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">x</span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">ϵ</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">f</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">x</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-331" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-332">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">x</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">f(x + \epsilon) \approx f(x) + \epsilon f^{\prime}(x)</script></span></p><p>Do đó, đạo hàm có ích trong việc tối thiểu hóa một hàm vì nó cho chúng ta biết nên thay đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">x</span></span></span><script type="math/tex" id="MathJax-Element-51">x</script></span> thế nào để cải thiện hàm tối ưu một lượng nhỏ. Ví dụ, ta biết rằng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-52">\epsilon</script></span> đủ nhỏ thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">f</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">x</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">ϵ</span><span class="MJXp-mspace" id="MJXp-Span-346" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-mi" id="MJXp-Span-348">s</span><span class="MJXp-mi" id="MJXp-Span-349">i</span><span class="MJXp-mi" id="MJXp-Span-350">g</span><span class="MJXp-mi" id="MJXp-Span-351">n</span></span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-355" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-356">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">x</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-53">f(x -\epsilon \,\mathrm{sign}( f^{\prime}(x)))</script></span>  sẽ nhỏ hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">f</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">x</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-54">f(x)</script></span>. Từ đây, ta có thể giảm giá trị hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">f</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">x</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">f(x)</script></span> bằng cách tăng hoặc giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">x</span></span></span><script type="math/tex" id="MathJax-Element-56">x</script></span> một lượng nhỏ về hướng ngược với hướng của của đạo hàm. Kỹ thuật này được gọi là <em>trượt gradient</em> (gradient descent). Hình 4.1 minh họa cho kỹ thuật này.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-374"><span class="MJXp-mspace" id="MJXp-Span-375" style="width: 9.449em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-57">\hspace{4cm}</script></span><img src="https://i.imgur.com/E2Haih6.png" alt=""></p><blockquote>
<p>Hình 4.1: Trượt gradient. Một minh họa về cách thuật toán trượt gradient sử dụng các đạo hàm của một hàm để đi theo dốc của hàm tiến về một điểm cực tiểu.</p>
</blockquote><p>Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-376"><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-379" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-380">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">x</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-385">0</span></span></span><script type="math/tex" id="MathJax-Element-58">f^{\prime}(x) = 0</script></span> , ta không biết được nên thay đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">x</span></span></span><script type="math/tex" id="MathJax-Element-59">x</script></span> như thế nào nếu chỉ dựa vào đạo hàm. Ta gọi các điểm mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-391" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-392">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">x</span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-397">0</span></span></span><script type="math/tex" id="MathJax-Element-60">f^{\prime}(x) = 0</script></span> là các <em>điểm tới hạn</em> (critical point) hoặc <em>điểm dừng</em> (stationary point). Điểm <em>cực tiểu cục bộ</em> (local minimum) là điểm mà giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">f</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">x</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-61">f(x)</script></span> nhỏ hơn giá trị của hàm tại tất cả các điểm lân cận, do đó, ta không thể giảm giá trị của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">f</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">x</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">f(x)</script></span> bằng cách thay đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span></span></span><script type="math/tex" id="MathJax-Element-63">x</script></span> một lượng vô cùng nhỏ như trước. Tương tự, điểm <em>cực đại cục bộ</em> (local maximum) là điểm mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">f</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">x</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-64">f(x)</script></span> có giá trị lớn hơn giá trị của hàm tại tất cả các điểm lân cận, do đó, ta không thể tăng giá trị của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">f</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">x</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-65">f(x)</script></span> bằng cách thay đổi  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">x</span></span></span><script type="math/tex" id="MathJax-Element-66">x</script></span> một lượng vô cùng nhỏ như trước. Có một vài điểm tới hạn không phải là cực đại hay cực tiểu. Các điểm đó ta gọi là các <em>điểm yên ngựa</em> (saddle point). Hình 4.2 minh họa từng loại điểm tới hạn.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mspace" id="MJXp-Span-423" style="width: 7.087em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-67">\hspace{3cm}</script></span><img src="https://i.imgur.com/yAoQUb2.png" alt=""></p><blockquote>
<p>Hình 4.2 Các loại điểm tới hạn. Ví dụ về ba loại điểm tới hạn trong không gian một chiều. Điểm tới hạn là điểm có độ dốc bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-mn" id="MJXp-Span-425">0</span></span></span><script type="math/tex" id="MathJax-Element-68">0</script></span>. Một điểm như vậy có thể là một điểm cực tiểu cục bộ, giá trị hàm số tại điểm này có giá trị thấp hơn tại các điểm lân cận; hoặc một điểm cực đại cục bộ, giá trị hàm số tại điểm này có giá trị cao hơn tại các điểm lân cận; hoặc cũng có thể là một điểm yên ngựa, giá trị hàm số tại điểm này có giá trị cao hơn tại một số điểm lân cận nhưng lại thấp hơn tại một số các điểm lân cận khác.</p>
</blockquote><p>Một điểm mà hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">f</span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">x</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">f(x)</script></span> đạt giá trị nhỏ nhất được gọi là <em>cực tiểu toàn cục</em> (global optimum) của hàm. Một hàm số có thể có một hoặc nhiều điểm cực tiểu toàn cục. Hàm cũng có thể có những điểm cực tiểu cục bộ mà không phải cực tiểu toàn cục. Trong phạm vi của học sâu, chúng ta thường gặp bài toán tối ưu mà ở đó hàm có nhiều cực tiểu cục bộ nhưng không phải toàn cục, hoặc hàm có nhiều điểm yên ngựa được bao quanh bởi các vùng phẳng. Tất cả những vấn đề này làm cho việc tối ưu hóa trở nên khó khăn, đặc biệt là khi các biến của hàm số là biến nhiều chiều. Do đó, chúng ta thường chỉ cần tìm một giá trị mà ở đó hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">f</span></span></span><script type="math/tex" id="MathJax-Element-70">f</script></span> có giá trị nhỏ nhưng không nhất thiết phải là cực tiểu theo đúng nghĩa. Xem một ví dụ minh họa trong hình 4.3.</p><p><img src="https://i.imgur.com/m0tYi8A.png" alt=""></p><blockquote>
<p>Hình 4.3. Xấp xỉ giá trị cực tiểu. Các thuật toán tối ưu có thể không tìm được cực tiểu toàn cục khi tồn tại nhiều cực tiểu cục bộ hoặc các <em>miền phẳng</em> (plateaus). Trong phạm vi của học sâu, chúng ta cũng thường chấp nhận những nghiệm như vậy ngay cả khi nó không thực sự là các điểm cực tiểu, miễn là nó tương ứng với các giá trị rất nhỏ của hàm chi phí.</p>
</blockquote><p>Chúng ta thường cực tiểu hóa các hàm đa biến: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">f</span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mrow" id="MJXp-Span-437" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-438">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-439" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mrow" id="MJXp-Span-442"><span class="MJXp-mi undefined" id="MJXp-Span-443">R</span></span></span></span><script type="math/tex" id="MathJax-Element-71">f : \mathbb{R}^{n} \rightarrow \mathbb{R}</script></span>. Để khái niệm “tối ưu hóa” trở nên hợp lý, đầu ra của hàm phải là một đại lượng vô hướng duy nhất.</p><p>Với các hàm đa biến, ta phải sử dụng khái niệm đạo hàm riêng. Đạo hàm riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mfrac" id="MJXp-Span-445" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-446">∂</span><span class="MJXp-mrow" id="MJXp-Span-447"></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-448">∂</span><span class="MJXp-mrow" id="MJXp-Span-449"><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">f</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">x</span></span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-72">\frac{\partial{}}{\partial{x_i}}f({x})</script></span> là đại lượng đo sự biến thiên của hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">f</span></span></span><script type="math/tex" id="MathJax-Element-73">f</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-463" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-74">x_i</script></span> tăng tại điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-465">x</span></span></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol{x}</script></span>. <em>Gradient</em> là khái niệm tổng quát của đạo hàm cho một vector: gradient của hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">f</span></span></span><script type="math/tex" id="MathJax-Element-76">f</script></span> là vector chứa tất cả đạo hàm riêng của hàm số, kí hiệu: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi" id="MJXp-Span-470" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-472">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">f</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-475">x</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-77">\nabla_{\boldsymbol x}f(\boldsymbol x)</script></span>. Phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">i</span></span></span><script type="math/tex" id="MathJax-Element-78">i</script></span> của gradient biểu diễn đạo hàm riêng phần của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">f</span></span></span><script type="math/tex" id="MathJax-Element-79">f</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-484" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-80">x_i</script></span>. Trong không gian đa chiều, những điểm tới hạn là những điểm mà tại đó mọi phần tử của gradient đều bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-485"><span class="MJXp-mn" id="MJXp-Span-486">0</span></span></span><script type="math/tex" id="MathJax-Element-81">0</script></span>.</p><p><em>Đạo hàm theo hướng</em> (directional derivative) theo phương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-488">u</span></span></span><script type="math/tex" id="MathJax-Element-82">\boldsymbol u</script></span> (một vector đơn vị) là độ dốc của hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">f</span></span></span><script type="math/tex" id="MathJax-Element-83">f</script></span> theo phương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">u</span></span></span><script type="math/tex" id="MathJax-Element-84">u</script></span>. Nói cách khác, đạo hàm theo hướng là đạo hàm của hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">f</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-496">x</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-499">u</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-85">f(\boldsymbol x + \alpha \boldsymbol u)</script></span> đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">α</span></span></span><script type="math/tex" id="MathJax-Element-86">\alpha</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">α</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-506">0</span></span></span><script type="math/tex" id="MathJax-Element-87">\alpha = 0</script></span>. Sử dụng quy tắc chuỗi, ta có thể nhận ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mfrac" id="MJXp-Span-508" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-509">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-510">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">α</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">f</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-514">x</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-517">u</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-88">\frac{\partial}{\partial \alpha} f(\boldsymbol x + \alpha \boldsymbol u)</script></span> bằng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-msubsup" id="MJXp-Span-525"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-526" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-527" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-528">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mi" id="MJXp-Span-530" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-531" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-532">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">f</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-535">x</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-89">\boldsymbol u^{\intercal} \nabla_{\boldsymbol x} f(\boldsymbol x)</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">α</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-540">0</span></span></span><script type="math/tex" id="MathJax-Element-90">\alpha = 0</script></span>.</p><p>Để tìm giá trị nhỏ nhất của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">f</span></span></span><script type="math/tex" id="MathJax-Element-91">f</script></span>, chúng ta cần tìm hướng sao cho hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">f</span></span></span><script type="math/tex" id="MathJax-Element-92">f</script></span> giảm nhanh nhất.<br>
Ta có thể thực hiện điều này  bằng cách sử dụng đạo hàm theo hướng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-545"><span class="MJXp-mtable" id="MJXp-Span-546"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-547" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-548" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-549"><span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-551" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-552">u</span><span class="MJXp-mo" id="MJXp-Span-553">,</span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-556" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-557">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-558">u</span><span class="MJXp-mo" id="MJXp-Span-559">=</span><span class="MJXp-mn" id="MJXp-Span-560">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-561"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-562" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-563" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-564">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-565"><span class="MJXp-mi" id="MJXp-Span-566" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-567" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-568">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">f</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-571">x</span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-93">\min_{\boldsymbol u, \boldsymbol u^{\intercal}\boldsymbol u = 1}\boldsymbol u^{\intercal}  \nabla_{\boldsymbol x} f(\boldsymbol x) \tag{4.3}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-573"><span class="MJXp-mtable" id="MJXp-Span-574"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-575" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-576" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-578"><span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-580" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-581">u</span><span class="MJXp-mo" id="MJXp-Span-582">,</span><span class="MJXp-msubsup" id="MJXp-Span-583"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-584" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-585" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-586">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-587">u</span><span class="MJXp-mo" id="MJXp-Span-588">=</span><span class="MJXp-mn" id="MJXp-Span-589">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-590"><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-592"><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-594">u</span><span class="MJXp-mrow" id="MJXp-Span-595"><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-597"><span class="MJXp-mrow" id="MJXp-Span-598" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-601">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-604"><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi" id="MJXp-Span-607" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-609">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">f</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-612">x</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-614"><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-616"><span class="MJXp-mrow" id="MJXp-Span-617" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-619" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-620">2</span></span></span><span class="MJXp-mi" id="MJXp-Span-621">cos</span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">θ</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-94">= \min_{\boldsymbol u, \boldsymbol u^{\intercal}\boldsymbol u=1} ||\boldsymbol u||_{2}||\nabla_{\boldsymbol x} f(\boldsymbol x)||_{2} \cos \theta \tag{4.4}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">θ</span></span></span><script type="math/tex" id="MathJax-Element-95">\theta</script></span> là góc giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-626"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-627">u</span></span></span><script type="math/tex" id="MathJax-Element-96">\boldsymbol u</script></span> và gradient. Thay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mrow" id="MJXp-Span-629"><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-631"><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-633">u</span><span class="MJXp-mrow" id="MJXp-Span-634"><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mrow" id="MJXp-Span-637" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-639" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-641">1</span></span></span><script type="math/tex" id="MathJax-Element-97">||\boldsymbol u||_2 = 1</script></span> và bỏ qua các đại lượng không phụ thuộc vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-642"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-643">u</span></span></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol u</script></span>, bài toán trở thành tìm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-644"><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-647" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-648">u</span></span></span><span class="MJXp-mi" id="MJXp-Span-649">cos</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">θ</span></span></span><script type="math/tex" id="MathJax-Element-99">\min_{\boldsymbol u} \cos \theta</script></span> . Hàm số này đạt giá trị cực tiểu khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">u</span></span></span><script type="math/tex" id="MathJax-Element-100">u</script></span> có hướng ngược lại so với gradient. Nói cách khác, gradient chỉ theo hướng đi lên và phương nghịch của gradient chỉ theo hướng đi xuống. Chúng ta có thể giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">f</span></span></span><script type="math/tex" id="MathJax-Element-101">f</script></span> bằng cách di chuyển theo phương nghịch của gradient. Phương pháp này được gọi là <em>gradient dốc nhất</em> (steepest gradient) hoặc <em>trượt gradient</em> (gradient descent).</p><p>Trượt gradient đưa ra một điểm mới:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-656"><span class="MJXp-mtable" id="MJXp-Span-657"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-658" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-659" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-660"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-661" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-662" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-664">x</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-667"><span class="MJXp-mi" id="MJXp-Span-668" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-669" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-670">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">f</span><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-673">x</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-102">\boldsymbol x^\prime =  \boldsymbol x - \epsilon \nabla_{\boldsymbol x} f(\boldsymbol x) \tag{4.5}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-103">\epsilon</script></span> là <em>tốc độ học</em> (learning rate), một đại lượng vô hướng dương xác định kích thước của bước nhảy. Chúng ta có thể lựa chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-104">\epsilon</script></span> theo nhiều cách khác nhau. Một cách phổ biến nhất cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-105">\epsilon</script></span> nhận giá trị là hằng số rất nhỏ, và đôi khi chúng ta có thể tìm được bước nhảy khiến cho đạo hàm theo hướng bị triệt tiêu. Một cách tiếp cận khác là tìm giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">f</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-684">x</span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-687"><span class="MJXp-mi" id="MJXp-Span-688" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-689" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-690">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">f</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-693">x</span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">f(\boldsymbol x - \epsilon \nabla_{\boldsymbol x} f(\boldsymbol x))</script></span> với một số giá trị khác nhau của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-107">\epsilon</script></span> và lựa chọn giá trị dẫn đến giá trị nhỏ nhất của hàm mục tiêu. Chiến lược này còn được gọi là <em>dò đường</em> (line search).</p><p>Trượt gradient hội tụ khi mọi phần tử của gradient bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-mn" id="MJXp-Span-699">0</span></span></span><script type="math/tex" id="MathJax-Element-108">0</script></span> (hoặc, trong thực tế, rất gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mn" id="MJXp-Span-701">0</span></span></span><script type="math/tex" id="MathJax-Element-109">0</script></span>). Trong một vài trường hợp, ta có thể tránh việc chạy thuật toán theo vòng lặp mà nhảy trực tiếp đến điểm tới hạn bằng cách giải phương trình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mi" id="MJXp-Span-704" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-705" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-706">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">f</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-709">x</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-712">0</span></span></span><script type="math/tex" id="MathJax-Element-110">\nabla_{\boldsymbol x} f(\boldsymbol x) = 0</script></span> để tìm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-713"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-714">x</span></span></span><script type="math/tex" id="MathJax-Element-111">\boldsymbol x</script></span>.</p><p>Mặc dù trượt gradient bị giới hạn để tối ưu hóa trong các không gian liên tục, ý tưởng chung của việc lặp lại các bước di chuyển nhỏ (mà có thể coi là bước di chuyển nhỏ tốt nhất) để hướng tới một kết quả tốt hơn có thể được khái quát hóa cho các không gian rời rạc. Quá trình tăng một hàm mục tiêu của các tham số rời rạc được gọi là quá trình <em>leo đồi</em> (hill climbing) [Russel and Norvig, 2003].</p><h2 id="431-Ma-trận-Jacobi-và-ma-trận-Hesse"><a class="anchor hidden-xs" href="#431-Ma-trận-Jacobi-và-ma-trận-Hesse" title="431-Ma-trận-Jacobi-và-ma-trận-Hesse"><span class="octicon octicon-link"></span></a>4.3.1 Ma trận Jacobi và ma trận Hesse</h2><p>Đôi khi chúng ta cần tìm tất cả các đạo hàm riêng của một hàm có đầu vào và đầu ra đều là các vector. Ma trận chứa tất cả các đạo hàm riêng như vậy được gọi là <em>ma trận Jacobi</em> (Jacobian matrix). Cụ thể, nếu chúng ta có một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">f</span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-718"><span class="MJXp-mrow" id="MJXp-Span-719" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-720">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-721" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mrow" id="MJXp-Span-724" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-725">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-726" style="vertical-align: 0.5em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-112">f:\mathbb{R}^m\rightarrow \mathbb{R}^n</script></span>, thì ma trận Jacobi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-728">J</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-732" style="vertical-align: 0.5em;"><span class="MJXp-mspace" id="MJXp-Span-733" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">n</span><span class="MJXp-mspace" id="MJXp-Span-735" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-736">×</span><span class="MJXp-mspace" id="MJXp-Span-737" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">m</span></span></span></span></span><script type="math/tex" id="MathJax-Element-113">\boldsymbol J \in R^{\, n \,\times\, m}</script></span> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">f</span></span></span><script type="math/tex" id="MathJax-Element-114">f</script></span> được xác định như sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-741"><span class="MJXp-msubsup" id="MJXp-Span-742"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-743" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-744" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">i</span><span class="MJXp-mo" id="MJXp-Span-746">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-749" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-750">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-751">∂</span><span class="MJXp-msubsup" id="MJXp-Span-752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-754" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">f</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-757">x</span><span class="MJXp-msubsup" id="MJXp-Span-758"><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-760" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-115">\boldsymbol J_{i,j}=\frac{\partial}{\partial x_j} f(\boldsymbol x)_i.</script></span></p><p>Đôi khi chúng ta cũng quan tâm đến một đạo hàm của một đạo hàm. Ta gọi nó là đạo hàm bậc hai. Ví dụ, đối với một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">f</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mrow" id="MJXp-Span-766" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-767">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-768" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mrow" id="MJXp-Span-770"><span class="MJXp-mi undefined" id="MJXp-Span-771">R</span></span></span></span><script type="math/tex" id="MathJax-Element-116">f:\mathbb{R}^n\rightarrow \mathbb{R}</script></span>, đạo hàm đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-772"><span class="MJXp-msubsup" id="MJXp-Span-773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-775" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-117">x_i</script></span> của đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">f</span></span></span><script type="math/tex" id="MathJax-Element-118">f</script></span> đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-msubsup" id="MJXp-Span-779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-781" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-119">x_j</script></span> được ký hiệu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-782"><span class="MJXp-mfrac" id="MJXp-Span-783" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-784"><span class="MJXp-mi" id="MJXp-Span-785" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-786" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-787">∂</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-791">∂</span><span class="MJXp-msubsup" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-794" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">f</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">x</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-120">\frac{\partial^2}{\partial x_i \partial x_j}f(x)</script></span>. Trong trường hợp một chiều, ta có thể kí hiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mfrac" id="MJXp-Span-800" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-803" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">d</span><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-807" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">f</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">x</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-121">\frac{d^2}{dx^2}f(x)</script></span> bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-815" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-816">′</span><span class="MJXp-mi" id="MJXp-Span-817">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">x</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-122">f^{\prime\prime}(x)</script></span>. Đạo hàm bậc hai cho chúng ta biết đạo hàm bậc một sẽ biến thiên như thế nào khi chúng ta thay đổi đầu vào. Đây là một tính chất quan trọng bởi nó cho ta biết liệu một bước cập nhật gradient có cải thiện hàm số như chúng ta mong đợi khi chỉ dựa trên gradient hay không. Chúng ta có thể coi đạo hàm bậc hai như là phép đo <em>độ cong</em> (curvature). Giả sử chúng ta có hàm bậc hai (nhiều hàm phát sinh trong thực nghiệm không phải là bậc hai nhưng có thể xấp xỉ tốt bởi dạng bậc hai, ít nhất là một cách cục bộ). Nếu một hàm như vậy có đạo hàm bậc hai bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-821"><span class="MJXp-mn" id="MJXp-Span-822">0</span></span></span><script type="math/tex" id="MathJax-Element-123">0</script></span> thì nó không có độ cong. Nó hoàn toàn là một đường thẳng và chỉ cần sử dụng gradient là ta có thể dự đoán được giá trị nó. Nếu gradient là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-mn" id="MJXp-Span-824">1</span></span></span><script type="math/tex" id="MathJax-Element-124">1</script></span>, thì chúng ta có thể thực hiện một bước cập nhật có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-125">\epsilon</script></span> dọc theo vector đối của gradient, và hàm chi phí sẽ giảm cùng lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-126">\epsilon</script></span>. Nếu đạo hàm bậc hai là số âm, hàm sẽ cong xuống dưới, do đó hàm chi phí thực tế sẽ giảm nhiều hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-127">\epsilon</script></span>. Cuối cùng, nếu đạo hàm bậc hai là dương, thì đường cong của hàm hướng lên trên, do đó, hàm chi phí có thể giảm ít hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-128">\epsilon</script></span>. Xem hình 4.4 để thấy các dạng cong khác nhau ảnh hưởng đến mối quan hệ giữa giá trị dự đoán của hàm chi phí sử dụng gradient với giá trị thực của hàm như thế nào.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-833"><span class="MJXp-mspace" id="MJXp-Span-834" style="width: 9.449em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-129">\hspace{4cm}</script></span><img src="https://i.imgur.com/3iQdPB9.png" alt=""></p><blockquote>
<p>Hình 4.4: Đạo hàm bậc hai mô tả độ cong của hàm. Ở đây chúng tôi biểu diễn các hàm bậc hai với các độ cong khác nhau. Đường nét đứt biểu thị giá trị của hàm chi phí mà chúng ta kỳ vọng khi thực hiện một bước giảm gradient, trong trường hợp ta chỉ biết thông tin về gradient. Với độ cong có giá trị âm, hàm chi phí thực sự giảm nhanh hơn lượng giảm gradient dự đoán. Với độ cong bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-835"><span class="MJXp-mn" id="MJXp-Span-836">0</span></span></span><script type="math/tex" id="MathJax-Element-130">0</script></span>, gradient dự đoán mức giảm chính xác. Với độ cong dương, hàm giảm chậm hơn dự kiến và cuối cùng bắt đầu tăng, vì vậy các bước nhảy quá lớn có thể vô tình làm tăng hàm số.</p>
</blockquote><p>Khi hàm có biến số nhiều chiều, sẽ có nhiều đạo hàm bậc hai. Ta có thể thu thập các đạo hàm này lại với nhau thành một ma trận gọi là <em>ma trận Hesse</em> (Hessian matrix). Ma trận Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-838">H</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">f</span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-843">x</span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-131">\boldsymbol H(f)(\boldsymbol x)</script></span> được xác định như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-845"><span class="MJXp-mtable" id="MJXp-Span-846"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-847" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-848" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-849">H</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">f</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-854">x</span><span class="MJXp-msubsup" id="MJXp-Span-855"><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-857" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">i</span><span class="MJXp-mo" id="MJXp-Span-859">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-862" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-863"><span class="MJXp-mi" id="MJXp-Span-864" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-865" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-866">∂</span><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-870">∂</span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-873" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">f</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">x</span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-132">\boldsymbol H(f)(\boldsymbol x)_{i,j} = \frac{\partial^2}{\partial x_i \partial x_j}f(x) \tag{4.6}</script></span></p><p>Nói cách khác, ma trận Hesse chính là ma trận Jacobi của gradient.</p><p>Tại bất kỳ điểm nào mà các đạo hàm riêng bậc hai là liên tục, thì các toán tử vi phân có tính chất giao hoán; có nghĩa là, thứ tự của chúng có thể được hoán đổi:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-878"><span class="MJXp-mtable" id="MJXp-Span-879"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-880" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-881" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-882" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi" id="MJXp-Span-884" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-885" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-886">∂</span><span class="MJXp-msubsup" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-889" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-890">∂</span><span class="MJXp-msubsup" id="MJXp-Span-891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-893" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">f</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-896">x</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-899" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi" id="MJXp-Span-901" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-902" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-903">∂</span><span class="MJXp-msubsup" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-906" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mi" id="MJXp-Span-907">∂</span><span class="MJXp-msubsup" id="MJXp-Span-908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-910" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">f</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-913">x</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-133">\frac{\partial^2}{\partial x_i \partial x_j}f(\boldsymbol x)=\frac{\partial^2}{\partial x_j \partial x_i}f(\boldsymbol x) \tag{4.7}</script></span></p><p>Điều này dẫn tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-msubsup" id="MJXp-Span-916"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-917" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">i</span><span class="MJXp-mo" id="MJXp-Span-920">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-923"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-924" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-925" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">j</span><span class="MJXp-mo" id="MJXp-Span-927">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-134">\boldsymbol H_{i, j} = \boldsymbol H_{j,i}</script></span>, do đó ma trận Hesse là đối xứng tại những điểm như vậy.</p><p>Hầu hết các hàm số chúng ta gặp phải trong học sâu đều có Hesse đối xứng tại hầu hết mọi nơi. Bởi ma trận Hesse là thực và đối xứng, nên ta có thể phân tích nó thành một tập các giá trị riêng thực và một cơ sở trực giao của các vector riêng. Đạo hàm bậc hai theo một hướng cụ thể biểu diễn bởi một vector đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-930">d</span></span></span><script type="math/tex" id="MathJax-Element-135">\boldsymbol d</script></span> được cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-935">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-936">d</span></span></span><script type="math/tex" id="MathJax-Element-136">\boldsymbol d^\top \boldsymbol H\boldsymbol d</script></span>. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-938">d</span></span></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol d</script></span> là một vector riêng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-940">H</span></span></span><script type="math/tex" id="MathJax-Element-138">\boldsymbol H</script></span>, đạo hàm bậc hai theo hướng đó chính là giá trị riêng tương ứng. Đối với các hướng khác của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-942">d</span></span></span><script type="math/tex" id="MathJax-Element-139">\boldsymbol d</script></span>, đạo hàm bậc hai theo hướng là một trung bình có trọng số của tất cả các trị riêng, với các trọng số nằm giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mn" id="MJXp-Span-944">0</span></span></span><script type="math/tex" id="MathJax-Element-140">0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mn" id="MJXp-Span-946">1</span></span></span><script type="math/tex" id="MathJax-Element-141">1</script></span>, và các vector riêng có góc nhỏ hơn với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-947"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-948">d</span></span></span><script type="math/tex" id="MathJax-Element-142">\boldsymbol d</script></span> nhận trọng số lớn hơn. Trị riêng lớn nhất chính là giá trị lớn nhất của đạo hàm bậc hai (theo hướng) và trị riêng nhỏ nhất chính là giá trị nhỏ nhất của đạo hàm bậc hai.</p><p>Đạo hàm bậc hai (theo hướng) cho ta biết ta có thể kỳ vọng một bước trượt gradient thực hiện tốt như thế nào. Chúng ta có thể tạo một xấp xỉ bởi chuỗi Taylor bậc hai của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">f</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-952">x</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-143">f(\boldsymbol x)</script></span> xung quanh điểm hiện tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-954"><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-956" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-957" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-958">(</span><span class="MJXp-mn" id="MJXp-Span-959">0</span><span class="MJXp-mo" id="MJXp-Span-960">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-144">\boldsymbol x^{(0)}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-961"><span class="MJXp-mtable" id="MJXp-Span-962"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-963" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-964" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">f</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-967">x</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">f</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-972"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-973" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-974" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-975">(</span><span class="MJXp-mn" id="MJXp-Span-976">0</span><span class="MJXp-mo" id="MJXp-Span-977">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-981">x</span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-983"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-984" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-985" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-986">(</span><span class="MJXp-mn" id="MJXp-Span-987">0</span><span class="MJXp-mo" id="MJXp-Span-988">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-991" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-992">g</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-994" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-995">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-996">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-998">x</span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1001" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1002" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1003">(</span><span class="MJXp-mn" id="MJXp-Span-1004">0</span><span class="MJXp-mo" id="MJXp-Span-1005">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1006"><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1008" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1009">H</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1011">x</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1016">(</span><span class="MJXp-mn" id="MJXp-Span-1017">0</span><span class="MJXp-mo" id="MJXp-Span-1018">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-145">f(\boldsymbol x)\approx f(\boldsymbol x^{(0)}) + (\boldsymbol x-\boldsymbol x^{(0)})^\intercal \boldsymbol g +\frac{1}{2}(\boldsymbol x-\boldsymbol x^{(0)})^\intercal \boldsymbol H(\boldsymbol x-\boldsymbol x^{(0)}) \tag{4.8}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1021">g</span></span></span><script type="math/tex" id="MathJax-Element-146">\boldsymbol g</script></span> là gradient và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1023">H</span></span></span><script type="math/tex" id="MathJax-Element-147">\boldsymbol H</script></span> là ma trận Hesse tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1027" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1028">(</span><span class="MJXp-mn" id="MJXp-Span-1029">0</span><span class="MJXp-mo" id="MJXp-Span-1030">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-148">\boldsymbol x^{(0)}</script></span>. Nếu ta sử dụng tốc độ học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-149">\epsilon</script></span>, thì điểm mới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1034">x</span></span></span><script type="math/tex" id="MathJax-Element-150">\boldsymbol x</script></span> sẽ là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1038" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1039">(</span><span class="MJXp-mn" id="MJXp-Span-1040">0</span><span class="MJXp-mo" id="MJXp-Span-1041">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">ϵ</span><span class="MJXp-mspace" id="MJXp-Span-1044" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1045">g</span></span></span><script type="math/tex" id="MathJax-Element-151">\boldsymbol x^{(0)} - \epsilon \,\boldsymbol g</script></span>. Thay vào công thức xấp xỉ trên, ta thu được</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1046"><span class="MJXp-mtable" id="MJXp-Span-1047"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1048" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1049" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">f</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1054" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1055">(</span><span class="MJXp-mn" id="MJXp-Span-1056">0</span><span class="MJXp-mo" id="MJXp-Span-1057">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">ϵ</span><span class="MJXp-mspace" id="MJXp-Span-1060" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1061">g</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">f</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1068" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1069">(</span><span class="MJXp-mn" id="MJXp-Span-1070">0</span><span class="MJXp-mo" id="MJXp-Span-1071">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">ϵ</span><span class="MJXp-mspace" id="MJXp-Span-1075" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1077" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1078" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1079">g</span><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1081" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1082">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1083">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1086" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1088" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1089" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1090">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1091">g</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-152">f(\boldsymbol x^{(0)}-\epsilon \, \boldsymbol g)\approx f(\boldsymbol x^{(0)}) - \epsilon \, \boldsymbol g^\intercal \boldsymbol g +\frac{1}{2}\epsilon^2\boldsymbol g^\intercal \boldsymbol H\boldsymbol g. \tag{4.9}</script></span></p><p>Ba số hạng trong công thức trên theo thứ tự là: giá trị ban đầu của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">f</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1097" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1098" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1099">(</span><span class="MJXp-mn" id="MJXp-Span-1100">0</span><span class="MJXp-mo" id="MJXp-Span-1101">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-153">f(\boldsymbol x^{(0)})</script></span>, mức giảm kỳ vọng do độ dốc của hàm và hiệu chỉnh ta đưa vào để tính đến độ cong của hàm. Khi đại lượng cuối cùng quá lớn, bước trượt gradient thực tế có thể di chuyển lên trên. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1103"><span class="MJXp-msubsup" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1105" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1106" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1107">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1108">g</span></span></span><script type="math/tex" id="MathJax-Element-154">\boldsymbol g^\intercal \boldsymbol H\boldsymbol g</script></span> là số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mn" id="MJXp-Span-1110">0</span></span></span><script type="math/tex" id="MathJax-Element-155">0</script></span> hoặc số âm, xấp xỉ chuỗi Taylor dự đoán rằng tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-156">\epsilon</script></span> mãi mãi sẽ giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">f</span></span></span><script type="math/tex" id="MathJax-Element-157">f</script></span> mãi mãi. Trong thực tế, chuỗi Taylor không còn là một xấp xỉ tốt khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-158">\epsilon</script></span> lớn, vì vậy người ta phải sử dụng một vài kĩ thuật dựa trên kinh nghiệm để chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-159">\epsilon</script></span> trong trường hợp này. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1122" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1123">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1124">g</span></span></span><script type="math/tex" id="MathJax-Element-160">\boldsymbol g^\intercal \boldsymbol H\boldsymbol g</script></span> là một số dương, giải phương trình tìm giá trị bước nhảy tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-161">\epsilon</script></span> để giảm chuỗi xấp xỉ Taylor của hàm chi phí một lượng lớn nhất, ta có</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1127"><span class="MJXp-mtable" id="MJXp-Span-1128"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1129" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1130" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1133" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1135" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1136"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1137" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1138" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1139">g</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1141" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1142" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1143">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1144">g</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-162">\epsilon^*=\frac{\boldsymbol g^\intercal \boldsymbol g}{\boldsymbol g^\intercal \boldsymbol H\boldsymbol g}. \tag{4.10}</script></span></p><p>Trong trường hợp xấu nhất, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1147">g</span></span></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol g</script></span> có cùng hướng với vector riêng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1149">H</span></span></span><script type="math/tex" id="MathJax-Element-164">\boldsymbol H</script></span> tương ứng với giá trị riêng tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-msubsup" id="MJXp-Span-1151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152" style="margin-right: 0.05em;">λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1153" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">x</span></span></span></span></span><script type="math/tex" id="MathJax-Element-165">\lambda_{max}</script></span>, thì độ lớn của bước nhảy tối ưu này chính là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mfrac" id="MJXp-Span-1158" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1159">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161" style="margin-right: 0.05em;">λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1162" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">x</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-166">\frac{1}{\lambda_{max}}</script></span>. Trong phạm vi mà hàm số chúng ta đang cực tiểu hoá có thể được xấp xỉ tốt bởi hàm bậc hai, do đó, các giá trị riêng của ma trận Hesse sẽ xác định độ lớn của tốc độ học.</p><p>Đạo hàm bậc hai có thể được sử dụng để xác định một điểm tới hạn là cực đại cục bộ, cực tiểu cục bộ hay điểm yên ngựa. Nhớ lại rằng tại một điểm tới hạn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-msubsup" id="MJXp-Span-1167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1169" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1170">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">x</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1175">0</span></span></span><script type="math/tex" id="MathJax-Element-167">f^{\prime}(x) = 0</script></span>. Khi đạo hàm bậc hai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1176"><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1179" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1180">′</span><span class="MJXp-mi" id="MJXp-Span-1181">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">x</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1186">0</span></span></span><script type="math/tex" id="MathJax-Element-168">f^{\prime\prime}(x) > 0</script></span>, đạo hàm bậc một <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1187"><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1190" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1191">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">x</span><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-169">f^{\prime}(x)</script></span> tăng khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">x</span></span></span><script type="math/tex" id="MathJax-Element-170">x</script></span> di chuyển về bên phải và giảm khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">x</span></span></span><script type="math/tex" id="MathJax-Element-171">x</script></span> di chuyển về bên trái. Điều này có nghĩa là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-msubsup" id="MJXp-Span-1200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1202" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1203">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">x</span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">ϵ</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1210">0</span></span></span><script type="math/tex" id="MathJax-Element-172">f^{\prime}(x - \epsilon) < 0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1214" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1215">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">x</span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">ϵ</span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1222">0</span></span></span><script type="math/tex" id="MathJax-Element-173">f^{\prime}(x+\epsilon) > 0</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-174">\epsilon</script></span> đủ nhỏ. Nói cách khác, khi ta di chuyển sang phải thì độ dốc hướng lên về bên phải, và khi ta di chuyển sang trái thì độ dốc hướng lên về bên trái. Do đó, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1225"><span class="MJXp-msubsup" id="MJXp-Span-1226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1228" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1229">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">x</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1234">0</span></span></span><script type="math/tex" id="MathJax-Element-175">f^{\prime}(x) = 0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1238" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1239">′</span><span class="MJXp-mi" id="MJXp-Span-1240">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">x</span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1245">0</span></span></span><script type="math/tex" id="MathJax-Element-176">f^{\prime\prime}(x) > 0</script></span>, ta có thể kết luận rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">x</span></span></span><script type="math/tex" id="MathJax-Element-177">x</script></span> là một cực tiểu cục bộ. Tương tự, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1248"><span class="MJXp-msubsup" id="MJXp-Span-1249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1251" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1252">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">x</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1257">0</span></span></span><script type="math/tex" id="MathJax-Element-178">f^{\prime}(x) = 0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1261" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1262">′</span><span class="MJXp-mi" id="MJXp-Span-1263">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">x</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1268">0</span></span></span><script type="math/tex" id="MathJax-Element-179">f^{\prime\prime}(x) < 0</script></span>, ta có thể kết luận rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">x</span></span></span><script type="math/tex" id="MathJax-Element-180">x</script></span> là một cực đại cục bộ. Suy luận này được gọi là <em>phép thử đạo hàm bậc hai</em> (second derivative test). Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-msubsup" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1274" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1275">′</span><span class="MJXp-mi" id="MJXp-Span-1276">′</span></span></span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">x</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1281">0</span></span></span><script type="math/tex" id="MathJax-Element-181">f^{\prime\prime}(x) = 0</script></span>, ta sẽ không thể kết luận gì về đặc điểm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">x</span></span></span><script type="math/tex" id="MathJax-Element-182">x</script></span>. Trong trường hợp này, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">x</span></span></span><script type="math/tex" id="MathJax-Element-183">x</script></span> có thể là một điểm yên ngựa hay là một phần của một vùng phẳng.</p><p>Trong không gian nhiều chiều, ta cần khảo sát toàn bộ các đạo hàm bậc hai của hàm. Sử dụng phép phân tích riêng của ma trận Hesse, ta có thể tổng quát hóa phép thử đạo hàm bậc hai cho trường hợp nhiều chiều. Tại một điểm tới hạn, tức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mi" id="MJXp-Span-1288" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1289" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1290">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">f</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1293">x</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1296">0</span></span></span><script type="math/tex" id="MathJax-Element-184">\nabla_{\boldsymbol x}f(\boldsymbol x) = 0</script></span>, ta có thể khảo sát các trị riêng của ma trận Hesse để xác định điểm tới hạn là cực đại cục bộ, cực tiểu cục bộ hay điểm yên ngựa. Nếu ma trận Hesse là ma trận xác định dương (tất cả các trị riêng đều dương), điểm tới hạn đang xét là một cực tiểu cục bộ. Phát biểu này đúng nhờ vào quan sát sau: tất cả các đạo hàm bậc hai theo bất kì hướng nào đều phải dương, và từ đây tham chiếu đến trường hợp đạo hàm bậc hai đơn biến. Tương tự, nếu ma trận Hesse là ma trận xác định âm (tất cả các trị riêng đều âm) thì điểm tới hạn đang xét là một cực đại cục bộ. Trong không gian nhiều chiều, ta có thể tìm thấy những bằng chứng tích cực về điểm yên ngựa trong một số trường hợp. Nếu có ít nhất một trị riêng là âm và có ít nhất một trị riêng là dương, ta biết được rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1298">x</span></span></span><script type="math/tex" id="MathJax-Element-185">\boldsymbol x</script></span> là một cực đại cục bộ trên một <em>mặt cắt</em> (cross section) của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">f</span></span></span><script type="math/tex" id="MathJax-Element-186">f</script></span> nhưng lại là một cực tiểu cục bộ trên một mặt cắt khác.  Xem một ví dụ minh họa cho trường hợp này trong hình 4.5. Cuối cùng, phép thử đạo hàm bậc hai của hàm nhiều biến cũng có thể không cho ta một nhận định chắc chắn về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1302">x</span></span></span><script type="math/tex" id="MathJax-Element-187">\boldsymbol x</script></span>, cũng giống như trong trường hợp đơn biến. Phép thử sẽ không cho ta kết luận gì nếu tất cả các trị riêng khác không cùng dấu (âm hoặc dương) nhưng có ít nhất một trị riêng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1303"><span class="MJXp-mn" id="MJXp-Span-1304">0</span></span></span><script type="math/tex" id="MathJax-Element-188">0</script></span>. Nguyên nhân là bởi ta không thể kết luận được gì từ phép thử đạo hàm bậc hai đơn biến trong mặt cắt tương ứng với trị riêng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1305"><span class="MJXp-mn" id="MJXp-Span-1306">0</span></span></span><script type="math/tex" id="MathJax-Element-189">0</script></span>.<br>
<img src="https://i.imgur.com/uW7mg1Q.png" alt=""></p><blockquote>
<p>Hình 4.5: Một điểm yên ngựa gồm cả độ cong âm và dương. Phương trình trong ví dụ này là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">f</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1310">x</span><span class="MJXp-mo" id="MJXp-Span-1311" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1316">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1315">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1321">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1320">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-190">f(\boldsymbol x)=x_1^2 - x_2^2</script></span>. Theo trục tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1322"><span class="MJXp-msubsup" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1325" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-191">x_1</script></span>, đồ thị hàm số cong lên. Trục này là một vector riêng của ma trận Hesse có trị riêng dương. Theo trục tương ứng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1329" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-192">x_2</script></span>, đồ thị hàm số cong xuống. Trục theo hướng này là một vector riêng của ma trận Hesse với trị riêng âm. Cái tên “điểm yên ngựa” bắt nguồn từ hình dáng giống như yên ngựa của hàm này. Đây là một ví dụ hết sức tinh tế về một phương trình với một điểm yên ngựa. Trong không gian nhiều chiều, một điểm không nhất thiết phải có trị riêng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1330"><span class="MJXp-mn" id="MJXp-Span-1331">0</span></span></span><script type="math/tex" id="MathJax-Element-193">0</script></span> mới là điểm yên ngựa: Một điểm yên ngựa chỉ cần có cả trị riêng âm và trị riêng dương. Ta có thể coi một điểm yên ngựa có các trị riêng âm và dương là một cực đại cục bộ trong một mặt cắt nhưng nó lại là một cực tiểu cục bộ trong một mặt cắt khác.</p>
</blockquote><p>Trong không gian nhiều chiều, tại một điểm sẽ có một đạo hàm bậc hai khác nhau cho mỗi chiều. Hệ số điều hòa của ma trận Hesse tại điểm này thể hiện mức độ khác nhau giữa các đạo hàm bậc hai. Nếu ma trận Hesse có hệ số điều hòa cao, thuật toán trượt gradient sẽ kém hiệu quả. Bởi theo một hướng nào đó, đạo hàm tăng nhanh chóng, nhưng theo một hướng khác, nó tăng rất chậm. Thuật toán trượt gradient không nhận thức được sự thay đổi này của đạo hàm, nên nó sẽ không biết rằng nên ưu tiên đi theo hướng mà đạo hàm âm nhiều hơn. Hệ số điều hòa cao còn làm cho việc chọn bước nhảy trở nên khó khăn. Bước nhảy phải đủ nhỏ để tránh đi qua giá trị cực tiểu và đi ngược lên hướng có độ cong dương. Điều này thường có nghĩa là, theo những hướng khác ít cong hơn, thì bước nhảy này lại là quá nhỏ để tạo ra những bước tiến đáng kể đến điểm tới hạn. Xem một ví dụ minh họa trong hình 4.6.</p><p><img src="https://i.imgur.com/EcF8YCh.png" alt=""></p><blockquote>
<p>Hình 4.6: Thuật toán trượt gradident không thể khai thác được thông tin về độ cong từ ma trận Hesse. Ở đây ta sử dụng thuật toán trượt gradient để tìm giá trị nhỏ nhất của hàm bậc hai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">f</span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1335">x</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">f(\boldsymbol x)</script></span>, hàm này có hệ số điều hòa là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1337"><span class="MJXp-mn" id="MJXp-Span-1338">5</span></span></span><script type="math/tex" id="MathJax-Element-195">5</script></span>. Điều này có nghĩa là hướng có độ cong lớn nhất sẽ cong gấp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mn" id="MJXp-Span-1340">5</span></span></span><script type="math/tex" id="MathJax-Element-196">5</script></span> lần hướng có độ cong nhỏ nhất. Trong trường hợp này, độ cong lớn nhất nằm ở hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1341"><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1343">1</span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1345">1</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1348" style="vertical-align: 0.5em;">⊺</span></span></span></span><script type="math/tex" id="MathJax-Element-197">[1, 1]^\intercal</script></span> và độ cong nhỏ nhất nằm ở hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1351">1</span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1354">1</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1357" style="vertical-align: 0.5em;">⊺</span></span></span></span><script type="math/tex" id="MathJax-Element-198">[1, -1]^\intercal</script></span>. Những đoạn màu đỏ thể hiện đường đi của thuật toán trượt gradient. Đồ thị này kéo dài và có những đỉnh nhọn trông giống như một hẻm núi dài vậy. Thuật toán trượt gradient đã lãng phí thời gian để liên tiếp đi xuống những sườn núi bởi chúng có độ dốc lớn nhất. Nguyên nhân gây ra hiện tượng trên là bởi bước nhảy quá lớn và có khả năng sẽ vượt quá điểm thấp nhất cần tìm nên thuật toán trượt gradient đã phải điều chỉnh đường đi bằng cách đi theo sườn của đỉnh đối diện trong lần lặp tiếp theo. Trị riêng có giá trị lớn của ma trận Hesse tương ứng với vector riêng của hướng này có đạo hàm theo hướng tăng rất nhanh, vì thế một thuật toán tối ưu dựa trên ma trận Hesse có thể dự đoán rằng đi theo sườn dốc nhất chưa chắc đã là một hướng tìm kiếm tốt trong trường hợp này.</p>
</blockquote><p>Vấn đề này có thể được giải quyết bằng cách sử dụng thông tin từ ma trận Hesse để dẫn dắt quá trình tìm kiếm. Phương pháp đơn giản nhất được biết đến để thực hiện điều này là <em>phương pháp Newton</em> (Newton’s method). Phương pháp Newton dựa trên khai triển chuỗi Taylor bậc hai để xấp xỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">f</span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1361">x</span><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-199">f(\boldsymbol x)</script></span> tại điểm gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-msubsup" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1365" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1366" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1367">(</span><span class="MJXp-mn" id="MJXp-Span-1368">0</span><span class="MJXp-mo" id="MJXp-Span-1369">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">\boldsymbol x^{(0)}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1370"><span class="MJXp-mtable" id="MJXp-Span-1371"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1372" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1373" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">f</span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1376">x</span><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">f</span><span class="MJXp-mo" id="MJXp-Span-1380" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1382" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1383" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1384">(</span><span class="MJXp-mn" id="MJXp-Span-1385">0</span><span class="MJXp-mo" id="MJXp-Span-1386">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1389" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1390">x</span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1394" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1395">(</span><span class="MJXp-mn" id="MJXp-Span-1396">0</span><span class="MJXp-mo" id="MJXp-Span-1397">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1398"><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1400" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-1401"><span class="MJXp-mi" id="MJXp-Span-1402" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1404">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">f</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1407"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1408" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1409" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1410">(</span><span class="MJXp-mn" id="MJXp-Span-1411">0</span><span class="MJXp-mo" id="MJXp-Span-1412">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1415" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1416">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1417">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1419">x</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1423" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1424">(</span><span class="MJXp-mn" id="MJXp-Span-1425">0</span><span class="MJXp-mo" id="MJXp-Span-1426">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1429" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1430">H</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">f</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1435"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1436" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1437" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1438">(</span><span class="MJXp-mn" id="MJXp-Span-1439">0</span><span class="MJXp-mo" id="MJXp-Span-1440">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1443">x</span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1446" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1447" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1448">(</span><span class="MJXp-mn" id="MJXp-Span-1449">0</span><span class="MJXp-mo" id="MJXp-Span-1450">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-201">f(\boldsymbol x) \approx f(\boldsymbol x^{(0)}) + (\boldsymbol x - \boldsymbol x^{(0)})^\intercal\nabla_{\boldsymbol x}f(\boldsymbol x^{(0)}) + \frac{1}{2}(\boldsymbol x-\boldsymbol x^{(0)})^\intercal\boldsymbol{H}(f)(\boldsymbol x^{(0)})(\boldsymbol x-\boldsymbol x^{(0)}). \tag{4.11}</script></span></p><p>Nếu giải phương trình này, ta sẽ thu được điểm tới hạn sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1453"><span class="MJXp-mtable" id="MJXp-Span-1454"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1455" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1456" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1457"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1458" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1459" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1464">(</span><span class="MJXp-mn" id="MJXp-Span-1465">0</span><span class="MJXp-mo" id="MJXp-Span-1466">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1468">H</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">f</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1475" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1476">(</span><span class="MJXp-mn" id="MJXp-Span-1477">0</span><span class="MJXp-mo" id="MJXp-Span-1478">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1481" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1482">−</span><span class="MJXp-mn" id="MJXp-Span-1483">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1484"><span class="MJXp-mi" id="MJXp-Span-1485" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1486" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1487">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">f</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1490"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1491" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1492" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1493">(</span><span class="MJXp-mn" id="MJXp-Span-1494">0</span><span class="MJXp-mo" id="MJXp-Span-1495">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-202">\boldsymbol x^* = \boldsymbol x^{(0)} - \boldsymbol{H}(f)(\boldsymbol x^{(0)})^{-1}\nabla_{\boldsymbol x}f(\boldsymbol x^{(0)}).\tag{4.12}</script></span></p><p>Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">f</span></span></span><script type="math/tex" id="MathJax-Element-203">f</script></span> là một hàm bậc hai xác định dương, ta sử dụng phương pháp Newton bằng cách áp dụng phương trình (4.12) một lần và có thể nhảy đến ngay điểm cực tiểu của hàm số. Nếu hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">f</span></span></span><script type="math/tex" id="MathJax-Element-204">f</script></span> không phải là bậc hai nhưng trên cục bộ có thể xấp xỉ tốt bởi một hàm bậc hai xác định dương, thì phương pháp Newton được thực hiện bằng cách áp dụng phương trình (4.12) nhiều lần. Lặp lại việc cập nhật hàm xấp xỉ và nhảy đến cực tiểu của hàm xấp xỉ có thể dẫn đến điểm tới hạn nhanh hơn khá nhiều so với thuật toán trượt gradient. Đây là một tính chất hữu ích khi ta đã ở gần một cực tiểu cục bộ, nhưng cũng có thể là một tính chất có hại nếu ta ở gần điểm yên ngựa. Trong mục 8.2.3, ta sẽ chỉ ra phương pháp Newton chỉ phù hợp khi điểm tới hạn cận kề là một cực tiểu (tất cả các trị riêng của ma trận Hesse là dương), khi mà trượt gradient không bị hút về phía các điểm yên ngựa nếu gradient không chỉ về phía chúng.</p><p>Các thuật toán tối ưu chỉ sử dụng gradient, ví dụ như trượt gradient, được gọi là các <em>thuật toán tối ưu bậc nhất</em> (first-order optimization algorithm). Các thuật toán tối ưu sử dụng cả ma trận Hesse, ví dụ như phương pháp Newton, được gọi là các <em>thuật toán tối ưu bậc hai</em> (second-order optimization algorithm) [Nocedal and Wright, 2006].</p><p>Những thuật toán tối ưu được sử dụng trong hầu hết ngữ cảnh của cuốn sách này có thể áp dụng cho một phạm vi rộng các hàm số nhưng hầu như không có đảm bảo rằng chúng luôn hoạt động tốt. Những thuật toán học sâu thường có xu hướng thiếu sự đảm bảo bởi chúng sử dụng những họ hàm số hết sức phức tạp. Trong những lĩnh vực khác, hướng tiếp cập chủ yếu với bài toán tối ưu hóa là thiết kế những thuật toán tối ưu cho hữu hạn họ các phương trình.</p><p>Trong phạm vi của học sâu, đôi khi ta cũng đạt được một số tính đảm bảo bằng cách giới hạn phạm vi các hàm số phải là <em>liên tục Lipschitz</em> (Lipschitz continuos) hoặc có đạo hàm Lipschitz liên tục. Một hàm số Lipschitz liên tục là một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">f</span></span></span><script type="math/tex" id="MathJax-Element-205">f</script></span> có tốc độ thay đổi bị giới hạn bởi một <em>hằng số Lipschitz</em> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mrow" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1506">L</span></span></span></span><script type="math/tex" id="MathJax-Element-206">\mathcal{L}</script></span>*:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1507"><span class="MJXp-mtable" id="MJXp-Span-1508"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1509" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1510" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1511">∀</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1512">x</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1514">∀</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1515">y</span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1517"><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">f</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1521">x</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">f</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1526">y</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1528"><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1532">L</span></span><span class="MJXp-mrow" id="MJXp-Span-1533"><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1535"><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1537">x</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1539">y</span><span class="MJXp-mrow" id="MJXp-Span-1540"><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1542"><span class="MJXp-mrow" id="MJXp-Span-1543" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1545" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-207">\forall \boldsymbol x, \forall \boldsymbol y,|f(\boldsymbol x) -f(\boldsymbol y)| \leq \mathcal{L}||\boldsymbol x - \boldsymbol y||_2 \tag{4.13}</script></span></p><p>Tính chất này khá hữu dụng bởi nó cho phép ta định lượng được giả thiết một sự thay đổi nhỏ ở đầu vào do một thuật toán, như trượt gradient chẳng hạn, gây ra sẽ dẫn đến một thay đổi nhỏ ở đầu ra. Tính liên tục Lipschitz cũng là một ràng buộc khá yếu, ta có thể làm cho nhiều bài toán tối ưu trong học sâu có tính chất liên tục Lipschitz với một vài kĩ thuật thay đối nhỏ.</p><p>Có lẽ lĩnh vực thành công nhất của bài toán tối ưu hoá chuyên dụng là <em>tối ưu lồi</em> (convex optimization). Các thuật toán tối ưu lồi có nhiều tính chất chứng minh được một cách chặt chẽ do các hàm mục tiêu có nhiều giới hạn mạnh hơn. Những thuật toán này chỉ có thể áp dụng cho những hàm lồi - những hàm số có ma trận Hesse là bán xác định dương tại mọi điểm. Những hàm này dễ tối ưu hơn vì chúng không có điểm yên ngựa, và những cực tiểu cục bộ đều là cực tiểu toàn cục. Tuy nhiên, hầu hết những bài toán trong học sâu đều khó có thể biểu diễn về dạng bài toán tối ưu lồi. Tối ưu lồi chỉ được sử dụng như một chương trình con của một số thuật toán học sâu. Các ý tưởng đến từ giải tích của những thuật toán tối ưu lồi có thể hữu ích cho việc chứng minh tính hội tụ của các thuật toán học sâu, tuy nhiên, nhìn chung, tối ưu lồi không có ý nghĩa quá quan trọng trong phạm vi của học sâu. Để tìm hiểu thêm về tối ưu lồi, bạn có thể đọc sách của Boyd và Vandenberghe (2001) hoặc Rockafellar(1997).</p><h1 id="44-Tối-ưu-có-ràng-buộc"><a class="anchor hidden-xs" href="#44-Tối-ưu-có-ràng-buộc" title="44-Tối-ưu-có-ràng-buộc"><span class="octicon octicon-link"></span></a>4.4 Tối ưu có ràng buộc</h1><p>Đôi khi, mục tiêu của chúng ta không chỉ là tìm giá trị cực đại hoặc cực tiểu của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">f</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1549">x</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-208">f(\boldsymbol{x})</script></span> trên toàn bộ tập các giá trị mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1552">x</span></span></span><script type="math/tex" id="MathJax-Element-209">\boldsymbol x</script></span> có thể nhận. Mà thay vào đó, chúng ta mong muốn tìm giá trị cực đại hoặc cực tiểu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">f</span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1556">x</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-210">f(\boldsymbol{x})</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1559">x</span></span></span><script type="math/tex" id="MathJax-Element-211">\boldsymbol{x}</script></span> nằm trong một số tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mrow" id="MJXp-Span-1561"><span class="MJXp-mi undefined" id="MJXp-Span-1562">S</span></span></span></span><script type="math/tex" id="MathJax-Element-212">\mathbb{S}</script></span> nào đó. Vấn đề này được gọi là bài toán <em>tối ưu có ràng buộc</em> (constrained optimization). Các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1564">x</span></span></span><script type="math/tex" id="MathJax-Element-213">\boldsymbol{x}</script></span> nằm trong tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1565"><span class="MJXp-mrow" id="MJXp-Span-1566"><span class="MJXp-mi undefined" id="MJXp-Span-1567">S</span></span></span></span><script type="math/tex" id="MathJax-Element-214">\mathbb{S}</script></span> được gọi là các điểm <em>khả thi</em> (feasible) ngữ cảnh của bài toán tối ưu có ràng buộc.</p><p>Ta thường muốn tìm ra nghiệm nhỏ, theo một nghĩa nào đó. Cách tiếp cận thông thường trong những trường hợp như vậy là áp thêm ràng buộc về <em>chuẩn</em> (norm), chẳng hạn như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1570"><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1572">x</span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1575">1</span></span></span><script type="math/tex" id="MathJax-Element-215">\|\boldsymbol{x}\|<1</script></span>.</p><p>Một phương án đơn giản khác theo hướng tối ưu có ràng buộc là sửa đổi thuật toán trượt gradient theo hướng sử dụng các ràng buộc. Nếu ta dùng một bước nhảy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-216">\epsilon</script></span> nhỏ không đổi, ta có thể tạo ra các bước trượt gradient và chiếu kết quả ngược về tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-mrow" id="MJXp-Span-1579"><span class="MJXp-mi undefined" id="MJXp-Span-1580">S</span></span></span></span><script type="math/tex" id="MathJax-Element-217">\mathbb{S}</script></span>. Nếu sử dụng kỹ thuật dò đường, ta chỉ có thể tìm kiếm trong phạm vi các bước nhảy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-218">\epsilon</script></span> tạo ra được các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1584">x</span></span></span><script type="math/tex" id="MathJax-Element-219">\boldsymbol{x}</script></span> khả thi mới, hoặc ta có thể chiếu mỗi điểm trên đường đó đi ngược về vùng ràng buộc. Nếu được, ta có thể cải thiện phương pháp này bằng cách chiếu gradient vào không gian tiếp tuyến với vùng khả thi trước khi thực hiện bước trượt hoặc dò đường [Rosen, 1960].</p><p>Một cách tiếp cận phức tạp hơn là thiết kế một bài toán tối ưu không ràng buộc khác, sao cho đáp án của nó có thể được chuyển đổi thành đáp án của bài toán tối ưu có ràng buộc ban đầu. Chẳng hạn, nếu ta cực tiểu hóa   <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">f</span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1588">x</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-220">f(\boldsymbol{x})</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1591">x</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mrow" id="MJXp-Span-1594" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1595">R</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1596" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-221">\boldsymbol{x}\in\mathbb{R}^2</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1597"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1598">x</span></span></span><script type="math/tex" id="MathJax-Element-222">\boldsymbol{x}</script></span> thỏa mãn ràng buộc rằng nó có một chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1599"><span class="MJXp-msubsup" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1602" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-223">L^2</script></span> xác định thì thay vào đó, ta sẽ cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">g</span><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">θ</span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">f</span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi" id="MJXp-Span-1612">cos</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">θ</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1616">sin</span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">θ</span><span class="MJXp-msubsup" id="MJXp-Span-1619"><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1621" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-224">g(\theta)=f([\cos\theta, \sin\theta]^\intercal)</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">θ</span></span></span><script type="math/tex" id="MathJax-Element-225">\theta</script></span>, sau đó trả về giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi" id="MJXp-Span-1627">cos</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">θ</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1631">sin</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">θ</span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-226">[\cos\theta, \sin\theta]</script></span> như là đáp áp của bài toán gốc. Cách tiếp cận này đòi hỏi tính sáng tạo; việc chuyển đổi qua lại giữa các bài toán tối ưu phải được thiết kế riêng cho mỗi trường hợp.</p><p>Phương pháp <em>Karush-Kuhn-Tucker</em> (KKT) cung cấp một phương pháp giải quyết rất tổng quát cho bài toán tối ưu có ràng buộc. Trong phương pháp này, chúng tôi giới thiệu một hàm mới, gọi là <em>Lagrange tổng quát</em> (generalized Lagrangian) hay <em>hàm Lagrange tổng quát</em> (generalized Lagrange function)<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-msubsup" id="MJXp-Span-1636"><span class="MJXp-mi" id="MJXp-Span-1637" style="margin-right: 0.05em;"></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1638" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1639">[</span><span class="MJXp-mn" id="MJXp-Span-1640">1</span><span class="MJXp-mo" id="MJXp-Span-1641">]</span></span></span></span></span><script type="math/tex" id="MathJax-Element-227">^{[1]}</script></span>.</p><blockquote>
<p>[1] Phương pháp KKT tổng quát hóa phương pháp <em>nhân tử Lagrange</em> (Lagrange multiplier), chỉ cho phép đẳng thức ràng buộc mà không cho phép các bất đẳng thức ràng buộc.</p>
</blockquote><p>Để định nghĩa hàm Lagrange, đầu tiên, ta cần mô tả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mrow" id="MJXp-Span-1643"><span class="MJXp-mi undefined" id="MJXp-Span-1644">S</span></span></span></span><script type="math/tex" id="MathJax-Element-228">\mathbb{S}</script></span> ở dạng các phương trình và bất phương trình. Ta cần một mô tả của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1645"><span class="MJXp-mrow" id="MJXp-Span-1646"><span class="MJXp-mi undefined" id="MJXp-Span-1647">S</span></span></span></span><script type="math/tex" id="MathJax-Element-229">\mathbb{S}</script></span> ở dạng gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">m</span></span></span><script type="math/tex" id="MathJax-Element-230">m</script></span> hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-msubsup" id="MJXp-Span-1651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1653" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1654">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">i</span><span class="MJXp-mo" id="MJXp-Span-1656">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-231">g^{(i)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">n</span></span></span><script type="math/tex" id="MathJax-Element-232">n</script></span> hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1659"><span class="MJXp-msubsup" id="MJXp-Span-1660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1662" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1663">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">i</span><span class="MJXp-mo" id="MJXp-Span-1665">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-233">h^{(i)}</script></span>, sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1666"><span class="MJXp-mrow" id="MJXp-Span-1667"><span class="MJXp-mi undefined" id="MJXp-Span-1668">S</span></span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1671">x</span><span class="MJXp-mrow" id="MJXp-Span-1672"><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi" id="MJXp-Span-1674">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">i</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1679" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1680">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">i</span><span class="MJXp-mo" id="MJXp-Span-1682">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1684">x</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1687">0</span><span class="MJXp-mtext" id="MJXp-Span-1688">&nbsp;và&nbsp;</span><span class="MJXp-mi" id="MJXp-Span-1689">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">j</span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1694" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1695">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">j</span><span class="MJXp-mo" id="MJXp-Span-1697">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1699">x</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1702">0</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-234">\mathbb{S}=\{\boldsymbol{x}| \forall i, g^{(i)}(\boldsymbol{x})=0 \text{ và }\forall j, h^{(j)}(\boldsymbol{x})\leq 0\}</script></span>. Các phương trình liên quan tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-msubsup" id="MJXp-Span-1705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1707" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1708">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">i</span><span class="MJXp-mo" id="MJXp-Span-1710">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-235">g^{(i)}</script></span> được gọi là các <em>đẳng thức ràng buộc</em>, và các bất phương trình liên quan tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1714" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1715">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">i</span><span class="MJXp-mo" id="MJXp-Span-1717">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-236">h^{(i)}</script></span> được gọi là các <em>bất đẳng thức ràng buộc</em>.</p><p>Ta đưa vào các biến mới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1718"><span class="MJXp-msubsup" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1721" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-237">\lambda_i</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-msubsup" id="MJXp-Span-1723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1725" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-238">\alpha_i</script></span> cho mỗi ràng buộc; chúng được gọi là các <em>nhân tử KKT</em> (KKT multiplier). Hàm Lagrange tổng quát được định nghĩa như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1726"><span class="MJXp-mtable" id="MJXp-Span-1727"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1728" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1729" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">L</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1732">x</span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1734">λ</span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1736">α</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1738" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">f</span><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1741">x</span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1744"><span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1749" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1752" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1753">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">i</span><span class="MJXp-mo" id="MJXp-Span-1755">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1757">x</span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1760"><span><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1765" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1768" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1769">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">j</span><span class="MJXp-mo" id="MJXp-Span-1771">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1773">x</span><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-239">L(\boldsymbol{x},\boldsymbol{\lambda},\boldsymbol{\alpha})=f(\boldsymbol{x})+\sum_i \lambda_i g^{(i)}(\boldsymbol{x})+\sum_j \alpha_j h^{(j)}(\boldsymbol{x}). \tag{4.14}</script></span></p><p>Tới đây, ta có thể giải bài toán cực tiểu hoá có ràng buộc bằng cách giải bài toán tối ưu không ràng buộc - bài toán Lagrange tổng quát. Miễn là tối thiểu có một điểm khả thi tồn tại và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">f</span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1779">x</span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-240">f(\boldsymbol{x})</script></span> không có khả năng tiến tới giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1781"><span class="MJXp-mi" id="MJXp-Span-1782">∞</span></span></span><script type="math/tex" id="MathJax-Element-241">\infty</script></span>, thì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1783"><span class="MJXp-mtable" id="MJXp-Span-1784"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1785" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1786" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1787"><span><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1789" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1790"><span><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1792" style="margin-left: 0px;">λ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1793"><span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1795" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1796">α</span><span class="MJXp-mo" id="MJXp-Span-1797">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1798">α</span><span class="MJXp-mo" id="MJXp-Span-1799">≥</span><span class="MJXp-mn" id="MJXp-Span-1800">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">L</span><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1803">x</span><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1805">λ</span><span class="MJXp-mo" id="MJXp-Span-1806" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1807">α</span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-242">\min_\boldsymbol{x}\max_\boldsymbol{\lambda}\max_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0} L(\boldsymbol{x},\boldsymbol{\lambda},\boldsymbol{\alpha}) \tag{4.15}</script></span></p><p>có cùng giá trị hàm mục tiêu tối ưu và cùng tập các điểm tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1809"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1810">x</span></span></span><script type="math/tex" id="MathJax-Element-243">\boldsymbol{x}</script></span> với</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1811"><span class="MJXp-mtable" id="MJXp-Span-1812"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1813" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1814" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1815"><span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1817" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1818">x</span><span class="MJXp-mo" id="MJXp-Span-1819">∈</span><span class="MJXp-mrow" id="MJXp-Span-1820"><span class="MJXp-mi undefined" id="MJXp-Span-1821">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">f</span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1824">x</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-244">\min_{\boldsymbol{x}\in\mathbb{S}}f(\boldsymbol{x}) \tag{4.16}</script></span></p><p>Tính chất này là bởi bất cứ khi nào các ràng buộc được thỏa mãn, thì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1826"><span class="MJXp-mtable" id="MJXp-Span-1827"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1828" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1829" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1830"><span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1832" style="margin-left: 0px;">λ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1833"><span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1835" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1836">α</span><span class="MJXp-mo" id="MJXp-Span-1837">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1838">α</span><span class="MJXp-mo" id="MJXp-Span-1839">≥</span><span class="MJXp-mn" id="MJXp-Span-1840">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">L</span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1843">x</span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1845">λ</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1847">α</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">f</span><span class="MJXp-mo" id="MJXp-Span-1851" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1852">x</span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1854" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-245">\max_\boldsymbol{\lambda}\max_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0} L(\boldsymbol{x},\boldsymbol{\lambda},\boldsymbol{\alpha})=f(\boldsymbol{x}), \tag{4.17}</script></span></p><p>Ngược lại, bất cứ khi nào ràng buộc bị vi phạm,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1855"><span class="MJXp-mtable" id="MJXp-Span-1856"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1857" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1858" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1859"><span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1861" style="margin-left: 0px;">λ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1862"><span><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1864" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1865">α</span><span class="MJXp-mo" id="MJXp-Span-1866">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1867">α</span><span class="MJXp-mo" id="MJXp-Span-1868">≥</span><span class="MJXp-mn" id="MJXp-Span-1869">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">L</span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1872">x</span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1874">λ</span><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1876">α</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1879">∞</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-246">\max_\boldsymbol{\lambda}\max_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0} L(\boldsymbol{x},\boldsymbol{\lambda},\boldsymbol{\alpha})=\infty \tag{4.18}</script></span></p><p>Những tính chất này đảm bảo rằng không có điểm bất khả thi nào có thể trở thành điểm tối ưu, và rằng giá trị tối ưu của hàm trong tập điểm khả thi là không đổi.</p><p>Để giải quyết bài toán cực đại có ràng buộc, ta có thể xây dựng hàm Lagrange tổng quát của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1880"><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">f</span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1884">x</span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">-f(\boldsymbol{x})</script></span>, từ đó ta có bài toán tối ưu sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1886"><span class="MJXp-mtable" id="MJXp-Span-1887"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1888" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1889" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1890"><span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1892" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1893"><span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1895" style="margin-left: 0px;">λ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1896"><span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1898" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1899">α</span><span class="MJXp-mo" id="MJXp-Span-1900">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1901">α</span><span class="MJXp-mo" id="MJXp-Span-1902">≥</span><span class="MJXp-mn" id="MJXp-Span-1903">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">f</span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1907">x</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1910"><span><span class="MJXp-mo" id="MJXp-Span-1911" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1915" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1918" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1919">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">i</span><span class="MJXp-mo" id="MJXp-Span-1921">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1923">x</span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1926"><span><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1931" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1934" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1935">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">j</span><span class="MJXp-mo" id="MJXp-Span-1937">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1939">x</span><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-248">\min_\boldsymbol{x}\max_\boldsymbol{\lambda}\max_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0} -f(\boldsymbol{x})+\sum_i \lambda_i g^{(i)}(\boldsymbol{x})+\sum_j \alpha_j h^{(j)}(\boldsymbol{x}) \tag{4.19}</script></span></p><p>Ta cũng có thể chuyển bài toán về dạng có bước ngoài cùng là tìm cực đại:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1941"><span class="MJXp-mtable" id="MJXp-Span-1942"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1943" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1944" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1945"><span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1947" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1948"><span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1950" style="margin-left: 0px;">λ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1951"><span><span class="MJXp-mo" id="MJXp-Span-1952" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1953" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1954">α</span><span class="MJXp-mo" id="MJXp-Span-1955">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1956">α</span><span class="MJXp-mo" id="MJXp-Span-1957">≥</span><span class="MJXp-mn" id="MJXp-Span-1958">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">f</span><span class="MJXp-mo" id="MJXp-Span-1960" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1961">x</span><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1964"><span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1969" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1972" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1973">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">i</span><span class="MJXp-mo" id="MJXp-Span-1975">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1977">x</span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1980"><span><span class="MJXp-mo" id="MJXp-Span-1981" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1985" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1988" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1989">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">j</span><span class="MJXp-mo" id="MJXp-Span-1991">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1993">x</span><span class="MJXp-mo" id="MJXp-Span-1994" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-249">\max_\boldsymbol{x}\min_\boldsymbol{\lambda}\min_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0} f(\boldsymbol{x})+\sum_i \lambda_i g^{(i)}(\boldsymbol{x})-\sum_j \alpha_j h^{(j)}(\boldsymbol{x}) \tag{4.20}</script></span></p><p>Chú ý rằng dấu của số hạng trong đẳng thức ràng buộc không quan trọng. Dấu cộng hay trừ tùy thuộc vào cách ta đưa ra bài toán, bởi dấu của mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1995"><span class="MJXp-msubsup" id="MJXp-Span-1996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1998" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-250">\lambda_i</script></span> có thể được tự do lựa chọn trong quá trình tối ưu.</p><p>Các bất đẳng thức ràng buộc đặc biệt thú vị. Giả sử rằng một ràng buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1999"><span class="MJXp-msubsup" id="MJXp-Span-2000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2002" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2003">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">i</span><span class="MJXp-mo" id="MJXp-Span-2005">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2006" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2007">x</span><span class="MJXp-mo" id="MJXp-Span-2008" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-251">h^{(i)}(\boldsymbol{x})</script></span> là <em>có hiệu lực</em> (active) nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-msubsup" id="MJXp-Span-2010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2012" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2013">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">i</span><span class="MJXp-mo" id="MJXp-Span-2015">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2017"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2018" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-2019" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-2020" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2022">0</span></span></span><script type="math/tex" id="MathJax-Element-252">h^{(i)}(\boldsymbol{x^*})=0</script></span>. Nếu một ràng buộc là phi hiệu lực thì đáp án tìm được của bài toán khi sử dụng ràng buộc đó sẽ vẫn là một đáp án cục bộ khi ta loại bỏ ràng buộc đó ra khỏi bài toán. Cũng có khi một ràng buộc phi hiệu lực loại trừ những đáp án khác. Chẳng hạn, một bài toán tối ưu lồi với toàn bộ vùng các điểm tối ưu toàn cục (một vùng rộng, phẳng mà hàm có cùng giá trị tối ưu tại mọi điểm) có thể bị các ràng buộc loại ra một phần, hay một bài toán tối ưu không lồi có thể có các điểm dừng cục bộ tốt hơn bị loại bỏ bởi một ràng buộc phi hiệu lực tại thời điểm hội tụ. Tuy vậy, điểm mà ta tìm được sau khi hội tụ vẫn là một điểm dừng, bất kể ta có đưa vào các ràng buộc phi hiệu lực hay không. Bởi vì nếu một phi hiệu lực <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2023"><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2026" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2027">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">i</span><span class="MJXp-mo" id="MJXp-Span-2029">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-253">h^{(i)}</script></span> có giá trị âm, thì lời giải cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2030"><span class="MJXp-msubsup" id="MJXp-Span-2031"><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2033" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-2034"><span class="MJXp-mo" id="MJXp-Span-2035" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2036" style="vertical-align: -0.4em;">λ</span></span><span class="MJXp-msubsup" id="MJXp-Span-2037"><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2039" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2040">α</span><span class="MJXp-mo" id="MJXp-Span-2041">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2042">α</span><span class="MJXp-mo" id="MJXp-Span-2043">≥</span><span class="MJXp-mn" id="MJXp-Span-2044">0</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">L</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2047">x</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2049">λ</span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2051">α</span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-254">\min_\boldsymbol{x} \max_\boldsymbol{\lambda} \max_{\boldsymbol{\alpha},\boldsymbol{\alpha}\geq 0}L(\boldsymbol{x},\boldsymbol{\lambda},\boldsymbol{\alpha})</script></span> sẽ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2053"><span class="MJXp-msubsup" id="MJXp-Span-2054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2056" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2057" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2058">0</span></span></span><script type="math/tex" id="MathJax-Element-255">\alpha_i=0</script></span>. Do đó, ta có nhận xét rằng đáp án tối ưu sẽ thoả mãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2059"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2060">α</span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2062">h</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2063" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2064">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2067">0</span></span></span><script type="math/tex" id="MathJax-Element-256">\boldsymbol{\alpha}\odot\boldsymbol{h(x)}=0</script></span>. Nói cách khác, với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">i</span></span></span><script type="math/tex" id="MathJax-Element-257">i</script></span>, ta biết rằng ít nhất một trong số các ràng buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2070"><span class="MJXp-msubsup" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2073" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-2075">0</span></span></span><script type="math/tex" id="MathJax-Element-258">\alpha_i\geq 0</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2076"><span class="MJXp-msubsup" id="MJXp-Span-2077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2079" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2080">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">i</span><span class="MJXp-mo" id="MJXp-Span-2082">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2084">x</span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2086" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-2087">0</span></span></span><script type="math/tex" id="MathJax-Element-259">h^{(i)}(\boldsymbol{x})\leq 0</script></span> phải có hiệu lực trong đáp án tối ưu. Để dễ mường tượng hơn, ta có thể giả sử rằng, hoặc là đáp án nằm trên biên của bất đẳng thức và ta phải sử dụng nhân tử KKT để tác động tính chất này của đáp án lên biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2089">x</span></span></span><script type="math/tex" id="MathJax-Element-260">\boldsymbol{x}</script></span>; hoặc là bất đẳng thức không có ảnh hưởng gì lên đáp án và ta biểu diễn điều này bằng cách thiết lập giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2090"><span class="MJXp-mn" id="MJXp-Span-2091">0</span></span></span><script type="math/tex" id="MathJax-Element-261">0</script></span> cho các nhân tử KKT.</p><p>Có một tập các điều kiện đơn giản, mô tả các tính chất mà điểm tối ưu của các bài toán tối ưu có ràng buộc phải thỏa mãn. Các tính chất này được gọi là các điều kiện Karush-Kuhn-Tucker (KKT) [Karush, 1939, Kuhn and Tucker, 1951]. Chúng là các điều kiện cần, nhưng không phải luôn là điều kiện đủ để một điểm là tối ưu. Các điều kiện gồm:</p><ul>
<li>Gradient của hàm Lagrange tổng quát bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2092"><span class="MJXp-mn" id="MJXp-Span-2093">0</span></span></span><script type="math/tex" id="MathJax-Element-262">0</script></span>.</li>
<li>Tất cả ràng buộc trên cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2094"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2095">x</span></span></span><script type="math/tex" id="MathJax-Element-263">\boldsymbol{x}</script></span> lẫn các nhân tử KKT phải được thỏa mãn.</li>
<li>Các bất đẳng thức ràng buộc có tính “lỏng lẻo bù trừ” (complementary slackness): <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2096"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2097">α</span><span class="MJXp-mo" id="MJXp-Span-2098" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2099">h</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2101">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2102" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2104">0</span></span></span><script type="math/tex" id="MathJax-Element-264">\boldsymbol{\alpha}\odot\boldsymbol{h(x)}=0</script></span>.</li>
</ul><p>Để hiểu rõ hơn về phương pháp KKT, bạn đọc hãy tìm đọc sách của Nocedal và Wright (2006).</p><h1 id="45-Ví-dụ-Bình-phương-cực-tiểu-tuyến-tính"><a class="anchor hidden-xs" href="#45-Ví-dụ-Bình-phương-cực-tiểu-tuyến-tính" title="45-Ví-dụ-Bình-phương-cực-tiểu-tuyến-tính"><span class="octicon octicon-link"></span></a>4.5 Ví dụ: Bình phương cực tiểu tuyến tính</h1><p>Giả sử ta muốn tìm giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2105"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2106">x</span></span></span><script type="math/tex" id="MathJax-Element-265">\boldsymbol{x}</script></span> sao cho hàm số sau đạt giá trị nhỏ nhất:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2107"><span class="MJXp-mtable" id="MJXp-Span-2108"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2109" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2110" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">f</span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2113">x</span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2115" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2116" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2117">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2118">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2120">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2121">x</span><span class="MJXp-mo" id="MJXp-Span-2122" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2123">b</span><span class="MJXp-msubsup" id="MJXp-Span-2124"><span class="MJXp-mo" id="MJXp-Span-2125" style="margin-left: 0em; margin-right: 0.05em;">‖</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2127">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2126">2</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-266">f(\boldsymbol{x})=\frac{1}{2} \|\boldsymbol{Ax}-\boldsymbol{b}\|^2_2 \tag{4.21}</script></span></p><p>Các giải thuật đại số tuyến tính chuyên dụng có thể giải bài toán này một cách hiệu quả; tuy nhiên, ta cũng có thể tìm hiểu cách giải bằng phương pháp tối ưu dựa trên gradient để coi đây như là một ví dụ đơn giản minh họa cách các kĩ thuật này hoạt động.</p><p>Trước tiên, ta cần tính gradient:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2128"><span class="MJXp-mtable" id="MJXp-Span-2129"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2130" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2131" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2132"><span class="MJXp-mi" id="MJXp-Span-2133" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2134" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">f</span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2137">x</span><span class="MJXp-mo" id="MJXp-Span-2138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2141" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2142" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mo" id="MJXp-Span-2143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2144">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2145">x</span><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2147">b</span><span class="MJXp-mo" id="MJXp-Span-2148" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2149" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2150"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2151" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2152" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2153">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2154">x</span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2156"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2157" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2158" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2159">b</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-267">\nabla_\boldsymbol{x}f(\boldsymbol{x})=\boldsymbol{A}^\intercal(\boldsymbol{Ax}-\boldsymbol{b})=\boldsymbol{A}^\intercal\boldsymbol{Ax}-\boldsymbol{A}^\intercal\boldsymbol{b} \tag{4.22}</script></span></p><p>Tiếp đó ta trượt gradient này theo hướng xuống theo từng bước nhỏ. Xem chi tiết trong giải thuật 4.1.</p><hr><p><strong>Giải thuật 4.1</strong>: Một thuật toán cực tiểu hóa hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">f</span><span class="MJXp-mo" id="MJXp-Span-2162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2163">x</span><span class="MJXp-mo" id="MJXp-Span-2164" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2166" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2167">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2168">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2170">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2171">x</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2173">x</span><span class="MJXp-msubsup" id="MJXp-Span-2174"><span class="MJXp-mo" id="MJXp-Span-2175" style="margin-left: 0em; margin-right: 0.05em;">‖</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2177">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2176">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-268">f(\boldsymbol{x})=\frac{1}{2}\|\boldsymbol{Ax}-\boldsymbol{x}\|^2_2</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2178"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2179">x</span></span></span><script type="math/tex" id="MathJax-Element-269">\boldsymbol{x}</script></span> bằng phương pháp trượt gradient, bắt đầu từ một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2180"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2181">x</span></span></span><script type="math/tex" id="MathJax-Element-270">\boldsymbol{x}</script></span> tùy ý.</p><hr><p>Chọn bước nhảy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2182"><span class="MJXp-mo" id="MJXp-Span-2183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">ϵ</span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-271">(\epsilon)</script></span> và sai số cho phép <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2186"><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">δ</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-272">(\delta)</script></span> có giá trị dương, độ lớn nhỏ.</p><p><strong>while</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2190"><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-msubsup" id="MJXp-Span-2192"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2193" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2194" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2195">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2196">x</span><span class="MJXp-mo" id="MJXp-Span-2197" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2198"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2199" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2200" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2201">b</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mo" id="MJXp-Span-2203" style="margin-left: 0em; margin-right: 0.05em;">‖</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">δ</span></span></span><script type="math/tex" id="MathJax-Element-273">\|\boldsymbol{A}^\intercal\boldsymbol{Ax}-\boldsymbol{A}^\intercal\boldsymbol{b}\|_2>\delta</script></span> <strong>do</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2207"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2208">x</span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2210">x</span><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">ϵ</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2214"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2215" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2216" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2217">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2218">x</span><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2220"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2221" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2222" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2223">b</span><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-274">\boldsymbol{x}\leftarrow\boldsymbol{x}-\epsilon(\boldsymbol{A}^\intercal\boldsymbol{Ax}-\boldsymbol{A}^\intercal\boldsymbol{b})</script></span></p><p><strong>end while</strong></p><hr><p>Bài toán này cũng có thể giải được bằng phương pháp Newton. Trong trường hợp này, bởi vì hàm số đúng là hàm bậc hai, phương pháp xấp xỉ hàm bậc hai sử dụng phương pháp Newton là chính xác và giải thuật sẽ hội tụ về điểm cực tiểu toàn cục trong vòng một bước.</p><p>Tới đây, giả sử ta muốn cực tiểu một hàm số tương tự, nhưng bổ sung thêm ràng buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2225"><span class="MJXp-msubsup" id="MJXp-Span-2226"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2227" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2228" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2229">x</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-2231">1</span></span></span><script type="math/tex" id="MathJax-Element-275">\boldsymbol{x}^\intercal\boldsymbol{x}\leq 1</script></span>. Để giải quyết bài toán này, ta đưa vào hàm Lagrange:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2232"><span class="MJXp-mtable" id="MJXp-Span-2233"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2234" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2235" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">L</span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2238">x</span><span class="MJXp-mo" id="MJXp-Span-2239" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">λ</span><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">f</span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2245">x</span><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2247" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">λ</span><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2250"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2251" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2252" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2253">x</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2255">1</span><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-276">L(\boldsymbol{x},\lambda)=f(\boldsymbol{x})+\lambda(\boldsymbol{x}^\intercal\boldsymbol{x}-1). \tag{4.23}</script></span></p><p>Tiếp theo ta giải bài toán</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2258"><span class="MJXp-mtable" id="MJXp-Span-2259"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2260" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2261" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-2262"><span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-2265"><span><span class="MJXp-mo" id="MJXp-Span-2266" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2267" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">λ</span><span class="MJXp-mo" id="MJXp-Span-2269">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">λ</span><span class="MJXp-mo" id="MJXp-Span-2271">≥</span><span class="MJXp-mn" id="MJXp-Span-2272">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">L</span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2275">x</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">λ</span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-277">\min_x\max_{\lambda,\lambda\geq 0} L(\boldsymbol{x},\lambda) \tag{4.24}</script></span></p><p>Nghiệm của bài toán có chuẩn nhỏ nhất cho bài toán bình phương cực tiểu không ràng buộc có thể tìm ra bằng phương pháp giả nghịch đảo Moore-Penrose: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2280">x</span><span class="MJXp-mo" id="MJXp-Span-2281" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2283" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2284" style="vertical-align: 0.5em;">+</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2285">b</span></span></span><script type="math/tex" id="MathJax-Element-278">\boldsymbol{x}=\boldsymbol{A}^+\boldsymbol{b}</script></span>. Nếu điểm này khả thi thì nó cũng là đáp án của bài toán có ràng buộc. Ngược lại, ta phải tìm đáp án trong đó ràng buộc về chuẩn là có hiệu lực. Lấy đạo hàm hàm Lagrange theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2287">x</span></span></span><script type="math/tex" id="MathJax-Element-279">\boldsymbol{x}</script></span>, ta được phương trình:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2288"><span class="MJXp-mtable" id="MJXp-Span-2289"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2290" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2291" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2292"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2293" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2294" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2295">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2296">x</span><span class="MJXp-mo" id="MJXp-Span-2297" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2298"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2299" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2300" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2301">b</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2303">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">λ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2305">x</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2307">0</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-280">\boldsymbol{A}^\intercal\boldsymbol{Ax}-\boldsymbol{A}^\intercal\boldsymbol{b}+2\lambda\boldsymbol{x}=0 \tag{4.25}</script></span></p><p>Như vậy nghiệm của bài toán sẽ có dạng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2308"><span class="MJXp-mtable" id="MJXp-Span-2309"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2310" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2311" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2312">x</span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2316" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2317" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2318">A</span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2320">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">λ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2322">I</span><span class="MJXp-msubsup" id="MJXp-Span-2323"><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2325" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2326">−</span><span class="MJXp-mn" id="MJXp-Span-2327">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2329" style="margin-right: 0.05em;">A</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2330" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2331">b</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-281">\boldsymbol{x}=(\boldsymbol{A}^\intercal\boldsymbol{A}+2\lambda\boldsymbol{I})^{-1}\boldsymbol{A}^\intercal\boldsymbol{b} \tag{4.26}</script></span></p><p>Độ lớn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">λ</span></span></span><script type="math/tex" id="MathJax-Element-282">\lambda</script></span> phải được chọn sao cho kết quả bài toán tuân theo ràng buộc về chuẩn. Ta có thể tìm giá trị này bằng cách áp dụng phương pháp <em>leo dốc gradient</em> (gradient ascent) với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">λ</span></span></span><script type="math/tex" id="MathJax-Element-283">\lambda</script></span>. Để làm được điều đó, ta thấy rằng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2336"><span class="MJXp-mtable" id="MJXp-Span-2337"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2338" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2339" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2340" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2341">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2342">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">λ</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344">L</span><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2346">x</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">λ</span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2351"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2352" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2353" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2354">x</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2356">1</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-284">\frac{\partial}{\partial\lambda}L(\boldsymbol{x},\lambda)=\boldsymbol{x}^\intercal\boldsymbol{x}-1 \tag{4.27}</script></span></p><p>Khi chuẩn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2357"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2358">x</span></span></span><script type="math/tex" id="MathJax-Element-285">\boldsymbol{x}</script></span> vượt quá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2359"><span class="MJXp-mn" id="MJXp-Span-2360">1</span></span></span><script type="math/tex" id="MathJax-Element-286">1</script></span>, đạo hàm trên có giá trị dương, do đó để men theo đạo hàm “leo dốc” và tăng giá trị hàm Lagrange theo biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">λ</span></span></span><script type="math/tex" id="MathJax-Element-287">\lambda</script></span>, ta phải tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">λ</span></span></span><script type="math/tex" id="MathJax-Element-288">\lambda</script></span>. Bởi hệ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">λ</span></span></span><script type="math/tex" id="MathJax-Element-289">\lambda</script></span> dùng để phạt  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2367"><span class="MJXp-msubsup" id="MJXp-Span-2368"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2369" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2370" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2371">x</span></span></span><script type="math/tex" id="MathJax-Element-290">\boldsymbol{x}^\intercal\boldsymbol{x}</script></span> tăng lên, nên việc giải phương trình tuyến tính (4.25) tìm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2373">x</span></span></span><script type="math/tex" id="MathJax-Element-291">\boldsymbol{x}</script></span> sẽ cho ra đáp án với chuẩn nhỏ hơn. Quá trình giải phương trình tuyến tính và điều chỉnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">λ</span></span></span><script type="math/tex" id="MathJax-Element-292">\lambda</script></span> diễn ra liên tục cho đến khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2377">x</span></span></span><script type="math/tex" id="MathJax-Element-293">\boldsymbol{x}</script></span> có chuẩn đúng và đạo hàm trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">λ</span></span></span><script type="math/tex" id="MathJax-Element-294">\lambda</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-mn" id="MJXp-Span-2381">0</span></span></span><script type="math/tex" id="MathJax-Element-295">0</script></span>.</p><p>Đến đây, chúng tôi đã kết thúc sơ bộ phần toán học mà ta cần để phát triển các thuật toán học máy. Chúng ta đã sẵn sàng để xây dựng và phân tích một số hệ thống tự học đầy đủ.</p><hr><p>Người dịch: Nguyễn Văn Thành, Soah, Son Tran Hoang, Luong TD, linux, Hung Le, Pham Dinh Khanh,  Phu Nguyen, Xuan Tu, lhlong, LA, Hung Ngo, Võ Tấn Phát</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-4-Tính-toán-số-" title="Chương 4 
Tính toán số ">Chương 4 
Tính toán số </a></li>
<li><a href="#41-Tràn-luồng-và-thấp-luồng" title="4.1 Tràn luồng và thấp luồng">4.1 Tràn luồng và thấp luồng</a></li>
<li><a href="#42-Tính-kém-điều-hòa" title="4.2 Tính kém điều hòa">4.2 Tính kém điều hòa</a></li>
<li><a href="#43-Tối-ưu-dựa-trên-gradient" title="4.3 Tối ưu dựa trên gradient">4.3 Tối ưu dựa trên gradient</a><ul class="nav">
<li><a href="#431-Ma-trận-Jacobi-và-ma-trận-Hesse" title="4.3.1 Ma trận Jacobi và ma trận Hesse">4.3.1 Ma trận Jacobi và ma trận Hesse</a></li>
</ul>
</li>
<li><a href="#44-Tối-ưu-có-ràng-buộc" title="4.4 Tối ưu có ràng buộc">4.4 Tối ưu có ràng buộc</a></li>
<li><a href="#45-Ví-dụ-Bình-phương-cực-tiểu-tuyến-tính" title="4.5 Ví dụ: Bình phương cực tiểu tuyến tính">4.5 Ví dụ: Bình phương cực tiểu tuyến tính</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-4-Tính-toán-số-" title="Chương 4 
Tính toán số ">Chương 4 
Tính toán số </a></li>
<li><a href="#41-Tràn-luồng-và-thấp-luồng" title="4.1 Tràn luồng và thấp luồng">4.1 Tràn luồng và thấp luồng</a></li>
<li><a href="#42-Tính-kém-điều-hòa" title="4.2 Tính kém điều hòa">4.2 Tính kém điều hòa</a></li>
<li><a href="#43-Tối-ưu-dựa-trên-gradient" title="4.3 Tối ưu dựa trên gradient">4.3 Tối ưu dựa trên gradient</a><ul class="nav">
<li><a href="#431-Ma-trận-Jacobi-và-ma-trận-Hesse" title="4.3.1 Ma trận Jacobi và ma trận Hesse">4.3.1 Ma trận Jacobi và ma trận Hesse</a></li>
</ul>
</li>
<li><a href="#44-Tối-ưu-có-ràng-buộc" title="4.4 Tối ưu có ràng buộc">4.4 Tối ưu có ràng buộc</a></li>
<li><a href="#45-Ví-dụ-Bình-phương-cực-tiểu-tuyến-tính" title="4.5 Ví dụ: Bình phương cực tiểu tuyến tính">4.5 Ví dụ: Bình phương cực tiểu tuyến tính</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
