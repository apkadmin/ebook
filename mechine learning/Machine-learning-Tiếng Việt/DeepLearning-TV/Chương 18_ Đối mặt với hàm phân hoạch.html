<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-18-Đối-mặt-với-hàm-phân-hoạch">Chương 18: Đối mặt với hàm phân hoạch</h1><p>------------------------<br>
<strong>Thăng Lê Cao bắt đầu dịch từ đây</strong><br>
------------------------</p><p>Trong phần 16.2.2 chúng ta nhận thấy rằng nhiều mô hình xác suất (thường được biết đến với tên gọi mô hình đồ thị vô hướng) được định nghĩa bởi một phân phối xác suất chưa được chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-munderover" id="MJXp-Span-3"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-7"><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-9">x</span></span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-11">θ</span></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-1-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-1">\tilde{p}({\mathbf{x};\boldsymbol{\theta}})</script></span>. Ta cần phải chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mrow" id="MJXp-Span-14"><span class="MJXp-munderover" id="MJXp-Span-15"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-2-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-2">\tilde{p}</script></span> bằng cách chia cho hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">Z</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-21">θ</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-3-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-3">Z(\boldsymbol{\theta})</script></span> để đạt được một phân phối hợp lý:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-23"><span class="MJXp-mtable" id="MJXp-Span-24"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-25" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-26" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">p</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-29"><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-31">x</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-33">θ</span></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-36" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-37">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">Z</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-40">θ</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-42"><span class="MJXp-munderover" id="MJXp-Span-43"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-49">x</span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-51">θ</span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\begin{align}
p({\mathbf{x};\boldsymbol{\theta}}) = \frac{1}{Z(\boldsymbol{\theta})}\widetilde{p}({\mathbf{x};\boldsymbol{\theta}}).\tag{18.1}
\end{align}</script></span><br>
Hàm phân hoạch là một phép tích phân (đối với biến ngẫu nhiên liên tục) hoặc phép lấy tổng (đối với biến ngẫu nhiên rời rạc) các xác suất chưa chuẩn hóa của tất cả các trạng thái trong không gian mẫu:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-54"><span class="MJXp-mtable" id="MJXp-Span-55"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-56" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-57" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-60" style="vertical-align: -0.46em;"></span></span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-munderover" id="MJXp-Span-62"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-66">x</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">d</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-69">x</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">\begin{align}
\int_{} \widetilde{p}(\boldsymbol{x}) d\boldsymbol{x} \tag{18.2}
\end{align}</script></span><br>
hoặc<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-70"><span class="MJXp-mtable" id="MJXp-Span-71"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-72" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-73" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-74"><span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-76" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-77">x</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-munderover" id="MJXp-Span-79"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-83">x</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">\begin{align}
\sum\limits_{\boldsymbol{x}} \widetilde{p}(\boldsymbol{x}). \tag{18.3}
\end{align}</script></span><br>
Phép toán này khó tính toán đối với nhiều mô hình thống kê.<br>
Như ta sẽ thấy trong chương 20, một số mô hình học sâu được thiết kế có hằng số chuẩn hóa có thể tính toán được hoặc được thiết kế để không cần phải tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">p</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">x</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-7-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-7">p(x)</script></span>. Tuy nhiên, nhiều mô hình khác phải đối mặt với thách thức của các hàm phân hoạch khó tính toán. Trong chương này, chúng tôi mô tả một số kĩ thuật được sử dụng để huấn luyện và đánh giá các mô hình có hàm phân hoạch khó tính toán.</p><h1 id="181-Gradient-của-logarit-hàm-hợp-lý">18.1 Gradient của logarit hàm hợp lý</h1><p>Nguyên nhân dẫn đến việc học các mô hình vô hướng bằng phương pháp hợp lý cực đại trở nên khó khăn là do hàm phân hoạch phụ thuộc vào nhiều tham số. Gradient của logarit hàm hợp lý ứng với các tham số có một phần tương ứng với gradient của hàm phân hoạch:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-91"><span class="MJXp-mtable" id="MJXp-Span-92"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-93" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-94" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi" id="MJXp-Span-96" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-98">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-99">log</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">p</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-104"><span class="MJXp-mrow" id="MJXp-Span-105"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-106">x</span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-108">θ</span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi" id="MJXp-Span-112" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-114">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-115">log</span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mrow" id="MJXp-Span-118"><span class="MJXp-munderover" id="MJXp-Span-119"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-123"><span class="MJXp-mrow" id="MJXp-Span-124"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-125">x</span></span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-127">θ</span></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-130"><span class="MJXp-mi" id="MJXp-Span-131" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-132" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-133">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-134">log</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">Z</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-139">θ</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\begin{align}
\nabla_{\boldsymbol{\theta}}\log{p({\mathbf{x};\boldsymbol{\theta}})} = \nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x};\boldsymbol{\theta}})} - \nabla_{\boldsymbol{\theta}}\log{Z(\boldsymbol{\theta)}} \tag{18.4}
\end{align}</script></span><br>
Đây là sự phân tách phổ biến thành <strong>pha dương</strong> và <strong>pha âm</strong> trong việc học của mô hình.</p><p>Đối với hầu hết các mô hình vô hướng, việc tính toán pha âm gặp khó khăn. Những mô hình không có biến ẩn hoặc có ít tương tác giữa các biến ẩn thường có pha dương tính được. Một ví dụ điển hình của mô hình có pha dương tính được và pha âm khó tính toán là RBM, trong đó các đơn vị ẩn độc lập có điều kiện với nhau nếu cho trước giá trị của các đơn vị khả kiến. Trường hợp khó tính toán pha dương, trong những mô hình có nhiều tương tác phức tạp giữa các biến ẩn, được chúng tôi khai thác ở chương 19. Chương này tập trung vào các khó khăn trong việc tính toán pha âm.<br>
Ta hãy cùng phân tích công thức gradient của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-mi" id="MJXp-Span-142">log</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-9-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-9">\log Z</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-145"><span class="MJXp-mtable" id="MJXp-Span-146"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-147" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-148" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi" id="MJXp-Span-150" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-152">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-153">log</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">Z</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">\begin{align}
\nabla_{\boldsymbol{\theta}}\log{Z} \tag{18.5}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-157"><span class="MJXp-mtable" id="MJXp-Span-158"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-159" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-160" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-162" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-163"><span class="MJXp-mi" id="MJXp-Span-164" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-165" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-166">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">Z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\begin{align}
= \frac{\nabla_{\boldsymbol{\theta}}Z}{Z} \tag{18.6}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-169"><span class="MJXp-mtable" id="MJXp-Span-170"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-171" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-172" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-174" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi" id="MJXp-Span-176" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-177" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-178">θ</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-179"><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-181" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-182"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-183">x</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-184"><span class="MJXp-mrow" id="MJXp-Span-185"><span class="MJXp-munderover" id="MJXp-Span-186"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-190"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-191">x</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">\begin{align}
= \frac{\nabla_{\boldsymbol{\theta}}\sum\nolimits_{\mathbf{x}} {\widetilde{p}(\mathbf{x})}}{Z} \tag{18.7}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-194"><span class="MJXp-mtable" id="MJXp-Span-195"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-196" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-197" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-199" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-202" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-203"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-204">x</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-205"><span class="MJXp-mi" id="MJXp-Span-206" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-207" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-208">θ</span></span></span><span class="MJXp-mrow" id="MJXp-Span-209"><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-munderover" id="MJXp-Span-211"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-216">x</span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\begin{align}
= \frac{\sum\nolimits_{\mathbf{x}}\nabla_{\boldsymbol{\theta}}{\widetilde{p}(\mathbf{x})}}{Z} \tag{18.8}
\end{align}</script></span><br>
Để mô hình luôn đảm bảo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">p</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-222"><span class="MJXp-mrow" id="MJXp-Span-223"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-224">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-227">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-14-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-14">p(\mathbf{{x}}) > 0</script></span> với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-231">x</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-15">\mathbf{{x}}</script></span>, ta có thể thay thế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-munderover" id="MJXp-Span-234"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-240">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-16">\widetilde{p}(\mathbf{{x}})</script></span> cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mi" id="MJXp-Span-243">exp</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-246">log</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-248"><span class="MJXp-mrow" id="MJXp-Span-249"><span class="MJXp-munderover" id="MJXp-Span-250"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-254"><span class="MJXp-mrow" id="MJXp-Span-255"><span class="MJXp-mrow" id="MJXp-Span-256"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-257">x</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-17">\exp(\log{\widetilde{p}({\mathbf{{x}}})})</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-260"><span class="MJXp-mtable" id="MJXp-Span-261"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-262" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-263" style="text-align: right;"><span class="MJXp-mfrac" id="MJXp-Span-264" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-268"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-269">x</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi" id="MJXp-Span-271" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-273">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-274">exp</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-277">log</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mrow" id="MJXp-Span-280"><span class="MJXp-munderover" id="MJXp-Span-281"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-285"><span class="MJXp-mrow" id="MJXp-Span-286"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-287">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\begin{align}
\frac{\sum\nolimits_{\mathbf{x}}\nabla_{\boldsymbol{\theta}}\exp(\log{\widetilde{p}({\mathbf{x}})})}{Z} \tag{18.9}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-291"><span class="MJXp-mtable" id="MJXp-Span-292"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-293" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-294" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-296" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-300"><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-302">x</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-303">exp</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-306">log</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-308"><span class="MJXp-mrow" id="MJXp-Span-309"><span class="MJXp-munderover" id="MJXp-Span-310"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-314"><span class="MJXp-mrow" id="MJXp-Span-315"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-316">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi" id="MJXp-Span-320" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-322">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-323">log</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mrow" id="MJXp-Span-326"><span class="MJXp-munderover" id="MJXp-Span-327"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-331"><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-333">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">\begin{align}
= \frac{\sum\nolimits_{\mathbf{{x}}}\exp(\log{\widetilde{p}({\mathbf{x}})})\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x}})}}{Z} \tag{18.10}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-336"><span class="MJXp-mtable" id="MJXp-Span-337"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-338" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-339" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-341" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-342"><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-344" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-345"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-346">x</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-munderover" id="MJXp-Span-348"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mrow" id="MJXp-Span-353"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-354">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi" id="MJXp-Span-357" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-359">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-360">log</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-munderover" id="MJXp-Span-364"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-368"><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-370">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{align}
= \frac{\sum\nolimits_{\mathbf{x}}\widetilde{p}({\mathbf{x}})\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x}})}}{Z} \tag{18.11}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-373"><span class="MJXp-mtable" id="MJXp-Span-374"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-375" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-376" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-378"><span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-380" style="margin-left: 0px;"><span class="MJXp-mrow" id="MJXp-Span-381"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-382">x</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">p</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-385"><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-387">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi" id="MJXp-Span-390" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-392">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-393">log</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-mrow" id="MJXp-Span-396"><span class="MJXp-munderover" id="MJXp-Span-397"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-401"><span class="MJXp-mrow" id="MJXp-Span-402"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-403">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{align}
= \sum\limits_{\mathbf{x}} p({\mathbf{x}})\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x}})}\tag{18.12}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-405"><span class="MJXp-mtable" id="MJXp-Span-406"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-407" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-408" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-410"><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mrow" id="MJXp-Span-412" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-413">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-415"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-416">x</span></span><span class="MJXp-mo" id="MJXp-Span-417">∼</span><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">p</span><span class="MJXp-mo" id="MJXp-Span-420">(</span><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-422">x</span></span><span class="MJXp-mo" id="MJXp-Span-423">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi" id="MJXp-Span-426" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-428">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-429">log</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-431"><span class="MJXp-mrow" id="MJXp-Span-432"><span class="MJXp-munderover" id="MJXp-Span-433"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-437"><span class="MJXp-mrow" id="MJXp-Span-438"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-439">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">\begin{align}
= \mathop{\mathbb{E}_{\mathbf{x}\sim{p(\mathbf{x})}}} \nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x}})}\tag{18.13}
\end{align}</script></span></p><p>Phần đạo hàm này áp dụng trên tổng của tất cả các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">x</script></span> rời rạc, kết quả tương tự cũng được áp dụng bằng cách tính tích phân biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">x</script></span> liên tục. Trong phiên bản liên tục của đạo hàm, ta sử dụng quy tắc Leibniz cho vi phân để đạt được phép đồng nhất:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-445"><span class="MJXp-mtable" id="MJXp-Span-446"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-447" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-448" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mi" id="MJXp-Span-450" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-452">θ</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-455" style="vertical-align: -0.46em;"></span></span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-munderover" id="MJXp-Span-457"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-461"><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-463">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">x</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-468"><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-470" style="vertical-align: -0.46em;"></span></span><span class="MJXp-msubsup" id="MJXp-Span-471"><span class="MJXp-mi" id="MJXp-Span-472" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-474">θ</span></span></span><span class="MJXp-mrow" id="MJXp-Span-475"><span class="MJXp-munderover" id="MJXp-Span-476"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-480"><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-482">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">x</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">\begin{align}
\nabla_{\boldsymbol{\theta}} \int_{} \widetilde{p}({\mathbf{x}}) dx = \int_{} \nabla_{\boldsymbol{\theta}} \widetilde{p}({\mathbf{x}}) dx. \tag{18.14}
\end{align}</script></span></p><p>Phép đồng nhất này chỉ áp dụng được trong một số điều kiện nhất định của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mrow" id="MJXp-Span-488"><span class="MJXp-munderover" id="MJXp-Span-489"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26">\widetilde{p}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-msubsup" id="MJXp-Span-493"><span class="MJXp-mi" id="MJXp-Span-494" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-495" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">θ</span></span></span><span class="MJXp-mrow" id="MJXp-Span-497"><span class="MJXp-munderover" id="MJXp-Span-498"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-502"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-503">x</span></span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-27">\nabla_{\theta} \widetilde{p}(\mathbf{x})</script></span>. Trong lý thuyết đo lường, các điều kiện này là: (1) Phân phối chưa chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-munderover" id="MJXp-Span-507"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">\widetilde{p}</script></span> phải là một hàm tích hợp Lebesgue của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">x</script></span> cho mọi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-513">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">\boldsymbol{\theta}</script></span>. (2) Gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-514"><span class="MJXp-msubsup" id="MJXp-Span-515"><span class="MJXp-mi" id="MJXp-Span-516" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-517" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-518">θ</span></span></span><span class="MJXp-mrow" id="MJXp-Span-519"><span class="MJXp-munderover" id="MJXp-Span-520"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-524"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-525">x</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">\nabla_{\boldsymbol{\theta}} \widetilde{p}(\mathbf{x})</script></span> phải tồn tại với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-528">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">\boldsymbol{\theta}</script></span> và gần như với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">x</script></span>. (3) Phải tồn tại một hàm tích hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">R</span><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">x</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">R(x)</script></span> là cận của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-msubsup" id="MJXp-Span-537"><span class="MJXp-mi" id="MJXp-Span-538" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-539" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-540">θ</span></span></span><span class="MJXp-mrow" id="MJXp-Span-541"><span class="MJXp-munderover" id="MJXp-Span-542"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-546"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-547">x</span></span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">\nabla_{\boldsymbol{\theta}} \widetilde{p}(\mathbf{x})</script></span>, mà tại đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mrow" id="MJXp-Span-550"><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">a</span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">i</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-558" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-559">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-560">∂</span><span class="MJXp-msubsup" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-563" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">i</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-565"><span class="MJXp-munderover" id="MJXp-Span-566"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-571">x</span></span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-573"><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">R</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">x</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">|max_{i}\frac{\partial}{\partial \theta_{i}}\widetilde{p}(\mathbf{x})| \leq R(x)</script></span> với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">\theta</script></span> và gần như với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">x</script></span>. May mắn thay, hầu hết các mô hình học máy được nghiên cứu đều có những tính chất này.<br>
Phép đồng nhất<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-584"><span class="MJXp-mtable" id="MJXp-Span-585"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-586" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-587" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi" id="MJXp-Span-589" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-591">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-592">log</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">Z</span></span><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-597"><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mrow" id="MJXp-Span-599" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-600">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-603">x</span></span><span class="MJXp-mo" id="MJXp-Span-604">∼</span><span class="MJXp-mrow" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">p</span><span class="MJXp-mo" id="MJXp-Span-607">(</span><span class="MJXp-mrow" id="MJXp-Span-608"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-609">x</span></span><span class="MJXp-mo" id="MJXp-Span-610">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi" id="MJXp-Span-613" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-614" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-615">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-616">log</span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mrow" id="MJXp-Span-619"><span class="MJXp-munderover" id="MJXp-Span-620"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-624"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-625">x</span></span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\begin{align}
\nabla_{\boldsymbol{\theta}}\log{Z} = \mathop{\mathbb{E}_{\mathbf{x}\sim{p(\mathbf{x})}}} \nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\mathbf{x})}\tag{18.15}
\end{align}</script></span></p><p>là nền tảng cho nhiều phương pháp Monte Carlo dùng để xấp xỉ việc cực đại hoá hàm hợp lý của các mô hình có hàm phân hoạch khó tính toán.</p><p>Phương pháp tiếp cận Monte Carlo để học các mô hình vô hướng cung cấp một cơ chế trực quan trong cách chúng ta hiểu về pha dương và pha âm. Trong pha dương, ta tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mi" id="MJXp-Span-628">log</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-630"><span class="MJXp-mrow" id="MJXp-Span-631"><span class="MJXp-munderover" id="MJXp-Span-632"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-636"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-637">x</span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">\log{\widetilde{p}(\mathbf{x})}</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">x</script></span> được lấy mẫu từ tập dữ liệu. Trong pha âm, ta giảm hàm phân hoạch bằng cách giảm giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mi" id="MJXp-Span-642">log</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-644"><span class="MJXp-mrow" id="MJXp-Span-645"><span class="MJXp-munderover" id="MJXp-Span-646"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-650"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-651">x</span></span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">\log{\widetilde{p}(\mathbf{x})}</script></span> được lấy mẫu từ phân phối của mô hình.</p><p>Trong ngữ cảnh học sâu, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mi" id="MJXp-Span-654">log</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-mrow" id="MJXp-Span-657"><span class="MJXp-munderover" id="MJXp-Span-658"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">p</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">\log{\widetilde{p}}</script></span> thường được tham số hóa dưới dạng một hàm năng lượng (phương trình 16.7). Trong trường hợp này, ta có thể diễn giải pha dương như một cách thu giảm năng lượng từ tập huấn luyện và pha âm như một cách tăng năng lượng của mẫu được lấy mẫu từ mô hình, theo như mô phỏng trong hình 18.1.</p><h1 id="182-Hợp-lý-cực-đại-ngẫu-nhiên-và-phân-kì-tương-phản">18.2 Hợp lý cực đại ngẫu nhiên và phân kì tương phản</h1><p>Một cách ngây thơ để hiện thực phương trình 18.15 là sử dụng phép loại bỏ các chuỗi Markov từ một khởi tạo ngẫu nhiên khi cần tính gradient. Trong quá trình học bằng phương pháp trượt gradient ngẫu nhiên, ta thực hiện phép loại bỏ chuỗi Markov tại mỗi bước tính gradient. Phương pháp tiếp cận này được mô tả trong giải thuật 18.1. Chi phí cao của phép loại bỏ chuỗi Markov trong mỗi vòng lặp làm cho giải thuật này không khả thi về mặt tính toán, tuy nhiên giải thuật này lại là khởi nguồn cho các giải thuật xấp xỉ khác.</p><hr><p>Giải thuật 18.1 Một giải thuật MCMC ngây thơ cho cực đại hóa logarit của hàm hợp lý với hàm phân hoạch không tính được, sử dụng phương pháp giảm theo gradient.</p><hr><p>Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">\epsilon</script></span>, kích cỡ của bước đi, là một số dương có giá trị nhỏ.<br>
Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">k</script></span>, số bước Gibbs, đủ lớn cho phép loại bỏ chuỗi Markov. Khoảng chừng 100 để huấn luyện mô hình RBM trên tập ảnh nhỏ<br>
<strong>while</strong> không hội tụ <strong>do</strong></p><ul>
<li>
<p>Lấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-667"><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-669"><span class="MJXp-mrow" id="MJXp-Span-670" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-671">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-672" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-673">(</span><span class="MJXp-mn" id="MJXp-Span-674">1</span><span class="MJXp-mo" id="MJXp-Span-675">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-681"><span class="MJXp-mrow" id="MJXp-Span-682" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-683">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-684" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-685">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">m</span><span class="MJXp-mo" id="MJXp-Span-687">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">\{\mathbf{x}^{(1)}, ..., \mathbf{x}^{(m)}\}</script></span> từ tập huấn luyện</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">g</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-692" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-693">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-695"><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">i</span><span class="MJXp-mo" id="MJXp-Span-699">=</span><span class="MJXp-mn" id="MJXp-Span-700">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mi" id="MJXp-Span-704" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-705" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-706">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-707">log</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-709"><span class="MJXp-mrow" id="MJXp-Span-710"><span class="MJXp-munderover" id="MJXp-Span-711"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-715"><span class="MJXp-mrow" id="MJXp-Span-716" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-717">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-718" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-719">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">i</span><span class="MJXp-mo" id="MJXp-Span-721">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-723">θ</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">g \leftarrow \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\mathbf{x}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p>Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-729"><span class="MJXp-mrow" id="MJXp-Span-730" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-731"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-732"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-733">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-735" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-736">(</span><span class="MJXp-mn" id="MJXp-Span-737">1</span><span class="MJXp-mo" id="MJXp-Span-738">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-744"><span class="MJXp-mrow" id="MJXp-Span-745" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-746"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-748">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-750" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-751">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">m</span><span class="MJXp-mo" id="MJXp-Span-753">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">\{\widetilde{\mathbf{x}}^{(1)}, ..., \widetilde{\mathbf{x}}^{(m)}\}</script></span> có giá trị ngẫu nhiên (ví dụ, từ phân phối đều hoặc chuẩn, hoặc có thể từ một phân phối có biên phù hợp với biên của mô hình).</p>
</li>
<li>
<p><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">i</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-758">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">i = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">k</script></span> <strong>do</strong></p>
<ul>
<li><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">j</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-764">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">j = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">m</script></span> <strong>do</strong>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-767"><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mrow" id="MJXp-Span-769" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-770"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-771"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-772">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-774" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-775">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">j</span><span class="MJXp-mo" id="MJXp-Span-777">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mtext" id="MJXp-Span-779">gibbs_update</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mrow" id="MJXp-Span-782" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-783"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-784"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-785">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-787" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-788">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">j</span><span class="MJXp-mo" id="MJXp-Span-790">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\widetilde{\mathbf{x}}^{(j)} \leftarrow \text{gibbs_update}(\widetilde{\mathbf{x}}^{(j)})</script></span></li>
</ul>
</li>
<li><strong>end for</strong></li>
</ul>
</li>
<li>
<p><strong>end for</strong></p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-793">g</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-795">g</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-797" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-798">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-800"><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">i</span><span class="MJXp-mo" id="MJXp-Span-804">=</span><span class="MJXp-mn" id="MJXp-Span-805">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi" id="MJXp-Span-809" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-811">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-812">log</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-814"><span class="MJXp-mrow" id="MJXp-Span-815"><span class="MJXp-munderover" id="MJXp-Span-816"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-820"><span class="MJXp-mrow" id="MJXp-Span-821" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-822"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-823"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-824">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-826" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-827">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">i</span><span class="MJXp-mo" id="MJXp-Span-829">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-831">θ</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">\boldsymbol{g} \leftarrow \boldsymbol{g} - \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\widetilde{\mathbf{x}}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-833"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-834">θ</span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-836">θ</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-839">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} + \epsilon \boldsymbol{g}</script></span><br>
<strong>end while</strong></p>
</li>
</ul><hr><p>Chúng ta có thể xem phương pháp MCMC cho hợp lý cực đại như việc cân bằng giữa hai lực lượng, một lực lượng đẩy lên phân phối mô hình tại các vùng có dữ liệu và một lực lượng khác đẩy xuống phân phối mô hình tại các vùng có mẫu được lấy mẫu từ phân phối mô hình. Hình 18.1 mô phỏng quá trình này. Hai lực lượng này tương ứng với việc cực đại hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mi" id="MJXp-Span-841">log</span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mrow" id="MJXp-Span-844"><span class="MJXp-munderover" id="MJXp-Span-845"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">p</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">\log{\widetilde{p}}</script></span> và cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-848"><span class="MJXp-mi" id="MJXp-Span-849">log</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">\log{Z}</script></span>. Một vài phương pháp có thể xấp xỉ pha âm. Mỗi xấp xỉ này có thể được hiểu như một cách làm giảm thiểu chi phí tính toán pha âm tuy nhiên lúc này pha âm sẽ đẩy xuống phân phối mô hình tại những vị trí không chính xác.</p><p>Bởi vì pha âm có liên quan đến việc lấy mẫu từ phân phối mô hình, ta có thể xem nó như việc tìm những điểm mà mô hình tin vào chúng nhất. Vì pha âm đóng vai trò làm giảm xác suất của những điểm này, nó được hiểu như những niềm tin sai lầm của mô hình về thế giới. Nó cũng thường được đề cập trong nhiều tài liệu như là <strong>“các ảo giác”</strong> hay <strong>“các phân tử tưởng tượng”</strong>. Trong thực tế, pha âm đã được đề xuất như một sự giải thích cho giấc mơ của con người và các loài động vật khác (Crick và Mitchison, 1983), với ý tưởng bộ não duy trì một phân phối xác suất về thế giới và việc lấy đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mi" id="MJXp-Span-854">log</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-856"><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-munderover" id="MJXp-Span-858"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">p</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">\log{\widetilde{p}}</script></span> tương ứng với việc ta trải nghiệm những sự kiện thực tế trong trạng thái đang thức và việc lấy đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-mi" id="MJXp-Span-862">log</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-864"><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-munderover" id="MJXp-Span-866"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">p</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\log{\widetilde{p}}</script></span> để cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-869"><span class="MJXp-mi" id="MJXp-Span-870">log</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">\log{Z}</script></span> tương ứng với khi ta đang ngủ và trải nghiệm các sự kiện được lấy mẫu từ phân phối của mô hình. Cách nhìn này giải thích khá rõ ràng cho sự phân tách thành pha âm và pha dương của giải thuật, tuy nhiên tính đúng đắn của nó chưa được chứng minh bởi các thí nghiệm thần kinh học. Trong các mô hình học máy, việc sử dụng pha dương và pha âm đồng thời cần thiết hơn là chia thành các giai đoạn tách biệt như thức và ngủ mơ (giấc ngủ REM). Như ta sẽ thấy trong phần 19.5, các giải thuật học máy khác lấy mẫu từ phân phối mô hình cho nhiều mục đích khác nhau, và các giải thuật này cũng có đề cập đến hàm ngủ mơ.</p><p><img src="https://i.imgur.com/rxc334A.jpg" alt=""></p><blockquote>
<p>Hình 18.1 Cách nhìn của giải thuật 18.1 có “pha dương” và “pha âm”. (Trái) Trong pha dương, ta lấy mẫu từ phân phối dữ liệu và đẩy lên xác suất chưa chuẩn hóa của chúng. Điều này có nghĩa là những điểm có khả năng thuộc về tập dữ liệu sẽ được đẩy lên hơn nữa. (Phải) Trong pha âm, ta lấy mẫu từ phân phối mô hình và đẩy xuống xác suất chưa chuẩn hóa của chúng. Điều này chống lại xu hướng của pha dương khi chỉ thêm một hằng lớn vào xác suất chưa chuẩn hóa khắp mọi nơi. Khi phân phối dữ liệu và phân phối mô hình bằng nhau, pha dương có cơ hội đẩy lên một điểm dữ liệu ngang với cơ hội đẩy xuống dữ liệu của pha âm. Khi điều này xảy ra, không còn bất kì gradient nào nữa (theo kì vọng), và quá trình huấn luyện cần phải dừng.</p>
</blockquote><p>Với cách hiểu về vai trò của pha dương và pha âm trong học máy, ta có thiết kế giải thuật ít tốn chi phí hơn giải thuật 18.1. Chi phí chủ yếu của giải thuật MCMC là chi phí của phép loại bỏ chuỗi Markov từ một khởi tạo ngẫu nhiên tại mỗi bước. Một giải pháp tự nhiên là khởi tạo chuỗi Markov từ một phân phối gần với phân phối của mô hình, như vậy quá trình loại bỏ chuỗi Markov ít tốn chi phí hơn.</p><hr><p>Giải thuật 18.2 Giải thuật phân kì tương phản, sử dụng kĩ thuật tối ưu đi ngược gradient</p><hr><p>Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">\epsilon</script></span>, kích cỡ của bước đi, là một số dương có giá trị nhỏ.<br>
Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">k</script></span>, số bước Gibbs, đủ lớn để chuỗi Markov xáo trộn khi được khởi tạo từ dữ liệu. Khoảng chừng 1-20 để huấn luyện mô hình RBM trên tập ảnh nhỏ<br>
<strong>while</strong> không hội tụ <strong>do</strong></p><ul>
<li>
<p>Lấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-880"><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-882"><span class="MJXp-mrow" id="MJXp-Span-883" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-884">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-885" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-886">(</span><span class="MJXp-mn" id="MJXp-Span-887">1</span><span class="MJXp-mo" id="MJXp-Span-888">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-894"><span class="MJXp-mrow" id="MJXp-Span-895" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-896">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-897" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-898">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">m</span><span class="MJXp-mo" id="MJXp-Span-900">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-66">\{\mathbf{x}^{(1)}, ..., \mathbf{x}^{(m)}\}</script></span> từ tập huấn luyện</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">g</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-905" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-906">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-908"><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">i</span><span class="MJXp-mo" id="MJXp-Span-912">=</span><span class="MJXp-mn" id="MJXp-Span-913">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-916"><span class="MJXp-mi" id="MJXp-Span-917" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-919">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-920">log</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-922"><span class="MJXp-mrow" id="MJXp-Span-923"><span class="MJXp-munderover" id="MJXp-Span-924"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mrow" id="MJXp-Span-929" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-930">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-931" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-932">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">i</span><span class="MJXp-mo" id="MJXp-Span-934">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-936">θ</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">g \leftarrow \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\mathbf{x}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">i</span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-941">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">i = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">m</script></span> do</p>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-944"><span class="MJXp-msubsup" id="MJXp-Span-945"><span class="MJXp-mrow" id="MJXp-Span-946" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-947"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-948"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-949">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-951" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-952">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">i</span><span class="MJXp-mo" id="MJXp-Span-954">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mrow" id="MJXp-Span-957" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-958">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-959" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-960">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">i</span><span class="MJXp-mo" id="MJXp-Span-962">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">\widetilde{\mathbf{x}}^{(i)} \leftarrow \mathbf{x}^{(i)}</script></span>.</li>
</ul>
</li>
<li>
<p><strong>end for</strong></p>
</li>
<li>
<p><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">i</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-966">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">i = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">k</script></span> <strong>do</strong></p>
<ul>
<li><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">j</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-972">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">j = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">m</script></span> <strong>do</strong>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-msubsup" id="MJXp-Span-976"><span class="MJXp-mrow" id="MJXp-Span-977" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-978"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-979"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-980">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-982" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-983">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">j</span><span class="MJXp-mo" id="MJXp-Span-985">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mtext" id="MJXp-Span-987">gibbs_update</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mrow" id="MJXp-Span-990" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-991"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-992"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-993">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-995" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-996">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">j</span><span class="MJXp-mo" id="MJXp-Span-998">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">\widetilde{\mathbf{x}}^{(j)} \leftarrow \text{gibbs_update}(\widetilde{\mathbf{x}}^{(j)})</script></span></li>
</ul>
</li>
<li><strong>end for</strong></li>
</ul>
</li>
<li>
<p><strong>end for</strong></p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1001">g</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1003">g</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1005" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1006">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1008"><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">i</span><span class="MJXp-mo" id="MJXp-Span-1012">=</span><span class="MJXp-mn" id="MJXp-Span-1013">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1016"><span class="MJXp-mi" id="MJXp-Span-1017" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1018" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1019">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-1020">log</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1022"><span class="MJXp-mrow" id="MJXp-Span-1023"><span class="MJXp-munderover" id="MJXp-Span-1024"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mrow" id="MJXp-Span-1029" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1030"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1032">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1034" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1035">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">i</span><span class="MJXp-mo" id="MJXp-Span-1037">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1039">θ</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">\boldsymbol{g} \leftarrow \boldsymbol{g} - \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\widetilde{\mathbf{x}}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1042">θ</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1044">θ</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1047">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} + \epsilon \boldsymbol{g}</script></span><br>
<strong>end while</strong></p>
</li>
</ul><hr><p>Giải thuật phân kì tương phản (CD, hoặc CD-k biểu thị CD với k bước Gibbs) khởi tạo chuỗi Markov tại mỗi bước với mẫu từ phân phối của tập dữ liệu (Hinton, 2000, 2010). Phương pháp này được mô tả như giải thuật 18.2. Lấy mẫu từ phân phối dữ liệu không tốn chi phí, vì chúng ta đã có sẵn tập dữ liệu. Ban đầu, phân phối của dữ liệu không giống với phân phối mô hình, vì thế pha âm không được tính chính xác. May mắn thay, pha dương có thể làm tăng xác suất dữ liệu của phân phối mô hình một cách chính xác. Sau một thời gian, phân phối mô hình tiến gần tới phân phối của dữ liệu, và pha âm trở nên chính xác hơn.</p><p>Dĩ nhiên, CD vẫn là một xấp xỉ của pha âm. Điều làm CD thất bại trong việc hiện thực pha âm một cách chính xác là nó thất bại trong việc ngăn chặn những vùng có xác suất cao khác xa với mẫu huấn luyện thực. Những vùng này có xác suất cao theo phân phối mô hình nhưng có xác suất thấp theo phân phối sinh dữ liệu nên được gọi là <strong>mode giả mạo</strong> . Hình 18.2 là một ví dụ. Về cơ bản, các mode trong phân phối mô hình cách xa với phân phối dữ liệu sẽ không được tiếp cận bởi các chuỗi Markov được khởi tạo từ các điểm huấn luyện, trừ khi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-78">k</script></span> rất lớn.</p><p><img src="https://i.imgur.com/h4xUKmy.jpg" alt=""></p><blockquote>
<p>Hình 18.2 Mode giả mạo. Một ví dụ về cách mà pha âm trong phân kì tương phản (giải thuật 18.2) thất bại trong việc ngăn chặn mode giả mạo. Mode giả mạo là mode hiện diện trong phân phối mô hình nhưng vắng mặt trong phân phối dữ liệu. Bởi vì phân kì tương phản khởi tạo các chuỗi Markov từ các điểm dữ liệu và chỉ chạy chuỗi Markov trong một vài bước, nó không có khả năng tiếp cận mode của mô hình ở cách xa các điểm dữ liệu. Điều này có nghĩa rằng, khi lấy mẫu từ phân phối mô hình, chúng ta thỉnh thoảng sẽ gặp những mẫu không giống với dữ liệu. Nó cũng có nghĩa là, do sự lãng phí hàm lượng xác suất vào các mode này, mô hình sẽ vật lộn trong việc đặt hàm lượng xác suất cao vào các mode thật sự. Để cho trực quan, hình này sử dụng khái niệm khoảng cách đã được đơn giản hóa - mode giả mạo cách xa mode thật sự dọc theo trục số thực trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mrow" id="MJXp-Span-1051"><span class="MJXp-mi undefined" id="MJXp-Span-1052">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">\mathbb{R}</script></span>. Với nhiều mô hình xác suất đa tầng, chuỗi Markov dựa vào phương thức lấy mẫu Gibbs và có thể dịch chuyển không cục bộ với từng biến đơn lẻ nhưng không thể dịch chuyển tất cả các biến một cách đồng thời. Với những trường hợp này, nên xem xét khoảng cách Levenshtein giữa các mode, hơn là khoảng cách Euclidean. Tuy nhiên khoảng cách Levenshtein trong không gian đa chiều khó được biểu diễn trên đồ thị 2-D.</p>
</blockquote><p>Carreira-Perpinan và Hinton (2005) bằng thực nghiệm đã chỉ ra rằng ước tính CD cho RBMs và các máy Boltzmann khả kiến đầy đủ bị chệch, tức là nó hội tụ vào những điểm khác với xấp xỉ hợp lý cực đại. Họ lập luận rằng vì độ chệch nhỏ nên CD có thể được xem như một cách ít tốn kém để khởi tạo mô hình mà sau này có thể được dùng để tinh chỉnh bằng các phương pháp MCMC tốn kém hơn. Bengio và Delalleau (2009) chứng minh rằng CD có thể được diễn giải như là sự loại bỏ những phần nhỏ nhất trong cập nhật gradient bằng MCMC, từ đó giải thích cho độ chệch này.</p><p>CD hữu dụng trong việc huấn luyện các mô hình nông như RBMs. Các mô hình này có thể được chồng lên nhau hình thành những mô hình đa tầng như DBNs hoặc DBMs. Tuy nhiên CD không có nhiều hữu ích trong việc huấn luyện trực tiếp những mô hình đa tầng này. Nguyên nhân là do việc lấy mẫu của các đơn vị ẩn khi đã biết mẫu của các đơn vị khả kiến gặp khó khăn. Vì các đơn vị ẩn không có trong dữ liệu, việc khởi tạo từ các điểm dữ liệu không thể giải quyết được vấn đề. Thậm chí nếu chúng ta khởi tạo các đơn vị khả kiến từ dữ liệu, ta cần phải áp dụng phép loại bỏ chuỗi Markov từ phân phối có điều kiện của các đơn vị ẩn khi biết các đơn vị khả kiến.</p><p>Giải thuật CD có thể được xem như một hình phạt dành cho mô hình khi chuỗi Markov làm thay đổi dữ liệu đầu vào quá nhanh. Trong một phạm trù nào đó, huấn luyện với CD khá giống với huấn luyện bộ tự mã hóa. Mặc dù CD có độ chệch cao so với một số mô hình huấn luyện khác, nó khá hữu ích trong việc tiền huấn luyện các mô hình nông trước khi xếp chồng lên để hình thành mô hình đa tầng. Nguyên nhân là do các mô hình nông ban đầu được khuyến khích sao chép nhiều thông tin vào các biến ẩn, do đó thông tin có thể được truyền đi khi chồng chúng lên thành mô hình đa tầng. Đây có thể được xem như cách tận dụng việc huấn luyện bằng CD hơn là lợi thế về thiết kế mô hình.</p><p>Sutskever và Tieleman (2010) chỉ ra rằng hướng cập nhật của CD không phải là gradient của bất kì hàm số nào. Điều này có thể dẫn đến trường hợp CD lặp theo chu kì vô tận, tuy nhiên trong thực tế điều này không quá nghiêm trọng.</p><p>Một chiến lược khác giúp giải quyết nhiều bài toán với CD là khởi tạo chuỗi Markov tại mỗi bước tính gradient bằng các trạng thái của bước tính gradient trước đó. Cách tiếp cận này được biết đến lần đầu tiên với tên gọi hợp lý cực đại ngẫu nhiên (SML) trong cộng đồng toán ứng dụng và thống kê (Younes, 1998) và sau này được phát hiện một cách độc lập với tên gọi phân kì tương phản liên tục (PCD, hoặc PCD-k biểu thị k bước Gibbs được sử dụng trong mỗi lần cập nhật) trong cộng đồng học sâu (Tieleman, 2008). Xem giải thuật 18.3. Ý tưởng cơ bản của phương pháp này là, miễn là mỗi bước cập nhật của giải thuật trượt gradient ngẫu nhiên có giá trị nhỏ, mô hình ở bước trước đó sẽ tương tự với mô hình ở bước hiện tại. Điều đó dẫn đến mẫu được lấy từ phân phối mô hình trước đó sẽ rất gần với mẫu được lấy từ phân phối mô hình hiện tại, do đó chuỗi Markov được khởi tạo với các mẫu này sẽ không tốn nhiều thời gian trộn.</p><p>Do mỗi chuỗi Markov được cập nhật xuyên suốt quá trình học, thay vì khởi động lại chuỗi tại mỗi bước tính đạo hàm, các chuỗi được tự do đi tìm mode của mô hình. SML do đó có tính đề kháng đối với việc hình thành những mô hình với các mode giả mạo hơn là CD. Hơn nữa, vì nó có khả năng lưu giữ trạng thái của những biến đã được lấy mẫu, dù là biến ẩn hay khả kiến, SML cung cấp điểm khởi tạo cho cả đơn vị ẩn và đơn vị khả kiến. CD chỉ có khả năng cung cấp điểm khởi tạo cho các đơn vị khả kiến, do đó cần áp dụng phương pháp loại bỏ cho các mô hình đa tầng. SML có thể huấn luyện các mô hình đa tầng một cách hiệu quả. Marlin và các cộng sự (2010) đã so sánh SML với nhiều phương pháp khác cũng được giới thiệu trong chương này. Họ nhận thấy SML cho kết quả tốt nhất trên logarit của hàm hợp lý đối với mô hình RBM và nếu các đơn vị ẩn của RBM được dùng làm đặc trưng cho bộ phân loại SVM, SML cũng cho ra kết quả phân loại tốt nhất.</p><hr><p>Giải thuật 18.3 Giải thuật hợp lý cực đại ngẫu nhiên/phân kì tương phản liên tục, sử dụng kĩ thuật tối ưu ngược gradient</p><hr><p>Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">\epsilon</script></span>, kích cỡ của bước đi, là một số dương có giá trị nhỏ.<br>
Đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">k</script></span>, số bước Gibbs, đủ lớn để chuỗi Markov được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">p</span><span class="MJXp-mrow" id="MJXp-Span-1059"><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1062">x</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1064">θ</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1067">g</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">p{(\mathbf{x}; \boldsymbol{\theta} + \epsilon \boldsymbol{g} )}</script></span> để loại bỏ, khi bắt đầu từ mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">p</span><span class="MJXp-mrow" id="MJXp-Span-1071"><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1074">x</span></span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1076">θ</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">p{(\mathbf{x};\boldsymbol{\theta})}</script></span>. Khoảng chừng 1 để huấn luyện mô hình RBM trên tập ảnh nhỏ, hoặc 5-50 cho mô hình phức tạp hơn như DBM.</p><p>Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1082"><span class="MJXp-mrow" id="MJXp-Span-1083" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1084"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1086">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1088" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1089">(</span><span class="MJXp-mn" id="MJXp-Span-1090">1</span><span class="MJXp-mo" id="MJXp-Span-1091">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1097"><span class="MJXp-mrow" id="MJXp-Span-1098" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1099"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1101">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1103" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1104">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">m</span><span class="MJXp-mo" id="MJXp-Span-1106">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">\{\widetilde{\mathbf{x}}^{(1)}, ..., \widetilde{\mathbf{x}}^{(m)}\}</script></span> có giá trị ngẫu nhiên (ví dụ, từ phân phối đều hoặc chuẩn, hoặc có thể từ một phân phối có biên phù hợp với biên của mô hình).</p><p><strong>while</strong> không hội tụ <strong>do</strong></p><ul>
<li>
<p>Lấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">m</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1110"><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1112"><span class="MJXp-mrow" id="MJXp-Span-1113" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1114">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1115" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1116">(</span><span class="MJXp-mn" id="MJXp-Span-1117">1</span><span class="MJXp-mo" id="MJXp-Span-1118">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1124"><span class="MJXp-mrow" id="MJXp-Span-1125" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1126">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1127" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1128">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">m</span><span class="MJXp-mo" id="MJXp-Span-1130">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">\{\mathbf{x}^{(1)}, ..., \mathbf{x}^{(m)}\}</script></span> từ tập huấn luyện</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">g</span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1135" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1136">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1138"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span><span class="MJXp-mo" id="MJXp-Span-1142">=</span><span class="MJXp-mn" id="MJXp-Span-1143">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi" id="MJXp-Span-1147" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1149">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-1150">log</span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1152"><span class="MJXp-mrow" id="MJXp-Span-1153"><span class="MJXp-munderover" id="MJXp-Span-1154"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1158"><span class="MJXp-mrow" id="MJXp-Span-1159" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-1160"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1161">x</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1162" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1163">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">i</span><span class="MJXp-mo" id="MJXp-Span-1165">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1167">θ</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">g \leftarrow \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}({\mathbf{x}}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">i</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1172">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">i = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">k</script></span> <strong>do</strong></p>
<ul>
<li><strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">j</span><span class="MJXp-mo" id="MJXp-Span-1177" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1178">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">j = 1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">m</script></span> <strong>do</strong>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mrow" id="MJXp-Span-1183" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1184"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1185"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1186">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1188" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1189">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">j</span><span class="MJXp-mo" id="MJXp-Span-1191">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mtext" id="MJXp-Span-1193">gibbs_update</span><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1195"><span class="MJXp-mrow" id="MJXp-Span-1196" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1197"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1199">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1201" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1202">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">j</span><span class="MJXp-mo" id="MJXp-Span-1204">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">\widetilde{\mathbf{x}}^{(j)} \leftarrow \text{gibbs_update}(\widetilde{\mathbf{x}}^{(j)})</script></span></li>
</ul>
</li>
<li><strong>end for</strong></li>
</ul>
</li>
<li>
<p><strong>end for</strong></p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1206"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1207">g</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1209">g</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1211" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1212">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1214"><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">i</span><span class="MJXp-mo" id="MJXp-Span-1218">=</span><span class="MJXp-mn" id="MJXp-Span-1219">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mi" id="MJXp-Span-1223" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1224" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1225">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-1226">log</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1228"><span class="MJXp-mrow" id="MJXp-Span-1229"><span class="MJXp-munderover" id="MJXp-Span-1230"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mrow" id="MJXp-Span-1235" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1236"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mrow" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1238">x</span></span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1240" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-1241">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">i</span><span class="MJXp-mo" id="MJXp-Span-1243">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1245">θ</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">\boldsymbol{g} \leftarrow \boldsymbol{g} - \frac{1}{m}\sum\nolimits_{i=1}^{m}\nabla_{\boldsymbol{\theta}}\log{\widetilde{p}(\widetilde{\mathbf{x}}^{(i)};\boldsymbol{\theta})}</script></span>.</p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1248">θ</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1250">θ</span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1253">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} + \epsilon \boldsymbol{g}</script></span><br>
<strong>end while</strong></p>
</li>
</ul><hr><p>SML trở nên thiếu chính xác khi giải thuật gradient ngẫu nhiên dịch chuyển mô hình nhanh hơn quá trình chuỗi Markov giữa các bước hòa trộn vào nhau. Điều này có thể xảy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">k</script></span> quá nhỏ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">\epsilon</script></span> quá lớn. Không may thay, khoảng giá trị cho phép phụ thuộc nhiều vào từng bài toán. Chúng ta chưa tìm ra cách nào để kiểm tra rằng chuỗi Markov xáo trộn thành công giữa các bước. Một cách chủ quan, nếu hệ số học quá cao so với số bước lấy mẫu Gibbs, người ta có thể quan sát được phương sai trong các mẫu pha âm thông qua các bước tính gradient hơn là thông qua các chuỗi Markov khác nhau. Ví dụ, một mô hình được huấn luyện trên tập MNIST có thể chỉ lấy mẫu các mẫu 7 trong một bước. Quá trình học khi đó sẽ đẩy xuống rất mạnh các mode tương ứng với mẫu 7, và mô hình có thể chỉ lấy mẫu các mẫu 9 trong bước tiếp theo.</p><p>Cần có sự chú ý khi đánh giá các mẫu từ mô hình đã huấn luyện với SML. Ta cần lấy mẫu từ một chuỗi Markov mới hoàn toàn được khởi tạo từ các điểm bắt đầu ngẫu nhiên sau khi mô hình đã huấn luyện xong. Các mẫu hiện diện trong các chuỗi âm liên tục được sử dụng cho huấn luyện chịu ảnh hưởng bởi các phiên bản trước của mô hình, do đó có thể làm cho mô hình có dung lượng lớn hơn dung lượng thật của nó.</p><p>Berglund và Raiko (2013) thực hiện các thí nghiệm để kiểm tra độ chệch và phương sai trong việc ước tính giá trị gradient của các giải thuật CD và SML. CD có phương sai thấp hơn bộ ước tính dựa vào các phương pháp lấy mẫu chính xác. Trong khi đó, SML có phương sai cao hơn. Nguyên nhân CD có phương sai thấp là do nó sử dụng cùng các điểm huấn luyện trong cả pha âm và dương. Nếu pha âm được khởi tạo từ các điểm huấn luyện khác, phương sai của CD sẽ tăng vượt cả phương pháp lấy mẫu chính xác.</p><p>Tất cả các phương pháp dựa vào MCMC để lấy mẫu từ các mô hình về nguyên tắc có thể được sử dụng với bất kì biến thể nào khác của MCMC. Điều đó có nghĩa là các kĩ thuật như SML có thể được cải thiện bằng cách dùng các phương pháp MCMC nâng cao được mô tả trong chương 17, chẳng hạn như điều hòa song song (Desjardins và cộng sự, 2010; Cho và cộng sự, 2010).</p><p>Một hướng tiếp cận để làm tăng tính xáo trộn trong quá trình học không dựa vào các kĩ thuật lấy mẫu Monte Carlo mà dựa vào sự thay đổi tham số của mô hình và hàm chi phí. Fast PCD, hoặc FPCD (Tieleman và Hinton, 2009) thay thế tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1259">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol{\theta}</script></span> của một mô hình truyền thống bằng biểu thức<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1260"><span class="MJXp-mtable" id="MJXp-Span-1261"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1262" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1263" style="text-align: right;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1264">θ</span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1267" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1268" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1269">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">h</span><span class="MJXp-mrow" id="MJXp-Span-1272"><span class="MJXp-mo" id="MJXp-Span-1273">ậ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">m</span><span class="MJXp-mo" id="MJXp-Span-1275">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1277"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1278" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1279" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1280">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">h</span><span class="MJXp-mo" id="MJXp-Span-1286">)</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">\begin{align}
\boldsymbol{\theta} = \boldsymbol{\theta}^{(chậm)} + \boldsymbol{\theta}^{(nhanh)} \tag{18.16}
\end{align}</script></span></p><p>Số lượng tham số nhiều gấp đôi lúc trước, và chúng được cộng vào nhau theo từng phần tử tạo nên các tham số trong định nghĩa gốc của mô hình. Bản sao nhanh của các tham số được huấn luyện với hệ số học lớn, cho phép mô hình thích nghi nhanh chóng với pha âm trong quá trình học và đẩy chuỗi Markov đến khu vực mới. Nó buộc chuỗi Markov xáo trộn nhanh, mặc dù hiệu ứng này chỉ xảy ra trong quá trình học khi các trọng số nhanh được tự do thay đổi. Thông thường ta áp dụng suy giảm trọng số cho các trọng số nhanh, khuyến khích chúng hội tụ về những giá trị nhỏ, ngay sau khi chúng nhận những giá trị lớn đủ lâu để khuyến khích chuỗi Markov thay đổi mode.</p><p>Một trong những lợi ích quan trọng của các phương pháp dựa vào MCMC được mô tả trong phần này là chúng cung cấp một ước lượng giá trị gradient của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1287"><span class="MJXp-mi" id="MJXp-Span-1288">log</span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\log{Z}</script></span>, từ đó ta có thể phân tách bài toán thành các thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mi" id="MJXp-Span-1293">log</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1295"><span class="MJXp-mrow" id="MJXp-Span-1296"><span class="MJXp-munderover" id="MJXp-Span-1297"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">p</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">\log{\widetilde{p}}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1300"><span class="MJXp-mi" id="MJXp-Span-1301">log</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">\log{Z}</script></span>. Sau đó, ta có thể dùng các phương pháp khác để tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1305"><span class="MJXp-mi" id="MJXp-Span-1306">log</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1308"><span class="MJXp-mrow" id="MJXp-Span-1309"><span class="MJXp-munderover" id="MJXp-Span-1310"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1313"><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">x</span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">\log{\widetilde{p}{(x)}}</script></span> và chỉ cần thêm vào phần gradient pha âm đã được xấp xỉ. Đặc biệt, điều này có nghĩa là pha dương có thể tận dụng các phương pháp chỉ cung cấp biên dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1317"><span class="MJXp-mrow" id="MJXp-Span-1318"><span class="MJXp-munderover" id="MJXp-Span-1319"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">\widetilde{p}</script></span>. Hầu hết các phương pháp khác nhằm tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1322"><span class="MJXp-mi" id="MJXp-Span-1323">log</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">\log{Z}</script></span> được giới thiệu trong chương này đều không phù hợp với phương pháp dựa trên biên của pha dương.<br>
------------------------<br>
<strong>Thăng Lê Cao kết thúc dịch ở đây</strong><br>
------------------------</p><p>------------------------<br>
<strong>Đức Thọ bắt đầu dịch từ đây</strong><br>
------------------------<br>
Trang 613-617</p><h1 id="183-Pseudolikelihood-Giả-hợp-lý"><strong>18.3. Pseudolikelihood (Giả hợp lý)</strong></h1><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1327"><span class="MJXp-mspace" id="MJXp-Span-1328" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\hspace{5mm}</script></span> Các phương pháp xấp xỉ Monte Carlo cho hàm phân hoạch và gradient của nó đối diện trực tiếp hàm phân hoạch. Các phương pháp tiếp cận khác né tránh giải quyết vấn đề này, bằng cách huấn luyện mô hình mà không cần tính toán hàm phân hoạch. Hầu hết các hướng tiếp cận này dựa trên quan sát rằng chúng ta có thể tính toán tỷ lệ các xác suất một cách dễ dàng trong mô hình xác suất vô hướng. Điều này là do hàm phân hoạch xuất hiện trong cả tử số và mẫu số triệt tiêu lẫn nhau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1329"><span class="MJXp-mtable" id="MJXp-Span-1330"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1331" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1332" style="text-align: right;"><span class="MJXp-mfrac" id="MJXp-Span-1333" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">p</span><span class="MJXp-mrow" id="MJXp-Span-1336"><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1338"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1339">x</span></span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">p</span><span class="MJXp-mrow" id="MJXp-Span-1343"><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1346">y</span></span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1349" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1350"><span class="MJXp-mfrac" id="MJXp-Span-1351" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1352">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">Z</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1354"><span class="MJXp-munderover" id="MJXp-Span-1355"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1358"><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1361">x</span></span><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1363"><span class="MJXp-mfrac" id="MJXp-Span-1364" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1365">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">Z</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1367"><span class="MJXp-munderover" id="MJXp-Span-1368"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1371"><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1373"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1374">y</span></span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1377" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1378"><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-munderover" id="MJXp-Span-1380"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1383"><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1385"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1386">x</span></span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1388"><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-munderover" id="MJXp-Span-1390"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1393"><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1395"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1396">y</span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-107">\begin{align}
\frac{{p\left( \mathbf{x} \right)}}{{p\left( \mathbf{y} \right)}} = \frac{{\frac{1}{Z}\tilde p\left( \mathbf{x} \right)}}{{\frac{1}{Z}\tilde p\left( \mathbf{y} \right)}} = \frac{{\tilde p\left( \mathbf{x} \right)}}{{\tilde p\left( \mathbf{y} \right)}} \tag{18.17}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1398"><span class="MJXp-mspace" id="MJXp-Span-1399" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">\hspace{5mm}</script></span> Giả hợp lý dựa trên quan sát rằng các xác suất có điều kiện có dạng tỉ số và do đó có thể ước tính được mà không cần biết hàm phân hoạch. Giả thiết rằng ta phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1400"><span class="MJXp-mrow" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1402">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">\mathbf{x}</script></span> thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1403"><span class="MJXp-mrow" id="MJXp-Span-1404"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1405">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\mathbf{a}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1406"><span class="MJXp-mrow" id="MJXp-Span-1407"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1408">b</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">\mathbf{b}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1409"><span class="MJXp-mrow" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1411">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">\mathbf{c}</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1412"><span class="MJXp-mrow" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1414">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">\mathbf{a}</script></span> chứa các biến ta muốn tìm phân phối có điều kiện, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1417">b</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">\mathbf{b}</script></span> chứa các biến điều kiện, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1420">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\mathbf{c}</script></span> chứa các biến không được quan tâm:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1421"><span class="MJXp-mtable" id="MJXp-Span-1422"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1423" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1424" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">p</span><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1428"><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1430">a</span></span><span class="MJXp-mrow" id="MJXp-Span-1431"><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mrow" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1434">b</span></span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1438" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">p</span><span class="MJXp-mrow" id="MJXp-Span-1441"><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1443"><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1445">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1447">b</span></span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">p</span><span class="MJXp-mrow" id="MJXp-Span-1451"><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1454">b</span></span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1457" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">p</span><span class="MJXp-mrow" id="MJXp-Span-1460"><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1462"><span class="MJXp-mrow" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1464">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1466">b</span></span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1468"><span class="MJXp-msubsup" id="MJXp-Span-1469"><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1471" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1473">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1474">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1475">c</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">p</span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1480"><span class="MJXp-mrow" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1482">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1483" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1484">b</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1486">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1489" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1490"><span class="MJXp-mrow" id="MJXp-Span-1491"><span class="MJXp-munderover" id="MJXp-Span-1492"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1495"><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1497"><span class="MJXp-mrow" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1499">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1500" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1501">b</span></span></span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1503"><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1508">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1509">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1510">c</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1511"><span class="MJXp-mrow" id="MJXp-Span-1512"><span class="MJXp-munderover" id="MJXp-Span-1513"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1516"><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1518"><span class="MJXp-mrow" id="MJXp-Span-1519"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1520">a</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1521" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1522">b</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1524">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-116">\begin{align}
p\left( {\mathbf{a}\left| \mathbf{b} \right.} \right) = \frac{{p\left( \mathbf{{a,b}} \right)}}{{p\left( \mathbf{b} \right)}} = \frac{{p\left( \mathbf{{a,b}} \right)}}{{\sum\nolimits_\mathbf{{a,c}} {p\left( \mathbf{{a,b,c}} \right)} }} = \frac{{\tilde p\left( \mathbf{{a,b}} \right)}}{{\sum\nolimits_\mathbf{{a,c}} {\tilde p\left( \mathbf{{a,b,c}} \right)} }} \tag{18.18}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1526"><span class="MJXp-mspace" id="MJXp-Span-1527" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">\hspace{5mm}</script></span> Đại lượng này đòi hỏi việc lấy xác suất biên của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1528"><span class="MJXp-mrow" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1530">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">\mathbf{a}</script></span>, có thể là một phép toán hiệu quả với điều kiện rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mrow" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1533">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">\mathbf{a}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1534"><span class="MJXp-mrow" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1536">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">\mathbf{c}</script></span> không chứa nhiều biến. Trong trường hợp tốt nhất, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1537"><span class="MJXp-mrow" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1539">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">\mathbf{a}</script></span> có thể là một biến riêng lẻ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1540"><span class="MJXp-mrow" id="MJXp-Span-1541"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1542">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">\mathbf{c}</script></span> là rỗng, phép toán này này đòi hỏi số lần đánh giá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mrow" id="MJXp-Span-1544"><span class="MJXp-munderover" id="MJXp-Span-1545"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">\tilde p</script></span> tương đương với số lượng giá trị của biến ngẫu nhiên đó.<br>
Thật không may, để tính toán logarit hàm hợp lý, ta cần lấy xác suất biên của một lượng lớn các biến. Nếu có tổng cộng <em>n</em> biến, ta phải lấy xác suất biên của một tập có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">n</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1551">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">n-1</script></span>. Theo quy tắc chuỗi xác suất,<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1552"><span class="MJXp-mtable" id="MJXp-Span-1553"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1554" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1555" style="text-align: right;"><span class="MJXp-mi" id="MJXp-Span-1556">log</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">p</span><span class="MJXp-mrow" id="MJXp-Span-1559"><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1561"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1562">x</span></span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1565">log</span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">p</span><span class="MJXp-mrow" id="MJXp-Span-1568"><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1570"><span class="MJXp-mrow" id="MJXp-Span-1571"><span class="MJXp-msubsup" id="MJXp-Span-1572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1574" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1577">log</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">p</span><span class="MJXp-mrow" id="MJXp-Span-1580"><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1582"><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1586" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1587"><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1589"><span class="MJXp-mrow" id="MJXp-Span-1590"><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1593" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">p</span><span class="MJXp-mrow" id="MJXp-Span-1600"><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1602"><span class="MJXp-mrow" id="MJXp-Span-1603"><span class="MJXp-msubsup" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1606" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1609"><span class="MJXp-mrow" id="MJXp-Span-1610"><span class="MJXp-msubsup" id="MJXp-Span-1611"><span class="MJXp-mrow" id="MJXp-Span-1612" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1613">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1615">1</span><span class="MJXp-mo" id="MJXp-Span-1616">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">n</span><span class="MJXp-mo" id="MJXp-Span-1618">−</span><span class="MJXp-mn" id="MJXp-Span-1619">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-125">\begin{align}
\log p\left( \mathbf{x} \right) = \log p\left( {{x_1}} \right) + \log p\left( {{x_2}\left| {{x_1}} \right.} \right) +  \ldots  + p\left( {{x_n}\left| {{\mathbf{x}_{1:n - 1}}} \right.} \right) \tag{18.19}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1622"><span class="MJXp-mspace" id="MJXp-Span-1623" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">\hspace{5mm}</script></span>Trong trường hợp này, ta cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1624"><span class="MJXp-mrow" id="MJXp-Span-1625"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1626">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">\mathbf{a}</script></span> nhỏ nhất có thể, nhưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1627"><span class="MJXp-mrow" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1629">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">\mathbf{c}</script></span> có thể lớn như trường  hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-mrow" id="MJXp-Span-1631"><span class="MJXp-msubsup" id="MJXp-Span-1632"><span class="MJXp-mrow" id="MJXp-Span-1633" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1634">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1635" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1636">2</span><span class="MJXp-mo" id="MJXp-Span-1637">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">n</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">{\mathbf{x}_{2:n}}</script></span>. Điều gì xảy ra nếu ta đơn giản chuyển <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mrow" id="MJXp-Span-1640"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1641">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\mathbf{c}</script></span> vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mrow" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1644">b</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">\mathbf{b}</script></span> nhằm giảm chi phí tính toán? Điều này dẫn đến hàm mục tiêu <strong>giả hợp lý</strong> (Besag, 1975), dựa trên việc dự đoán giá trị của đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1645"><span class="MJXp-msubsup" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1648" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">x_i</script></span> nếu cho trước tất cả các đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1649"><span class="MJXp-msubsup" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1652" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1653">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">x_{-i}</script></span> khác:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1655"><span class="MJXp-mtable" id="MJXp-Span-1656"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1657" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1658" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-1659"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665" style="margin-right: 0px; margin-left: 0px;">n</span></span><span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1661" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">i</span><span class="MJXp-mo" id="MJXp-Span-1663">=</span><span class="MJXp-mn" id="MJXp-Span-1664">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1666"><span class="MJXp-mi" id="MJXp-Span-1667">log</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">p</span><span class="MJXp-mrow" id="MJXp-Span-1670"><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1672"><span class="MJXp-mrow" id="MJXp-Span-1673"><span class="MJXp-msubsup" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1676" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1677"><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1679"><span class="MJXp-mrow" id="MJXp-Span-1680"><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1684">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-134">\begin{align}
\sum\limits_{i = 1}^n {\log p\left( {{x_i}\left| {{x_{ - i}}} \right.} \right)} \tag{18.20}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1688"><span class="MJXp-mspace" id="MJXp-Span-1689" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">\hspace{5mm}</script></span> Nếu mỗi biến ngẫu nhiên có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">k</script></span> giá trị khác nhau, ta chỉ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">k</span><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">k \times n</script></span> lần đánh giá giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1696"><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-munderover" id="MJXp-Span-1698"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">\tilde p</script></span> để ước tính, trái ngược với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1701"><span class="MJXp-msubsup" id="MJXp-Span-1702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1704" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">k^n</script></span> lần đánh giá cần thiết để ước tính hàm phân hoạch.<br>
Điều này trông giống như một mẹo nhỏ mà không dựa trên cơ sở lý thuyết nào, tuy nhiên ta có thể chứng minh rằng ước lượng thông qua cực đại hóa hàm giả hợp lý là tiệm cận sự ổn định (Mase, 1995). Dĩ nhiên, trong trường hợp tập dữ liệu không đạt tới giới hạn mẫu lớn, hàm giả hợp lý có thể biểu hiện các hành vi khác nhau từ bộ ước lượng hợp lý cực đại.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1705"><span class="MJXp-mspace" id="MJXp-Span-1706" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">\hspace{5mm}</script></span> Ta có thể đánh đổi độ phức tạp tính toán giá trị độ lệch từ kỹ thuật hợp lý cực đại bằng cách sử dụng <strong>bộ ước lượng giả hợp lý tổng quát</strong> (Huang và Ogata, 2002). Bộ ước lượng giả hợp lý tổng quát sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">m</script></span> tập khác nhau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1709"><span class="MJXp-mrow" id="MJXp-Span-1710"><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mrow" id="MJXp-Span-1712" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1713">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1714" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1715"><span class="MJXp-mo" id="MJXp-Span-1716">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">i</span><span class="MJXp-mo" id="MJXp-Span-1718">)</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">{\mathbb{S}^{\left( i \right)}}</script></span>,<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">i</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1722">1</span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">i = 1, \ldots ,m</script></span> biểu thị chỉ số các biến xuất hiện cùng nhau ở phía bên trái của thanh điều kiện. Trong trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">m</span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1730">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">m=1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1731"><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-msubsup" id="MJXp-Span-1733"><span class="MJXp-mrow" id="MJXp-Span-1734" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1735">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1736" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1737"><span class="MJXp-mo" id="MJXp-Span-1738">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">i</span><span class="MJXp-mo" id="MJXp-Span-1740">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">i</span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1744">1</span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">{\mathbb{S}^{\left( i \right)}},i = 1, \ldots ,n</script></span>, giả hợp lý tổng quát trở thành logarit hàm hợp lý. Trong trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">m</span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">m=n</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mrow" id="MJXp-Span-1754"><span class="MJXp-msubsup" id="MJXp-Span-1755"><span class="MJXp-mrow" id="MJXp-Span-1756" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1757">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1758" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1759"><span class="MJXp-mo" id="MJXp-Span-1760">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">i</span><span class="MJXp-mo" id="MJXp-Span-1762">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1764"><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">i</span><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0em; margin-right: 0em;">}</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">{\mathbb{S}^{\left( i \right)}} = \left\{ i \right\}</script></span>, giả hợp lý tổng quát trở thành hàm giả hợp lý. Hàm mục tiêu giả hợp lý tổng quát được cho bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1768"><span class="MJXp-mtable" id="MJXp-Span-1769"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1770" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1771" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-1772"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1774" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">i</span><span class="MJXp-mo" id="MJXp-Span-1776">=</span><span class="MJXp-mn" id="MJXp-Span-1777">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mi" id="MJXp-Span-1780">log</span><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">p</span><span class="MJXp-mrow" id="MJXp-Span-1783"><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1785"><span class="MJXp-mrow" id="MJXp-Span-1786"><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mrow" id="MJXp-Span-1788" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1789">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1790" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1791"><span class="MJXp-msubsup" id="MJXp-Span-1792"><span class="MJXp-mrow" id="MJXp-Span-1793" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1794">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1795" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1796"><span class="MJXp-mo" id="MJXp-Span-1797">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">i</span><span class="MJXp-mo" id="MJXp-Span-1799">)</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1800"><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1802"><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-msubsup" id="MJXp-Span-1804"><span class="MJXp-mrow" id="MJXp-Span-1805" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1806">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1807" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1808">−</span><span class="MJXp-mrow" id="MJXp-Span-1809"><span class="MJXp-msubsup" id="MJXp-Span-1810"><span class="MJXp-mrow" id="MJXp-Span-1811" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1812">S</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1813" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-1814"><span class="MJXp-mo" id="MJXp-Span-1815">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">i</span><span class="MJXp-mo" id="MJXp-Span-1817">)</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-148">\begin{align}
\sum\limits_{i = 1}^m {\log p\left( {{\mathbf{x}_{{\mathbb{S}^{\left( i \right)}}}}\left| {{\mathbf{x}_{ - {\mathbb{S}^{\left( i \right)}}}}} \right.} \right)} \tag{18.21}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1820"><span class="MJXp-mspace" id="MJXp-Span-1821" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">\hspace{5mm}</script></span>  Tính hiệu quả của phương pháp tiếp cận dựa trên giả hợp lý phụ thuộc nhiều vào cách mô hình được sử dụng. Giả hợp lý hoạt động kém hiệu quả trên các bài toán yêu cầu một mô hình tốt cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">p</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1825"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1826">x</span></span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">p(\mathbf{x})</script></span>, chẳng hạn như ước lượng mật độ và lấy mẫu. Nó có hiệu suất tốt hơn phương pháp hợp lý cực đại đối với các bài toán chỉ yêu cầu phân bố có điều kiện được sử dụng trong suốt quá trình huấn luyện, chẳng hạn như bài toán bổ sung một lượng nhỏ các giá trị thiếu hụt. Các kỹ thuật giả hợp lý tổng quát đặc biệt chiếm ưu thế nếu dữ liệu có cấu trúc thông thường cho phép ta thiết kế các tập chỉ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1828"><span class="MJXp-mrow" id="MJXp-Span-1829"><span class="MJXp-mi undefined" id="MJXp-Span-1830">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">\mathbb{S}</script></span> để lưu giữ những thông tin tương quan cần thiết trong khi loại bỏ nhóm các biến có độ tương quan không đáng kể. Ví dụ, trong các ảnh tự nhiên, các điểm ảnh cách xa nhau nhiều trong không gian có độ tương quan thấp, vì vậy phương pháp giả hợp lý tổng quát có thể được áp dụng với mỗi tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1831"><span class="MJXp-mrow" id="MJXp-Span-1832"><span class="MJXp-mi undefined" id="MJXp-Span-1833">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\mathbb{S}</script></span> là các ô cục bộ có kích thước nhỏ về mặt không gian.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1834"><span class="MJXp-mspace" id="MJXp-Span-1835" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">\hspace{5mm}</script></span> Một điểm yếu của phương pháp ước lượng giả hợp lý là nó không thể được sử dụng với các phương pháp xấp xỉ khác chỉ cung cấp một cận dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1836"><span class="MJXp-mrow" id="MJXp-Span-1837"><span class="MJXp-munderover" id="MJXp-Span-1838"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1842"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1843">x</span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">\tilde p(\mathbf{x})</script></span>, chẳng hạn như suy diễn biến phân, được mô tả trong chương 19. Nguyên nhân là do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1845"><span class="MJXp-mrow" id="MJXp-Span-1846"><span class="MJXp-munderover" id="MJXp-Span-1847"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">\tilde p</script></span> xuất hiện ở mẫu số. Một cận dưới của mẫu số tương ứng với một cận trên của toàn bộ biểu thức, và không có lợi ích gì khi cực đại hoá một cận trên. Điều này dẫn đến các hướng tiếp cận giả hợp lý khó được áp dụng cho các mô hình sâu như các máy Boltzmann đa tầng, vì các phương pháp biến phân là một trong các hướng tiếp cận nổi trội dùng để xấp xỉ việc lấy xác suất biên của nhiều lớp biến ẩn tương tác với nhau. Tuy nhiên, giả hợp lý vẫn có lợi ích trong học sâu, vì nó có thể được sử dụng để huấn luyện các mô hình đơn lớp hoặc các mô hình đa tầng sử dụng các phương pháp suy diễn xấp xỉ mà không dựa trên các cận dưới.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1850"><span class="MJXp-mspace" id="MJXp-Span-1851" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">\hspace{5mm}</script></span> Giả hợp lý có chi phí tính toán trên mỗi bước gradient lớn hơn so với SML, bởi nó đòi hỏi tính toán chi tiết tất cả các phân phối điều kiện. Nhưng giả hợp lý tổng quát và các tiêu chuẩn tương tự vẫn có thể thực hiện tốt nếu chỉ có một phân phối điều kiện chọn ngẫu nhiên được ước tính cho mỗi ví dụ (Goodfellow và cộng sự, 2013b), do đó mang lại chi phí tính toán thấp hơn ngang bằng với SML.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1852"><span class="MJXp-mspace" id="MJXp-Span-1853" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">\hspace{5mm}</script></span> Mặc dù phép ước lượng giả hợp lý không giảm thiểu hàm log Z một cách tường minh, nó vẫn có thể được xem như có một chút gì đó tương đồng với một pha âm. Các mẫu số của mỗi một phân phối có điều kiện dẫn đến việc giải thuật học tìm cách ngăn chặn xác suất của tất cả trạng thái mà chỉ có một biến khác với mẫu huấn luyện.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mspace" id="MJXp-Span-1855" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">\hspace{5mm}</script></span> Tham khảo Marlin và Freitas (2011) cho phân tích lý thuyết về độ tiệm cận sự hiệu quả của phương pháp giả hợp lý.</p><h1 id="184-So-sánh-theo-điểm-số-và-so-sánh-theo-tỉ-lệ"><strong>18.4. So sánh theo điểm số và so sánh theo tỉ lệ</strong></h1><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1856"><span class="MJXp-mspace" id="MJXp-Span-1857" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">\hspace{5mm}</script></span> So sánh theo điểm số (Hyvarinen, 2005) cung cấp một phương thức khác dùng để huấn luyện mô hình mà không cần ước tính <em>Z</em> và đạo hàm của nó. Cái tên <em>so sánh theo điểm số</em> bắt nguồn từ thuật ngữ đại diện cho đạo hàm của logarit hàm mật độ, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1858"><span class="MJXp-mrow" id="MJXp-Span-1859"><span class="MJXp-msubsup" id="MJXp-Span-1860"><span class="MJXp-mi" id="MJXp-Span-1861" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1862" style="vertical-align: -0.4em;">x</span></span></span><span class="MJXp-mi" id="MJXp-Span-1863">log</span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">p</span><span class="MJXp-mrow" id="MJXp-Span-1866"><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">x</span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">{\nabla _x}\log p\left( x \right)</script></span>, được gọi là <strong>điểm số</strong> của nó. Chiến lược được sử dụng bởi phương pháp so sánh theo điểm số là cực tiểu hóa sai khác bình phương kỳ vọng giữa đạo hàm của logarit hàm mật độ của mô hình theo biến đầu vào và đạo hàm của logarit hàm mật độ của dữ liệu theo biến đầu vào:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1920"><span class="MJXp-mtable" id="MJXp-Span-1921"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1922" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1923" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">L</span><span class="MJXp-mrow" id="MJXp-Span-1925"><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">x</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1930">θ</span></span><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1933" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1934">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1935">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mrow" id="MJXp-Span-1937" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mrow" id="MJXp-Span-1939"><span class="MJXp-mrow" id="MJXp-Span-1940"><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi" id="MJXp-Span-1942" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1943" style="vertical-align: -0.4em;">x</span></span></span><span class="MJXp-mi" id="MJXp-Span-1944">log</span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1946"><span class="MJXp-msubsup" id="MJXp-Span-1947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1949" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1950">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">l</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1953"><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">x</span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1958">θ</span></span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1960" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1962"><span class="MJXp-msubsup" id="MJXp-Span-1963"><span class="MJXp-mi" id="MJXp-Span-1964" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1965" style="vertical-align: -0.4em;">x</span></span></span><span class="MJXp-mi" id="MJXp-Span-1966">log</span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1968"><span class="MJXp-msubsup" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1971" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">a</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1976"><span class="MJXp-mo" id="MJXp-Span-1977" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">x</span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1980"><span class="MJXp-mo" id="MJXp-Span-1981" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1982"></span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0em;">‖</span></span></span><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-script-box" style="height: 2.2em; vertical-align: -0.98em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1986">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1985">2</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-161">\begin{align}
L\left( {x,\boldsymbol{\theta}} \right) = \frac{1}{2}\left\| {{\nabla _x}\log {p_{\bmod el}}\left( {x,\boldsymbol{\theta} } \right), - {\nabla _x}\log {p_{data}}\left( x \right)\left. {} \right\|} \right._2^2 \tag{18.22}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1987"><span class="MJXp-mtable" id="MJXp-Span-1988"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1989" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1990" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">J</span><span class="MJXp-mrow" id="MJXp-Span-1992"><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1994">θ</span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1997" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1998">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1999">2</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2000"><span class="MJXp-msubsup" id="MJXp-Span-2001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2003" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2004"><span class="MJXp-msubsup" id="MJXp-Span-2005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2007" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">a</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2012"><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">x</span><span class="MJXp-mo" id="MJXp-Span-2015" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">L</span><span class="MJXp-mrow" id="MJXp-Span-2017"><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">x</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2022">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-162">\begin{align}
J\left( \boldsymbol{\theta}  \right) = \frac{1}{2}{E_{{p_{data}}}}\left( x \right)L\left( {x,\boldsymbol{\theta} } \right) \tag{18.23}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2024"><span class="MJXp-mtable" id="MJXp-Span-2025"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2026" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2027" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-2028"><span class="MJXp-msubsup" id="MJXp-Span-2029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2030" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2031" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2033"><span><span class="MJXp-mrow" id="MJXp-Span-2034"><span class="MJXp-mo" id="MJXp-Span-2035" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036" style="margin-left: 0px;">θ</span></span></span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">J</span><span class="MJXp-mrow" id="MJXp-Span-2039"><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2041">θ</span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-163">\begin{align}
{\boldsymbol{\theta} ^*} = \mathop {\min }\limits_\theta  J\left( \boldsymbol{\theta}  \right)\tag{18.24}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2043"><span class="MJXp-mspace" id="MJXp-Span-2044" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">\hspace{5mm}</script></span> Hàm mục tiêu này tránh được những khó khăn trong việc lấy đạo hàm của hàm phân hoạch <em>Z</em> , bởi <em>Z</em> không phải là một hàm số theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">x</script></span> và do đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2047"><span class="MJXp-mrow" id="MJXp-Span-2048"><span class="MJXp-msubsup" id="MJXp-Span-2049"><span class="MJXp-mi" id="MJXp-Span-2050" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2051" style="vertical-align: -0.4em;">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">Z</span><span class="MJXp-mo" id="MJXp-Span-2053" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2054">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">{\nabla _x}Z = 0</script></span>. Ban đầu, phương pháp so sánh theo điểm số xuất hiện một khó khăn mới là: việc tính toán điểm số của phân phối dữ liệu yêu cầu kiến thức về phân phối thật sự tạo ra dữ liệu huấn luyện, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2055"><span class="MJXp-mrow" id="MJXp-Span-2056"><span class="MJXp-msubsup" id="MJXp-Span-2057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2059" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">a</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">{p_{data}}</script></span>. May mắn thay, việc cực tiểu hóa giá trị kỳ vọng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">L</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">x</span><span class="MJXp-mo" id="MJXp-Span-2068" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">θ</span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">L(x,\theta)</script></span> tương đương với việc cực tiểu giá trị kỳ vọng của<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2071"><span class="MJXp-mtable" id="MJXp-Span-2072"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2073" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2074" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-2075"><span class="MJXp-munderover" id="MJXp-Span-2076"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">L</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2079"><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">x</span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2084">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2086" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2087"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093" style="margin-right: 0px; margin-left: 0px;">n</span></span><span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2089" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">j</span><span class="MJXp-mo" id="MJXp-Span-2091">=</span><span class="MJXp-mn" id="MJXp-Span-2092">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2094"><span class="MJXp-mrow" id="MJXp-Span-2095"><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2097"><span class="MJXp-mfrac" id="MJXp-Span-2098" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2099"><span class="MJXp-mrow" id="MJXp-Span-2100"><span class="MJXp-msubsup" id="MJXp-Span-2101"><span class="MJXp-mi" id="MJXp-Span-2102" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2103" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2104"><span class="MJXp-mi" id="MJXp-Span-2105">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2109">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">j</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2110">log</span><span class="MJXp-mo" id="MJXp-Span-2111" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2112"><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2115" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">l</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2121"><span class="MJXp-mo" id="MJXp-Span-2122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">x</span><span class="MJXp-mo" id="MJXp-Span-2125" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2126">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2127" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2129" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2130">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2131">2</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2132"><span class="MJXp-mo" id="MJXp-Span-2133" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2134"><span class="MJXp-mfrac" id="MJXp-Span-2135" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2136">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2137"><span class="MJXp-mi" id="MJXp-Span-2138">∂</span><span class="MJXp-mrow" id="MJXp-Span-2139"><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2142" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2143">log</span><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2145"><span class="MJXp-msubsup" id="MJXp-Span-2146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">l</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2154"><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">x</span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2159">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2161" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2162" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-169">\begin{align}
\tilde L\left( {x,\boldsymbol{\theta} } \right) = \sum\limits_{j = 1}^n {\left( {\frac{{{\partial ^2}}}{{\partial x_j^2}}\log {p_{model}}\left( {x,\boldsymbol{\theta} } \right) + \frac{1}{2}\left( {\frac{\partial }{{\partial {x_j}}}\log {p_{model}}\left( {x,\boldsymbol{\theta} } \right)} \right)} \right)} \tag{18.25}
\end{align}</script></span><br>
trong đó <em>n</em> là số chiều của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">x</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2165"><span class="MJXp-mspace" id="MJXp-Span-2166" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\hspace{5mm}</script></span> Do phương pháp so sánh theo điểm số đòi hỏi phải tính đạo hàm theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">x</script></span>, nó không được áp dụng cho các mô hình dữ liệu rời rạc nhưng các biến ẩn trong mô hình có thể rời rạc.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2169"><span class="MJXp-mspace" id="MJXp-Span-2170" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">\hspace{5mm}</script></span> Giống như giả hợp lý, so sánh theo điểm số chỉ hoạt động khi có thể ước tính trực tiếp được hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2171"><span class="MJXp-mi" id="MJXp-Span-2172">log</span><span class="MJXp-mo" id="MJXp-Span-2173" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2174"><span class="MJXp-munderover" id="MJXp-Span-2175"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2178"><span class="MJXp-mo" id="MJXp-Span-2179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2180"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2181">x</span></span><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\log \tilde p\left(\mathbf{x} \right)</script></span> và các đạo hàm của nó. Nó không thích hợp với các phương pháp chỉ cung cấp một cận dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2183"><span class="MJXp-mi" id="MJXp-Span-2184">log</span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2186"><span class="MJXp-munderover" id="MJXp-Span-2187"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2190"><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2192"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2193">x</span></span><span class="MJXp-mo" id="MJXp-Span-2194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\log \tilde p\left(\mathbf{x} \right)</script></span>, bởi vì so sánh theo điểm số đòi hỏi các đạo hàm bậc nhất và đạo hàm bậc hai của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2195"><span class="MJXp-mi" id="MJXp-Span-2196">log</span><span class="MJXp-mo" id="MJXp-Span-2197" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2198"><span class="MJXp-munderover" id="MJXp-Span-2199"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">p</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2202"><span class="MJXp-mo" id="MJXp-Span-2203" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2204"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2205">x</span></span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">\log \tilde p\left(\mathbf{x} \right)</script></span>, nhưng một cận dưới lại không mang thông tin về các giá trị đạo hàm đó. Điều này có nghĩa rằng so sánh theo điểm số không được áp dụng để ước lượng các mô hình có các đơn vị ẩn tương tác phức tạp với nhau, ví dụ như các mô hình mã hóa rời rạc hoặc các máy Boltzmann đa tầng. Trong khi so sánh theo điểm số có thể được sử dụng nhằm tiền huấn luyện cho lớp ẩn đầu tiên trong một mô hình lớn, nó không được áp dụng như một chiến lược tiền huấn luyện cho các lớp sâu hơn bên dưới trong một mô hình lớn. Điều này nhiều khả năng là do các lớp ẩn của các mô hình như vậy thường chứa biến rời rạc.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2207"><span class="MJXp-mspace" id="MJXp-Span-2208" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">\hspace{5mm}</script></span> Trong khi so sánh theo điểm số không có một pha âm tường minh, nó có thể được xem như là một phiên bản của phân kỳ tương phản bằng cách sử dụng một chuỗi Markov đặc thù (Hyvarinen, 2007a). Chuỗi Markov trong trường hợp này không phải là lấy mẫu Gibbs, mà đúng hơn là một cách tiếp cận khác quyết định các bước dịch chuyển cục bộ dựa trên giá trị gradient. So sánh theo điểm số tương đương với CD với loại chuỗi Markov này khi kích thước của các bước dịch chuyển cục bộ tiến về 0.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2209"><span class="MJXp-mspace" id="MJXp-Span-2210" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">\hspace{5mm}</script></span> Lyu (2009) tổng quát phương pháp so sánh theo điểm số với trường hợp rời rạc (nhưng có lỗi trong phần tính đạo hàm đã được sửa chữa bởi Marlin và cộng sự [2010]). Marlin và cộng sự (2010) nhận thấy rằng <strong>so sánh theo điểm số dạng tổng quát</strong> (GSM) không hoạt động trong các không gian rời rạc đa chiều, khi xác suất quan sát được của nhiều sự kiện bằng 0.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2211"><span class="MJXp-mspace" id="MJXp-Span-2212" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">\hspace{5mm}</script></span> Một hướng tiếp cận thành công hơn nhằm mở rộng các ý tưởng cơ bản của phương pháp so sánh theo điểm số với dữ liệu rời rạc là <strong>so sánh theo tỷ lệ</strong> (Hyvarinen, 2007b). So sánh theo tỷ lệ áp dụng cụ thể cho dữ liệu nhị phân. So sánh theo tỷ lệ bao gồm việc cực tiểu hóa giá trị trung bình theo ví dụ của hàm mục tiêu sau đây:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2213"><span class="MJXp-mtable" id="MJXp-Span-2214"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2215" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2216" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-2217"><span class="MJXp-msubsup" id="MJXp-Span-2218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2220" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-2221"><span class="MJXp-mo" id="MJXp-Span-2222">(</span><span class="MJXp-mrow" id="MJXp-Span-2223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">M</span></span><span class="MJXp-mo" id="MJXp-Span-2226">)</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2227"><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2229"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2230">x</span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2232">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2233" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2235"><span class="MJXp-munderover" id="MJXp-Span-2236"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242" style="margin-right: 0px; margin-left: 0px;">n</span></span><span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2238" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">j</span><span class="MJXp-mo" id="MJXp-Span-2240">=</span><span class="MJXp-mn" id="MJXp-Span-2241">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2243"><span class="MJXp-mrow" id="MJXp-Span-2244" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-2245"><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.711em;"><span class="MJXp-right MJXp-scale2" style="font-size: 7.844em; margin-left: -0.25em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2247"><span class="MJXp-mfrac" id="MJXp-Span-2248" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2249">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2250"><span class="MJXp-mn" id="MJXp-Span-2251">1</span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2253" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2254"><span class="MJXp-mrow" id="MJXp-Span-2255"><span class="MJXp-msubsup" id="MJXp-Span-2256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2258" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">l</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2264"><span class="MJXp-mo" id="MJXp-Span-2265">(</span><span class="MJXp-mrow" id="MJXp-Span-2266"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2267">x</span><span class="MJXp-mo" id="MJXp-Span-2268">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2269">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2270">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2271"><span class="MJXp-mrow" id="MJXp-Span-2272"><span class="MJXp-msubsup" id="MJXp-Span-2273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2275" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">l</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2281"><span class="MJXp-mo" id="MJXp-Span-2282">(</span><span class="MJXp-mrow" id="MJXp-Span-2283"><span class="MJXp-mrow" id="MJXp-Span-2284"><span class="MJXp-mo" id="MJXp-Span-2285">(</span><span class="MJXp-mrow" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">f</span><span class="MJXp-mrow" id="MJXp-Span-2288"><span class="MJXp-mo" id="MJXp-Span-2289">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2290">x</span><span class="MJXp-mo" id="MJXp-Span-2291">)</span></span><span class="MJXp-mo" id="MJXp-Span-2292">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">j</span></span><span class="MJXp-mo" id="MJXp-Span-2294">)</span></span><span class="MJXp-mo" id="MJXp-Span-2295">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2296">θ</span></span><span class="MJXp-mo" id="MJXp-Span-2297">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.711em;"><span class="MJXp-right MJXp-scale2" style="font-size: 7.844em; margin-left: -0.25em;">)</span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2299" style="vertical-align: 1.2em;">2</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-180">\begin{align}
{L^{\left( {RM} \right)}}\left( {\boldsymbol{x},\boldsymbol{\theta}} \right) = {\sum\limits_{j = 1}^n {\left( {\frac{1}{{1 + \frac{{{p_{model}}\left( {\boldsymbol{x},\boldsymbol{\theta} } \right)}}{{{p_{model}}\left( {\left( {f\left( \boldsymbol{x} \right),j} \right);\boldsymbol{\theta} } \right)}}}}} \right)} ^2}\tag{18.26}
\end{align}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">f</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2303">x</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">j</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">f(\boldsymbol{x},j)</script></span> trả về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2307"><span class="MJXp-mrow" id="MJXp-Span-2308"><span class="MJXp-mi undefined" id="MJXp-Span-2309">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">\mathbb{x}</script></span> với bit tại vị trí <em>j</em> bị đảo ngược. So sánh theo tỷ lệ tránh hàm phân hoạch bằng cách sử dụng cùng một thủ thuật của ước lượng giả hợp lý: trong tỷ lệ giữa hai xác suất, hàm phân hoạch triệt tiêu lẫn nhau. Marlin và cộng sự (2010) phát hiện rằng so sánh theo tỷ lệ có hiệu suất tốt hơn SML, giả hợp lý và GSM xét theo khả năng làm giảm nhiễu từ tập ảnh kiểm thử của các mô hình đã được huấn luyện.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2310"><span class="MJXp-mspace" id="MJXp-Span-2311" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">\hspace{5mm}</script></span> Giống như phép ước lượng giả hợp lý, so sánh theo tỷ lệ đòi hỏi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">n</script></span> ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2314"><span class="MJXp-mrow" id="MJXp-Span-2315"><span class="MJXp-munderover" id="MJXp-Span-2316"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2318" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">\tilde p</script></span> trên mỗi điểm dữ liệu, làm cho chi phí tính toán trên mỗi lần cập nhật cao gấp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">n</script></span> lần so với SML.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2321"><span class="MJXp-mspace" id="MJXp-Span-2322" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">\hspace{5mm}</script></span> Cũng như với phép ước lượng giả hợp lý, so sánh theo tỷ có thể được xem như là đẩy xuống tất cả các trạng thái tưởng tựợng mà chỉ có một biến khác với ví dụ huấn luyện. Bởi vì so sánh theo tỷ lệ áp dụng cụ thể cho dữ liệu nhị phân, điều này có nghĩa rằng nó có tác dụng trên tất cả trạng thái tưởng tượng có khoảng cách Hamming 1 so với dữ liệu.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2323"><span class="MJXp-mspace" id="MJXp-Span-2324" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\hspace{5mm}</script></span> So sánh theo tỷ lệ có thể hữu ích khi là cơ sở để xử lý dữ liệu thưa, nhiều chiều như các vector đếm từ. Kiểu dữ liệu này đặt ra một thách thức cho các phương pháp dựa trên MCMC vì dữ liệu này cực kỳ tốn kém để biểu diễn ở định dạng dày đặc, nhưng bộ lấy mẫu MCMC vẫn chưa lấy được các mẫu thưa cho tới khi mô hình học được cách biểu diễn sự thưa thớt trong phân phối dữ liệu. Dauphin và Bengio (2013) đã khắc phục vấn đề này bằng cách thiết kế một phép xấp xỉ ngẫu nhiên không chệch cho so sánh theo tỷ lệ. Phép xấp xỉ này chỉ đánh giá một tập con được chọn ngẫu nhiên từ các phần của hàm mục tiêu và không đòi hỏi mô hình sinh các mẫu tưởng tượng hoàn chỉnh.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2325"><span class="MJXp-mspace" id="MJXp-Span-2326" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">\hspace{5mm}</script></span> Tham khảo Marlin và De Freitas (2011) cho phân tích lý thuyết về độ tiệm cận của sự hiệu quả của so sánh theo tỷ lệ.</p><h1 id="185Giảm-nhiễu-so-sánh-theo-điểm-số"><strong>18.5.Giảm nhiễu so sánh theo điểm số</strong></h1><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2327"><span class="MJXp-mspace" id="MJXp-Span-2328" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">\hspace{5mm}</script></span> Trong một số trường hợp, ta có thể chính quy hoá so sánh theo điểm số, bằng cách điều chỉnh phân phối<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2329"><span class="MJXp-mtable" id="MJXp-Span-2330"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2331" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2332" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-2333"><span class="MJXp-msubsup" id="MJXp-Span-2334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2336" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344">d</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2345"><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">x</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mrow" id="MJXp-Span-2351"><span class="MJXp-mrow" id="MJXp-Span-2352"><span class="MJXp-msubsup" id="MJXp-Span-2353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2355" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">a</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2360"><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">y</span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">q</span><span class="MJXp-mrow" id="MJXp-Span-2365"><span class="MJXp-mo" id="MJXp-Span-2366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2367"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2368">x</span><span class="MJXp-mrow" id="MJXp-Span-2369"><span class="MJXp-mo" id="MJXp-Span-2370" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2371">y</span><span class="MJXp-mo" id="MJXp-Span-2372" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">y</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-191">\begin{align}
{p_{smoothed}}\left( x \right) = \int {{p_{data}}\left( y \right)q\left( {\boldsymbol{x}\left|\boldsymbol{y} \right.} \right)dy} \tag{18.27}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mspace" id="MJXp-Span-2377" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">\hspace{5mm}</script></span> hơn là phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-msubsup" id="MJXp-Span-2379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2381" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">a</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">p_{data}</script></span> đúng. Phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-mrow" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">q</span><span class="MJXp-mrow" id="MJXp-Span-2389"><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">x</span><span class="MJXp-mrow" id="MJXp-Span-2393"><span class="MJXp-mo" id="MJXp-Span-2394" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">y</span><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0em; margin-right: 0em;"></span></span></span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">{q\left( {x\left| y \right.} \right)}</script></span> là một quá trình sai lệch, thường tạo ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">x</script></span> bằng cách thêm một lượng nhiễu nhỏ vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">y</script></span>.<br>
-----------------------<br>
<strong>Đức Thọ kết thúc dịch ở đây</strong><br>
--------------------------</p><p>------------------------<br>
<strong>Hiếu NP bắt đầu dịch từ đây</strong><br>
------------------------<br>
Trang 618-622</p><p>Kỹ thuật giảm nhiễu so sánh theo điểm số đặc biệt hữu ích vì trong thực tiễn, ta thường không tiếp cận được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-mrow" id="MJXp-Span-2403"><span class="MJXp-msubsup" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2406" style="vertical-align: -0.4em;">data</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">{p_\text{data}}</script></span> đúng mà chỉ biết một phân phối thực nghiệm được xác định từ các mẫu của nó. Bất kỳ ước lượng tin cậy nào, nếu có đủ công suất, sẽ biến đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2407"><span class="MJXp-mrow" id="MJXp-Span-2408"><span class="MJXp-msubsup" id="MJXp-Span-2409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2411" style="vertical-align: -0.4em;">model</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">{p_\text{model}}</script></span> thành một tập các phân phối Dirac tập trung vào các điểm huấn luyện. Việc làm mịn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mrow" id="MJXp-Span-2413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">q</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">{q}</script></span> giúp giảm thiểu vấn đề này, khi mất đi thuộc tính tin cậy tiệm cận được mô tả trong phần 5.4.5. Kingma và LeCun (2010) đã giới thiệu một quy trình thực hiện so sánh theo điểm số được chính quy hoá, với phân phối mịn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2415"><span class="MJXp-mrow" id="MJXp-Span-2416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">q</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">{q}</script></span> là nhiễu có phân phối chuẩn.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2418"><span class="MJXp-mspace" id="MJXp-Span-2419" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-201">\hspace{5mm}</script></span> Phần 14.5.1 cho thấy một số thuật toán huấn luyện bộ tự mã hoá tương đương với kỹ thuật so sánh điểm số hoặc giảm nhiễu so sánh điểm số. Những thuật toán huấn luyện bộ tự mã hoá này vì vậy là một cách để khắc phục vấn đề hàm phân hoạch.</p><h1 id="186-Ước-lượng-tương-phản-nhiễu"><strong>18.6. Ước lượng tương phản nhiễu</strong></h1><p>Hầu hết các kỹ thuật ước lượng mô hình với hàm phân hoạch khó tính toán không cung cấp ước lượng của hàm phân hoạch. SML và CD chỉ ước tính gradient của logarit hàm phân hoạch, thay vì chính hàm phân hoạch. So sánh điểm số và giả hợp lý tránh việc ước tính các đại lượng có liên quan đến hàm phân hoạch.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2420"><span class="MJXp-mspace" id="MJXp-Span-2421" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">\hspace{5mm}</script></span><strong>Ước lượng tương phản nhiễu</strong> (NCE) (Gutmann and Hyvarinen, 2010) đi theo một chiến lược khác. Theo đó, phân phối xác suất được ước lượng từ mô hình được biểu diễn tường minh như sau</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2422"><span class="MJXp-mtable" id="MJXp-Span-2423"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2424" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2425" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-2426"><span class="MJXp-mi" id="MJXp-Span-2427">log</span><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2431" style="vertical-align: -0.4em;">model</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2432"><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2434"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2435">x</span></span><span class="MJXp-mo" id="MJXp-Span-2436" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2438">log</span><span class="MJXp-mo" id="MJXp-Span-2439" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2440"><span class="MJXp-msubsup" id="MJXp-Span-2441"><span class="MJXp-mrow" id="MJXp-Span-2442" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2443"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">p</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2446" style="vertical-align: -0.4em;">model</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2447"><span class="MJXp-mo" id="MJXp-Span-2448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2449"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2450">x</span></span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">θ</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2454" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">c</span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-203">\begin{align}
{\log p_\text{model}} \left( \textbf{x} \right) = \log {\widetilde{p}_\text{model}} \left( \textbf{x};\theta \right) + c, \tag{18.28}
\end{align}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2457"><span class="MJXp-mrow" id="MJXp-Span-2458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">{c}</script></span> là một xấp xỉ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-mrow" id="MJXp-Span-2461"><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-2463">log</span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">Z</span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">θ</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">{-\log{Z (\theta)}}</script></span>. Thay vì chỉ ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2470"><span class="MJXp-mrow" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">θ</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">{\theta}</script></span>, ước lượng tương phản nhiễu xem <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2473"><span class="MJXp-mrow" id="MJXp-Span-2474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">{c}</script></span> như là một tham số khác và ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2476"><span class="MJXp-mrow" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">θ</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">{\theta}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mrow" id="MJXp-Span-2480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">{c}</script></span> một cách đồng thời, sử dụng cùng một thuật toán cho cả hai. Kết quả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2482"><span class="MJXp-mrow" id="MJXp-Span-2483"><span class="MJXp-mi" id="MJXp-Span-2484">log</span><span class="MJXp-mo" id="MJXp-Span-2485" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2488" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2489">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-2490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2491"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2492">x</span></span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">{\log p_{\text{model}}(\textbf{x})}</script></span> vì vậy có thể không phản ánh chính xác một phân phối xác suất đúng đắn, nhưng nó sẽ càng lúc càng gần hơn một kết quả hợp lệ khi ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2494"><span class="MJXp-mrow" id="MJXp-Span-2495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">{c}</script></span> được cải thiện.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2497"><span class="MJXp-mspace" id="MJXp-Span-2498" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">\hspace{5mm}</script></span> Hướng tiếp cận như vậy sẽ không thể lấy phương pháp cực đại hóa hàm hợp lý làm tiêu chuẩn cho việc ước lượng. Tiêu chuẩn hợp lý cực đại sẽ chọn giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">c</script></span> cao tuỳ ý, thay vì chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">c</script></span> để đạt được một phân phối xác suất hợp lệ.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2503"><span class="MJXp-mspace" id="MJXp-Span-2504" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">\hspace{5mm}</script></span> NCE hoạt động bằng cách thu giảm bài toán học không giám sát để ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506">p</span><span class="MJXp-mo" id="MJXp-Span-2507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2508"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2509">x</span></span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">p(\textbf{x})</script></span> thành việc học một bộ phân loại nhị phân xác suất, mà ở đó một trong các phạm trù tương ứng với dữ liệu được sinh ra bởi mô hình. Bài toán học có giám sát này được xây dựng theo cách mà phương pháp ước lượng hợp lý cực đại định nghĩa một ước lượng tin cậy tiệm cận của bài toán ban đầu.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2511"><span class="MJXp-mspace" id="MJXp-Span-2512" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">\hspace{5mm}</script></span>Cụ thể, ta giới thiệu phân phối thứ hai, <strong>phân phối nhiễu</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-msubsup" id="MJXp-Span-2514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2516" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2517">noise</span></span></span><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2519"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2520">x</span></span><span class="MJXp-mo" id="MJXp-Span-2521" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">p_{\text{noise}}(\textbf{x})</script></span>. Phân phối nhiễu cần phải tính toán được để đánh giá và lấy mẫu. Bây giờ ta có thể xây dựng một mô hình trên cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2522"><span class="MJXp-mrow" id="MJXp-Span-2523"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2524">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\textbf{x}</script></span> và một biến nhị phân mới, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">y</script></span>. Trong mô hình chung sau đó, ta xác định rằng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2527"><span class="MJXp-mtable" id="MJXp-Span-2528"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2529" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2530" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-2531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2533" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">y</span><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2537">1</span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2539" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2540" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2541">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2542">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2543" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2544" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2545" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-2546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2548" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2550"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2551">x</span></span><span class="MJXp-mrow" id="MJXp-Span-2552"><span class="MJXp-mo" id="MJXp-Span-2553" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">y</span><span class="MJXp-mo" id="MJXp-Span-2555" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2556">1</span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2561" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2563"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2564">x</span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-221">\begin{align}
p_\text{joint}(y=1) = \frac{1}{2}, \tag{18.29} \\
p_\text{joint}(\textbf{x}|y=1) = p_\text{model} (\textbf{x}), \tag{18.30}
\end{align}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2567"><span class="MJXp-mspace" id="MJXp-Span-2568" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">\hspace{5mm}</script></span> và<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2569"><span class="MJXp-mtable" id="MJXp-Span-2570"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2571" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2572" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2575" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2577"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2578">x</span></span><span class="MJXp-mrow" id="MJXp-Span-2579"><span class="MJXp-mo" id="MJXp-Span-2580" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581">y</span><span class="MJXp-mo" id="MJXp-Span-2582" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2583">0</span><span class="MJXp-mo" id="MJXp-Span-2584" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2585" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2588" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2590"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2591">x</span></span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2593" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">p_\text{joint}(\textbf{x}|y=0) = p_\text{noise} (\textbf{x}). \tag{18.31}</script></span></p><p>Nói cách khác, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">y</script></span> là một biến chuyển đổi xác định xem chúng ta sẽ sinh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2596"><span class="MJXp-mrow" id="MJXp-Span-2597"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2598">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">\textbf{x}</script></span> từ mô hình hay từ phân phối nhiễu.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2599"><span class="MJXp-mspace" id="MJXp-Span-2600" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">\hspace{5mm}</script></span>Ta có thể xây dựng một mô hình chung tương tự cho dữ liệu huấn luyện. Trong trường hợp này, biến chuyển đổi sẽ xác định xem ta lấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2601"><span class="MJXp-mrow" id="MJXp-Span-2602"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2603">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\textbf{x}</script></span> từ <strong>dữ liệu</strong> hay từ phân phối nhiễu. Một cách tổng quát, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2604"><span class="MJXp-msubsup" id="MJXp-Span-2605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2607" style="vertical-align: -0.4em;">train</span></span><span class="MJXp-mo" id="MJXp-Span-2608" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">y</span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2611">1</span><span class="MJXp-mo" id="MJXp-Span-2612" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2613" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2614" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2615">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2616">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">p_\text{train} (y = 1) = \frac{1}{2}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2617"><span class="MJXp-msubsup" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2620" style="vertical-align: -0.4em;">train</span></span><span class="MJXp-mo" id="MJXp-Span-2621" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2622">x</span><span class="MJXp-mrow" id="MJXp-Span-2623"><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">y</span><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2627">1</span><span class="MJXp-mo" id="MJXp-Span-2628" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2632" style="vertical-align: -0.4em;">data</span></span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2634">x</span><span class="MJXp-mo" id="MJXp-Span-2635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">p_\text{train} (\text{x} | y = 1) = p_\text{data} (\text{x})</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2636"><span class="MJXp-msubsup" id="MJXp-Span-2637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2639" style="vertical-align: -0.4em;">train</span></span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2641">x</span><span class="MJXp-mrow" id="MJXp-Span-2642"><span class="MJXp-mo" id="MJXp-Span-2643" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644">y</span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2646">0</span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2648" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2651" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2653">x</span><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">p_\text{train} (\text{x} | y = 0) = p_\text{noise} (\text{x})</script></span>.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2655"><span class="MJXp-mspace" id="MJXp-Span-2656" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">\hspace{5mm}</script></span>Bây giờ ta chỉ cần sử dụng phương pháp học bằng hợp lý cực đại để giải quyết bài toán học <strong>có giám sát</strong>, điều chỉnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2657"><span class="MJXp-msubsup" id="MJXp-Span-2658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2660" style="vertical-align: -0.4em;">joint</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">p_\text{joint}</script></span> cho phù hợp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2661"><span class="MJXp-msubsup" id="MJXp-Span-2662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2664" style="vertical-align: -0.4em;">train</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">p_\text{train}</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2665"><span class="MJXp-mtable" id="MJXp-Span-2666"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2667" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2668" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">θ</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">c</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munder" id="MJXp-Span-2673"><span><span class="MJXp-mrow" id="MJXp-Span-2674"><span class="MJXp-mi" id="MJXp-Span-2675">a</span><span class="MJXp-mi" id="MJXp-Span-2676">r</span><span class="MJXp-mi" id="MJXp-Span-2677">g</span><span class="MJXp-mi" id="MJXp-Span-2678">m</span><span class="MJXp-mi" id="MJXp-Span-2679">a</span><span class="MJXp-mi" id="MJXp-Span-2680">x</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2681" style="margin-left: 0px;">θ</span><span class="MJXp-mo" id="MJXp-Span-2682">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">c</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2684">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2685"><span class="MJXp-mrow" id="MJXp-Span-2686" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2687">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2688" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2689"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2690">x</span></span><span class="MJXp-mo" id="MJXp-Span-2691">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692">y</span><span class="MJXp-mo" id="MJXp-Span-2693">∼</span><span class="MJXp-msubsup" id="MJXp-Span-2694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2696" style="vertical-align: -0.4em;">train</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2697">log</span><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2701" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703">y</span><span class="MJXp-mrow" id="MJXp-Span-2704"><span class="MJXp-mo" id="MJXp-Span-2705" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2706"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2707">x</span></span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2709" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-234">\begin{align}
\theta, c = \underset{\theta,c}{\mathrm{argmax}}\text{   } \mathbb{E}_{\textbf{x},y \sim p_\text{train}} \log p_\text{joint}(y | \textbf{x}). \tag{18.32}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2710"><span class="MJXp-mspace" id="MJXp-Span-2711" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">\hspace{5mm}</script></span>Phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2712"><span class="MJXp-msubsup" id="MJXp-Span-2713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2714" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2715" style="vertical-align: -0.4em;">joint</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">p_\text{joint}</script></span> về cơ bản là một mô hình hồi quy logit được áp dụng trên sự chênh lệch của các logarit xác suất của mô hình và phân phối nhiễu:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2716"><span class="MJXp-mtable" id="MJXp-Span-2717"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2718" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2719" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-2720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2722" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">y</span><span class="MJXp-mo" id="MJXp-Span-2725" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2726">1</span><span class="MJXp-mrow" id="MJXp-Span-2727"><span class="MJXp-mo" id="MJXp-Span-2728" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2729"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2730">x</span></span><span class="MJXp-mo" id="MJXp-Span-2731" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2732" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2733"></span><span class="MJXp-mo" id="MJXp-Span-2734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2735" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2738" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2739" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2740"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2741">x</span></span><span class="MJXp-mo" id="MJXp-Span-2742" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2745" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2746" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2747"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2748">x</span></span><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2750" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2753" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2754" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2755"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2756">x</span></span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2758" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2759" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2760" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2761"></span><span class="MJXp-mo" id="MJXp-Span-2762" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2763" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2764">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2765">1</span><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2767" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2770" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2771">(</span><span class="MJXp-mrow" id="MJXp-Span-2772"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2773">x</span></span><span class="MJXp-mo" id="MJXp-Span-2774">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2776" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2777" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2778">(</span><span class="MJXp-mrow" id="MJXp-Span-2779"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2780">x</span></span><span class="MJXp-mo" id="MJXp-Span-2781">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2782" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2783" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2784" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2785"></span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2787" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2788">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2789">1</span><span class="MJXp-mo" id="MJXp-Span-2790" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-2791">exp</span><span class="MJXp-mo" id="MJXp-Span-2792" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2793"><span class="MJXp-mrow" id="MJXp-Span-2794"><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-mi" id="MJXp-Span-2796">log</span><span class="MJXp-mo" id="MJXp-Span-2797" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-2798" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2800" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2801" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2802">(</span><span class="MJXp-mrow" id="MJXp-Span-2803"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2804">x</span></span><span class="MJXp-mo" id="MJXp-Span-2805">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2808" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2809">(</span><span class="MJXp-mrow" id="MJXp-Span-2810"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2811">x</span></span><span class="MJXp-mo" id="MJXp-Span-2812">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2813" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2814" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2815" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2816" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2817"></span><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">σ</span><span class="MJXp-mrow" id="MJXp-Span-2820"><span class="MJXp-mo" id="MJXp-Span-2821" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">(</span></span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-2823">log</span><span class="MJXp-mo" id="MJXp-Span-2824" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-2825" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2828" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2830"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2831">x</span></span><span class="MJXp-mo" id="MJXp-Span-2832" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2835" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2837"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2838">x</span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">)</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2841" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2842" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2843" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2844"></span><span class="MJXp-mo" id="MJXp-Span-2845" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">σ</span><span class="MJXp-mo" id="MJXp-Span-2847" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-2848">log</span><span class="MJXp-mo" id="MJXp-Span-2849" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2852" style="vertical-align: -0.4em;">model</span></span><span class="MJXp-mo" id="MJXp-Span-2853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2854"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2855">x</span></span><span class="MJXp-mo" id="MJXp-Span-2856" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2857" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2860" style="vertical-align: -0.4em;">noise</span></span><span class="MJXp-mo" id="MJXp-Span-2861" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2862"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2863">x</span></span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2866" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-237">\begin{align}
p_\text{joint}(y=1|\textbf{x}) &= \frac{p_\text{model}(\textbf{x})}{p_\text{model}(\textbf{x})+p_\text{noise}(\textbf{x})}\tag{18.33} \\
&= \frac{1}{1+\frac{p_\text{noise}(\textbf{x})}{p_\text{model}(\textbf{x})}} \tag{18.34} \\
&= \frac{1}{1+\exp{\left(\log \frac{p_\text{noise}(\textbf{x})}{p_\text{model}(\textbf{x})}\right) }} \tag{18.35} \\
&=\sigma \left( - \log \frac{p_\text{noise}(\textbf{x})}{p_\text{model}(\textbf{x})}\right) \tag{18.36} \\
&= \sigma (\log p_\text{model}(\textbf{x})-p_\text{noise}(\textbf{x})). \tag{18.37}
\end{align}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2867"><span class="MJXp-mspace" id="MJXp-Span-2868" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">\hspace{5mm}</script></span>Vì vậy NCE rất đơn giản để áp dụng miễn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2869"><span class="MJXp-mi" id="MJXp-Span-2870">log</span><span class="MJXp-mo" id="MJXp-Span-2871" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2872"><span class="MJXp-mrow" id="MJXp-Span-2873" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2874"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2876" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">p</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2877" style="vertical-align: -0.4em;">model</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">\log \tilde{p}_\text{model}</script></span> dễ dàng lan truyền ngược, và, như đã chỉ rõ ở trên, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2878"><span class="MJXp-msubsup" id="MJXp-Span-2879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2881" style="vertical-align: -0.4em;">noise</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">p_\text{noise}</script></span> dễ đánh giá (nhằm đánh giá $p_\text{joint}) và lấy mẫu (để tạo dữ liệu huấn luyện).</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2882"><span class="MJXp-mspace" id="MJXp-Span-2883" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\hspace{5mm}</script></span>NCE thành công nhất khi được áp dụng cho các vấn đề với chỉ vài biến ngẫu nhiên, nhưng nó có thể hoạt động tốt ngay cả khi những biến ngẫu nhiên này có thể nhận một lượng lớn các giá trị. Ví dụ, nó đã được áp dụng thành công để mô hình hóa phân phối có điều kiện của một từ khi cho trước ngữ cảnh của từ đó (Mnih và Kavukcuoglu, 2013). Mặc dù từ này có thể được lấy từ một tập từ vựng lớn, chỉ có một từ được lấy ra.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2884"><span class="MJXp-mspace" id="MJXp-Span-2885" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\hspace{5mm}</script></span>Khi NCE được áp dụng cho các vấn đề với nhiều biến ngẫu nhiên, nó trở nên kém hiệu quả. Phân loại hồi quy logit có thể bác bỏ một mẫu nhiễu bằng cách nhận diện bất kì một biến riêng lẻ nào có giá trị khả nghi. Điều này có nghĩa là việc học chậm lại đáng kể sau khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2886"><span class="MJXp-msubsup" id="MJXp-Span-2887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2889" style="vertical-align: -0.4em;">model</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">p_\text{model}</script></span> đã học được các số liệu thống kê biên cơ bản. Hãy tưởng tượng việc học một mô hình của hình ảnh khuôn mặt, bằng cách sử dụng nhiễu Gauss phi cấu trúc như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2890"><span class="MJXp-msubsup" id="MJXp-Span-2891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2893" style="vertical-align: -0.4em;">noise</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">p_\text{noise}</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2894"><span class="MJXp-msubsup" id="MJXp-Span-2895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2897" style="vertical-align: -0.4em;">model</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">p_\text{model}</script></span> học về mắt, nó có thể bác bỏ hầu như tất cả các mẫu nhiễu phi cấu trúc mà không học được bất cứ điều gì về các đặc trưng khác trên khuôn mặt, chẳng hạn như miệng.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2898"><span class="MJXp-mspace" id="MJXp-Span-2899" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">\hspace{5mm}</script></span>Các ràng buộc như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-msubsup" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2903" style="vertical-align: -0.4em;">noise</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">p_\text{noise}</script></span> phải dễ dàng đánh giá và dễ dàng lấy mẫu có thể quá mức hạn chế. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2904"><span class="MJXp-msubsup" id="MJXp-Span-2905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2907" style="vertical-align: -0.4em;">noise</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">p_\text{noise}</script></span> đơn giản, hầu hết các mẫu có thể quá khác biệt so với dữ liệu để có thể buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2908"><span class="MJXp-msubsup" id="MJXp-Span-2909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2911" style="vertical-align: -0.4em;">model</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">p_\text{model}</script></span> cải thiện đáng kể.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2912"><span class="MJXp-mspace" id="MJXp-Span-2913" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">\hspace{5mm}</script></span>Giống như so sánh theo điểm số và giả hợp lý, NCE không hoạt động nếu chỉ biết cận dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2914"><span class="MJXp-mrow" id="MJXp-Span-2915"><span class="MJXp-munderover" id="MJXp-Span-2916"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2918" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917">p</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">\tilde{p}</script></span>. Một cận dưới như vậy có thể được sử dụng để xây dựng một cận dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2919"><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2922" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">y</span><span class="MJXp-mo" id="MJXp-Span-2925" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2926">1</span><span class="MJXp-mrow" id="MJXp-Span-2927"><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2929"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2930">x</span></span><span class="MJXp-mo" id="MJXp-Span-2931" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">p_\text{joint} (y = 1 |\textbf{x})</script></span>, nhưng nó chỉ có thể được sử dụng để xây dựng một cận trên cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2932"><span class="MJXp-msubsup" id="MJXp-Span-2933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2935" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2936" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937">y</span><span class="MJXp-mo" id="MJXp-Span-2938" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2939">0</span><span class="MJXp-mrow" id="MJXp-Span-2940"><span class="MJXp-mo" id="MJXp-Span-2941" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2942"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2943">x</span></span><span class="MJXp-mo" id="MJXp-Span-2944" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">p_\text{joint} (y = 0 | \textbf{x})</script></span>, xuất hiện trong một phần nửa các biểu thức của hàm mục tiêu NCE. Tương tự như vậy, một cận dưới cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2945"><span class="MJXp-msubsup" id="MJXp-Span-2946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2948" style="vertical-align: -0.4em;">noise</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">p_\text{noise}</script></span> là không hữu ích, bởi vì nó chỉ cung cấp một cận trên cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2949"><span class="MJXp-msubsup" id="MJXp-Span-2950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2951" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2952" style="vertical-align: -0.4em;">joint</span></span><span class="MJXp-mo" id="MJXp-Span-2953" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954">y</span><span class="MJXp-mo" id="MJXp-Span-2955" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2956">1</span><span class="MJXp-mrow" id="MJXp-Span-2957"><span class="MJXp-mo" id="MJXp-Span-2958" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2959"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2960">x</span></span><span class="MJXp-mo" id="MJXp-Span-2961" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">p_\text{joint} (y = 1 | \textbf{x})</script></span>.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2962"><span class="MJXp-mspace" id="MJXp-Span-2963" style="width: 1.181em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">\hspace{5mm}</script></span>Khi phân phối mô hình được sao chép để định nghĩa một phân phối nhiễu mới trước mỗi bước gradient, NCE định nghĩa một quy trình được gọi là <strong>ước lượng tự tương phản</strong>, có gradient kỳ vọng tương đương với gradient kỳ vọng của hàm hợp lý cực đại (Goodfellow, 2014). Trường hợp đặc biệt của NCE trong đó các mẫu nhiễu được sinh ra bởi mô hình cho thấy hàm hợp lý cực đại có thể được diễn giải như là một thủ tục buộc một mô hình liên tục học cách phân biệt giữa thực tế và những niềm tin mà riêng nó phát triển, trong khi ước lượng tương phản nhiễu giảm đi chi phí tính toán bằng cách buộc mô hình chỉ cần phân biệt giữa thực tế và một đường cơ sở cố định (mô hình nhiễu).</p><p>Sử dụng tác vụ phân loại có giám sát giữa các mẫu huấn luyện và các mẫu được sinh ra (với hàm mô hình năng lượng được sử dụng khi định nghĩa bộ phân loại) để cung cấp gradient cho mô hình đã được giới thiệu trước đây dưới nhiều dạng khác nhau (Welling và cộng sự, 2003b; Bengio, 2009).</p><p>Ước lượng tương phản nhiễu dựa trên ý tưởng rằng một mô hình sinh mẫu tốt có thể phân biệt giữa dữ liệu và nhiễu. Một ý tưởng liên quan chặt chẽ khác là một mô hình sinh mẫu tốt có thể sinh ra các mẫu mà không một bộ phân loại nào có thể phân biệt chúng với dữ liệu. Ý tưởng này dẫn đến mạng đối kháng sinh mẫu (phần 20.10.4).</p><h1 id="187-Ước-tính-hàm-phân-hoạch">18.7. Ước tính hàm phân hoạch</h1><p>Trong khi phần lớn chương này dành riêng cho việc mô tả các phương pháp để tránh việc tính toán hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">Z</span><span class="MJXp-mo" id="MJXp-Span-2966" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967">θ</span><span class="MJXp-mo" id="MJXp-Span-2968" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">Z(\theta)</script></span> của một mô hình đồ thị vô hướng, trong phần này chúng tôi thảo luận một số phương pháp để ước tính trực tiếp hàm phân hoạch.</p><p>Việc ước tính hàm phân hoạch có thể quan trọng nếu ta muốn tính hàm hợp lý đã được chuẩn hóa của dữ liệu. Điều này thường quan trọng trong việc <em>đánh giá</em> mô hình, theo dõi hiệu suất huấn luyện và so sánh các mô hình với nhau.</p><p>Ví dụ, tưởng tượng ta có hai mô hình: mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2969"><span class="MJXp-msubsup" id="MJXp-Span-2970"><span class="MJXp-mrow" id="MJXp-Span-2971" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2973">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2974" style="vertical-align: -0.4em;">A</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">{\cal{M}}_A</script></span> định nghĩa phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2975"><span class="MJXp-msubsup" id="MJXp-Span-2976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2978" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-2979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2980"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2981">x</span></span><span class="MJXp-mo" id="MJXp-Span-2982" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2985" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2987" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2988" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2989">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2991" style="margin-right: 0.05em;">Z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2992" style="vertical-align: -0.4em;">A</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2993"><span class="MJXp-mrow" id="MJXp-Span-2994" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2995"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2996">p</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2998" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-2999" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3000"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3001">x</span></span><span class="MJXp-mo" id="MJXp-Span-3002" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3005" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3006" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">p_A(\textbf{x}; \theta_A) = \frac{1}{Z_A}\tilde{p}_A(\textbf{x}; \theta_A)</script></span> và mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3007"><span class="MJXp-msubsup" id="MJXp-Span-3008"><span class="MJXp-mrow" id="MJXp-Span-3009" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3010"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3011">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3012" style="vertical-align: -0.4em;">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">{\cal{M}}_B</script></span> định nghĩa phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3013"><span class="MJXp-msubsup" id="MJXp-Span-3014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3015" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3016" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3018"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3019">x</span></span><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3023" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3024" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3025" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3026" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3027">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3029" style="margin-right: 0.05em;">Z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3030" style="vertical-align: -0.4em;">B</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3031"><span class="MJXp-mrow" id="MJXp-Span-3032" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3033"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3035" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034">p</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3036" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3038"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3039">x</span></span><span class="MJXp-mo" id="MJXp-Span-3040" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3043" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">p_B(\textbf{x}; \theta_B) = \frac{1}{Z_B}\tilde{p}_B(\textbf{x}; \theta_B)</script></span>. Một cách phổ biến để so sánh các mô hình là đánh giá và so sánh hàm hợp lý mà cả hai mô hình gán cho một tập dữ liệu kiểm thử i.i.d. Giả sử tập kiểm thử bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3046">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-262">m</script></span> ví dụ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3047"><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-3049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3051" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3052">(</span><span class="MJXp-mn" id="MJXp-Span-3053">1</span><span class="MJXp-mo" id="MJXp-Span-3054">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3057" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3058" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3062" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3063">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">m</span><span class="MJXp-mo" id="MJXp-Span-3065">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3066" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">\{x^{(1)},... , x^{(m)}\}</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3067"><span class="MJXp-msubsup" id="MJXp-Span-3068"><span class="MJXp-mo" id="MJXp-Span-3069" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3070" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3073" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mrow" id="MJXp-Span-3074"><span class="MJXp-mo" id="MJXp-Span-3075" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3076"><span class="MJXp-mrow" id="MJXp-Span-3077" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3078">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3079" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3080">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3081">i</span><span class="MJXp-mo" id="MJXp-Span-3082">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3083" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3085" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3086" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3087" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3088" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-3089"><span class="MJXp-mo" id="MJXp-Span-3090" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3091" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3094" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mrow" id="MJXp-Span-3095"><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3097"><span class="MJXp-mrow" id="MJXp-Span-3098" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3099">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3100" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3101">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102">i</span><span class="MJXp-mo" id="MJXp-Span-3103">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3104" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3107" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3108" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">\prod _ip_A\left(\textbf{x}^{(i)};\theta_A\right) > \prod _ip_B\left(\textbf{x}^{(i)};\theta_B\right)</script></span> hay tương đương với</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3109"><span class="MJXp-mtable" id="MJXp-Span-3110"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3111" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3112" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-3113"><span><span class="MJXp-mo" id="MJXp-Span-3114" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3116">log</span><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3120" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mrow" id="MJXp-Span-3121"><span class="MJXp-mo" id="MJXp-Span-3122" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3123"><span class="MJXp-mrow" id="MJXp-Span-3124" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3125">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3126" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3127">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3128">i</span><span class="MJXp-mo" id="MJXp-Span-3129">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3133" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3135" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-3136"><span><span class="MJXp-mo" id="MJXp-Span-3137" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3139">log</span><span class="MJXp-mo" id="MJXp-Span-3140" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3143" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mrow" id="MJXp-Span-3144"><span class="MJXp-mo" id="MJXp-Span-3145" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3146"><span class="MJXp-mrow" id="MJXp-Span-3147" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3148">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3149" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3150">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3151">i</span><span class="MJXp-mo" id="MJXp-Span-3152">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3153" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3156" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-3159">0</span><span class="MJXp-mo" id="MJXp-Span-3160" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-265"> \sum_i \log p_A\left(\textbf{x}^{(i)};\theta_A\right) - \sum_i \log p_B\left(\textbf{x}^{(i)};\theta_B\right) >0, \tag{18.38}</script></span></p><p>thì ta nói rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3161"><span class="MJXp-msubsup" id="MJXp-Span-3162"><span class="MJXp-mrow" id="MJXp-Span-3163" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3164"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3165">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3166" style="vertical-align: -0.4em;">A</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">{\cal{M}}_A</script></span> là một mô hình tốt hơn so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3167"><span class="MJXp-msubsup" id="MJXp-Span-3168"><span class="MJXp-mrow" id="MJXp-Span-3169" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3170"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3171">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3172" style="vertical-align: -0.4em;">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">{\cal{M}}_B</script></span> (hoặc, ít nhất, nó là một mô hình tốt hơn trên tập kiểm thử), nghĩa là nó có logarit hàm hợp lý của tập kiểm thử tốt hơn. Thật không may, việc kiểm định điều kiện này lại đòi hỏi kiến thức về hàm phân hoạch. Quả thực, phương trình 18.38 đòi hỏi đánh giá logarit xác suất mà mô hình gán cho mỗi điểm, từ đó đòi hỏi đánh giá hàm phân hoạch. Ta có thể đơn giản hóa tình huống bằng cách viết lại phương trình 18.38 thành một dạng mà tại đó ta chỉ cần biết <strong>tỷ lệ</strong> của hai hàm phân hoạch của mô hình:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3173"><span class="MJXp-mtable" id="MJXp-Span-3174"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3175" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3176" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-3177"><span><span class="MJXp-mo" id="MJXp-Span-3178" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3179" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3180">log</span><span class="MJXp-mo" id="MJXp-Span-3181" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3184" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mrow" id="MJXp-Span-3185"><span class="MJXp-mo" id="MJXp-Span-3186" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3187"><span class="MJXp-mrow" id="MJXp-Span-3188" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3189">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3190" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3191">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3192">i</span><span class="MJXp-mo" id="MJXp-Span-3193">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3194" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3197" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3198" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-3200"><span><span class="MJXp-mo" id="MJXp-Span-3201" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3202" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3203">log</span><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3206" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3207" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mrow" id="MJXp-Span-3208"><span class="MJXp-mo" id="MJXp-Span-3209" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3210"><span class="MJXp-mrow" id="MJXp-Span-3211" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3212">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3213" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3214">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3215">i</span><span class="MJXp-mo" id="MJXp-Span-3216">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3217" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3219" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3220" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3221" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3223"><span><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3226"><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mi" id="MJXp-Span-3228">log</span><span class="MJXp-mo" id="MJXp-Span-3229" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-3230" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3231"><span class="MJXp-mrow" id="MJXp-Span-3232" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3233"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3235" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">p</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3236" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mrow" id="MJXp-Span-3237"><span class="MJXp-mo" id="MJXp-Span-3238" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3239"><span class="MJXp-mrow" id="MJXp-Span-3240" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3241">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3242" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3243">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244">i</span><span class="MJXp-mo" id="MJXp-Span-3245">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3246" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3248" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3249" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3250" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3251"><span class="MJXp-mrow" id="MJXp-Span-3252" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3253"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3255" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3254">p</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3256" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mrow" id="MJXp-Span-3257"><span class="MJXp-mo" id="MJXp-Span-3258" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-3259"><span class="MJXp-mrow" id="MJXp-Span-3260" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3261">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3262" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3263">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3264">i</span><span class="MJXp-mo" id="MJXp-Span-3265">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3266" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3269" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3272" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3273">m</span><span class="MJXp-mi" id="MJXp-Span-3274">log</span><span class="MJXp-mo" id="MJXp-Span-3275" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-3276" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277">Z</span><span class="MJXp-mo" id="MJXp-Span-3278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3280" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3281" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3283">Z</span><span class="MJXp-mo" id="MJXp-Span-3284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3286" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3287" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3288" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3289" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3290" style="width: 0em; height: 0em;"></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-268"> \sum_i \log p_A\left(\textbf{x}^{(i)};\theta_A\right) - \sum_i \log p_B\left(\textbf{x}^{(i)};\theta_B\right) = \sum_i \left( \log \frac{\tilde{p}_A\left(\textbf{x}^{(i)};\theta_A\right)}{\tilde{p}_B\left(\textbf{x}^{(i)};\theta_B\right)} \right) - m \log \frac{Z(\theta_A)}{Z(\theta_B)}. \\ \tag{18.39}</script></span></p><p>Do đó, ta có thể xác định xem liệu mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3291"><span class="MJXp-msubsup" id="MJXp-Span-3292"><span class="MJXp-mrow" id="MJXp-Span-3293" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3294"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3295">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3296" style="vertical-align: -0.4em;">A</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-269">{\cal{M}}_A</script></span> có tốt hơn so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3297"><span class="MJXp-msubsup" id="MJXp-Span-3298"><span class="MJXp-mrow" id="MJXp-Span-3299" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3300"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3301">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3302" style="vertical-align: -0.4em;">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-270">{\cal{M}}_B</script></span> nhưng không cần biết hàm phân hoạch của cả hai mô hình mà chỉ cần tỷ lệ của chúng. Như sẽ thấy ngay sau đây, ta có thể ước tính tỷ lệ này bằng phương pháp lấy mẫu quan trọng, với điều kiện hai mô hình tương tự nhau.</p><p>Tuy nhiên, nếu ta muốn tính xác suất thực sự của dữ liệu kiểm thử theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3303"><span class="MJXp-msubsup" id="MJXp-Span-3304"><span class="MJXp-mrow" id="MJXp-Span-3305" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3306"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3307">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3308" style="vertical-align: -0.4em;">A</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-271">{\cal{M}}_A</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3309"><span class="MJXp-msubsup" id="MJXp-Span-3310"><span class="MJXp-mrow" id="MJXp-Span-3311" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3312"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3313">M</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3314" style="vertical-align: -0.4em;">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-272">{\cal{M}}_B</script></span>, ta cần tính giá trị thực của các hàm phân hoạch. Điều đó nói rằng, nếu ta biết tỷ lệ của hai hàm phân hoạch, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3316">r</span><span class="MJXp-mo" id="MJXp-Span-3317" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3318" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3319">Z</span><span class="MJXp-mo" id="MJXp-Span-3320">(</span><span class="MJXp-msubsup" id="MJXp-Span-3321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3322" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3323" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3324">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3325">Z</span><span class="MJXp-mo" id="MJXp-Span-3326">(</span><span class="MJXp-msubsup" id="MJXp-Span-3327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3329" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3330">)</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-273-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-273">r = \frac{Z (\theta_B)} {Z (\theta_A)}</script></span>, và ta biết giá trị thực của một trong hai hàm, ví dụ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3332">Z</span><span class="MJXp-mo" id="MJXp-Span-3333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3335" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3336" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-274">Z (\theta_A)</script></span>, ta có thể tính giá trị của hàm còn lại:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3338"><span class="MJXp-mtable" id="MJXp-Span-3339"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3340" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3341" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3342">Z</span><span class="MJXp-mo" id="MJXp-Span-3343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3345" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3346" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3347" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3349">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">Z</span><span class="MJXp-mo" id="MJXp-Span-3351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3353" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3354" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3355" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3356" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3357" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3358">Z</span><span class="MJXp-mo" id="MJXp-Span-3359" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3361" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3362" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mo" id="MJXp-Span-3363" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3364">Z</span><span class="MJXp-mo" id="MJXp-Span-3365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3368" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3369" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3370">Z</span><span class="MJXp-mo" id="MJXp-Span-3371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3373" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3374" style="vertical-align: -0.4em;">A</span></span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3376" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-275">Z (\theta_B)=rZ (\theta_A)=\frac{Z (\theta_B)} {Z (\theta_A)}Z (\theta_A). \tag{18.40}</script></span></p><p>Một cách đơn giản để ước tính hàm phân hoạch là sử dụng phương pháp Monte Carlo đơn giản như lấy mẫu quan trọng. Chúng tôi sẽ trình bày cách tiếp cận này thông qua các biến liên tục sử dụng tích phân, nhưng nó cũng có thể dễ dàng áp dụng cho các biến rời rạc bằng cách thay thế các tích phân bằng tổng. Ta sử dụng một phân phối đề xuất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3377"><span class="MJXp-msubsup" id="MJXp-Span-3378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3379" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3380" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3381" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3382"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3383">x</span></span><span class="MJXp-mo" id="MJXp-Span-3384" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3385" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3386" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3387">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3389" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3390" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3391"><span class="MJXp-mrow" id="MJXp-Span-3392" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3393"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3395" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3396" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3398"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3399">x</span></span><span class="MJXp-mo" id="MJXp-Span-3400" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-276">p_0(\textbf{x}) = \frac{1}{Z_0}\tilde{p}_0 (\textbf{x})</script></span>, hỗ trợ lấy mẫu và đánh giá cả hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3401"><span class="MJXp-msubsup" id="MJXp-Span-3402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3404" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-277">Z_0</script></span> và phân phối chưa chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3405"><span class="MJXp-msubsup" id="MJXp-Span-3406"><span class="MJXp-mrow" id="MJXp-Span-3407" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3408"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3410" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3409">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3411" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3413"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3414">x</span></span><span class="MJXp-mo" id="MJXp-Span-3415" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-278">\tilde{p}_0 (\textbf{x})</script></span>.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3416"><span class="MJXp-mtable" id="MJXp-Span-3417"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3418" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3419" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-3420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3421" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3422" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mtd" id="MJXp-Span-3423" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3424"></span><span class="MJXp-mo" id="MJXp-Span-3425" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-msubsup" id="MJXp-Span-3427"><span class="MJXp-mrow" id="MJXp-Span-3428" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3429"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3431" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3432" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3434"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3435">x</span></span><span class="MJXp-mo" id="MJXp-Span-3436" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3437">d</span><span class="MJXp-mrow" id="MJXp-Span-3438"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3439">x</span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3440" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3441" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3442" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3443"></span><span class="MJXp-mo" id="MJXp-Span-3444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3445" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mfrac" id="MJXp-Span-3446" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3448" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3449" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3451"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3452">x</span></span><span class="MJXp-mo" id="MJXp-Span-3453" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3455" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3456" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3457" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3458"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3459">x</span></span><span class="MJXp-mo" id="MJXp-Span-3460" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3461"><span class="MJXp-mrow" id="MJXp-Span-3462" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3463"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3465" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3464">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3466" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3468"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3469">x</span></span><span class="MJXp-mo" id="MJXp-Span-3470" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471">d</span><span class="MJXp-mrow" id="MJXp-Span-3472"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3473">x</span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3474" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3475" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3476" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3477"></span><span class="MJXp-mo" id="MJXp-Span-3478" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3481" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3482" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-msubsup" id="MJXp-Span-3483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3484" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3485" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3487"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3488">x</span></span><span class="MJXp-mo" id="MJXp-Span-3489" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-3490" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3491"><span class="MJXp-mrow" id="MJXp-Span-3492" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3493"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3495" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3494">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3496" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3498"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3499">x</span></span><span class="MJXp-mo" id="MJXp-Span-3500" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3501"><span class="MJXp-mrow" id="MJXp-Span-3502" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3503"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3505" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3504">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3506" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3508"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3509">x</span></span><span class="MJXp-mo" id="MJXp-Span-3510" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3511">d</span><span class="MJXp-mrow" id="MJXp-Span-3512"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3513">x</span></span><span class="MJXp-mo" id="MJXp-Span-3514" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-3515" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3516" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-3517"><span class="MJXp-mrow" id="MJXp-Span-3518" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3519"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3521" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3520">Z</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3522" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mtd" id="MJXp-Span-3523" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3524"></span><span class="MJXp-mo" id="MJXp-Span-3525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3526" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3528" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3529" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3530">K</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3531"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537" style="margin-right: 0px; margin-left: 0px;">K</span></span><span><span class="MJXp-mo" id="MJXp-Span-3532" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3533" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3534">k</span><span class="MJXp-mo" id="MJXp-Span-3535">=</span><span class="MJXp-mn" id="MJXp-Span-3536">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3538" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3539"><span class="MJXp-mrow" id="MJXp-Span-3540" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3541"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3543" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3542">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3544" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3546"><span class="MJXp-mrow" id="MJXp-Span-3547" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3548">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3549" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3550">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3551">k</span><span class="MJXp-mo" id="MJXp-Span-3552">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3554"><span class="MJXp-mrow" id="MJXp-Span-3555" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3556"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3557">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3559" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3561"><span class="MJXp-mrow" id="MJXp-Span-3562" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3563">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3564" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3565">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-3566" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-3567">&nbsp;s.t. :&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-3568"><span class="MJXp-mrow" id="MJXp-Span-3569" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3570">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3571" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3572">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3573">k</span><span class="MJXp-mo" id="MJXp-Span-3574">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3575" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-3576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3578" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3579" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-279">\begin{align}
Z_1 &= \int \tilde{p}_1(\textbf{x})d\textbf{x} \tag{18.41} \\
&= \int \frac{p_0(\textbf{x})}{p_0(\textbf{x})}\tilde{p}_1(\textbf{x})d\textbf{x} \tag{18.42} \\
&= Z_0 \int p_0(\textbf{x}) \frac{\tilde{p}_1(\textbf{x})}{\tilde{p}_0(\textbf{x})} d\textbf{x}, \tag{18.43} \\
\hat{Z}_1 &=\frac{Z_0}{K}\sum_{k=1}^K\frac{\tilde{p}_1(\textbf{x}^{(k)})}{\tilde{p}_0(\textbf{x}^{k})} \text{    s.t. : }\textbf{x}^{(k)} \sim p_0. \tag{18.44} \\
\end{align}</script></span></p><p>Trong dòng cuối cùng, ta thực hiện một ước lượng Monte Carlo, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3580"><span class="MJXp-msubsup" id="MJXp-Span-3581"><span class="MJXp-mrow" id="MJXp-Span-3582" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3583"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3585" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3584">Z</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3586" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-280">\hat{Z}_1</script></span>, của biểu thức tích phân bằng cách sử dụng mẫu được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3587"><span class="MJXp-msubsup" id="MJXp-Span-3588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3589" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3590" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3592"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-3593">x</span></span><span class="MJXp-mo" id="MJXp-Span-3594" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-281">p_0 (\textbf{x})</script></span>, và sau đó đánh trọng số cho mỗi mẫu với tỷ lệ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3595"><span class="MJXp-msubsup" id="MJXp-Span-3596"><span class="MJXp-mrow" id="MJXp-Span-3597" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3598"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3600" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3599">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3601" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-282">\tilde{p}_1</script></span> chưa chuẩn hóa và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3602"><span class="MJXp-msubsup" id="MJXp-Span-3603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3605" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-283">p_0</script></span> đề xuất.<br>
------------------------<br>
<strong>Hiếu NP kết thúc dịch ở đây</strong><br>
------------------------</p><p>-----------------------<br>
<strong>dzu.gidiel bắt đầu dịch ở đây</strong><br>
--------------------------<br>
(Trang 623-628)</p><p>Cách tiếp cận này còn cho phép chúng ta ước tính tỷ lệ giữa các hàm phân hoạch bằng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3606"><span class="MJXp-mtable" id="MJXp-Span-3607"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3608" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3609" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3610" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3611">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3612">K</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3613"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619" style="margin-right: 0px; margin-left: 0px;">K</span></span><span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3615" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3616">k</span><span class="MJXp-mo" id="MJXp-Span-3617">=</span><span class="MJXp-mn" id="MJXp-Span-3618">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3620" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3621"><span class="MJXp-mrow" id="MJXp-Span-3622" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3623"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3625" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3624">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3626" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3628"><span class="MJXp-mrow" id="MJXp-Span-3629" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3630">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3631" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3632">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3633">k</span><span class="MJXp-mo" id="MJXp-Span-3634">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3635" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3636"><span class="MJXp-mrow" id="MJXp-Span-3637" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3638"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3640" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3641" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3643"><span class="MJXp-mrow" id="MJXp-Span-3644" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3645">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3646" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3647">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3648">k</span><span class="MJXp-mo" id="MJXp-Span-3649">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3650" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-3651" style="width: 2em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3652">s</span><span class="MJXp-mo" id="MJXp-Span-3653" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3654">t</span><span class="MJXp-mo" id="MJXp-Span-3655" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3656" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mspace" id="MJXp-Span-3657" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3658"><span class="MJXp-mrow" id="MJXp-Span-3659" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3660"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3661">x</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3662" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3663">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">k</span><span class="MJXp-mo" id="MJXp-Span-3665">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3666" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-3667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3668" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3669" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-284-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-284">
\frac{1}{K}\sum\limits_{k=1}^K \frac{\tilde{p}_1(\mathbf{x}^{(k)})}{\tilde{p}_0(\mathbf{x}^{(k)})}
\qquad s.t. :\, {\mathbf{x}}^{(k)} \sim p_0
\tag{18.45}
</script></span><br>
Giá trị này có thể được sử dụng để so sánh trực tiếp hai mô hình ở phương trình (18.39).</p><p>Nếu phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3670"><span class="MJXp-msubsup" id="MJXp-Span-3671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3672" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3673" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-285">p_0</script></span> gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3674"><span class="MJXp-msubsup" id="MJXp-Span-3675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3677" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-286">p_1</script></span>, phương trình (18.44) có thể là một cách hiệu quả để ước tính hàm phân hoạch (Minka, 2005). Thật không may mắn, hầu như mọi lần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3678"><span class="MJXp-msubsup" id="MJXp-Span-3679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3680" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3681" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-287">p_1</script></span> đều phức tạp (thường là đa mode) và được định nghĩa trong một không gian nhiều chiều. Rất khó để tìm được một <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3682"><span class="MJXp-msubsup" id="MJXp-Span-3683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3685" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-288">p_0</script></span> dễ kiểm soát mà lại đủ đơn giản để đánh giá trong khi vẫn đủ gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3686"><span class="MJXp-msubsup" id="MJXp-Span-3687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3688" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3689" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-289">p_1</script></span> để tạo ra một xấp xỉ có chất lượng cao. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3690"><span class="MJXp-msubsup" id="MJXp-Span-3691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3692" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3693" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-290">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3694"><span class="MJXp-msubsup" id="MJXp-Span-3695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3696" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3697" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-291">p_1</script></span> không gần nhau, nhiều mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3698"><span class="MJXp-msubsup" id="MJXp-Span-3699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3700" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3701" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-292">p_0</script></span> sẽ có xác suất xảy ra thấp hơn trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3702"><span class="MJXp-msubsup" id="MJXp-Span-3703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3704" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3705" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-293">p_1</script></span> và từ đó đóng góp không đáng kể tới tổng trong phương trình (18.44).</p><p>Nếu có quá ít mẫu với trọng số đáng kể trong tổng này thì ước lượng sẽ có chất lượng thấp do có phương sai cao. Điều này có thể hiểu được thông qua việc ước lượng phương sai của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3706"><span class="MJXp-msubsup" id="MJXp-Span-3707"><span class="MJXp-mrow" id="MJXp-Span-3708" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3709"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3711" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3710">Z</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3712" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-294">\hat{Z}_1</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3713"><span class="MJXp-mtable" id="MJXp-Span-3714"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3715" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3716" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-3717"><span class="MJXp-munderover" id="MJXp-Span-3718"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-3722" style="margin-left: 0px; margin-right: 0px;">^</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3720">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721">r</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3723" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3724"><span class="MJXp-mrow" id="MJXp-Span-3725" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3726"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3728" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3727">Z</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3729" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3730" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3731" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3732" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3734" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3735" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737" style="margin-right: 0.05em;">K</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3738" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3739"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3745" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3746">K</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3740" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3741" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3742">k</span><span class="MJXp-mo" id="MJXp-Span-3743">=</span><span class="MJXp-mn" id="MJXp-Span-3744">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3747"><span class="MJXp-mrow" id="MJXp-Span-3748" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3749" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-3750"><span><span class="MJXp-mtr" id="MJXp-Span-3751" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3752" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3753" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3754"><span class="MJXp-mrow" id="MJXp-Span-3755" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3756"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3758" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3759" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3760">(</span><span class="MJXp-msubsup" id="MJXp-Span-3761"><span class="MJXp-mrow" id="MJXp-Span-3762" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3763">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3764" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3765">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3766">k</span><span class="MJXp-mo" id="MJXp-Span-3767">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3768">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3769"><span class="MJXp-mrow" id="MJXp-Span-3770" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3771"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3773" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3772">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3774" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3775">(</span><span class="MJXp-msubsup" id="MJXp-Span-3776"><span class="MJXp-mrow" id="MJXp-Span-3777" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3778">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3779" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3780">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">k</span><span class="MJXp-mo" id="MJXp-Span-3782">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3783">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3784" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3785"><span class="MJXp-mrow" id="MJXp-Span-3786" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3787"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3789" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">Z</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3790" style="vertical-align: -0.4em;">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3791" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3792" style="vertical-align: 1.86em;">2</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-295-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-295">
\hat{Var}(\hat{Z}_1)= \frac{Z_0}{K^2}
\sum\limits_{k=1}^{K} 
\begin{pmatrix}
\frac{\tilde{p}_1(\mathbf{x}^{(k)})}{\tilde{p}_0(\mathbf{x}^{(k)})}-\hat{Z}_1
\end{pmatrix}^2
\tag{18.46}
</script></span><br>
Đại lượng này lớn nhất khi giá trị của các trọng số quan trọng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3793"><span class="MJXp-mfrac" id="MJXp-Span-3794" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3795"><span class="MJXp-mrow" id="MJXp-Span-3796" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3797"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3799" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3798">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3800" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3801">(</span><span class="MJXp-msubsup" id="MJXp-Span-3802"><span class="MJXp-mrow" id="MJXp-Span-3803" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3804">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3805" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3806">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3807">k</span><span class="MJXp-mo" id="MJXp-Span-3808">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3809">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3810"><span class="MJXp-mrow" id="MJXp-Span-3811" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3812"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3814" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3813">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3815" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3816">(</span><span class="MJXp-msubsup" id="MJXp-Span-3817"><span class="MJXp-mrow" id="MJXp-Span-3818" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3819">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3820" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3821">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3822">k</span><span class="MJXp-mo" id="MJXp-Span-3823">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3824">)</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-296">\frac{\tilde{p}_1(\mathbf{x}^{(k)})}{\tilde{p}_0(\mathbf{x}^{(k)})}</script></span> có độ lệch đáng kể.</p><p>Bây giờ chúng ta chuyển sang hai chiến thuật liên quan được phát triển nhằm giải quyết bài toán ước lượng các hàm phân hoạch của các phân phối phức tạp trong không gian nhiều chiều: ủ lấy mẫu theo độ quan trọng và lấy mẫu bắc cầu. Cả hai đều bắt đầu với chiến thuật lấy mẫu theo độ quan trọng được giới thiệu ở trên, và đều nỗ lực khắc phục vấn đề <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3825"><span class="MJXp-msubsup" id="MJXp-Span-3826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3827" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3828" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-297">p_0</script></span> được đề xuất quá cách xa với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3829"><span class="MJXp-msubsup" id="MJXp-Span-3830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3831" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3832" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-298">p_1</script></span>, bằng việc giới thiệu các phân phối trung gian để <em>khoả lấp khoảng cách</em> giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3833"><span class="MJXp-msubsup" id="MJXp-Span-3834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3835" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3836" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-299">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3837"><span class="MJXp-msubsup" id="MJXp-Span-3838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3839" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3840" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-300">p_1</script></span>.</p><h3 id="1871-Ủ-lấy-mẫu-theo-độ-quan-trọng">18.7.1. Ủ lấy mẫu theo độ quan trọng</h3><p>Trong trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3841"><span class="MJXp-msubsup" id="MJXp-Span-3842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3843" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3844" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3845">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3849" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3850" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mrow" id="MJXp-Span-3851"><span class="MJXp-mo" id="MJXp-Span-3852" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-3853"><span class="MJXp-mo" id="MJXp-Span-3854" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3857" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3858" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-301">D_{KL}(p_0||p_1)</script></span> lớn (nghĩa là khi có rất ít sự chồng chéo giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3859"><span class="MJXp-msubsup" id="MJXp-Span-3860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3861" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3862" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-302">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3863"><span class="MJXp-msubsup" id="MJXp-Span-3864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3865" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3866" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-303">p_1</script></span>), một chiến thuật được gọi là <strong>ủ lấy mẫu theo độ quan trọng</strong> (AIS) có nhiệm vụ khoả lấp khoảng cách này bằng cách đề xuất các phân phối trung gian  (Jarzynski, 1997; Neal, 2001). Xét một chuỗi các phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3867"><span class="MJXp-msubsup" id="MJXp-Span-3868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3869" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3870" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3872" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3873" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3874" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3875" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3876" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3877" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3878" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3881" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3883" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3884" style="vertical-align: -0.4em;">n</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-304">p_{\eta_0},...,p_{\eta_n}</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3885"><span class="MJXp-mn" id="MJXp-Span-3886">0</span><span class="MJXp-mo" id="MJXp-Span-3887" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3889" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3890" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-3891" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3893" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3894" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3895" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-3896" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3897" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3898" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3899" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3901" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3902" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3903">n</span><span class="MJXp-mo" id="MJXp-Span-3904">−</span><span class="MJXp-mn" id="MJXp-Span-3905">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3906" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-3907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3908" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3909" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3910" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3911">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-305">0=\eta_0<\eta_1<...<\eta_{n-1}<\eta_n=1</script></span>, sao cho phân phối đầu tiên và cuối cùng của chuỗi lần lượt là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3912"><span class="MJXp-msubsup" id="MJXp-Span-3913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3914" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3915" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-306">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3916"><span class="MJXp-msubsup" id="MJXp-Span-3917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3918" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3919" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-307">p_1</script></span>.</p><p>Cách tiếp cận này cho phép chúng ta ước tính hàm phân hoạch của một phân phối đa mode, được định nghĩa trong một không gian nhiều chiều (ví dụ như phân phối định nghĩa bởi một máy Boltzmann hạn chế đã huấn luyện). Chúng ta bắt đầu bằng một mô hình đơn giản hơn với một hàm phân hoạch đã biết (ví dụ như một máy Boltzmann hạn chế với các trọng số bằng không), và ước tính tỷ lệ giữa hai hàm phân hoạch của hai mô hình này. Phép ước lượng của tỷ lệ này dựa trên ước lượng các tỷ lệ của một chuỗi các phân phối tương tự nhau nhau, chẳng hạn như chuỗi các máy Boltzmann hạn chế, với các trọng số được nội suy giữa giá trị không và các giá trị trọng số đã học được.</p><p>Bây giờ ta có thể viết tỷ lệ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3920"><span class="MJXp-mfrac" id="MJXp-Span-3921" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3923" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3924" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3926" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3927" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-308">\frac{Z_1}{Z_0}</script></span> dưới dạng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3928"><span class="MJXp-mtable" id="MJXp-Span-3929"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3930" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3931" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3932" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3934" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3935" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3937" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3938" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3939" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3940" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3942" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3943" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3945" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3946" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3947" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3949" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3950" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3952" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3953" style="vertical-align: -0.4em;">1</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3955" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3956" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3958" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3959" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3960" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3961" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3962" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mfrac" id="MJXp-Span-3963" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3966" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3968" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3969" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3970">n</span><span class="MJXp-mo" id="MJXp-Span-3971">−</span><span class="MJXp-mn" id="MJXp-Span-3972">1</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3974" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3975" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3977" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3978" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3979">n</span><span class="MJXp-mo" id="MJXp-Span-3980">−</span><span class="MJXp-mn" id="MJXp-Span-3981">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-309-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-309">
\frac{Z_1}{Z_0}=\frac{Z_1}{Z_0}\frac{Z_{\eta_1}}{Z_{\eta_1}}...
\frac{Z_{\eta_{n-1}}}{Z_{\eta_{n-1}}} \tag{18.47}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3982"><span class="MJXp-mtable" id="MJXp-Span-3983"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3984" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3985" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3986" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3987" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3989" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3990" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3992" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3993" style="vertical-align: -0.4em;">1</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3995" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3996" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3997">0</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3998" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4000" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4001" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4004" style="vertical-align: -0.4em;">2</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4006" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4007" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4010" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4011" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4012" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4013" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mfrac" id="MJXp-Span-4014" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4016" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4017" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4019" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4020" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4021">n</span><span class="MJXp-mo" id="MJXp-Span-4022">−</span><span class="MJXp-mn" id="MJXp-Span-4023">1</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4025" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4026" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4028" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4029" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4030">n</span><span class="MJXp-mo" id="MJXp-Span-4031">−</span><span class="MJXp-mn" id="MJXp-Span-4032">2</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4033" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4035" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4036" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-4037"><span class="MJXp-mn" id="MJXp-Span-4038">1</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4040" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4041" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4043" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4044" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4045">n</span><span class="MJXp-mo" id="MJXp-Span-4046">−</span><span class="MJXp-mn" id="MJXp-Span-4047">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-310-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-310">
=\frac{Z_{\eta_1}}{Z_{0}}\frac{Z_{\eta_2}}{Z_{\eta_1}}...
\frac{Z_{\eta_{n-1}}}{Z_{\eta_{n-2}}}
\frac{Z_{{1}}}{Z_{\eta_{n-1}}} \tag{18.48}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4048"><span class="MJXp-mtable" id="MJXp-Span-4049"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4050" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4051" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4052" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-4053"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4059" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4060">n</span><span class="MJXp-mo" id="MJXp-Span-4061">−</span><span class="MJXp-mn" id="MJXp-Span-4062">1</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-4054" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4055" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4056">j</span><span class="MJXp-mo" id="MJXp-Span-4057">=</span><span class="MJXp-mn" id="MJXp-Span-4058">0</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4063" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4065" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4066" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4069" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4070">j</span><span class="MJXp-mo" id="MJXp-Span-4071">+</span><span class="MJXp-mn" id="MJXp-Span-4072">1</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4074" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4075" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4077" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4078" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4079">j</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-4080" style="width: 2em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-4081" style="width: 2em; height: 0em;"></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-311-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-311">
=\prod\limits_{j=0}^{n-1}\frac{Z_{\eta_{j+1}}}{Z_{\eta_{j}}} \qquad\qquad\tag{18.49}
</script></span></p><p>Giả sử các phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4082"><span class="MJXp-msubsup" id="MJXp-Span-4083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4084" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4085" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4087" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4088" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4089">j</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-312">p_{\eta_{j}}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4090"><span class="MJXp-msubsup" id="MJXp-Span-4091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4092" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4093" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4095" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4096" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">j</span><span class="MJXp-mo" id="MJXp-Span-4098">+</span><span class="MJXp-mn" id="MJXp-Span-4099">1</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-313">p_{\eta_{j+1}}</script></span>, với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4100"><span class="MJXp-mn" id="MJXp-Span-4101">0</span><span class="MJXp-mo" id="MJXp-Span-4102" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4103">j</span><span class="MJXp-mo" id="MJXp-Span-4104" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4105">n</span><span class="MJXp-mo" id="MJXp-Span-4106" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-4107">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-314">0\leq j\leq n-1</script></span>, đủ gần nhau, chúng ta có thể ước tính mỗi phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4108"><span class="MJXp-mfrac" id="MJXp-Span-4109" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4111" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4112" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4114" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4115" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4116">j</span><span class="MJXp-mo" id="MJXp-Span-4117">+</span><span class="MJXp-mn" id="MJXp-Span-4118">1</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4120" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4121" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4123" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4124" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4125">j</span></span></span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-315-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-315">\frac{Z_{\eta_{j+1}}}{Z_{\eta_{j}}}</script></span> một cách tin cậy bằng phép lấy mẫu theo độ quan trọng, và sau đó sử dụng chúng để ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4126"><span class="MJXp-mfrac" id="MJXp-Span-4127" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4129" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4130" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-4131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4132" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4133" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-316">\frac{Z_1}{Z_0}</script></span>.</p><p>Những phân phối trung gian này đến từ đâu? Giống như phân phối nguyên bản <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4134"><span class="MJXp-msubsup" id="MJXp-Span-4135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4136" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4137" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-317">p_0</script></span> được đề xuất, là một lựa chọn thiết kế, chuỗi các phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4138"><span class="MJXp-msubsup" id="MJXp-Span-4139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4140" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4141" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4143" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4144" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4145" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4146" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4147" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4148" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4149" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4151" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4152" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4154" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4155" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-4156">−</span><span class="MJXp-mn" id="MJXp-Span-4157">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-318">p_{\eta_1},...,p_{\eta_n-1}</script></span> cũng là một lựa chọn thiết kế. Nghĩa là, nó có thể được thiết kế riêng biệt phù hợp cho phạm vi của mỗi bài toán. Một lựa chọn phổ biến của các phân phối trung gian là sử dụng trung bình nhân có trọng số của phân phối đích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4158"><span class="MJXp-msubsup" id="MJXp-Span-4159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4160" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4161" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-319">p_1</script></span> và phân phối được đề xuất ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4162"><span class="MJXp-msubsup" id="MJXp-Span-4163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4164" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4165" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-320-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-320">p_0</script></span> (có hàm phân hoạch đã biết):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4166"><span class="MJXp-mtable" id="MJXp-Span-4167"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4168" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4169" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-4170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4171" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4172" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4174" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4175" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4176" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-msubsup" id="MJXp-Span-4177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4178" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-4181"><span class="MJXp-msubsup" id="MJXp-Span-4182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4183" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4184" style="vertical-align: -0.4em;">j</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4179"><span class="MJXp-mn" id="MJXp-Span-4180">1</span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-4185" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-4186" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4188" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-4190"><span class="MJXp-mn" id="MJXp-Span-4191">1</span><span class="MJXp-mo" id="MJXp-Span-4192">−</span><span class="MJXp-mrow" id="MJXp-Span-4193"><span class="MJXp-msubsup" id="MJXp-Span-4194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4195" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4196" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-4189">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4197" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-321-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-321">
p_{\eta_j}\propto p_{1}^{\eta_j} \,\,p_0^{1-{\eta_j}}. \tag{18.50}
</script></span><br>
Để lấy mẫu từ những phân phối trung gian này, chúng ta định nghĩa một dãy các hàm chuyển tiếp dựa trên chuỗi Markov <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4198"><span class="MJXp-msubsup" id="MJXp-Span-4199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4200" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4201" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4203" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4204" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4206"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4207" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4208" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-4209"><span class="MJXp-mo" id="MJXp-Span-4210" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4211" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4212">x</span><span class="MJXp-mo" id="MJXp-Span-4213" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-322-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-322">T_{\eta_j} (\boldsymbol{x}'|\,\boldsymbol{x})</script></span> thể hiện phân phối xác suất điều kiện của việc chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4214"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4215">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-323-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-323">\boldsymbol{x}</script></span> thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4216"><span class="MJXp-msup" id="MJXp-Span-4217"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4218" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4219" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-324-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-324">\boldsymbol{x}'</script></span>. Toán tử chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4220"><span class="MJXp-msubsup" id="MJXp-Span-4221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4222" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4223" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4226" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4228"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4229" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4230" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-4231"><span class="MJXp-mo" id="MJXp-Span-4232" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4233" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4234">x</span><span class="MJXp-mo" id="MJXp-Span-4235" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-325-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-325">T_{\eta_j} (\boldsymbol{x}'|\,\boldsymbol{x})</script></span> được định nghĩa để <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4236"><span class="MJXp-msubsup" id="MJXp-Span-4237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4238" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4239" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4241" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4242" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4243" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4244">x</span><span class="MJXp-mo" id="MJXp-Span-4245" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-326-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-326">p_{\eta_j}(\boldsymbol{x})</script></span> bất biến:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4246"><span class="MJXp-mtable" id="MJXp-Span-4247"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4248" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4249" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-4250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4251" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4252" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4254" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4255" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4257">x</span><span class="MJXp-mo" id="MJXp-Span-4258" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4259" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4260" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-msubsup" id="MJXp-Span-4261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4262" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4263" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4265" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4266" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4267" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4268"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4269" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4270" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4271" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4273" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4274" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4276" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4277" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4279">x</span><span class="MJXp-mrow" id="MJXp-Span-4280"><span class="MJXp-mo" id="MJXp-Span-4281" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4282" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msup" id="MJXp-Span-4283"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4284" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4285" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4286" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-4287" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4288">d</span><span class="MJXp-msup" id="MJXp-Span-4289"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4290" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4291" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4292" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-327-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-327">
p_{\eta_j}(\boldsymbol{x})=\int p_{\eta_j}(\boldsymbol{x}')T_{\eta_j} (\boldsymbol{x}|\,\boldsymbol{x}')\;d\boldsymbol{x}'.\tag{18.51}
</script></span><br>
Những phép chuyển tiếp này có thể được xây dựng giống như bất kỳ phương pháp Monte Carlo dựa trên chuỗi Markov nào (ví dụ như Metropolis-Hastings, Gibbs), bao gồm các phương pháp duyệt nhiều lượt qua tất cả các biến ngẫu nhiên hoặc các loại vòng lặp khác.</p><p>Chiến thuật lấy mẫu AIS sau đó sẽ sinh các mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4293"><span class="MJXp-msubsup" id="MJXp-Span-4294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4295" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4296" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-328-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-328">p_0</script></span> và sử dụng các toán tử chuyển tiếp để lần lượt sinh ra các mẫu từ các phân phối trung gian cho đến khi chúng ta thu được các mẫu từ phân phối đích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4297"><span class="MJXp-msubsup" id="MJXp-Span-4298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4299" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4300" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-329-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-329">p_1</script></span>:</p><ul>
<li>for <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4302">k</span><span class="MJXp-mo" id="MJXp-Span-4303" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4304">1...</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4305">K</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-330-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-330">k=1...K</script></span>
<ul>
<li>Lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4306"><span class="MJXp-msubsup" id="MJXp-Span-4307"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4308" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4313"><span class="MJXp-mo" id="MJXp-Span-4314">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4315">k</span><span class="MJXp-mo" id="MJXp-Span-4316">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4309"><span class="MJXp-msubsup" id="MJXp-Span-4310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4311" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4312" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4317" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-4318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4320" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-4321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-4322"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-4323">x</span></span><span class="MJXp-mo" id="MJXp-Span-4324" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-331-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-331">\boldsymbol{x}_{\eta_1}^{(k)} \sim p_0(\mathbf{x})</script></span></li>
<li>Lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4325"><span class="MJXp-msubsup" id="MJXp-Span-4326"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4327" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4332"><span class="MJXp-mo" id="MJXp-Span-4333">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4334">k</span><span class="MJXp-mo" id="MJXp-Span-4335">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4328"><span class="MJXp-msubsup" id="MJXp-Span-4329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4330" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4331" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4336" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-4337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4338" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4339" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4341" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4342" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4344"><span class="MJXp-mrow" id="MJXp-Span-4345" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-4346">x</span></span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4351"><span class="MJXp-mo" id="MJXp-Span-4352">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4353">k</span><span class="MJXp-mo" id="MJXp-Span-4354">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4347"><span class="MJXp-msubsup" id="MJXp-Span-4348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4349" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4350" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4355"><span class="MJXp-mo" id="MJXp-Span-4356" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4357"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4358" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4363"><span class="MJXp-mo" id="MJXp-Span-4364">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4365">k</span><span class="MJXp-mo" id="MJXp-Span-4366">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4359"><span class="MJXp-msubsup" id="MJXp-Span-4360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4361" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4362" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4367" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-332-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-332">\boldsymbol{x}_{\eta_2}^{(k)} \sim T_{\eta_1}(\mathbf{x}_{\eta_2}^{(k)}|\boldsymbol{x}_{\eta_1}^{(k)})</script></span></li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4368"><span class="MJXp-mo" id="MJXp-Span-4369" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4370" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4371" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-333-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-333">...</script></span></li>
<li>Lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4372"><span class="MJXp-msubsup" id="MJXp-Span-4373"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4374" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4382"><span class="MJXp-mo" id="MJXp-Span-4383">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4384">k</span><span class="MJXp-mo" id="MJXp-Span-4385">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4375"><span class="MJXp-msubsup" id="MJXp-Span-4376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4377" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4379">n</span><span class="MJXp-mo" id="MJXp-Span-4380">−</span><span class="MJXp-mn" id="MJXp-Span-4381">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4386" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-4387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4388" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4389" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4391" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4392" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393">n</span><span class="MJXp-mo" id="MJXp-Span-4394">−</span><span class="MJXp-mn" id="MJXp-Span-4395">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4397"><span class="MJXp-mrow" id="MJXp-Span-4398" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-4399">x</span></span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4407"><span class="MJXp-mo" id="MJXp-Span-4408">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4409">k</span><span class="MJXp-mo" id="MJXp-Span-4410">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4400"><span class="MJXp-msubsup" id="MJXp-Span-4401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4402" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4404">n</span><span class="MJXp-mo" id="MJXp-Span-4405">−</span><span class="MJXp-mn" id="MJXp-Span-4406">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4411"><span class="MJXp-mo" id="MJXp-Span-4412" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4413"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4414" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4422"><span class="MJXp-mo" id="MJXp-Span-4423">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4424">k</span><span class="MJXp-mo" id="MJXp-Span-4425">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4415"><span class="MJXp-msubsup" id="MJXp-Span-4416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4418" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4419">n</span><span class="MJXp-mo" id="MJXp-Span-4420">−</span><span class="MJXp-mn" id="MJXp-Span-4421">2</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4426" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-334-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-334">\boldsymbol{x}_{\eta_{n-1}}^{(k)} \sim T_{\eta_{n-2}}(\mathbf{x}_{\eta_{n-1}}^{(k)}|\boldsymbol{x}_{\eta_{n-2}}^{(k)})</script></span></li>
<li>Lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4427"><span class="MJXp-msubsup" id="MJXp-Span-4428"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4429" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4435"><span class="MJXp-mo" id="MJXp-Span-4436">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4437">k</span><span class="MJXp-mo" id="MJXp-Span-4438">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4430"><span class="MJXp-msubsup" id="MJXp-Span-4431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4432" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4433" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4434">n</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4439" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-msubsup" id="MJXp-Span-4440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4441" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4442" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4444" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4445" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4446">n</span><span class="MJXp-mo" id="MJXp-Span-4447">−</span><span class="MJXp-mn" id="MJXp-Span-4448">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4449" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4450"><span class="MJXp-mrow" id="MJXp-Span-4451" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-4452">x</span></span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4458"><span class="MJXp-mo" id="MJXp-Span-4459">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4460">k</span><span class="MJXp-mo" id="MJXp-Span-4461">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4453"><span class="MJXp-msubsup" id="MJXp-Span-4454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4455" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4456" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4457">n</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4462"><span class="MJXp-mo" id="MJXp-Span-4463" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4464"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4465" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4473"><span class="MJXp-mo" id="MJXp-Span-4474">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4475">k</span><span class="MJXp-mo" id="MJXp-Span-4476">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4466"><span class="MJXp-msubsup" id="MJXp-Span-4467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4468" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4469" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4470">n</span><span class="MJXp-mo" id="MJXp-Span-4471">−</span><span class="MJXp-mn" id="MJXp-Span-4472">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4477" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-335-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-335">\boldsymbol{x}_{\eta_{n}}^{(k)} \sim T_{\eta_{n-1}}(\mathbf{x}_{\eta_{n}}^{(k)}|\boldsymbol{x}_{\eta_{n-1}}^{(k)})</script></span></li>
</ul>
</li>
</ul><ul>
<li>end</li>
</ul><p>Với mẫu k, ta có thể thu được trọng số quan trọng bằng cách xâu chuỗi các trọng số quan trọng cho những bước nhảy giữa các phân phối trung gian đã cho ở phương trình (18.49):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4478"><span class="MJXp-mtable" id="MJXp-Span-4479"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4480" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4481" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-4482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4483" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4484" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4485">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4486">k</span><span class="MJXp-mo" id="MJXp-Span-4487">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4488" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4489" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4490"><span class="MJXp-mrow" id="MJXp-Span-4491" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4492"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4494" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4493">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4495" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4497" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4498" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4500"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4501" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4506"><span class="MJXp-mo" id="MJXp-Span-4507">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4508">k</span><span class="MJXp-mo" id="MJXp-Span-4509">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4502"><span class="MJXp-msubsup" id="MJXp-Span-4503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4504" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4505" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4510" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4511"><span class="MJXp-mrow" id="MJXp-Span-4512" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4513"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4515" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4514">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4516" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-4517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4518"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4519" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4524"><span class="MJXp-mo" id="MJXp-Span-4525">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4526">k</span><span class="MJXp-mo" id="MJXp-Span-4527">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4520"><span class="MJXp-msubsup" id="MJXp-Span-4521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4522" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4523" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4528" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4529" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4530"><span class="MJXp-mrow" id="MJXp-Span-4531" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4532"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4534" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4533">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4535" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4537" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4538" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4539" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4540"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4541" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4546"><span class="MJXp-mo" id="MJXp-Span-4547">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4548">k</span><span class="MJXp-mo" id="MJXp-Span-4549">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4542"><span class="MJXp-msubsup" id="MJXp-Span-4543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4544" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4545" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4550" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4551"><span class="MJXp-mrow" id="MJXp-Span-4552" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4553"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4555" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4554">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4556" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4558" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4559" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4561"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4562" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4567"><span class="MJXp-mo" id="MJXp-Span-4568">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4569">k</span><span class="MJXp-mo" id="MJXp-Span-4570">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4563"><span class="MJXp-msubsup" id="MJXp-Span-4564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4565" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4566" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4572" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4573" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4574" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mfrac" id="MJXp-Span-4575" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4576"><span class="MJXp-mrow" id="MJXp-Span-4577" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4578"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4580" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4579">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4581" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4582">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4583" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4584"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4585" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4588"><span class="MJXp-mo" id="MJXp-Span-4589">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4590">k</span><span class="MJXp-mo" id="MJXp-Span-4591">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4586"><span class="MJXp-mn" id="MJXp-Span-4587">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4592" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4593"><span class="MJXp-mrow" id="MJXp-Span-4594" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4595"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4597" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4596">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4598" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4600" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4601" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4602">n</span><span class="MJXp-mo" id="MJXp-Span-4603">−</span><span class="MJXp-mn" id="MJXp-Span-4604">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4606"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4607" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4612"><span class="MJXp-mo" id="MJXp-Span-4613">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4614">k</span><span class="MJXp-mo" id="MJXp-Span-4615">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4608"><span class="MJXp-msubsup" id="MJXp-Span-4609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4610" style="margin-right: 0.05em;">η</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4611" style="vertical-align: -0.4em;">n</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4616" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4617" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-336-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-336">
w^{(k)}=\frac{\tilde{p}_{\eta_1}(\boldsymbol{x}^{(k)}_{\eta_1})}{\tilde{p}_0(\boldsymbol{x}^{(k)}_{\eta_1})}
\frac{\tilde{p}_{\eta_2}(\boldsymbol{x}^{(k)}_{\eta_2})}{\tilde{p}_{\eta_1}(\boldsymbol{x}^{(k)}_{\eta_2})}...
\frac{\tilde{p}_{1}(\boldsymbol{x}^{(k)}_{1})}{\tilde{p}_{\eta_{n-1}}(\boldsymbol{x}^{(k)}_{\eta_n})}.\tag{18.52}
</script></span><br>
Để tránh các vấn đề về số như tràn luồng, giải pháp tốt nhất là tính log <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4618"><span class="MJXp-msubsup" id="MJXp-Span-4619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4620" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4621" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4622">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4623">k</span><span class="MJXp-mo" id="MJXp-Span-4624">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-337-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-337">w^{(k)}</script></span> bằng cách cộng và trừ các logarit của xác suất, thay vì tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4625"><span class="MJXp-msubsup" id="MJXp-Span-4626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4627" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4628" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4629">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4630">k</span><span class="MJXp-mo" id="MJXp-Span-4631">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-338-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-338">w^{(k)}</script></span> bằng cách nhân và chia các xác suất.</p><p>Với phương pháp lấy mẫu này, và các trọng số quan trọng được cho trong phương trình (18.52), ước lượng tỷ lệ của các hàm phân hoạch được cho bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4632"><span class="MJXp-mtable" id="MJXp-Span-4633"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4634" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4635" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-4636" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4638" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4639" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4641" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4642" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4643" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mfrac" id="MJXp-Span-4644" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4645">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4646">K</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-4647"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4653" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4654">K</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-4648" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4649" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4650">k</span><span class="MJXp-mo" id="MJXp-Span-4651">=</span><span class="MJXp-mn" id="MJXp-Span-4652">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4656" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4657" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4658">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4659">k</span><span class="MJXp-mo" id="MJXp-Span-4660">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4661" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-339-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-339">
\frac{Z_1}{Z_0}\approx\frac{1}{K}\sum\limits_{k=1}^{K}w^{(k)}.\tag{18.53}
</script></span><br>
Để xác nhận rằng phương pháp này thực hiện đúng ý đồ của phương pháp lấy mẫu theo độ quan trọng, chúng ta có thể chứng minh (Neal, 2001) rằng phương pháp AIS tương đương với phép lấy mẫu theo độ quan trọng đơn giản trên một không gian trạng thái được mở rộng, với các điểm lấy mẫu nằm trên không gian tích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4662"><span class="MJXp-mo" id="MJXp-Span-4663" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-4664"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4665" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4666" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4668" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4669" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4670" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4671" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4672" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4673" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4674" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4675"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4676" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4677" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4679" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4680" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4681">n</span><span class="MJXp-mo" id="MJXp-Span-4682">−</span><span class="MJXp-mn" id="MJXp-Span-4683">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4684" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4685"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4686" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4687" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4688">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4689" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-340-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-340">[\boldsymbol{x}_{\eta_1},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{1}]</script></span>. Để làm được điều này, ta định nghĩa phân phối trên không gian mở rộng như sau:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4690"><span class="MJXp-mtable" id="MJXp-Span-4691"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4692" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4693" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-4694"><span class="MJXp-munderover" id="MJXp-Span-4695"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4697" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4696">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4699"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4700" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4701" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4703" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4704" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4705" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4706" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4707" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4708" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4709" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4710"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4711" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4712" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4714" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4715" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4716">n</span><span class="MJXp-mo" id="MJXp-Span-4717">−</span><span class="MJXp-mn" id="MJXp-Span-4718">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4721" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4722" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4723">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4724" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-341-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-341">
\tilde{p}(\boldsymbol{x}_{\eta_1},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{1}) \tag{18.54}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4725"><span class="MJXp-mtable" id="MJXp-Span-4726"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4727" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4728" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4729" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4730"><span class="MJXp-mrow" id="MJXp-Span-4731" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4732"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4734" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4733">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4735" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4736" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4737"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4738" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4739" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4740" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4741"><span class="MJXp-mrow" id="MJXp-Span-4742" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4743"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-4745" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4744">T</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4746" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4748" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4749" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4750">n</span><span class="MJXp-mo" id="MJXp-Span-4751">−</span><span class="MJXp-mn" id="MJXp-Span-4752">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4753" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4754"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4755" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4756" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4758" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4759" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4760">n</span><span class="MJXp-mo" id="MJXp-Span-4761">−</span><span class="MJXp-mn" id="MJXp-Span-4762">1</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4763"><span class="MJXp-mo" id="MJXp-Span-4764" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4765" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4766"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4767" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4768" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4769" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4770"><span class="MJXp-mrow" id="MJXp-Span-4771" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4772"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-4774" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4773">T</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4775" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4777" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4778" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4779">n</span><span class="MJXp-mo" id="MJXp-Span-4780">−</span><span class="MJXp-mn" id="MJXp-Span-4781">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4782" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4783"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4784" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4785" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4787" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4788" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4789">n</span><span class="MJXp-mo" id="MJXp-Span-4790">−</span><span class="MJXp-mn" id="MJXp-Span-4791">2</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4792"><span class="MJXp-mo" id="MJXp-Span-4793" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4794" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4795"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4796" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4797" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4799" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4800" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4801">n</span><span class="MJXp-mo" id="MJXp-Span-4802">−</span><span class="MJXp-mn" id="MJXp-Span-4803">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4804" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4805" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4806" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4807" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-4808"><span class="MJXp-mrow" id="MJXp-Span-4809" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4810"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-4812" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4811">T</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4813" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4815" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4816" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4817">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4819"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4820" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4821" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4823" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4824" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4825">1</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4826"><span class="MJXp-mo" id="MJXp-Span-4827" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4828" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4829"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4830" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4831" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4833" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4834" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4835">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4836" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4837" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-342-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-342">
=\tilde{p}_1(\boldsymbol{x}_1)\tilde{T}_{\eta_{n-1}}(\boldsymbol{x}_{\eta_{n-1}}|\,\boldsymbol{x}_1)
\tilde{T}_{\eta_{n-2}}(\boldsymbol{x}_{\eta_{n-2}}|\,\boldsymbol{x}_{\eta_{n-1}})...
\tilde{T}_{\eta_{1}}(\boldsymbol{x}_{\eta_{1}}|\,\boldsymbol{x}_{\eta_{2}}),\tag{18.55}
</script></span></p><p>Trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4838"><span class="MJXp-msubsup" id="MJXp-Span-4839"><span class="MJXp-mrow" id="MJXp-Span-4840" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4841"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-4843" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4842">T</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4844" style="vertical-align: -0.4em;">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-343-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-343">\tilde{T}_a</script></span> là nghịch đảo của toán tử chuyển tiếp định nghĩa bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4845"><span class="MJXp-msubsup" id="MJXp-Span-4846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4847" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4848" style="vertical-align: -0.4em;">a</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-344-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-344">T_a</script></span> (thông qua một ứng dụng của định luật Bayes):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4849"><span class="MJXp-mtable" id="MJXp-Span-4850"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4851" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4852" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-4853"><span class="MJXp-mrow" id="MJXp-Span-4854" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4855"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-4857" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4856">T</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4858" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-4859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4860"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4861" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-4862" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-4863"><span class="MJXp-mo" id="MJXp-Span-4864" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4865" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4866">x</span><span class="MJXp-mo" id="MJXp-Span-4867" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4868" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4869" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4871" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4872" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-4873" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4874"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4875" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-4876" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4877" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4879" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4880" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mrow" id="MJXp-Span-4881"><span class="MJXp-mo" id="MJXp-Span-4882" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4883">x</span><span class="MJXp-mo" id="MJXp-Span-4884" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4886" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4887" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-4888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4889">x</span><span class="MJXp-mspace" id="MJXp-Span-4890" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4891"><span class="MJXp-mo" id="MJXp-Span-4892" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4893" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msup" id="MJXp-Span-4894"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4895" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-4896" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4897" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4898" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4899" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-4900"><span class="MJXp-munderover" id="MJXp-Span-4901"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-4905" style="margin-left: 0px; margin-right: 0px;">~</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-4902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4903" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4904" style="vertical-align: -0.4em;">a</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4906" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-4907"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4908" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-4909" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4910" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-4911"><span class="MJXp-munderover" id="MJXp-Span-4912"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-4916" style="margin-left: 0px; margin-right: 0px;">~</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-4913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4914" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4915" style="vertical-align: -0.4em;">a</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4917"><span class="MJXp-mo" id="MJXp-Span-4918" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4919">x</span><span class="MJXp-mo" id="MJXp-Span-4920" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4922" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4923" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mo" id="MJXp-Span-4924" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4925">x</span><span class="MJXp-mspace" id="MJXp-Span-4926" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4927"><span class="MJXp-mo" id="MJXp-Span-4928" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-4929" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msup" id="MJXp-Span-4930"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4931" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-4932" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4933" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4934" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-345-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-345">
\tilde{T}_a(\boldsymbol{x'}|\,\boldsymbol{x})=\frac{p_a(\boldsymbol{x'})}{p_a{(\boldsymbol{x})}}T_a(\boldsymbol{x}\,|\,\boldsymbol{x'})=
\frac{\tilde{p_a}(\boldsymbol{x'})}{\tilde{p_a}{(\boldsymbol{x})}}T_a(\boldsymbol{x}\,|\,\boldsymbol{x'}).\tag{18.56}
</script></span></p><p>Gán đoạn trên vào biểu thức phân phối đồng thời trên không gian trạng thái mở rộng cho trong phương trình (18.55), ta được:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4935"><span class="MJXp-mtable" id="MJXp-Span-4936"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4937" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4938" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-4939"><span class="MJXp-munderover" id="MJXp-Span-4940"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4942" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4941">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4943" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4944"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4945" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4946" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4948" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4949" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4950" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-4951" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4952" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4953" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4954" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4955"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4956" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4957" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4959" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4960" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4961">n</span><span class="MJXp-mo" id="MJXp-Span-4962">−</span><span class="MJXp-mn" id="MJXp-Span-4963">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4964" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4965"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4966" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4967" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4968">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4969" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-346-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-346">
\tilde{p}(\boldsymbol{x}_{\eta_1},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{1}) \tag{18.57}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4970"><span class="MJXp-mtable" id="MJXp-Span-4971"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-4972" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4973" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4974" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4975"><span class="MJXp-mrow" id="MJXp-Span-4976" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4977"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4979" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4978">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4980" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4981" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4982"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4983" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4984" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4985" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-4986" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4987"><span class="MJXp-mrow" id="MJXp-Span-4988" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-4989"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-4991" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4990">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4992" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-4993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4994" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4995" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4996">n</span><span class="MJXp-mo" id="MJXp-Span-4997">−</span><span class="MJXp-mn" id="MJXp-Span-4998">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4999" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5000"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5001" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5002" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5004" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5005" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5006">n</span><span class="MJXp-mo" id="MJXp-Span-5007">−</span><span class="MJXp-mn" id="MJXp-Span-5008">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5009" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5010"><span class="MJXp-mrow" id="MJXp-Span-5011" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5012"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5014" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5013">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5015" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5017" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5018" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5019">n</span><span class="MJXp-mo" id="MJXp-Span-5020">−</span><span class="MJXp-mn" id="MJXp-Span-5021">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5022" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5023"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5024" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5025" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5026">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-5027" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5029" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5030" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5032" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5033" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5034">n</span><span class="MJXp-mo" id="MJXp-Span-5035">−</span><span class="MJXp-mn" id="MJXp-Span-5036">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5038"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5039" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5040" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5041">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-5042" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5043"><span class="MJXp-mo" id="MJXp-Span-5044" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5045" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5046"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5047" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5048" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5050" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5051" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5052">n</span><span class="MJXp-mo" id="MJXp-Span-5053">−</span><span class="MJXp-mn" id="MJXp-Span-5054">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5055" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-5056"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5062" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5063">n</span><span class="MJXp-mo" id="MJXp-Span-5064">−</span><span class="MJXp-mn" id="MJXp-Span-5065">2</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-5057" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5058" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5059">i</span><span class="MJXp-mo" id="MJXp-Span-5060">=</span><span class="MJXp-mn" id="MJXp-Span-5061">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5066" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5067"><span class="MJXp-mrow" id="MJXp-Span-5068" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5069"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5071" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5070">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5072" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5074" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5075" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5076">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5077" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5078"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5079" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5080" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5082" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5083" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5084">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5085" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5086"><span class="MJXp-mrow" id="MJXp-Span-5087" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5088"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5090" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5089">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5091" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5093" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5094" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5095">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5097"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5098" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5099" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5101" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5102" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5103">i</span><span class="MJXp-mo" id="MJXp-Span-5104">+</span><span class="MJXp-mn" id="MJXp-Span-5105">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5106" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5108" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5109" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5111" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5112" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5113">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5115"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5116" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5117" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5119" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5120" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5121">i</span><span class="MJXp-mo" id="MJXp-Span-5122">+</span><span class="MJXp-mn" id="MJXp-Span-5123">1</span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5124" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5125"><span class="MJXp-mo" id="MJXp-Span-5126" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5127" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5128"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5129" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5130" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5132" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5133" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5134">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-347-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-347">
=\tilde{p}_1(\boldsymbol{x}_1)\frac{\tilde{p}_{\eta_{n-1}}(\boldsymbol{x}_{\eta_{n-1}})}{\tilde{p}_{\eta_{n-1}}(\boldsymbol{x}_{1})}
T_{\eta_{n-1}}(\boldsymbol{x}_{1}\,|\,\boldsymbol{x}_{\eta_{n-1}})
\prod\limits_{i=1}^{n-2}
\frac{\tilde{p}_{\eta_{i}}(\boldsymbol{x}_{\eta_{i}})}{\tilde{p}_{\eta_{i}}(\boldsymbol{x}_{\eta_{i+1}})}
T_{\eta_{i}}(\boldsymbol{x}_{\eta_{i+1}}\,|\,\boldsymbol{x}_{\eta_{i}})  
\tag{18.58}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5136"><span class="MJXp-mtable" id="MJXp-Span-5137"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-5138" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-5139" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-5140" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-5141" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5142"><span class="MJXp-mrow" id="MJXp-Span-5143" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5144"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5146" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5145">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5147" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5149"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5150" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5151" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5152" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5153"><span class="MJXp-mrow" id="MJXp-Span-5154" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5155"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5157" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5156">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5158" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5160" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5161" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5162">n</span><span class="MJXp-mo" id="MJXp-Span-5163">−</span><span class="MJXp-mn" id="MJXp-Span-5164">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5165" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5166"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5167" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5168" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5171" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5172" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5174" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5175" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5176">n</span><span class="MJXp-mo" id="MJXp-Span-5177">−</span><span class="MJXp-mn" id="MJXp-Span-5178">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5180"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5181" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5182" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mspace" id="MJXp-Span-5183" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5184"><span class="MJXp-mo" id="MJXp-Span-5185" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5186" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5187"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5188" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5189" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5191" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5192" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5193">n</span><span class="MJXp-mo" id="MJXp-Span-5194">−</span><span class="MJXp-mn" id="MJXp-Span-5195">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5196" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5197"><span class="MJXp-mrow" id="MJXp-Span-5198" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5199"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5201" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5200">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5202" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5204" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5205" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5206" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5207"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5208" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5209" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5211" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5212" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5213">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5214" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-5215"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5221" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5222">n</span><span class="MJXp-mo" id="MJXp-Span-5223">−</span><span class="MJXp-mn" id="MJXp-Span-5224">2</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-5216" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5217" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5218">i</span><span class="MJXp-mo" id="MJXp-Span-5219">=</span><span class="MJXp-mn" id="MJXp-Span-5220">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5225" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5226"><span class="MJXp-mrow" id="MJXp-Span-5227" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5228"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5230" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5229">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5231" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5233" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5234" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5235">i</span><span class="MJXp-mo" id="MJXp-Span-5236">+</span><span class="MJXp-mn" id="MJXp-Span-5237">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5239"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5240" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5241" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5243" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5244" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5245">i</span><span class="MJXp-mo" id="MJXp-Span-5246">+</span><span class="MJXp-mn" id="MJXp-Span-5247">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5248" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5249"><span class="MJXp-mrow" id="MJXp-Span-5250" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5251"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5253" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5252">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5254" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5256" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5257" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5258">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5260"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5261" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5262" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5264" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5265" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5266">i</span><span class="MJXp-mo" id="MJXp-Span-5267">+</span><span class="MJXp-mn" id="MJXp-Span-5268">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5269" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-5270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5271" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5272" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5274" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5275" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5276">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5278"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5279" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5280" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5282" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5283" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5284">i</span><span class="MJXp-mo" id="MJXp-Span-5285">+</span><span class="MJXp-mn" id="MJXp-Span-5286">1</span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5287" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5288"><span class="MJXp-mo" id="MJXp-Span-5289" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5290" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5291"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5292" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5293" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5295" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5296" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5297">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5299" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-348-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-348">
=\frac{\tilde{p}_1(\boldsymbol{x}_1)}{\tilde{p}_{\eta_{n-1}}(\boldsymbol{x}_1)} 
T_{\eta_{n-1}}(\boldsymbol{x}_1\,|\,\boldsymbol{x}_{\eta_{n-1}})
\tilde{p}_{\eta_1}(\boldsymbol{x}_{\eta_{1}})
\prod\limits_{i=1}^{n-2}
\frac{\tilde{p}_{\eta_{i+1}}(\boldsymbol{x}_{\eta_{i+1}})}{\tilde{p}_{\eta_{i}}(\boldsymbol{x}_{\eta_{i+1}})}
T_{\eta_{i}}(\boldsymbol{x}_{\eta_{i+1}}\,|\,\boldsymbol{x}_{\eta_{i}}). 
\tag{18.59}
</script></span></p><p>Chúng ta giờ đã có các phương tiện để sinh mẫu từ phân phối đồng thời được đề xuất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5301">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-349-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-349">q</script></span> trên mẫu được mở rộng thông qua một cơ chế lấy mẫu được cho ở trên, trong đó phân phối đồng thời được cho bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5302"><span class="MJXp-mtable" id="MJXp-Span-5303"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-5304" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-5305" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5306">q</span><span class="MJXp-mo" id="MJXp-Span-5307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5308"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5309" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5310" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5312" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5313" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5314">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5315" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-5316" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5317" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5318" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5319" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5320"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5321" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5322" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5324" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5325" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5326">n</span><span class="MJXp-mo" id="MJXp-Span-5327">−</span><span class="MJXp-mn" id="MJXp-Span-5328">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5329" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5330"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5331" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5332" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5333"><span class="MJXp-mn" id="MJXp-Span-5334">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5335" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5336" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5338" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5339" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-5340" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5341"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5342" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5343" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5345" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5346" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5347">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-5349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5350" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5351" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5353" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5354" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5356"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5357" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5358" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5360" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5361" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5362">2</span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-5363" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5364"><span class="MJXp-mo" id="MJXp-Span-5365" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5366" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5367"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5368" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5369" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5371" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5372" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5373">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5374" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5375" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5376" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5377" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-5378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5379" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5380" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5382" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5383" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5384">n</span><span class="MJXp-mo" id="MJXp-Span-5385">−</span><span class="MJXp-mn" id="MJXp-Span-5386">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5388"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5389" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5390" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5391">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-5392" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-5393"><span class="MJXp-mo" id="MJXp-Span-5394" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-5395" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-5396"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5397" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5398" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5400" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5401" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5402">n</span><span class="MJXp-mo" id="MJXp-Span-5403">−</span><span class="MJXp-mn" id="MJXp-Span-5404">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5405" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5406" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-350-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-350">
q(\boldsymbol{x}_{\eta_{1}},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{{1}})=p_0(\boldsymbol{x}_{\eta_{1}})T_{\eta_1}
(\boldsymbol{x}_{\eta_{2}}\,|\,\boldsymbol{x}_{\eta_{1}})...
T_{\eta_{n-1}}
(\boldsymbol{x}_{1}\,|\,\boldsymbol{x}_{\eta_{n-1}}). \tag{18.60}
</script></span><br>
Chúng ta có một phân phối đồng thời trên không gian mở rộng được cho bởi phương trình (18.59). Với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5408">q</span><span class="MJXp-mo" id="MJXp-Span-5409" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5410"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5411" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5412" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5414" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5415" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5416">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5417" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-5418" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5419" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5420" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5421" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5422"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5423" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5424" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5426" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5428">n</span><span class="MJXp-mo" id="MJXp-Span-5429">−</span><span class="MJXp-mn" id="MJXp-Span-5430">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5431" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5432"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5433" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5434" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5435"><span class="MJXp-mn" id="MJXp-Span-5436">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5437" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-351-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-351">q(\boldsymbol{x}_{\eta_{1}},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{{1}})</script></span> là phân phối đề xuất trên không gian trạng thái mở rộng mà từ đó chúng ta sẽ lấy mẫu, ta cần xác định các trọng số quan trọng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5438"><span class="MJXp-mtable" id="MJXp-Span-5439"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-5440" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-5441" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-5442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5443" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5444" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-5445">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5446">k</span><span class="MJXp-mo" id="MJXp-Span-5447">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-5448" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-5449" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-5450"><span class="MJXp-munderover" id="MJXp-Span-5451"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5453" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5452">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5455"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5456" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5457" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5459" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5460" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5461">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5462" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-5463" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5464" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5465" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5466" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5467"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5468" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5469" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5471" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5472" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5473">n</span><span class="MJXp-mo" id="MJXp-Span-5474">−</span><span class="MJXp-mn" id="MJXp-Span-5475">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5476" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5477"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5478" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5479" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5480"><span class="MJXp-mn" id="MJXp-Span-5481">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5482" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5483">q</span><span class="MJXp-mo" id="MJXp-Span-5484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5485"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5486" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5487" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5489" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5490" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5491">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5492" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-5493" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5494" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5495" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5496" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5497"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5498" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5499" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5501" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5502" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5503">n</span><span class="MJXp-mo" id="MJXp-Span-5504">−</span><span class="MJXp-mn" id="MJXp-Span-5505">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5506" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-5507"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5508" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5509" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5510"><span class="MJXp-mn" id="MJXp-Span-5511">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5512" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5513" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-5514" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5515"><span class="MJXp-mrow" id="MJXp-Span-5516" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5517"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5519" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5518">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5520" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5521" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5522"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5523" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5525"><span class="MJXp-mo" id="MJXp-Span-5526">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5527">k</span><span class="MJXp-mo" id="MJXp-Span-5528">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-5524">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5529" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5530"><span class="MJXp-mrow" id="MJXp-Span-5531" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5532"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5534" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5533">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5535" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5537" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5538" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5539">n</span><span class="MJXp-mo" id="MJXp-Span-5540">−</span><span class="MJXp-mn" id="MJXp-Span-5541">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5542" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5543"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5544" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5552"><span class="MJXp-mo" id="MJXp-Span-5553">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5554">k</span><span class="MJXp-mo" id="MJXp-Span-5555">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5545"><span class="MJXp-msubsup" id="MJXp-Span-5546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5547" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5548" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5549">n</span><span class="MJXp-mo" id="MJXp-Span-5550">−</span><span class="MJXp-mn" id="MJXp-Span-5551">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5556" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5557" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5558" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-5559" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mfrac" id="MJXp-Span-5560" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5561"><span class="MJXp-mrow" id="MJXp-Span-5562" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5563"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5565" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5564">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5566" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5568" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5569" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5571"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5572" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5577"><span class="MJXp-mo" id="MJXp-Span-5578">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5579">k</span><span class="MJXp-mo" id="MJXp-Span-5580">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5573"><span class="MJXp-msubsup" id="MJXp-Span-5574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5575" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5576" style="vertical-align: -0.4em;">2</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5581" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5582"><span class="MJXp-mrow" id="MJXp-Span-5583" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5584"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5586" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5585">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5587" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5588"><span class="MJXp-mn" id="MJXp-Span-5589">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5590" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5591"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5592" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5598"><span class="MJXp-mo" id="MJXp-Span-5599">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5600">k</span><span class="MJXp-mo" id="MJXp-Span-5601">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5593"><span class="MJXp-msubsup" id="MJXp-Span-5594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5595" style="margin-right: 0.05em;">η</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5596" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-5597">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5602" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5603" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5604"><span class="MJXp-mrow" id="MJXp-Span-5605" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5606"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5608" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5607">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5609" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-5610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5611" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5612" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5613" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5614"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5615" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5620"><span class="MJXp-mo" id="MJXp-Span-5621">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5622">k</span><span class="MJXp-mo" id="MJXp-Span-5623">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5616"><span class="MJXp-msubsup" id="MJXp-Span-5617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5618" style="margin-right: 0.05em;">η</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5619" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5624" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5625"><span class="MJXp-mrow" id="MJXp-Span-5626" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5627"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5629" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5628">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5630" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-5631"><span class="MJXp-mn" id="MJXp-Span-5632">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5633" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5634"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5635" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5638"><span class="MJXp-mo" id="MJXp-Span-5639">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5640">k</span><span class="MJXp-mo" id="MJXp-Span-5641">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5636"><span class="MJXp-mn" id="MJXp-Span-5637">0</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5642" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5643" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-352-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-352">
w^{(k)}=\frac{\tilde{p}(\boldsymbol{x}_{\eta_{1}},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{{1}})}{q(\boldsymbol{x}_{\eta_{1}},...,\boldsymbol{x}_{\eta_{n-1}},\boldsymbol{x}_{{1}})}=
\frac{\tilde{p}_1(\boldsymbol{x}_1^{(k)})}{\tilde{p}_{\eta_{n-1}}(\boldsymbol{x}_{\eta_{n-1}}^{(k)})}...
\frac{\tilde{p}_{\eta_2}(\boldsymbol{x}_{\eta_2}^{(k)})}{\tilde{p}_{{1}}(\boldsymbol{x}_{\eta_{1}}^{(k)})}
\frac{\tilde{p}_{\eta_1}(\boldsymbol{x}_{\eta_1}^{(k)})}{\tilde{p}_{{0}}(\boldsymbol{x}_{0}^{(k)})}.\tag{18.61}
</script></span><br>
Các trọng số này giống hệt những trọng số được đề xuất cho AIS. Do đó chúng ta có thể hiểu AIS như là một phép lấy mẫu theo độ quan trọng áp dụng cho một trạng thái mở rộng, và tính hợp lệ của nó tuân theo tính hợp lệ của phép lấy mẫu theo độ quan trọng.</p><p>Ủ lấy mẫu theo độ quan trọng được khám phá lần đầu tiên bởi Jarzynski (1997) và sau đó, một cách độc lập, bởi Neal (2001). Đây hiện là cách phổ biến nhất để ước tính hàm phân hoạch cho các mô hình xác suất vô hướng. Nguyên nhân của việc này có liên quan tới sự xuất bản của một bài báo có tính ảnh hưởng cao (Salakhutdinov and Murray, 2008), mô tả ứng dụng của AIS trong việc ước tính hàm phân hoạch của máy Boltzmann hạn chế và mạng phân phối đa tầng hơn là việc AIS có những lợi thế hơn hẳn so với phương pháp còn lại được mô tả dưới đây.</p><p>Cuộc thảo luận về các tính chất của bộ ước lượng AIS (ví dụ về phương sai và tính hiệu quả của nó) có thể được tìm thấy trong Neal (2001).</p><h3 id="1872-Lấy-mẫu-bắc-cầu">18.7.2. Lấy mẫu bắc cầu</h3><p>Lấy mẫu bắc cầu (Bennett, 1976) là một phương pháp khác, giống như AIS, giải quyết những thiếu sót của phép lấy mẫu theo độ quan trọng. Thay vì xâu chuỗi một dãy các phân phối trung gian lại với nhau, lấy mẫu bắc cầu sử dụng một phân phối đơn lẻ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5644"><span class="MJXp-msubsup" id="MJXp-Span-5645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5646" style="margin-right: 0.05em;">p</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5647" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-353-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-353">p_*</script></span>, được gọi là cầu, để nội suy giữa một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5648"><span class="MJXp-msubsup" id="MJXp-Span-5649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5650" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5651" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-354-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-354">p_0</script></span> với hàm phân hoạch đã biết, và một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5652"><span class="MJXp-msubsup" id="MJXp-Span-5653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5654" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5655" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-355-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-355">p_1</script></span> mà chúng ta đang tìm cách ước tính hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5656"><span class="MJXp-msubsup" id="MJXp-Span-5657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5658" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5659" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-356-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-356">Z_1</script></span> của nó.</p><p>Lấy mẫu bắc cầu ước tính tỷ lệ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5660"><span class="MJXp-msubsup" id="MJXp-Span-5661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5662" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5663" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5664"><span class="MJXp-mo" id="MJXp-Span-5665" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-5666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5667" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5668" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-357-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-357">Z_1/Z_0</script></span> dựa vào tỷ lệ của các trọng số quan trọng theo kỳ vọng giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5669"><span class="MJXp-msubsup" id="MJXp-Span-5670"><span class="MJXp-mrow" id="MJXp-Span-5671" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5672"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5674" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5673">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5675" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-358-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-358">\tilde{p}_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5676"><span class="MJXp-msubsup" id="MJXp-Span-5677"><span class="MJXp-mrow" id="MJXp-Span-5678" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5679"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5681" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5680">p</span></span></span></span></span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5682" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-359-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-359">\tilde{p}_*</script></span>, và giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5683"><span class="MJXp-msubsup" id="MJXp-Span-5684"><span class="MJXp-mrow" id="MJXp-Span-5685" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5686"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5688" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5687">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5689" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-360-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-360">\tilde{p}_1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5690"><span class="MJXp-msubsup" id="MJXp-Span-5691"><span class="MJXp-mrow" id="MJXp-Span-5692" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5693"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5695" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5694">p</span></span></span></span></span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5696" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-361-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-361">\tilde{p}_*</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-5697"><span class="MJXp-mtable" id="MJXp-Span-5698"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-5699" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-5700" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-5701" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5703" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5704" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5706" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5707" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5708" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-munderover" id="MJXp-Span-5709"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5715" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5716">K</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-5710" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5711" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5712">k</span><span class="MJXp-mo" id="MJXp-Span-5713">=</span><span class="MJXp-mn" id="MJXp-Span-5714">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5717"><span class="MJXp-mo" id="MJXp-Span-5718" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-5719" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5720"><span class="MJXp-mrow" id="MJXp-Span-5721" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5722"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5724" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5723">p</span></span></span></span></span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5725" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-5726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5727"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5728" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5730"><span class="MJXp-mo" id="MJXp-Span-5731">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5732">k</span><span class="MJXp-mo" id="MJXp-Span-5733">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-5729">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5734" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5735"><span class="MJXp-mrow" id="MJXp-Span-5736" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5737"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5739" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5738">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5740" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-5741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5742"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5743" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5745"><span class="MJXp-mo" id="MJXp-Span-5746">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5747">k</span><span class="MJXp-mo" id="MJXp-Span-5748">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-5744">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5749" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5750"></span><span class="MJXp-mo" id="MJXp-Span-5751" style="margin-left: 0.111em; margin-right: 0.111em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-5752"></span><span class="MJXp-mo" id="MJXp-Span-5753" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-munderover" id="MJXp-Span-5754"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5760" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5761">K</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-5755" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-5756" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5757">k</span><span class="MJXp-mo" id="MJXp-Span-5758">=</span><span class="MJXp-mn" id="MJXp-Span-5759">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-5762" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5763"><span class="MJXp-mrow" id="MJXp-Span-5764" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5765"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5767" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5766">p</span></span></span></span></span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5768" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-5769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5770"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5771" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5773"><span class="MJXp-mo" id="MJXp-Span-5774">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5775">k</span><span class="MJXp-mo" id="MJXp-Span-5776">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-5772">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5777" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-5778"><span class="MJXp-mrow" id="MJXp-Span-5779" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5780"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5782" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5781">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5783" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5785"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5786" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5788"><span class="MJXp-mo" id="MJXp-Span-5789">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5790">k</span><span class="MJXp-mo" id="MJXp-Span-5791">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-5787">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5792" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5793" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-362-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-362">
\frac{Z_1}{Z_0}\approx\sum\limits_{k=1}^{K}\left.\frac{\tilde{p}_*(\boldsymbol{x}_0^{(k)})}{\tilde{p}_0(\boldsymbol{x}_0^{(k)})} 
\middle/\right.
\sum\limits_{k=1}^{K}\frac{\tilde{p}_*(\boldsymbol{x}_1^{(k)})}{\tilde{p}_1(\boldsymbol{x}_1^{(k)})}. \tag{18.62}
</script></span><br>
Nếu phân phối cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5794"><span class="MJXp-msubsup" id="MJXp-Span-5795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5796" style="margin-right: 0.05em;">p</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5797" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-363-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-363">p_*</script></span> được chọn cẩn thận để có một sự chồng lấp lớn với cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5798"><span class="MJXp-msubsup" id="MJXp-Span-5799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5800" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5801" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-364-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-364">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5802"><span class="MJXp-msubsup" id="MJXp-Span-5803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5804" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5805" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-365-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-365">p_1</script></span>, thì phép lấy mẫu bắc cầu có thể cho phép khoảng cách giữa hai phân phối (hoặc một cách chính thống, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5806"><span class="MJXp-msubsup" id="MJXp-Span-5807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5808" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5809" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5810">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5811">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-5812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5814" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5815" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mrow" id="MJXp-Span-5816"><span class="MJXp-mo" id="MJXp-Span-5817" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-5818"><span class="MJXp-mo" id="MJXp-Span-5819" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-5820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5821" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5822" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5823" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-366-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-366">D_{KL}(p_0||p_1)</script></span>) lớn hơn nhiều so với phép lấy mẫu theo độ quan trọng thuần túy.</p><p>Có thể thấy phân phối bắc cầu tối ưu được cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5824"><span class="MJXp-msubsup" id="MJXp-Span-5825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5826" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-5828"><span class="MJXp-mo" id="MJXp-Span-5829">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5830">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5831">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5832">t</span><span class="MJXp-mo" id="MJXp-Span-5833">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mo" id="MJXp-Span-5827">∗</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-5834" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-5835"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-5836">x</span></span><span class="MJXp-mo" id="MJXp-Span-5837" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5838" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mfrac" id="MJXp-Span-5839" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-5840"><span class="MJXp-mrow" id="MJXp-Span-5841" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5842"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5844" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5843">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5845" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-5846">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5847">x</span><span class="MJXp-mo" id="MJXp-Span-5848">)</span><span class="MJXp-msubsup" id="MJXp-Span-5849"><span class="MJXp-mrow" id="MJXp-Span-5850" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5851"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5853" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5852">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5854" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5855">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5856">x</span><span class="MJXp-mo" id="MJXp-Span-5857">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5858">r</span><span class="MJXp-msubsup" id="MJXp-Span-5859"><span class="MJXp-mrow" id="MJXp-Span-5860" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5861"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5863" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5862">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5864" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-5865">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5866">x</span><span class="MJXp-mo" id="MJXp-Span-5867">)</span><span class="MJXp-mo" id="MJXp-Span-5868">+</span><span class="MJXp-msubsup" id="MJXp-Span-5869"><span class="MJXp-mrow" id="MJXp-Span-5870" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-5871"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-5873" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5872">p</span></span></span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5874" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5875">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5876">x</span><span class="MJXp-mo" id="MJXp-Span-5877">)</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-367-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-367">p_*^{(opt)}(\mathbf{x})\propto\frac{\tilde{p}_0(\boldsymbol{x})\tilde{p}_1(\boldsymbol{x})}{r\tilde{p}_0(\boldsymbol{x})+\tilde{p}_1(\boldsymbol{x})}</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5879">r</span><span class="MJXp-mo" id="MJXp-Span-5880" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5882" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5883" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5884"><span class="MJXp-mo" id="MJXp-Span-5885" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-5886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5887" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5888" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-368-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-368">r=Z_1/Z_0</script></span>. Đầu tiên, đây giống như một nghiệm không thể giải được vì nó yêu cầu đại lượng mà chúng ta đang tìm cách ước tính, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5889"><span class="MJXp-msubsup" id="MJXp-Span-5890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5891" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5892" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5893"><span class="MJXp-mo" id="MJXp-Span-5894" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-5895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5896" style="margin-right: 0.05em;">Z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5897" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-369-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-369">Z_1/Z_0</script></span>. Tuy nhiên, ta có thể bắt đầu với một ước lượng thô của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5899">r</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-370-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-370">r</script></span> và sử dụng phân phối bắc cầu thu được để điều chỉnh lại ước lượng của chúng ta, một cách lặp đi lặp lại (Neal, 2005). Nghĩa là, chúng ta lặp đi lặp lại việc ước lượng tỷ lệ và cập nhật giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5901">r</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-371-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-371">r</script></span> tại mỗi vòng lặp.</p><p><strong>Lấy mãu theo độ quan trọng được liên kết</strong> Cả AIS và lấy mẫu bắc cầu đều có những lợi thế riêng của chúng. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5902"><span class="MJXp-msubsup" id="MJXp-Span-5903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5904" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-5905" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5906">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5907">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-5908" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5910" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5911" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mrow" id="MJXp-Span-5912"><span class="MJXp-mo" id="MJXp-Span-5913" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-5914"><span class="MJXp-mo" id="MJXp-Span-5915" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-5916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5917" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5918" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-5919" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-372-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-372">D_{KL}(p_0||p_1)</script></span> không quá lớn (vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5920"><span class="MJXp-msubsup" id="MJXp-Span-5921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5922" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5923" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-373-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-373">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5924"><span class="MJXp-msubsup" id="MJXp-Span-5925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5926" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5927" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-374-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-374">p_1</script></span> đủ gần nhau), lấy mẫu bắc cầu có thể là phương pháp hiệu quả hơn để ước lượng tỷ lệ của các hàm phân hoạch. Tuy nhiên, nếu hai phân phối quá xa nhau để một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5928"><span class="MJXp-msubsup" id="MJXp-Span-5929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5930" style="margin-right: 0.05em;">p</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-5931" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-375-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-375">p_*</script></span> có thể khoả lấp khoảng cách này, ta có thể dùng AIS với nhiều phân phối trung gian để nối liền khoảng cách giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5932"><span class="MJXp-msubsup" id="MJXp-Span-5933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5934" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5935" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-376-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-376">p_0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5936"><span class="MJXp-msubsup" id="MJXp-Span-5937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5938" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5939" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-377-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-377">p_1</script></span>. Neal (2005) đã cho thấy cách mà phương pháp lấy mẫu theo độ quan trọng được liên kết của ông tận dụng sức mạnh của chiến thuật lấy mẫu bắc cầu để bắc cầu nối giữa các phân phối trung gian sử dụng trong AIS và cải thiện đáng kể các ước lượng hàm phân hoạch.</p><p><em>Ước lượng hàm phân hoạch trong khi huấn luyện</em>: Mặc dù AIS được xem là phương pháp tiêu chuẩn để ước tính hàm phân hoạch cho nhiều mô hình vô hướng, việc có độ phức tạp tính toán đủ lớn khiến nó không khả thi để áp dụng trong lúc huấn luyện. Các chiến thuật thay thế đã được khám phá để ước tính hàm phân hoạch trong suốt quá trình huấn luyện.</p><p>Sử dụng một tổ hợp của lấy mẫu bắc cầu, chuỗi AIS ngắn, điều hoà song song, Desjardins et al. (2011) đã phát minh ra một cơ chế để theo dõi hàm phân hoạch của một máy Boltzman hạn chế trong suốt quá trình huấn luyện. Chiến thuật này dựa trên sự duy trì các ước lượng độc lập của các hàm phân hoạch của máy Boltzmann hạn chế trong mọi nhiệt độ vận hành trong phương pháp điều hoà song song. Các tác giả kết hợp các ước lượng tỷ lệ của hàm phân hoạch thông qua lấy mẫu bắc cầu của các chuỗi lân cận (ví dụ thu được từ điều hoà song song) với các ước lượng AIS theo thời gian, để tạo thành một ước lượng của hàm phân hoạch có phương sai thấp tại mỗi lần lặp của quá trình học.</p><p>Các công cụ được mô tả trong chương này cung cấp nhiều cách để khắc phục vấn đề liên quan đến hàm phân hoạch khó tính toán, nhưng có thể vẫn còn tồn tại nhiều khó khăn khác liên quan đến huấn luyện và sử dụng các mô hình sinh mẫu. Trong đó quan trọng nhất là vấn đề về suy diễn khó tính toán, chủ đề mà ta sẽ bàn luận ở chương tiếp theo.</p><p>-----------------------<br>
<strong>dzu.gidiel kết thúc dịch ở đây</strong><br>
--------------------------</p></div>