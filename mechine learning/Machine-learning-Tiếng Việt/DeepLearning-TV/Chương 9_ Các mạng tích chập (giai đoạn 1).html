<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Chương 9: Các mạng tích chập (giai đoạn 1) - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-9-Các-mạng-tích-chập-giai-đoạn-1"><a class="anchor hidden-xs" href="#Chương-9-Các-mạng-tích-chập-giai-đoạn-1" title="Chương-9-Các-mạng-tích-chập-giai-đoạn-1"><span class="octicon octicon-link"></span></a>Chương 9: Các mạng tích chập (giai đoạn 1)</h1><p><em>Mạng tích chập</em> (convolutional network), hay <em>mạng neuron tích chập</em> (convolutional neural network), hay viết tắt là CNN, là một loại mạng neuron đặc biệt để xử lý dữ liệu có cấu trúc dạng lưới. Chẳng hạn, dữ liệu dạng chuỗi thời gian (time-series) có thể được xem là lưới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">1</script></span> chiều chứa các mẫu lấy tại các khoảng thời gian nhất định,hay dữ liệu hình ảnh có thể được xem là lưới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mn" id="MJXp-Span-4">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">2</script></span> chiều tạo bởi các điểm ảnh. Mạng tích chập đã và đang được áp dụng rất thành công trong nhiều ứng dụng thực tiễn. Tên gọi “mạng neuron tích chập” cho biết mạng sử dụng phép toán <em>tích chập</em> (convolution). Tích chập là một dạng phép toán tuyến tính đặc biệt. <em>Mạng tích chập đơn giản là mạng neuron sử dụng phép tích chập thay vì phép nhân ma trận trong ít nhất một tầng của mạng</em>.</p><p>Trong chương này, trước tiên, chúng tôi sẽ mô tả phép tích chập. Sau đó chúng tôi giải thích tại sao ta sử dụng nó trong mạng neuron. Sau đó, chúng tôi miêu tả phép toán <em>gộp</em> (pooling); phép toán này được sử ụng trong hầu hết các mạng tích chập. Thông thường, phép tích chập sử dụng trong mạng neuron tích chập không hoàn toàn tương đồng với phép tích chập sử dụng trong các lĩnh vực khác, như trong kỹ thuật hay toán thuần túy. Chúng tôi sẽ trình bày một vài biến thể của hàm tích chập thường dùng trong các mạng neuron thực tế. Chúng tôi cũng trình bày cách áp dụng phép tích chập đối với các dạng dữ liệu khác nhau, với số chiều khác nhau. Sau đó ta thảo luận về các phương pháp nâng cao hiệu suất của phép tích chập. Mạng tích chập là một ví dụ nổi bật cách mà các nguyên lý của ngành thần kinh học ảnh hưởng tới học sâu như thế nào. Chúng tôi sẽ thảo luận các nguyên lý thần kinh học này, sau đó đưa ra kết luận cùng với nhận xét về vai trò của mạng tích chập trong lịch sử phát triển của học sâu. Một chủ đề mà chương này sẽ không đề cập tới việc làm thế nào để bạn chọn cho mình một cấu trúc mạng tích chập. Mục tiêu của chương này là giải thích các công cụ mà mạng tích chập cung cấp, và chương 11 sẽ hướng dẫn tổng quát về cách chọn công cụ phù hợp trong các trường hợp cụ thể. Làn sóng nghiên cứu thiết kế kiến trúc các mạng tích chập đang phát triển nhanh đến mức mỗi vài tuần tới vài tháng lại có một kiến trúc mới tốt hơn được công bố cho một tác vụ nào đó, khiến cho chúng tôi không thể liệt kê ra kiến trúc nào là tốt nhất trong giới hạn của cuốn sách này. Tuy nhiên, các kiến trúc tốt nhất đã và đang sử dụng các thành tố nền tảng mà chúng tôi mô tả ở đây.</p><h1 id="91-Phép-tích-chập"><a class="anchor hidden-xs" href="#91-Phép-tích-chập" title="91-Phép-tích-chập"><span class="octicon octicon-link"></span></a>9.1. Phép tích chập</h1><p>Định nghĩa chung nhất về phép tích chập là một phép toán giữa hai hàm có đối số thực. Chúng tôi sẽ đưa ra một vài ví dụ về hai hàm số kiểu này để giải thích rõ hơn về định nghĩa của phép tích chập.</p><p>Giả sử ta đang theo dõi vị trí một con tàu vũ trụ bằng một cảm biến laser. Cảm biến laser này cung cấp một đầu ra duy nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">x</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">t</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">x(t)</script></span> là vị trí của con tàu tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">t</script></span>. Trong đó cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">t</script></span> đều có giá trị thực, nghĩa là ta có thể nhận được kết quả của cảm biến laser tại bất kì thời điểm nào.</p><p>Bây giờ, giả sử cảm ứng laser bị nhiễu. Để giảm bớt sai lệch trong việc dự đoán vị trí con tàu, chúng ta sẽ lấy trung bình có trọng số của một vài phép đo. Dĩ nhiên, các giá trị vừa đo được càng gần thời điểm hiện tại càng quan trọng nên ta sẽ gán cho chúng các trọng số lớn hơn. Ta có thể làm điều này bằng cách sử dụng một hàm gán trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">w</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">a</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">w(a)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">a</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">a</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">a</script></span> là “tuổi” của một phép đo. Nếu ta áp dụng phép lấy trung bình có trọng số như vậy tại mọi thời điểm, ta sẽ có một hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">s</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">s</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">s</script></span> mới, là ước lượng được làm trơn của vị trí con tàu:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-25"><span class="MJXp-mtable" id="MJXp-Span-26"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-27" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-28" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">s</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">t</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">x</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">a</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">w</span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">t</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">a</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">a</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-35"><span class="mtable" id="MathJax-Span-36" style="min-width: 16.544em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.544em;"><span style="display: inline-block; position: absolute; width: 10.832em; height: 0px; clip: rect(-1.506em, 1010.78em, 1.026em, -999.997em); top: 0em; left: 50%; margin-left: -5.439em;"><span style="position: absolute; clip: rect(2.481em, 1010.78em, 5.013em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.832em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1010.78em, 5.013em, -999.997em); top: -3.984em; left: 50%; margin-left: -5.439em;"><span class="mtd" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.272em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.38em;"></span></span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">x</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">a</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.913em, 1001.94em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-9.1"><span class="mrow" id="MathJax-Span-38"><span class="mtext" id="MathJax-Span-39" style="font-family: MathJax_Main;">(9.1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">s(t) = \int x(a)w(t-a)da.\tag{9.1}</script></span></p><p>Phép toán này được gọi là <em>tích chập</em> (convolution), và thường được ký hiệu bằng dấu sao (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-62"><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">∗</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">*</script></span>).</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-50"><span class="MJXp-mtable" id="MJXp-Span-51"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-52" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-53" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">s</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">t</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">x</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">w</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">t</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-65"><span class="mtable" id="MathJax-Span-66" style="min-width: 13.041em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.041em;"><span style="display: inline-block; position: absolute; width: 7.33em; height: 0px; clip: rect(-0.913em, 1007.28em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -3.661em;"><span style="position: absolute; clip: rect(3.128em, 1007.28em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.33em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1007.28em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -3.661em;"><span class="mtd" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">w</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.859em, 1001.94em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-9.2"><span class="mrow" id="MathJax-Span-68"><span class="mtext" id="MathJax-Span-69" style="font-family: MathJax_Main;">(9.2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">s(t) = (x * w)(t).\tag{9.2}</script></span></p><p>Trong ví dụ trên, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">w</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">w</script></span> phải là một hàm mật độ xác suất hợp lệ, nếu không, ta sẽ không thu được đầu ra là trung bình có trọng số. Ngoài ra, trọng số mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">w</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">w</script></span> gán cho tất cả các đối số âm phải bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mn" id="MJXp-Span-73">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-93"><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">0</script></span>, nếu không, đầu ra sẽ tính tới cả số liệu đo được trong tương lai, vốn nằm ngoài khả năng của chúng ta. Tuy nhiên, đây chỉ là các ràng buộc cụ thể trong ví dụ này. Nói chung, phép tích chập là xác định cho mọi hàm với tích phân trên là xác định, và chúng có thể đuược sử dụng với mục đích khác chứ không chỉ để tính trung bình có trọng số.</p><p>Trong thuật ngữ của mạng tích chập, đối số đầu tiên của phép tích chập (trong ví dụ này là hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">x</script></span>) thường được gọi là <em>đầu vào</em> (input), và đối số thứ hai (trong ví dụ này là hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">w</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">w</script></span>) là <em>lõi</em> (kernel). Còn đầu ra đôi khi được gọi là <em>bản đồ đặc trưng</em> (feature map).</p><p>Trong ví dụ của ta, việc cảm biến laser đo được vị trí con tàu ở mọi thời điểm bất kỳ là phi thực tế. Thông thường, khi làm việc với dữ liệu trên máy tính, thời gian sẽ bị rời rạc hóa, và cảm biến sẽ cung cấp dữ liệu cách nhau một khoảng thời gian nhất định. Do đó, để phù hợp với thực tế, ta giả định rằng cảm biến sẽ thực hiện đo đạc theo từng giây. Chỉ số thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">t</script></span> lúc này chỉ có thể là số nguyên. Nếu giả định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">w</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">w</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">w</script></span> được tính theo số nguyên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">t</script></span>, chúng ta có thể định nghĩa phép tích chập rời rạc như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-86"><span class="MJXp-mtable" id="MJXp-Span-87"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-88" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-89" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">s</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">t</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">x</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">w</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">t</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-104"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi" id="MJXp-Span-111" style="margin-right: 0px; margin-left: 0px;">∞</span></span><span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-106" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">a</span><span class="MJXp-mo" id="MJXp-Span-108">=</span><span class="MJXp-mo" id="MJXp-Span-109">−</span><span class="MJXp-mi" id="MJXp-Span-110">∞</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">x</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">a</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">w</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">t</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">a</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-114"><span class="mtable" id="MathJax-Span-115" style="min-width: 22.201em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.201em;"><span style="display: inline-block; position: absolute; width: 16.49em; height: 0px; clip: rect(-1.775em, 1016.44em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -8.241em;"><span style="position: absolute; clip: rect(2.212em, 1016.44em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 16.49em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1016.44em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -8.241em;"><span class="mtd" id="MathJax-Span-119"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">w</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-135" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.38em;"><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1002.16em, 4.313em, -999.997em); top: -2.961em; left: 0em;"><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.757em;"><span class="mi" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">x</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">a</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-9.3"><span class="mrow" id="MathJax-Span-117"><span class="mtext" id="MathJax-Span-118" style="font-family: MathJax_Main;">(9.3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">s(t) = (x * w)(t) = \sum^\infty_{a=-\infty}x(a)w(t-a).\tag{9.3}</script></span></p><p>Trong các ứng dụng học máy, đầu vào thường là một mảng dữ liệu đa chiều, và lõi thường là một mảng đa chiều của các tham số thay đổi tuỳ theo các thuật toán học khác nhau. Chúng tôi gọi các mảng đa chiều này là các tensor. Do mỗi phần tử của đầu vào và lõi phải được lưu trữ hoàn toàn riêng biệt, ta thường giả định rằng các hàm này có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-mn" id="MJXp-Span-124">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-156"><span class="mn" id="MathJax-Span-157" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">0</script></span> tại mọi điểm, ngoại trừ một tập hữu hạn một số điểm mà ta lưu trữ các giá trị. Nghĩa là, trong thực tế, chúng ta có thể tính tổng vô hạn ở công thức trên bằng cách tính tổng trên một lượng hữu hạn các phần tử của mảng.</p><p>Điểm cuối cùng, chúng ta thường sử dụng hàm tích chập trên nhiều trục cùng lúc. Ví dụ, nếu dùng một bức ảnh hai chiều <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">I</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">I</script></span> làm đầu vào, ta cần sử dụng một lõi hai chiều <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">K</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">K</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-129"><span class="MJXp-mtable" id="MJXp-Span-130"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-131" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-132" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">S</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">j</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">I</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">K</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">i</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">j</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-151"><span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-left: 0px;">m</span></span></span><span class="MJXp-munderover" id="MJXp-Span-154"><span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156" style="margin-left: 0px;">n</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">I</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">m</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">n</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">K</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">i</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">m</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">j</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">n</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-165"><span class="mtable" id="MathJax-Span-166" style="min-width: 29.529em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 29.529em;"><span style="display: inline-block; position: absolute; width: 23.817em; height: 0px; clip: rect(-1.452em, 1023.76em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -11.905em;"><span style="position: absolute; clip: rect(2.535em, 1023.76em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 23.817em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1023.76em, 5.283em, -999.997em); top: -4.362em; left: 50%; margin-left: -11.905em;"><span class="mtd" id="MathJax-Span-170"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-190" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.6em, 4.259em, -999.997em); top: -2.961em; left: 0.434em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-193" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.259em, -999.997em); top: -2.961em; left: 0.488em;"><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">n</span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.237em, 1001.94em, 0.057em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="mjx-eqn-9.4"><span class="mrow" id="MathJax-Span-168"><span class="mtext" id="MathJax-Span-169" style="font-family: MathJax_Main;">(9.4)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">S(i,j) = (I*K)(i,j) = \sum_m \sum_n I(m,n)K(i-m,j-n).\tag{9.4}</script></span></p><p>Phép tích chập có tính giao hoán, do đó ta có thể viết:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-174"><span class="MJXp-mtable" id="MJXp-Span-175"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-176" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-177" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">S</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">i</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">j</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">K</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">I</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">i</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">j</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-196"><span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198" style="margin-left: 0px;">m</span></span></span><span class="MJXp-munderover" id="MJXp-Span-199"><span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201" style="margin-left: 0px;">n</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">I</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">m</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">j</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">n</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">K</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">m</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">n</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-214"><span class="mtable" id="MathJax-Span-215" style="min-width: 29.529em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 29.529em;"><span style="display: inline-block; position: absolute; width: 23.817em; height: 0px; clip: rect(-1.452em, 1023.76em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -11.905em;"><span style="position: absolute; clip: rect(2.535em, 1023.76em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 23.817em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1023.76em, 5.283em, -999.997em); top: -4.362em; left: 50%; margin-left: -11.905em;"><span class="mtd" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-239" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.6em, 4.259em, -999.997em); top: -2.961em; left: 0.434em;"><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-242" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.259em, -999.997em); top: -2.961em; left: 0.488em;"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">n</span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.237em, 1001.94em, 0.057em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="mjx-eqn-9.5"><span class="mrow" id="MathJax-Span-217"><span class="mtext" id="MathJax-Span-218" style="font-family: MathJax_Main;">(9.5)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">S(i,j) = (K*I)(i,j) = \sum_m \sum_n I(i-m,j-n)K(m,n).\tag{9.5}</script></span></p><p>Thông thường, công thức thứ hai sẽ là đơn giản hơn đối với các thư viện học máy, vì khoảng giá trị hợp lệ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">m</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-265"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">n</script></span> là ít biến thiên hơn.</p><p>Tính giao hoán của phép tích chập đến từ việc ta đã <em>đảo</em> (flip) lõi tương lấy đầu vào làm mốc, theo nghĩa khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-268"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">m</script></span> tăng, chỉ số gắn với đầu vào cũng tăng, nhưng chỉ số của lõi lại giảm. Lý do duy nhất cho việc đảo lõi là để thu được tính giao hoán. Trong khi tính giao hoán trở nên hữu dụng trong việc chứng minh công thức, nó thường không quan trọng khi cài đặt mạng neuron. Thay vào đó, nhiều thư viện mạng neuron sử dụng một hàm tương đương, gọi là <em>tương quan chéo</em> (cross-correlation), vốn tương tự với hàm tích chập nhưng không đảo lõi:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-225"><span class="MJXp-mtable" id="MJXp-Span-226"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-227" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-228" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">S</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">i</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">j</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">K</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">I</span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">i</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">j</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-247"><span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249" style="margin-left: 0px;">m</span></span></span><span class="MJXp-munderover" id="MJXp-Span-250"><span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-left: 0px;">n</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">I</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">i</span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">m</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">j</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">n</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">K</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">m</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">n</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-272"><span class="mtable" id="MathJax-Span-273" style="min-width: 29.529em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 29.529em;"><span style="display: inline-block; position: absolute; width: 23.817em; height: 0px; clip: rect(-1.452em, 1023.76em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -11.905em;"><span style="position: absolute; clip: rect(2.535em, 1023.76em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 23.817em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1023.76em, 5.283em, -999.997em); top: -4.362em; left: 50%; margin-left: -11.905em;"><span class="mtd" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-297" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.6em, 4.259em, -999.997em); top: -2.961em; left: 0.434em;"><span class="mi" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-300" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.259em, -999.997em); top: -2.961em; left: 0.488em;"><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">j</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">n</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.237em, 1001.94em, 0.057em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="mjx-eqn-9.6"><span class="mrow" id="MathJax-Span-275"><span class="mtext" id="MathJax-Span-276" style="font-family: MathJax_Main;">(9.6)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">S(i,j) = (K*I)(i,j) = \sum_m \sum_n I(i+m,j+n)K(m,n).\tag{9.6}</script></span></p><p>Rất nhiều thư viện học máy sử dụng tương quan chéo nhưng gọi nó là tích chập. Trong cuốn sách này, chúng tôi sẽ theo quy ước này và gọi cả hai phép toán đều là tích chập, và sẽ nói rõ rằng thực sự có đảo lõi hay không ở những phần có mà tính đảo lõi trở nên quan trọng. Trong các tác vụ học máy, thuật toán học sẽ học ra các giá trị phù hợp của lõi ở những vị trị phù hợp. Do đó, một thuật toán học dựa trên tích chập có đảo lõi sẽ học ra một lõi đã được đảo, so với lõi học được bởi thuật toán không đảo lõi. Phép tích chập hiếm khi chỉ được dùng đơn lẻ trong học máy, mà thường được kết hợp đồng thời với các hàm khác, và sự kết hợp của những hàm này là không giao hoán bất chấp việc phép tích chập có đảo lõi hay không.</p><p>Hình 9.1 minh họa một ví dụ của phép tích chập (không đảo lõi) áp dụng cho một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mn" id="MJXp-Span-271">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-321"><span class="mn" id="MathJax-Span-322" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">2</script></span> chiều.</p><p><img src="https://i.imgur.com/ACNxjIO.png" alt=""></p><blockquote>
<p>Hình 9.1: Một ví dụ về tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mn" id="MJXp-Span-273">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-324"><span class="mn" id="MathJax-Span-325" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">2</script></span> chiều không đảo lõi. Chúng tôi chỉ xuất ra kết quả đầu ra tại các vị trí có lõi nằm hoàn toàn trong ảnh, mà đôi khi được gọi là tích chập “hợp lệ” trong một số trường hợp. Chúng tôi vẽ các ô với mũi tên để mô tả cách tính phần tử ở góc trái trên của tensor đầu ra bằng cách áp dụng lõi vào vùng tương ứng của tensor đầu vào.</p>
</blockquote><p>Phép tích chập rời rạc có thể được coi như phép nhân với một ma trận, tuy nhiên, ma trận này có ràng buộc là một số phần tử trong ma trận có giá trị bằng nhau. Ví dụ, với phép tích chập rời rạc đơn biến, mỗi hàng của ma trận bị ràng buộc phải bằng hàng bên trên nó dịch đi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mn" id="MJXp-Span-275">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-327"><span class="mn" id="MathJax-Span-328" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">1</script></span> phần tử. Đây gọi là <em>ma trận Toeplitz</em>. Đối với trường hợp hai chiều, phép tích chập tương ứng với <em>ma trận quay vòng theo khối kép</em> (doubly block circulant matrix). Ngoài những ràng buộc về sự bằng nhau của các phần tử trong ma trận, phép tích chập cũng thường tương ứng với một ma trận rất thưa (ma trận mà hầu hết các phần tử đều bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mn" id="MJXp-Span-277">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-330"><span class="mn" id="MathJax-Span-331" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">0</script></span>). Điều này là bởi lõi thường nhỏ hơn nhiều so với ảnh đầu vào. Bất kì thuật toán mạng neuron nào hoạt động với phép nhân ma trận và không phụ thuộc vào các tính chất cụ thể của cấu trúc ma trận, thì cũng sẽ hoạt động được với phép tích chập mà không cần bất kì thay đổi nào trong mạng neuron. Các mạng neuron tích chập điển hình có sử dụng các kĩ thuật chuyên biệt hơn để xử lý đầu vào lớn một cách hiệu quả, tuy nhiên về mặt lý thuyết thì việc này là không bắt buộc.</p><h1 id="92-Động-lực-phát-triển"><a class="anchor hidden-xs" href="#92-Động-lực-phát-triển" title="92-Động-lực-phát-triển"><span class="octicon octicon-link"></span></a>9.2 Động lực phát triển</h1><p>Phép tích chập mở ra cơ hội giúp cải thiện hệ thống học máy dựa trên ba ý tưởng quan trọng:  <em>tương tác thưa</em> (sparse interactions), <em>dùng chung tham số</em> (parameter sharing) và <em>biểu diễn đẳng biến</em> (equivariant reprentations). Hơn nữa, phép tích chập còn cung cấp công cụ để làm việc với đầu vào có kích thước thay đổi. Chúng tôi sẽ lần lược mô tả từng ý tưởng.</p><p>Các tầng mạng neuron truyền thống sử dụng phép nhân ma trận với ma trận các tham số trong đó mỗi tham số riêng biệt thể hiện tương tác giữa từng đơn vị đầu vào và đơn vị đầu ra. Nghĩa là tất cả đơn vị đầu ra đều tương tác với tất cả đơn vị đầu vào. Tuy nhiên, các mạng tích chập lại thường có các tương tác thưa (hay còn được gọi là <em>kết nối thưa</em> hay <em>trọng số thưa</em>). Điều này đạt được bằng cách khiến cho lõi nhỏ hơn đầu vào. Ví dụ, khi xử lý một bức ảnh, bức ảnh đầu vào có thể có hàng ngàn hay hàng triệu điểm ảnh, nhưng ta vẫn có thể nhận diện một tập đặc trưng nhỏ và có ý nghĩa, chẳng hạn như các cạnh với lõi chỉ chiếm hàng chục hay hàng trăm điểm ảnh. Điều này nghĩa là ta chỉ cần lưu trữ một lượng tham số ít hơn, giúp giảm cả yêu cầu về lưu trữ của mô hình, cũng như tăng tính hiệu quả về mặt thống kê. Đồng thời, việc tính toán đầu ra cũng cần ít phép toán hơn.  Cải thiện tính toán thu được này thường tương đối lớn. Nếu có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-332"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-333"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">m</script></span> đầu vào và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">n</script></span> đầu ra, phép nhân ma trận cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">m</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">m \times n</script></span> tham số, và các thuật toán trong thực tế có thời gian chạy là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">O</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">m</span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">n</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">O(m \times n)</script></span> (cho mỗi mẫu). Nếu chúng ta giới hạn được số lượng kết nối của từng đầu ra xuống <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">k</script></span>; phương pháp kết nối thưa chỉ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">k</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">k \times n</script></span> tham số và thời gian chạy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">O</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">k</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">n</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">O(k \times n)</script></span>. Trong nhiều ứng dụng thực tế, ta có thể thu được kết quả tốt trong nhiều tác vụ học máy khi giữ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">k</script></span> nhỏ hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">m</script></span> vài bậc. Xem hình 9.2 và hình 9.3 để hình dung về kết nối thưa. Trong mạng tích chập đa tầng, các đơn vị trong các tầng sâu hơn có thể tương tác gián tiếp với một phần lớn hơn của đầu vào, như trong hình 9.4. Điều này cho phép mạng mô tả một cách hiệu quả các tương tác phức tạp giữa nhiều biến bằng cách xây dựng các tương tác này từ các khối đơn giản mà từng khối chỉ diễn tả các tương tác thưa.</p><p><img src="https://i.imgur.com/Huarsml.png" alt=""></p><blockquote>
<p>Hình 9.2: Kết nối thưa, nhìn theo hướng từ dưới lên. Chúng tôi tô đậm một đơn vị đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-313" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-374"><span class="msubsup" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mn" id="MathJax-Span-377" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">x_3</script></span> và các đơn vị đầu ra trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-315">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-46">\boldsymbol s</script></span> chịu ảnh hưởng của đầu vào này. <em>(Hình trên)</em> Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-317">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">\boldsymbol s</script></span> được tính bởi phép tích chập với một lõi có độ rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mn" id="MJXp-Span-319">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">3</script></span>, chỉ có ba đầu ra bị ảnh hưởng bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">boldsymbol x</script></span>. <em>(Hình dưới)</em> Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">boldsymbol s</script></span> được tính bởi phép nhân ma trận, kết nối không còn là thưa, do đố tất cả đầu ra đều bị ảnh hưởng bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">x_3</script></span>.</p>
</blockquote><p><img src="https://i.imgur.com/WyxmbVY.png" alt=""></p><blockquote>
<p>Hình 9.3: Kết nối thưa, nhìn theo hướng từ trên xuống. Chúng tôi tô đậm một đơn vị đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-msubsup" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-351" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">s_3</script></span> và các đơn vị đầu vào trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-353">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">\boldsymbol x</script></span> gây ảnh hưởng đến nó. Các đơn vị này được gọi là <em>trường tiếp nhận</em> (receptive field) của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-354"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">s_3</script></span>. <em>(Hình trên)</em> Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-359">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\boldsymbol s</script></span> được tính bởi phép tích chập với một lõi có độ rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mn" id="MJXp-Span-361">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">3</script></span>, chỉ có ba đầu vào ảnh hưởng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">s_3</script></span>. <em>(Hình phía dưới)</em> Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">s</script></span> được tạo bởi phép nhân ma trận, kết nối không còn là thưa, nên tất cả đầu vào đều ảnh hưởng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">s_3</script></span>.</p>
</blockquote><p><img src="https://i.imgur.com/Tqng3jP.png" alt=""></p><blockquote>
<p>Hình 9.4. Trong mạng tích chập, trường tiếp nhận của các đơn vị trong những tầng sâu hơn sẽ lớn hơn trường tiếp nhận của các đơn vị trong các tầng nông. Hiệu ứng này sẽ tăng lên nếu mạng có các đặc điểm kiến trúc như <em>tích chập theo sải</em> (strided convolution) như hình 9.12 hay gộp (phần 9.3). Điều này có nghĩa là mặc dù các kết nối <em>trực tiếp</em> trong mạng tích chập là rất thưa, nhưng các đơn vị trong các tầng sâu hơn vẫn có thể được kết nối <em>gián tiếp</em> với toàn bộ hay hầu hết các ảnh đầu vào.</p>
</blockquote><p><em>Dùng chung tham số</em> ám chỉ đến việc sử dụng cùng bộ tham số cho nhiều hơn một hàm trong mô hình. Trong mạng neuron truyền thống, từng phần tử của ma trận trọng số được sử dụng một lần duy nhất khi tính toán đầu ra của một tầng. Nó được nhân với một phần tử của đầu vào và không bao giờ được sử dụng lại nữa. Nói một cách tương đương với việc dùng chung tham số, ta có thể nói ma trận có <em>trọng số bị trói buộc</em> (tied weights), bởi vì giá trị của trọng số cho một đầu vào bị trói buộc với giá trị của trọng số ở nơi khác. Trong mạng neuron tích chập, các thành phần của lõi được sử dụng ở tất cả các vị trí của đầu vào (có lẽ chỉ trừ một vài điểm ảnh ở biên, tuỳ thuộc vào các các quyết định thiết kế liên quan tới biên). Dùng chung tham số trong phép tích chập có ý nói thay vì học mỗi bộ tham số riêng biệt cho từng vị trí, ta chỉ học một bộ tham số duy nhất. Điều này không ảnh hưởng tới thời gian chạy của quá trình lan truyền thuận-vẫn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">O</span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">k</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">n</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">O(k \times n)</script></span>-nhưng làm giảm đáng kể nhu cầu lưu trữ của mô hình xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">k</script></span> tham số. Nhắc lại rằng: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">k</script></span> thường nhỏ hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">m</script></span> vài bậc. Vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">m</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">n</script></span> thường có kích cỡ gần tương đương, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-66">k</script></span> thực tế thường không đáng kể so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">m</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">m \times n</script></span>. Phép tích chập nhờ đó trở nên hiệu quả hơn rất nhiều so với việc nhân ma trận về mặt yêu cầu bộ nhớ và hiệu quả thống kê. Hình 9.5 mô tả minh họa cách dùng chung tham số hoạt động.</p><p><img src="https://i.imgur.com/EVADjoY.png" alt=""></p><blockquote>
<p>Hình 9.5. Dùng chung tham số. Mũi tên đen biểu thị các kết nối dùng chung một tham số cụ thể trong hai mô hình khác nhau. <em>(Hình trên)</em> Các mũi tên đen biểu thị việc sử dụng các phần tử trung tâm của một lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-mn" id="MJXp-Span-396">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">3</script></span> phần tử trong mô hình tích chập. <em>(Hình dưới)</em> Mũi tên đen duy nhất biểu thị việc sử dụng phần tử trung tâm của ma trận trọng số trong mô hình kết nối đầy đủ. Mô hình này không dùng chung tham số, do đó tham số chỉ được dùng một lần.</p>
</blockquote><p>Để lấy ví dụ cho hai quy tắc này trong thực tế, hình 9.6 minh hoạ kết nối thưa và dùng chung tham số có thể cải thiện đáng kể hiệu quả của hàm tuyến tính trong việc phát hiện các cạnh của ảnh.</p><p><img src="https://i.imgur.com/EYpBIhD.png" alt=""></p><blockquote>
<p>Hình 9.6. Hiệu quả của việc phát hiện cạnh biên. Hình bên phải được tạo thành bằng các lấy từng điểm ảnh trong ảnh gốc và trừ đi giá trị của điểm ảnh lân cận bên trái. Nó cho thấy cường độ của tất cả các cạnh hướng dọc trong ảnh đầu vào, vốn là một thao tác có ích trong việc nhận diện vật thể. Cả hai bức ảnh đều cao <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mn" id="MJXp-Span-398">280</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">280</script></span> điểm ảnh. Ảnh đầu vào rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mn" id="MJXp-Span-400">320</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">320</script></span> điểm ảnh, trong khi ảnh đầu ra rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mn" id="MJXp-Span-402">319</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">319</script></span> điểm ảnh. Biến đổi này có thể được mô tả bằng một lõi tích chập có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-mn" id="MJXp-Span-404">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">2</script></span> phần tử, và cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-mn" id="MJXp-Span-406">319</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-408">280</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-410">3</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-412">267.960</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">319 \times 280 \times 3 = 267.960</script></span> phép toán dấu phẩy động (hai phép nhân và một phép cộng cho mỗi điểm ảnh đầu ra) để tính toán sử dụng tích chập. Để mô tả một biến đổi này bằng phép nhân ma trận, cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-mn" id="MJXp-Span-414">320</span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-416">280</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-418">319</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-420">280</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">320 \times 280 \times 319 \times 280</script></span>, hay hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mn" id="MJXp-Span-422">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">8</script></span> tỷ phần tử trong ma trận, cho thấy phép tích chập hiệu quả hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mn" id="MJXp-Span-424">4</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">4</script></span> tỷ lần trong biểu diễn phép biến đổi này. Thuật toán nhân ma trận trực tiếp thực hiện hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mn" id="MJXp-Span-426">16</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">16</script></span> tỷ phép toán dấu phẩy động, cho thấy tích chập hiệu quả hơn gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mn" id="MJXp-Span-428">60</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-430">000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-78">60,000</script></span> lần về mặt tính toán. Tất nhiên, hầu hết các phần tử trong ma trận có thể bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mn" id="MJXp-Span-432">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">0</script></span>. Nếu chúng ta chỉ lưu trữ các phần tử khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-mn" id="MJXp-Span-434">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">0</script></span> của ma trận, cả phép nhân ma trận và tích chập có thể cần lượng phép toán dấu phẩy động tương đương nhau trong tính toán. Ma trận vẫn sẽ cần phải chứa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-435"><span class="MJXp-mn" id="MJXp-Span-436">2</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-438">319</span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-440">280</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-442">178.640</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">2 \times 319 \times 280 = 178.640</script></span> phần tử. Tích chập là cách cực kì hiệu quả để mô tả phép biến đổi áp dụng cùng một biến đổi tuyến tính cho một vùng nhỏ cục bộ xuyên suốt toàn bộ đầu vào. Nguồn: Paula Goodfellow.</p>
</blockquote><p>Trong trường hợp của phép tích chập, có một dạng cụ thể của dùng chung tham số khiến cho một tầng có một tính chất gọi là <em>tính đẳng biến</em> (equavariance) đối với phép tịnh tiến. Một hàm được gọi là có tính đẳng biến khi đầu vào thay đổi, và đầu ra cũng thay đổi theo cùng một cách như vậy. Cụ thể, hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">f</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">x</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">f(x)</script></span> đẳng biến với hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">g</script></span> nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">f</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">g</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">x</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">g</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">f</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">x</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">f(g(x)) = g(f(x))</script></span>. Đối với phép tích chập, nếu ta cho hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">g</script></span> là một hàm tịnh tiến đầu vào, hay nói cách khác là dịch đầu vào, thì hàm tích chập là đẳng biến với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">g</script></span>. Ví dụ, gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">I</script></span> là hàm biểu thị độ sáng của ảnh ở các tọa độ nguyên. Cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">g</script></span> là một hàm ánh xạ một hàm ảnh tới hàm ảnh khác, sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-msup" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476" style="margin-right: 0.05em;">I</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-477" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">g</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">I</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">I' = g(I)</script></span> là hàm ảnh, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-msup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;">I</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-486" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">x</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">y</span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">I</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">x</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-497">1</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">y</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">I'(x,y) = I(x-1,y)</script></span>. Hàm này dịch toàn bộ các điểm ảnh của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">I</script></span> sang phải một đơn vị. Nếu ta áp dụng phép biến đổi này vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">I</script></span>, sau đó áp dụng tích chập, kết quả nhận được sẽ tương tự như khi áp dụng tích chập cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-msup" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507" style="margin-right: 0.05em;">I</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-508" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">I'</script></span>, sau đó áp dụng phép biến đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">g</script></span> vào đầu ra. Khi xử lý dữ liệu dạng chuỗi thời gian, điều này có nghĩa là tích chập tạo ra một loại dòng thời gian, đánh dấu khi nào các đặc trưng khác nhau xuất hiện trong đầu vào. Nếu tại đầu vào ta dịch chuyển một sự kiện về thời điểm muộn hơn, thì biểu diễn giống hệt của sự kiện đó sẽ xuất hiện trong đầu ra, chỉ là muộn hơn mà thôi. Tương tự với hình ảnh, tích chập tạo ra một ánh xạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mn" id="MJXp-Span-512">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">2</script></span> chiều cho biết thời điểm các đặc trưng cụ thể xuất hiện trong đầu vào. Nếu ta dịch chuyển một đối tượng trong đầu vào, biển diễn của nó cũng sẽ bị dịch chuyển một lượng tương đương trong đầu ra. Điều này có lợi khi ta biết rằng một hàm nào đó của một lượng nhỏ các điểm ảnh lân cận sẽ hữu ích khi áp dụng vào nhiều vị trí đầu vào. Ví dụ, khi xử lý ảnh, việc xác định được cạnh trong tầng đầu tiên của mạng tích chập thường có lợi. Những cạnh giống nhau đều ít nhiều xuất hiện khắp nơi trong ảnh, vì vậy, sẽ thực tế hơn khi ta dùng chung các tham số trên toàn bộ bức ảnh. Tuy nhiên trong một vài trường hợp, nên tránh việc dùng chung tham số trên toàn bộ ảnh như vậy. Chẳng hạn, nếu ta đang xử lý một bức ảnh đã được cắt để chỉ tập trung vào khuôn mặt một người, ta sẽ muốn trích xuất các đặc trưng khác nhau ở các vị trí khác nhau. Chẳng hạn, phần mạng phụ trách xử lý phần trên của khuôn mặt cần tìm kiếm lông mày, trong khi phần mạng xử lý phần dưới của khuôn mặt cần tìm kiếm cằm của người đó.</p><p>Phép tích chập không có tính đẳng biến với một số phép biến đổi khác, như phép phóng to, thu nhỏ hay phép xoay. Việc xử lý những phép biến đổi này cần áp dụng các cơ chế khác.</p><p>Điều cuối cùng chúng tôi muốn nói ở phần này, đó là có một số dạng dữ liệu không thể được xử lý bằng các mạng neuron xác định bởi phép nhân với một ma trận kích thước cố định. Nhưng phép tích chập cho phép ta xử lý một vài dạng dữ liệu này. Điều này sẽ được thảo luận sâu hơn trong phần 9.7.</p><h1 id="93-Phép-gộp"><a class="anchor hidden-xs" href="#93-Phép-gộp" title="93-Phép-gộp"><span class="octicon octicon-link"></span></a>9.3. Phép gộp</h1><p>Một tầng mạng tích chập điển hình bao gồm ba giai đoạn (xem hình 9.7). Trong giai đoạn đầu tiên, tầng mạng thực hiện song song một vài phép tích chập để tạo ra một tập các tín hiệu kích hoạt tuyến tính. Trong giai đoạn thứ hai, từng tín hiệu kích hoạt tuyến tính đi qua một hàm kích hoạt phi tuyến tính, chẳng hạn như hàm kích hoạt tuyến tính hiệu chỉnh. Đôi lúc, ta gọi giai đoạn này là <em>giai đoạn phát hiện</em> (detector stage). Trong giai đoạn thứ ba, ta sẽ dùng <em>hàm gộp</em> (pooling function) để biến đổi đầu ra một lần nữa.</p><p>Một hàm gộp thay thế đầu ra của mạng tại một vị trí xác định bằng một thông số thống kê tổng hợp về các đầu ra lân cận. Ví dụ, phép toán <em>gộp cực đại</em> (max pooling) (Zhouand Chellappa, 1988) cho ta đầu ra cực đại trong vùng lân cận hình chữ nhật. Các hàm hộp phổ biến khác gồm hàm lấy trung bình của vùng lân cận chữ nhật, chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-513"><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-516" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">L^2</script></span> của vùng lân cận hình chữ nhật, hay trung bình có trọng số dựa trên khoảng cách tới điểm ảnh trung tâm.</p><p><img src="https://i.imgur.com/1XQt5XN.png" alt=""></p><blockquote>
<p>Hình 9.7: Các thành phần của một tầng mạng neuron tích chập điển hình. Có hai bộ thuật ngữ thường được sử dụng để mô tả các tầng này. <em>(Hình trái)</em> Trong bộ thuật ngữ này, mạng tích chập được xem như một một số lượng nhỏ các tầng tương đối phức tạp, với mỗi tầng có nhiều “giai đoạn”. Có một ánh xạ một-một giữa các tensor lõi với các tầng mạng. Trong cuốn sách này, chúng tôi thường sử dụng bộ thuật ngữ này. <em>(Hình phải)</em> Ở đây, mạng tích chập được xem như một số lượng lớn các tầng đơn giản; mỗi bước xử lý được coi là một tầng theo đúng nghĩa của nó. Điều này có nghĩa là không phải mọi “tầng” đều có tham số.</p>
</blockquote><p>Trong mọi trường hợp, phép toán gộp giúp biểu diễn gần như <em>bất biến</em> (invariant) đối với các phép tịnh tiến nhỏ của đầu vào. Tính bất biến đối với phép tịnh tiến có nghĩa là nếu ta dịch đầu vào một lượng nhỏ, giá trị của hầu hết đầu ra sau khi gộp sẽ không thay đổi. Hình 9.8 trình bày cách thức hoạt động của phép gộp. <em>Tính bất biến đối với phép tịnh tiến cục bộ có thể là một thuộc tính hữu ích khi ta quan tâm đến sự tồn tại của đặc trưng hơn là vị trí chính xác của nó</em>. Ví dụ, khi xác định một hình ảnh có chứa một khuôn mặt, ta không cần biết vị trí của mắt chính xác tới toạ độ của từng điểm ảnh, ta chỉ cần biết rằng có một mắt ở phía bên trái của khuôn mặt và một mắt ở bên phải khuôn mặt là được. Nhưng trong các tình huống khác, việc bảo toàn vị trí của các đặc trưng lại quan trọng hơn. Chẳng hạn, nếu muốn tìm một góc được xác định bởi hai cạnh cắt nhau tại một hướng cụ thể nào đó, chúng ta cần phải bảo toàn vị trí của các cạnh đủ tốt để kiểm tra xem chúng có thoả mãn yêu cầu trên hay không.</p><p><img src="https://i.imgur.com/LU7rgcR.png" alt=""></p><blockquote>
<p>Hình 9.8: Phép gộp cực đại tạo ra tính bất biến. <em>(Hình trên)</em> Một phần đầu ra của một tầng tích chập. Hàng dưới biểu diễn kết quả đầu ra của hàm phi tuyến. Hàng trên biểu diễn các kết quả đầu ra của phép gộp cực đại, với sải chập (stride) có độ dài là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mn" id="MJXp-Span-518">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">1</script></span> điểm ảnh giữa các vùng gộp và độ rộng vùng gộp là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mn" id="MJXp-Span-520">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">3</script></span> điểm ảnh. <em>(Hình phía dưới)</em> Vẫn trong trường hợp như hình trên, nhưng đầu vào bị dịch sang phải <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mn" id="MJXp-Span-522">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">1</script></span> điểm ảnh. Mọi giá trị trong hàng dưới đã thay đổi, nhưng chỉ một nửa giá trị trong hàng trên bị thay đổi, bởi vì các bộ gộp cực đại chỉ nhạy với giá trị cực đại trong vùng lân cận, không nhạy với vị trí chính xác của nó.</p>
</blockquote><p>Việc sử dụng phép gộp có thể xem như là thêm vào một tiên nghiệm cực mạnh rằng: hàm mà các tầng học được phải là bất biến đối với các bước tịnh tiến nhỏ. Nếu giả định này chính xác, nó có thể cải thiện đáng kể hiệu quả thống kê của mạng.</p><p>Phép gộp trong các miền không gian tạo ra tính bất biến đối với phép tịnh tiến, nhưng nếu chúng ta gộp đầu ra của các tích chập được tham số hoá một cách riêng biệt, thì các đặc trưng có thể học được rằng chúng sẽ trở thành bất biến đối với những phép biến đổi nào (xem hình 9.9).</p><p><img src="https://i.imgur.com/QDpzfPl.png" alt=""></p><blockquote>
<p>Hình 9.9: Ví dụ về tính bất biến học được. Một đơn vị gộp nhiều đặc trưng được học bằng các tham số riêng biệt có thể học để trở nên bất biến với các phép biến đổi của đầu vào. Ở đây, chúng tôi chỉ ra cách một tập gồm ba bộ lọc học được (learned filters) và một đơn vị gộp cực đại có thể học để trở nên bất biến đối với phép xoay. Ta mong đợi cả ba bộ lọc được sẽ phát hiện được số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-523"><span class="MJXp-mn" id="MJXp-Span-524">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">5</script></span> viết tay. Mỗi bộ lọc sẽ cố gắng khớp với một hướng hơi khác nhau của số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-mn" id="MJXp-Span-526">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">5</script></span>. Khi số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-mn" id="MJXp-Span-528">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">5</script></span> xuất hiện trong đầu vào, bộ lọc tương ứng sẽ khớp với nó và sinh ra một tín hiệu kích hoạt lớn trong đơn vị phát hiện (detector unit). Đơn vị gộp cực đại sau đó có được một tín hiệu kích hoạt lớn, bất kể đầu vào khớp với đơn vị phát hiện nào. Ở đây, chúng tôi chỉ ra cách quá trình mạng xử lý hai đầu vào khác nhau, kết quả là hai đơn vị phát hiện khác nhau đã được kích hoạt. Hiệu quả trên các đơn vị gộp là gần như nhau. Nguyên tắc này được tận dụng bởi các mạng cực đại đầu ra (Goodfellow et al., 2013a) và các mạng tích chập khác. Phép gộp cực đại trong các vị trí không gian là bất biến một cách tự nhiên đối với phép tịnh tiến; cách tiếp cận đa kênh này chỉ cần thiết cho việc học các phép biến đổi khác.</p>
</blockquote><p>Bởi vì phép gộp tổng hợp các phản hồi của toàn bộ vùng lân cận, ta có thể sử dụng số lượng đơn vị gộp ít hơn so với số lượng đơn vị phát hiện, bằng cách báo cáo các thông số thống kê tổng hợp cho các vùng gộp có độ rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">k</script></span> điểm ảnh thay vì chỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-mn" id="MJXp-Span-532">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">1</script></span> điểm ảnh. Xem ví dụ minh hoạ ở hình 9.10. Điều này cải thiện hiệu suất tính toán của mạng vì tầng tiếp theo có số đầu vào ít hơn khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">k</script></span> lần. Khi số lượng tham số trong tầng tiếp theo là một hàm của kích thước đầu vào (chẳng hạn như khi tầng tiếp theo là tầng kết nối đầy đủ và dựa trên phép nhân ma trận), việc giảm kích thước đầu vào này cũng có thể dẫn đến sự cải thiện hiệu suất thống kê và giảm lượng bộ nhớ yêu cầu dùng để lưu trữ các tham số.</p><p><img src="https://i.imgur.com/QakMdJp.png" alt=""></p><blockquote>
<p>Hình 9.10: Phép gộp với phép thu nhỏ mẫu (downsampling). Ở đây chúng ta sử dụng hàm gộp cực đại với độ rộng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mn" id="MJXp-Span-536">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">3</script></span> và sải chập giữa các cụm gộp là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mn" id="MJXp-Span-538">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">2</script></span>. Điều này làm giảm kích thước của biểu diễn xuống <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-mn" id="MJXp-Span-540">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">2</script></span> lần, giúp giảm cả gánh nặng tính toán lẫn gánh nặng thống kê ở tầng kế tiếp. Lưu ý rằng vùng gộp ngoài cùng bên phải có kích thước nhỏ hơn nhưng cần được tính vào nếu ta không muốn bỏ qua một số đơn vị phát hiện.</p>
</blockquote><p>Đối với nhiều tác vụ, phép gộp là rất cần thiết để xử lý các đầu vào có kích thước khác nhau. Ví dụ, nếu ta muốn phân loại các hình ảnh có kích thước khác nhau, đầu vào cho tầng phân loại phải có kích thước cố định. Ta thường làm điều này bằng cách điều chỉnh độ lệch (offset) giữa các vùng gộp sao cho tầng phân loại luôn nhận được cùng một số lượng thống kê tổng hợp bất kể kích thước đầu vào là bao nhiêu. Ví dụ, tầng gộp cuối cùng của mạng có thể được xác định để xuất ra bốn bộ thống kê tổng hợp, một cho mỗi góc phần tư của hình ảnh, bất kể kích thước của bức ảnh.</p><p>Một số công trình nghiên cứu lý thuyết cung cấp cho chúng ta những hướng dẫn về việc nên sử dụng dạng gộp nào trong các tình huống khác nhau [Boureau et al., 2010]. Ta cũng có thể gộp các đặc trưng với nhau một cách linh động, ví dụ, bằng cách chạy một thuật toán phân cụm trên các vị trí của các đặc trưng ta quan tâm [Boureau et al., 2011]. Cách tiếp cận này tạo ra các vùng gộp khác nhau cho mỗi hình ảnh. Một cách tiếp cận khác là <em>học</em> một cấu trúc gộp duy nhất, sau đó đem áp dụng cho tất cả các ảnh [Jia et al., 2012].</p><p>Phép gộp có thể làm phức tạp hoá một số loại kiến trúc mạng neuron sử dụng thông tin dạng theo dạng từ trên xuống (top-down), chẳng hạn như máy Boltzmann và các bộ tự mã hóa. Những vấn đề này sẽ được thảo luận sâu hơn khi chúng tôi trình bày các loại mạng này trong phần III. Phép gộp trong các <em>máy Boltzmann tích chập</em> (convolutional Boltzmann machine) được trình bày trong phần 20.6. Các phép toán kiểu nghịch đảo trên các đơn vị gộp sẽ là cần thiết trong một số mạng khả vi sẽ được nhắc tới trong phần 20.10.6.</p><p>Hình 9.11 đưa ra một số ví dụ về các kiến trúc mạng tích chập hoàn chỉnh cho bài toán phân loại và phép gộp.</p><p><img src="https://i.imgur.com/ByGtS6j.png" alt=""></p><blockquote>
<p>Hình 9.11: Ví dụ về kiến trúc cho bài toán phân loại với mạng tích chập. Độ lớn sải chập và độ sâu cụ thể được sử dụng trong hình này không được khuyến nghị sử dụng trong thực tế; kiến trúc của chúng được thiết kế rất nông để phù hợp với khuôn khổ trang sách. Các mạng tích chập thực tiễn thường bao gồm số lượng nhánh nhiều đáng kể, không giống như các cấu trúc chuỗi đơn giản được biểu diễn ở đây. <em>(Hình trái)</em> Một mạng tích chập xử lý hình ảnh có kích thước cố định. Sau khi đi qua vài tầng tích chập và gộp xen kẽ nhau, tensor của bản đồ đặc trưng tích chập được định hình lại để làm phẳng các chiều không gian. Phần còn lại của mạng là một mạng phân loại lan truyền thuận đa tầng thường gặp, như đã mô tả trong chương 6. <em>(Hình giữa)</em> Một mạng tích chập xử lý các hình ảnh có kích thước khác nhau nhưng vẫn duy trì một thành phần kết nối đầy đủ. Mạng này sử dụng các phép toán gộp có kích thước khác nhau, nhưng số lượng gộp là cố định để cho ra một vector có kích thước cố định là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mn" id="MJXp-Span-542">576</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">576</script></span> đơn vị cho phần kết nối đầy đủ của mạng. <em>(Hình phải)</em> Một mạng tích chập không có bất kỳ tầng kết nối trọng số đầy đủ nào. Thay vào đó, tầng tích chập cuối cùng xuất ra một bản đồ đặc trưng cho từng lớp phân loại. Mô hình này có thể học một bản đồ về khả năng xảy ra của từng lớp tại mỗi vị trí không gian. Lấy tính trung bình một bản đồ đặc trưng để tạo ra một giá trị duy nhất để làm đối số cho tầng phân loại softmax ở trên cùng.</p>
</blockquote><h1 id="94-Tích-chập-và-phép-gộp-dưới-góc-nhìn-một-tiên-nghiệm-mạnh-vô-hạn"><a class="anchor hidden-xs" href="#94-Tích-chập-và-phép-gộp-dưới-góc-nhìn-một-tiên-nghiệm-mạnh-vô-hạn" title="94-Tích-chập-và-phép-gộp-dưới-góc-nhìn-một-tiên-nghiệm-mạnh-vô-hạn"><span class="octicon octicon-link"></span></a>9.4 Tích chập và phép gộp dưới góc nhìn một tiên nghiệm mạnh vô hạn.</h1><p>Nhắc lại khái niệm <em>phân phối xác suất tiên nghiệm</em> từ phần 5.6. Đây là một phân bố xác suất dựa trên các tham số của một mô hình mã hoá niềm tin của chúng ta về việc những mô hình nào là hợp lý, trước khi quan sát bất kỳ dữ liệu nào.</p><p>Các tiên nghiệm có thể được coi là yếu hoặc mạnh tùy thuộc vào mức độ tập trung của mật độ xác suất trong tiên nghiệm. Một tiên nghiệm yếu là một phân bố tiên nghiệm với entropy cao, chẳng hạn như một phân bố Gauss với phương sai cao. Tiên nghiệm như vậy cho phép dữ liệu thay đổi các tham số một cách gần như tự do. Một tiên nghiệm mạnh có entropy rất thấp, chẳng hạn như một phân phối Gauss với phương sai thấp. Tiên nghiệm như vậy đóng vai trò tích cực hơn trong việc xác định miền mà giá trị mà các tham số rơi vào.</p><p>Một tiên nghiệm mạnh vô hạn gán xác suất bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-mn" id="MJXp-Span-544">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">0</script></span> cho một số tham số và cho biết rằng các giá trị tham số này hoàn toàn bị cấm, bất kể dữ liệu ủng hộ các giá trị đó như thế nào.</p><p>Chúng ta có thể tưởng tượng mạng tích chập cũng tương tự như một mạng kết nối đầy đủ nhưng với tiên nghiệm mạnh vô hạn cho các trọng số của nó. Tiên nghiệm mạnh vô hạn này cho biết các trọng số cho một đơn vị ẩn sẽ phải đồng nhất với các trọng số của các đơn vị lân cận nhưng bị dịch theo không gian. Tiên nghiệm cũng cho biết các trọng số phải bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mn" id="MJXp-Span-546">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">0</script></span>, trừ các giá trị tại các trường tiếp nhận nhỏ và tiếp giáp nhau được chỉ định cho đơn vị ẩn đó. Nhìn chung, ta có thể coi việc sử dụng tích chập như việc đưa ra một phân phối xác suất tiên nghiệm mạnh vô hạn cho các tham số trong một tầng. Tiên nghiệm này cho biết rằng: hàm số mà mỗi tầng nên học chỉ chứa các tương tác cục bộ và có tính đẳng biến đối với các phép tịnh tiến. Tương tự như vậy, công dụng của phép gộp là một tiên nghiệm mạnh vô hạn mà theo đó, mỗi đơn vị nên có tính bất biến với các tịnh tiến nhỏ.</p><p>Dĩ nhiên việc triển khai mạng tích chập như một mạng kết nối đầy đủ với các tiên nghiệm mạnh vô hạn sẽ là rất lãng phí tài nguyên tính toán. Nhưng quan điểm coi mạng tích chập như một mạng kết nối đầy đủ với các tiên nghiệm mạnh vô hạn có thể giúp chúng ta hiểu rõ hơn về cách hoạt động của mạng tích chập.</p><p>Một chi tiết quan trọng đó là phép tích chập và phép gộp có thể gây ra hiện tượng <em>vị khớp</em> (underfitting) cho mô hình. Giống như bất kỳ tiên nghiệm nào, phép chập và phép gộp chỉ hữu ích khi các giả định bởi tiên nghiệm là khá chính xác. Nếu như một tác vụ dựa trên việc bảo toàn thông tin không gian một cách chính xác, thì việc sử dụng phép gộp trên toàn bộ đặc trưng sẽ làm tăng sai số huấn luyện. Một vài kiến trúc mạng tích chập [Szegedy et al. 2014a] được thiết kế để chỉ sử dụng phép gộp trên một số kênh, sao cho có thể thu được các đặc trưng có tính bất biến cao và các đặc trưng sẽ không bị vị khớp khi tiên nghiệm về bất biến tịnh tiến  là không chính xác. Trong trường hợp bài toán yêu cầu kết hợp thông tin giữa các vị trí cách xa nhau ở đầu vào, thì tiên nghiệm áp đặt bởi phép tích chập có thể là không thích hợp.</p><p>Một chi tiết quan trọng khác đó là chúng ta chỉ nên so sánh các mô hình mạng tích chập với nhau dựa trên các thang đo tiêu chuẩn về hiệu suất học thống kê. Các mô hình không sử dụng phép tích chập vẫn có thể học được ngay cả khi ta hoán đổi vị trí các điểm ảnh trong ảnh. Đối với nhiều bộ dữ liệu ảnh, có nhiều thang đo riêng biệt cho các mô hình là <em>bất biến theo hoán vị</em> (permutation invariant), và phải tự tìm ra những khái niệm về topology thông qua quá trình học và cho các mô hình đã được gắn cứng các tri thức về các mối quan hệ không gian bởi người thiết kế chúng.</p><h1 id="95-Các-biến-thể-của-hàm-tích-chập-cơ-bản"><a class="anchor hidden-xs" href="#95-Các-biến-thể-của-hàm-tích-chập-cơ-bản" title="95-Các-biến-thể-của-hàm-tích-chập-cơ-bản"><span class="octicon octicon-link"></span></a>9.5 Các biến thể của hàm tích chập cơ bản</h1><p>Khi thảo luận về tích chập trong phạm vi mạng neuron, chúng ta thường không đề cập một cách chính xác về các phép tích chập rời rạc chuẩn như thường dùng trong cộng đồng toán. Các hàm chúng ta sử dụng trong những bài toán thực tế sẽ khác một chút. Trong phần này, chúng tôi sẽ mô tả chi tiết về những điểm khác nhau này và nhấn mạnh một số đặc tính quan trọng của các hàm được sử dụng trong mạng neuron.</p><p>Trước tiên, khi đề cập đến phép tích chập trong phạm vi mạng neuron, nó thường mang nghĩa là một phép toán bao gồm nhiều phép tích chập song song. Đó là bởi vì phép tích chập với một lõi duy nhất chỉ có thể trích xuất được một dạng đặc trưng, mặc dù tại nhiều vị trí không gian khác nhau. Tuy nhiên ta thường mong muốn mỗi tầng trong mô hình mạng có thể trích xuất được nhiều dạng đặc trưng, tại nhiều vị trí khác nhau.</p><p>Thêm vào đó, dữ liệu đầu vào thông thường không chỉ là một lưới các giá trị số thực mà sẽ là một lưới các quan sát có giá trị vector. Ví dụ, một ảnh màu sẽ bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mn" id="MJXp-Span-548">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">3</script></span> giá trị chỉ cường độ sắc đỏ, lục, lam tại mỗi điểm ảnh. Trong mô hình mạng neuron tích chập đa tầng, đầu vào của tầng thứ hai chính là đầu ra của tầng thứ nhất, chúng thường là kết quả của nhiều phép tích chập khác nhau tại mỗi vị trí. Khi làm việc với ảnh, chúng ta thường coi dữ liệu đầu vào và đầu ra của mạng tích chập như các tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mn" id="MJXp-Span-550">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">3</script></span> chiều với một chiều tương ứng với các kênh màu và hai chiều còn lại tương ứng với các tọa độ không gian của từng kênh màu. Các phần mềm hoạt động ở chế độ lô dữ liệu (batch mode), do vậy  mô hình của ta thực tế sẽ sử dụng các tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mn" id="MJXp-Span-552">4</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">4</script></span> chiều, với chiều thứ tư giúp đánh chỉ mục cho các mẫu khác nhau trong khối dữ liệu, tuy nhiên, ở đây, chúng tôi sẽ bỏ qua chiều dữ liệu này để đơn giản hóa vấn đề.</p><p>Do mạng tích chập thường sử dụng phép tích chập đa kênh, các phép biến đổi tuyến tính mà chúng dựa vào sẽ không đảm bảo được tính giao hoán, ngay cả khi sử dụng đảo lõi. Các phép biến đổi đa kênh chỉ có thể có tính giao hoán nếu như mỗi phép biến đổi có số kênh ở đầu ra bằng với số kênh đầu vào.</p><p>Giả sử ta có một lõi tensor 4 chiều <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mrow" id="MJXp-Span-554"><span class="MJXp-mi undefined" id="MJXp-Span-555">K</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\boldsymbol{\mathsf{K}}</script></span>, với phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-556"><span class="MJXp-msubsup" id="MJXp-Span-557"><span class="MJXp-mrow" id="MJXp-Span-558" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-560">K</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-561" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">i</span><span class="MJXp-mo" id="MJXp-Span-563">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">j</span><span class="MJXp-mo" id="MJXp-Span-565">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">k</span><span class="MJXp-mo" id="MJXp-Span-567">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">l</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">{\mathsf{K}}_{i,j,k,l}</script></span> cho biết cường độ kết nối giữa một đơn vị tại kênh thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">i</script></span> của đầu ra với một đơn vị tại kênh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">j</script></span> của đầu vào, với độ lệch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">k</script></span> hàng và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">l</script></span> cột giữa đơn vị đầu ra và đơn vị đầu vào. Giả sử rằng đầu vào của chúng ta chứa dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-mrow" id="MJXp-Span-578"><span class="MJXp-mi undefined" id="MJXp-Span-579">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">\boldsymbol{\mathsf{V}}</script></span> quan sát được, với phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-msubsup" id="MJXp-Span-581"><span class="MJXp-mrow" id="MJXp-Span-582" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-583"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-584">V</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-585" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">i</span><span class="MJXp-mo" id="MJXp-Span-587">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">j</span><span class="MJXp-mo" id="MJXp-Span-589">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">k</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">{\mathsf{V}}_{i,j,k}</script></span> biểu thị giá trị đơn vị đầu vào ở kênh thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">i</script></span>, tại điểm nằm ở hàng thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">j</script></span> và cột thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">k</script></span>. Giả sử đầu ra của  ta là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-597"><span class="MJXp-mrow" id="MJXp-Span-598"><span class="MJXp-mi undefined" id="MJXp-Span-599">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">\boldsymbol{\mathsf{Z}}</script></span> có định dạng giống với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-mrow" id="MJXp-Span-601"><span class="MJXp-mi undefined" id="MJXp-Span-602">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">\boldsymbol{\mathsf{V}}</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-603"><span class="MJXp-mrow" id="MJXp-Span-604"><span class="MJXp-mi undefined" id="MJXp-Span-605">Z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">\boldsymbol{\mathsf{Z}}</script></span> là một kết quả của phép tích chập giữa tensor lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-606"><span class="MJXp-mrow" id="MJXp-Span-607"><span class="MJXp-mi undefined" id="MJXp-Span-608">K</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol{\mathsf{K}}</script></span> và dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-mrow" id="MJXp-Span-610"><span class="MJXp-mi undefined" id="MJXp-Span-611">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\boldsymbol{\mathsf{V}}</script></span> khi ta không áp dụng đảo lõi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mrow" id="MJXp-Span-613"><span class="MJXp-mi undefined" id="MJXp-Span-614">K</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">\boldsymbol{\mathsf{K}}</script></span>, thì:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-615"><span class="MJXp-mtable" id="MJXp-Span-616"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-617" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-618" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-621" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">i</span><span class="MJXp-mo" id="MJXp-Span-623">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">j</span><span class="MJXp-mo" id="MJXp-Span-625">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-628"><span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-630" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">l</span><span class="MJXp-mo" id="MJXp-Span-632">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">m</span><span class="MJXp-mo" id="MJXp-Span-634">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">n</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-638" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">l</span><span class="MJXp-mo" id="MJXp-Span-640">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">j</span><span class="MJXp-mo" id="MJXp-Span-642">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">m</span><span class="MJXp-mo" id="MJXp-Span-644">−</span><span class="MJXp-mn" id="MJXp-Span-645">1</span><span class="MJXp-mo" id="MJXp-Span-646">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">k</span><span class="MJXp-mo" id="MJXp-Span-648">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">n</span><span class="MJXp-mo" id="MJXp-Span-650">−</span><span class="MJXp-mn" id="MJXp-Span-651">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653" style="margin-right: 0.05em;">K</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-654" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">i</span><span class="MJXp-mo" id="MJXp-Span-656">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">l</span><span class="MJXp-mo" id="MJXp-Span-658">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">m</span><span class="MJXp-mo" id="MJXp-Span-660">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">n</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-132">Z_{i,j,k}=\sum\limits_{l,m,n}V_{l, j+m-1,k+n-1}K_{i,l,m,n} \tag{9.7}</script></span></p><p>trong đó, phép lấy tổng trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">l</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">l,m</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">n</script></span> trên tất cả các giá trị mà tại đó chỉ số của tensor hợp lệ. Theo cách ký hiệu của đại số tuyến tính, ta đánh chỉ số các mảng bắt đầu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mn" id="MJXp-Span-669">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">1</script></span>. Do đó, ta phải có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-672">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">-1</script></span> trong công thức trên. Với các ngôn ngữ lập trình như C và Python thì chỉ số sẽ bắt đầu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-mn" id="MJXp-Span-674">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">0</script></span>, do vậy biểu diễn công thức trên bằng ngôn ngữ lập trình sẽ đơn giản hơn.</p><p>Chúng ta có thể sẽ muốn bỏ qua một vài vị trí của lõi để giảm chi phí tính toán (đổi lại bằng việc giảm bớt chất lượng của việc trích xuất các đặc trưng). Ta có thể coi việc này giống như bước áp dụng thu nhỏ mẫu (downsampling) đầu ra của hàm tích chập đầy đủ. Nếu chỉ muốn lấy mẫu mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">s</script></span> điểm ảnh theo mỗi chiều tại đầu ra, ta có thể định nghĩa một hàm tích chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">c</script></span> đã thu nhỏ mẫu như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-679"><span class="MJXp-mtable" id="MJXp-Span-680"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-681" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-682" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684" style="margin-right: 0.05em;">Z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-685" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">i</span><span class="MJXp-mo" id="MJXp-Span-687">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">j</span><span class="MJXp-mo" id="MJXp-Span-689">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">c</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-694"><span class="MJXp-mi undefined" id="MJXp-Span-695">K</span></span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-697"><span class="MJXp-mi undefined" id="MJXp-Span-698">V</span></span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">s</span><span class="MJXp-msubsup" id="MJXp-Span-701"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-703" style="vertical-align: -0.4em;"><span class="MJXp-mspace" id="MJXp-Span-704" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">i</span><span class="MJXp-mo" id="MJXp-Span-706">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">j</span><span class="MJXp-mo" id="MJXp-Span-708">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-711"><span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-713" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">l</span><span class="MJXp-mo" id="MJXp-Span-715">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">m</span><span class="MJXp-mo" id="MJXp-Span-717">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-722" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">l</span><span class="MJXp-mo" id="MJXp-Span-724">,</span><span class="MJXp-mspace" id="MJXp-Span-725" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-726">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">j</span><span class="MJXp-mo" id="MJXp-Span-728">−</span><span class="MJXp-mn" id="MJXp-Span-729">1</span><span class="MJXp-mo" id="MJXp-Span-730">)</span><span class="MJXp-mo" id="MJXp-Span-731">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">s</span><span class="MJXp-mo" id="MJXp-Span-733">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">m</span><span class="MJXp-mo" id="MJXp-Span-735">,</span><span class="MJXp-mspace" id="MJXp-Span-736" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-737">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">k</span><span class="MJXp-mo" id="MJXp-Span-739">−</span><span class="MJXp-mn" id="MJXp-Span-740">1</span><span class="MJXp-mo" id="MJXp-Span-741">)</span><span class="MJXp-mo" id="MJXp-Span-742">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">s</span><span class="MJXp-mo" id="MJXp-Span-744">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">n</span></span></span><span class="MJXp-mspace" id="MJXp-Span-746" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748" style="margin-right: 0.05em;">K</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-749" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">i</span><span class="MJXp-mo" id="MJXp-Span-751">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">l</span><span class="MJXp-mo" id="MJXp-Span-753">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">m</span><span class="MJXp-mo" id="MJXp-Span-755">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">Z_{i,j,k} = c(\boldsymbol{\mathsf{K}}, \boldsymbol{\mathsf{V}}, s)_{\,i,j,k} = \sum\limits_{l,m,n} [V_{l, \,(j-1)\times s +m, \,(k-1)\times s +n}\,K_{i,l,m,n}] \tag{9.8}</script></span></p><p>Chúng tôi coi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">s</script></span> là tham số đại diện cho <strong>sải chập</strong> (stride) của phép tích chập đã thu nhỏ mẫu này. Ta cũng có thể định nghĩa một giá trị sải chập riêng cho mỗi hướng dịch chuyển. Xem minh hoạ ở hình 9.12.</p><p><img src="https://i.imgur.com/wWWzRBG.png" alt=""></p><blockquote>
<p>Hình 9.12: Phép tích chập theo sải. Trong ví dụ này, chúng tôi sử dụng sải chập có độ lớn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-760"><span class="MJXp-mn" id="MJXp-Span-761">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">2</script></span>. <em>(Hình trên)</em> Phép tích chập với độ lớn sải bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mn" id="MJXp-Span-763">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">2</script></span> cho mỗi lượt tích chập. <em>(Hình dưới)</em> Phép tích chập với sải chập lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-764"><span class="MJXp-mn" id="MJXp-Span-765">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">1</script></span> điểm ảnh là tương đương về mặt toán học với phép tích chập với sải bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mn" id="MJXp-Span-767">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">1</script></span> sau đó áp dụng thu nhỏ mẫu. Rõ ràng là hướng tiếp cận ở hình dưới sẽ lãng phí tài nguyên tính toán, bởi nó tính toán rất nhiều giá trị rồi loại bỏ ngay sau đó.</p>
</blockquote><p>Một đặc tính tối quan trọng trong việc thực thi bất cứ mô hình mạng tích chập nào là ta có thể đệm thêm các giá trị 0 để mở rộng dữ liệu đầu vào. Nếu không có đặc tính này thì kích thước của dữ liệu đầu vào sau khi đi qua mỗi tầng sẽ bị co lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mn" id="MJXp-Span-769">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">1</script></span> điểm ảnh so với độ rộng của lõi ở mỗi tầng. Kỹ thuật đệm thêm các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-770"><span class="MJXp-mn" id="MJXp-Span-771">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">0</script></span> (zero padding) cho phép ta kiểm soát độ rộng của lõi và kích thước đầu ra một cách độc lập với nhau. Nếu không có kỹ thuật này, ta sẽ bị buộc phải lựa chọn giữa sử dụng lõi có kích thước nhỏ, hoặc chấp nhận việc phạm vi không gian của mạng sẽ bị co lại một cách nhanh chóng. Cả hai lựa chọn này đều sẽ giảm năng lực biểu đạt của mô hình mạng một cách rõ rệt. Xem ví dụ ở hình 9.13.</p><p>Có ba trường hợp đặc biệt trong cách cấu hình đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-772"><span class="MJXp-mn" id="MJXp-Span-773">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">0</script></span> cần được nhắc đến. Một là trường hợp cực đoan khi ta hoàn toàn không sử dụng đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mn" id="MJXp-Span-775">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">0</script></span>, và lõi chỉ được phép đi qua những vị trí mà toàn bộ lõi nằm hoàn toàn trong ảnh. Thuật ngữ trong MATLAB gọi đây là tích chập <em>hợp lệ</em> (valid convolution). Trong trường hợp này thì tất cả điểm ảnh tại đầu ra là một hàm của cùng một số lượng điểm ảnh trong đầu vào, do đó hành vi của điểm ảnh đầu ra có phần chuẩn tắc hơn. Tuy nhiên, kích thước đầu ra sẽ bị co lại dần qua mỗi tầng trong mô hình. Nếu ảnh đầu vào có độ rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">m</script></span> và lõi có độ rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">k</script></span> thì đầu ra sẽ có độ rộng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">m</span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">k</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-785">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">m - k +1</script></span>. Tốc độ co lại về kích thước này sẽ tăng lên nhanh chóng nếu như ta sử dụng lõi có kích thước lớn. Do mức co lại luôn lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mn" id="MJXp-Span-787">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">0</script></span>, nên số lượng tầng tích chập có thể đưa vào mô hình mạng sẽ bị giới hạn. Khi ta đưa thêm tầng vào mô hình, số chiều không gian của mạng sẽ dần giảm về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mn" id="MJXp-Span-789">1</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-791">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">1 \times 1</script></span>, tại thời điểm đó các tầng tích chập phía sau sẽ không còn ý nghĩa nữa. Một trường hợp đặc biệt nữa của đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mn" id="MJXp-Span-793">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">0</script></span> đó là thêm vừa đủ vùng đệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mn" id="MJXp-Span-795">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">0</script></span> để kích thước đầu ra đúng bằng với kích thước đầu vào. MATLAB gọi kỹ thuật này là tích chập <em>đều</em> (same convolution). Trong trường hợp này, mô hình mạng có thể thêm số lượng tầng tích chập tuỳ ý miễn là phù hợp với giới hạn tính toán của phần cứng, bởi phép tích chập thực hiện ở tầng trước không làm ảnh hưởng đến cấu trúc dữ liệu đầu vào ở tầng sau. Tuy nhiên, những điểm ảnh đầu vào gần vị trí biên của ảnh ảnh hưởng đến đầu ra ít hơn so với các điểm ảnh nằm ở trung tâm. Điều này sẽ dẫn đến việc các điểm ảnh nằm ở biên, theo một cách nào đó, sẽ không được thể hiện đầy đủ trong mô hình. Hạn chế này thúc đẩy một trường hợp tiêu biểu nữa, mà MATLAB gọi là phép tích chập <em>đầy đủ</em> (full convolution), trong đó một số lượng vừa đủ giá trị điểm ảnh bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-mn" id="MJXp-Span-797">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">0</script></span> được thêm vào để có thể thực hiện phép chập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">k</script></span> lần theo mỗi hướng, trả về một đầu ra có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">m</span><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">k</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-805">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">m-k+1</script></span>. Trong trường hợp này, các điểm ảnh đầu ra ở vị trí gần biên là một hàm số của ít điểm ảnh đầu vào hơn so với các điểm ảnh nằm ở trung tâm của ảnh. Việc này có thể gây khó khăn cho việc học một lõi duy nhất sao cho nó hữu hiệu tại mọi vị trí trong ánh xạ đặc trưng tích chập. Thông thường thì số lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-mn" id="MJXp-Span-807">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">0</script></span> đệm vào tối ưu nhất (xét về độ phân loại chính xác của tập kiểm thử) nằm ở đâu đó giữa tích chập “hợp lệ” và tích chậm “đều”.</p><p><img src="https://i.imgur.com/1KSFf8K.png" alt=""></p><blockquote>
<p>Hình 9.13: Ảnh hưởng của đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-808"><span class="MJXp-mn" id="MJXp-Span-809">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">0</script></span>* lên kích thước của mô hình mạng. Xét một mạng tích chập với lõi có độ rộng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mn" id="MJXp-Span-811">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">6</script></span> tại mọi tầng mạng. Trong ví dụ này, chúng ta không sử dụng bất kỳ phép gộp nào, do vậy chỉ có bản thân phép tích chập làm giảm kích thước mô hình mạng. <em>(Hình trên)</em>  Trong mạng tích chập này, chúng ta không đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-mn" id="MJXp-Span-813">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">0</script></span>. Điều này khiến ma trận biểu diễn bị co lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mn" id="MJXp-Span-815">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">5</script></span> điểm ảnh qua mỗi tầng mạng. Dữ liệu đầu vào có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mn" id="MJXp-Span-817">16</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">16</script></span> điểm ảnh, ta chỉ có thể sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-mn" id="MJXp-Span-819">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">3</script></span> tầng tích chập trong mô hình, và tầng cuối cùng không thể di chuyển lõi được nên thực sự mô hình chỉ có thể áp dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-mn" id="MJXp-Span-821">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">2</script></span> tầng tích chập mà thôi. Tốc độ co dữ liệu có thể giảm bớt khi ta sử dụng lõi với kích cỡ nhỏ hơn, nhưng cũng đồng nghĩa với việc giảm khả năng biểu diễn, và việc bị co dữ liệu là không thể tránh khỏi trong kiểu kiến trúc này. <em>(Hình dưới)</em> Bằng cách thêm vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-mn" id="MJXp-Span-823">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">5</script></span> điểm ảnh có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mn" id="MJXp-Span-825">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">0</script></span> tại mỗi tầng một cách ngầm định, chúng ta ngăn ngừa được việc ma trận biểu diễn bị co lại. Điều này cho phép ta tạo ra một mạng tích chập với độ sâu tùy ý.</p>
</blockquote><p>Trong một số trường hợp, ta không thực sự cần sử dụng tích chập, thay vào đó là các <em>tầng kết nối cục bộ</em> (locally connected layers) [LeCun, 1986, 198]. Trong trường hợp này, các ma trận kề trong đồ thị của mạng Perceptron đa tầng là giống nhau, tuy nhiên, mỗi kết nối đều có trọng số riêng được xác định bởi một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mn" id="MJXp-Span-827">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">6</script></span> chiều: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-mrow" id="MJXp-Span-829"><span class="MJXp-mi undefined" id="MJXp-Span-830">W</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\boldsymbol{\mathsf{W}}</script></span>. Các chỉ số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-831"><span class="MJXp-mrow" id="MJXp-Span-832"><span class="MJXp-mi undefined" id="MJXp-Span-833">W</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">\boldsymbol{\mathsf{W}}</script></span> tương ứng như sau: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">i</script></span> là chỉ số kênh đầu ra, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">j</script></span> là hàng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">k</script></span> là cột, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">l</script></span> là chỉ số kênh đầu vào, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">m</script></span> là chỉ số độ lệch (offset) của hàng trong dữ liệu đầu vào, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">n</script></span> là chỉ số độ lệch của cột trong dữ liệu đầu vào. Phần tuyến tính của tầng kết nối cục bộ có dạng sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-846"><span class="MJXp-mtable" id="MJXp-Span-847"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-848" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-849" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-850"><span class="MJXp-mrow" id="MJXp-Span-851" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-852">Z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">i</span><span class="MJXp-mo" id="MJXp-Span-855">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">j</span><span class="MJXp-mo" id="MJXp-Span-857">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-860"><span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-862" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">l</span><span class="MJXp-mo" id="MJXp-Span-864">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">m</span><span class="MJXp-mo" id="MJXp-Span-866">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-869"><span class="MJXp-mrow" id="MJXp-Span-870" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-871">V</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-872" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">l</span><span class="MJXp-mo" id="MJXp-Span-874">,</span><span class="MJXp-mspace" id="MJXp-Span-875" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">j</span><span class="MJXp-mo" id="MJXp-Span-877">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">m</span><span class="MJXp-mo" id="MJXp-Span-879">−</span><span class="MJXp-mn" id="MJXp-Span-880">1</span><span class="MJXp-mo" id="MJXp-Span-881">,</span><span class="MJXp-mspace" id="MJXp-Span-882" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">k</span><span class="MJXp-mo" id="MJXp-Span-884">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">n</span><span class="MJXp-mo" id="MJXp-Span-886">−</span><span class="MJXp-mn" id="MJXp-Span-887">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-888" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-891" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">i</span><span class="MJXp-mo" id="MJXp-Span-893">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">j</span><span class="MJXp-mo" id="MJXp-Span-895">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">k</span><span class="MJXp-mo" id="MJXp-Span-897">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">l</span><span class="MJXp-mo" id="MJXp-Span-899">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">m</span><span class="MJXp-mo" id="MJXp-Span-901">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-179">\mathsf{Z}_{i,j,k} = \sum\limits_{l,m,n} [\mathsf{V}_{l,\,j+m-1,\,k+n-1}\,w_{i,j,k,l,m,n}]. \tag{9.9}</script></span></p><p>Đôi khi ta gọi đó là <em>phép tích chập không dùng chung tham số</em> (unshared convolution), bởi nó tương tự như một phép tích chập rời rạc với lõi nhỏ, nhưng không dùng chung các tham số giữa các vị trí với nhau. Hình 9.14 so sánh giữa phương pháp kết nối cục bộ, phương pháp tích chập và phương pháp kết nối đầy đủ.</p><p><img src="https://i.imgur.com/bw2Ke7k.png" alt=""></p><blockquote>
<p>Hình 9.14: So sánh giữa kết nối cục bộ, tích chập và kết nối đầy đủ. <em>(Hình trên)</em> Một tầng kết nối cục bộ với kích thước mảnh (patch size) là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-905"><span class="MJXp-mn" id="MJXp-Span-906">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">2</script></span> điểm ảnh. Mỗi cạnh được gán một chữ cái độc nhất, thể hiện rằng các cạnh được liên kết với trọng số của riêng nó. <em>(Hình giữa)</em> Một tầng tích chập với lõi có chiều rộng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mn" id="MJXp-Span-908">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">2</script></span> điểm ảnh. Mô hình này có cấu trúc kết nối giống hệt với tầng kết nối cục bộ. Điểm khác biệt không nằm ở cách tương tác giữa các đơn vị với nhau, mà là ở cách dùng chung tham số. Tầng kết nối cục bộ không dùng chung tham số. Tầng tích chập sử dụng cùng một cặp trọng số lặp đi lặp lại trên toàn bộ đầu vào, biểu diễn bằng các chữ cái lặp lại bên cạnh các mũi tên. <em>(Hình dưới)</em> Một tầng kết nối đầy đủ giống với tầng kết nối cục bộ ở chỗ mỗi cạnh đều có tham số của riêng nó. Tuy nhiên các kết nối không hề bị giới hạn như trường hợp của tầng kết nối cục bộ.</p>
</blockquote><p>Phương pháp sử dụng các tầng kết nối cục bộ sẽ hữu ích khi ta biết mỗi đặc trưng sẽ là một hàm số của một phần nhỏ của không gian ảnh, nhưng không có lý do gì để đặc trưng đó cũng sẽ xuất hiện trên toàn bộ không gian ảnh. Ví dụ, nếu ta muốn biết một tấm ảnh có phải chụp một khuôn mặt hay không, ta chỉ cần tìm kiếm phần miệng ở nửa dưới của bức ảnh.</p><p>Đôi khi ta muốn tạo ra các phiên bản tích chập hoặc các tầng kết nối cục bộ mà trong đó cấu trúc liên kết bị giới hạn hơn, chẳng hạn, để ràng buộc mỗi kênh đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">i</script></span> trở thành một hàm số của chỉ một tập con của các kênh đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">l</script></span>. Một cách thông thường để làm việc này đó là đưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">m</script></span> kênh đầu tiên tại đầu ra kết nối với chỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">n</script></span> kênh đầu tiên tại đầu vào, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">m</script></span> kênh thứ hai tại đầu ra kết nối với chỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">n</script></span> kênh thứ hai tại đầu vào, vân vân. Hình 9.15 minh hoạ một ví dụ như vậy. Việc mô hình hoá các tương tác giữa một số lượng nhỏ các kênh cho phép mô hình mạng có ít tham số hơn, giảm mức tiêu thụ bộ nhớ trong quá trình tính toán, tăng hiệu quả thống kê và giảm số lượng tính toán cần thiết để thực hiện thuật toán lan truyền thuận và ngược. Phương pháp này giúp giải quyết các mục tiêu trên mà không cần phải giảm số lượng đơn vị ẩn.</p><p><img src="https://i.imgur.com/dr3iOv5.png" alt=""></p><blockquote>
<p>Hình 9.15: Một mạng tích chập với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-mn" id="MJXp-Span-922">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">2</script></span> kênh đầu ra đầu tiên được kết nối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mn" id="MJXp-Span-924">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">2</script></span> kênh đầu vào đầu tiên, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-925"><span class="MJXp-mn" id="MJXp-Span-926">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">2</script></span> kênh đầu ra thứ hai được kết nối đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mn" id="MJXp-Span-928">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">2</script></span> kênh đầu vào thứ hai.</p>
</blockquote><p><em>Tích chập xếp chồng</em> (tiled convolution) [Gregor and LeCun, 2010a; Le et al., 2010] cho ta một sự thoả hiệp giữat một tầng tích chập và một tầng kết nối cục bộ. Thay vì học riêng biệt từng bộ trọng số tại mỗi vị trí, chúng ta sẽ học một bộ các lõi mà chúng ta có thể xoay lõi đó khi dịch chuyển trong không gian ảnh. Điều này có nghĩa là các vị trí kề nhau sẽ có các bộ lọc khác nhau như trong một tầng kết nối cục bộ, tuy nhiên, yêu cầu bộ nhớ lưu trữ các tham số sẽ tăng lên theo tỉ lệ kích thước của tập lõi này, thay vì tăng theo kích thước của toàn bộ ánh xạ đặc trưng đầu ra. Hình 9.16 thể hiện một so sánh giữa các tầng kết nối cục bộ, tích chập xếp chồng và tích chập tiêu chuẩn.</p><p><img src="https://i.imgur.com/h6MxPOW.png" alt=""></p><blockquote>
<p>Hình 9.16: So sánh giữa các tầng kết nối cục bộ, tích chập xếp chồng và tích chập tiêu chuẩn. Cả ba đều có cùng dạng kết nối giữa các đơn vị khi sử dụng lõi có cùng kích thước. Sơ đồ này mô phỏng việc sử dụng lõi có chiều rộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mn" id="MJXp-Span-930">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">2</script></span> điểm ảnh. Sự khác biệt giữa các phương pháp này nằm ở cách chúng chia sẻ tham số. <em>(Hình trên)</em> Tầng kết nối cục bộ không dùng chung tham số. Ta thấy rằng mỗi kết nối có trọng số của riêng nó và mỗi liên kết được ký hiệu bằng một chữ cái riêng biệt. <em>(Hình giữa)</em> Tích chập xếp chồng có một bộ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">t</script></span> lõi khác nhau. Ở đây ta mô phỏng trường hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">t</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-936">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">t=2</script></span>, một lõi có các liên kết được ký hiệu là “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">a</script></span>” và “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">b</script></span>”, lõi còn lại có liên kết được ký hiệu là “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">c</script></span>” và “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">d</script></span>”. Mỗi lần ta dịch đầu ra sang phải một điểm ảnh, thì ta cũng chuyển sang sử dụng lõi kế tiếp. Điều này có nghĩa là, giống như tầng kết nối cục bộ, các đơn vị liền kề tại đầu ra có các tham số khác nhau. Tuy nhiên, không giống như tầng kết nối cục bộ, sau khi ta đã sử dụng hết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">t</script></span> lõi, chúng ta sẽ quay vòng trở lại với lõi đầu tiên. Hai đơn vị đầu ra cách nhau một khoảng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">t</script></span> bước sẽ dùng chung tham số với nhau. <em>(Hình dưới)</em> Tích chập thông thường, tương đương với tích chập xếp chồng có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">t</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-952">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-201">t=1</script></span>. Nó chỉ áp dụng duy nhất một lõi tại mọi điểm trên ảnh, như ta thấy ở trên hình là lõi với các trọng số được gán nhãn “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">a</script></span>” và “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">b</script></span>” tại khắp nơi.</p>
</blockquote><p>Để định nghĩa tích chập xếp chồng về mặt đại số, đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-957"><span class="MJXp-mrow" id="MJXp-Span-958"><span class="MJXp-mi undefined" id="MJXp-Span-959">K</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">\boldsymbol{\mathsf{K}}</script></span> là một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mn" id="MJXp-Span-961">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">6</script></span> chiều, có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-962"><span class="MJXp-mn" id="MJXp-Span-963">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">2</script></span> chiều tương ứng với các vị trí khác nhau của dữ liệu đầu ra. Thay vì sử dụng một chỉ số riêng biệt cho mỗi vị trí trên ánh xạ đầu ra, các vị trí ở đầu ra sẽ xoay vòng trên một tập hợp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">t</script></span> lựa chọn khác nhau của ngăn xếp lõi (kernel stack) theo mỗi hướng. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">t</script></span> bằng với chiều rộng của đầu ra, tích chập xếp chồng sẽ giống với một tầng kết nối cục bộ:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-968"><span class="MJXp-mtable" id="MJXp-Span-969"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-970" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-971" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-972"><span class="MJXp-mrow" id="MJXp-Span-973" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-974">Z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-975" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">i</span><span class="MJXp-mo" id="MJXp-Span-977">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">j</span><span class="MJXp-mo" id="MJXp-Span-979">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-982"><span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-984" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">l</span><span class="MJXp-mo" id="MJXp-Span-986">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">m</span><span class="MJXp-mo" id="MJXp-Span-988">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">n</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-990"><span class="MJXp-mrow" id="MJXp-Span-991" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-992">V</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-993" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">l</span><span class="MJXp-mo" id="MJXp-Span-995">,</span><span class="MJXp-mspace" id="MJXp-Span-996" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">j</span><span class="MJXp-mo" id="MJXp-Span-998">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">m</span><span class="MJXp-mo" id="MJXp-Span-1000">−</span><span class="MJXp-mn" id="MJXp-Span-1001">1</span><span class="MJXp-mo" id="MJXp-Span-1002">,</span><span class="MJXp-mspace" id="MJXp-Span-1003" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">k</span><span class="MJXp-mo" id="MJXp-Span-1005">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">n</span><span class="MJXp-mo" id="MJXp-Span-1007">−</span><span class="MJXp-mn" id="MJXp-Span-1008">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mrow" id="MJXp-Span-1010" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-1011">K</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1012" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">i</span><span class="MJXp-mo" id="MJXp-Span-1014">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">l</span><span class="MJXp-mo" id="MJXp-Span-1016">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">m</span><span class="MJXp-mo" id="MJXp-Span-1018">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">n</span><span class="MJXp-mo" id="MJXp-Span-1020">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">j</span><span class="MJXp-mi" id="MJXp-Span-1022">%</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">t</span><span class="MJXp-mo" id="MJXp-Span-1024">+</span><span class="MJXp-mn" id="MJXp-Span-1025">1</span><span class="MJXp-mo" id="MJXp-Span-1026">,</span><span class="MJXp-mspace" id="MJXp-Span-1027" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">k</span><span class="MJXp-mi" id="MJXp-Span-1029">%</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">t</span><span class="MJXp-mo" id="MJXp-Span-1031">+</span><span class="MJXp-mn" id="MJXp-Span-1032">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-209">\mathsf{Z}_{i,j,k} = \sum\limits_{l,m,n} \mathsf{V}_{l,\,j+m-1,\,k+n-1}\mathsf{K}_{i,l,m,n, j\%t+1,\,k\%t +1},\tag{9.10}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-mi" id="MJXp-Span-1035">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">\%</script></span> là phép toán chia lấy dư, ví dụ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">t</span><span class="MJXp-mspace" id="MJXp-Span-1038" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1039">%</span><span class="MJXp-mspace" id="MJXp-Span-1040" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">t</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1043">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">t\,\%\,t = 0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">t</span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1048">1</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1050">%</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">t</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1053">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">(t+1)\%t=1</script></span>, vân vân. Ta có thể dễ dàng tổng quát hóa phương trình này cho trường hợp kích thước ngăn xếp lõi khác nhau ở mỗi chiều.</p><p>Các tầng kết nối cục bộ và các tầng tích chập xếp chồng đều có một tương tác thú vị với phép gộp cực đại: các đơn vị phát hiện của những tầng này được dẫn dắt bởi các bộ lọc khác nhau. Nếu những bộ lọc này được học để phát hiện các phiên bản biến đổi khác nhau của cùng các đặc trưng bên dưới thì phép gộp cực đại sẽ trở nên bất biến đối với các phép biến đổi đã học (xem hình 9.9). Các tầng tích chập được thiết kế để trở nên bất biến cụ thể là với các phép tịnh tiến.</p><p>Ngoài phép tích chập, các mạng tích chập cũng thường cần thực hiện một số phép toán khác. Để thực thi quá trình học từ dữ liệu, mô hình phải có khả năng tính toán gradient đối với lõi, khi biết gradient đối với đầu ra. Trong một số trường hợp đơn giản, phép toán này có thể được thực hiện bằng phép tích chập, nhưng với nhiều trường hợp đáng chú ý, bao gồm trường hợp mà giá trị sải chập lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mn" id="MJXp-Span-1055">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">1</script></span>, sẽ không có đặc tính này.</p><p>Nhắc lại, tích chập là một phép toán tuyến tính và do đó có thể được mô tả dưới dạng một phép nhân ma trận (nếu trước đó ta thay đổi hình dạng của tensor đầu vào thành một vector phẳng). Ma trận liên quan là một hàm số của lõi tích chập. Ma trận đó là ma trận thưa, và mỗi phần tử của lõi được sao chép sang nhiều phần tử của ma trận đó. Cách nhìn này sẽ giúp ta suy ra một vài phép toán khác cần thiết trong quá trình thực thi mô hình mạng tích chập.</p><p>Phép nhân với chuyển vị của ma trận được xác định bởi tích chập là một trong những phép toán như vậy. Đây là phép toán cần thiết để lan truyền ngược các đạo hàm của hàm sai số qua một tầng tích chập, do đó phép toán này là cần thiết khi huấn luyện mạng tích chập có nhiều hơn một tầng ẩn. Phép toán này cũng cần thiết khi ta cần phục hồi các đơn vị khả kiến (visible) từ những đơn vị ẩn (hidden) [Simard et al., 1992]. Việc phục hồi các đơn vị khả kiến là một phép toán thông thường được sử dụng trong các mô hình ở trong phần III của quyển sách này, như bộ tự mã hóa, máy Boltzmann thu hẹp và mã hóa thưa. Tích chập chuyển vị là cần thiết khi ta xây dựng các phiên bản tích chập của những mô hình này. Giống như phép tính gradient cho lõi, phép tính gradient cho đầu vào này đôi khi có thể được thực hiện bằng một phép tích chập nhưng thường yêu cầu thực hiện thêm một phép toán thứ ba. Cần phải cẩn trọng khi phối hợp phép chuyển vị ma trận này với quá trình lan truyền thuận. Kích thước ma trận đầu ra sau khi chuyển vị phụ thuộc vào việc sử dụng kỹ thuật đệm thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1056"><span class="MJXp-mn" id="MJXp-Span-1057">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">0</script></span> và sải chập trong quá trình tính toán lan truyền thuận, cũng như kích thước của ánh xạ đầu ra sau quá trình lan truyền thuận. Trong một số trường hợp, nhiều đầu vào có kích thước khác nhau có thể trả về ánh xạ đầu ra của phép lan truyền thuận có cùng một kích thước, do vậy phép chuyển vị phải biết được chính xác kích thước của dữ liệu đầu vào ban đầu.</p><p>Ba phép toán trên — tích chập, lan truyền ngược từ đầu ra về các trọng số và lan truyền ngược từ đầu ra về đầu vào—là đủ để tính toán mọi gradient cần thiết cho việc huấn luyện bất cứ mô hình mạng tích chập lan truyền thuận nào với độ sâu bất kỳ, cũng như huấn luyện các mô hình mạng tích chập với các hàm phục hồi dựa trên chuyển vị của phép tích chập. Tham khảo Goodfellow (2010) về phương pháp đầy đủ để suy ra các phương trình trong các trường hợp đa chiều, đa mẫu huấn luyện tổng quát. Để tìm hiểu một chút cách hoạt động của các phương trình này, ở đây chúng tôi sẽ sử dụng phên bản <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1058"><span class="MJXp-mn" id="MJXp-Span-1059">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">2</script></span> chiều với chỉ một mẫu huấn luyện.</p><hr><p>Người dịch: Mai Anh, Sơn Hoàng Trần, Thomas Nguyễn, Dương Nguyễn, Hùng Lê, Phát Võ, LA, Linux, Nam Trần, Xuân Tú</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-9-Các-mạng-tích-chập-giai-đoạn-1" title="Chương 9: Các mạng tích chập (giai đoạn 1)">Chương 9: Các mạng tích chập (giai đoạn 1)</a></li>
<li><a href="#91-Phép-tích-chập" title="9.1. Phép tích chập">9.1. Phép tích chập</a></li>
<li><a href="#92-Động-lực-phát-triển" title="9.2 Động lực phát triển">9.2 Động lực phát triển</a></li>
<li><a href="#93-Phép-gộp" title="9.3. Phép gộp">9.3. Phép gộp</a></li>
<li><a href="#94-Tích-chập-và-phép-gộp-dưới-góc-nhìn-một-tiên-nghiệm-mạnh-vô-hạn" title="9.4 Tích chập và phép gộp dưới góc nhìn một tiên nghiệm mạnh vô hạn.">9.4 Tích chập và phép gộp dưới góc nhìn một tiên nghiệm mạnh vô hạn.</a></li>
<li><a href="#95-Các-biến-thể-của-hàm-tích-chập-cơ-bản" title="9.5 Các biến thể của hàm tích chập cơ bản">9.5 Các biến thể của hàm tích chập cơ bản</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-9-Các-mạng-tích-chập-giai-đoạn-1" title="Chương 9: Các mạng tích chập (giai đoạn 1)">Chương 9: Các mạng tích chập (giai đoạn 1)</a></li>
<li><a href="#91-Phép-tích-chập" title="9.1. Phép tích chập">9.1. Phép tích chập</a></li>
<li><a href="#92-Động-lực-phát-triển" title="9.2 Động lực phát triển">9.2 Động lực phát triển</a></li>
<li><a href="#93-Phép-gộp" title="9.3. Phép gộp">9.3. Phép gộp</a></li>
<li><a href="#94-Tích-chập-và-phép-gộp-dưới-góc-nhìn-một-tiên-nghiệm-mạnh-vô-hạn" title="9.4 Tích chập và phép gộp dưới góc nhìn một tiên nghiệm mạnh vô hạn.">9.4 Tích chập và phép gộp dưới góc nhìn một tiên nghiệm mạnh vô hạn.</a></li>
<li><a href="#95-Các-biến-thể-của-hàm-tích-chập-cơ-bản" title="9.5 Các biến thể của hàm tích chập cơ bản">9.5 Các biến thể của hàm tích chập cơ bản</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
