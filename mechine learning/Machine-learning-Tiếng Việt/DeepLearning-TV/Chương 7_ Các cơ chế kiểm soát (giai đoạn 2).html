<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-7-Các-cơ-chế-kiểm-soát-giai-đoạn-2">Chương 7: Các cơ chế kiểm soát (giai đoạn 2)</h1><p>Theo chuỗi Taylor xấp xỉ cục bộ, gradient được tính như sau:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtable" id="MJXp-Span-2"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi" id="MJXp-Span-6" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-munderover" id="MJXp-Span-9"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">J</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-13">w</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">H</span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-18">w</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="min-width: 17.19em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.19em;"><span style="display: inline-block; position: absolute; width: 10.509em; height: 0px; clip: rect(-1.021em, 1010.4em, 0.541em, -999.997em); top: 0em; left: 50%; margin-left: -5.224em;"><span style="position: absolute; clip: rect(2.966em, 1010.4em, 4.529em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.509em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1010.4em, 4.421em, -999.997em); top: -3.877em; left: 50%; margin-left: -5.224em;"><span class="mtd" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-11" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-12"><span class="mrow" id="MathJax-Span-13"><span class="munderover" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.254em; left: 0.326em;"><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-bold-italic;">w</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-bold-italic;">w</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-25" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.805em, 1002.48em, 0.541em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-7.34"><span class="mrow" id="MathJax-Span-5"><span class="mtext" id="MathJax-Span-6" style="font-family: MathJax_Main;">(7.34)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\nabla_\boldsymbol{w} \hat J(\boldsymbol{w}) = H(\boldsymbol{w} - \boldsymbol{w}^*).	 \tag{7.34} </script></span></p><p>Chúng ta sẽ nghiên cứu sự thay đổi quỹ đạo của vector tham số trong quá trình huấn luyện. Để đơn giản, ta thiết lập vector tham số ban đầu về gốc toạ độ,<sup>[3]</sup> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-msubsup" id="MJXp-Span-26"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-27" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-28" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-29">(</span><span class="MJXp-mn" id="MJXp-Span-30">0</span><span class="MJXp-mo" id="MJXp-Span-31">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-33">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-30"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mo" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\boldsymbol{w}^{(0)} = 0</script></span>. Ta sẽ nghiên cứu hành vi gần đúng của thuật toán trượt gradient trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">J</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">J</script></span> thông qua phân tích quá trình trượt gradient trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-36"><span class="MJXp-mrow" id="MJXp-Span-37"><span class="MJXp-munderover" id="MJXp-Span-38"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">J</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-45"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="munderover" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.254em; left: 0.326em;"><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\hat J</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-41"><span class="MJXp-mtable" id="MJXp-Span-42"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-43" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-44" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-48">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">τ</span><span class="MJXp-mo" id="MJXp-Span-50">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-51" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-52"></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-54" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-57" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-58">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">τ</span><span class="MJXp-mo" id="MJXp-Span-60">−</span><span class="MJXp-mn" id="MJXp-Span-61">1</span><span class="MJXp-mo" id="MJXp-Span-62">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi" id="MJXp-Span-66" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-munderover" id="MJXp-Span-69"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">J</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-75" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-76">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">τ</span><span class="MJXp-mo" id="MJXp-Span-78">−</span><span class="MJXp-mn" id="MJXp-Span-79">1</span><span class="MJXp-mo" id="MJXp-Span-80">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-82" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-83" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mspace" id="MJXp-Span-84" style="width: 3.543em; height: 0em;"></span></span><span class="MJXp-mtd" id="MJXp-Span-85" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-86"></span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-88" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-91" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-92">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">τ</span><span class="MJXp-mo" id="MJXp-Span-94">−</span><span class="MJXp-mn" id="MJXp-Span-95">1</span><span class="MJXp-mo" id="MJXp-Span-96">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-99">H</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-104">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">τ</span><span class="MJXp-mo" id="MJXp-Span-106">−</span><span class="MJXp-mn" id="MJXp-Span-107">1</span><span class="MJXp-mo" id="MJXp-Span-108">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-112" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-115" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-116" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-119" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-120">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">τ</span><span class="MJXp-mo" id="MJXp-Span-122">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-126" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mtd" id="MJXp-Span-127" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-128"></span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-130" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-132">I</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-135">H</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-141">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">τ</span><span class="MJXp-mo" id="MJXp-Span-143">−</span><span class="MJXp-mn" id="MJXp-Span-144">1</span><span class="MJXp-mo" id="MJXp-Span-145">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-147"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-148" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-149" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-52"><span class="mtable" id="MathJax-Span-53" style="min-width: 23.979em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.979em;"><span style="display: inline-block; position: absolute; width: 17.244em; height: 0px; clip: rect(-2.53em, 1017.19em, 1.996em, -999.997em); top: 0em; left: 50%; margin-left: -8.618em;"><span style="position: absolute; clip: rect(2.535em, 1004.31em, 6.845em, -999.997em); top: -5.008em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.313em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.84em, 4.151em, -999.997em); top: -5.385em; right: 0em;"><span class="mtd" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1003.07em, 4.151em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mspace" id="MathJax-Span-107" style="height: 0em; vertical-align: 0em; width: 3.074em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1004.31em, 4.259em, -999.997em); top: -2.368em; right: 0em;"><span class="mtd" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mo" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-155" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.013em;"></span></span><span style="position: absolute; clip: rect(2.481em, 1000.97em, 6.145em, -999.997em); top: -4.362em; left: 4.313em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -5.385em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68"></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -3.877em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110"></span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -2.368em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160"></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.367em;"></span></span><span style="position: absolute; clip: rect(2.697em, 1011.59em, 7.223em, -999.997em); top: -5.224em; left: 5.606em;"><span style="display: inline-block; position: relative; width: 11.641em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1010.08em, 4.421em, -999.997em); top: -5.385em; left: 0em;"><span class="mtd" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="msubsup" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="msubsup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="munderover" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.254em; left: 0.326em;"><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1011.59em, 4.421em, -999.997em); top: -3.877em; left: 0em;"><span class="mtd" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-121" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1010.19em, 4.421em, -999.997em); top: -2.368em; left: 0em;"><span class="mtd" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-171"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mo" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-181" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.229em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-2.26em, 1002.48em, 1.996em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -5.385em; right: 0em;"><span class="mtd" id="mjx-eqn-7.35"><span class="mrow" id="MathJax-Span-55"><span class="mtext" id="MathJax-Span-56" style="font-family: MathJax_Main;">(7.35)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-7.36"><span class="mrow" id="MathJax-Span-103"><span class="mtext" id="MathJax-Span-104" style="font-family: MathJax_Main;">(7.36)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -2.368em; right: 0em;"><span class="mtd" id="mjx-eqn-7.37"><span class="mrow" id="MathJax-Span-143"><span class="mtext" id="MathJax-Span-144" style="font-family: MathJax_Main;">(7.37)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">
\begin{eqnarray}
\boldsymbol{w}^{(\tau)} & = & \boldsymbol{w}^{(\tau-1)}-\epsilon\nabla_\boldsymbol{w}\hat J(\boldsymbol{w}^{(\tau-1)})\tag{7.35} \\
\hspace{1.5cm}& = &\boldsymbol{w}^{(\tau-1)}-\epsilon \boldsymbol H(\boldsymbol{w}^{(\tau-1)}-\boldsymbol{w}^*),\tag{7.36} \\
\boldsymbol{w}^{(\tau)}-\boldsymbol{w}^* & = &(\boldsymbol I-\epsilon \boldsymbol H)(\boldsymbol{w}^{(\tau-1)}-\boldsymbol{w}^*). \tag{7.37}
\end{eqnarray}
</script></span></p><blockquote>
<p>[3]: Đối với các mạng neuron, để khử tính đối xứng giữa các đơn vị ẩn, ta không thể khởi tạo tất cả các tham số về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mn MJXp-bold" id="MJXp-Span-153">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-187"><span class="mn" id="MathJax-Span-188" style="font-family: MathJax_Main-bold;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\boldsymbol 0</script></span>, như đã nói trong phần 6.2. Tuy nhiên, lập luận ở đây vẫn đúng với bất kì giá trị khởi tạo nào của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-msubsup" id="MJXp-Span-155"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-156" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-157" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-158">(</span><span class="MJXp-mn" id="MJXp-Span-159">0</span><span class="MJXp-mo" id="MJXp-Span-160">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-189"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-190"><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="mo" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\boldsymbol{w}^{(0)}</script></span>.</p>
</blockquote><p>Bây giờ, ta sẽ viết lại biểu thức này trong không gian của các vector riêng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">H</script></span>, khai thác phép phân tích riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-164">H</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-166">H</span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-168">Q</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-169">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-170"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-171" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-172" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">Q</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Main-bold;">Λ</span><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.865em;"><span class="mi" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\boldsymbol H:\boldsymbol H = \boldsymbol Q\boldsymbol\Lambda \boldsymbol Q^\top</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-174">Λ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Main-bold;">Λ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\boldsymbol \Lambda</script></span> là ma trận đường chéo và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-176">Q</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-215"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-bold-italic;">Q</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\boldsymbol Q</script></span> là hệ cơ sở trực giao của các vector riêng.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-177"><span class="MJXp-mtable" id="MJXp-Span-178"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-179" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-180" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-181"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-182" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-183" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-184">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">τ</span><span class="MJXp-mo" id="MJXp-Span-186">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-188"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-189" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-190" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mtd" id="MJXp-Span-191" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-192"></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-194" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">I</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-199">Q</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-200">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-202" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-203" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-206"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-207" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-208" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-209">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">τ</span><span class="MJXp-mo" id="MJXp-Span-211">−</span><span class="MJXp-mn" id="MJXp-Span-212">1</span><span class="MJXp-mo" id="MJXp-Span-213">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-216" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-217" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-219" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-220" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-221"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-222" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-223" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-225"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-226" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-227" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-228">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">τ</span><span class="MJXp-mo" id="MJXp-Span-230">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-232"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-233" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-234" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-236" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-237"></span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-239" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">I</span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">ϵ</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-244">Λ</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-246"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-247" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-248" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-251" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-252" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-253">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">τ</span><span class="MJXp-mo" id="MJXp-Span-255">−</span><span class="MJXp-mn" id="MJXp-Span-256">1</span><span class="MJXp-mo" id="MJXp-Span-257">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-260" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-261" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-219"><span class="mtable" id="MathJax-Span-220" style="min-width: 26.673em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.673em;"><span style="display: inline-block; position: absolute; width: 19.938em; height: 0px; clip: rect(-1.775em, 1019.83em, 1.242em, -999.997em); top: 0em; left: 50%; margin-left: -9.965em;"><span style="position: absolute; clip: rect(2.212em, 1006.47em, 5.229em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.576em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1004.31em, 4.259em, -999.997em); top: -4.631em; right: 0em;"><span class="mtd" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-234" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1006.47em, 4.421em, -999.997em); top: -3.122em; right: 0em;"><span class="mtd" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="msubsup" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mo" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-285" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.804em, 1000.97em, 5.013em, -999.997em); top: -3.984em; left: 6.576em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -4.631em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-237"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239"></span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -3.122em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mi" id="MathJax-Span-291"></span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.212em, 1011.96em, 5.229em, -999.997em); top: -3.984em; left: 7.923em;"><span style="display: inline-block; position: relative; width: 12.072em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1011.96em, 4.421em, -999.997em); top: -4.631em; left: 0em;"><span class="mtd" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-bold-italic;">Q</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Main-bold;">Λ</span><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mo" id="MathJax-Span-258" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-260" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-264" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1011.1em, 4.421em, -999.997em); top: -3.122em; left: 0em;"><span class="mtd" id="MathJax-Span-293"><span class="mrow" id="MathJax-Span-294"><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Main-bold;">Λ</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-301"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-305"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mo" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-315" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.56em, 1002.48em, 1.242em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.631em; right: 0em;"><span class="mtd" id="mjx-eqn-7.38"><span class="mrow" id="MathJax-Span-222"><span class="mtext" id="MathJax-Span-223" style="font-family: MathJax_Main;">(7.38)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.122em; right: 0em;"><span class="mtd" id="mjx-eqn-7.39"><span class="mrow" id="MathJax-Span-269"><span class="mtext" id="MathJax-Span-270" style="font-family: MathJax_Main;">(7.39)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">
\begin{eqnarray}
\boldsymbol{w}^{(\tau)}-\boldsymbol{w}^* & = & (I-\epsilon \boldsymbol Q \boldsymbol\Lambda \boldsymbol Q^\top)(\boldsymbol{w}^{(\tau-1)}-\boldsymbol{w}^*) \tag{7.38}\\
\boldsymbol Q^\top(\boldsymbol{w}^{(\tau)}-\boldsymbol{w}^*) & = & (I-\epsilon\boldsymbol\Lambda) \boldsymbol Q^\top(\boldsymbol{w}^{(\tau-1)}-\boldsymbol{w}^*) \tag{7.39}
\end{eqnarray}
</script></span></p><p>Giả sử rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-263"><span class="MJXp-msubsup" id="MJXp-Span-264"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-265" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-266" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-267">(</span><span class="MJXp-mn" id="MJXp-Span-268">0</span><span class="MJXp-mo" id="MJXp-Span-269">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-271">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-320"><span class="msubsup" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="mo" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol{w}^{(0)} = 0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-331"><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\epsilon</script></span> được chọn đủ nhỏ để đảm bảo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn" id="MJXp-Span-277">1</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-282" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-286">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-334"><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">|</span></span></span><span class="mn" id="MathJax-Span-338" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="msubsup" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.272em;">&lt;</span><span class="mn" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">| 1− \epsilon\lambda_i| < 1</script></span>, quỹ đạo của tham số trong quá trình huấn luyện sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\tau</script></span> lần cập nhật tham số như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-289"><span class="MJXp-mtable" id="MJXp-Span-290"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-291" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-292" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-295" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-296"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-297" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-298" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-299">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">τ</span><span class="MJXp-mo" id="MJXp-Span-301">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-304">I</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-307">I</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">ϵ</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-310">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-313" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-314">τ</span></span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-319" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-320"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-321" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-322" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-353"><span class="mtable" id="MathJax-Span-354" style="min-width: 21.07em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.07em;"><span style="display: inline-block; position: absolute; width: 14.335em; height: 0px; clip: rect(-1.021em, 1014.28em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -7.163em;"><span style="position: absolute; clip: rect(2.966em, 1014.28em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.335em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1014.28em, 4.421em, -999.997em); top: -3.877em; left: 50%; margin-left: -7.163em;"><span class="mtd" id="MathJax-Span-358"><span class="mrow" id="MathJax-Span-359"><span class="msubsup" id="MathJax-Span-360"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mo" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.272em;">[</span><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.218em;">(</span><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Main-bold;">Λ</span><span class="msubsup" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-381"><span class="mrow" id="MathJax-Span-382"><span class="mo" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">]</span><span class="mtext" id="MathJax-Span-385" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-386"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-388" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-389"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.805em, 1002.48em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-7.40"><span class="mrow" id="MathJax-Span-356"><span class="mtext" id="MathJax-Span-357" style="font-family: MathJax_Main;">(7.40)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">Q^\top \boldsymbol{w}^{(\tau)}= [\boldsymbol I − (\boldsymbol I − \epsilon \boldsymbol \Lambda)^τ]\ \boldsymbol Q^\top \boldsymbol w^∗.			 \tag{7.40}</script></span></p><p>Bây giờ, áp dụng phương trình (7.13) cho kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-327" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-394"><span class="msubsup" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-397" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">L^2</script></span> để viết lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-msubsup" id="MJXp-Span-329"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-330" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-331" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-munderover" id="MJXp-Span-333"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-334">w</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-398"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-399"><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.865em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-403"><span class="mrow" id="MathJax-Span-404"><span class="munderover" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.362em; left: 0.272em;"><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\boldsymbol Q^\top \tilde{\boldsymbol{w}}</script></span> thành:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-336"><span class="MJXp-mtable" id="MJXp-Span-337"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-338" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-339" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-340"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-341" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-342" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-munderover" id="MJXp-Span-344"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-345">w</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-347" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-348"></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-350" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-352">Λ</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-355">I</span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-358" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-359">−</span><span class="MJXp-mn" id="MJXp-Span-360">1</span></span></span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-361">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-362"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-363" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-364" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-365"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-366" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-367" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-369" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-370" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-371"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-372" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-373" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-munderover" id="MJXp-Span-375"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-376">w</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-378" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-379"></span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-381" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-383">I</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-386">Λ</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-389">I</span><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-392" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-393">−</span><span class="MJXp-mn" id="MJXp-Span-394">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">α</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-msubsup" id="MJXp-Span-397"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-398" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-399" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-400"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-401" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-402" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-409"><span class="mtable" id="MathJax-Span-410" style="min-width: 21.393em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.393em;"><span style="display: inline-block; position: absolute; width: 14.658em; height: 0px; clip: rect(-1.668em, 1014.6em, 1.188em, -999.997em); top: 0em; left: 50%; margin-left: -7.325em;"><span style="position: absolute; clip: rect(2.32em, 1002.32em, 5.121em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1002.32em, 4.367em, -999.997em); top: -4.631em; right: 0em;"><span class="mtd" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"><span class="msubsup" id="MathJax-Span-416"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="munderover" id="MathJax-Span-421"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.362em; left: 0.272em;"><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.966em, 1002.32em, 4.367em, -999.997em); top: -3.176em; right: 0em;"><span class="mtd" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="msubsup" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="munderover" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.362em; left: 0.272em;"><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.804em, 1000.97em, 4.96em, -999.997em); top: -3.984em; left: 2.32em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -4.631em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426"></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.97em, 4.151em, -999.997em); top: -3.176em; left: 50%; margin-left: -0.536em;"><span class="mtd" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464"></span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.32em, 1010.94em, 5.175em, -999.997em); top: -3.984em; left: 3.666em;"><span style="display: inline-block; position: relative; width: 10.994em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1008.78em, 4.421em, -999.997em); top: -4.631em; left: 0em;"><span class="mtd" id="MathJax-Span-428"><span class="mrow" id="MathJax-Span-429"><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Main-bold;">Λ</span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">α</span><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-437"><span class="mrow" id="MathJax-Span-438"><span class="mo" id="MathJax-Span-439" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Main-bold;">Λ</span><span class="msubsup" id="MathJax-Span-442"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.966em, 1010.94em, 4.421em, -999.997em); top: -3.176em; left: 0em;"><span class="mtd" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main; padding-left: 0.218em;">(</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Main-bold;">Λ</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">α</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-476"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-478"><span class="mrow" id="MathJax-Span-479"><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-bold-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-487"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.811em;"><span class="mo" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.56em, 1002.48em, 1.188em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.631em; right: 0em;"><span class="mtd" id="mjx-eqn-7.41"><span class="mrow" id="MathJax-Span-412"><span class="mtext" id="MathJax-Span-413" style="font-family: MathJax_Main;">(7.41)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.176em; right: 0em;"><span class="mtd" id="mjx-eqn-7.42"><span class="mrow" id="MathJax-Span-450"><span class="mtext" id="MathJax-Span-451" style="font-family: MathJax_Main;">(7.42)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{eqnarray}
\boldsymbol Q^\top \tilde{\boldsymbol{w}} & = & (\boldsymbol \Lambda+\alpha \boldsymbol I)^{-1}\boldsymbol\Lambda \boldsymbol Q^\top \boldsymbol{w}^*,\tag{7.41} \\
\boldsymbol Q^\top \tilde{\boldsymbol{w}} & = & [\boldsymbol I-(\boldsymbol \Lambda+\alpha \boldsymbol I)^{-1}\alpha]\boldsymbol Q^\top \boldsymbol{w}^*.\tag{7.42}
\end{eqnarray}</script></span></p><p>So sánh phương trình 7.40 và phương trình 7.42, chúng ta thấy rằng nếu chọn các siêu tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-491"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\epsilon</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">α</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">α</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\alpha</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\tau</script></span> sao cho:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-410"><span class="MJXp-mtable" id="MJXp-Span-411"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-412" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-413" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-415">I</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">ϵ</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-418">Λ</span><span class="MJXp-msubsup" id="MJXp-Span-419"><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-421" style="vertical-align: 0.5em;">τ</span></span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold" id="MJXp-Span-424">Λ</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-427">I</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-430" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-431">−</span><span class="MJXp-mn" id="MJXp-Span-432">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">α</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-500"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-501"><span class="mtable" id="MathJax-Span-502" style="min-width: 18.16em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.16em;"><span style="display: inline-block; position: absolute; width: 11.425em; height: 0px; clip: rect(-0.967em, 1011.37em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -5.709em;"><span style="position: absolute; clip: rect(3.02em, 1011.37em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.425em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1011.37em, 4.421em, -999.997em); top: -3.93em; left: 50%; margin-left: -5.709em;"><span class="mtd" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Main-bold;">Λ</span><span class="msubsup" id="MathJax-Span-513"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-514" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Main-bold;">Λ</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">α</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-bold-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-524"><span class="mrow" id="MathJax-Span-525"><span class="mo" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.859em, 1002.48em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-7.43"><span class="mrow" id="MathJax-Span-504"><span class="mtext" id="MathJax-Span-505" style="font-family: MathJax_Main;">(7.43)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">(\boldsymbol I − \epsilon\boldsymbol \Lambda)^\tau = (\boldsymbol \Lambda + \alpha \boldsymbol I)^{-1}\alpha,\tag{7.43}</script></span></p><p>thì kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-435"><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-438" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-531"><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-534" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">L^2</script></span> và kết thúc sớm được xem là tương đương (hoặc ít nhất là tương đương đối với xấp xỉ bậc hai của hàm mục tiêu). Phân tích sâu hơn, bằng cách lấy logarit và sử dụng khai triển chuỗi cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi" id="MJXp-Span-440">log</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-443">1</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">x</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-538"></span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-540" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">x</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\log (1 + x)</script></span>, ta có thể kết luận rằng nếu toàn bộ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-545"><span class="msubsup" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\lambda_i</script></span> là nhỏ (nghĩa là, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-455" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0.333em; margin-right: 0.333em;">≪</span><span class="MJXp-mn" id="MJXp-Span-457">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">ϵ</span><span class="msubsup" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main; padding-left: 0.272em;">≪</span><span class="mn" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\epsilon\lambda_i \ll 1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-msubsup" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-461" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">α</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.333em; margin-right: 0.333em;">≪</span><span class="MJXp-mn" id="MJXp-Span-466">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-558"><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.272em;">≪</span><span class="mn" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\lambda_i/\alpha \ll 1</script></span>) thì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-467"><span class="MJXp-mtable" id="MJXp-Span-468"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-469" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-470" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">τ</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mfrac" id="MJXp-Span-473" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-474">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">ϵ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">α</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-569"><span class="mtable" id="MathJax-Span-570" style="min-width: 10.24em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 10.24em;"><span style="display: inline-block; position: absolute; width: 3.505em; height: 0px; clip: rect(-1.452em, 1003.45em, 0.919em, -999.997em); top: 0em; left: 50%; margin-left: -1.775em;"><span style="position: absolute; clip: rect(2.535em, 1003.45em, 4.906em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1003.45em, 4.852em, -999.997em); top: -3.93em; left: 50%; margin-left: -1.775em;"><span class="mtd" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.272em;">≈</span><span class="mfrac" id="MathJax-Span-578" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-579" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1001.03em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.536em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic;">ϵ</span><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.19em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.188em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.859em, 1002.48em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-7.44"><span class="mrow" id="MathJax-Span-572"><span class="mtext" id="MathJax-Span-573" style="font-family: MathJax_Main;">(7.44)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\tau\approx\frac{1}{\epsilon\alpha},\tag{7.44}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-478"><span class="MJXp-mtable" id="MJXp-Span-479"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-480" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-481" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">α</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mfrac" id="MJXp-Span-484" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-485">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">τ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">ϵ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-585"><span class="mtable" id="MathJax-Span-586" style="min-width: 10.24em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 10.24em;"><span style="display: inline-block; position: absolute; width: 3.505em; height: 0px; clip: rect(-1.452em, 1003.45em, 0.919em, -999.997em); top: 0em; left: 50%; margin-left: -1.775em;"><span style="position: absolute; clip: rect(2.535em, 1003.45em, 4.906em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1003.45em, 4.852em, -999.997em); top: -3.93em; left: 50%; margin-left: -1.775em;"><span class="mtd" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.272em;">≈</span><span class="mfrac" id="MathJax-Span-594" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-595" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.92em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.03em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.026em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.859em, 1002.48em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-7.45"><span class="mrow" id="MathJax-Span-588"><span class="mtext" id="MathJax-Span-589" style="font-family: MathJax_Main;">(7.45)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">\alpha\approx\frac{1}{\tau\epsilon}.\tag{7.45}</script></span></p><p>Tức là, theo các giả định này, số lần huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-601"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">\tau</script></span> tỷ lệ nghịch với tham số kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-msubsup" id="MJXp-Span-492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-494" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">L^2</script></span>, và nghịch đảo của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">τ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-608"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">\tau\epsilon</script></span> đóng vai trò là hệ số suy giảm trọng số.</p><p>Các giá trị tham số tương ứng với các hướng có độ cong lớn (của hàm mục tiêu) bị kiểm soát ít hơn so với hướng có độ cong nhỏ hơn. Dĩ nhiên, trong trường hợp kết thúc sớm, các tham số tương ứng với các hướng có độ cong lớn có xu hướng học sớm hơn so với các tham số tương ứng với hướng có độ cong nhỏ.</p><p>Các bước suy luận trong phần này đã chỉ ra rằng một quỹ đạo sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">\tau</script></span> lần cập nhật tham số dừng tại một điểm tương ứng với một cực tiểu của hàm mục tiêu có kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-500"><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-503" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-616"><span class="msubsup" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-619" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">L^2</script></span>. Dĩ nhiên, kết thúc sớm không chỉ đơn thuần là kiểm soát chiều dài của quỹ đạo; thay vào đó, kết thúc sớm thường liên quan đến việc giám sát lỗi trên tập xác thực, để dừng quỹ đạo tại một điểm đặc biệt tốt trong không gian. Do đó, kết thúc sớm có nhiều lợi thế hơn suy giảm trọng số ở chỗ nó sẽ tự động xác định chính xác lượng kiểm soát, trong khi phương pháp suy giảm trọng số cần thử nghiệm huấn luyện nhiều lần với các giá trị khác nhau của siêu tham số.</p><h1 id="79-Trói-buộc-tham-số-và-dùng-chung-tham-số">7.9 Trói buộc tham số và dùng chung tham số</h1><p>Như vậy, cho đến phần này của chương, khi thảo luận về việc áp thêm các ràng buộc hoặc các hàm phạt cho các tham số, ta thực hiện việc đó đối với một vùng hoặc một điểm xác định. Ví dụ, hàm kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-507" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-620"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-621"><span class="msubsup" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">L^2</script></span> (hoặc hàm suy giảm trọng số) sẽ phạt các tham số mô hình dựa trên độ chệch so với giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mn" id="MJXp-Span-509">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-626"><span class="mn" id="MathJax-Span-627" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">0</script></span> được cố định từ đầu. Tuy nhiên, đôi khi ta cần những cách khác để thể hiện tri thức tiên nghiệm về các giá trị phù hợp của các tham số mô hình. Đôi khi ta không biết chính xác giá trị của các tham số, nhưng ta biết rằng, từ những tri thức về miền hiện tại và kiến trúc của mô hình, sẽ luôn tồn tại những mối quan hệ phụ thuộc giữa các tham số mô hình với nhau.</p><p>Một kiểu quan hệ phụ thuộc phổ biến mà ta thường muốn diễn tả là các tham số nhất định phải gần nhau. Xét trường hợp sau: ta có hai mô hình thực hiện cùng một tác vụ phân loại (với cùng một tập nhãn) nhưng với phân phối đầu vào khác nhau một chút. Ta có mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">A</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">A</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">A</script></span> với các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-515" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-516">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">A</span><span class="MJXp-mo" id="MJXp-Span-518">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-632"><span class="msubsup" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="texatom" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mo" id="MathJax-Span-637" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">w^{(A)}</script></span> và mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">B</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-641"><span class="mi" id="MathJax-Span-642" style="font-family: MathJax_Math-italic;">B</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">B</script></span> với các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-524" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-525">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">B</span><span class="MJXp-mo" id="MJXp-Span-527">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-643"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-644"><span class="msubsup" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="texatom" id="MathJax-Span-647"><span class="mrow" id="MathJax-Span-648"><span class="mo" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">w^{(B)}</script></span>. Hai mô hình ánh xạ đầu vào thành hai đầu ra khác nhau nhưng có liên quan với nhau: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-528"><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mrow" id="MJXp-Span-530" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-531"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-534" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-535">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">A</span><span class="MJXp-mo" id="MJXp-Span-537">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">f</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-541"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-542" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-543" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-544">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">A</span><span class="MJXp-mo" id="MJXp-Span-546">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-548">x</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-653"><span class="msubsup" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-655"><span class="mrow" id="MathJax-Span-656"><span class="munderover" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-659" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.469em; left: 0.595em;"><span class="texatom" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="mo" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-670"><span class="mrow" id="MathJax-Span-671"><span class="mo" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">x</span><span class="mo" id="MathJax-Span-677" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">\hat y^{(A)}= f(\boldsymbol{w}^{(A)}, \boldsymbol x)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-msubsup" id="MJXp-Span-551"><span class="MJXp-mrow" id="MJXp-Span-552" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-553"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-556" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-557">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">B</span><span class="MJXp-mo" id="MJXp-Span-559">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">g</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-563"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-564" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-565" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-566">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">B</span></span></span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-569">x</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-679"><span class="msubsup" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="munderover" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.469em; left: 0.595em;"><span class="texatom" id="MathJax-Span-686"><span class="mrow" id="MathJax-Span-687"><span class="mo" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-690" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-696"><span class="mrow" id="MathJax-Span-697"><span class="mo" id="MathJax-Span-698" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-699" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">x</span><span class="mo" id="MathJax-Span-702" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">\hat y^{(B)} = g(\boldsymbol{w}^{(B}, \boldsymbol x)</script></span>.</p><p>Thử tưởng tượng rằng các tác vụ này đủ giống nhau (có thể có cùng phân phối đầu vào và đầu ra), nên ta tin rằng các tham số mô hình phải gần nhau: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi" id="MJXp-Span-572">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">i</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-575"><span class="MJXp-mrow" id="MJXp-Span-576" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">w</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mo" id="MJXp-Span-580">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">A</span><span class="MJXp-mo" id="MJXp-Span-582">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">i</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-703"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Main;">∀</span><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-708" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1001.13em, 4.313em, -999.997em); top: -4.523em; left: 0.703em;"><span class="texatom" id="MathJax-Span-712"><span class="mrow" id="MathJax-Span-713"><span class="mo" id="MathJax-Span-714" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -3.661em; left: 0.703em;"><span class="mi" id="MathJax-Span-717" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">\forall i, {w}^{(A)}_i</script></span> sẽ gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mrow" id="MJXp-Span-585" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">w</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-588"><span class="MJXp-mo" id="MJXp-Span-589">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">B</span><span class="MJXp-mo" id="MJXp-Span-591">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">i</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-718"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-719"><span class="msubsup" id="MathJax-Span-720"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-721"><span class="mrow" id="MathJax-Span-722"><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1001.19em, 4.313em, -999.997em); top: -4.523em; left: 0.703em;"><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mo" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-728" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -3.661em; left: 0.703em;"><span class="mi" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">{w}^{(B)}_i</script></span>. Ta có thể tận dụng thông tin này thông qua một cơ chế kiểm soát. Cụ thể, ta có thể sử dụng hàm phạt chuẩn tham số có dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mrow" id="MJXp-Span-593"><span class="MJXp-mi" id="MJXp-Span-594">Ω</span></span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-596"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-597" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-598" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-599">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">A</span><span class="MJXp-mo" id="MJXp-Span-601">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-603"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-604" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-605" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-606">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">B</span><span class="MJXp-mo" id="MJXp-Span-608">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-611"><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-613"><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-617" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-618">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">A</span><span class="MJXp-mo" id="MJXp-Span-620">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-623" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-624" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-625">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">B</span><span class="MJXp-mo" id="MJXp-Span-627">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-628"><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-630"><span class="MJXp-mrow" id="MJXp-Span-631" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-634">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-633">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-730"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-731"><span class="texatom" id="MathJax-Span-732"><span class="mrow" id="MathJax-Span-733"><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Main;">Ω</span></span></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-736"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-738"><span class="mrow" id="MathJax-Span-739"><span class="mo" id="MathJax-Span-740" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-741" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-742" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-744" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mo" id="MathJax-Span-748" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-749" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-750" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-753" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-754"><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-756"><span class="mrow" id="MathJax-Span-757"><span class="mo" id="MathJax-Span-758" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-759"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mo" id="MathJax-Span-763" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-766" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-767" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.81em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-768" style="font-family: MathJax_Math-bold-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.811em;"><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="mo" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-773" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-777"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.16em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -4.469em; left: 0.272em;"><span class="mn" id="MathJax-Span-781" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.715em; left: 0.272em;"><span class="mn" id="MathJax-Span-782" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">{\Omega} (\boldsymbol{w}^{(A)},\boldsymbol{w}^{(B)}) =||\boldsymbol{w}^{(A)}-\boldsymbol{w}^{(B)}||^2_2</script></span>. Ở đây, chúng tôi sử dụng một hàm phạt chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-638" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-783"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-784"><span class="msubsup" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-787" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">L^2</script></span>, nhưng bạn đọc hoàn toàn có thể lựa chọn các hàm phạt với các chuẩn khác.</p><p>Cách tiếp cận kiểu này được đề xuất bởi Lasserre và cộng sự (2006), họ đã kiểm soát các tham số của một mô hình được huấn luyện để làm một bộ phân loại trong một mô hình có giám sát, sao cho giá trị của các tham số mô hình này gần với các tham số của một mô hình khác được huấn luyện theo cách không giám sát (để nắm bắt phân phối của dữ liệu đầu vào). Các kiến trúc được xây dựng sao cho tất cả các tham số trong mô hình phân loại (có giám sát) có thể được ghép cặp với các tham số tương ứng trong mô hình không giám sát.</p><p>Trong khi sử dụng một hàm phạt chuẩn tham số là một cách để kiểm soát các tham số mô hình sao cho chúng gần nhau, còn một cách khác thông dụng hơn là sử dụng các ràng buộc: <em>để ép các tập thông số phải bằng nhau</em>. Phương pháp kiểm soát này thường được nhắc đến với cái tên gọi là <em>dùng chung tham số</em> (parameter sharing), bởi vì ta diễn giải các mô hình hoặc thành phần của mô hình là dùng chung một tập tham số duy nhất. Một lợi ích rõ ràng của phương pháp dùng chung tham số so với việc kiểm soát sao cho các tham số gần nhau (thông qua sử dụng một hàm phạt chuẩn) đó là chỉ có một tập con của các tham số duy nhất (unique) cần được lưu trữ trong bộ nhớ. Trong một số mô hình nhất định — chẳng hạn như mạng neuron tích chập — lợi ích này có thể giúp giảm đáng kể lượng bộ nhớ cần dùng để lưu trữ mô hình.</p><h2 id="791-Mạng-neuron-tích-chập">7.9.1 Mạng neuron tích chập</h2><p>Cho đến nay, phương pháp dùng chung tham số đã được sử dụng phổ biến và rộng rãi nhất trong các <em>mạng neuron tích chập</em> (convolutional Neural networks - CNNs) được ứng dụng trong lĩnh vực thị giác máy tính.</p><p>Hình ảnh tự nhiên có nhiều thuộc tính thống kê bất biến khi thực hiện dịch ảnh. Ví dụ, một bức ảnh con mèo vẫn là ảnh con mèo nếu ta dịch bức ảnh qua phải một điểm ảnh. Các mạng neuron tích chập ghi nhớ thuộc tính này bằng cách dùng chung các tham số trên nhiều vị trí khác nhau của ảnh. Cùng một đặc trưng (một đơn vị ẩn có cùng trọng số) được tính toán trên các vị trí khác nhau trên ảnh đầu vào. Điều này có nghĩa rằng chúng ta có thể tìm một con mèo chỉ cần duy nhất một mô hình nhận diện mèo dù cho con mèo xuất hiện ở cột <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">i</script></span> hay cột <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">i</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-644">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-791"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-792"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-795" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">i + 1</script></span> trong bức ảnh.</p><p>Dùng chung tham số đã cho phép mạng neuron tích chập giảm đáng kể số lượng các tham số duy nhất (unique) của mô hình và tăng đáng kể kích thước mạng mà không cần tăng lượng dữ liệu huấn luyện. Đây vẫn là một trong những ví dụ tốt nhất về cách tích hợp hiệu quả những tri thức chuyên sâu trên một miền nhất định vào việc thiết kế kiến trúc mạng.</p><p>Các mạng neuron tích chập sẽ được thảo luận chi tiết hơn trong chương 9.</p><h1 id="710-Biểu-diễn-thưa">7.10 Biểu diễn thưa</h1><p>Suy giảm trọng số hoạt động bằng cách áp dụng một hàm phạt trực tiếp lên các tham số mô hình. Một cách khác là áp dụng một hàm phạt lên giá trị hàm kích hoạt của các đơn vị trong mạng neuron, có xu hướng khiến các giá trị này trở nên thưa. Điều này gián tiếp áp đặt một hàm phạt phức tạp lên các tham số của mô hình.</p><p>Ta đã thảo luận (trong phần 7.1.2) cách hàm phạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-msubsup" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-648" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-796"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-797"><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.703em;"><span class="mn" id="MathJax-Span-800" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">L^1</script></span> tạo ra các tham số thưa - nghĩa là nhiều tham số có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mn" id="MJXp-Span-650">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-801"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-802"><span class="mn" id="MathJax-Span-803" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">0</script></span> (hoặc gần bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mn" id="MJXp-Span-652">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-804"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-805"><span class="mn" id="MathJax-Span-806" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">0</script></span>). Mặt khác, độ thưa về mặt biểu diễn mô tả một biểu diễn mà trong đó nhiều phần tử của biểu diễn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mn" id="MJXp-Span-654">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-808"><span class="mn" id="MathJax-Span-809" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">0</script></span> (hoặc gần bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-mn" id="MJXp-Span-656">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-810"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-811"><span class="mn" id="MathJax-Span-812" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">0</script></span>). Một cái nhìn đơn giản về sự khác biệt này có thể được minh họa trong bài toán hồi quy tuyến tính:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-657"><span class="MJXp-mtable" id="MJXp-Span-658"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-659" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-660" style="text-align: center;"><span class="MJXp-munder" id="MJXp-Span-661"><span><span class="MJXp-mrow" id="MJXp-Span-662"><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-664"><span><span class="MJXp-mtr" id="MJXp-Span-665" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-666" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-667">18</span></span></span><span class="MJXp-mtr" id="MJXp-Span-668" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-669" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-670">5</span></span></span><span class="MJXp-mtr" id="MJXp-Span-671" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-672" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-673">15</span></span></span><span class="MJXp-mtr" id="MJXp-Span-674" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-675" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-677">9</span></span></span><span class="MJXp-mtr" id="MJXp-Span-678" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-679" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-681">3</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-683" style="margin-left: 0px;">y</span><span class="MJXp-mo" id="MJXp-Span-684">∈</span><span class="MJXp-msubsup" id="MJXp-Span-685"><span class="MJXp-mrow" id="MJXp-Span-686" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-687">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-688" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munder" id="MJXp-Span-690"><span><span class="MJXp-mrow" id="MJXp-Span-691"><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-693"><span><span class="MJXp-mtr" id="MJXp-Span-694" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-695" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-696">4</span></span><span class="MJXp-mtd" id="MJXp-Span-697" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-698">0</span></span><span class="MJXp-mtd" id="MJXp-Span-699" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-700">0</span></span><span class="MJXp-mtd" id="MJXp-Span-701" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-703">2</span></span><span class="MJXp-mtd" id="MJXp-Span-704" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-705">0</span></span><span class="MJXp-mtd" id="MJXp-Span-706" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-707">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-708" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-709" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-710">0</span></span><span class="MJXp-mtd" id="MJXp-Span-711" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-712">0</span></span><span class="MJXp-mtd" id="MJXp-Span-713" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-715">1</span></span><span class="MJXp-mtd" id="MJXp-Span-716" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-717">0</span></span><span class="MJXp-mtd" id="MJXp-Span-718" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-719">3</span></span><span class="MJXp-mtd" id="MJXp-Span-720" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-721">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-722" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-723" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-724">0</span></span><span class="MJXp-mtd" id="MJXp-Span-725" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-726">5</span></span><span class="MJXp-mtd" id="MJXp-Span-727" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-728">0</span></span><span class="MJXp-mtd" id="MJXp-Span-729" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-730">0</span></span><span class="MJXp-mtd" id="MJXp-Span-731" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-732">0</span></span><span class="MJXp-mtd" id="MJXp-Span-733" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-734">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-735" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-736" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-737">1</span></span><span class="MJXp-mtd" id="MJXp-Span-738" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-739">0</span></span><span class="MJXp-mtd" id="MJXp-Span-740" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-741">0</span></span><span class="MJXp-mtd" id="MJXp-Span-742" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-744">1</span></span><span class="MJXp-mtd" id="MJXp-Span-745" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-746">0</span></span><span class="MJXp-mtd" id="MJXp-Span-747" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-749">4</span></span></span><span class="MJXp-mtr" id="MJXp-Span-750" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-751" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-752">1</span></span><span class="MJXp-mtd" id="MJXp-Span-753" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-754">0</span></span><span class="MJXp-mtd" id="MJXp-Span-755" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-756">0</span></span><span class="MJXp-mtd" id="MJXp-Span-757" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-758">0</span></span><span class="MJXp-mtd" id="MJXp-Span-759" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-761">5</span></span><span class="MJXp-mtd" id="MJXp-Span-762" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-763">0</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-765" style="margin-left: 0px;">A</span><span class="MJXp-mo" id="MJXp-Span-766">∈</span><span class="MJXp-msubsup" id="MJXp-Span-767"><span class="MJXp-mrow" id="MJXp-Span-768" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-769">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-770" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">m</span><span class="MJXp-mo" id="MJXp-Span-772">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">n</span></span></span></span></span><span class="MJXp-munder" id="MJXp-Span-774"><span><span class="MJXp-mrow" id="MJXp-Span-775"><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.306em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.222em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-777"><span><span class="MJXp-mtr" id="MJXp-Span-778" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-779" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-780">2</span></span></span><span class="MJXp-mtr" id="MJXp-Span-781" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-782" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-783">3</span></span></span><span class="MJXp-mtr" id="MJXp-Span-784" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-785" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-787">2</span></span></span><span class="MJXp-mtr" id="MJXp-Span-788" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-789" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-791">5</span></span></span><span class="MJXp-mtr" id="MJXp-Span-792" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-793" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-794">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-795" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-796" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-797">4</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.306em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.222em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-799" style="margin-left: 0px;">x</span><span class="MJXp-mo" id="MJXp-Span-800">∈</span><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mrow" id="MJXp-Span-802" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-803">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-804" style="vertical-align: 0.5em;">n</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style=""></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">\underset{\boldsymbol{y} \in \mathbb{R}^m}{\begin{bmatrix}
18 \\
5 \\
15 \\
-9 \\
-3 \\
\end{bmatrix}} = \underset{\boldsymbol{A} \in \mathbb{R}^{m \times n}}{\begin{bmatrix}
4 & 0 & 0 & -2 & 0 & 0 \\
0 & 0 & -1 & 0 & 3 & 0 \\
0 & 5 & 0 & 0 & 0 & 0 \\
1 & 0 & 0 & -1 & 0 & -4 \\
1 & 0 & 0 & 0 & -5 & 0 \\
\end{bmatrix}} \underset{\boldsymbol{x} \in \mathbb{R}^n}{\begin{bmatrix}
2 \\
3 \\
-2 \\
-5 \\
1 \\
4 \\
\end{bmatrix}} \tag{7.46}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-805"><span class="MJXp-mtable" id="MJXp-Span-806"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-807" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-808" style="text-align: center;"><span class="MJXp-munder" id="MJXp-Span-809"><span><span class="MJXp-mrow" id="MJXp-Span-810"><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-812"><span><span class="MJXp-mtr" id="MJXp-Span-813" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-814" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-816">14</span></span></span><span class="MJXp-mtr" id="MJXp-Span-817" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-818" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-819">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-820" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-821" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-822">19</span></span></span><span class="MJXp-mtr" id="MJXp-Span-823" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-824" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-825">2</span></span></span><span class="MJXp-mtr" id="MJXp-Span-826" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-827" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-828">23</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-830" style="margin-left: 0px;">y</span><span class="MJXp-mo" id="MJXp-Span-831">∈</span><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mrow" id="MJXp-Span-833" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-834">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-835" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munder" id="MJXp-Span-837"><span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-840"><span><span class="MJXp-mtr" id="MJXp-Span-841" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-842" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-843">3</span></span><span class="MJXp-mtd" id="MJXp-Span-844" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-846">1</span></span><span class="MJXp-mtd" id="MJXp-Span-847" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-848">2</span></span><span class="MJXp-mtd" id="MJXp-Span-849" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-851">5</span></span><span class="MJXp-mtd" id="MJXp-Span-852" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-853">4</span></span><span class="MJXp-mtd" id="MJXp-Span-854" style="padding-left: 1em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-855">1</span></span></span><span class="MJXp-mtr" id="MJXp-Span-856" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-857" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-858">4</span></span><span class="MJXp-mtd" id="MJXp-Span-859" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-860">2</span></span><span class="MJXp-mtd" id="MJXp-Span-861" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-863">3</span></span><span class="MJXp-mtd" id="MJXp-Span-864" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-866">1</span></span><span class="MJXp-mtd" id="MJXp-Span-867" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-868">1</span></span><span class="MJXp-mtd" id="MJXp-Span-869" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-870">3</span></span></span><span class="MJXp-mtr" id="MJXp-Span-871" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-872" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-874">1</span></span><span class="MJXp-mtd" id="MJXp-Span-875" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-876">5</span></span><span class="MJXp-mtd" id="MJXp-Span-877" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-878">4</span></span><span class="MJXp-mtd" id="MJXp-Span-879" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-880">2</span></span><span class="MJXp-mtd" id="MJXp-Span-881" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-883">3</span></span><span class="MJXp-mtd" id="MJXp-Span-884" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-886">2</span></span></span><span class="MJXp-mtr" id="MJXp-Span-887" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-888" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-889">3</span></span><span class="MJXp-mtd" id="MJXp-Span-890" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-891">1</span></span><span class="MJXp-mtd" id="MJXp-Span-892" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-893">2</span></span><span class="MJXp-mtd" id="MJXp-Span-894" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-896">3</span></span><span class="MJXp-mtd" id="MJXp-Span-897" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-898">0</span></span><span class="MJXp-mtd" id="MJXp-Span-899" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-901">3</span></span></span><span class="MJXp-mtr" id="MJXp-Span-902" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-903" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-905">5</span></span><span class="MJXp-mtd" id="MJXp-Span-906" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-907">4</span></span><span class="MJXp-mtd" id="MJXp-Span-908" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-910">2</span></span><span class="MJXp-mtd" id="MJXp-Span-911" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-912">2</span></span><span class="MJXp-mtd" id="MJXp-Span-913" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-915">5</span></span><span class="MJXp-mtd" id="MJXp-Span-916" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-918">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.444em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-920" style="margin-left: 0px;">B</span><span class="MJXp-mo" id="MJXp-Span-921">∈</span><span class="MJXp-msubsup" id="MJXp-Span-922"><span class="MJXp-mrow" id="MJXp-Span-923" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-924">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-925" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">m</span><span class="MJXp-mo" id="MJXp-Span-927">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">n</span></span></span></span></span><span class="MJXp-munder" id="MJXp-Span-929"><span><span class="MJXp-mrow" id="MJXp-Span-930"><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.306em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.222em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-932"><span><span class="MJXp-mtr" id="MJXp-Span-933" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-934" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-935">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-936" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-937" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-938">2</span></span></span><span class="MJXp-mtr" id="MJXp-Span-939" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-940" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-941">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-942" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-943" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-944">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-945" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-946" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-948">3</span></span></span><span class="MJXp-mtr" id="MJXp-Span-949" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-950" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-951">0</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.306em;"><span class="MJXp-right MJXp-scale2" style="font-size: 10.222em; margin-left: -0.25em;">]</span></span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-953" style="margin-left: 0px;">h</span><span class="MJXp-mo" id="MJXp-Span-954">∈</span><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mrow" id="MJXp-Span-956" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-957">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-958" style="vertical-align: 0.5em;">n</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-57">\underset{\boldsymbol{y} \in \mathbb{R}^m}{\begin{bmatrix}
-14 \\
1 \\
19 \\
2 \\
23 \\
\end{bmatrix}} = \underset{\boldsymbol{B} \in \mathbb{R}^{m \times n}}{\begin{bmatrix}
3 & -1 & 2 & -5 & 4 & 1 \\
4 & 2 & -3 & -1 & 1 & 3 \\
-1 & 5 & 4 & 2 & -3 & -2 \\
3 & 1 & 2 & -3 & 0 & -3 \\
-5 & 4 & -2 & 2 & -5 & -1 \\
\end{bmatrix}} \underset{\boldsymbol{h} \in \mathbb{R}^n}{\begin{bmatrix}
0 \\
2 \\
0 \\
0 \\
-3 \\
0 \\
\end{bmatrix}} \tag{7.47}</script></span></p><p>Trong biểu thức đầu tiên, ta có một ví dụ về mô hình hồi quy tuyến tính với các tham số thưa. Trong biểu thức thứ hai, chúng tôi biểu diễn hồi quy tuyến tính với biểu diễn thưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-959"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-960">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">\boldsymbol h</script></span> của dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-961"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-962">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">\boldsymbol x</script></span>. Trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-964">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">\boldsymbol h</script></span> là một hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-965"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-966">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\boldsymbol x</script></span>, theo nghĩa là, biểu diễn thông tin chứa trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-967"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-968">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">\boldsymbol x</script></span> bằng một vector thưa.</p><p>Cơ chế kiểm soát đối với biểu diễn được thực hiện bởi cùng một kiểu cơ chế mà chúng ta đã sử dụng trong kiểm soát tham số.</p><p>Cơ chế kiểm soát bằng phạt chuẩn của các biểu diễn được thực hiện bằng cách thêm vào hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">J</script></span> một đại lượng phạt chuẩn đối với <em>biểu diễn</em>. Đại lượng phạt này được ký hiệu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-972">Ω</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">h</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">\boldsymbol{\Omega}(h)</script></span>. Giống như phía trên, chúng tôi ký hiệu hàm mất mát có kiểm soát bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mrow" id="MJXp-Span-977"><span class="MJXp-munderover" id="MJXp-Span-978"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">J</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">\tilde J</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-981"><span class="MJXp-mtable" id="MJXp-Span-982"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-983" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-984" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-munderover" id="MJXp-Span-986"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">J</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-990">θ</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-992">X</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-994">y</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">J</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-999">θ</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1001">X</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1003">y</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">α</span><span class="MJXp-mi" id="MJXp-Span-1007">Ω</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1009">h</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">\tilde J(\boldsymbol\theta; \boldsymbol X,\boldsymbol y) = J(\boldsymbol\theta;\boldsymbol X, \boldsymbol y) + \alpha\Omega(\boldsymbol h),\tag{7.48}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">α</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1016">0</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1018">∞</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">\alpha ∈ [0, \infty)</script></span> là trọng số đóng góp tương đối của đại lượng phạt chuẩn, với các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">\alpha</script></span> lớn hơn tương ứng với nhiều sự kiểm soát hơn.</p><p>Cũng giống như việc áp dụng phạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1025" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">L^1</script></span> gây ra tính thưa của tham số, phạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1026"><span class="MJXp-msubsup" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1029" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">L^1</script></span> lên các phần tử của biểu diễn tạo ra biểu diễn thưa: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1030"><span class="MJXp-mi" id="MJXp-Span-1031">Ω</span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1033">h</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1036"><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1038"><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1040">h</span><span class="MJXp-mrow" id="MJXp-Span-1041"><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mrow" id="MJXp-Span-1044" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1046" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1048"><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1050" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-1051"><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1055" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-1056"><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">\Omega(\boldsymbol h) = ||\boldsymbol h||_1 = \sum_i |h_i |</script></span>. Tất nhiên, phạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1058"><span class="MJXp-msubsup" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1061" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">L^1</script></span> chỉ là một trong những lựa chọn có thể tạo ra một biểu diễn thưa. Những kiểu phạt khác bao gồm phạt thu được bằng cách áp một phân phối tiên nghiệm Student <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">t</script></span> lên biểu diễn [Olshausen and Field, 1996; Bergstra, 2011] và hàm phạt phân kỳ Kullback–Leibler [Larochelle and Bengio, 2008] đặc biệt hữu ích khi biểu diễn với các phần tử bị ràng buộc sao cho phải nằm trên một khoảng đơn vị. Lee và cộng sự (2008) &amp; Goodfellow và cộng sự (2009) đều đưa ra các ví dụ về các chiến lược dựa trên kiểm soát giá trị hàm kích hoạt trung bình thông qua một vài mẫu huấn luyện, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mfrac" id="MJXp-Span-1065" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1066">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1068"><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1070" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1072" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1073" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1074">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">i</span><span class="MJXp-mo" id="MJXp-Span-1076">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">\frac{1}{m}\sum_i \boldsymbol h^{(i)}</script></span>, để buộc nó gần một số giá trị mục tiêu, chẳng hạn như một vector với mỗi phần tử có giá trị bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mn" id="MJXp-Span-1078">.01</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">.01</script></span>.</p><p>Một hướng tiếp cận khác để thu được biểu diễn thưa sử dụng một ràng buộc cứng trên các giá trị kích hoạt. Ví dụ, thuật toán <em>theo đuổi kết hợp trực giao</em> (orthogonal matching pursuit - OMP) [Pati et al.,1993] mã hóa đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1080">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">\boldsymbol x</script></span> bằng biểu diễn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1082">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">\boldsymbol h</script></span> để giải quyết bài toán tối ưu có ràng buộc</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1091"><span class="MJXp-mtable" id="MJXp-Span-1092"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1093" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1094" style="text-align: center;"><span class="MJXp-munder" id="MJXp-Span-1095"><span><span class="MJXp-mi" id="MJXp-Span-1096">arg</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1099" style="margin-left: 0px;">h</span><span class="MJXp-mo" id="MJXp-Span-1100">,</span><span class="MJXp-mrow" id="MJXp-Span-1101"><span class="MJXp-mo" id="MJXp-Span-1102">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1103"><span class="MJXp-mo" id="MJXp-Span-1104">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1105">h</span><span class="MJXp-mrow" id="MJXp-Span-1106"><span class="MJXp-mo" id="MJXp-Span-1107">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1108"><span class="MJXp-mrow" id="MJXp-Span-1109" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1110">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1112">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1114"><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1118">x</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1120">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1121">h</span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1124"><span class="MJXp-mrow" id="MJXp-Span-1125" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1127" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-78">\underset{\boldsymbol h,||\boldsymbol h||_0 < k}{\arg\min}||\boldsymbol x − \boldsymbol W \boldsymbol h||^2, \tag{7.49}</script></span></p><p>Trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-mrow" id="MJXp-Span-1130"><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1134">h</span><span class="MJXp-mrow" id="MJXp-Span-1135"><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mrow" id="MJXp-Span-1138" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1140" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">||\boldsymbol h||_0</script></span> là số phần tử khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1141"><span class="MJXp-mn" id="MJXp-Span-1142">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">0</script></span> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1144">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">\boldsymbol h</script></span>. Bài toán này có thể được giải quyết hiệu quả khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1146">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">\boldsymbol W</script></span> bị ràng buộc là trực giao. Phương pháp này thường được gọi là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1147"><span class="MJXp-mtext" id="MJXp-Span-1148">OMP</span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">\text{OMP}-k</script></span>, với các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">k</script></span> thể hiện số đặc trưng khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-mn" id="MJXp-Span-1154">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">0</script></span> có thể. Coates và Ng (2011) đã chứng minh rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mtext" id="MJXp-Span-1156">OMP</span><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1158">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">\text{OMP}-1</script></span> có thể là một bộ <em>trích chọn đặc trưng</em> (feature extractor) rất hiệu quả cho các kiến trúc đa tầng.</p><p>Về cơ bản, bất kỳ mô hình nào có các đơn vị ẩn đều có thể được biểu diễn thưa. Xuyên suốt cuốn sách này, ta sẽ thấy nhiều ví dụ về phương pháp kiểm soát tính thưa được sử dụng trong các ngữ cảnh khác nhau.</p><h1 id="711-Bỏ-túi-và-các-phương-pháp-kết-hợp-khác">7.11 Bỏ túi và các phương pháp kết hợp khác</h1><p><em>Bỏ túi</em> (bagging) (viết tắt của <em>tổng hợp tự lực</em> (bootstrap aggregating)) là một kĩ thuật để giảm sai số tổng quát hóa bằng cách kết hợp một số mô hình khác nhau [Breiman, 1994]. Ý tưởng ở đây là huấn luyện một vài mô hình khác nhau một cách riêng biệt, sau đó tất cả các mô hình bỏ phiếu xác định đầu ra cho các mẫu kiểm thử. Đây là một ví dụ về một chiến lược tổng quát trong học máy được gọi là <em>trung bình hóa mô hình</em> (model averaging). Những kĩ thuật sử dụng chiến lược này được gọi là các <em>phương pháp hợp thể</em> (ensemble method).</p><blockquote>
<p><em><strong>ND</strong></em>: Từ bagging được hình thành bằng cách ghép các chữ cái in đậm của từ <b>b</b>oostrap <b>agg</b>regat<b>ing</b>. Từ bag trong tiếng Anh là cái túi, và bagging có thể tạm hiểu là gom lại vào trong túi. Theo nghĩa nào đó, từ bagging cũng phản ánh tính chất của phương pháp boostrap aggregating là thực hiện gom lại các mô hình để tạo thành mô hình mới. Từ bagging là một cách chơi chữ rất khéo léo của Leo Breiman mà chúng tôi không tìm được cách dịch tiếng Việt thể hiện đầy đủ sự khéo léo này. Do đó, chúng tôi tạm dịch từ bagging theo nghĩa đen của nó.</p>
</blockquote><p>Chiến lược trung bình hóa mô hình hoạt động hiệu quả là nhờ các mô hình khác nhau thường sẽ không tạo các các lỗi giống nhau trên tập kiểm thử.</p><p>Xem xét ví dụ về một tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">k</script></span> mô hình hồi quy. Giả sử rằng mỗi mô hình tạo ra một lỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1164" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">\epsilon_i</script></span> trên mỗi quan sát, với các lỗi được rút ra từ một phân phối chuẩn đa biến có trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1165"><span class="MJXp-mn" id="MJXp-Span-1166">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">0</script></span>, phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1167"><span class="MJXp-mrow" id="MJXp-Span-1168"><span class="MJXp-mi undefined" id="MJXp-Span-1169">E</span></span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1174">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">\mathbb{E}[\epsilon_i^2] = v</script></span> và hiệp phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mrow" id="MJXp-Span-1179"><span class="MJXp-mi undefined" id="MJXp-Span-1180">E</span></span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1184" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1187" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">\mathbb{E}[\epsilon_i\epsilon_j] = c</script></span>. Theo đó, những lỗi được tạo ra bằng cách dự đoán trung bình của tất cả các mô hình trong hợp thể là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mfrac" id="MJXp-Span-1192" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1193">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">k</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1195"><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1197" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1201" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">\frac{1}{k}\sum_{i} \epsilon_i</script></span>. Sai số bình phương kỳ vọng của bộ dự đoán hợp thể là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1202"><span class="MJXp-mtable" id="MJXp-Span-1203"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1204" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1205" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1206"><span class="MJXp-mi undefined" id="MJXp-Span-1207">E</span></span><span class="MJXp-mstyle" id="MJXp-Span-1208"><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">[</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1211"><span class="MJXp-mrow" id="MJXp-Span-1212"><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1214" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1215">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">k</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1217"><span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1219" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1223" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mstyle" id="MJXp-Span-1225" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-1226"><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1228" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mstyle" id="MJXp-Span-1229"><span class="MJXp-mrow" id="MJXp-Span-1230"><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1233" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1234">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1237" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1238"><span class="MJXp-mi undefined" id="MJXp-Span-1239">E</span></span><span class="MJXp-mstyle" id="MJXp-Span-1240"><span class="MJXp-mrow" id="MJXp-Span-1241"><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">[</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1243"><span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1245" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">i</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1247"><span class="MJXp-mrow" id="MJXp-Span-1248"><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1250"><span class="MJXp-mrow" id="MJXp-Span-1251" style="margin-right: 0.05em;"><span class="MJXp-msubsup" id="MJXp-Span-1252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1254" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1255" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1257"><span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1259" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">i</span><span class="MJXp-mo" id="MJXp-Span-1261">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">j</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1265" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1268" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mstyle" id="MJXp-Span-1269"><span class="MJXp-mrow" id="MJXp-Span-1270"><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1272"><span class="MJXp-mrow" id="MJXp-Span-1273"><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-93">\mathbb{E}\bigg[\bigg(\frac{1}{k}\sum_{i} \epsilon_i\bigg)^2\bigg] = \frac{1}{k^2}\mathbb{E}\bigg[\sum_{i}\bigg({\epsilon_i}^2 + \sum_{i\neq j}\epsilon_i\epsilon_j \bigg)\bigg],\tag{7.50}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1276"><span class="MJXp-mtable" id="MJXp-Span-1277"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1278" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1279" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1281" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1282">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">k</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">v</span><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1286" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">k</span><span class="MJXp-mo" id="MJXp-Span-1288" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1289">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">k</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">c</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">= \frac{1}{k}v + \frac{k-1}{k}c. \tag{7.51}</script></span></p><p>Trong trường hợp các sai số là <em>tương quan tuyệt đối</em> (perfectly correlated) và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">c</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">c = v</script></span>, sai số bình phương trung bình giảm xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">v</script></span>, do đó việc trung bình hóa mô hình sẽ không mang lại lợi ích gì. Trong trường hợp sai số hoàn toàn không tương quan với nhau và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">c</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1302">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">c=0</script></span>, k vọng bình phương sai số của mô hình hợp thể chỉ còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1303"><span class="MJXp-mfrac" id="MJXp-Span-1304" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1305">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">k</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">\frac{1}{k}v</script></span>. Điều này có nghĩa là sai số bình phương kỳ vọng của mô hình hợp thể sẽ tỉ lệ nghịch với kích thước của mô hình hợp thể. Nói cách khác, xét theo trung bình, mô hình hợp thể sẽ có hiệu suất tốt ít nhất bằng một mô hình thành phần bất kì nào đó của nó, và nếu các mô hình thành phần tạo ra các sai số một cách độc lập, mô hình hợp thể sẽ hiệu quả hơn nhiều so với các mô hình thành phần của nó.</p><p>Các phương pháp hợp thể khác nhau xây dựng mô hình hợp thể theo các cách khác nhau. Ví dụ, mỗi một thành phần của mô hình hợp thể có thể được tạo thành bằng cách huấn luyện các loại mô hình hoàn toàn khác nhau bằng các thuật toán và hàm mục tiêu khác nhau. Bỏ túi là một phương pháp cho phép tái sử dụng nhiều lần cùng một loại mô hình, thuật toán huấn luyện, và hàm mục tiêu.</p><p>Cụ thể, phương pháp bỏ túi sẽ xây dựng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">k</script></span> tập dữ liệu khác nhau. Mỗi tập dữ liệu có cùng một số lượng mẫu huấn luyện như tập dữ liệu gốc, nhưng mỗi tập dữ liệu được xây dựng bằng cách <em>lấy mẫu có thay thế</em> (sampling with replacement) từ tập dữ liệu gốc. Điều này có nghĩa rằng, mỗi tập dữ liệu đều có khả năng cao bị thiếu một số mẫu  và chứa một vài mẫu bị trùng lặp so với tập dữ liệu gốc<sup>[4]</sup>. Mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">i</script></span> sau đó được huấn luyện trên tập dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">i</script></span>. Sự khác biệt giữa các mẫu được thêm vào trong mỗi tập dữ liệu tạo nên sự khác biệt giữa các mô hình huấn luyện. Xem một ví dụ trong hình 7.5.</p><blockquote>
<p>[4]: Khi cả tập dữ liệu gốc lẫn tập dữ liệu được tái lấy mẫu đều chứa $m mẫu quan sát, tỉ lệ chính xác của các mẫu quan sát bị thiếu trong tập dữ liệu mới là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1314"><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1316">1</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1318" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1319">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1323" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">(1-\frac{1}{m})^m</script></span>. Đây là khả năng mà một quan sát cụ thể không được chọn trong số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">m</script></span> quan sát có thể trong tập dữ liệu gốc để tạo ra tập dữ liệu mới. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">m</script></span> tiến tới vô cùng, giá trị này hội tụ về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1328"><span class="MJXp-mfrac" id="MJXp-Span-1329" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1330">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">e</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">\frac{1}{e}</script></span>. Giá trị này lớn hơn một chút so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1332"><span class="MJXp-mfrac" id="MJXp-Span-1333" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1334">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1335">3</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\frac{1}{3}</script></span>.</p>
</blockquote><p><img src="https://i.imgur.com/4f2IBg7.png" alt=""></p><blockquote>
<p>Hình 7.5: Một mô tả bằng hình ảnh về cách phương pháp bỏ túi hoạt động. Giả sử chúng ta huấn luyện một bộ nhận diện số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1336"><span class="MJXp-mn" id="MJXp-Span-1337">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">8</script></span> trên tập dữ liệu được mô tả ở trên, bao gồm một số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1338"><span class="MJXp-mn" id="MJXp-Span-1339">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">8</script></span>, một số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1340"><span class="MJXp-mn" id="MJXp-Span-1341">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">6</script></span> và một số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1342"><span class="MJXp-mn" id="MJXp-Span-1343">9</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">9</script></span>. Giả sử ta tạo ra hai bộ dữ liệu được tái lấy mẫu khác nhau. Quá trình huấn luyện bỏ túi xây dựng mỗi một bộ dữ liệu bằng cách tái lấy mẫu có thay thế. Bộ dữ liệu đầu tiên bỏ qua số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mn" id="MJXp-Span-1345">9</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">9</script></span> và lặp lại số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1346"><span class="MJXp-mn" id="MJXp-Span-1347">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">8</script></span>. Trên bộ dữ liệu này, bộ nhận diện học được rằng có một vòng ở phần phía trên chữ số tương ứng với số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-mn" id="MJXp-Span-1349">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">8</script></span>. Trong bộ dữ liệu thứ hai, chúng ta lặp lại số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-mn" id="MJXp-Span-1351">9</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">9</script></span> và loại bỏ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1352"><span class="MJXp-mn" id="MJXp-Span-1353">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">6</script></span>. Trong trường hợp này, bộ nhận diện học được rằng có một vòng tròn ở phần dưới của chữ số tương ứng với số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-mn" id="MJXp-Span-1355">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">8</script></span>. Mỗi quy tắc riêng lẻ này là khá yếu, nhưng nếu chúng ta lấy trung bình đầu ra của chúng, thì bộ nhận diện sẽ trở nên mạnh hơn và đạt được độ chính xác tối đa khi cả hai vòng tròn của số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-mn" id="MJXp-Span-1357">8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">8</script></span> xuất hiện.</p>
</blockquote><p>Các mạng neuron nhân tạo đạt được bộ điểm tối ưu đủ đa dạng để có thể hưởng lợi từ phương pháp trung bình hóa mô hình ngay cả khi tất cả các mô hình được huấn luyện trên cùng tập dữ liệu. Sự khác biệt trong khởi tạo ngẫu nhiên, trong chọn lô nhỏ ngẫu nhiên, trong siêu tham số, hoặc trong kết quả của việc thực thi không xác định các mạng neuron là đủ để khiến các mô hình thành viên khác nhau của mô hình hợp thể tạo ra các sai số độc lập theo từng phần.</p><p>Trung bình hóa mô hình là một phương pháp cực kì mạnh và đáng tin cậy để giảm thiểu sai số tổng quát hoá. Việc sử dụng mô hình này thường không được khuyến khích khi <em>đánh giá xếp loại</em> (benchmarking) các giải thuật cho các bài báo khoa học, bởi vì bất kì một giải thuật học máy nào cũng có thể thu được lợi ích đáng kể từ trung bình hóa mô hình với cái giá phải trả là tăng khối lượng tính toán và bộ nhớ. Vì lý do này, việc đánh giá xếp loại thường được thực hiện sử dụng một mô hình đơn.</p><p>Các phương pháp sử dụng trung bình hoá mô hình trên hàng tá mô hình đơn lẻ thường xuyên chiến thắng trong các cuộc thi học máy. Một ví vụ nổi bật gần đây là Netﬂix Grand Prize [Koren, 2009].</p><p>Không phải toàn bộ các kĩ thuật xây dựng các mô hình hợp thể được thiết kế để mô hình hợp thể được kiểm soát hơn so với các mô hình đơn lẻ. Ví dụ, một kĩ thuật được gọi là <em>học tăng cường</em> (boosting) [Freund và Schapire, 1996b,a] xây dựng một mô hình hợp thể với dung lượng cao hơn những mô hình đơn lẻ. Học tăng cường đã và đang được áp dụng để xây dựng các hợp thể của mạng neuron [Schwenk and Bengio, 1998] bằng cách từng bước thêm các mạng neuron vào mô hình hợp thể. Học tăng cường cũng đã được áp dụng để diễn giải một mạng neuron đơn lẻ như là một mô hình hợp thể [Bengio et al., 2006a], từng bước thêm các đơn vị ẩn vào trong mạng.</p><h1 id="712-Cơ-chế-tắt-ngẫu-nhiên">7.12 Cơ chế tắt ngẫu nhiên</h1><p><em>Cơ chế tắt ngẫu nhiên</em> (dropout) [Srivastava et al., 2014] cung cấp một phương pháp đơn giản nhưng hiệu quả để kiểm soát một họ lớn các mô hình. Nói một cách tương đối, cơ chế tắt ngẫu nhiên có thể được coi là một phương pháp khiến cho kĩ thuật bỏ túi thực hiện hợp thể rất nhiều mạng neuron lớn trở nên thực tế hơn. Bỏ túi bao gồm việc huấn luyện nhiều mô hình và đánh giá nhiều mô hình trên mỗi mẫu kiểm thử. Điều này có vẻ phi thực tế khi mỗi mô hình là một mạng neuron lớn, bởi việc huấn luyện và đánh giá những mạng neuron gây tốn kém về mặt thời gian và bộ nhớ. Người ta thường sử dụng mô hình hợp thể của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1358"><span class="MJXp-mn" id="MJXp-Span-1359">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">5</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mn" id="MJXp-Span-1361">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">10</script></span> mạng neuron - Szegedy và cộng sự (2014a) sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1362"><span class="MJXp-mn" id="MJXp-Span-1363">6</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">6</script></span> mạng neuron để thắng cuộc thi ILSVRC - nhưng nhiều hơn số này sẽ nhanh chóng trở nên khó sử dụng. Cơ chế tắt ngẫu nhiên cung cấp một xấp xỉ khá hiệu quả để huấn luyện và đánh giá một mô hình hợp thể kết hợp nhiều mạng neuron.</p><p>Cụ thể, cơ chế tắt ngẫu nhiên huấn luyện mô hình hợp thể bao gồm tất cả các mạng con được hình thành bằng cách loại bỏ các đơn vị không phải đầu ra từ một mạng cơ sở, như minh họa trong hình 7.6. Trong hầu hết các mạng neuron hiện đại, dựa vào một chuỗi các phép biến đổi affin và phi tuyến, chúng ta có thể loại bỏ một cách hiệu quả một đơn vị trong mạng bằng cách nhân giá trị đầu ra của nó với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1364"><span class="MJXp-mn" id="MJXp-Span-1365">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">0</script></span>. Quá trình này chỉ đòi hỏi một số sửa đổi nhỏ trong mô hình kiểu như các <em>mạng các hàm cơ sở xuyên tâm</em> (radial basis function network), mà đầu vào của nó là sự khác biệt giữa trạng thái của một đơn vị và giá trị tham chiếu nào đó. Ở đây, chúng tôi trình bày giải thuật của cơ chế tắt ngẫu nhiên bằng phép nhân với số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1366"><span class="MJXp-mn" id="MJXp-Span-1367">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">0</script></span> cho đơn giản, nhưng chỉ cần được điều chỉnh một chút để phù hợp với các thao tác xoá nút khác.</p><p><img src="https://i.imgur.com/INRtWNf.png" alt=""></p><blockquote>
<p>Hình 7.6: Cơ chế tắt ngẫu nhiên huấn luyện một mô hình hợp thể tất cả các mạng con có thể được tạo ra bằng cách loại bỏ các đơn vị không phải đầu ra từ một mạng cơ sở. Ở đây, chúng tôi bắt đầu với một mạng cơ sở với hai đơn vị tường minh và hai đơn vị ẩn. Có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1368"><span class="MJXp-mn" id="MJXp-Span-1369">16</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">16</script></span> tập con có thể của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1370"><span class="MJXp-mn" id="MJXp-Span-1371">4</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">4</script></span> đơn vị này. Chúng tôi chỉ ra tất cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mn" id="MJXp-Span-1373">16</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">16</script></span> mạng con có thể được tạo ra bằng cách loại bỏ các tập con khác nhau của các đơn vị trong mạng cơ sở. Trong ví dụ nhỏ này, phần lớn các mạng con được tạo ra không có các đơn vị đầu vào hoặc không có đường kết nối giữa đầu vào và đầu ra. Vấn đề này không quan trọng đối với các mạng có các tầng rộng hơn, khi mà xác suất để loại bỏ tất cả các đường từ đầu vào đến đầu ra trở nên rất nhỏ.</p>
</blockquote><p>Nhắc lại, trong kĩ thuật học bỏ túi, chúng ta định nghĩa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">k</script></span> mô hình khác nhau, xây dựng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">k</script></span> tập dữ liệu khác nhau từ tập huấn luyện bằng lấy mẫu có thay thế, và sau đó huấn luyện mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">i</script></span> trên tập dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">i</script></span>. Cơ chế tắt ngẫu nhiên nhằm mục đích xấp xỉ quá trình này nhưng với số lượng lớn theo hàm mũ các mạng neuron. Cụ thể, để huấn luyện với cơ chế tắt ngẫu nhiên, chúng ta sử dụng một thuật toán học dựa trên lô nhỏ thực hiện các bước cập nhật nhỏ, chẳng hạn như trượt gradient ngẫu nhiên. Mỗi lần nạp một tập dữ liệu vào một lô nhỏ, ta lấy mẫu ngẫu nhiên một <em>mặt nạ nhị phân</em> (binary mask) khác để để áp dụng lên toàn bộ đầu vào và đơn vị ẩn của mạng. Mặt nạ của mỗi đơn vị được lấy mẫu độc lập với các đơn vị khác. Xác suất lấy mẫu của một mặt nạ có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1382"><span class="MJXp-mn" id="MJXp-Span-1383">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">1</script></span> (dẫn đến một đơn vị được nằm trong mạng) là một siêu tham số được thiết lập trước khi quá trình huấn luyện bắt đầu. Nó không phải là một hàm của các tham số hiện tại của mô hình hoặc dữ liệu đầu vào. Thông thường, một đơn vị đầu vào được thêm vào với xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1384"><span class="MJXp-mn" id="MJXp-Span-1385">0.8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">0.8</script></span> và một đơn vị ẩn được thêm vào với xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mn" id="MJXp-Span-1387">0.5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">0.5</script></span>. Sau đó, ta thực hiện lan truyền thuận, lan truyền ngược và cập nhật quá trình học như thông thường. Hình 7.7 minh họa cách lan truyền thuận với cơ chế tắt ngẫu nhiên.</p><p><img src="https://i.imgur.com/4DHtdga.png" alt=""></p><blockquote>
<p>Hình 7.7: Một ví dụ về quá trình lan truyền thuận qua một mạng lan truyền thuận sử dụng cơ chế tắt ngẫu nhiên. (<em>Hình trên</em>) Trong ví dụ này, ta sử dụng một mạng sử dụng lan truyền thuận với hai đơn vị đầu vào, một tầng ẩn với hai đơn vị ẩn và một đơn vị đầu ra. (<em>Hình dưới</em>) Để thực hiện lan truyền thuận với cơ chế tắt ngẫu nhiên, ta lấy mẫu ngẫu nhiên một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">\mu</script></span> với một thành phần ứng với mỗi đơn vị tầng ẩn hoặc đầu vào trong mạng. Các phần tử của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">\mu</script></span> là các giá trị nhị phân và được lấy mẫu độc lập với nhau. Xác suất mỗi phần tử bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1392"><span class="MJXp-mn" id="MJXp-Span-1393">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">1</script></span> là một siêu tham số, thông thường nó sẽ bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1394"><span class="MJXp-mn" id="MJXp-Span-1395">0.5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">0.5</script></span> cho các tầng ẩn và bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1396"><span class="MJXp-mn" id="MJXp-Span-1397">0.8</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">0.8</script></span> cho đầu vào. Mỗi đơn vị trong mạng sẽ được nhân tương ứng với một mặt nạ, và tiếp tục lan truyền thuận qua các phần còn lại của mô hình mạng như thường lệ. Điều này giống với việc lựa chọn ngẫu nhiên một trong các mạng con trong hình 7.16 sau đó thực hiện lan truyền thuận qua mạng con đó.</p>
</blockquote><p>Nói một cách toán học hơn, giả sử một vector mặt nạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1399">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">\boldsymbol{\mu}</script></span> quy định thành phần nào được thêm vào và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">J</span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1403">θ</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1405">μ</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">J(\boldsymbol{\theta},\boldsymbol{\mu})</script></span> biểu diễn chi phí của mô hình được xác địnhđ bởi tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1407"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1408">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">\boldsymbol{\theta}</script></span> và mặt nạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1409"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1410">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">\boldsymbol{\mu}</script></span>. Sau đó quá trình huấn luyện mô hình với cơ chế tắt ngẫu nhiên sẽ bao gồm việc cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1411"><span class="MJXp-msubsup" id="MJXp-Span-1412"><span class="MJXp-mrow" id="MJXp-Span-1413" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1414">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1415" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1416">μ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">J</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1419">θ</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1421">μ</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">\mathbb{E}_{\boldsymbol{\mu}}J(\boldsymbol{\theta},\boldsymbol{\mu})</script></span>. Kỳ vọng chứa một số mũ các thành phần, nhưng ta có thể thu được một ước lượng không chệch của gradient bằng lấy mẫu các giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1423"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1424">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">\boldsymbol{\mu}</script></span>.</p><p>Cơ chế tắt ngẫu nhiên không hoàn toàn giống với kỹ thuật bỏ túi. Trong trường hợp bỏ túi, các mô hình là độc lập với nhau. Trong trường hợp tắt ngẫu nhiên, các mô hình dùng chung tham số, với mỗi mô hình kế thừa từ các tập con khác nhau của bộ tham số từ mạng neuron mẹ. Việc dùng chung tham số này làm cho nó có thể biểu diễn một số lượng theo hàm mũ của các mô hình với lượng bộ nhớ khả dụng. Trong trường hợp của bỏ túi, mỗi mô hình được huấn luyện để hội tụ trên tập huấn luyện tương ứng. Trong trường hợp của tắt ngẫu nhiên, thông thường hầu hết các mô hình không được huấn luyện một cách tường minh - thường thì mô hình lớn đến mức ta không thể lấy mẫu tất cả các mạng con có thể. Thay vào đó, một phần nhỏ trong số các mạng con khả dụng được huấn luyện theo từng mạng trong một bước duy nhất, và việc dùng chung tham số làm cho các mạng con còn lại tiến tới các thiết lập tốt của tham số. Đó là những điểm khác biệt duy nhất, ngoài ra, tắt ngẫu nhiên hầu như tuân theo cơ chế của kỹ thuật bỏ túi. Ví dụ, tập huấn luyện của mỗi mạng con thực tế là một tập con của tập huấn luyện ban đầu được lấy mẫu có thay thế.</p><p>Để đưa ra dự đoán, một mô hình hợp thể kiểu bỏ túi phải tích lũy kết quả dự đoán từ tất cả các thành viên của nó. Chúng tôi đề cập đến quá trình đó như là <em>quá trình suy luận</em> (inference) trong trường hợp này. Cho đến nay, mô tả của chúng tôi về kỹ thuật bỏ túi và cơ chế tắt ngẫu nhiên không yêu cầu các mô hình phải là xác suất một cách hiển hiện. Từ bây giờ, chúng tôi giả định rằng vai trò của mô hình là để tạo ra một phân phối xác suất. Trong trường hợp của bỏ túi, mỗi mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">i</script></span> tạo ra phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1427"><span class="MJXp-msubsup" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1430" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1431">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">i</span><span class="MJXp-mo" id="MJXp-Span-1433">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">y</span><span class="MJXp-mrow" id="MJXp-Span-1436"><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1438">x</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">p^{(i)}(y|\boldsymbol{x})</script></span>. Dự đoán của mô hình hợp thể được cho bới trung bình số học của các phân bố này,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1440"><span class="MJXp-mtable" id="MJXp-Span-1441"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1442" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1443" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1444" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1445">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">k</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1447"><span class="MJXp-munderover" id="MJXp-Span-1448"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1454" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">k</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1450" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">i</span><span class="MJXp-mo" id="MJXp-Span-1452">=</span><span class="MJXp-mn" id="MJXp-Span-1453">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1458" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1459">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">i</span><span class="MJXp-mo" id="MJXp-Span-1461">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">y</span><span class="MJXp-mtext" id="MJXp-Span-1464">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1465"><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1467">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1468">x</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-146">\frac{1}{k}\displaystyle\sum_{i=1}^{k} p^{(i)}(y\ |\ \boldsymbol{x}). \tag{7.52}</script></span></p><p>Trong trường hợp sử dụng cơ chế tắt ngẫu nhiên, mỗi mô hình con được xác định bởi vector mặt nạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">\mu</script></span> là một phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">p</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">y</span><span class="MJXp-mtext" id="MJXp-Span-1477">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1480">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1481">x</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1483">μ</span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">p(y\ |\ \boldsymbol{x}, \boldsymbol {\mu})</script></span>. Giá trị trung bình trên toàn bộ các mặt nạ được cho bởi:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1485"><span class="MJXp-mtable" id="MJXp-Span-1486"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1487" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1488" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1489"><span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1491" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">μ</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">p</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1495">μ</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">p</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">y</span><span class="MJXp-mtext" id="MJXp-Span-1500">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1503">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1504">x</span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1506">μ</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-149">\sum_{\mu}p(\boldsymbol{\mu})p(y\ |\ \boldsymbol{x}, \boldsymbol{\mu}), \tag{7.53}</script></span></p><p>Trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">p</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1512">μ</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">p(\boldsymbol{\mu})</script></span> là phân phối xác suất được sử dụng để lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1515">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">\boldsymbol{\mu}</script></span> tại thời điểm huấn luyện.</p><p>Do tổng trên bao gồm một hàm mũ các thành phần, nên việc định trị nó rất tốn kém trừ khi cấu trúc của mô hình mạng có dạng đơn giản. Tuy nhiên cho đến nay, chưa có mạng neuron đa tầng nào có dạng đơn giản như vậy. Thay vào đó, chúng ta có thể xấp xỉ quá trình suy luận thông qua phép lấy mẫu, bằng cách lấy trung bình kết quả đầu ra từ nhiều mặt nạ. Ngay cả chỉ với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1516"><span class="MJXp-mn" id="MJXp-Span-1517">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">10</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mn" id="MJXp-Span-1519">20</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">20</script></span> mặt nạ cũng thường là đủ để thu được hiệu suất tốt.</p><p>Một cách tiếp cận tốt hơn nữa, cho phép ta thu được một xấp xỉ tốt của các dự đoán của toàn bộ hợp thể, với chi phí chỉ là một lượt lan truyền thuận. Để làm điều đó, ta chuyển sang sử dụng giá trị <em>trung bình nhân</em> (geometric mean) thay vì trung bình cộng của phân phối các dự đoán của toàn bộ thành viên trong hợp thể. Warde-Farley và cộng sự (2014) đã đưa ra luận cứ và bằng chứng thực nghiệm cho thấy trung bình nhân thực hiện tốt hơn hoặc ít nhất là tương đương so với trung bình cộng trong trường hợp này.</p><p>Trung bình nhân của nhiều phân phối xác suất không được đảm bảo cũng là một phân phối xác suất. Để đảo bảo kết quả là một phân phối xác suất, chúng tôi áp đặt một yêu cầu rằng không có mô hình con nào sẽ gán xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mn" id="MJXp-Span-1521">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">0</script></span> cho bất kỳ sự kiện nào, sau đó thực hiện tái chuẩn hoá phân phối thu được. Phân phối xác suất chưa chuẩn hoá được định nghĩa trực tiếp bằng phép trung bình nhân có dạng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1522"><span class="MJXp-mtable" id="MJXp-Span-1523"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1524" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1525" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mrow" id="MJXp-Span-1527" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1528"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1531" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1532">ensemble</span></span></span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">y</span><span class="MJXp-mtext" id="MJXp-Span-1535">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1536"><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1538">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1539">x</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mroot" id="MJXp-Span-1542"><span class="MJXp-script" style="margin-right: -0.724em; vertical-align: 1.404em;"><span class="MJXp-msubsup" id="MJXp-Span-1559"><span class="MJXp-mn" id="MJXp-Span-1560" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1561" style="vertical-align: 0.5em;">d</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 254%; margin-top: 0.055em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-1543"><span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1545" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1546">μ</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">p</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">y</span><span class="MJXp-mtext" id="MJXp-Span-1550">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1551"><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1553">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1554">x</span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1556">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1557">μ</span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-155">\tilde{p}_{\text{ensemble}}(y\ |\ \boldsymbol{x}) = \sqrt[2^d]{\prod\limits_{\boldsymbol{\mu}}p(y\ |\ \boldsymbol{x},\ \boldsymbol{\mu})}, \tag{7.54}</script></span></p><blockquote>
<p><em><strong>ND</strong></em>: Giả sử ta có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">d</script></span> đơn vị. Khi đó, ta sẽ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1565"><span class="MJXp-msubsup" id="MJXp-Span-1566"><span class="MJXp-mn" id="MJXp-Span-1567" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1568" style="vertical-align: 0.5em;">d</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">2^d</script></span> mạng neuron có thể được tạo thành từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">d</script></span> đơn vị này, mỗi mạng tương ứng với một tập con của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">d</script></span> đơn vị trên. Do đó phân phối xác suất chuẩn theo trung bình nhân sẽ bằng khai căn bậc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1573"><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mn" id="MJXp-Span-1575" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1576" style="vertical-align: 0.5em;">d</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">2^d</script></span> của tích xác suất đầu ra của các thành phần trong mô hình hợp thể.</p>
</blockquote><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">d</script></span> là số đơn vị có thể bị tắt ngẫu nhiên. Ở đây ta sử dụng một phân phối đều trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1579"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1580">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">\boldsymbol{\mu}</script></span> để đơn giản hoá việc trình bày, cần chú ý là phân phối không đều cũng được chấp nhận. Để đưa ra dự đoán, ta phải chuẩn hóa lại toàn bộ hợp thể:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1581"><span class="MJXp-mtable" id="MJXp-Span-1582"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1583" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1584" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1587" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1588">ensemble</span></span></span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">y</span><span class="MJXp-mtext" id="MJXp-Span-1591">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1592"><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1594">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1595">x</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1598" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1599"><span class="MJXp-mrow" id="MJXp-Span-1600" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1601"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">p</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1604" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">y</span><span class="MJXp-mtext" id="MJXp-Span-1607">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1608"><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1610">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611">x</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1613"><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1615" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1618" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1619"><span class="MJXp-mi" id="MJXp-Span-1620" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1621" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1622"><span class="MJXp-mrow" id="MJXp-Span-1623" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1624"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">p</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1627" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1631" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1632"><span class="MJXp-mi" id="MJXp-Span-1633" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1634" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1635">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1636"><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1638">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1639">x</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-163">p_{\text{ensemble}}(y\ |\ \boldsymbol{x}) = \frac{\tilde{p}_\text{ensemble}(y\ |\ \boldsymbol{x}) }{\sum_{y^{'}}\tilde{p}_\text{ensemble}(y^{'}\ |\ \boldsymbol{x})}. \tag{7.55}</script></span></p><p>Một điểm mấu chốt [Hinton et al., 2012c] trong cơ chế tắt ngẫu nhiên đó là ta có thể xấp xỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-msubsup" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1645" style="vertical-align: -0.4em;">ensemble</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">p_\text{ensemble}</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">p</span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">y</span><span class="MJXp-mrow" id="MJXp-Span-1650"><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1652">x</span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">p(y|\boldsymbol{x})</script></span> trong một mô hình mà bao gồm toàn bộ các đơn vị, nhưng các trọng số đi ra ngoài đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">i</script></span> được nhân với xác suất giữ lại đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">i</script></span>. Động cơ của sự thay đổi này đó là để có thể bắt được đúng giá trị kỳ vọng tại đầu ra của đơn vị đó. Chúng ta gọi cách tiếp cận này đó là <em>quy tắc suy luận nhân tỉ lệ trọng số</em> (weight scaling inference rule). Không có một luận điểm lý thuyết nào về độ chính xác của quy tắc suy luận xấp xỉ này trong các mô hình mạng neuron không tuyến tính, tuy nhiên trong các thực nghiệm nó đã thực hiện rất hiệu quả.</p><p>Do ta thường thiết lập xác suất giữ một đơn vị trong cơ chế tắt ngẫu nhiên là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1658"><span class="MJXp-mfrac" id="MJXp-Span-1659" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1660">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1661">2</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">\frac{1}{2}</script></span>, quy tắc nhân tỉ lệ trọng số thường dẫn đến việc chia các trọng số cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-mn" id="MJXp-Span-1663">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">2</script></span> tại thời điểm cuối của quá trình huấn luyện, sau đó sử dụng mô hình đó như bình thường. Một cách khác để thu được kết quả tương tự đó là nhân các đơn vị hiện thời với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-mn" id="MJXp-Span-1665">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">2</script></span> trong quá trình huấn luyện. Dù bằng cách nào đi nữa, mục đích vẫn là đảm bảo rằng tổng các đầu vào kỳ vọng cho một đơn vị tại thời điểm kiểm thử gần với tổng các đầu vào kỳ vọng cho đơn vị đó tại thời điểm huấn luyện, mặc dù trung bình có đến một nửa số đơn vị tại thời điểm huấn luyện bị tắt đi.</p><blockquote>
<p><em><strong>ND</strong></em>: Phép nhân tỉ lệ trọng số dùng để suy diễn, hay nói đơn giản hơn là dùng khi chạy mô hình với dữ liệu mới (trong quá trình kiểm thử hoặc áp dụng mô hình vào thực tiễn), vì ta không sử dụng cơ chế tắt ngẫu nhiên để tắt hay bật các đơn vị ẩn trong quá trình này.</p>
</blockquote><p>Với các lớp mô hình không có đơn vị ẩn phi tuyến, quy tắc suy luận nhân tỉ lệ trọng số là chính xác. Một ví dụ đơn giản, xét một bộ phân lớp hồi quy sử dụng softmax với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">n</script></span> biến đầu vào được biểu diễn bởi vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1668"><span class="MJXp-mrow" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1670">v</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">\mathbf{v}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1671"><span class="MJXp-mtable" id="MJXp-Span-1672"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1673" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1674" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">P</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1677"><span class="MJXp-mi" id="MJXp-Span-1678">y</span></span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">y</span><span class="MJXp-mtext" id="MJXp-Span-1681">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1682"><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1684">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1685"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1686">v</span></span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1689"><span class="MJXp-mi" id="MJXp-Span-1690">s</span><span class="MJXp-mi" id="MJXp-Span-1691">o</span><span class="MJXp-mi" id="MJXp-Span-1692">f</span><span class="MJXp-mi" id="MJXp-Span-1693">t</span><span class="MJXp-mi" id="MJXp-Span-1694">m</span><span class="MJXp-mi" id="MJXp-Span-1695">a</span><span class="MJXp-mi" id="MJXp-Span-1696">x</span></span><span class="MJXp-mstyle" id="MJXp-Span-1697"><span class="MJXp-mrow" id="MJXp-Span-1698"><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1700"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1701" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1702" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1703">⊤</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1704"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1705">v</span></span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1707">b</span><span class="MJXp-msubsup" id="MJXp-Span-1708"><span class="MJXp-mstyle" id="MJXp-Span-1709" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-1710"><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1712" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-173">P(\mathrm{y}=y\space |\ \mathbf{v}) = \mathrm{softmax}\bigg(\boldsymbol{W}^{\top}\mathbf{v} +\boldsymbol{b}\bigg)_y . \tag{7.56}</script></span></p><p>Chúng ta có thể biểu thị các mô hình con bằng phép nhân theo từng phần tử của đầu vào với một vector nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1715">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\boldsymbol{d}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1716"><span class="MJXp-mtable" id="MJXp-Span-1717"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1718" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1719" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">P</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1722"><span class="MJXp-mi" id="MJXp-Span-1723">y</span></span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">y</span><span class="MJXp-mtext" id="MJXp-Span-1726">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1727"><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1729">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1730"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1731">v</span></span><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1733">d</span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1736"><span class="MJXp-mi" id="MJXp-Span-1737">s</span><span class="MJXp-mi" id="MJXp-Span-1738">o</span><span class="MJXp-mi" id="MJXp-Span-1739">f</span><span class="MJXp-mi" id="MJXp-Span-1740">t</span><span class="MJXp-mi" id="MJXp-Span-1741">m</span><span class="MJXp-mi" id="MJXp-Span-1742">a</span><span class="MJXp-mi" id="MJXp-Span-1743">x</span></span><span class="MJXp-mstyle" id="MJXp-Span-1744"><span class="MJXp-mrow" id="MJXp-Span-1745"><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1748" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1749" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1750">⊤</span></span></span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1752">d</span><span class="MJXp-mo" id="MJXp-Span-1753" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1755">v</span></span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1758">b</span><span class="MJXp-msubsup" id="MJXp-Span-1759"><span class="MJXp-mstyle" id="MJXp-Span-1760" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1763" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-175">P(\mathrm{y}=y\ |\ \mathbf{v};\boldsymbol{d}) = \mathrm{softmax}\bigg(\boldsymbol{W}^{\top}(\boldsymbol{d}\odot\mathbf{v}) +\boldsymbol{b}\bigg)_y . \tag{7.57}</script></span></p><p>Bộ dự đoán hợp thể được xác định bằng cách chuẩn hóa lại giá trị trung bình nhân trên toàn bộ dự đoán của các thành viên trong hợp thể:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1765"><span class="MJXp-mtable" id="MJXp-Span-1766"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1767" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1768" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;">P</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1771" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1773"><span class="MJXp-mi" id="MJXp-Span-1774">y</span></span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">y</span><span class="MJXp-mrow" id="MJXp-Span-1777"><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1780">v</span></span><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1783" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1784"><span class="MJXp-mrow" id="MJXp-Span-1785" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1786"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">P</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1791"><span class="MJXp-mi" id="MJXp-Span-1792">y</span></span><span class="MJXp-mo" id="MJXp-Span-1793" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">y</span><span class="MJXp-mtext" id="MJXp-Span-1795">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1796"><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1798">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1799"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1800">v</span></span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1804" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1807" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1808"><span class="MJXp-mi" id="MJXp-Span-1809" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1810" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mrow" id="MJXp-Span-1812" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1813"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">p</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1816" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1818"><span class="MJXp-mi" id="MJXp-Span-1819">y</span></span><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1823" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1824"><span class="MJXp-mi" id="MJXp-Span-1825" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1826" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1827">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1828"><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1830">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1831"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1832">v</span></span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-176">P_\text{ensemble}(\mathrm{y}=y|\mathbf{v}) = \frac{\tilde{P}_\text{ensemble}(\mathrm{y}=y\ |\ \mathbf{v}) }{\sum_{y^{'}}\tilde{p}_\text{ensemble}(\mathrm{y}=y^{'}\ |\ \mathbf{v})} , \tag{7.58}</script></span></p><p>trong đó</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1835"><span class="MJXp-mtable" id="MJXp-Span-1836"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1837" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1838" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1839"><span class="MJXp-mrow" id="MJXp-Span-1840" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1841"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">P</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1844" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1846"><span class="MJXp-mi" id="MJXp-Span-1847">y</span></span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">y</span><span class="MJXp-mtext" id="MJXp-Span-1850">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1851"><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1853">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1854"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1855">v</span></span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mroot" id="MJXp-Span-1858"><span class="MJXp-script" style="margin-right: -0.798em; vertical-align: 1.523em;"><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mn" id="MJXp-Span-1887" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1888" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 280%; margin-top: 0.05em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-1859"><span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1861" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1862">d</span><span class="MJXp-mo" id="MJXp-Span-1863">∈</span><span class="MJXp-mo" id="MJXp-Span-1864">{</span><span class="MJXp-mn" id="MJXp-Span-1865">0</span><span class="MJXp-mo" id="MJXp-Span-1866">,</span><span class="MJXp-mn" id="MJXp-Span-1867">1</span><span class="MJXp-msubsup" id="MJXp-Span-1868"><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1870" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">P</span><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1873"><span class="MJXp-mi" id="MJXp-Span-1874">y</span></span><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">y</span><span class="MJXp-mtext" id="MJXp-Span-1877">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1878"><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1880">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1881"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1882">v</span></span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1884">d</span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-177">\tilde{P}_\text{ensemble}(\mathrm{y} = y\space |\space\mathbf{v}) = \sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n} P(\mathrm{y}=y\ |\ \mathbf{v};\boldsymbol{d})}. \tag{7.59}</script></span></p><p>Để thấy rằng quy tắc nhân tỉ lệ trọng số là chính xác, ta có thể đơn giản hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1890"><span class="MJXp-msubsup" id="MJXp-Span-1891"><span class="MJXp-mrow" id="MJXp-Span-1892" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1893"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">P</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1896" style="vertical-align: -0.4em;">ensemble</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">\tilde{P}_\text{ensemble}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1897"><span class="MJXp-mtable" id="MJXp-Span-1898"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1899" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1900" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1901"><span class="MJXp-mrow" id="MJXp-Span-1902" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1903"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">P</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1906" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1908"><span class="MJXp-mi" id="MJXp-Span-1909">y</span></span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">y</span><span class="MJXp-mtext" id="MJXp-Span-1912">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1913"><span class="MJXp-mo" id="MJXp-Span-1914" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1915">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1917">v</span></span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mroot" id="MJXp-Span-1920"><span class="MJXp-script" style="margin-right: -0.798em; vertical-align: 1.523em;"><span class="MJXp-msubsup" id="MJXp-Span-1948"><span class="MJXp-mn" id="MJXp-Span-1949" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1950" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 280%; margin-top: 0.05em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-1921"><span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1923" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1924">d</span><span class="MJXp-mo" id="MJXp-Span-1925">∈</span><span class="MJXp-mo" id="MJXp-Span-1926">{</span><span class="MJXp-mn" id="MJXp-Span-1927">0</span><span class="MJXp-mo" id="MJXp-Span-1928">,</span><span class="MJXp-mn" id="MJXp-Span-1929">1</span><span class="MJXp-msubsup" id="MJXp-Span-1930"><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1932" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">P</span><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1935"><span class="MJXp-mi" id="MJXp-Span-1936">y</span></span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">y</span><span class="MJXp-mtext" id="MJXp-Span-1939">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1940"><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1942">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1943"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1944">v</span></span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1946">d</span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-179">\tilde{P}_\text{ensemble}(\mathrm{y} = y\space |\space\mathbf{v}) = \sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n}P(\mathrm{y}=y\ |\ \mathbf{v};\boldsymbol{d})}. \tag{7.60}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1952"><span class="MJXp-mtable" id="MJXp-Span-1953"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1954" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1955" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mroot" id="MJXp-Span-1957"><span class="MJXp-script" style="margin-right: -0.838em; vertical-align: 1.588em;"><span class="MJXp-msubsup" id="MJXp-Span-1993"><span class="MJXp-mn" id="MJXp-Span-1994" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1995" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 294%; margin-top: 0.048em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-1958"><span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1960" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1961">d</span><span class="MJXp-mo" id="MJXp-Span-1962">∈</span><span class="MJXp-mo" id="MJXp-Span-1963">{</span><span class="MJXp-mn" id="MJXp-Span-1964">0</span><span class="MJXp-mo" id="MJXp-Span-1965">,</span><span class="MJXp-mn" id="MJXp-Span-1966">1</span><span class="MJXp-msubsup" id="MJXp-Span-1967"><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1969" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1970"><span class="MJXp-mi" id="MJXp-Span-1971">s</span><span class="MJXp-mi" id="MJXp-Span-1972">o</span><span class="MJXp-mi" id="MJXp-Span-1973">f</span><span class="MJXp-mi" id="MJXp-Span-1974">t</span><span class="MJXp-mi" id="MJXp-Span-1975">m</span><span class="MJXp-mi" id="MJXp-Span-1976">a</span><span class="MJXp-mi" id="MJXp-Span-1977">x</span></span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1979"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1980" style="margin-right: 0.05em;">W</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1981" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1983">d</span><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-1985"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1986">v</span></span><span class="MJXp-mo" id="MJXp-Span-1987" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1988" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1989">b</span><span class="MJXp-msubsup" id="MJXp-Span-1990"><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1992" style="vertical-align: -0.4em;">y</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-180">=\sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n}\mathrm{softmax}(\boldsymbol W^\top(\boldsymbol d\odot\mathbf v)+\boldsymbol{b})_y}\tag{7.61}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1996"><span class="MJXp-mtable" id="MJXp-Span-1997"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1998" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1999" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2000" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mroot" id="MJXp-Span-2001"><span class="MJXp-script" style="margin-right: -0.79em; vertical-align: 2.147em;"><span class="MJXp-msubsup" id="MJXp-Span-2081"><span class="MJXp-mn" id="MJXp-Span-2082" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2083" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale4" style="font-size: 416%; margin-top: 0.034em; margin-left: -0.327em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.126em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-2002"><span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2004" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2005">d</span><span class="MJXp-mo" id="MJXp-Span-2006">∈</span><span class="MJXp-mo" id="MJXp-Span-2007">{</span><span class="MJXp-mn" id="MJXp-Span-2008">0</span><span class="MJXp-mo" id="MJXp-Span-2009">,</span><span class="MJXp-mn" id="MJXp-Span-2010">1</span><span class="MJXp-msubsup" id="MJXp-Span-2011"><span class="MJXp-mo" id="MJXp-Span-2012" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2013" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2014">&nbsp;</span><span class="MJXp-mfrac" id="MJXp-Span-2015" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2016">exp</span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2020" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2025"><span class="MJXp-mi" id="MJXp-Span-2026">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">y</span><span class="MJXp-mo" id="MJXp-Span-2023">,</span><span class="MJXp-mo" id="MJXp-Span-2024">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2028">d</span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2030"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2031">v</span></span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2033" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2034"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2035" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2036" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2038"><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2040" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2043" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2044"><span class="MJXp-mi" id="MJXp-Span-2045" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2046" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2047">exp</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mstyle" id="MJXp-Span-2049"><span class="MJXp-mrow" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2052"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2053" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2060"><span class="MJXp-mi" id="MJXp-Span-2061">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2054"><span class="MJXp-msup" id="MJXp-Span-2055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2057" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2058">,</span><span class="MJXp-mo" id="MJXp-Span-2059">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2063">d</span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2065"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2066">v</span></span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2068" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2069"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2070" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2071" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2074" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2075"><span class="MJXp-mi" id="MJXp-Span-2076" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2077" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-2078"><span class="MJXp-mrow" id="MJXp-Span-2079"><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-181">=\sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n}\space
\frac
{\exp(\boldsymbol{W}_{y,:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+\boldsymbol{b}_y)} 
{\sum_{y^{'}}\exp\bigg(\boldsymbol{W}_{y',:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+\boldsymbol{b}_{y^{'}}\bigg)}
}
\tag{7.62}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2084"><span class="MJXp-mtable" id="MJXp-Span-2085"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2086" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2087" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2089" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mroot" id="MJXp-Span-2090"><span class="MJXp-script" style="margin-right: -0.821em; vertical-align: 1.56em;"><span class="MJXp-msubsup" id="MJXp-Span-2125"><span class="MJXp-mn" id="MJXp-Span-2126" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2127" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 288%; margin-top: 0.049em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-2091"><span><span class="MJXp-mo" id="MJXp-Span-2092" style="margin-left: 0.111em; margin-right: 0.167em;">∏</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2093" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2094">d</span><span class="MJXp-mo" id="MJXp-Span-2095">∈</span><span class="MJXp-mo" id="MJXp-Span-2096">{</span><span class="MJXp-mn" id="MJXp-Span-2097">0</span><span class="MJXp-mo" id="MJXp-Span-2098">,</span><span class="MJXp-mn" id="MJXp-Span-2099">1</span><span class="MJXp-msubsup" id="MJXp-Span-2100"><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2102" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2103">exp</span><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2107" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2112"><span class="MJXp-mi" id="MJXp-Span-2113">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">y</span><span class="MJXp-mo" id="MJXp-Span-2110">,</span><span class="MJXp-mo" id="MJXp-Span-2111">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2115">d</span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2117"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2118">v</span></span><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2121"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2122" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2123" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2124" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mroot" id="MJXp-Span-2128"><span class="MJXp-script" style="margin-right: -0.821em; vertical-align: 1.56em;"><span class="MJXp-msubsup" id="MJXp-Span-2185"><span class="MJXp-mn" id="MJXp-Span-2186" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2187" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 288%; margin-top: 0.049em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-2129"><span><span class="MJXp-mo" id="MJXp-Span-2130" style="margin-left: 0.111em; margin-right: 0.167em;">∏</span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2131" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2132">d</span><span class="MJXp-mo" id="MJXp-Span-2133">∈</span><span class="MJXp-mo" id="MJXp-Span-2134">{</span><span class="MJXp-mn" id="MJXp-Span-2135">0</span><span class="MJXp-mo" id="MJXp-Span-2136">,</span><span class="MJXp-mn" id="MJXp-Span-2137">1</span><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2140" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2141"><span class="MJXp-msubsup" id="MJXp-Span-2142"><span class="MJXp-mo" id="MJXp-Span-2143" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2144" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2147" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2148"><span class="MJXp-mi" id="MJXp-Span-2149" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2150" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2151">exp</span><span class="MJXp-mo" id="MJXp-Span-2152" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mstyle" id="MJXp-Span-2153"><span class="MJXp-mrow" id="MJXp-Span-2154"><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2156"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2157" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2164"><span class="MJXp-mi" id="MJXp-Span-2165">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2158"><span class="MJXp-msup" id="MJXp-Span-2159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2161" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2162">,</span><span class="MJXp-mo" id="MJXp-Span-2163">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2167">d</span><span class="MJXp-mo" id="MJXp-Span-2168" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2169"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2170">v</span></span><span class="MJXp-mo" id="MJXp-Span-2171" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2174" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2175" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2178" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2179"><span class="MJXp-mi" id="MJXp-Span-2180" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2181" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-2182"><span class="MJXp-mrow" id="MJXp-Span-2183"><span class="MJXp-mo" id="MJXp-Span-2184" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-182">=\frac {\sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n} \exp(\boldsymbol{W}_{y,:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+\boldsymbol{b}_y)}}{\sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n}{\sum_{y^{'}}\exp\bigg(\boldsymbol{W}_{y',:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+\boldsymbol{b}_{y^{'}}\bigg)}}} 
\tag{7.63}</script></span></p><p>Do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2188"><span class="MJXp-mrow" id="MJXp-Span-2189"><span class="MJXp-munderover" id="MJXp-Span-2190"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2192" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">P</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">\tilde{P}</script></span> sẽ được chuẩn hóa, ta có thể bỏ qua phép nhân bởi các hệ số là không đổi đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">y</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2195"><span class="MJXp-mtable" id="MJXp-Span-2196"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2197" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2198" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2199"><span class="MJXp-mrow" id="MJXp-Span-2200" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2201"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2203" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">P</span></span></span></span></span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2206"><span class="MJXp-mi" id="MJXp-Span-2207">y</span></span><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">y</span><span class="MJXp-mtext" id="MJXp-Span-2210">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2211"><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2213">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2214"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2215">v</span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2217" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mroot" id="MJXp-Span-2218"><span class="MJXp-script" style="margin-right: -0.838em; vertical-align: 1.588em;"><span class="MJXp-msubsup" id="MJXp-Span-2253"><span class="MJXp-mn" id="MJXp-Span-2254" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2255" style="vertical-align: 0.5em;">n</span></span></span><span><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 294%; margin-top: 0.048em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-munderover" id="MJXp-Span-2219"><span><span class="MJXp-mo" id="MJXp-Span-2220" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2221" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2222">d</span><span class="MJXp-mo" id="MJXp-Span-2223">∈</span><span class="MJXp-mo" id="MJXp-Span-2224">{</span><span class="MJXp-mn" id="MJXp-Span-2225">0</span><span class="MJXp-mo" id="MJXp-Span-2226">,</span><span class="MJXp-mn" id="MJXp-Span-2227">1</span><span class="MJXp-msubsup" id="MJXp-Span-2228"><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2230" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2231">exp</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2233" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2235" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2240"><span class="MJXp-mi" id="MJXp-Span-2241">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">y</span><span class="MJXp-mo" id="MJXp-Span-2238">,</span><span class="MJXp-mo" id="MJXp-Span-2239">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2243">d</span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2245"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2246">v</span></span><span class="MJXp-mo" id="MJXp-Span-2247" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2249"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2250" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2251" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-185">\tilde{P}_\text{ensemble}(\mathrm{y} = y\space |\space\mathbf{v})
\propto
\sqrt[2^n]{\prod\limits_{\boldsymbol{d}\in\{0,1\}^n} \exp(\boldsymbol{W}_{y,:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+\boldsymbol{b}_y)}
\tag{7.64}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2256"><span class="MJXp-mtable" id="MJXp-Span-2257"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2258" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2259" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2261">exp</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2263"><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-2265" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2266">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2267"><span class="MJXp-mn" id="MJXp-Span-2268" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2269" style="vertical-align: 0.5em;">n</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2270"><span><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2272" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2273">d</span><span class="MJXp-mo" id="MJXp-Span-2274">∈</span><span class="MJXp-mo" id="MJXp-Span-2275">{</span><span class="MJXp-mn" id="MJXp-Span-2276">0</span><span class="MJXp-mo" id="MJXp-Span-2277">,</span><span class="MJXp-mn" id="MJXp-Span-2278">1</span><span class="MJXp-msubsup" id="MJXp-Span-2279"><span class="MJXp-mo" id="MJXp-Span-2280" style="margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2281" style="vertical-align: 0.5em;">n</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2283" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2288"><span class="MJXp-mi" id="MJXp-Span-2289">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">y</span><span class="MJXp-mo" id="MJXp-Span-2286">,</span><span class="MJXp-mo" id="MJXp-Span-2287">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2291">d</span><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mrow" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2294">v</span></span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2299" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2300" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">)</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-186">=\exp
\left(\frac{1}{2^n}\sum_{\boldsymbol{d}\in\{0,1\}^n} \boldsymbol{W}_{y,:}^{\top}(\boldsymbol{d}\odot\mathbf{v})+b_y\right)
\tag{7.65}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2301"><span class="MJXp-mtable" id="MJXp-Span-2302"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2303" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2304" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2306">exp</span><span class="MJXp-mo" id="MJXp-Span-2307" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2308"><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-2310" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2311">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2312">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2313"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2314" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2319"><span class="MJXp-mi" id="MJXp-Span-2320">⊤</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">y</span><span class="MJXp-mo" id="MJXp-Span-2317">,</span><span class="MJXp-mo" id="MJXp-Span-2318">:</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2321"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2322">v</span></span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2326" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-2327" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-187">=\exp\left(\frac{1}{2} \boldsymbol{W}_{y,:}^{\top}\mathbf{v}+b_y\right)
\tag{7.66}.</script></span></p><p>Thay công thức này vào phương trình 7.58, ta thu được một bộ phân loại softmax với giá trị trọng số bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2329"><span class="MJXp-mfrac" id="MJXp-Span-2330" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2331">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2332">2</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2333">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\frac{1}{2}\boldsymbol{W}</script></span>.</p><p>Quy tắc nhân tỉ lệ trọng số cũng chính xác trong các thiết lập khác, bao gồm các mạng hồi quy với điều kiện đầu ra tuân theo phân phối chuẩn có điều kiện cũng như các mạng neuron đa tầng có các tầng ẩn không chứa các thành phần phi tuyến. Tuy nhiên, quy tắc nhân tỉ lệ trọng số chỉ là một xấp xỉ đối với các mô hình đa tầng có chứa thành phần phi tuyến. Mặc dù xấp xỉ này chưa có bằng chứng lý thuyết, nhưng nó thường cho kết quả tốt trong thực nghiệm. Goodfellow và cộng sự (2013a) đã tìm ra bằng thực nghiệm rằng các xấp xỉ bằng phép nhân tỉ lệ trọng số hoạt động tốt hơn (về độ chính xác phân loại) so với các hợp thể được xấp xỉ theo Monte-Carlo. Điều này vẫn đúng khi các xấp xỉ theo Monte-Carlo được phép lấy mẫu lên đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mn" id="MJXp-Span-2335">1000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">1000</script></span> mạng con. Gal và Ghahramani (2015) tìm ra rằng một số mô hình có kết quả phân loại tốt hơn khi sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2336"><span class="MJXp-mn" id="MJXp-Span-2337">20</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">20</script></span> mẫu và xấp xỉ Monte-Carlo. Có vẻ như việc lựa chọn suy luận xấp xỉ tối ưu phụ thuộc vào từng bài toán.</p><p>Srivastava và cộng sự (2014) chỉ ra rằng cơ chế tắt ngẫu nhiên hiệu quả hơn so với các phương pháp kiểm soát khác có chi phí tính toán thấp như suy giảm trọng số, ràng buộc chuẩn và kiểm soát tính thưa. Tắt ngẫu nhiên cũng có thể được kết hợp với các cơ chế kiểm soát khác để nâng cao hiệu suất của mô hình.</p><p>Một ưu điểm của cơ chế tắt ngẫu nhiên đó là chi phí tính toán thấp. Việc sử dụng cơ chế này trong quá trình huấn luyện chỉ cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">O</span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">n</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">O(n)</script></span> phép toán với mỗi mẫu cho mỗi lần cập nhật, để tạo ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">n</script></span> số nhị phân ngẫu nhiên và nhân các số này với các trạng thái. Tuỳ thuộc vào cách thức thực thi, nó có thể yêu cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">O</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">n</span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">O(n)</script></span> bộ nhớ để lưu trữ những các giá trị nhị phân này cho đến khi quá trình lan truyền ngược bắt đầu. Việc thực hiện quá trình suy luận trên các mô hình đã huấn luyện có chi phí trên mỗi mẫu bằng với trường hợp không sử dụng cơ chế tắt ngẫu nhiên, mặc dù ta vẫn phải tốn chi phí cho việc chia các trọng số cho 2 đúng một lần trước khi bắt đầu thực hiện suy luận trên các mẫu.</p><p>Một ưu điểm nổi bật khác của cơ chế tắt ngẫu nhiên đó là nó không giới hạn một cách đáng kể loại mô hình hay các phương pháp huấn luyện sử dụng. Nó hoạt động với bất kỳ mô hình nào sử dụng biểu diễn phân tán và có thể được huấn luyện với thuật toán trượt gradient ngẫu nhiên. Bao gồm các mô hình mạng neuron lan truyền thuận, mô hình xác suất như máy Boltzmann thu hẹp [Srivastava et al., 2014], hoặc mô hình mạng neuron truy hồi [Bayer and Osendorfer, 2014; Pascanu et al., 2014a]. Trong khi nhiều chiến lược kiểm soát khác với hiệu quả tương đương lại tỏ ra kén chọn khi áp đặt những giới hạn khắt khe hơn đối với kiến trúc của mô hình.</p><p>Mặc dù chi phí áp dụng cơ chế tắt ngẫu nhiên trong mỗi bước cho một mô hình cụ thể là không đáng kể, nhưng chi phí sử dụng tắt ngẫu nhiên trong một hệ thống hoàn chỉnh có thể trở nên đáng lưu tâm. Bởi cơ chế tắt ngẫu nhiên là một kỹ thuật kiểm soát, nó làm giảm dung lượng có hiệu lực của mô hình. Để bù lại ta phải tăng kích thước của mô hình. Thường thì sai số trên tập xác thực sẽ thấp hơn khá nhiều khi sử dụng cơ chế tắt ngẫu nhiên, tuy nhiên điều này đổi lại mô hình tạo ra sẽ rất lớn và cần sử dụng nhiều vòng lặp trong thuật toán huấn luyện. Với các bộ dữ liệu cực lớn, cơ chế kiểm soát làm giảm không đáng kể sai số tổng quát hoá của mô hình. Trong trường hợp này, chi phí tính toán khi sử dụng cơ chế tắt ngẫu nhiên có thể vượt quá lợi ích thu được từ chúng.</p><p>Trong trường hợp số mẫu huấn luyện được gán nhãn sẵn là rất nhỏ, cơ chế tắt ngẫu nhiên lại tỏ ra kém hiệu quả hơn. Các mô hình mạng neuron Bayes [Neal, 1996] có hiệu suất cao hơn hẳn cơ chế tắt ngẫu nhiên trên tập dữ liệu Alternative Splicing [Xiong et al., 2011], với chỉ gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mn" id="MJXp-Span-2351">5000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">5000</script></span> mẫu trong tập dữ liệu [Srivastava et al., 2014]. Khi thêm các dữ liệu không được gán nhãn vào, việc học không giám sát các đặc trưng có thể mang lại nhiều lợi ích so với cơ chế tắt ngẫu nhiên.</p><p>Wager và cộng sự (2013) chỉ ra rằng khi áp dụng cho hồi quy tuyến tính, cơ chế tắt ngẫu nhiên tương đương với phương pháp suy giảm trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-msubsup" id="MJXp-Span-2353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2355" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">L_2</script></span> với các hệ số suy giảm trọng số khác nhau cho mỗi đặc trưng đầu vào. Tầm quan trọng của hệ số suy giảm trọng số của mỗi đặc trưng được quyết định bởi phương sai của nó. Kết quả tương tự cũng đúng với các mô hình tuyến tính khác. Với mô hình đa tầng, cơ chế tắt ngẫu nhiên không tương đương với phương pháp suy giảm trọng số.</p><p>Tính ngẫu nhiên trong quá trình huấn luyện với cơ chế tắt ngẫu nhiên là không cần thiết để đạt được kết quả tốt. Nó chỉ là một cách để xấp xỉ tổng trên toàn bộ các mô hình con. Wang và Manning (2013) đã tìm ra xấp xỉ dạng giải tích của tổng này. Xấp xỉ của họ, được gọi là <em>cơ chế tắt ngẫu nhiên nhanh</em> (fast dropout), có tốc độ hội tụ nhanh hơn do giảm tính ngẫu nhiên trong việc tính toán gradient. Phương pháp này cũng có thể được áp dụng trong quá trình kiểm thử, như là một xấp xỉ chính thức hơn (nhưng cũng cần tăng khối lượng tính toán nhiều hơn) của trung bình cộng trên toàn bộ các mạng con so với xấp xỉ dựa trên phép nhân tỉ lệ trọng số. Kỹ thuật tắt ngẫu nhiên nhanh đã và đang được sử dụng để đạt được hiệu suất tốt như tắt ngẫu nhiên truyền thống trên các bài toán sử dụng mạng neuron kích thước nhỏ. Tuy nhiên, kỹ thuật này chưa thực sự đạt được sự cải thiện đáng kể hoặc cũng chưa được áp dụng trên các bài toán lớn.</p><p>Tính ngẫu nhiên là không cần thiết và cũng không đủ để đạt được hiệu quả kiểm soát của cơ chế tắt ngẫu nhiên. Để giải thích điều này, Warde-Farley và cộng sự (2014) xây dựng các thí nghiệm kiểm tra sử dụng phương pháp được gọi là <em>cơ chế tắt ngẫu nhiên tăng cường</em> (dropout boosting). Phương pháp này sử dụng mặt nạ nhiễu giống với cơ chế tắt ngẫu nhiên truyền thống nhưng không có hiệu ứng kiểm soát. Cơ chế tắt ngẫu nhiên tăng cường sẽ huấn luyện toàn bộ mô hình hợp thể để cực đại hoá logarit hàm hợp lý trên dữ liệu huấn luyện. Theo nghĩa rằng nếu cơ chế tắt ngẫu nhiên truyền thống tương đương với cơ chế bỏ túi, thì phương pháp này tương đương với cơ chế tăng cường. Giống như dự đoán, các thực nghiệm với cơ chế tắt ngẫu nhiên tăng cường gần như không thể hiện hiệu ứng kiểm soát nào so với khi huấn luyện toàn bộ mạng như một mô hình đơn. Điều này cho thấy rằng cách diễn giải cơ chế tắt ngẫu nhiên theo phương pháp bỏ túi có giá trị hơn so với cách diễn giải cơ chế tắt ngẫu nhiên như là một phương pháp kháng nhiễu. Hiệu ứng kiểm soát của mô hình hợp thể khi sử dụng phương pháp bỏ túi chỉ đạt được khi các thành viên được lấy ngẫu nhiên của hợp thể được huấn luyện độc lập với nhau.</p><p>Cơ chế tắt ngẫu nhiên đã truyền cảm hứng cho các hướng tiếp cận có tính ngẫu nhiên khác để huấn luyện các hợp thể lớn của các mô hình dùng chung tham số. <em>Ngắt kết nối</em> (DropConnect) là một trường hợp đặc biệt của cơ chế tắt ngẫu nhiên, trong đó mỗi tích giữa một trọng số vô hướng và một trạng thái đơn vị ẩn được xem là một đơn vị có thể được loại bỏ [Wan et al., 2013]. Phép <em>gộp ngẫu nhiên</em> (stochastic pooling) là một dạng gộp ngẫu nhiên (randomized pooling - xem phần 9.3) để xây dựng hợp thể của các mạng tích chập, với mỗi mạng tích chập chú tâm đến các vị trí không gian khác nhau của mỗi <em>bản đồ đặc trưng</em> (feature map). Cho đến thời điểm này, cơ chế tắt ngẫu nhiên vẫn là một phương pháp hợp thể ngầm định được sử dụng rộng rãi nhất.</p><p>Một trong những điểm mấu chốt trong cơ chế tắt ngẫu nhiên đó là quá trình huấn luyện một mạng với hành vi ngẫu nhiên với dự đoán đưa ra bằng cách lấy trung bình của nhiều quyết định ngẫu nhiên, sẽ thực thi phương pháp bỏ túi dùng chung tham số. Ở trên, chúng tôi đã mô tả cơ chế tắt ngẫu nhiên như là một hợp thể của các mô hình bằng cách thêm hoặc loại bỏ các phần tử. Tuy nhiên chiến lược trung bình hoá mô hình này không nhất thiết phụ thuộc vào sự thêm vào hay loại bỏ các đơn vị. Về nguyên tắc, bất kì kiểu chỉnh sửa ngẫu nhiên nào cũng được chấp nhận. Trong thực tế, chúng ta phải chọn họ các kĩ thuật sửa đổi mà các mạng neuron khả năng học để kháng cự lại.</p><p>Trong trường hợp lý tưởng, chúng ta cũng nên sử dụng các họ mô hình có một quy tắc suy luận xấp xỉ nhanh. Ta có thể coi bất cứ dạng sửa đổi nào được tham số hoá bằng một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">\mu</script></span> như là việc huấn luyện một hợp thể của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">p</span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">y</span><span class="MJXp-mrow" id="MJXp-Span-2362"><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2364">x</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2366">μ</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">p(y|\boldsymbol x,\boldsymbol\mu)</script></span> với tất cả các giá trị có thể của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">\mu</script></span>. Không yêu cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">\mu</script></span> phải có một số hữu hạn giá trị. Ví dụ, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2373">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">\boldsymbol\mu</script></span> có thể là số thực. Srivastava và cộng sự (2014) chỉ ra rằng việc nhân các trọng số với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2375">μ</span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-2377"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2378">N</span></span><span class="MJXp-mo" id="MJXp-Span-2379" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2380">1</span><span class="MJXp-mo" id="MJXp-Span-2381" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2382">I</span><span class="MJXp-mo" id="MJXp-Span-2383" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-201">\boldsymbol\mu \sim \mathcal{N}(1,\boldsymbol I)</script></span> có thể đạt hiệu suất tốt hơn hẳn cơ chế tắt ngẫu nhiên dựa trên mặt nạ nhị phân. Bởi vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">E</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2387">μ</span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2390">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">E[\boldsymbol \mu]= 1</script></span>, mạng chuẩn đó tự động thực hiện suy luận xấp xỉ trong hợp thể, mà không cần phải nhân tỉ lệ trọng số.</p><p>Cho tới thời điểm này, chúng tôi đã mô tả cơ chế tắt ngẫu nhiên đơn giản chỉ như một phương tiện thực hiện xấp xỉ phương pháp bỏ túi một cách hiệu quả. Ở một góc nhìn khác xa hơn, cơ chế tắt ngẫu nhiên không chỉ là một hợp thể các mô hình ở dạng bỏ túi mà còn là một hợp thể của các mô hình có chung các đơn vị ẩn. Điều này có nghĩa là mỗi đơn vị ẩn phải có khả năng thực hiện tốt, bất kể các đơn vị ẩn khác hoạt động thế nào trong mô hình. Các đơn vị ẩn phải được chuẩn bị để hoán đổi giữa các mô hình. Hinton và cộng sự (2012c) lấy cảm hứng từ một ý tưởng sinh học: sinh sản hữu tính - một hình thức sinh sản có sự tham gia của quá trình trao đổi gen giữa các sinh vật khác nhau, tạo ra một áp lực tiến hóa cho gen để trở nên không những tốt, mà còn có khả năng trao đổi giữa các sinh vật khác với nhau. Những gen và đặc trưng đó khá bền vững trước những thay đổi môi trường vì chúng không có khả năng thích nghi một cách sai lầm với các đặc trưng bất thường của bất cứ sinh vật hay mô hình nào. Vì vậy, cơ chế tắt ngẫu nhiên kiểm soát từng đơn vị ẩn để nó trở nên không chỉ là một đặc trưng tốt mà còn tốt trong nhiều hoàn cảnh khác nhau. Warde-Farley và cộng sự (2014) đã so sánh việc huấn luyện sự dụng cơ chế tắt ngẫu nhiên với việc huấn luyện một lượng lớn hợp thể, và kết luận rằng cơ chế tắt ngẫu nhiên cũng giúp cải thiện sai số tổng quát hoá một cách vượt trội so với hợp thể của các mô hình độc lập.</p><p>Một điều quan trọng bạn đọc cần phải hiểu đó là một phần lớn sức mạnh của cơ chế tắt ngẫu nhiên bắt nguồn từ việc áp dụng các mặt nạ nhiễu cho các đơn vị ẩn. Điều này có thể được coi như một dạng phá huỷ nội dung thông tin đầu vào thông minh và có tính thích ứng cao, thay vì phá hủy các giá trị thô của dữ liệu đầu vào đó. Ví dụ, nếu mô hình học từ một đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2391"><span class="MJXp-msubsup" id="MJXp-Span-2392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2394" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">h_i</script></span> giúp nhận dạng khuôn mặt bằng cách tìm ra mũi, thì việc loại bỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-msubsup" id="MJXp-Span-2396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2398" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">h_i</script></span> sẽ tương ứng với việc xóa bỏ thông tin là có một chiếc mũi trên ảnh. Mô hình phải học một phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2399"><span class="MJXp-msubsup" id="MJXp-Span-2400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2402" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">h_i</script></span> khác để, hoặc là mã hoá sự hiện diện của mũi, hoặc là nhận diện mặt dựa vào các đặc trưng khác như là miệng. Các kỹ thuật thêm nhiễu truyền thống, thêm các nhiễu vô cấu trúc (unstructured noise) vào đầu vào không thể ngẫu nhiên xóa bỏ thông tin về mũi từ một hình ảnh khuôn mặt, trừ khi giá trị của nhiễu là lớn đến nỗi toàn bộ thông tin trong ảnh bị huỷ bỏ. Việc phá hủy các các đặc trưng được trích chọn thay vì các trị số gốc cho phép quá trình phá hủy tận dụng được kiến thức về phân bố đầu vào mà mô hình đã thu được trước đó.</p><p>Một khía cạnh quan trọng khác của cơ chế tắt ngẫu nhiên đó là các nhiễu được nhân lên nhiều lần (nhiễu nhân tính). Nếu nhiễu được thêm vào với một tỉ lệ cố định, một đơn vị ẩn tuyến tính hiệu chỉnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2403"><span class="MJXp-msubsup" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2406" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">h_i</script></span> với nhiễu bổ sung <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">\epsilon</script></span> có thể chỉ đơn giản là học để tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2409"><span class="MJXp-msubsup" id="MJXp-Span-2410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2412" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">h_i</script></span> trở nên cực lớn, khiến cho cho nhiễu nhỏ đi tương đối. Các nhiễu nhân tính không cho phép các giải pháp kháng nhiễu vô lý như vậy.</p><p>Một thuật toán học sâu khác, được gọi là <em>chuẩn hóa theo lô</em> (batch normalization), tái tham số hoá mô hình theo cách đưa vào cả nhiễu cộng tính lẫn nhiễn nhân tính trên các đơn vị ẩn khi huấn luyện. Ý nghĩa của phương pháp này là để tăng khả năng tối ưu, nhưng nhiễu đó có thể có cả hiệu ứng kiểm soát và đôi lúc làm cho cơ chế tắt ngẫu nhiên trở nên không cần thiết. Chuẩn hóa theo lô sẽ được mô tả nhiều hơn trong phần 8.7.1.</p><h1 id="713-Huấn-luyện-đối-kháng">7.13 Huấn luyện đối kháng</h1><p>Trong nhiều trường hợp, mạng neuron đã bắt đầu đạt được hiệu suất như con người khi đánh giá trên các dữ liệu kiểm thử được lấy ngẫu nhiên đồng đều. Theo lẽ tự nhiên, chúng ta có thể tự hỏi rằng liệu những mô hình này có thực sự đã đạt đến mức của con người trong những tác vụ như vậy hay chưa. Để thăm dò mức độ hiểu biết của một mạng đối với một tác vụ đằng sau, ta có thể tìm kiếm các mẫu dữ liệu mà mô hình phân lớp lỗi. Szegedy và cộng sự (2014) đã tìm ra rằng thậm chí các mạng neuron có độ chính xác ngang bằng con người vẫn có tỉ lệ lỗi gần như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2413"><span class="MJXp-mn" id="MJXp-Span-2414">100</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">100%</script></span> trên các mẫu dữ liệu được xây dựng bằng cách sử dụng một thủ tục tối ưu, để tìm ra một mẫu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2415"><span class="MJXp-msup" id="MJXp-Span-2416"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2417" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2418" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">\boldsymbol x'</script></span> gần với một điểm dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2419"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2420">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">\boldsymbol x</script></span> sao cho đầu ra của mô hình tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2421"><span class="MJXp-msup" id="MJXp-Span-2422"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2423" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2424" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">\boldsymbol x'</script></span> là rất khác biệt. Trong rất nhiều trường hợp, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2425"><span class="MJXp-msup" id="MJXp-Span-2426"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2427" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2428" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">\boldsymbol x'</script></span> có thể giống <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2430">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">\boldsymbol x</script></span> đến mức con người không thể thấy được sự khác biệt giữa mẫu ban đầu và <em>mẫu đối kháng</em> (adversarial example), tuy nhiên mạng neuron lại đưa ra các dự đoán hoàn toàn khác nhau. Xem ví dụ trong hình 7.8.</p><p><img src="https://i.imgur.com/xOCNLlm.png" alt=""></p><blockquote>
<p>Hình 7.8: Một ví dụ tạo ra mẫu đối kháng được ứng dụng trong GoogLeNet [Szegedy et al., 2014a] trên ImageNet. Bằng cách thêm một vector rất nhỏ vào đạo hàm của hàm mất mát, chúng ta có thể thay đổi kết quả phân lớp của mạng GoogLeNet. Hình minh hoạ được tái tạo có sự cho phép của Goodfellow và cộng sự (2014b).</p>
</blockquote><p>Các mẫu đối kháng có rất nhiều ứng dụng, chẳng hạn như trong bảo mật máy tính, một lĩnh vực nằm ngoài phạm vi của chương này. Tuy nhiên, chúng khá thú vị trong ngữ cảnh các cơ chế kiểm soát vì ta có thể giảm tỉ lệ dự đoán sai của một dữ liệu kiểm thử được lấy ngẫu nhiên đồng đều bằng cách huấn luyện trên các mẫu đối kháng tạo ra từ dữ liệu gốc [Szegedy et al., 2014b; Goodfellow et al., 2014b].</p><p>Goodfellow và cộng sự (2014b) đã chỉ ra một trong những nguyên nhân chính cho sự tồn tại của các mẫu đối kháng là do sự tuyến tính quá mức. Mạng neuron được xây dựng chủ yếu dựa trên các khối tuyến tính. Vì vậy trong một số thực nghiệm, hàm tổng quát mà chúng thực thi có tính tuyến tính cao. Các hàm tuyến tính này khá dễ tối ưu. Nhưng không may, giá trị của một hàm tuyến tính có thể thay đổi rất nhiều nếu có nhiều dữ liệu đầu vào. Nếu ta thay đổi mỗi đầu vào bằng một số nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">\epsilon</script></span>, thì một hàm tuyến tính với trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2433"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2434">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">\boldsymbol w</script></span> có thể thay đổi một lượng rất lớn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436">ϵ</span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-2438"><span class="MJXp-mo" id="MJXp-Span-2439" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2440"><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2442">w</span><span class="MJXp-mrow" id="MJXp-Span-2443"><span class="MJXp-mo" id="MJXp-Span-2444" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-2445"><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">\epsilon .||\boldsymbol w||</script></span> nếu như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2448">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">\boldsymbol w</script></span> có số chiều cao. Huấn luyện đối kháng ngăn cản các hành vi tuyến tính cục bộ quá nhạy bằng cách khuyến khích mạng neuron bất biến cục bộ trong vùng lân cận với dữ liệu huấn luyện. Điều này có thể được xem như một cách đưa vào một <em>tiền đề bất biến cục bộ</em> (local constancy prior) cho mạng neuron có giám sát.</p><blockquote>
<p><em><strong>ND</strong></em>: Xem phần cuối chương 5 để biết thêm tiền đề bất biến cục bộ là gì.</p>
</blockquote><p>Huấn luyện đối kháng giúp ta minh hoạ sức mạnh của việc sử dụng một họ hàm lớn cùng với cơ chế kiểm soát mạnh. Các mô hình thuần túy tuyến tính, như hồi quy logit, không thể chống lại mẫu đối kháng bởi vì chúng bị buộc phải hoạt động một cách tuyến tính. Mạng neuron có thể biểu diễn các hàm số từ gần như tuyến tính tới gần như bất biến cục bộ, và vì vậy chúng có độ mềm dẻo để bắt được các xu hướng tuyến tính trong dữ liệu huấn luyện trong khi vẫn có khả năng học để ngăn chặn sự xáo trộn cục bộ.</p><p>Mẫu đối kháng cũng cung cấp một công cụ để học bán giám sát. Tại điểm dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2449"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2450">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\boldsymbol x</script></span> không có nhãn trong tập dữ liệu, mô hình sẽ tự gán một nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2451"><span class="MJXp-mrow" id="MJXp-Span-2452"><span class="MJXp-munderover" id="MJXp-Span-2453"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2455" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">\hat{y}</script></span> cho nó. Các nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2456"><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-munderover" id="MJXp-Span-2458"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">\hat{y}</script></span> từ mô hình có thể không phải là nhãn đúng, nhưng nếu mô hình có chất lượng tốt thì nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2461"><span class="MJXp-mrow" id="MJXp-Span-2462"><span class="MJXp-munderover" id="MJXp-Span-2463"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">\hat{y}</script></span> có khả năng cao giống với nhãn đúng. Chúng ta có thể tìm kiếm một điểm đối kháng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2466"><span class="MJXp-msup" id="MJXp-Span-2467"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2468" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2469" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">\boldsymbol x'</script></span>  khiến bộ phân lớp dự đoán một nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2470"><span class="MJXp-msup" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2473" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">y'</script></span> sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2474"><span class="MJXp-msup" id="MJXp-Span-2475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476" style="margin-right: 0.05em;">y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2477" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2478" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mrow" id="MJXp-Span-2479"><span class="MJXp-munderover" id="MJXp-Span-2480"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">y' \neq \hat{y}</script></span>. Các mẫu đối kháng được tạo ra bằng cách sử dụng nhãn không phải nhãn thực mà là một nhãn được cung cấp bởi một mô hình đã huấn luyện được gọi là các <em>mẫu đối kháng ảo</em> (virtual adversarial examples) [Miyato et al., 2015]. Sau đó bộ phân lớp có thể sẽ được huấn luyện để gán cùng một nhãn cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2484">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">\boldsymbol x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2485"><span class="MJXp-msup" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2487" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2488" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\boldsymbol x'</script></span>. Điều đó khuyến khích bộ phân lớp học một hàm ổn định với một sự thay đổi nhỏ ở bất cứ đâu dọc theo đa tạp (manifold) mà dữ liệu chưa được gán nhãn nằm trên đó. Giả định thúc đẩy cách tiếp cận này là các lớp khác nhau thường nằm trong các miền đa tạp riêng rẽ và một lượng nhỏ xáo trộn không nên làm các điểm dự liệu nhảy từ lớp đa tạp này sang lớp đa tạp khác.</p><h1 id="714-Khoảng-cách-tiếp-tuyến-lan-truyền-tiếp-tuyến-bộ-phân-loại-tiếp-tuyến-đa-tạp">7.14 Khoảng cách tiếp tuyến, lan truyền tiếp tuyến, bộ phân loại tiếp tuyến đa tạp</h1><p>Nhiều thuật toán học máy hướng đến việc khắc phục hiểm họa số chiều lớn bằng cách giả định rằng dữ liệu nằm gần một đa tạp có số chiều thấp, như được đề cập đến trong phần 5.11.3.</p><p>Một trong những nỗ lực đầu tiên để tận dụng lợi thế của giả thuyết đa tạp là thuật toán <em>khoảng cách tiếp tuyến</em> (tangent distance) [Simard et al., 1993, 1998]. Đây là một thuật toán điểm gần nhất phi tham số, trong đó thước đo được sử dụng không phải là khoảng cách Euclid phổ thông mà là một thang đo bắt nguồn từ hiểu biết về các đa tạp ở gần vùng xác suất tập trung. Kĩ thuật này giả định rằng chúng ta đang cố gắng phân loại các mẫu dữ liệu và các mẫu đều ở trên cùng một đa tạp có cùng chung một danh mục. Vì bộ phân loại nên có tính chất bất biến đối với các biến tố cục bộ tương ứng với chuyển động trên đa tạp, sẽ là hợp lý hơn nếu ta sử dụng khoảng cách <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2489"><span class="MJXp-msubsup" id="MJXp-Span-2490"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2491" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2492" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">\boldsymbol x_1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2493"><span class="MJXp-msubsup" id="MJXp-Span-2494"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2495" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2496" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">\boldsymbol x_2</script></span> dọc theo các đa tạp tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2497"><span class="MJXp-msubsup" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499" style="margin-right: 0.05em;">M</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2500" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">M_1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-msubsup" id="MJXp-Span-2502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503" style="margin-right: 0.05em;">M</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2504" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">M_2</script></span> làm khoảng cách điểm gần nhất. Mặc dù tính các khoảng cách đó có thể là một bài toán khó về mặt tính toán (vì ta sẽ phải giải một bài toán tối ưu để tìm cặp điểm gần nhất trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2505"><span class="MJXp-msubsup" id="MJXp-Span-2506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507" style="margin-right: 0.05em;">M</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2508" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">M_1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2509"><span class="MJXp-msubsup" id="MJXp-Span-2510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511" style="margin-right: 0.05em;">M</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2512" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">M_2</script></span>), một phương án thay thế đơn giản khá hợp lý ở mức cục bộ là xấp xỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-msubsup" id="MJXp-Span-2514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2516" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">M_i</script></span> bằng mặt phẳng tiếp tuyến tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2517"><span class="MJXp-msubsup" id="MJXp-Span-2518"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2519" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2520" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">\boldsymbol {x}_{i}</script></span> và đo khoảng cách giữa hai tiếp tuyến, hoặc giữa một mặt phẳng tiếp tuyến tại một điểm. Tính toán này có thể thực hiện bằng cách giải một hệ phương trình tuyến tính có số chiều thấp (trong chiều của các đa tạp). Tất nhiên, thuật toán này yêu cầu ta phải chỉ định các vector tiếp tuyến.</p><p>Tương tự như vậy, thuật toán <em>lan truyền tiếp tuyến</em> (tangent prop) [Simard et al., 1992] (hình 7.9) huấn luyện một bộ mạng neuron phân loại với một đại lượng phạt bổ sung để khiến cho mỗi đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">f</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2525">x</span><span class="MJXp-mo" id="MJXp-Span-2526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">f(\boldsymbol{x})</script></span> của mạng neuron là bất biến cục bộ với các biến tố đã biết. Những biến tố này tương ứng với chuyển động dọc theo đa tạp gần nơi các mẫu của cùng một lớp tập trung lại. Sự bất biến cục bộ đạt được bằng cách buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2527"><span class="MJXp-msubsup" id="MJXp-Span-2528"><span class="MJXp-mi" id="MJXp-Span-2529" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2530" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2531">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">f</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2534">x</span><span class="MJXp-mo" id="MJXp-Span-2535" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">\nabla _ { \boldsymbol { x } } f ( \boldsymbol { x } )</script></span> phải trực giao với vector tiếp tuyến đa tạp đã biết  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2536"><span class="MJXp-msubsup" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2538" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2539" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2540">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">i</span><span class="MJXp-mo" id="MJXp-Span-2542">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">\boldsymbol { v }^{(i)}</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2544">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">\boldsymbol{x}</script></span>, hoặc tương đương với buộc đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">f</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2548">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\boldsymbol{x}</script></span> theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2549"><span class="MJXp-msubsup" id="MJXp-Span-2550"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2551" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2552" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2553">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">i</span><span class="MJXp-mo" id="MJXp-Span-2555">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\boldsymbol { v } ^ { ( i ) }</script></span> nhỏ bằng cách thêm một đại lượng phạt kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2556"><span class="MJXp-mi" id="MJXp-Span-2557">Ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">\Omega</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2588"><span class="MJXp-mtable" id="MJXp-Span-2589"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2590" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2591" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2592">Ω</span><span class="MJXp-mo" id="MJXp-Span-2593" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594">f</span><span class="MJXp-mo" id="MJXp-Span-2595" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2597"><span><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2599" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2601"><span class="MJXp-mrow" id="MJXp-Span-2602" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2603" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2604"><span class="MJXp-mrow" id="MJXp-Span-2605" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2607"><span class="MJXp-mi" id="MJXp-Span-2608" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2609" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2610">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611">f</span><span class="MJXp-mo" id="MJXp-Span-2612" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2613">x</span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2615" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2616" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2617">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2619" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2620" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2621">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">i</span><span class="MJXp-mo" id="MJXp-Span-2623">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2625" style="vertical-align: 0.82em;"><span class="MJXp-mn" id="MJXp-Span-2626">2</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-244">\Omega( f ) = \sum _ { i } \left( \left( \nabla _ { \boldsymbol { x } } f ( \boldsymbol { x } ) \right) ^ {\intercal  } \boldsymbol { v } ^ { ( i ) } \right) ^ { 2 }  \tag{7.67}</script></span><br>
Bộ kiểm soát này dĩ nhiên có thể được nhân tỷ lệ bởi một siêu tham số thích hợp, và đối với hầu hết các mạng neuron, chúng ta sẽ cộng tổng qua nhiều kết quả đầu ra thay vì chỉ đầu ra đơn lẻ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2628">f</span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2630">x</span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">f(\boldsymbol{x})</script></span> như mô tả ở trên để đơn giản hoá vấn đề. Giống như thuật toán khoảng cách tiếp tuyến, các vector tiếp tuyến được suy ra trước đó, thường là từ những hiểu biết toán học về hiệu ứng của các phép biến đổi như dịch, xoay và nhân tỷ lệ trong hình ảnh. Lan truyền tiếp tuyến đã được sử dụng không chỉ trong học có giám sát [Simard et al., 1992] mà còn trong học củng cố [Thrun, 1995].</p><p><img src="https://i.imgur.com/9pnXdZh.png" alt=""></p><blockquote>
<p><em>Hình 7.9</em>: Minh họa ý tưởng chính của thuật lan truyền tiếp tuyến [Simard et al.,1992] và phân loại tiếp tuyến đa tạp [Rifai et al., 2011c]. Cả hai đều kiểm soát hàm đầu ra của bộ phân loại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2633">f</span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2635">x</span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">f (\boldsymbol{x})</script></span>. Mỗi đường cong biểu thị đa tạp cho một lớp khác, được minh họa ở đây dưới dạng đa tạp một chiều được nhúng trong không gian hai chiều. Trên một đường cong, chúng tôi đã chọn một điểm và vẽ một vector tiếp tuyến với đa tạp của lớp tương ứng (song song và tiếp xúc với đa tạp) và một vector pháp tuyến với đa tạp của lớp (trực giao với đa tạp). Trong nhiều chiều, có thể có nhiều hướng tiếp tuyến và nhiều hướng pháp tuyến. Chúng ta mong đợi hàm phân loại thay đổi nhanh chóng khi nó di chuyển theo hướng vuông góc với đa tạp, và không thay đổi khi nó di chuyển dọc theo lớp đa tạp. Cả quá trình lan truyền tiếp tuyến lẫn bộ phân loại tiếp tuyến đa tạp đều kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">f</span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2640">x</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">f (\boldsymbol{x})</script></span> để nó không thay đổi quá nhiều khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2642"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2643">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">\boldsymbol{x}</script></span> di chuyển dọc theo đa tạp. Lan truyền tiếp tuyến yêu cầu người dùng phải chỉ định các hàm tính toán các hướng tiếp tuyến một cách thủ công (chẳng hạn như quy định rằng một phép dịch ảnh với độ dịch nhỏ vẫn cho ra một ảnh nằm trong cùng một đa tạp của lớp đó) trong khi bộ phân loại tiếp tuyến đa tạp ước lượng các hướng tiếp tuyến đa tạp bằng cách huấn luyện bộ tự mã hóa để khớp dữ liệu huấn luyện. Việc sử dụng bộ tự mã hóa để ước lượng đa tạp sẽ được mô tả trong chương 14.</p>
</blockquote><p>Lan truyền tiếp tuyến liên quan chặt chẽ đến mở rộng dữ liệu. Trong cả hai trường hợp, người sử dụng thuật toán đều mã hóa tri thức tiên nghiệm của mình về tác vụ bằng cách chỉ định một tập các phép biến đổi không làm thay đổi đầu ra của mạng.  Sự khác biệt ở chỗ trong trường hợp mở rộng dữ liệu, mạng được huấn luyện một cách rõ ràng để phân loại chính xác các đầu vào riêng biệt được tạo ra bằng cách áp dụng các phép biến đổi này. Lan truyền tiếp tuyến không yêu cầu truy nhập trực tiếp một điểm đầu vào mới. Thay vào đó, nó kiểm soát mô hình theo kiểu giải tích để chống lại sự nhiễu loạn theo các hướng tương ứng với phép biến đổi được chỉ định. Mặc dù phương pháp giải tích này khá thông minh và đơn giản, nó có hai nhược điểm chính. Đầu tiên, nó chỉ kiểm soát mô hình để chống lại sự nhiễu loạn vô cùng nhỏ. Trực tiếp mở rộng tập dữ liệu tạo ra sức kháng nhiễu lớn hơn. Thứ hai, cách tiếp cận <em>vô cùng nhỏ</em> (infinitesimal) này gây khó khăn cho các mô hình dựa trên các đơn vị tuyến tính hiệu chỉnh. Những mô hình này chỉ có thể thu nhỏ các đạo hàm của chúng bằng cách tắt các đơn vị hoặc giảm trọng số của chúng. Chúng không thể co lại các đạo hàm bằng cách bão hòa ở một giá trị cao với trọng số lớn, như các đơn vị chữ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645">S</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">S</script></span> (sigmoid) hoặc các đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2646"><span class="MJXp-mi" id="MJXp-Span-2647">tanh</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">\tanh</script></span>. Việc mở rộng tập dữ liệu hoạt động tốt với các bộ tuyến tính hiệu chỉnh vì các tập con khác nhau của các đơn vị hiệu chỉnh có thể kích hoạt cho các phiên bản được biến đổi khác nhau của mỗi đầu vào ban đầu.</p><p>Lan truyền tiếp tuyến cũng liên quan đến <em>lan truyền ngược kép</em> (double backprop) [Drucker and LeCun,1992] và huấn luyện đối kháng [zegedy et al., 2014b; Goodfellow et al., 2014b].  Lan truyền ngược kép sẽ kiểm soát ma trận Jacobian để nó trở nên nhỏ, đồng thời huấn luyện đối kháng để tìm các đầu vào mới gần với đầu vào gốc và huấn luyện mô hình để tạo ra cùng một đầu ra cho các đầu vào mới này như đối với đầu vào gốc. Cả hai phương pháp lan truyền tiếp tuyến và mở rộng dữ liệu sử dụng các phép biến đổi được quy định sẵn một cách thủ công và yêu cầu các mô hình cần phải bất biến đối với một số hướng thay đổi cụ thể trên đầu vào. Còn hai phương pháp lan truyền ngược kép và huấn luyện đối kháng đều yêu cầu mô hình được sử dụng bất biến đối với tất cả các hướng thay đổi trong nguồn đầu vào này dù cho sự thay đổi có là nhỏ. Cũng giống như mở rộng tập dữ liệu là phiên bản <em>phi vô cùng nhỏ</em> (non-infinitesimal) của lan truyền tiếp tuyến, huấn luyện đối kháng là phiên bản phi vô cùng nhỏ của di truyền ngược kép.</p><p>Bộ phân loại tiếp tuyến đa tạp [Rifai et al., 2011c] không yêu cầu biết trước các vector tiếp tuyến. Như chúng ta sẽ thấy trong chương 14, các bộ tự mã hoá có thể ước tính được các vector tiếp tuyến đa tạp. Bộ phân loại tiếp tuyến đa tạp sử dụng kỹ thuật này để tránh các vector tiếp tuyến do người dùng tự chỉ định. Như được minh họa trong hình 14.10, các vector tiếp tuyến ước tính này vượt trên các bất biến cổ điển thường thấy trong phép thay đổi hình ảnh (như dịch, xoay và nhân tỷ lệ) và bao gồm các nhân tố cần phải được học ra vì chúng là đặc thù đối tượng (chẳng hạn như chuyển động các bộ phận trên cơ thể). Do đó, thuật toán được đề xuất với bộ phân loại tiếp tuyến đa tạp đơn giản là: (1) sử dụng bộ tự mã hóa để tìm hiểu cấu trúc đa tạp bằng phương pháp học không giám sát, và (2) sử dụng các tiếp tuyến này để kiểm soát bộ phân loại mạng neuron như trong kĩ thuật lan truyền tiếp tuyến (phương trình 7.67).</p><p>Trong chương này, chúng tôi đã mô tả hầu hết các chiến lược chung được sử dụng để kiểm soát mạng neuron. Cơ chế kiểm soát là một chủ đề chính của học máy và do đó sẽ được đề cập lại thường xuyên ở hầu hết các chương tiếp theo. Một chủ đề quan trọng khác của việc học máy là tối ưu hóa, sẽ được đề cập ở chương kế tiếp.</p><hr><p>Người dịch: Phuoc Hau, NguyenTT, Thomas Nguyen, Hung Nguyen FL, Thu Nguyen, Hung Le, Pham Dinh Khanh, LA, Xuan Tu</p></div>