<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-10-Mô-hình-dạng-chuỗi---Mạng-truy-hồi-giai-đoạn-1">Chương 10: Mô hình dạng chuỗi - Mạng truy hồi (giai đoạn 1)</h1><p><em>Mạng neuron truy hồi</em> (recurrent neural network - RNN) [Rumelhart et al., 1986a] là một họ các mạng neuron dùng để xử lý dữ liệu dạng chuỗi (sequential data). Giống như mạng tích chập, một mạng neuron chuyên dụng để xử lý một lưới giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-3">X</span></span></span></span><script type="math/tex" id="MathJax-Element-1">\mathsf{X}</script></span> như hình ảnh, mạng neuron truy hồi là một mạng neuron chuyên dụng để xử lý một chuỗi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4"><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-7" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-8">(</span><span class="MJXp-mn" id="MJXp-Span-9">1</span><span class="MJXp-mo" id="MJXp-Span-10">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-17">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">τ</span><span class="MJXp-mo" id="MJXp-Span-19">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-2">\boldsymbol x^{(1)}, \dots, \boldsymbol x^{(\tau)}</script></span>. Tương tự như khả năng mở rộng chiều rộng và chiều dài hình ảnh và xử lý các ảnh không cùng kích cỡ của mạng tích chập, mạng truy hồi có thể mở rộng chuỗi đầu vào thành những chuỗi dài hơn nhiều so với thực tế, vốn không thể xử lý bằng các mạng không chuyên về xử lý chuỗi. Hầu hết các mạng truy hồi có thể xử lý các chuỗi với độ dài khác nhau.</p><p>Để phát triển mạng đa tầng thành mạng truy hồi, ta cần tận dụng một ý tưởng sơ khởi trong học máy và các mô hình thống kê từ những năm 1980, đó là <em>dùng chung tham số</em> giữa các phần khác nhau của mô hình. Dùng chung tham số giúp ta có thể mở rộng và áp dụng mô hình cho các mẫu huấn luyện có dạng khác nhau (ở đây, các mẫu không cùng độ dài) và tổng quát hóa chúng. Nếu sử dụng các tham số riêng biệt cho từng thời điểm, ta sẽ không thể tổng quát hóa để xử lý  chuỗi có độ dài không xuất hiện trong tập huấn luyện, cũng như không thể chia sẻ cường độ thống kê (statistical strength) giữa các độ dài chuỗi khác nhau và các thời điểm khác nhau. Việc chia sẻ này đặc biệt quan trọng khi một đoạn thông tin nào đó có thể xuất hiện tại nhiều vị trí trong chuỗi. Cùng xem xét hai câu: “Tôi đã đi tới Nepal trong năm 2009” và “Trong năm 2009, tôi đã đi tới Nepal”. Nếu ta yêu cầu mô hình học máy đọc từng câu và lấy ra thời điểm mà người này đi tới Nepal, tức là ta muốn mô hình nhận định được rằng năm 2009 là một đoạn thông tin thích hợp cho câu hỏi trên, dù nó xuất hiện ở vị trí thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mn" id="MJXp-Span-21">6</span></span></span><script type="math/tex" id="MathJax-Element-3">6</script></span> hay thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mn" id="MJXp-Span-23">2</span></span></span><script type="math/tex" id="MathJax-Element-4">2</script></span> trong câu. Giả định rằng ta đang huấn luyện một mạng lan truyền thuận xử lý các câu có độ dài cố định. Một mạng lan truyền thuận kết nối đầy đủ (fully connected feedforward network) truyền thống sẽ có các tham số riêng biệt cho mỗi đặc trưng đầu vào, vì vậy nó cần học tất cả các quy tắc của ngôn ngữ một cách riêng biệt cho từng vị trí trong câu. Còn với mạng neuron truy hồi, nó dùng chung các trọng số qua nhiều bước.</p><p>Một ý tưởng liên quan là sử dụng tích chập qua một chuỗi thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mn" id="MJXp-Span-25">1</span></span></span><script type="math/tex" id="MathJax-Element-5">1</script></span> chiều. Hướng tiếp cận này là nền tảng của các <em>mạng neuron trễ thời gian</em> (time-delay neural network) [Lang and Hinton, 1988; Waibel et al., 1989; Lang et al., 1990]. Phép tích chập cũng cho phép mạng chia sẻ các tham số qua các bước nhưng chỉ trong phạm vi một tầng. Đầu ra của phép tích chập là một chuỗi với mỗi phần tử là một hàm số của một lượng nhỏ các điểm lân cận ở đầu vào. Ý tưởng dùng chung tham số thể hiện trong việc áp dụng cùng một lõi chập tại mỗi bước thời gian. Mạng truy hồi lại chia sẻ tham số theo một cách khác. Mỗi phần tử của đầu ra là một hàm của các phần tử trước đó của đầu ra. Mỗi phần tử của đầu ra được tạo ra bằng cách sử dụng cùng một quy tắc cập nhật được áp dụng cho các đầu ra trước đó. Công thức truy hồi này dẫn đến sự chia sẻ tham số xuyên suốt một đồ thị tính toán rất sâu.</p><p>Để đơn giản, ta xét mạng neuron truy hồi khi thực hiện tính toán trên một chuỗi gồm các vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-29" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-30">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">t</span><span class="MJXp-mo" id="MJXp-Span-32">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-6">\boldsymbol x^{(t)}</script></span> với chỉ số thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">t</span></span></span><script type="math/tex" id="MathJax-Element-7">t</script></span> nằm trong đoạn từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mn" id="MJXp-Span-36">1</span></span></span><script type="math/tex" id="MathJax-Element-8">1</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">τ</span></span></span><script type="math/tex" id="MathJax-Element-9">\tau</script></span>. Trong thực tế, các mạng truy hồi thường tính toán trên lô nhỏ của các chuỗi như vậy, với các độ dài <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">τ</span></span></span><script type="math/tex" id="MathJax-Element-10">\tau</script></span> khác nhau cho mỗi chuỗi trong một lô nhỏ. Chúng tôi bỏ qua chỉ số các lô nhỏ để đơn giản hóa ký hiệu. Hơn nữa, chỉ số thời gian ở đây không thực sự biểu thị thời gian đã trôi qua trong thế giới thực, mà đôi khi nó chỉ đề cập tới vị trí trong chuỗi. Mạng neuron truy hồi cũng có thể áp dụng trong dữ liệu không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mn" id="MJXp-Span-42">2</span></span></span><script type="math/tex" id="MathJax-Element-11">2</script></span> chiều như hình ảnh, và ngay cả khi được áp dụng vào dữ liệu bao gồm thời gian, mạng cũng có thể có những kết nối đi ngược thời gian, miễn là toàn bộ chuỗi được quan sát đầy đủ trước khi đưa nó vào mạng.</p><p>Chương này mở rộng ý tưởng của đồ thị tính toán bằng việc thêm vào chu trình. Các chu trình này đại diện cho sự ảnh hưởng của giá trị hiện tại của một biến lên chính giá trị của nó tại một thời điểm trong tương lai. Các đồ thị tính toán như vậy cho phép ta định nghĩa mạng neuron truy hồi. Tiếp theo, chúng tôi sẽ mô tả một số cách xây dựng, huấn luyện và sử dụng các mạng neuron truy hồi.</p><p>Để xem thêm thông tin về mạng neuron truy hồi bạn có thể tham khảo sách của Graves (2012).</p><h1 id="101-Đồ-thị-tính-toán-trải-dài">10.1 Đồ thị tính toán trải dài</h1><p>Đồ thị tính toán là một phương pháp để biểu diễn cấu trúc của một tập hợp các phép tính toán, chẳng hạn như phép toán được thực hiện trong phép ánh xạ đầu vào cùng với tham số để tạo đầu ra và hàm mất mát. Bạn đọc có thể tham khảo tổng quan chung trong phần 6.5.1. Trong phần này, chúng tôi giải thích ý tưởng của việc <em>trải dài</em> (unfolding) một phép tính truy hồi hoặc đệ quy thành một đồ thị tính toán có một cấu trúc lặp lại, thường tương ứng với một chuỗi sự kiện. Việc trải dài đồ thị này dẫn đến sự chia sẻ các tham số xuyên suô một cấu trúc mạng học sâu.</p><p>Ví dụ, xét dạng cổ điển của một hệ động lực:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-43"><span class="MJXp-mtable" id="MJXp-Span-44"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-45" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-46" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-49" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-50">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">t</span><span class="MJXp-mo" id="MJXp-Span-52">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">f</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-58" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-59">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">t</span><span class="MJXp-mo" id="MJXp-Span-61">−</span><span class="MJXp-mn" id="MJXp-Span-62">1</span><span class="MJXp-mo" id="MJXp-Span-63">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-65">θ</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-12">\boldsymbol s^{(t)} = f(\boldsymbol s^{(t-1)}; \boldsymbol \theta),
\tag{10.1}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-msubsup" id="MJXp-Span-69"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-70" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-71" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-72">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">t</span><span class="MJXp-mo" id="MJXp-Span-74">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol s^{(t)}</script></span> được gọi là trạng thái của hệ.</p><p>Phương trình 10.1 là truy hồi bởi vì định nghĩa của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-76">s</span></span></span><script type="math/tex" id="MathJax-Element-14">\boldsymbol s</script></span> tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">t</span></span></span><script type="math/tex" id="MathJax-Element-15">t</script></span> tham chiếu đến định nghĩa của nó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-80">s</span></span></span><script type="math/tex" id="MathJax-Element-16">\boldsymbol s</script></span> tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">t</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-84">1</span></span></span><script type="math/tex" id="MathJax-Element-17">t-1</script></span>.</p><p>Đối với một số hữu hạn bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">τ</span></span></span><script type="math/tex" id="MathJax-Element-18">\tau</script></span>, đồ thị có thể được trải dài bằng cách lặp lại việc áp dụng định nghĩa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">τ</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-90">1</span></span></span><script type="math/tex" id="MathJax-Element-19">\tau - 1</script></span> lần. Chẳng hạn, nếu ta trải phương trình 10.1 với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">τ</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-94">3</span></span></span><script type="math/tex" id="MathJax-Element-20">\tau = 3</script></span> bước nhảy, ta có:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-95"><span class="MJXp-mtable" id="MJXp-Span-96"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-97" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-98" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-101" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-102">(</span><span class="MJXp-mn" id="MJXp-Span-103">3</span><span class="MJXp-mo" id="MJXp-Span-104">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-105" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-106"></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">f</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-112" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-113">(</span><span class="MJXp-mn" id="MJXp-Span-114">2</span><span class="MJXp-mo" id="MJXp-Span-115">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-117">θ</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-119" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-120" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-121" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-122"></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">f</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">f</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-130" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-131">(</span><span class="MJXp-mn" id="MJXp-Span-132">1</span><span class="MJXp-mo" id="MJXp-Span-133">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-135">θ</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-138">θ</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{align} 
\boldsymbol s^{(3)} &= f(\boldsymbol s^{(2)}; \boldsymbol \theta)\tag{10.2}\\
&= f(f(\boldsymbol s^{(1)}; \boldsymbol \theta); \boldsymbol \theta). \tag{10.3}
\end{align}</script></span></p><p>Việc trải dài phương trình theo cách này tạo ra một biểu thức không mang tính truy hồi. Những biểu thức như vậy khi đó có thể được biểu diễn bằng một đồ thị tính toán có hướng không có chu trình. Đồ thị tính toán của phương trình 10.1 và 10.3 được minh họa trong hình 10.1.</p><p><img src="https://i.imgur.com/inBan7m.png" alt=""></p><blockquote>
<p>Hình 10.1: Hệ động lực cổ điển được mô tả bởi phương trình 10.1, minh họa bằng một đồ thị tính toán trải dài. Mỗi nút đại diện cho một trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">t</span></span></span><script type="math/tex" id="MathJax-Element-22">t</script></span>, và hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">f</span></span></span><script type="math/tex" id="MathJax-Element-23">f</script></span> ánh xạ trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">t</span></span></span><script type="math/tex" id="MathJax-Element-24">t</script></span> tới trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">t</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-150">1</span></span></span><script type="math/tex" id="MathJax-Element-25">t+1</script></span>. Các tham số (giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">θ</span></span></span><script type="math/tex" id="MathJax-Element-26">\theta</script></span> được sử dụng để tham số hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">f</span></span></span><script type="math/tex" id="MathJax-Element-27">f</script></span>) giống nhau được sử dụng tại tất cả các bước.</p>
</blockquote><p>Một ví dụ khác, xét một hệ thống động lực được điều khiển bởi một tín hiệu bên ngoài <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-158" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-159">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">t</span><span class="MJXp-mo" id="MJXp-Span-161">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-28">\boldsymbol x^{(t)}</script></span>,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-162"><span class="MJXp-mtable" id="MJXp-Span-163"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-164" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-165" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-169">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">t</span><span class="MJXp-mo" id="MJXp-Span-171">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">f</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-176" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-177" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-178">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">t</span><span class="MJXp-mo" id="MJXp-Span-180">−</span><span class="MJXp-mn" id="MJXp-Span-181">1</span><span class="MJXp-mo" id="MJXp-Span-182">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-186" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-187">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">t</span><span class="MJXp-mo" id="MJXp-Span-189">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-191">θ</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-29"> \boldsymbol s^{(t)} = f(\boldsymbol s^{(t-1)},\boldsymbol x^{(t)}; \boldsymbol \theta), \tag{10.4}</script></span></p><p>ta thấy rằng trạng thái hiện tại chứa đựng thông tin về toàn bộ chuỗi trước đó.</p><p>Mạng neuron truy hồi có thể được xây dựng bằng nhiều cách khác nhau. Ta đã biết bất kỳ hàm số nào cũng có thể được coi như một mạng neuron lan truyền thuận. Tương tự như vậy, về cơ bản hàm số nào mang tính truy hồi đều có thể được xem như một mạng neuron truy hồi.</p><p>Nhiều mạng neuron truy hồi sử dụng phương trình 10.5 hoặc một phương trình tương tự để xác định giá trị của các đơn vị ẩn. Để thấy rằng trạng thái là đơn vị ẩn của mạng, ta viết lại phương trình 10.4 bằng cách sử dụng biến số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-195">h</span></span></span><script type="math/tex" id="MathJax-Element-30">\boldsymbol h</script></span> để đại diện cho trạng thái,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-196"><span class="MJXp-mtable" id="MJXp-Span-197"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-198" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-199" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-201" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-202" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-203">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">t</span><span class="MJXp-mo" id="MJXp-Span-205">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">f</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-209"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-210" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-211" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-212">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">t</span><span class="MJXp-mo" id="MJXp-Span-214">−</span><span class="MJXp-mn" id="MJXp-Span-215">1</span><span class="MJXp-mo" id="MJXp-Span-216">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-220" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-221">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">t</span><span class="MJXp-mo" id="MJXp-Span-223">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-225">θ</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-31"> \boldsymbol h^{(t)}   = f(\boldsymbol h^{(t-1)},\boldsymbol x^{(t)} ;\boldsymbol \theta), 
\tag{10.5}</script></span></p><p>phương trình này được minh họa trong hình 10.2. Thông thường, mạng neuron truy hồi sẽ bổ sung các đặc trưng về kiến trúc, chẳng hạn như các tầng đầu ra đọc thông tin trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-229">h</span></span></span><script type="math/tex" id="MathJax-Element-32">\boldsymbol h</script></span> để đưa ra dự đoán.</p><p><img src="https://i.imgur.com/slKE7sM.png" alt=""></p><blockquote>
<p>Hình 10.2: Một mạng truy hồi không có đầu ra. Mạng truy hồi này chỉ xử lý thông tin từ đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-231">x</span></span></span><script type="math/tex" id="MathJax-Element-33">\boldsymbol x</script></span> bằng cách đưa nó vào trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-233">h</span></span></span><script type="math/tex" id="MathJax-Element-34">\boldsymbol h</script></span> được truyền thuận theo thời gian. (<em>Hình trái</em>) Biểu đồ dạng chu trình. Ô vuông màu đen đại diện cho độ trễ trong một bước. (<em>Hình phải</em>) Mạng tương tự được biểu diễn dưới dạng đồ thị tính toán trải dài, trong đó mỗi nút tương ứng với một mốc thời gian cụ thể.</p>
</blockquote><p>Khi mạng truy hồi được huấn luyện để thực hiện một tác vụ yêu cầu dự đoán tương lai từ quá khứ, nó thường học cách sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-234"><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-236" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-237" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-238">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">t</span><span class="MJXp-mo" id="MJXp-Span-240">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">\boldsymbol h^{(t)}</script></span> như một bản tóm tắt các yếu tố liên quan đến tác vụ của chuỗi đầu vào từ quá khứ cho đến trước thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">t</span></span></span><script type="math/tex" id="MathJax-Element-36">t</script></span>. Nói chung, bản tóm tắt này thường mất mát thông tin, bởi nó ánh xạ chuỗi có độ dài tùy ý <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-247" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-248">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mo" id="MJXp-Span-250">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-254" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-255">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">t</span><span class="MJXp-mo" id="MJXp-Span-257">−</span><span class="MJXp-mn" id="MJXp-Span-258">1</span><span class="MJXp-mo" id="MJXp-Span-259">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-261"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-262" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-263" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-264">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">t</span><span class="MJXp-mo" id="MJXp-Span-266">−</span><span class="MJXp-mn" id="MJXp-Span-267">2</span><span class="MJXp-mo" id="MJXp-Span-268">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-274" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-275">(</span><span class="MJXp-mn" id="MJXp-Span-276">2</span><span class="MJXp-mo" id="MJXp-Span-277">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-281" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-282">(</span><span class="MJXp-mn" id="MJXp-Span-283">1</span><span class="MJXp-mo" id="MJXp-Span-284">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-37">(\boldsymbol x^{(t)}, \boldsymbol x^{(t-1)}, \boldsymbol x^{(t-2)}, \dots, \boldsymbol x^{(2)}, \boldsymbol x^{(1)})</script></span> tới một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-289" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-290">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">t</span><span class="MJXp-mo" id="MJXp-Span-292">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-38">\boldsymbol h^{(t)}</script></span> độ dài cố định. Tùy vào tiêu chuẩn huấn luyện, bản tóm tắt này có thể chọn lọc để giữ lại một vài yếu tố của chuỗi quá khứ với độ chính xác cao hơn các yếu tố khác. Ví dụ, nếu mạng neuron truy hồi được sử dụng trong tác vụ mô hình hoá ngôn ngữ dựa trên thống kê, thường để dự đoán một từ mới dựa trên các từ cho trước, việc lưu trữ toàn bộ thông tin trong chuỗi đầu vào từ đầu cho đến thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">t</span></span></span><script type="math/tex" id="MathJax-Element-39">t</script></span> có thể là không cần thiết; ta chỉ cần lưu trữ lượng thông tin vừa đủ để dự đoán phần còn lại của chuỗi. Trường hợp đòi hỏi khắt khe nhất đó là trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-295"><span class="MJXp-msubsup" id="MJXp-Span-296"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-297" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-298" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-299">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">t</span><span class="MJXp-mo" id="MJXp-Span-301">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-40">\boldsymbol h^{(t)}</script></span> cần chứa đủ lượng thông tin để cho phép ta phục hồi gần đúng chuỗi đầu vào, giống như đối với bộ tự mã hóa (chương 14).</p><p>Phương trình 10.5 có thể được biểu diễn theo hai cách khác nhau. Cách thứ nhất là vẽ mạng neuron truy hồi bằng một biểu đồ bao gồm một nút cho mỗi thành phần có thể tồn tại trong một triển khai vật lý của mô hình, chẳng hạn như một mạng neuron sinh học. Trong cách nhìn này, mạng được định nghĩa như một chu trình vận hành theo thời gian thực, với các thành phần vật lý mà trạng thái hiện tại của chúng có thể ảnh hưởng đến trạng thái tương lai, giống như minh họa trong hình trái của hình 10.2. Xuyên suốt chương này, chúng tôi sử dụng hình vuông màu đen trong biểu đồ có chu trình để biểu thị một tương tác diễn ra với độ trễ trong một bước thời gian, từ trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">t</span></span></span><script type="math/tex" id="MathJax-Element-41">t</script></span> đến trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-307">1</span></span></span><script type="math/tex" id="MathJax-Element-42">t+1</script></span>. Cách còn lại để thể hiện mạng neuron truy hồi là sử dụng đồ thị tính toán trải dài, trong đó mỗi thành phần được biểu diễn bằng nhiều biến số khác nhau, mỗi biến ứng với một bước thời gian, đại diện cho trạng thái của thành phần tại thời điểm đó. Mỗi biến được vẽ bằng một nút riêng biệt của đồ thị tính toán, như trong hình phải của hình 10.2. Việc trải dài mà ta đề cập là một phép toán ánh xạ một chu trình thành một đồ thị tính toán với những thành phần lặp lại. Kích thước của đồ thị trải dài phụ thuộc vào độ dài chuỗi.</p><p>Ta có thể mô tả tính truy hồi được trải dài sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">t</span></span></span><script type="math/tex" id="MathJax-Element-43">t</script></span> bước bằng một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-313" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-314">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">t</span><span class="MJXp-mo" id="MJXp-Span-316">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-44">g^{(t)}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-317"><span class="MJXp-mtable" id="MJXp-Span-318"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-319" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-320" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-323" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-324">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">t</span><span class="MJXp-mo" id="MJXp-Span-326">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-327" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-328"></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-332" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-333">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">t</span><span class="MJXp-mo" id="MJXp-Span-335">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-339" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-340">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">t</span><span class="MJXp-mo" id="MJXp-Span-342">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-346" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-347">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">t</span><span class="MJXp-mo" id="MJXp-Span-349">−</span><span class="MJXp-mn" id="MJXp-Span-350">1</span><span class="MJXp-mo" id="MJXp-Span-351">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-355" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-356">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">t</span><span class="MJXp-mo" id="MJXp-Span-358">−</span><span class="MJXp-mn" id="MJXp-Span-359">2</span><span class="MJXp-mo" id="MJXp-Span-360">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-364"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-365" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-366" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-367">(</span><span class="MJXp-mn" id="MJXp-Span-368">2</span><span class="MJXp-mo" id="MJXp-Span-369">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-371"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-372" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-373" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-374">(</span><span class="MJXp-mn" id="MJXp-Span-375">1</span><span class="MJXp-mo" id="MJXp-Span-376">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-378" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-379" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-380" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-381"></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">f</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-386" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-387" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-388">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">t</span><span class="MJXp-mo" id="MJXp-Span-390">−</span><span class="MJXp-mn" id="MJXp-Span-391">1</span><span class="MJXp-mo" id="MJXp-Span-392">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-396" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-397">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">t</span><span class="MJXp-mo" id="MJXp-Span-399">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-401">θ</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-45">\begin{align}
\boldsymbol h^{(t)}  &= g^{(t)}(\boldsymbol x^{(t)}, \boldsymbol x^{(t-1)}, \boldsymbol x^{(t-2)}, \dots, \boldsymbol x^{(2)}, \boldsymbol x^{(1)}) 
\tag{10.6}
\\
&= f(\boldsymbol h^{(t-1)},\boldsymbol x^{(t)} ;\boldsymbol \theta), \tag{10.7}
\end{align}</script></span></p><p>Hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-404"><span class="MJXp-msubsup" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-407" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-408">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">t</span><span class="MJXp-mo" id="MJXp-Span-410">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-46">g^{(t)}</script></span> dùng toàn bộ chuỗi quá khứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-413"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-414" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-415" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-416">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">t</span><span class="MJXp-mo" id="MJXp-Span-418">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-422" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-423">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">t</span><span class="MJXp-mo" id="MJXp-Span-425">−</span><span class="MJXp-mn" id="MJXp-Span-426">1</span><span class="MJXp-mo" id="MJXp-Span-427">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-429"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-430" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-431" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-432">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">t</span><span class="MJXp-mo" id="MJXp-Span-434">−</span><span class="MJXp-mn" id="MJXp-Span-435">2</span><span class="MJXp-mo" id="MJXp-Span-436">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-440"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-441" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-442" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-443">(</span><span class="MJXp-mn" id="MJXp-Span-444">2</span><span class="MJXp-mo" id="MJXp-Span-445">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-449" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-450">(</span><span class="MJXp-mn" id="MJXp-Span-451">1</span><span class="MJXp-mo" id="MJXp-Span-452">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-47">(\boldsymbol x^{(t)}, \boldsymbol x^{(t-1)}, \boldsymbol x^{(t-2)}, \dots, \boldsymbol x^{(2)}, \boldsymbol x^{(1)})</script></span> làm đầu vào và xuất ra trạng thái hiện tại, nhưng cấu trúc trải dài cho phép chúng ta phân tách <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-457" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-458">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">t</span><span class="MJXp-mo" id="MJXp-Span-460">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-48">g^{(t)}</script></span> thành một chuỗi các phép toán áp dụng cùng một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">f</span></span></span><script type="math/tex" id="MathJax-Element-49">f</script></span>. Quá trình trải dài nhờ đó mang lại hai lợi thế lớn:</p><ol>
<li>
<p>Bất kể độ dài chuỗi, mô hình sau khi học luôn có kích thước đầu vào giống nhau, bởi vì nó được chỉ định theo sự chuyển tiếp từ một trạng thái sang trạng thái khác, chứ không phải về lịch sử thay đổi độ dài của các trạng thái.</p>
</li>
<li>
<p>Có thể sử dụng <em>cùng</em> một hàm chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">f</span></span></span><script type="math/tex" id="MathJax-Element-50">f</script></span> với tham số giống nhau tại mỗi bước.</p>
</li>
</ol><p>Hai yếu tố này cho phép ta học một mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">f</span></span></span><script type="math/tex" id="MathJax-Element-51">f</script></span> hoạt động trên tất cả các bước thời gian và tất cả độ dài chuỗi, thay vì học một mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-467"><span class="MJXp-msubsup" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-470" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-471">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">t</span><span class="MJXp-mo" id="MJXp-Span-473">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-52">g^{(t)}</script></span> riêng biệt tại mỗi bước. Học một mô hình dùng chung cho phép ta tổng quát hóa đối với các độ dài chuỗi không xuất hiện trong tập huấn luyện, và cho phép ta ước lượng mô hình với số mẫu huấn luyện ít hơn nhiều so với trường hợp không dùng chung tham số.</p><p>Cả đồ thị truy hồi lẫn đồ thị trải dài đều có công dụng riêng của nó. Đồ thị truy hồi ngắn gọn, trong khi đồ thị trải dài mô tả rõ ràng những tính toán cần thực hiện. Đồ thị trải dài cũng giúp minh họa ý tưởng luồng thông tin lan truyền thuận theo thời gian (tính toán đầu ra và hàm mất mát) và ngược theo thời gian (tính toán gradient) bằng cách chỉ ra đường đi của luồng thông tin này một cách rõ ràng.</p><h1 id="102-Các-mạng-neuron-truy-hồi">10.2 Các mạng neuron truy hồi</h1><p>Dựa trên ý tưởng trải dài đồ thị và dùng chung tham số trình bày trong phần 10.1, ta có thể thiết kế nhiều dạng mạng neuron truy hồi.</p><p>Một vài ví dụ về các mô thức thiết kế quan trọng cho các mạng neuron truy hồi có thể kể đến như:</p><ul>
<li>
<p>Mạng truy hồi sinh đầu ra tại mỗi bước thời gian và có các liên kết truy hồi giữa các đơn vị ẩn, được minh họa trong hình 10.3.</p>
</li>
<li>
<p>Mạng truy hồi sinh đầu ra tại mỗi bước thời gian và chỉ có các liên kết truy hồi từ đầu ra tại một thời điểm tới các đơn vị ẩn ở thời điểm kế tiếp, được minh họa trong hình 10.4.</p>
</li>
<li>
<p>Mạng truy hồi với các liên kết truy hồi giữa các đơn vị ẩn. Các mạng này đọc toàn bộ chuỗi và sinh một đầu ra duy nhất, được minh họa trong hình 10.5.</p>
</li>
</ul><p>Hình 10.3 là một ví dụ điển hình mà ta sẽ xem xét suốt phần lớn của chương này.</p><p><img src="https://i.imgur.com/45CuT5V.png" alt=""></p><blockquote>
<p>Hình 10.3: Đồ thị tính toán được sử dụng để tính hàm mất mát trong quá trình huấn luyện của một mạng neuron truy hồi nhận đầu vào là một chuỗi các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-475">x</span></span></span><script type="math/tex" id="MathJax-Element-53">\boldsymbol{x}</script></span> và sinh đầu ra tương ứng là chuỗi các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-477">o</span></span></span><script type="math/tex" id="MathJax-Element-54">\boldsymbol{o}</script></span>. Hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-479">L</span></span></span><script type="math/tex" id="MathJax-Element-55">\boldsymbol{L}</script></span> được dùng để đánh giá sự sai khác của giá trị dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-481">o</span></span></span><script type="math/tex" id="MathJax-Element-56">\boldsymbol{o}</script></span> so với nhãn huấn luyện thực tế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-483">y</span></span></span><script type="math/tex" id="MathJax-Element-57">\boldsymbol{y}</script></span>. Khi sử dụng đầu ra là các softmax, ta giả định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-485">o</span></span></span><script type="math/tex" id="MathJax-Element-58">\boldsymbol{o}</script></span> là logarit của xác suất chưa chuẩn hoá.<br>
Hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">L</span></span></span><script type="math/tex" id="MathJax-Element-59">L</script></span> tính toán giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mrow" id="MJXp-Span-489"><span class="MJXp-munderover" id="MJXp-Span-490"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">x</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">o</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-60">\hat{y} = softmax(o)</script></span> và so sánh nó với nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-505">y</span></span></span><script type="math/tex" id="MathJax-Element-61">\boldsymbol{y}</script></span>. Trong mạng này, kết nối giữa đầu vào với tầng ẩn (input-to-hidden), tầng ẩn với đầu ra (hidden-to-output),  tầng ẩn với tầng ẩn (hidden-to-hidden) được tham số hoá lần lượt bởi các ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-507">U</span></span></span><script type="math/tex" id="MathJax-Element-62">\boldsymbol{U}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-509">W</span></span></span><script type="math/tex" id="MathJax-Element-63">\boldsymbol{W}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-511">V</span></span></span><script type="math/tex" id="MathJax-Element-64">\boldsymbol{V}</script></span>. Phương trình 10.8 xác định quá trình lan truyền thuận trong mô hình này. <em>(Hình trái)</em> Mạng neuron truy hồi và hàm mất mát của nó được minh hoạ bằng các liên kết truy hồi. <em>(Hình phải)</em> Vẫn mạng đó dưới góc nhìn một biểu đồ tính toán trải dài theo thời gian, mỗi nút ứng với một thời điểm cụ thể.</p>
</blockquote><p>Mạng neuron truy hồi mô tả trong hình 10.3 và phương trình 10.8 là một mạng phổ quát, theo nghĩa là bất kỳ hàm số nào có thể tính được bằng một máy Turing thì cũng có thể tính được bằng một mạng truy hồi kích thước hữu hạn. Đầu ra có thể đươc đọc từ mạng neuron truy hồi sau một số lượng bước tiệm cận tuyến tính với số bước mà máy Turing sử dụng và tiệm cận tuyến tính với độ dài của đầu vào [Siegelmann and Sontag, 1991; Siegelmann, 1995; Siegelmann and Sontag, 1995; Hyotyniemi, 1996]. Các hàm số có thể được tính bằng máy Turing là các hàm rời rạc, vì vậy các kết quả này quan tâm đến giá trị chính xác của hàm thay vì giá trị xấp xỉ. Mạng neuron truy hồi khi được sử dụng như một máy Turing sẽ nhận chuỗi nhị phân làm đầu vào, và đầu ra phải được rời rạc hoá để tạo thành các giá trị nhị phân. Khi đó, ta có thể tính toán mọi hàm số kiểu này chỉ với một mạng neuron truy hồi cụ thể có kích thước hữu hạn [Siegelmann và Sontag, 1995] sử dụng 886 đơn vị). “Đầu vào” của máy Turing là một đặc tả của hàm cần tính toán, do đó một mạng tương tự mô phỏng máy Turing này là đủ để giải quyết mọi vấn đề. Mạng neuron truy hồi lý thuyết sử dụng trong chứng minh này có thể mô phỏng một ngăn xếp vô hạn bằng cách biểu diễn các tín hiệu kích hoạt và trọng số của nó bằng các số hữu tỷ có độ chính xác vô hạn.</p><p>Tiếp theo, ta xây dựng các phương trình lan truyền thuận cho mạng neuron truy hồi mô tả trong hình 10.3. Hình 10.3 không chỉ ra hàm kích hoạt cụ thể nào được sử dụng cho các đơn vị ẩn, ở đây chúng tôi giả định sử dụng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">h</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-518">x</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-65">tanh(\boldsymbol{x})</script></span>. Ngoài ra, hình vẽ cũng không chỉ định chính xác dạng hàm mất mát và đầu ra. Ở đây chúng tôi giả sử rằng đầu ra là rời rạc, như trong trường hợp sử dụng mạng neuron truy hồi để dự đoán từ hoặc ký tự. Một phương pháp tự nhiên để biểu diễn các biến rời rạc là coi đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-521">o</span></span></span><script type="math/tex" id="MathJax-Element-66">\boldsymbol{o}</script></span> như là logarit xác suất chưa chuẩn hoá của các giá trị mà biến rời rạc có thể nhận. Sau đó dùng một bước hậu xử lý bằng phép toán softmax để thu được vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mrow" id="MJXp-Span-523"><span class="MJXp-munderover" id="MJXp-Span-524"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-525">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-67">\hat{\boldsymbol{y}}</script></span> biểu thị các xác suất đã chuẩn hoá của đầu ra. Để tính toán lan truyền thuận, trước hết cần phải thiết lập trạng thái ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-msubsup" id="MJXp-Span-528"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-529" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-530" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-531">(</span><span class="MJXp-mn" id="MJXp-Span-532">0</span><span class="MJXp-mo" id="MJXp-Span-533">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-68">\boldsymbol{h}^{(0)}</script></span>. Sau đó, tại mỗi bước từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">t</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-537">1</span></span></span><script type="math/tex" id="MathJax-Element-69">t = 1</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">t</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">τ</span></span></span><script type="math/tex" id="MathJax-Element-70">t = \tau</script></span>, ta áp dụng các công thức cập nhật sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-542"><span class="MJXp-mtable" id="MJXp-Span-543"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-544" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-545" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-548" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-549">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">t</span><span class="MJXp-mo" id="MJXp-Span-551">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-552" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-553"></span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-555">b</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-557">W</span><span class="MJXp-msubsup" id="MJXp-Span-558"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-559" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-560" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-561">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">t</span><span class="MJXp-mo" id="MJXp-Span-563">−</span><span class="MJXp-mn" id="MJXp-Span-564">1</span><span class="MJXp-mo" id="MJXp-Span-565">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-567">U</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-570" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-571">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">t</span><span class="MJXp-mo" id="MJXp-Span-573">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-575" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-576" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-577"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-578" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-579" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-580">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">t</span><span class="MJXp-mo" id="MJXp-Span-582">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-583" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-584"></span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-586">tanh</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-588"><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-590"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-591" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-592" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-593">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">t</span><span class="MJXp-mo" id="MJXp-Span-595">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-598" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-599" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-600"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-601" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-602" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-603">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">t</span><span class="MJXp-mo" id="MJXp-Span-605">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-606" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-607"></span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-609">c</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-611">V</span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-614" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-615">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">t</span><span class="MJXp-mo" id="MJXp-Span-617">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-619" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-620" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mrow" id="MJXp-Span-622" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-623"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-624">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-626" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-627">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">t</span><span class="MJXp-mo" id="MJXp-Span-629">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-630" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-631"></span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-633">softmax</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-637"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-638" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-639" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-640">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">t</span><span class="MJXp-mo" id="MJXp-Span-642">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-71">\begin{align} 
    \boldsymbol{a}^{(t)} &= \boldsymbol{b} + \boldsymbol{W}\boldsymbol{h}^{(t-1)} + \boldsymbol{U} \boldsymbol{x}^{(t)},\tag{10.8}
\\ 
    \boldsymbol{h}^{(t)} & = \tanh \left( \boldsymbol{a}^{(t)} \right), \tag{10.9}\\
    \boldsymbol{o}^{(t)} & = \boldsymbol{c} + \boldsymbol{V}\boldsymbol{h}^{(t)}  \tag{10.10},\\ 
    \hat{\boldsymbol{y}}^{(t)} & = \operatorname{softmax} \left( \boldsymbol{o}^{(t)}
    \right),  \tag{10.11}
\end{align}</script></span></p><p>trong đó tham số là các vector hệ số tự do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-646">b</span></span></span><script type="math/tex" id="MathJax-Element-72">\boldsymbol{b}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-648">c</span></span></span><script type="math/tex" id="MathJax-Element-73">\boldsymbol{c}</script></span>, cùng các ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-650">U</span></span></span><script type="math/tex" id="MathJax-Element-74">\boldsymbol{U}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-652">W</span></span></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol{W}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-654">V</span></span></span><script type="math/tex" id="MathJax-Element-76">\boldsymbol{V}</script></span>, lần lượt là các ma trận liên kết giữa đầu vào với tầng ẩn, tầng ẩn với tầng ẩn và tầng ẩn với đầu ra. Đây là một ví dụ về một mạng truy hồi giúp ánh xạ chuỗi đầu vào thành một chuỗi đầu ra có cùng độ dài. Giá trị hàm mất mát khi đó sẽ là tổng mất mát tại tất cả các bước thời gian. Ví dụ, nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-658" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-659">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">t</span><span class="MJXp-mo" id="MJXp-Span-661">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-77">\boldsymbol{L}^{(t)}</script></span> là số đối của logarit hàm hợp lý của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-665" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-666">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">t</span><span class="MJXp-mo" id="MJXp-Span-668">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-78">y^{(t)}</script></span> khi đã biết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-msubsup" id="MJXp-Span-670"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-671" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-672" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-673">(</span><span class="MJXp-mn" id="MJXp-Span-674">1</span><span class="MJXp-mo" id="MJXp-Span-675">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-681"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-682" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-683" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-684">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">t</span><span class="MJXp-mo" id="MJXp-Span-686">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-79">\boldsymbol{x}^{(1)}, ..., \boldsymbol{x}^{(t)}</script></span>, thì:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-687"><span class="MJXp-mtable" id="MJXp-Span-688"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-689" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-690" style="text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-691" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">L</span><span class="MJXp-mrow" id="MJXp-Span-693"><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mtext" id="MJXp-Span-695">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-697"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-698" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-699" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-700">(</span><span class="MJXp-mn" id="MJXp-Span-701">1</span><span class="MJXp-mo" id="MJXp-Span-702">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-710" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-711">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">τ</span><span class="MJXp-mo" id="MJXp-Span-713">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-719" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-720">(</span><span class="MJXp-mn" id="MJXp-Span-721">1</span><span class="MJXp-mo" id="MJXp-Span-722">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-730" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-731">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">τ</span><span class="MJXp-mo" id="MJXp-Span-733">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-736" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-737" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-738" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-739"></span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-741"><span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-743" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">t</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-747" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-748">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">t</span><span class="MJXp-mo" id="MJXp-Span-750">)</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-751" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-752" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-753" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-754"></span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-757"><span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-759" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">t</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-761">log</span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-763"><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;"><span class="MJXp-mspace" id="MJXp-Span-767" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-768">model</span></span></span><span class="MJXp-mrow" id="MJXp-Span-769"><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-773" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-774">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">t</span><span class="MJXp-mo" id="MJXp-Span-776">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-777"><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-781" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-782" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-783">(</span><span class="MJXp-mn" id="MJXp-Span-784">1</span><span class="MJXp-mo" id="MJXp-Span-785">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-791"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-792" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-793" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-794">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">t</span><span class="MJXp-mo" id="MJXp-Span-796">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-80">\begin{align}
    &L \left( \
\{\boldsymbol{x}^{(1)}, ..., \boldsymbol{x}^{(\tau)}\}, \{\boldsymbol{y}^{(1)},  ..., \boldsymbol{y}^{(\tau)}\} \right)  \tag{10.12} \\
    &= \sum_{t}L^{(t)}  \tag{10.13} \\
    &= - \sum_{t}\log{p_{\,\text{model}} \left( y^{(t)} | \{\boldsymbol{x}^{(1)},...,\boldsymbol{x}^{(t)}\}\right)}  \tag{10.14}
\end{align}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mi" id="MJXp-Span-800">log</span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-802"><span class="MJXp-msubsup" id="MJXp-Span-803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-805" style="vertical-align: -0.4em;"><span class="MJXp-mspace" id="MJXp-Span-806" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-807">model</span></span></span><span class="MJXp-mrow" id="MJXp-Span-808"><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-812" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-813">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">t</span><span class="MJXp-mo" id="MJXp-Span-815">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-816"><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-821" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-822">(</span><span class="MJXp-mn" id="MJXp-Span-823">1</span><span class="MJXp-mo" id="MJXp-Span-824">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-830"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-831" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-832" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-833">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">t</span><span class="MJXp-mo" id="MJXp-Span-835">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-81">\log{p_{\,\text{model}} \left( y^{(t)} | \{\boldsymbol{x}^{(1)},...,\boldsymbol{x}^{(t)}\}\right)}</script></span> là giá trị tương ứng với thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-838"><span class="MJXp-msubsup" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-841" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-842">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">t</span><span class="MJXp-mo" id="MJXp-Span-844">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-82">y^{(t)}</script></span> từ vector đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-msubsup" id="MJXp-Span-846"><span class="MJXp-mrow" id="MJXp-Span-847" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-848"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-849">y</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-851" style="vertical-align: 0.524em;"><span class="MJXp-mo" id="MJXp-Span-852">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">t</span><span class="MJXp-mo" id="MJXp-Span-854">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-83">\hat{\boldsymbol{y}}^{(t)}</script></span> của mô hình. Tính gradient của hàm mất mát này theo các tham số là một phép toán tiêu tốn nhiều tài nguyên. Phép tính gradient này yêu cầu một lần thực hiện lan truyền thuận từ trái sang phải của đồ thị trải dài trong hình 10.3, rồi tiếp tục lan truyền ngược từ phải qua trái đồ thị. Thời gian chạy của thuật toán là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">O</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">τ</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-84">O(\tau)</script></span> và không thể giảm xuống bằng các phép tính toán song song bởi đồ thị lan truyền thuận vốn là chuỗi tuần tự; mỗi bước thời gian chỉ có thể được tính sau bước phía trước nó. Các trạng thái được tính toán trong quá trình lan truyền thuận phải được lưu cho tới khi nó được sử dụng lại trong quá trình lan truyền ngược, vì vậy dung lượng bộ nhớ cần sử dụng cũng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">O</span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">τ</span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-85">O(\tau)</script></span>. Thuật toán lan truyền ngược áp dụng trong đồ thị trải dài với chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">O</span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">τ</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-86">O(\tau)</script></span> được gọi là <em>lan truyền ngược theo thời gian</em> (back-propagation through time - BPTT) và sẽ được thảo luận kỹ hơn trong phần 10.2.2. Do đó, những mạng có tính truy hồi giữa các đơn vị ẩn là rất mạnh mẽ nhưng cũng tiêu tốn nhiều tài nguyên để huấn luyện. Liệu có một giải pháp thay thế nào khác hay không?</p><p><img src="https://i.imgur.com/ILcgqKe.png" alt=""></p><blockquote>
<p>Hình 10.4: Một mạng neuron truy hồi chỉ có liên kết truy hồi từ đầu ra tới tầng ẩn. Tại mỗi bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">t</span></span></span><script type="math/tex" id="MathJax-Element-87">t</script></span>, ta có các đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-msubsup" id="MJXp-Span-873"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-874" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-875" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-88">\boldsymbol{x}_t</script></span>, hàm kích hoạt tại tầng ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-msubsup" id="MJXp-Span-877"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-878" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-879" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-880">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">t</span><span class="MJXp-mo" id="MJXp-Span-882">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-89">\boldsymbol{h}^{(t)}</script></span>, đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-883"><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-885" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-886" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-887">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">t</span><span class="MJXp-mo" id="MJXp-Span-889">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-90">\boldsymbol{o}^{(t)}</script></span>, mục tiêu $\boldsymbol{y}^{(t)} và hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-msubsup" id="MJXp-Span-891"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-892" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-893" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-894">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">t</span><span class="MJXp-mo" id="MJXp-Span-896">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-91">\boldsymbol{L}^{(t)}</script></span> . <em>(Hình trái)</em> Biểu đồ chu trình. <em>(Hình phải)</em> Đồ thị tính toán trải dài. Mạng neuron truy hồi dạng này yếu hơn (theo nghĩa có khả năng thể hiện tập hàm số nhỏ hơn) so với họ mạng neuron truy hồi như trong hình 10.3. Mạng neuron truy hồi biểu diễn trong hình 10.3 có thể lựa chọn đưa bất kỳ thông tin nào nó cần trong quá khứ để đưa vào biểu diễn ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-897"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-898">h</span></span></span><script type="math/tex" id="MathJax-Element-92">\boldsymbol{h}</script></span> và truyền tới tương lai. Mạng neuron truy hồi trong hình này được huấn luyện để đưa một giá trị đầu ra cụ thể vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-900">o</span></span></span><script type="math/tex" id="MathJax-Element-93">\boldsymbol{o}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-902">o</span></span></span><script type="math/tex" id="MathJax-Element-94">\boldsymbol{o}</script></span> là thông tin duy nhất được gửi tới tương lai, mà không có liên kết trực tiếp nào từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-904">h</span></span></span><script type="math/tex" id="MathJax-Element-95">\boldsymbol{h}</script></span> về phía trước. Trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-905"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-906">h</span></span></span><script type="math/tex" id="MathJax-Element-96">\boldsymbol{h}</script></span> ở bước phía trước chỉ được liên kết một cách gián tiếp tới thực tại thông qua những dự đoán được sinh ra dựa trên chính nó. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-908">o</span></span></span><script type="math/tex" id="MathJax-Element-97">\boldsymbol{o}</script></span> thường bị mất những thông tin quan trọng trong quá khứ trừ khi nó được biểu diễn với số chiều lớn và chứa nhiều thông tin. Điều này khiến cho mạng neuron truy hồi dạng này trở nên yếu hơn, tuy rằng huấn luyện nó dễ hơn bởi mỗi bước thời gian được huấn luyện tách biệt với các bước thời gian khác, từ đó tận dụng tốt hơn các phép tính toán song song trong quá trình huấn luyện như đã mô tả trong phần 10.2.1.</p>
</blockquote><p><img src="https://i.imgur.com/dTrSDBX.png" alt=""></p><blockquote>
<p>Hình 10.5: Mạng neuron truy hồi trải dài theo thời gian với một đầu ra duy nhất tại phía cuối của chuỗi. Những mạng neuron truy hồi như vậy có thể tổng hợp một chuỗi và sinh ra một biểu diễn có độ dài cố định được sử dụng làm đầu vào cho những bước xử lý khác. Mạng có thể có một nhãn ở bước cuối cùng (như minh họa trong hình), hoặc gradient đối với đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-912" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-913">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">t</span><span class="MJXp-mo" id="MJXp-Span-915">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol{o}^{(t)}</script></span> có thể thu được qua quá trình lan truyền nghịch từ những module xuôi dòng (downstream) sau đó.</p>
</blockquote><h2 id="1021-Dạy-bắt-buộc-và-các-mạng-với-đầu-ra-truy-hồi">10.2.1 Dạy bắt buộc và các mạng với đầu ra truy hồi</h2><p>Mạng neuron chỉ có liên kết truy hồi từ đầu ra tại một bước thời gian đến đơn vị ẩn tại bước thời gian tiếp theo (như minh hoạ ở hình 10.4) trở nên yếu hơn hẳn vì thiếu đi các liên kết truy hồi giữa các tầng ẩn với nhau. Chẳng hạn như nó không thể mô phỏng một máy Turing phổ quát. Vì mạng này không có tính truy hồi giữa các tầng ẩn, các đơn vị đầu ra cần phải nắm bắt toàn bộ thông tin trong quá khứ mà mạng sẽ dùng để dự đoán các đầu ra ở tương lai. Mặt khác, rõ ràng, các đơn vị đầu ra được huấn luyện để khớp với nhãn trong tập huấn luyện, vì vậy chúng thường không có khả năng nắm bắt được các thông tin cần thiết về quá khứ của đầu vào, trừ khi người dùng biết cách mô tả trạng thái đầy đủ của hệ thống ở từng thời điểm và đưa nó làm một phần của nhãn huấn luyện. Ưu điểm của việc loại bỏ tính truy hồi giữa các tầng ẩn đó là, đối với mọi hàm mất mát dựa trên sự so sánh giữa dự đoán tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">t</span></span></span><script type="math/tex" id="MathJax-Element-99">t</script></span> với nhãn huấn luyện tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">t</span></span></span><script type="math/tex" id="MathJax-Element-100">t</script></span>, các bước thời gian là hoàn toàn riêng biệt. Do đó ta có thể song song hóa quá trình huấn luyện, với gradient ở mỗi thời điểm được tính toán độc lập với nhau. Ta không nhất thiết phải tính toán đầu ra cho bước thời gian liền trước bởi tập huấn luyện sẽ cung cấp giá trị lý tưởng của đầu ra đó.</p><p>Các mô hình có liên kết truy hồi từ đầu ra ngược trở lại mô hình có thể được huấn luyện bằng cách <em>dạy ép buộc</em> (teacher forcing). Dạy ép buộc là một kỹ thuật ra đời dựa trên tiêu chuẩn hợp lý cực đại. Trong quá trình huấn luyện, mô hình sẽ nhận đầu ra thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-920"><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-923" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-924">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">t</span><span class="MJXp-mo" id="MJXp-Span-926">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-101">y^{(t)}</script></span> làm đầu vào tại bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">t</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-930">1</span></span></span><script type="math/tex" id="MathJax-Element-102">t+1</script></span>. Ta có thể nhận thấy điều bằng cách quan sát một chuỗi với hai bước thời gian. Tiêu chuẩn hợp lý cực đại có điều kiện trong trường hợp này:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-931"><span class="MJXp-mtable" id="MJXp-Span-932"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-933" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-934" style="text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-935" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-936">log</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">p</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-940"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-941" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-942" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-943">(</span><span class="MJXp-mn" id="MJXp-Span-944">1</span><span class="MJXp-mo" id="MJXp-Span-945">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-947"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-948" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-949" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-950">(</span><span class="MJXp-mn" id="MJXp-Span-951">2</span><span class="MJXp-mo" id="MJXp-Span-952">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-953">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-954"><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-956" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-957"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-958" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-959" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-960">(</span><span class="MJXp-mn" id="MJXp-Span-961">1</span><span class="MJXp-mo" id="MJXp-Span-962">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-965" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-966" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-967">(</span><span class="MJXp-mn" id="MJXp-Span-968">2</span><span class="MJXp-mo" id="MJXp-Span-969">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-971" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-972" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-973" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-974"></span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-976">log</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">p</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-980"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-981" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-982" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-983">(</span><span class="MJXp-mn" id="MJXp-Span-984">2</span><span class="MJXp-mo" id="MJXp-Span-985">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-986">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-987"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-989" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-990"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-991" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-992" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-993">(</span><span class="MJXp-mn" id="MJXp-Span-994">1</span><span class="MJXp-mo" id="MJXp-Span-995">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-999" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1000">(</span><span class="MJXp-mn" id="MJXp-Span-1001">1</span><span class="MJXp-mo" id="MJXp-Span-1002">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1005" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1006" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1007">(</span><span class="MJXp-mn" id="MJXp-Span-1008">2</span><span class="MJXp-mo" id="MJXp-Span-1009">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1012">log</span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">p</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1017" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1018" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1019">(</span><span class="MJXp-mn" id="MJXp-Span-1020">1</span><span class="MJXp-mo" id="MJXp-Span-1021">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1022">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1023"><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-1025" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1027" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1028" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1029">(</span><span class="MJXp-mn" id="MJXp-Span-1030">1</span><span class="MJXp-mo" id="MJXp-Span-1031">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1034" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1035" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1036">(</span><span class="MJXp-mn" id="MJXp-Span-1037">2</span><span class="MJXp-mo" id="MJXp-Span-1038">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-103">\begin{align}
& \log p(\boldsymbol y^{(1)},\boldsymbol y^{(2)}\ |\,\boldsymbol x^{(1)},\boldsymbol x^{(2)}) \tag{10.15}
\\
&=\log p(\boldsymbol y^{(2)}\ |\,\boldsymbol y^{(1)},\boldsymbol x^{(1)},\boldsymbol x^{(2)})+\log p(\boldsymbol y^{(1)}\ |\,\boldsymbol x^{(1)},\boldsymbol x^{(2)}). \tag{10.16}
\end{align}</script></span></p><p>Trong ví dụ này, dễ thấy tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">t</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1044">2</span></span></span><script type="math/tex" id="MathJax-Element-104">t=2</script></span>, mô hình được huấn luyện để cực đại hóa xác suất có điều kiện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1045"><span class="MJXp-msubsup" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1047" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1048" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1049">(</span><span class="MJXp-mn" id="MJXp-Span-1050">2</span><span class="MJXp-mo" id="MJXp-Span-1051">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-105">\boldsymbol y^{(2)}</script></span> khi đã biết chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1053">x</span></span></span><script type="math/tex" id="MathJax-Element-106">\boldsymbol x</script></span> cho đến thời điểm hiện tại và giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1055">y</span></span></span><script type="math/tex" id="MathJax-Element-107">\boldsymbol y</script></span> tại thời điểm liền trước trong tập huấn luyện. Do đó, giá trị hợp lý cực đại chỉ rõ rằng trong quá trình huấn luyện, thay vì nạp đầu ra của mô hình vào lại chính nó, những liên kết này phải được nạp  các nhãn chỉ định giá trị chính xác của đầu ra. Điều này được minh hoạ trong hình 10.6.</p><p><img src="https://i.imgur.com/ztP1fQr.png" alt=""><br>
~~~Khánh kiến nghị sửa Thời gian huấn luyện, thời gian kiểm thử thành giai đoạn huấn luyện, giai đoạn kiểm thử ~~~</p><blockquote>
<p>Hình 10.6: Minh hoạ kỹ thuật dạy bắt buộc. Dạy bắt buộc là kỹ thuật huấn luyện có thể áp dụng trong mạng neuron truy hồi có liên kết giữa đầu ra và các trạng thái ẩn ở bước thời gian tiếp theo. <em>(Hình trái)</em> Trong giai đoạn huấn luyện, ta cung cấp <em>đầu ra chính xác</em> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1056"><span class="MJXp-msubsup" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1058" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1059" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1060">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">t</span><span class="MJXp-mo" id="MJXp-Span-1062">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-108">\boldsymbol y^{(t)}</script></span> được lấy từ dữ liệu huấn luyện làm đầu vào cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-msubsup" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1065" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1066" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1067">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">t</span><span class="MJXp-mo" id="MJXp-Span-1069">+</span><span class="MJXp-mn" id="MJXp-Span-1070">1</span><span class="MJXp-mo" id="MJXp-Span-1071">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-109">\boldsymbol h^{(t+1)}</script></span>. <em>(Hình phải)</em> Khi triển khai mô hình, ta thường không có thông tin về đầu ra thực sự. Trong trường hợp này, ta có thể xấp xỉ đầu ra thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1072"><span class="MJXp-msubsup" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1074" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1075" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1076">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">t</span><span class="MJXp-mo" id="MJXp-Span-1078">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-110">\boldsymbol y^{(t)}</script></span> từ đầu ra của mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1082" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1083">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">t</span><span class="MJXp-mo" id="MJXp-Span-1085">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-111">\boldsymbol o^{(t)}</script></span> và nạp ngược lại vào mô hình.</p>
</blockquote><p>Ban đầu, ý tưởng dạy bắt buộc được thúc đẩy từ mong muốn tránh sử dụng lan truyền ngược theo thời gian trong các mô hình không có liên kết giữa các tầng ẩn. Dạy ép buộc vẫn có thể áp dụng được ở những mô hình có liên kết giữa các tầng ẩn miễn là chúng có liên kết từ đầu ra tại một bước thời gian tới các giá trị được tính toán trong bước thời gian tiếp theo. Tuy nhiên, khi các đơn vị ẩn trở thành hàm số của các bước thời gian trước đó, ta phải dùng lan truyền ngược theo thời gian. Một vài mô hình do đó có thể được huấn luyện bằng cả hai kỹ thuật dạy bắt buộc và lan truyền ngược theo thời gian.</p><p>Khuyết điểm của dạy bắt buộc cứng nhắc sẽ phát sinh nếu sau đó mạng được sử dụng ở chế độ <em>vòng lặp đóng</em> (closed-loop), tức là đầu ra của mạng (hoặc các mẫu dữ liệu lấy từ phân phối đầu ra) được đưa ngược lại làm đầu vào. Trong trường hợp đó, các đầu vào bị đưa ngược này mà mạng quan sát trong suốt quá trình huấn luyện có thể trở nên khá khác biệt so với đầu vào trong giai đoạn kiểm tra. Một phương pháp để giảm thiểu vấn đề sai số này đó là huấn luyện mô hình với cả đầu vào dạy bắt buộc và đầu vào tự do, chẳng hạn bằng cách dự đoán nhãn chính xác tại một số bước trong tương lai thông qua các đường đi truy hồi trải dài từ đầu ra đến đầu vào. Khi ấy mạng có thể học cách chú ý đến các điều kiện đầu vào mà nó không gặp trong giai đoạn huấn luyện (chẳng hạn như đầu vào mà nó tự sinh ra trong chế độ chạy tự do) và cách ánh xạ một trạng thái ngược về trạng thái phía trước mà nhờ đó sẽ giúp mạng sinh ra các đầu ra phù hợp chỉ sau một vài bước. Một hướng tiếp cận khác [Bengio et al., 2015b] là giảm bớt khoảng cách giữa đầu vào gặp trong giai đoạn huấn luyện và đầu vào gặp trong giai đoạn kiểm thử bằng cách lựa chọn ngẫu nhiên dữ liệu được sinh ra hoặc dữ liệu thực tế làm đầu vào. Hướng tiếp cận này giúp khai thác một chiến lược học giáo trình để dần dần sử dụng nhiều giá trị được sinh ra làm đầu vào hơn.</p><h2 id="1022-Tính-toán-Gradient-trong-mạng-truy-hồi">10.2.2 Tính toán Gradient trong mạng truy hồi</h2><p>Việc tính toán gradient trong mạng truy hồi là rất đơn giản. Ta chỉ cần áp dụng thuật toán lan truyền ngược tổng quát được giới thiệu trong mục 6.5.6 vào đồ thị tính toán trải dài mà không phải cần đến một thuật toán chuyên biệt nào. Các giá trị gradient thu được thông qua bước lan truyền ngược có thể được sử dụng trong bất kì kỹ thuật huấn luyện mạng neuron truy hồi dựa trên gradient nào.</p><p>Để hình dung trực quan hơn về nguyên lý hoạt động của thuật toán lan truyền ngược theo thời gian, chúng tôi đưa ra một ví dụ mà ta tính toán gradient bằng thuật toán lan truyền ngược theo thời gian cho các phương trình trong mạng neuron truy hồi (phương trình 10.8 và 10.12). Các nút trong đồ thị tính toán bao gồm các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1086"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1087">U</span></span></span><script type="math/tex" id="MathJax-Element-112">\boldsymbol U</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1089">V</span></span></span><script type="math/tex" id="MathJax-Element-113">\boldsymbol V</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1091">W</span></span></span><script type="math/tex" id="MathJax-Element-114">\boldsymbol W</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1092"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1093">b</span></span></span><script type="math/tex" id="MathJax-Element-115">\boldsymbol b</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1095">c</span></span></span><script type="math/tex" id="MathJax-Element-116">\boldsymbol c</script></span> và chuỗi các nút được đánh chỉ số theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">t</span></span></span><script type="math/tex" id="MathJax-Element-117">t</script></span>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1098"><span class="MJXp-msubsup" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1100" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1101" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1102">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">t</span><span class="MJXp-mo" id="MJXp-Span-1104">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-118">\boldsymbol x^{(t)}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1108" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1109">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">t</span><span class="MJXp-mo" id="MJXp-Span-1111">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-119">\boldsymbol h^{(t)}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-msubsup" id="MJXp-Span-1113"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1114" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1115" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1116">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">t</span><span class="MJXp-mo" id="MJXp-Span-1118">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-120">\boldsymbol o^{(t)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1122" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1123">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">t</span><span class="MJXp-mo" id="MJXp-Span-1125">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-121">L^{(t)}</script></span>. Với mỗi nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mrow" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-1128">N</span></span></span></span><script type="math/tex" id="MathJax-Element-122">\mathsf{N}</script></span>, ta cần tính gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi" id="MJXp-Span-1131" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1132" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-1133">N</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">L</span></span></span><script type="math/tex" id="MathJax-Element-123">\nabla_\mathsf{N}L</script></span> bằng cách đệ quy dựa trên giá trị gradient tại các nút theo sau nó trong đồ thị. Ta bắt đầu phép đệ quy với các nút nằm ngay phía trước hàm mất mát cuối cùng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1135"><span class="MJXp-mtable" id="MJXp-Span-1136"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1137" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1138" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1139" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1140">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1142">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1145" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1146">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">t</span><span class="MJXp-mo" id="MJXp-Span-1148">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1150">1.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-124">\frac{\partial L}{\partial L^{(t)}}=1. \tag{10.17}</script></span></p><p>Trong biểu thức đạo hàm này, ta giả sử vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-msubsup" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1153" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1154" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1155">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">t</span><span class="MJXp-mo" id="MJXp-Span-1157">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-125">\boldsymbol o^{(t)}</script></span> là đầu vào của hàm softmax để tạo ra vector xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1158"><span class="MJXp-mrow" id="MJXp-Span-1159"><span class="MJXp-munderover" id="MJXp-Span-1160"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1161">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-126">\hat{\boldsymbol y}</script></span> của đầu ra. Đồng thời, ta giả định hàm mất mát là hàm đối của hàm logarit hợp lý của nhãn thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-msubsup" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1166" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1167">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">t</span><span class="MJXp-mo" id="MJXp-Span-1169">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-127">y^{(t)}</script></span> khi biết giá trị các đầu vào cho đến thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">t</span></span></span><script type="math/tex" id="MathJax-Element-128">t</script></span>. Gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1172"><span class="MJXp-msubsup" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1174" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1175" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1176"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1177" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1178" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1179">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">t</span><span class="MJXp-mo" id="MJXp-Span-1181">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">L</span></span></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol\nabla_{\boldsymbol o^{(t)}}L</script></span> của đầu ra tại bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">t</span></span></span><script type="math/tex" id="MathJax-Element-130">t</script></span> với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">i</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">t</span></span></span><script type="math/tex" id="MathJax-Element-131">i, t</script></span>  là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1189"><span class="MJXp-mtable" id="MJXp-Span-1190"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1191" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1192" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1194"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1195" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1196" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1199" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1200">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">t</span><span class="MJXp-mo" id="MJXp-Span-1202">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">L</span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1208" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1209">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1211">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213" style="margin-right: 0.05em;">o</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1215"><span class="MJXp-mo" id="MJXp-Span-1216">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">t</span><span class="MJXp-mo" id="MJXp-Span-1218">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1220" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1221">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1223">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1226" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1227">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">t</span><span class="MJXp-mo" id="MJXp-Span-1229">)</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1230" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1231">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1234" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1235">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">t</span><span class="MJXp-mo" id="MJXp-Span-1237">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1238">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0.05em;">o</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1242"><span class="MJXp-mo" id="MJXp-Span-1243">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">t</span><span class="MJXp-mo" id="MJXp-Span-1245">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mrow" id="MJXp-Span-1248" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1249"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">y</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 1.884em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1253"><span class="MJXp-mo" id="MJXp-Span-1254">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">t</span><span class="MJXp-mo" id="MJXp-Span-1256">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1258"><span class="MJXp-mrow" id="MJXp-Span-1259" style="margin-right: 0.05em;"><span class="MJXp-mn MJXp-bold" id="MJXp-Span-1260">1</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">i</span><span class="MJXp-mo" id="MJXp-Span-1263">=</span><span class="MJXp-msubsup" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1266" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1267">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">t</span><span class="MJXp-mo" id="MJXp-Span-1269">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-132">(\boldsymbol \nabla_{\boldsymbol o^{(t)}}L)_i=\frac{\partial L}{\partial o_i^{(t)}} = \frac{\partial L}{\partial L^{(t)}}\frac{\partial L^{(t)}}{\partial o_i^{(t)}}=\hat y_i^{(t)} - \mathbf{1}_{i= y^{(t)}}.\tag{10.18}</script></span></p><p>Ta lần lượt tính theo hướng ngược từ cuối về đầu. Ở bước thời gian cuối cùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">τ</span></span></span><script type="math/tex" id="MathJax-Element-133">\tau</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1273"><span class="MJXp-msubsup" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1275" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1276" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1277">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">τ</span><span class="MJXp-mo" id="MJXp-Span-1279">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-134">\boldsymbol h^{(\tau)}</script></span> chỉ có một nút con duy nhất là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1280"><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1283" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1284">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">τ</span><span class="MJXp-mo" id="MJXp-Span-1286">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-135">\boldsymbol o^{(\tau)}</script></span>, vì vậy gradient của nó rất đơn giản:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1287"><span class="MJXp-mtable" id="MJXp-Span-1288"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1289" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1290" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1291"><span class="MJXp-mi" id="MJXp-Span-1292" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1293" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1296" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1297">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">τ</span><span class="MJXp-mo" id="MJXp-Span-1299">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">L</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1303" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1304" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1306" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1307" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1309" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1310" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1311">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">τ</span></span></span><span class="MJXp-mo" id="MJXp-Span-1313">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">L</span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-136">\nabla_{\boldsymbol h^{(\tau)}}L= \boldsymbol V^\top\boldsymbol \nabla_{\boldsymbol o^{(\tau})}L. \tag{10.19}</script></span></p><p>Ta tiếp tục lặp lại phép tính ngược để thực hiện lan truyền ngược gradient theo thời gian, từ bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">t</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">τ</span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1321">1</span></span></span><script type="math/tex" id="MathJax-Element-137">t=\tau-1</script></span> về bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">t</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1325">1</span></span></span><script type="math/tex" id="MathJax-Element-138">t=1</script></span>, cần lưu ý rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1329" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1330">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">t</span><span class="MJXp-mo" id="MJXp-Span-1332">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-139">\boldsymbol h^{(t)}</script></span> (với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">t</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">τ</span></span></span><script type="math/tex" id="MathJax-Element-140">t<\tau</script></span>) có hai nút con là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1337"><span class="MJXp-msubsup" id="MJXp-Span-1338"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1339" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1340" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1341">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">t</span><span class="MJXp-mo" id="MJXp-Span-1343">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-141">\boldsymbol o^{(t)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-msubsup" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1346" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1347" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1348">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">t</span><span class="MJXp-mo" id="MJXp-Span-1350">+</span><span class="MJXp-mn" id="MJXp-Span-1351">1</span><span class="MJXp-mo" id="MJXp-Span-1352">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-142">\boldsymbol h^{(t+1)}</script></span>. Vì vậy gradient của nó là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1353"><span class="MJXp-mtable" id="MJXp-Span-1354"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1355" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1356" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1358" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1359" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1362" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1363">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">t</span><span class="MJXp-mo" id="MJXp-Span-1365">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">L</span></span><span class="MJXp-mtd" id="MJXp-Span-1367" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1368"></span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mrow" id="MJXp-Span-1371" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1373" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1374">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1376" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1377" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1378">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">t</span><span class="MJXp-mo" id="MJXp-Span-1380">+</span><span class="MJXp-mn" id="MJXp-Span-1381">1</span><span class="MJXp-mo" id="MJXp-Span-1382">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1383">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1386" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1387">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">t</span><span class="MJXp-mo" id="MJXp-Span-1389">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1391" style="vertical-align: 1.52em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1394" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1395" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1396"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1397" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1398" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1399">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">t</span><span class="MJXp-mo" id="MJXp-Span-1401">+</span><span class="MJXp-mn" id="MJXp-Span-1402">1</span><span class="MJXp-mo" id="MJXp-Span-1403">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">L</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1407"><span class="MJXp-mrow" id="MJXp-Span-1408" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1410" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1411">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1412"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1413" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1414" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1415">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">t</span><span class="MJXp-mo" id="MJXp-Span-1417">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1418">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1421" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1422">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">t</span><span class="MJXp-mo" id="MJXp-Span-1424">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1426" style="vertical-align: 1.52em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1429" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1430" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1432" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1433" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1434">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">t</span><span class="MJXp-mo" id="MJXp-Span-1436">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">L</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1439" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1440" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1441" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1442"></span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1445" style="margin-right: 0.05em;">W</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1446" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mrow" id="MJXp-Span-1447"><span class="MJXp-mrow" id="MJXp-Span-1448"><span class="MJXp-mi" id="MJXp-Span-1449">d</span><span class="MJXp-mi" id="MJXp-Span-1450">i</span><span class="MJXp-mi" id="MJXp-Span-1451">a</span><span class="MJXp-mi" id="MJXp-Span-1452">g</span></span></span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1454"><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1456">1</span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1458"><span class="MJXp-mrow" id="MJXp-Span-1459" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1464">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">t</span><span class="MJXp-mo" id="MJXp-Span-1466">+</span><span class="MJXp-mn" id="MJXp-Span-1467">1</span><span class="MJXp-mo" id="MJXp-Span-1468">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1470" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1474" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1475" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1477" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1478" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1479">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">t</span><span class="MJXp-mo" id="MJXp-Span-1481">+</span><span class="MJXp-mn" id="MJXp-Span-1482">1</span><span class="MJXp-mo" id="MJXp-Span-1483">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">L</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1488" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1489" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1492" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1493" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1495" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1496" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1497">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">t</span><span class="MJXp-mo" id="MJXp-Span-1499">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">L</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-143">\begin{align}
\boldsymbol \nabla_{\boldsymbol h^{(t)}}L&=\left (\frac{\partial \boldsymbol h^{(t+1)}}{\partial \boldsymbol h^{(t)}}\right )^\top(\boldsymbol \nabla_{\boldsymbol h^{(t+1)}}L) +\left (\frac{\partial \boldsymbol o^{(t)}}{\partial \boldsymbol h^{(t)}}\right )^\top(\boldsymbol \nabla_{\boldsymbol o^{(t)}}L) \tag{10.20}
\\
&= \boldsymbol W^\top\mathop{\mathrm{diag}}\left(1 -  {(\boldsymbol h^{(t+1)})}^2 \right )(\boldsymbol \nabla_{\boldsymbol h^{(t+1)}}L) + \boldsymbol V^\top( \boldsymbol \nabla_{\boldsymbol o^{(t)}}L),\tag{10.21}
\end{align}</script></span></p><p>Với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1503"><span class="MJXp-mrow" id="MJXp-Span-1504"><span class="MJXp-mi" id="MJXp-Span-1505">d</span><span class="MJXp-mi" id="MJXp-Span-1506">i</span><span class="MJXp-mi" id="MJXp-Span-1507">a</span><span class="MJXp-mi" id="MJXp-Span-1508">g</span></span><span class="MJXp-mrow" id="MJXp-Span-1509"><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1511">1</span><span class="MJXp-mo" id="MJXp-Span-1512" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1513"><span class="MJXp-mrow" id="MJXp-Span-1514" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1516"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1517" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1518" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1519">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">t</span><span class="MJXp-mo" id="MJXp-Span-1521">+</span><span class="MJXp-mn" id="MJXp-Span-1522">1</span><span class="MJXp-mo" id="MJXp-Span-1523">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1525" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-144">\mathrm{diag}\left( 1 -  \left(\boldsymbol h^{(t+1)}\right)^2\right)</script></span> là ma trận đường chéo với các phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1527"><span class="MJXp-mn" id="MJXp-Span-1528">1</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mrow" id="MJXp-Span-1531" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1536"><span class="MJXp-mo" id="MJXp-Span-1537">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">t</span><span class="MJXp-mo" id="MJXp-Span-1539">+</span><span class="MJXp-mn" id="MJXp-Span-1540">1</span><span class="MJXp-mo" id="MJXp-Span-1541">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1543" style="vertical-align: 0.82em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-145">1 - \left(h_i^{(t+1)}\right)^2</script></span> nằm trên đường chéo chính. Đây là định thức Jacobi của hàm tang hyperbolic ứng với đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">i</span></span></span><script type="math/tex" id="MathJax-Element-146">i</script></span> ở thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">t</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span></span></span><script type="math/tex" id="MathJax-Element-147">t+1</script></span>.</p><p>Khi đã tính được gradient tại các nút trong của đồ thị tính toán, ta có thể thu được gradient tại các nút tham số. Do tham số được dùng chung qua nhiều bước thời gian, ta cần phải cẩn thận khi thực hiện các phép toán vi tích phân liên quan đến các biến này. Các phương trình ta muốn thực hiện sử dụng phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1550"><span class="MJXp-mrow" id="MJXp-Span-1551"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1552">bprop</span></span></span></span><script type="math/tex" id="MathJax-Element-148">\texttt{bprop}</script></span> ở phần 6.5.6; phương thức này sẽ tính toán đóng góp của một cạnh đơn lẻ trong đồ thị tính toán đối với gradient. Tuy nhiên, toán tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi" id="MJXp-Span-1555" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;">W</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">f</span></span></span><script type="math/tex" id="MathJax-Element-149">\nabla_\boldsymbol{W} f</script></span> được sử dụng trong phép vi tích phân lại tính đến đóng góp của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1559">W</span></span></span><script type="math/tex" id="MathJax-Element-150">\boldsymbol W</script></span> đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">f</span></span></span><script type="math/tex" id="MathJax-Element-151">f</script></span> dựa trên <em>tất cả</em> các cạnh trong đồ thị tính toán. Để giải quyết vấn đề nhập nhằng này, ta sử dụng một biến giả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1562"><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1565" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1566">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">t</span><span class="MJXp-mo" id="MJXp-Span-1568">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-152">\boldsymbol W^{(t)}</script></span> được định nghĩa như là một bản sao của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1570">W</span></span></span><script type="math/tex" id="MathJax-Element-153">\boldsymbol W</script></span> nhưng mỗi biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1571"><span class="MJXp-msubsup" id="MJXp-Span-1572"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1573" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1574" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1575">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">t</span><span class="MJXp-mo" id="MJXp-Span-1577">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-154">\boldsymbol W^{(t)}</script></span> chỉ được sử dụng tại bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">t</span></span></span><script type="math/tex" id="MathJax-Element-155">t</script></span>. Như vậy, ta có thể sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1580"><span class="MJXp-msubsup" id="MJXp-Span-1581"><span class="MJXp-mi" id="MJXp-Span-1582" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1583" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1586" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1587">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">t</span><span class="MJXp-mo" id="MJXp-Span-1589">)</span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-156">\nabla_{\boldsymbol{W}^{(t)}}</script></span> để biễu thị cho đóng góp của các trọng số đối với gradient tại bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">t</span></span></span><script type="math/tex" id="MathJax-Element-157">t</script></span>.</p><p>Sử dụng cách ký hiệu này, gradient trên các tham số còn lại được tính bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1592"><span class="MJXp-mtable" id="MJXp-Span-1593"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1594" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1595" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi" id="MJXp-Span-1597" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1599">c</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">L</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1602"><span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604" style="margin-left: 0px;">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mrow" id="MJXp-Span-1606" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1608" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1609">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1612" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1613">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">t</span><span class="MJXp-mo" id="MJXp-Span-1615">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1616">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1617">c</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1619" style="vertical-align: 1.52em;"><span class="MJXp-mi" id="MJXp-Span-1620">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi" id="MJXp-Span-1622" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1623" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1624"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1625" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1626" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1627">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">t</span><span class="MJXp-mo" id="MJXp-Span-1629">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">L</span><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1632"><span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634" style="margin-left: 0px;">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1635"><span class="MJXp-mi" id="MJXp-Span-1636" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1637" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1639" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1640" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1641">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">t</span><span class="MJXp-mo" id="MJXp-Span-1643">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">L</span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-158">\nabla_{\boldsymbol c} L = \sum_t\left( \frac{\partial\boldsymbol o^{(t)}}{\partial \boldsymbol c} \right)^{\top} \nabla_{\boldsymbol o^{(t)}} L = \sum_t \nabla_{\boldsymbol o^{(t)}} L, \tag{10.22}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1646"><span class="MJXp-mtable" id="MJXp-Span-1647"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1648" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1649" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1650"><span class="MJXp-mi" id="MJXp-Span-1651" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1652" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1653">b</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">L</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1656"><span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658" style="margin-left: 0px;">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1659"><span class="MJXp-mrow" id="MJXp-Span-1660" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1662" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1663">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1664"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1665" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1666" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1667">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">t</span><span class="MJXp-mo" id="MJXp-Span-1669">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1670">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1671"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1672" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1673" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1674">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">t</span><span class="MJXp-mo" id="MJXp-Span-1676">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1678" style="vertical-align: 1.52em;"><span class="MJXp-mi" id="MJXp-Span-1679">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1680"><span class="MJXp-mi" id="MJXp-Span-1681" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1682" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1683"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1684" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1685" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1686">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">t</span><span class="MJXp-mo" id="MJXp-Span-1688">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">L</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1691"><span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693" style="margin-left: 0px;">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1694"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1695">diag</span></span><span class="MJXp-mrow" id="MJXp-Span-1696"><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1698">1</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1700"><span class="MJXp-mrow" id="MJXp-Span-1701" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1703"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1704" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1705" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1706">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">t</span><span class="MJXp-mo" id="MJXp-Span-1708">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1710" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mi" id="MJXp-Span-1713" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1714" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1715"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1716" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1717" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1718">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">t</span><span class="MJXp-mo" id="MJXp-Span-1720">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">L</span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-159">\nabla_{\boldsymbol b} L = \sum_t\left ( \frac{\partial\boldsymbol h^{(t)}}{\partial \boldsymbol b^{(t)}}\right )^{\top} \nabla_{\boldsymbol h^{(t)}} L = \sum_t \texttt{diag}\left (1-\left(\boldsymbol h ^{(t)}\right)^2\right )\nabla_{\boldsymbol h^{(t)}}L,\tag{10.23}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1723"><span class="MJXp-mtable" id="MJXp-Span-1724"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1725" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1726" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1727"><span class="MJXp-mi" id="MJXp-Span-1728" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1729" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1730">V</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">L</span><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1733"><span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-left: 0px;">t</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1736"><span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1739"><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1741" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1742">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1744">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746" style="margin-right: 0.05em;">o</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1748"><span class="MJXp-mo" id="MJXp-Span-1749">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">t</span><span class="MJXp-mo" id="MJXp-Span-1751">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1753"><span class="MJXp-mi" id="MJXp-Span-1754" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1755" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1756"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1757" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1758" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1759">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">t</span><span class="MJXp-mo" id="MJXp-Span-1761">)</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763" style="margin-right: 0.05em;">o</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1765"><span class="MJXp-mo" id="MJXp-Span-1766">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">t</span><span class="MJXp-mo" id="MJXp-Span-1768">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1770"><span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772" style="margin-left: 0px;">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1774"><span class="MJXp-mi" id="MJXp-Span-1775" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1776" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1777"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1778" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1779" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1780">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">t</span><span class="MJXp-mo" id="MJXp-Span-1782">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">L</span><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1785"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1786" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1787" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1788">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">t</span><span class="MJXp-msubsup" id="MJXp-Span-1790"><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1792" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1793" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-160">\nabla_{\boldsymbol V} L = \sum_t\sum_i\left ( \frac{\partial L}{\partial o_i^{(t)}}\right ) \nabla_{\boldsymbol V^{(t)}} o^{(t)}_i = \sum_t (\nabla_{\boldsymbol o^{(t)}}L)\boldsymbol h^{(t)^\top},\tag{10.24}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1794"><span class="MJXp-mtable" id="MJXp-Span-1795"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1796" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1797" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi" id="MJXp-Span-1799" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1800" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1801">W</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">L</span></span><span class="MJXp-mtd" id="MJXp-Span-1803" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1804"></span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1806"><span><span class="MJXp-mo" id="MJXp-Span-1807" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808" style="margin-left: 0px;">t</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1809"><span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1812"><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1814" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1815">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1817">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1821"><span class="MJXp-mo" id="MJXp-Span-1822">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">t</span><span class="MJXp-mo" id="MJXp-Span-1824">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1826"><span class="MJXp-mi" id="MJXp-Span-1827" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1828" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1829"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1830" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1831" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1832">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">t</span><span class="MJXp-mo" id="MJXp-Span-1834">)</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1838"><span class="MJXp-mo" id="MJXp-Span-1839">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">t</span><span class="MJXp-mo" id="MJXp-Span-1841">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">i</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1842" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1843" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1844" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1845"></span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1847"><span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849" style="margin-left: 0px;">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1850"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1851">diag</span></span><span class="MJXp-mrow" id="MJXp-Span-1852"><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1854">1</span><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1856"><span class="MJXp-mrow" id="MJXp-Span-1857" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1860" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1861" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1862">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">t</span><span class="MJXp-mo" id="MJXp-Span-1864">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1866" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1869"><span class="MJXp-mi" id="MJXp-Span-1870" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1871" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1872"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1873" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1874" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1875">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">t</span><span class="MJXp-mo" id="MJXp-Span-1877">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">L</span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1882" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1883">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">t</span><span class="MJXp-mo" id="MJXp-Span-1885">−</span><span class="MJXp-mn" id="MJXp-Span-1886">1</span><span class="MJXp-msubsup" id="MJXp-Span-1887"><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1889" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-161">\begin{align*}\nabla_{\boldsymbol W} L
 &= \sum_t\sum_i\left ( \frac{\partial L}{\partial h_i^{(t)}} \right )\nabla_{\boldsymbol W^{(t)}} h^{(t)}_i\tag{10.25}\\
 &= \sum_t\texttt{diag}\left ( 1 - \left (\boldsymbol h^{(t)} \right )^2\right ) (\nabla_{\boldsymbol h^{(t)}}L)h^{(t-1)^\top},\tag{10.26}
\end{align*}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1891"><span class="MJXp-mtable" id="MJXp-Span-1892"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1893" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1894" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1895"><span class="MJXp-mi" id="MJXp-Span-1896" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1897" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1898">U</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899">L</span></span><span class="MJXp-mtd" id="MJXp-Span-1900" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1901"></span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1903"><span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905" style="margin-left: 0px;">t</span></span></span><span class="MJXp-munderover" id="MJXp-Span-1906"><span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1909"><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1911" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1912">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">L</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1914">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1918"><span class="MJXp-mo" id="MJXp-Span-1919">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">t</span><span class="MJXp-mo" id="MJXp-Span-1921">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">i</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.867em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.467em; margin-left: -0.21em;">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1923"><span class="MJXp-mi" id="MJXp-Span-1924" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1925" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1926"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1927" style="margin-right: 0.05em;">U</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1928" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1929">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">t</span><span class="MJXp-mo" id="MJXp-Span-1931">)</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1935"><span class="MJXp-mo" id="MJXp-Span-1936">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">t</span><span class="MJXp-mo" id="MJXp-Span-1938">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">i</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1939" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1940" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1941" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1942"></span><span class="MJXp-mo" id="MJXp-Span-1943" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1944"><span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946" style="margin-left: 0px;">t</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1947"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1948">diag</span></span><span class="MJXp-mrow" id="MJXp-Span-1949"><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1951">1</span><span class="MJXp-mo" id="MJXp-Span-1952" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1953"><span class="MJXp-mrow" id="MJXp-Span-1954" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-1956"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1957" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1958" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1959">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">t</span><span class="MJXp-mo" id="MJXp-Span-1961">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1963" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1964" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.467em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.867em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1966"><span class="MJXp-mi" id="MJXp-Span-1967" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1968" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1970" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1971" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1972">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">t</span><span class="MJXp-mo" id="MJXp-Span-1974">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">L</span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1977"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1978" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1979" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1980">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">t</span><span class="MJXp-msubsup" id="MJXp-Span-1982"><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1984" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-162">\begin{align*}\nabla_{\boldsymbol U}L
 &= \sum_t\sum_i\left (\frac{\partial L}{\partial h^{(t)}_i} \right )\nabla_{\boldsymbol U ^{(t)}}h^{(t)}_i\tag{10.27}\\ 
 &= \sum_t\texttt{diag}\left(1-\left(\boldsymbol h^{(t)} \right )^2 \right )(\nabla_{\boldsymbol{h}^{(t)}} L)\boldsymbol x^{(t)^\top}.\tag{10.28}
\end{align*}</script></span></p><p>Chúng ta không cần tính toán giá trị gradient đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1986"><span class="MJXp-msubsup" id="MJXp-Span-1987"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1988" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1989" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1990">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">t</span><span class="MJXp-mo" id="MJXp-Span-1992">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol x^{(t)}</script></span> trong quá trình huấn luyện bởi nó không có bất kì nút cha nào nào trong đồ thị tính toán là các tham số xác định giá trị hàm mất mát.</p><h2 id="1023-Mạng-truy-hồi-dưới-dạng-các-mô-hình-đồ-thị-xác-suất">10.2.3 Mạng truy hồi dưới dạng các mô hình đồ thị xác suất</h2><p>Trong ví dụ về mạng truy hồi ta đưa ra ở trên, hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1993"><span class="MJXp-msubsup" id="MJXp-Span-1994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1996" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1997">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">t</span><span class="MJXp-mo" id="MJXp-Span-1999">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-164">L^{(t)}</script></span> là entropy chéo giữa mục tiêu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2000"><span class="MJXp-msubsup" id="MJXp-Span-2001"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2002" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2003" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2004">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">t</span><span class="MJXp-mo" id="MJXp-Span-2006">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-165">\boldsymbol y^{(t)}</script></span> và đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2007"><span class="MJXp-msubsup" id="MJXp-Span-2008"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2009" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2010" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2011">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">t</span><span class="MJXp-mo" id="MJXp-Span-2013">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-166">\boldsymbol o^{(t)}</script></span>. Giống như đối với mạng lan truyền thuận, về nguyên tắc, phần lớn các dạng hàm mất mát đều có thể được sử dụng cho mạng truy hồi và nó sẽ được lựa chọn tuỳ theo tác vụ ta cần thực hiện. Trong mạng lan truyền thuận, ta thường muốn coi đầu ra của mạng neuron truy hồi là một phân phối xác suất, và ta thường sử dụng entropy chéo ứng với phân phối đó để xác định hàm mất mát. Bình phương sai số trung bình là hàm mất mát tính bằng entropy chéo ứng với với một phân phối của đầu ra là một đơn vị Gauss, giống như trong một mạng lan truyền thuận.</p><p>Khi sử dụng hàm mục tiêu dự đoán là logarit hàm hợp lý, ví dụ như trong biểu thức 10.12, ta huấn luyện một mạng neuron truy hồi để ước lượng phân phối có điều kiện của phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2014"><span class="MJXp-msubsup" id="MJXp-Span-2015"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2016" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2017" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2018">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">t</span><span class="MJXp-mo" id="MJXp-Span-2020">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-167">\boldsymbol y^{(t)}</script></span> tiếp theo khi có các đầu vào trong quá khứ. Có thể hiểu là ta đang cực đại hóa logarit hàm hợp lý<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2021"><span class="MJXp-mtable" id="MJXp-Span-2022"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2023" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2024" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2025">log</span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">p</span><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2030" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2031" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2032">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">t</span><span class="MJXp-mo" id="MJXp-Span-2034">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2035">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2036"><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2038">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2040" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2041" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2042">(</span><span class="MJXp-mn" id="MJXp-Span-2043">1</span><span class="MJXp-mo" id="MJXp-Span-2044">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2045" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2047" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2050"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2051" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2052" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2053">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">t</span><span class="MJXp-mo" id="MJXp-Span-2055">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2057" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-168">\log p(\boldsymbol y^{(t)}\ |\ \boldsymbol x^{(1)},...,\boldsymbol x^{(t)}),\tag{10.29}</script></span></p><p>hoặc, nếu mô hình có liên kết từ đầu ra tại một bước thời gian tới bước thời gian tiếp theo, thì hàm mục tiêu của ta khi đó như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2058"><span class="MJXp-mtable" id="MJXp-Span-2059"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2060" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2061" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2062">log</span><span class="MJXp-mo" id="MJXp-Span-2063" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">p</span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2066"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2067" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2068" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2069">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">t</span><span class="MJXp-mo" id="MJXp-Span-2071">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2072">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2073"><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2075">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2077" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2078" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2079">(</span><span class="MJXp-mn" id="MJXp-Span-2080">1</span><span class="MJXp-mo" id="MJXp-Span-2081">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2086" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2087"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2088" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2089" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2090">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">t</span><span class="MJXp-mo" id="MJXp-Span-2092">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2093" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2094"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2095" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2096" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2097">(</span><span class="MJXp-mn" id="MJXp-Span-2098">1</span><span class="MJXp-mo" id="MJXp-Span-2099">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2100" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2105"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2106" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2107" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2108">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">t</span><span class="MJXp-mo" id="MJXp-Span-2110">−</span><span class="MJXp-mn" id="MJXp-Span-2111">1</span><span class="MJXp-mo" id="MJXp-Span-2112">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-169">\log p(\boldsymbol y^{(t)}\ |\ \boldsymbol x^{(1)},...,\boldsymbol x^{(t)},\boldsymbol y^{(1)},...,\boldsymbol y^{(t-1)}).\tag{10.30}</script></span></p><p>Phân tách xác suất đồng thời của chuỗi các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2115"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2116">y</span></span></span><script type="math/tex" id="MathJax-Element-170">\boldsymbol y</script></span> thành một chuỗi dự đoán xác suất qua từng bước là một cách để nắm bắt đầy đủ phân phối đồng thời của toàn bộ chuỗi. Khi các giá trị quá khứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2117"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2118">y</span></span></span><script type="math/tex" id="MathJax-Element-171">\boldsymbol y</script></span> không được sử dụng làm đầu vào như điều kiện dự đoán ở bước tiếp theo, mô hình đồ thị xác suất không bao gồm cạnh nào từ bất kì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2119"><span class="MJXp-msubsup" id="MJXp-Span-2120"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2121" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2122" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2123">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">i</span><span class="MJXp-mo" id="MJXp-Span-2125">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-172">\boldsymbol y^{(i)}</script></span> trong quá khứ đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2126"><span class="MJXp-msubsup" id="MJXp-Span-2127"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2128" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2129" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2130">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">t</span><span class="MJXp-mo" id="MJXp-Span-2132">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-173">\boldsymbol y^{(t)}</script></span> ở hiện tại. Trong trường hợp này, đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">y</span></span></span><script type="math/tex" id="MathJax-Element-174">y</script></span> là độc lập có điều kiện khi được cho chuỗi các giá trị đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2136">x</span></span></span><script type="math/tex" id="MathJax-Element-175">\boldsymbol x</script></span>. Khi các giá trị thực tế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2137"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2138">y</span></span></span><script type="math/tex" id="MathJax-Element-176">\boldsymbol y</script></span> (không phải các giá trị dự đoán mà là dữ liệu được quan sát hoặc sinh ra thật sự) được đưa trở lại mạng, mô hình đồ thị xác suất lúc này bao gồm các cạnh từ tất cả giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2139"><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2141" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2142" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2143">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">i</span><span class="MJXp-mo" id="MJXp-Span-2145">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-177">\boldsymbol y^{(i)}</script></span> trong quá khứ đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2146"><span class="MJXp-msubsup" id="MJXp-Span-2147"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2148" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2149" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2150">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">t</span><span class="MJXp-mo" id="MJXp-Span-2152">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-178">\boldsymbol y^{(t)}</script></span> ở hiện tại.</p><p>Xet một ví dụ đơn giản trong đó mạng neuron truy hồi chỉ mô phỏng một chuỗi các biến ngẫu nhiên vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2153"><span class="MJXp-mrow" id="MJXp-Span-2154"><span class="MJXp-mi undefined" id="MJXp-Span-2155">Y</span></span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2157" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-2158"><span class="MJXp-mrow" id="MJXp-Span-2159" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2160">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2161" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2162">(</span><span class="MJXp-mn" id="MJXp-Span-2163">1</span><span class="MJXp-mo" id="MJXp-Span-2164">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2168" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2170"><span class="MJXp-mrow" id="MJXp-Span-2171" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2172">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2173" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2174">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">τ</span><span class="MJXp-mo" id="MJXp-Span-2176">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-179">\mathbb{Y} = \{\mathrm{y}^{(1)},..., \mathrm{y}^{(\tau)}\}</script></span> và không có thêm đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2178"><span class="MJXp-mrow" id="MJXp-Span-2179"><span class="MJXp-mi" id="MJXp-Span-2180">x</span></span></span></span><script type="math/tex" id="MathJax-Element-180">\mathrm{x}</script></span>. Đầu vào ở bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">t</span></span></span><script type="math/tex" id="MathJax-Element-181">t</script></span> chỉ đơn giản là đầu ra ở bước thời gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">t</span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2186">1</span></span></span><script type="math/tex" id="MathJax-Element-182">t-1</script></span>. Mô hình mạng neuron truy hồi sau đó sẽ xác định một mô hình đồ thị xác suất của các biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2187"><span class="MJXp-mrow" id="MJXp-Span-2188"><span class="MJXp-mi" id="MJXp-Span-2189">y</span></span></span></span><script type="math/tex" id="MathJax-Element-183">\mathrm{y}</script></span>. Phân phối đồng thời của các quan sát này có thể được tham số hoá bằng cách sử dụng quy tắc chuỗi (phương trình 3.6) cho các xác suất có điều kiện:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2190"><span class="MJXp-mtable" id="MJXp-Span-2191"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2192" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2193" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">P</span><span class="MJXp-mo" id="MJXp-Span-2195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2196"><span class="MJXp-mi undefined" id="MJXp-Span-2197">Y</span></span><span class="MJXp-mo" id="MJXp-Span-2198" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">P</span><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mrow" id="MJXp-Span-2203" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2204">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2205" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2206">(</span><span class="MJXp-mn" id="MJXp-Span-2207">1</span><span class="MJXp-mo" id="MJXp-Span-2208">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2210" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2214"><span class="MJXp-mrow" id="MJXp-Span-2215" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2216">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2217" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2218">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">τ</span><span class="MJXp-mo" id="MJXp-Span-2220">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2223"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229" style="margin-right: 0px; margin-left: 0px;">τ</span></span><span><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2225" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">t</span><span class="MJXp-mo" id="MJXp-Span-2227">=</span><span class="MJXp-mn" id="MJXp-Span-2228">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">P</span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2232"><span class="MJXp-mrow" id="MJXp-Span-2233" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2234">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2235" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2236">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">t</span><span class="MJXp-mo" id="MJXp-Span-2238">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2239"><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2241" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mrow" id="MJXp-Span-2243" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2244">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2245" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2246">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">t</span><span class="MJXp-mo" id="MJXp-Span-2248">−</span><span class="MJXp-mn" id="MJXp-Span-2249">1</span><span class="MJXp-mo" id="MJXp-Span-2250">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2252"><span class="MJXp-mrow" id="MJXp-Span-2253" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2254">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2255" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2256">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">t</span><span class="MJXp-mo" id="MJXp-Span-2258">−</span><span class="MJXp-mn" id="MJXp-Span-2259">2</span><span class="MJXp-mo" id="MJXp-Span-2260">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2261" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2265"><span class="MJXp-mrow" id="MJXp-Span-2266" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2267">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2268" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2269">(</span><span class="MJXp-mn" id="MJXp-Span-2270">1</span><span class="MJXp-mo" id="MJXp-Span-2271">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2273" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-184">P(\mathbb{Y})=P(\mathrm{y}^{(1)},...,\mathrm{y}^{(\tau)})=\prod_{t=1}^\tau P(\mathrm{y}^{(t)}|\,\mathrm{y}^{(t-1)},\mathrm{y}^{(t-2)},...\mathrm{y}^{(1)}),\tag{10.31}</script></span></p><p>ở đây vế phải của công thức sẽ là rỗng khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">t</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2277">1</span></span></span><script type="math/tex" id="MathJax-Element-185">t=1</script></span>. Do đó hàm đối của logarit hàm hợp lý của tập giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-2280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2282" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2283">(</span><span class="MJXp-mn" id="MJXp-Span-2284">1</span><span class="MJXp-mo" id="MJXp-Span-2285">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2287" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2288" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2292" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2293">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294">τ</span><span class="MJXp-mo" id="MJXp-Span-2295">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-186">\{y^{(1)},...y^{(\tau)}\}</script></span> đối với một mô hình như vậy là<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2297"><span class="MJXp-mtable" id="MJXp-Span-2298"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2299" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2300" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">L</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2303"><span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305" style="margin-left: 0px;">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2308" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2309">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310">t</span><span class="MJXp-mo" id="MJXp-Span-2311">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2312" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-187">L=\sum_t L^{(t)},\tag{10.32}</script></span><br>
với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2313"><span class="MJXp-mtable" id="MJXp-Span-2314"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2315" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2316" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2319" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2320">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">t</span><span class="MJXp-mo" id="MJXp-Span-2322">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-2325">log</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">P</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mrow" id="MJXp-Span-2330" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-2331">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2332" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2333">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">t</span><span class="MJXp-mo" id="MJXp-Span-2335">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2339" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2340">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">t</span><span class="MJXp-mo" id="MJXp-Span-2342">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2343"><span class="MJXp-mo" id="MJXp-Span-2344" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2345" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2348" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2349">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">t</span><span class="MJXp-mo" id="MJXp-Span-2351">−</span><span class="MJXp-mn" id="MJXp-Span-2352">1</span><span class="MJXp-mo" id="MJXp-Span-2353">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2357" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2358">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">t</span><span class="MJXp-mo" id="MJXp-Span-2360">−</span><span class="MJXp-mn" id="MJXp-Span-2361">2</span><span class="MJXp-mo" id="MJXp-Span-2362">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2366" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2370" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2371">(</span><span class="MJXp-mn" id="MJXp-Span-2372">1</span><span class="MJXp-mo" id="MJXp-Span-2373">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2374" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-188">L^{(t)}=-\log P(\mathrm{y}^{(t)}=y^{(t)}|\,y^{(t-1)},y^{(t-2)},...,y^{(1)}).\tag{10.33}</script></span></p><p>Các cạnh trong mô hình đồ thị xác suất cho biết sự liên quan trực tiếp giữa các biến. Mục tiêu của nhiều mô hình đồ thị xác suất là đạt được hiệu quả về mặt thống kê và tính toán bằng cách giản lược các cạnh không có sự tương tác mạnh. Ví dụ, người ta thường áp dụng các giả định kiểu Markov rằng mô hình đồ thị chỉ nên chứa các cạnh từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mo" id="MJXp-Span-2377" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2380" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2381">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">t</span><span class="MJXp-mo" id="MJXp-Span-2383">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">k</span><span class="MJXp-mo" id="MJXp-Span-2385">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-189">\{y^{(t-k)}</script></span>,…,<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-msubsup" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2389" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2390">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">t</span><span class="MJXp-mo" id="MJXp-Span-2392">−</span><span class="MJXp-mn" id="MJXp-Span-2393">1</span><span class="MJXp-mo" id="MJXp-Span-2394">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-190">y^{(t-1)}\}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2396"><span class="MJXp-msubsup" id="MJXp-Span-2397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2399" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2400">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">t</span><span class="MJXp-mo" id="MJXp-Span-2402">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-191">y^{(t)}</script></span>, thay vì bao gồm toàn bộ các cạnh phía trước. Tuy nhiên, trong một vài trường hợp, ta có thể tin rằng toàn bộ đầu vào trước đó sẽ có ảnh hưởng nhất định tới thành phần tiếp theo của chuỗi. Mạng neuron truy hồi sẽ hữu ích khi ta tin rằng phân phối của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2403"><span class="MJXp-msubsup" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2406" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2407">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">t</span><span class="MJXp-mo" id="MJXp-Span-2409">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-192">y^{(t)}</script></span> có thể chịu ảnh hưởng vào một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2410"><span class="MJXp-msubsup" id="MJXp-Span-2411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2413" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2414">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">i</span><span class="MJXp-mo" id="MJXp-Span-2416">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-193">y^{(i)}</script></span> nào đó từ quá khứ xa xôi trước đó theo cách mà không thể nắm bắt được ảnh hưởng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2420" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2421">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">i</span><span class="MJXp-mo" id="MJXp-Span-2423">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-194">y^{(i)}</script></span> lên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2424"><span class="MJXp-msubsup" id="MJXp-Span-2425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2427" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2428">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429">t</span><span class="MJXp-mo" id="MJXp-Span-2430">−</span><span class="MJXp-mn" id="MJXp-Span-2431">1</span><span class="MJXp-mo" id="MJXp-Span-2432">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-195">y^{(t-1)}</script></span>.</p><p>Một cách để biểu diễn một mạng neuron truy hồi dưới dạng một mô hình đồ thị xác suất là cho rằng mạng neuron truy hồi xác định một mô hình đồ thị có xác suất có cấu trúc là một đồ thị đầy đủ, có khả năng thể hiện sự độc lập trực tiếp giữa bất kỳ cặp giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434">y</span></span></span><script type="math/tex" id="MathJax-Element-196">y</script></span> nào. Mô hình đồ thịđủủ xác suất của các  giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436">y</span></span></span><script type="math/tex" id="MathJax-Element-197">y</script></span> với cấu trúc đồ thị đầy đủ được chỉ ra trong hình 10.7. Cách diễn giải mạng neuron truy hồi bằng một đồ thị xác suất đầy đủ là do ta loại bỏ các đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2437"><span class="MJXp-msubsup" id="MJXp-Span-2438"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2439" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2440" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2441">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">t</span><span class="MJXp-mo" id="MJXp-Span-2443">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-198">\boldsymbol h^{(t)}</script></span> ra khỏi mô hình thông qua lấy xác suất cận biên.</p><p><img src="https://i.imgur.com/faUUuO6.png" alt=""></p><blockquote>
<p>Hình 10.7: Mô hình đồ thị xác suất có kết nối đầy đủ của chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2444"><span class="MJXp-msubsup" id="MJXp-Span-2445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2447" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2448">(</span><span class="MJXp-mn" id="MJXp-Span-2449">1</span><span class="MJXp-mo" id="MJXp-Span-2450">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-199">y^{(1)}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2451"><span class="MJXp-msubsup" id="MJXp-Span-2452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2454" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2455">(</span><span class="MJXp-mn" id="MJXp-Span-2456">2</span><span class="MJXp-mo" id="MJXp-Span-2457">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">y^{(2)}</script></span>,…, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-msubsup" id="MJXp-Span-2459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2461" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2462">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">t</span><span class="MJXp-mo" id="MJXp-Span-2464">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-201">y^{(t)}</script></span>,… Mỗi quan sát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2465"><span class="MJXp-msubsup" id="MJXp-Span-2466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2468" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2469">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">i</span><span class="MJXp-mo" id="MJXp-Span-2471">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-202">y^{(i)}</script></span> trong quá khứ có thể ảnh hưởng tới phân phối có điều kiện của một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2472"><span class="MJXp-msubsup" id="MJXp-Span-2473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2475" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2476">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">t</span><span class="MJXp-mo" id="MJXp-Span-2478">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-203">y^{(t)}</script></span> (với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">t</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">i</span></span></span><script type="math/tex" id="MathJax-Element-204">t > i</script></span>) nào đó khi biết những giá trị trước đó. Cách tham số hóa mô hình đồ thị xác suất theo đồ thị này một cách trực tiếp (như trong phương trình 10.6) có thể trở nên rất kém hiệu quả, khi tăng số lượng đầu vào và tham số cho mỗi thành phần của chuỗi. Mạng neuron truy hồi cũng đạt được tính liên kết đầy đủ như vậy nhưng tham số hóa hiệu quả hơn, như được mô tả trong hình 10.8.</p>
</blockquote><p><img src="https://i.imgur.com/45rwt8v.png" alt=""></p><blockquote>
<p>Hình 10.8: Đưa thêm biến trạng thái vào mô hình đồ thị xác suất của mạng neuron truy hồi, mặc dù nó là một hàm tất định của đầu vào, giúp ta thu được một cách tham số hóa hiệu quả, dựa trên phương trình 10.5. Mỗi giai đoạn của chuỗi (với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-msubsup" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2485" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2486" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2487">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">t</span><span class="MJXp-mo" id="MJXp-Span-2489">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-205">\boldsymbol h^{(t)}</script></span> và <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2490"><span class="MJXp-msubsup" id="MJXp-Span-2491"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2492" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2493" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2494">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">t</span><span class="MJXp-mo" id="MJXp-Span-2496">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-206">\boldsymbol y^{(t)}</script></span></em>) bao hàm cùng một cấu trúc (mỗi nút có cùng số đầu vào) và có thể dùng chung các tham số với các giai đoạn khác.</p>
</blockquote><p>Ta sẽ thấy vài điều thú vị khi xét cấu trúc mô hình đồ thị xác suất của mạng neuron truy hồi, được tạo thành bằng cách coi những đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2497"><span class="MJXp-msubsup" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2499" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2500" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2501">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">t</span><span class="MJXp-mo" id="MJXp-Span-2503">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-207">\boldsymbol h^{(t)}</script></span> là các biến ngẫu nhiên.<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2504"><span class="MJXp-msubsup" id="MJXp-Span-2505"><span class="MJXp-mi" id="MJXp-Span-2506" style="margin-right: 0.05em;"></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2507" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-2508">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-208">^{1}</script></span> Việc đưa các đơn vị ẩn vào mô hình đồ thị xác suất nói lên một điều rằng mạng neuron truy hồi cho ta một cách hiệu quả để tham số hóa phân phối xác suất đồng thời của các quan sát. Giả sử ta biểu diễn một phân phối xác suất đồng thời tùy ý của các giá trị rời rạc dưới dạng bảng - là một mảng chứa các giá trị riêng biệt cho biết xác suất xảy ra mỗi phép gán có thể. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510">y</span></span></span><script type="math/tex" id="MathJax-Element-209">y</script></span> có thể nhận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">k</span></span></span><script type="math/tex" id="MathJax-Element-210">k</script></span> giá trị khác nhau, biểu diễn dạng bảng sẽ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">O</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2518" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">τ</span></span></span><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-211">O(k^{\tau})</script></span> tham số. Trái lại, nhờ sử dụng chung tham số, số lượng tham số trong mạng neuron truy hồi là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">O</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2524">1</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">O(1)</script></span> theo độ dài chuỗi. Ta có thể điều chỉnh số lượng tham số trong mạng neuron truy hồi để kiểm soát dung lượng của mô hình nhưng không nhất thiết phải tỉ lệ với độ dài chuỗi. Phương trình 10.5 cho thấy mạng neuron truy hồi giúp tham số hóa hiệu quả mối quan hệ dài hạn giữa các biến, bằng cách áp dụng hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">f</span></span></span><script type="math/tex" id="MathJax-Element-213">f</script></span> một cách truy hồi và sử dụng chung bộ tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2528"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2529">θ</span></span></span><script type="math/tex" id="MathJax-Element-214">\boldsymbol \theta</script></span> tại các bước thời gian. Hình 10.8 mô tả một cách diễn giải dưới góc độ mô hình đồ thị xác suất. Việc tích hợp các nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2530"><span class="MJXp-msubsup" id="MJXp-Span-2531"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2532" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2533" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2534">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">t</span><span class="MJXp-mo" id="MJXp-Span-2536">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-215">\boldsymbol h^{(t)}</script></span> vào mô hình đồ thị giúp tách biệt quá khứ và tương lai, như một đại lượng trung gian giữa chúng. Một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2537"><span class="MJXp-msubsup" id="MJXp-Span-2538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2540" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2541">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542">i</span><span class="MJXp-mo" id="MJXp-Span-2543">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-216">y^{(i)}</script></span> trong quá khứ xa có thể ảnh hưởng đến một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2544"><span class="MJXp-msubsup" id="MJXp-Span-2545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2547" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2548">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">t</span><span class="MJXp-mo" id="MJXp-Span-2550">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-217">y^{(t)}</script></span> thông qua ảnh hưởng của nó lên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2551"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2552">h</span></span></span><script type="math/tex" id="MathJax-Element-218">\boldsymbol h</script></span>. Cấu trúc của đồ thị này chỉ ra rằng mô hình có thể được tham số hóa hiệu quả bằng cách sử dụng cùng một phân phối xác suất có điều kiện tại mỗi bước thời gian, và khi các biến đều được quan sát, xác suất của phép gán đồng thời tất cả các biến có thể được tính toán một cách hiệu quả.</p><blockquote>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2553"><span class="MJXp-msubsup" id="MJXp-Span-2554"><span class="MJXp-mi" id="MJXp-Span-2555" style="margin-right: 0.05em;"></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2556" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-2557">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-219">^{1}</script></span> Phân phối có điều kiện của những biến này khi biết giá trị của các nút cha của chúng là tất định. Điều này là hoàn toàn hợp lệ, mặc dù chúng ta hiếm khi thiết kế một mô hình đồ thị xác suất với các đơn vị ẩn tất định như vậy.</p>
</blockquote><p>Mặc dù được tham số hoá hiệu quả, thực hiện một số phép toán trong mô hình đồ thị vẫn là một thách thức về mặt tính toán. Chẳng hạn, rất khó để có thể dự đoán các giá trị bị thiếu ở giữa chuỗi.</p><p>Cái giá mà mạng truy hồi phải trả để đối lấy việc giảm số lượng tham số là việc tối ưu tham số trở nên khó khăn hơn.</p><p>Dùng chung tham số trong mạng truy hồi được sử dụng dựa trên giả định rằng cùng một bộ tham số có thể được sử dụng ở các thời điểm khác nhau. Điều này đồng nghĩa với giả định rằng phân bố xác suất có điều kiện của các biến tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2559">t</span><span class="MJXp-mo" id="MJXp-Span-2560" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2561">1</span></span></span><script type="math/tex" id="MathJax-Element-220">t+1</script></span> khi biết giá trị tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">t</span></span></span><script type="math/tex" id="MathJax-Element-221">t</script></span> là <em>ổn định</em> (stationary), có nghĩa là mối quan hệ giữa bước thời gian trước và sau không phụ thuộc vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">t</span></span></span><script type="math/tex" id="MathJax-Element-222">t</script></span>. Về nguyên tắc, ta có thể sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567">t</span></span></span><script type="math/tex" id="MathJax-Element-223">t</script></span> như một đầu vào bổ sung tại mỗi bước và để cho mô hình tự phát hiện nhiều nhất có thể sự phụ thuộc thời gian khi dùng chung tham số giữa các bước thời gian. Điều này tốt hơn nhiều so với việc sử dụng các phân phối xác suất có điều kiện khác nhau cho mỗi thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569">t</span></span></span><script type="math/tex" id="MathJax-Element-224">t</script></span>, nhưng sau đó mạng sẽ phải ngoại suy (extrapolate) khi gặp những giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">t</span></span></span><script type="math/tex" id="MathJax-Element-225">t</script></span> mới.</p><p>Để hoàn thiện góc nhìn của chúng ta về một mạng neuron truy hồi dưới dạng mô hình đồ thị xác suất, ta phải mô tả cách để lấy mẫu từ mô hình. Phép toán chủ yếu ta cần thực hiện chỉ là lấy mẫu từ phân phối có điều kiện tại mỗi bước thời gian, nhưng sẽ thêm có một chút phức tạp ở đây. Mạng neuron truy hồi cần phải có một cơ chế nào đó để xác định độ dài của chuỗi. Có nhiều phương pháp để thực hiện điều này.</p><p>Khi đầu ra là một ký hiệu lấy từ bộ từ vựng, ta có thể thêm một ký hiệu đặc biệt để đánh dấu sự kết thúc của chuỗi [Schmidhuber, 2012]. Khi ký hiệu đó được sinh ra, quá trình lấy mẫu sẽ dừng lại. Trong tập huấn luyện, ta thêm ký hiệu này như một thành phần bổ sung của chuỗi vào ngay sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2572"><span class="MJXp-msubsup" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2574" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2575" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2576">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2577">τ</span><span class="MJXp-mo" id="MJXp-Span-2578">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-226">\boldsymbol x^{(\tau)}</script></span> trong mỗi mẫu huấn luyện.</p><p>Một cách khác là tạo bổ sung một đầu ra Bernoulli cho mô hình, đại diện cho quyết định tạm dừng hay tiếp tục sinh mẫu ở mỗi bước thời gian. Hướng tiếp cận này có tính tổng quát hơn việc thêm một ký hiệu bổ sung cho bộ từ vựng bởi vì nó có thể được áp dụng cho bất kì mạng neuron truy hồi nào, thay vì chỉ giới hạn trong các mạng neuron truy hồi mà đầu ra là một chuỗi ký hiệu. Ví dụ, nó có thể được áp dụng cho mạng neuron truy hồi xuất ra một chuỗi các số thực. Đơn vị đầu ra mới thường là một đơn vị chữ S đã được huấn luyện với hàm mất mát dạng entropy chéo. Trong cách tiếp cận này, hàm chữ S đã được huấn luyện để cực đại hóa logarit của xác suất dự đoán chính xác về việc liệu chuỗi sẽ dừng lại hay tiếp tục tại mỗi mỗi bước thời gian.</p><p>Một lựa chọn khác để xác định độ dài chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">τ</span></span></span><script type="math/tex" id="MathJax-Element-227">\tau</script></span> là thêm một đầu ra bổ sung vào mô hình để nó dự đoán số nguyên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">τ</span></span></span><script type="math/tex" id="MathJax-Element-228">\tau</script></span>. Mô hình có thể lấy mẫu một giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584">τ</span></span></span><script type="math/tex" id="MathJax-Element-229">\tau</script></span> và sau đó lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586">τ</span></span></span><script type="math/tex" id="MathJax-Element-230">\tau</script></span> bước dữ liệu. Cách tiếp cận này yêu cầu thêm một đầu vào bổ sung cho việc cập nhật truy hồi tại mỗi bước thời gian để nó nhận thức được khi nào gần tới điểm cuối của chuỗi được sinh ra. Đầu vào bổ sung này có thể bao gồm giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2588">τ</span></span></span><script type="math/tex" id="MathJax-Element-231">\tau</script></span>, hoặc có thể là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590">τ</span><span class="MJXp-mo" id="MJXp-Span-2591" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2592">t</span></span></span><script type="math/tex" id="MathJax-Element-232">\tau-t</script></span> - số bước thời gian còn lại. Nếu không có đầu vào bổ sung này, mạng neuron truy hồi có thể sẽ sinh ra những chuỗi kết thúc đột ngột, chẳng hạn như một câu kết thúc trước khi nó được hoàn thành. Cách tiếp cận này dựa trên phép phân tách</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2593"><span class="MJXp-mtable" id="MJXp-Span-2594"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2595" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2596" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">P</span><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2600" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2601" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2602">(</span><span class="MJXp-mn" id="MJXp-Span-2603">1</span><span class="MJXp-mo" id="MJXp-Span-2604">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2605" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2607" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2608" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2610"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2611" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2612" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2613">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">τ</span><span class="MJXp-mo" id="MJXp-Span-2615">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2616" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">P</span><span class="MJXp-mo" id="MJXp-Span-2619" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620">τ</span><span class="MJXp-mo" id="MJXp-Span-2621" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">P</span><span class="MJXp-mo" id="MJXp-Span-2623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2624"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2625" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2626" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2627">(</span><span class="MJXp-mn" id="MJXp-Span-2628">1</span><span class="MJXp-mo" id="MJXp-Span-2629">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2630" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2632" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2635"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2636" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2637" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2638">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639">τ</span><span class="MJXp-mo" id="MJXp-Span-2640">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2641"><span class="MJXp-mo" id="MJXp-Span-2642" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">τ</span><span class="MJXp-mo" id="MJXp-Span-2644" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-233">P(\boldsymbol x^{(1)},...,\boldsymbol x^{(\tau)})=P(\tau)P(\boldsymbol x^{(1)},...,\boldsymbol x^{(\tau)}|\tau). \tag{10.34}</script></span></p><p>Bạn đọc có thể tham khảo chiến lược dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">τ</span></span></span><script type="math/tex" id="MathJax-Element-234">\tau</script></span> một cách trực tiếp được sử dụng bởi [Goodfellow et al., 2014d].</p><h2 id="1024-Mô-hình-hoá-chuỗi-khi-biết-ngữ-cảnh-với-mạng-neuron-truy-hồi">10.2.4 Mô hình hoá chuỗi khi biết ngữ cảnh với mạng neuron truy hồi</h2><p>Trong phần trước, chúng tôi đã mô tả cách một mạng neuron truy hồi có thể tương ứng với mô hình đồ thị xác suất có hướng của một chuỗi gồm các biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2648"><span class="MJXp-msubsup" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2651" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2652">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653">t</span><span class="MJXp-mo" id="MJXp-Span-2654">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-235">y^{(t)}</script></span> ngẫu nhiên không có đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2655"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2656">x</span></span></span><script type="math/tex" id="MathJax-Element-236">\boldsymbol x</script></span>. Tất nhiên, trình bày của chúng tôi về mạng neuron truy hồi trong phương trình 10.8 đã bao gồm một chuỗi các đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2657"><span class="MJXp-msubsup" id="MJXp-Span-2658"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2659" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2660" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2661">(</span><span class="MJXp-mn" id="MJXp-Span-2662">1</span><span class="MJXp-mo" id="MJXp-Span-2663">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2664" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2665"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2666" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2667" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2668">(</span><span class="MJXp-mn" id="MJXp-Span-2669">2</span><span class="MJXp-mo" id="MJXp-Span-2670">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2676"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2677" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2678" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2679">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680">τ</span><span class="MJXp-mo" id="MJXp-Span-2681">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-237">\boldsymbol x^{(1)},\boldsymbol x^{(2)},...,\boldsymbol x^{(\tau)}</script></span>. Nói chung, các mạng neuron truy hồi cho phép việc mở rộng góc nhìn mô hình đồ thị xác suất để biểu diễn không chỉ phân phối xác suất đồng thời của các biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">y</span></span></span><script type="math/tex" id="MathJax-Element-238">y</script></span>, mà còn cho phân phối có điều kiện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">y</span></span></span><script type="math/tex" id="MathJax-Element-239">y</script></span> khi biết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2686"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2687">x</span></span></span><script type="math/tex" id="MathJax-Element-240">\boldsymbol x</script></span>. Như đã thảo luận trong phần 6.2.1.1, trong ngữ cảnh của mạng lan truyền thuận, bất kì mô hình nào biểu diễn một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2689">P</span><span class="MJXp-mo" id="MJXp-Span-2690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2691">y</span><span class="MJXp-mo" id="MJXp-Span-2692" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2693">θ</span><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-241">P(\boldsymbol y;\boldsymbol\theta)</script></span> đều có thể được diễn giải như một mô hình biểu diễn phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">P</span><span class="MJXp-mo" id="MJXp-Span-2697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2698">y</span><span class="MJXp-mrow" id="MJXp-Span-2699"><span class="MJXp-mo" id="MJXp-Span-2700" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2701">ω</span><span class="MJXp-mo" id="MJXp-Span-2702" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-242">P(\boldsymbol y|\boldsymbol\omega)</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2703"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2704">ω</span><span class="MJXp-mo" id="MJXp-Span-2705" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2706">θ</span></span></span><script type="math/tex" id="MathJax-Element-243">\boldsymbol\omega=\boldsymbol\theta</script></span>. Ta có thể mở rộng một mô hình như vậy để biểu diễn một phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2707"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2708">P</span><span class="MJXp-mo" id="MJXp-Span-2709" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2710">y</span><span class="MJXp-mrow" id="MJXp-Span-2711"><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2713">x</span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-244">\boldsymbol P(\boldsymbol y|\boldsymbol x)</script></span> bằng cách sử dụng cùng phần phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2716">P</span><span class="MJXp-mo" id="MJXp-Span-2717" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2718">y</span><span class="MJXp-mrow" id="MJXp-Span-2719"><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2721">ω</span><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-245">P(\boldsymbol y|\boldsymbol \omega)</script></span> như vậy, nhưng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2723"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2724">ω</span></span></span><script type="math/tex" id="MathJax-Element-246">\boldsymbol\omega</script></span> là một hàm số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2725"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2726">x</span></span></span><script type="math/tex" id="MathJax-Element-247">\boldsymbol x</script></span>. Đối với mạng neuron truy hồi, điều này có thể đạt được bằng nhiều cách. Chúng tôi sẽ tóm lược ở đây các phương pháp rõ ràng và phổ biến nhất.</p><p>Trước đó, chúng tôi đã thảo luận về các mạng neuron truy hồi nhận một chuỗi vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-msubsup" id="MJXp-Span-2728"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2729" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2730" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2731">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732">t</span><span class="MJXp-mo" id="MJXp-Span-2733">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-248">\boldsymbol x^{(t)}</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">t</span><span class="MJXp-mo" id="MJXp-Span-2736" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2737">1</span><span class="MJXp-mo" id="MJXp-Span-2738" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2739" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2742" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743">τ</span></span></span><script type="math/tex" id="MathJax-Element-249">t = 1, ...,\tau</script></span> làm đầu vào. Một lựa chọn khác là chỉ nhận một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2744"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2745">x</span></span></span><script type="math/tex" id="MathJax-Element-250">\boldsymbol x</script></span> làm đầu vào. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2747">x</span></span></span><script type="math/tex" id="MathJax-Element-251">\boldsymbol x</script></span> là một vector có kích thước cố định, ta có thể đưa nó làm một đầu vào bổ sung cho mạng neuron truy hồi sinh chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2748"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2749">y</span></span></span><script type="math/tex" id="MathJax-Element-252">\boldsymbol y</script></span>. Một số cách thức phổ biến thực hiện cung cấp đầu vào bổ sung cho mạng neuron truy hồi là</p><ol>
<li>dưới dạng đầu vào bổ sung tại mỗi bước thời gian, hoặc</li>
<li>dưới dạng trạng thái khởi tạo của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2750"><span class="MJXp-msubsup" id="MJXp-Span-2751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2753" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2754">(</span><span class="MJXp-mn" id="MJXp-Span-2755">0</span><span class="MJXp-mo" id="MJXp-Span-2756">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-253">h^{(0)}</script></span>, hoặc</li>
<li>cả hai cách trên.</li>
</ol><p>Hướng tiếp cận đầu tiên và phổ biến nhất được mô tả trong hình 10.9. Sự tương tác giữa đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2757"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2758">x</span></span></span><script type="math/tex" id="MathJax-Element-254">\boldsymbol x</script></span> và mỗi vector đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2759"><span class="MJXp-msubsup" id="MJXp-Span-2760"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2761" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2762" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2763">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">t</span><span class="MJXp-mo" id="MJXp-Span-2765">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-255">\boldsymbol h^{(t)}</script></span> được tham số hóa bởi một ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2766"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2767">R</span></span></span><script type="math/tex" id="MathJax-Element-256">\boldsymbol R</script></span>, ma trận này không xuất hiện trong mô hình chỉ chứa chuỗi các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769">y</span></span></span><script type="math/tex" id="MathJax-Element-257">y</script></span>. Tích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2770"><span class="MJXp-msubsup" id="MJXp-Span-2771"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2772" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2773" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-2774">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2775">R</span></span></span><script type="math/tex" id="MathJax-Element-258">\boldsymbol x^{\top}\boldsymbol R</script></span> được thêm như một đầu vào bổ sung cho các đơn vị ẩn tại mỗi bước thời gian. Ta có coi việc lựa chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2776"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2777">x</span></span></span><script type="math/tex" id="MathJax-Element-259">\boldsymbol x</script></span> như việc xác định giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2778"><span class="MJXp-msubsup" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2780" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2781" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-2782">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2783">R</span></span></span><script type="math/tex" id="MathJax-Element-260">\boldsymbol x^{\top}\boldsymbol R</script></span>, một hệ số tự do hiệu quả được dùng trong mỗi đơn vị ẩn. Các trọng số vẫn độc lập với đầu vào. Có thể coi mô hình này như việc lấy các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2784"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2785">θ</span></span></span><script type="math/tex" id="MathJax-Element-261">\boldsymbol\theta</script></span> từ mô hình không điều kiện và chuyển chúng thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2786"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2787">ω</span></span></span><script type="math/tex" id="MathJax-Element-262">\boldsymbol\omega</script></span>, với các hệ số tự do trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2789">ω</span></span></span><script type="math/tex" id="MathJax-Element-263">\boldsymbol\omega</script></span> giờ đây trở thành hàm của đầu vào.</p><p><img src="https://i.imgur.com/areuqxF.png" alt=""></p><blockquote>
<p>Hình 10.9: Một mạng neuron truy hồi ánh xạ một vector độ dài cố định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2790"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2791">x</span></span></span><script type="math/tex" id="MathJax-Element-264">\boldsymbol x</script></span> vào một phân phối của các chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2792"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2793">Y</span></span></span><script type="math/tex" id="MathJax-Element-265">\boldsymbol Y</script></span>. Mạng neuron truy hồi này phù hợp với các tác vụ như chú thích hình ảnh, trong đó một hình ảnh được dùng làm đầu vào của mô hình, mô hình này sau đó sinh ra một chuỗi từ mô tả bức ảnh đầu vào. Mỗi phần tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2794"><span class="MJXp-msubsup" id="MJXp-Span-2795"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2796" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2797" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2798">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">t</span><span class="MJXp-mo" id="MJXp-Span-2800">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-266">\boldsymbol y^{(t)}</script></span> của chuỗi đầu ra quan sát vừa được xem như là đầu vào (cho bước thời gian hiện tại),vừa được xem như nhãn (cho bước thời gian trước đó) trong quá trình huấn luyện.</p>
</blockquote><p>Thay vì chỉ nhận một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2801"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2802">x</span></span></span><script type="math/tex" id="MathJax-Element-267">\boldsymbol x</script></span> làm đầu vào, mạng neuron truy hồi có thể nhận một chuỗi các vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2803"><span class="MJXp-msubsup" id="MJXp-Span-2804"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2805" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2806" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2807">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2808">t</span><span class="MJXp-mo" id="MJXp-Span-2809">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-268">\boldsymbol x^{(t)}</script></span> làm đầu vào. Mạng neuron truy hồi được mô tả trong phương trình 10.8, tương ứng với phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2811">P</span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2815" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2816">(</span><span class="MJXp-mn" id="MJXp-Span-2817">1</span><span class="MJXp-mo" id="MJXp-Span-2818">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2820" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2821" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2826" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2827">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2828">τ</span><span class="MJXp-mo" id="MJXp-Span-2829">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2830"><span class="MJXp-mo" id="MJXp-Span-2831" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2832" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2835" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2836">(</span><span class="MJXp-mn" id="MJXp-Span-2837">1</span><span class="MJXp-mo" id="MJXp-Span-2838">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2842" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2846" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2847">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848">τ</span><span class="MJXp-mo" id="MJXp-Span-2849">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2850" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-269">P(y^{(1)},...,y^{(\tau)}|\,x^{(1)},...,x^{(\tau)})</script></span> với giả định độc lập có điều kiện để phân phối này phân tách được như sau<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2851"><span class="MJXp-mtable" id="MJXp-Span-2852"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2853" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2854" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-2855"><span><span class="MJXp-mo" id="MJXp-Span-2856" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857" style="margin-left: 0px;">t</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858">P</span><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2860"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2861" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2862" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2863">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864">t</span><span class="MJXp-mo" id="MJXp-Span-2865">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-2866" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2867"><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2869" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2870"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2871" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2872" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2873">(</span><span class="MJXp-mn" id="MJXp-Span-2874">1</span><span class="MJXp-mo" id="MJXp-Span-2875">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2876" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2877" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2878" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2879"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2880" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2881" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2882">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">t</span><span class="MJXp-mo" id="MJXp-Span-2884">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2885" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-270">\prod_t P(\boldsymbol y^{(t)}\,|\,
\boldsymbol x^{(1)},\dots,\boldsymbol x^{(t)}). \tag{10.35}</script></span></p><p><img src="https://i.imgur.com/THDE5E8.png" alt=""></p><blockquote>
<p>Hình 10.10: Một mạng neuron truy hồi có điều kiện ánh xạ một chuỗi các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2887"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2888">x</span></span></span><script type="math/tex" id="MathJax-Element-271">\boldsymbol x</script></span> có độ dài biến thiên vào một phân phối của các chuỗi của các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2889"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2890">y</span></span></span><script type="math/tex" id="MathJax-Element-272">\boldsymbol y</script></span> có cùng độ dài. So với hình 10.3, mạng neuron truy hồi này chứa các kết nối từ đầu ra trước đó tới trạng thái hiện tại. Các kết nối này cho phép mạng neuron truy hồi mô hình hoá một phân phối tùy ý của các chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2891"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2892">y</span></span></span><script type="math/tex" id="MathJax-Element-273">\boldsymbol y</script></span> khi đã biết các chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2893"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2894">x</span></span></span><script type="math/tex" id="MathJax-Element-274">\boldsymbol x</script></span> có cùng độ dài. Mạng neuron truy hồi của hình 10.3 chỉ có thể biểu diễn các phân phối trong đó các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2895"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2896">y</span></span></span><script type="math/tex" id="MathJax-Element-275">\boldsymbol y</script></span> là độc lập có điều kiện với nhau khi đã biết các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2897"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2898">x</span></span></span><script type="math/tex" id="MathJax-Element-276">\boldsymbol x</script></span>.</p>
</blockquote><p>Để khử giả thiết độc lập có điều kiện này, ta có thể bổ sung các kết nối từ đầu ra tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900">t</span></span></span><script type="math/tex" id="MathJax-Element-277">t</script></span> đến đơn vị ẩn tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">t</span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2904">1</span></span></span><script type="math/tex" id="MathJax-Element-278">t+1</script></span>, như trong hình 10.10.<br>
Mô hình khi đó có thể biểu diễn một phân phối xác suất tùy ý của chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2905"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2906">y</span></span></span><script type="math/tex" id="MathJax-Element-279">\boldsymbol y</script></span>. Loại mô hình biểu diễn phân phối của một chuỗi khi cho trước một chuỗi khác như thế này có một hạn chế, đó là độ dài của hai chuỗi phải bằng nhau. Chúng tôi sẽ thảo luận về phương pháp loại bỏ hạn chế này trong phần 10.4.</p><h1 id="103-Các-mạng-neuron-truy-hồi-hai-chiều">10.3 Các mạng neuron truy hồi hai chiều</h1><p>Tất cả các mạng truy hồi ta đã xét cho đến hiện tại đều có cấu trúc “nguyên nhân - kết quả”, nghĩa là trạng thái tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908">t</span></span></span><script type="math/tex" id="MathJax-Element-280">t</script></span> chỉ nắm bắt thông tin từ các đầu vào trong quá khứ, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2909"><span class="MJXp-msubsup" id="MJXp-Span-2910"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2911" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2912" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2913">(</span><span class="MJXp-mn" id="MJXp-Span-2914">1</span><span class="MJXp-mo" id="MJXp-Span-2915">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2916" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2917" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2919"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2920" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2921" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2922">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923">t</span><span class="MJXp-mo" id="MJXp-Span-2924">−</span><span class="MJXp-mn" id="MJXp-Span-2925">1</span><span class="MJXp-mo" id="MJXp-Span-2926">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-281">\boldsymbol  x^{(1)},\dots,\boldsymbol x^{(t-1)}</script></span> và đầu vào hiện tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2927"><span class="MJXp-msubsup" id="MJXp-Span-2928"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2929" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2930" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2931">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932">t</span><span class="MJXp-mo" id="MJXp-Span-2933">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-282">\boldsymbol x^{(t)}</script></span>. Một số mô hình khác mà chúng ta đã thảo luận cũng cho phép thông tin từ các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2934"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2935">y</span></span></span><script type="math/tex" id="MathJax-Element-283">\boldsymbol y</script></span> trong quá khứ tác động đến trạng thái hiện tại khi sẵn có những giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2936"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2937">y</span></span></span><script type="math/tex" id="MathJax-Element-284">\boldsymbol y</script></span>.</p><p>Tuy nhiên, trong nhiều trường hợp, ta sẽ muốn tạo ra một dự đoán của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2938"><span class="MJXp-msubsup" id="MJXp-Span-2939"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2940" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2941" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2942">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">t</span><span class="MJXp-mo" id="MJXp-Span-2944">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-285">\boldsymbol y^{(t)}</script></span> sao cho nó có thể phụ thuộc vào <em>toàn bộ chuỗi đầu vào</em>. Chẳng hạn, trong bài toán nhận dạng giọng nói, cách diễn giải âm vị thể hiện âm thanh hiện tại có thể phụ thuộc vào vài âm vị tiếp theo để tạo thành một cụm từ chính xác, hay thậm chí là vài từ tiếp theo do sự phụ thuộc ngữ âm giữa các từ gần nhau: nếu có nhiều hơn một cách diễn dịch từ hiện tại đều hợp lý về mặt âm thanh, ta phải xem xét xa hơn vào tương lai (và quá khứ) để phân biệt chúng. Điều này cũng đúng trong bài toán nhận dạng chữ viết tay và nhiều tác vụ học chuỗi-sang-chuỗi (sequence-to-sequence) khác, được mô tả trong phần tiếp theo.</p><p>Mạng neuron truy hồi hai chiều được tạo ra để đáp ứng nhu cầu ấy [Schuster and Paliwal, 1997]. Chúng đã đạt được những kết quả tuyệt vời [Graves, 2012] trong các ứng dụng yêu cầu thông tin từ toàn bộ chuỗi, như nhận dạng chữ viết tay [Graves et al., 2008; Grave and Schmidhuber, 2009], nhận dạng giọng nói [Graves and Schmidhuber, 2005; Graves et al., 2013] và tin sinh học [Baldi et al., 1999].</p><p><img src="https://i.imgur.com/6ZOqVk2.png" alt=""></p><blockquote>
<p>Hình 10.11: Quy trình tính toán trong một mạng neuron truy hồi hai chiều điển hình, nó sẽ học để ánh xạ các chuỗi đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2945"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2946">x</span></span></span><script type="math/tex" id="MathJax-Element-286">\boldsymbol x</script></span> thành các chuỗi nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2947"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2948">y</span></span></span><script type="math/tex" id="MathJax-Element-287">\boldsymbol y</script></span>, với hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2949"><span class="MJXp-msubsup" id="MJXp-Span-2950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2951" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2952" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2953">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954">t</span><span class="MJXp-mo" id="MJXp-Span-2955">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-288">L^{(t)}</script></span> ở mỗi bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957">t</span></span></span><script type="math/tex" id="MathJax-Element-289">t</script></span>. Hàm truy hồi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2958"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2959">h</span></span></span><script type="math/tex" id="MathJax-Element-290">\boldsymbol h</script></span> lan truyền thông tin thuận theo thời gian (về phía bên phải), trong khi hàm truy hồi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2960"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2961">g</span></span></span><script type="math/tex" id="MathJax-Element-291">\boldsymbol g</script></span> lan truyền thông tin ngược theo thời gian (về phía bên trái). Vì vậy, tại mỗi điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">t</span></span></span><script type="math/tex" id="MathJax-Element-292">t</script></span>, các đơn vị đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2964"><span class="MJXp-msubsup" id="MJXp-Span-2965"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2966" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2967" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2968">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969">t</span><span class="MJXp-mo" id="MJXp-Span-2970">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-293">\boldsymbol o^{(t)}</script></span> có thể nắm bắt những thông tin hữu ích từ một tổng hợp về quá khứ trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2971"><span class="MJXp-msubsup" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2973" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2974" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2975">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2976">t</span><span class="MJXp-mo" id="MJXp-Span-2977">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-294">\boldsymbol h^{(t)}</script></span> và một tổng hợp về tương lai trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2978"><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2981" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2982">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2983">t</span><span class="MJXp-mo" id="MJXp-Span-2984">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-295">\boldsymbol g^{(t)}</script></span>.</p>
</blockquote><p>Giống như tên gọi, mạng neuron truy hồi hai chiều là sự kết hợp của một mạng neuron truy hồi thuận và một mạng neuron truy hồi nghịch. Trong cùng một giai đoạn. Mạng neuron truy hồi thuận dịch chuyển thuận theo thời gian, bắt đầu từ đầu chuỗi; ngược lại, mạng neuron truy hồi nghịch dịch chuyển theo chiều ngược lại, bắt đầu từ cuối chuỗi. Hình 10.11 minh họa một mạng neuron truy hồi hai chiều điển hình, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2985"><span class="MJXp-msubsup" id="MJXp-Span-2986"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2987" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2988" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2989">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990">t</span><span class="MJXp-mo" id="MJXp-Span-2991">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-296">\boldsymbol h^{(t)}</script></span> là trạng thái của mạng neuron truy hồi thuận và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2992"><span class="MJXp-msubsup" id="MJXp-Span-2993"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2994" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2995" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2996">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2997">t</span><span class="MJXp-mo" id="MJXp-Span-2998">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-297">\boldsymbol g^{(t)}</script></span> là trạng thái của mạng neuron truy hồi ngịch. Tính chất này cho phép các đơn vị đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2999"><span class="MJXp-msubsup" id="MJXp-Span-3000"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3001" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3002" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3003">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004">t</span><span class="MJXp-mo" id="MJXp-Span-3005">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-298">\boldsymbol o^{(t)}</script></span> tính toán một biểu diễn phụ thuộc vào <em>cả quá khứ và tương lai</em>, nhưng sẽ nhạy cảm nhất với các giá trị đầu vào quanh thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3007">t</span></span></span><script type="math/tex" id="MathJax-Element-299">t</script></span> mà không cần chỉ định một cửa sổ có kích thước cố định xung quanh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3009">t</span></span></span><script type="math/tex" id="MathJax-Element-300">t</script></span> (như trong mạng lan truyền thuận, mạng neuron tích chập hoặc mạng neuron truy hồi thông thường với một bộ đệm xem trước cố định).</p><p>Ý tưởng này, theo lẽ tự nhiên, có thể được mở rộng cho trường hợp đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3010"><span class="MJXp-mn" id="MJXp-Span-3011">2</span></span></span><script type="math/tex" id="MathJax-Element-301">2</script></span> chiều, ví dụ như hình ảnh, bằng cách sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3012"><span class="MJXp-mn" id="MJXp-Span-3013">4</span></span></span><script type="math/tex" id="MathJax-Element-302">4</script></span> mạng neuron truy hồi, mỗi mạng thành phần này dịch chuyển theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3014"><span class="MJXp-mn" id="MJXp-Span-3015">4</span></span></span><script type="math/tex" id="MathJax-Element-303">4</script></span> hướng: lên, xuống, trái, phải. Tại mỗi điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3016"><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3018">i</span><span class="MJXp-mo" id="MJXp-Span-3019" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020">j</span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-304">(i, j)</script></span> của lưới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3022"><span class="MJXp-mn" id="MJXp-Span-3023">2</span></span></span><script type="math/tex" id="MathJax-Element-305">2</script></span> chiều, đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3024"><span class="MJXp-msubsup" id="MJXp-Span-3025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026" style="margin-right: 0.05em;">O</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3027" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028">i</span><span class="MJXp-mo" id="MJXp-Span-3029">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-306">O_{i,j}</script></span> khi đó có thể tính toán một biểu diễn nắm bắt được hầu hết thông tin xung quanh điểm ảnh này, và nó cũng có thể phụ thuộc vào đầu vào ở phía xa, nếu mạng neuron truy hồi có thể học được cách truyền những thông tin đó. So với một mạng neuron tích chập, các mạng neuron truy hồi khi áp dụng với hình ảnh thường tốn kém hơn về mặt tính toán, nhưng sẽ cho phép nắm bắt các tương tác tầm xa giữa các đặc trưng trong cùng một bản đồ đặc trưng [Visin et al., 2015; Kalchbrenner et al., 2015]. Thật vậy, các phương trình lan truyền thuận trong các mạng neuron truy hồi như vậy có thể được viết dưới dạng khác cho thấy chúng sử dụng phép tích chập để tính toán đầu vào từ dưới lên (bottom-up) cho mỗi tầng, trước khi sự lan truyền truy hồi qua bản đồ đặc trưng kết hợp các tương tác xung quanh một điểm.</p><h1 id="104-Các-kiến-trúc-chuỗi-sang-chuỗi-dạng-mã-hóa-giải-mã">10.4 Các kiến trúc chuỗi-sang-chuỗi dạng mã hóa-giải mã</h1><p>Ta đã thấy trong hình 10.5 cách một mạng neuron truy hồi ánh xạ chuỗi đầu vào thành một vector có kích thước cố định. Và thấy trong hình 10.9 cách một mạng neuron truy hồi ánh xạ một vector có kích thước cố định thành một chuỗi. Ta cũng đã thấy trong các hình 10.3, 10.4, 10.10 và 10.11 cách một mạng neuron truy hồi ánh xạ một chuỗi đầu vào thành một chuỗi đầu ra có cùng độ dài.</p><p>Trong phần này, ta sẽ thảo luận về cách huấn luyện một mạng neuron truy hồi để ánh xạ một chuỗi đầu vào thành một chuỗi đầu ra không cần thiết có cùng độ dài. Vấn đề này xuất hiện trong nhiều ứng dụng như: nhận dạng giọng nói, dịch máy và vấn đáp, trong đó, hai chuỗi đầu vào và đầu ra trong tập huấn luyện thường không có cùng độ dài (mặc dù độ dài của chúng có thể liên quan đến nhau).</p><p>Đầu vào của mạng neuron truy hồi thường được gọi là “ngữ cảnh”. Chúng ta muốn tạo ra một biểu diễn cho ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">C</span></span></span><script type="math/tex" id="MathJax-Element-307">C</script></span> này. Ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034">C</span></span></span><script type="math/tex" id="MathJax-Element-308">C</script></span> có thể là một vector hoặc một chuỗi của các vector tóm lược chuỗi đầu vào, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3035"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3036">X</span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3039"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3040" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3041" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3042">(</span><span class="MJXp-mn" id="MJXp-Span-3043">1</span><span class="MJXp-mo" id="MJXp-Span-3044">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3045" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3048"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3049" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3050" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3051">(</span><span class="MJXp-msubsup" id="MJXp-Span-3052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3053" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3054" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-3055">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-309">\boldsymbol X = (\boldsymbol x^{(1)}, \dots, \boldsymbol x^{(n_x)})</script></span>.</p><p>Kiến trúc mạng neuron truy hồi đơn giản nhất để ánh xạ một chuỗi có độ dài bất kỳ thành chuỗi có độ dài bất kỳ khác được để xuất đầu tiên bởi [Cho et al., 2014], và sau đó [Sutskever et al., 2014] đã phát triển kiến trúc này một cách độc lập và là nhóm đầu tiên đạt được kết quả tốt nhất (state-of-the-art) trong bài toán dịch máy bằng hướng tiếp cận này. Hệ thống đầu tiên hoạt động dựa trên cơ chế tính điểm các bản dịch đề xuất tạo bởi một hệ thống dịch máy khác, trong khi hệ thống thứ hai sử dụng một mạng truy hồi độc lập để sinh ra bản dịch. Các tác giả gọi kiến trúc này là bộ mã hóa-giải mã <em>(encoder-decoder)</em> hoặc kiến trúc chuỗi-sang-chuỗi, được minh họa trong hình 10.12. Ý tưởng của nó rất đơn giản: (1) Mạng neuron truy hồi đóng vai trò làm bộ <em>mã hóa</em>, hoặc <em>đầu đọc</em> (reader), hoặc <em>đầu vào</em> (input), xử lý chuỗi đầu vào. Bộ mã hóa sinh ra ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058">C</span></span></span><script type="math/tex" id="MathJax-Element-310">C</script></span>, thường là một hàm số đơn giản của trạng thái ẩn cuối cùng của nó. (2) Mạng neuron truy hồi đóng vai trò làm bộ <em>giải mã</em>, hoặc <em>đầu ghi</em> (writer) hoặc <em>đầu ra</em> (output), dựa trên vector độ dài cố định đó (giống như hình 10.9) sinh ra chuỗi đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3059"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3060">Y</span><span class="MJXp-mo" id="MJXp-Span-3061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3063"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3064" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3065" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3066">(</span><span class="MJXp-mn" id="MJXp-Span-3067">1</span><span class="MJXp-mo" id="MJXp-Span-3068">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3069" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3071" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3072"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3073" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3074" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3075">(</span><span class="MJXp-msubsup" id="MJXp-Span-3076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3078" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-3079">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3080" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-311">\boldsymbol Y = (\boldsymbol y^{(1)},\dots,\boldsymbol y^{(n_y)})</script></span>. Điểm mới của loại kiến trúc này so với những kiến trúc đã trình bày trong các phần trước của chương đó là độ dài của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-msubsup" id="MJXp-Span-3082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3084" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-312">n_x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3085"><span class="MJXp-msubsup" id="MJXp-Span-3086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3087" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3088" style="vertical-align: -0.4em;">y</span></span></span></span><script type="math/tex" id="MathJax-Element-313">n_y</script></span> có thể khác nhau, trong khi những kiến trúc trước bị ràng buộc bởi điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3089"><span class="MJXp-msubsup" id="MJXp-Span-3090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3091" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3092" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-3093" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3096" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3098">τ</span></span></span><script type="math/tex" id="MathJax-Element-314">n_x = n_y = \tau</script></span>. Trong kiến trúc chuỗi-sang-chuỗi, hai mạng neuron truy hồi được huấn luyện cùng nhau để cực đại hóa giá trị trung bình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3100">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3101">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3103">P</span><span class="MJXp-mo" id="MJXp-Span-3104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3105"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3106" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3107" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3108">(</span><span class="MJXp-mn" id="MJXp-Span-3109">1</span><span class="MJXp-mo" id="MJXp-Span-3110">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3114"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3115" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3116" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3117">(</span><span class="MJXp-msubsup" id="MJXp-Span-3118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3120" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-3121">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-3122" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3123"><span class="MJXp-mo" id="MJXp-Span-3124" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-3125" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3127" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3128" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3129">(</span><span class="MJXp-mn" id="MJXp-Span-3130">1</span><span class="MJXp-mo" id="MJXp-Span-3131">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3132" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3133" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3135"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3136" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3137" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3138">(</span><span class="MJXp-msubsup" id="MJXp-Span-3139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3141" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-3142">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3143" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-315">logP(\boldsymbol y^{(1)},\dots,\boldsymbol y^{(n_y)}\,|\,\boldsymbol x^{(1)},\dots,\boldsymbol x^{(n_x)})</script></span> trên toàn bộ các cặp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">x</span></span></span><script type="math/tex" id="MathJax-Element-316">x</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3147">y</span></span></span><script type="math/tex" id="MathJax-Element-317">y</script></span> trong tập huấn luyện. Trạng thái cuối cùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3148"><span class="MJXp-msubsup" id="MJXp-Span-3149"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3150" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3151" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3153" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3154" style="vertical-align: -0.4em;">x</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-318">\boldsymbol h_{n_x}</script></span> của mạng neuron truy hồi mã hoá thường được sử dụng như một biểu diễn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156">C</span></span></span><script type="math/tex" id="MathJax-Element-319">C</script></span> của chuỗi đầu vào, và sau đó được đưa làm đầu vào cho mạng neuron truy hồi giải mã.</p><p><img src="https://i.imgur.com/wYfYfFY.png" alt=""></p><blockquote>
<p>Hình 10.12: Ví dụ về bộ mã hóa-giải mã, hay kiến trúc mạng neuron truy hồi chuỗi-sang-chuỗi, để học cách sinh chuỗi đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3157"><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3159"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3160" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3161" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3162">(</span><span class="MJXp-mn" id="MJXp-Span-3163">1</span><span class="MJXp-mo" id="MJXp-Span-3164">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3165" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3166" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3167" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3168"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3169" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3170" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3171">(</span><span class="MJXp-msubsup" id="MJXp-Span-3172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3173" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3174" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-3175">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3176" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-320">(\boldsymbol y^{(1)}, \dots,\boldsymbol y^{(n_y)})</script></span> khi cho trước chuỗi đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3177"><span class="MJXp-mo" id="MJXp-Span-3178" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3179"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3180" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3181" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3182">(</span><span class="MJXp-mn" id="MJXp-Span-3183">1</span><span class="MJXp-mo" id="MJXp-Span-3184">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3185" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3186"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3187" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3188" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3189">(</span><span class="MJXp-mn" id="MJXp-Span-3190">2</span><span class="MJXp-mo" id="MJXp-Span-3191">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3192" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3193" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3194"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3195" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3196" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3197">(</span><span class="MJXp-msubsup" id="MJXp-Span-3198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3199" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3200" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-3201">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3202" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-321">(\boldsymbol x^{(1)},\boldsymbol x^{(2)} \dots,\boldsymbol x^{(n_x)})</script></span>. Kiến trúc bao gồm một mạng neuron truy hồi làm bộ mã hóa giúp đọc chuỗi đầu vào và một mạng neuron truy hồi làm bộ giải mã sinh chuỗi đầu ra (hoặc tính toán xác suất của một chuỗi đầu ra cho trước). Trạng thái ẩn cuối cùng của bộ mã hóa được sử dụng để tính toán biến ngữ cảnh có độ dài cố định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3204">C</span></span></span><script type="math/tex" id="MathJax-Element-322">C</script></span>, biểu diễn một bản tóm lược về mặt ngữ nghĩa của chuỗi đầu vào và được dùng làm đầu vào cho bộ giải mã.</p>
</blockquote><p>Nếu ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3206">C</span></span></span><script type="math/tex" id="MathJax-Element-323">C</script></span> là một vector, thì bộ giải mã đơn giản là một mạng neuron truy hồi vector-sang-chuỗi, như được mô tả trong phần 10.2.4. Như ta đã thấy, có ít nhất hai cách để một mạng neuron truy hồi vector-sang-chuỗi tiếp nhận đầu vào. Đầu vào có thể được cung cấp dưới dạng một trạng thái khởi tạo của mạng neuron truy hồi, hoặc đầu vào có thể được liên kết với các đơn vị ẩn ở mỗi bước thời gian. Ta cũng có thể kết hợp hai phương pháp này với nhau.</p><p>Không có ràng buộc rằng bộ mã hóa phải có cùng kích thước tầng ẩn với bộ giải mã.</p><p>Một hạn chế rõ ràng của kiến trúc này xuất hiện khi ngữ cảnh đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">C</span></span></span><script type="math/tex" id="MathJax-Element-324">C</script></span> của bộ mã hóa có kích thước quá nhỏ để tổng kết chính xác một chuỗi dài. Hiện tượng này được quan sát bởi [Bahdanau et al., 2015] trong bài toán dịch máy. Họ đã đề xuất biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">C</span></span></span><script type="math/tex" id="MathJax-Element-325">C</script></span> trở thành một chuỗi có chiều dài tùy ý thay vì một vector có kích thước cố định. Ngoài ra, họ cũng giới thiệu một <em>cơ chế tập trung</em> (attention) giúp học cách liên kết các phần tử của chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3212">C</span></span></span><script type="math/tex" id="MathJax-Element-326">C</script></span> với các phần tử của chuỗi đầu ra. Xem phần 12.4.5.1 để biết thêm chi tiết.</p><p>------------ Hung Le đã review đến đây-----------</p></div>