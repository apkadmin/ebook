<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-12-giai-đoạn-2">Chương 12 (giai đoạn 2)</h1><p><img src="https://i.imgur.com/IiJ0RPh.png" alt=""></p><blockquote>
<p>Hình 12.4: Minh họa một hệ thống phân cấp đơn giản của các hạng mục từ, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">8</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">8</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">8</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-6" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-7">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-15" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-16">7</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="msubsup" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mn" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">w_{0} ,. . . , w_{7}</script></span> được tổ chức thành hệ thống phân cấp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-22"><span class="mn" id="MathJax-Span-23" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">3</script></span> cấp độ. Các lá của cây đại diện cho các từ. Các nút bên trong đại diện cho các nhóm từ. Bất kỳ nút nào cũng có thể được lập chỉ mục theo chuỗi các quyết định nhị phân (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mn" id="MJXp-Span-20">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-25"><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">0</script></span> = trái, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-28"><span class="mn" id="MathJax-Span-29" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">1</script></span> = phải) để đi từ gốc đến nút. Lớp cha <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-25">0</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-30"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-31"><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-33" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">(0)</script></span> chứa các lớp con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-29">0</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-31">0</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-35"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-36"><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">(0,0)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-35">0</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-37">1</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-42"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-43"><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-45" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">(0,1)</script></span>, chứa các tập hợp các từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-43" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-44">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-48" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-49">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-50"><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-54"><span class="mrow" id="MathJax-Span-55"><span class="mn" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-58" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-60"><span class="mrow" id="MathJax-Span-61"><span class="mn" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\{w_{0}, w_{1}\}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-55" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-56">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-60" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-61">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-65"><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-73" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\{w_{2}, w_{3}\}</script></span>, tương tự như thế lớp cha (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mn" id="MJXp-Span-64">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-80"><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">1</script></span>) chứa các lớp con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-67">1</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-69">0</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-83"><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-85" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">(1,0)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-73">1</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-75">1</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-90"><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-92" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">(1,1)</script></span> tương ứng với tập hợp các từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-82">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-84"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-86" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-87">5</span></span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-97"><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-101"><span class="mrow" id="MathJax-Span-102"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-105" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mn" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Main;">5</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\{w_{4}, w_{5}\}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-93" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-94">6</span></span></span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-98" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-99">7</span></span></span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-112"><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mn" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main;">6</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-120" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mn" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\{w_{6}, w_{7}\}</script></span>. Nếu cây cân bằng, độ sâu tối đa (số lượng các quyết định nhị phân) sẽ là bậc của logarit của số từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mrow" id="MJXp-Span-102"><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-104"><span class="MJXp-mi undefined" id="MJXp-Span-105">V</span></span><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-16">|\mathbb{V}|</script></span>: việc tìm kiếm một từ trong số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mrow" id="MJXp-Span-109"><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-111"><span class="MJXp-mi undefined" id="MJXp-Span-112">V</span></span><span class="MJXp-mrow" id="MJXp-Span-113"><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-17">|\mathbb{V}|</script></span> từ có thể được thực hiện với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">O</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">g</span><span class="MJXp-mrow" id="MJXp-Span-121"><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-123"><span class="MJXp-mi undefined" id="MJXp-Span-124">V</span></span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-18">O(log|\mathbb{V}|)</script></span> thao tác (mỗi thao tác ứng với mỗi nút trên đường dẫn từ gốc). Trong ví dụ trên, việc tính toán xác suất của từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">y</script></span> có thể được thực hiện bằng cách tính tích của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mn" id="MJXp-Span-131">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">3</script></span> xác suất, kết hợp với các quyết định nhị phân để di chuyển sang trái hoặc phải tại mỗi nút trên đường dẫn từ gốc đến nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-21">y</script></span>. Cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-137" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">y</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-22">b_{i}(y)</script></span> là quyết định nhị phân thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">i</script></span> khi duyệt cây đến giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">y</script></span>. Xác suất lấy mẫu một đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-25">y</script></span> được phân tích thành một tích các xác suất có điều kiện, sử dụng quy tắc chuỗi cho các xác suất có điều kiện, với mỗi nút đã được lập chỉ mục bởi tiền tố của các bit này. Ví dụ, nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-150">1</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-152">0</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26">(1,0)</script></span> tương ứng với tiền tố <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-159">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-164">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-167">1</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-172">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-176" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-177">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-180">0</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-27">(b_{0} (w_{4}) = 1, b_{1} (w_{4}) = 0)</script></span>, và xác suất của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-msubsup" id="MJXp-Span-183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-185" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-186">4</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">w_{4}</script></span> có thể bị phân tích như sau:</p>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-187"><span class="MJXp-mtable" id="MJXp-Span-188"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-189" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-190" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">P</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">y</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-198">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-200" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-201"></span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-203" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">P</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-208" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-209">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-211">1</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-216">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-218">0</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-222" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-223">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-225">0</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-227" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-228" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-229" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-230"></span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-232" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">P</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-237" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-238">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-240">1</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">P</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-247">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-249">0</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-254">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-256">1</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">P</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-263">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-265">0</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-269" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-270">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-272">1</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-276" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-277">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-279">0</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">\begin{eqnarray}
P(y=w_{4}) &=& P(b_{0}=1,b_{1}=0,b_{2}=0) \tag{12.11} \\
&=&P(b_{0}=1)P(b_{1}=0\mid b_{0}=1)P(b_{2}=0\mid b_{0}=1,b_{1}=0). \tag{12.12}
\end{eqnarray}</script></span></p>
</blockquote><p>Ta vẫn còn một câu hỏi bỏ ngỏ, đó là làm thế nào để xác định các lớp từ này một cách tốt nhất, hoặc làm thế nào để xác định hệ thống phân cấp từ nói chung. Các nghiên cứu trước kia sử dụng hệ thống phân cấp hiện có [Morin and Bengio, 2005], nhưng hệ thống phân cấp cũng có thể được học, lý tưởng nhất là với mô hình neuron ngôn ngữ. Học cách phân cấp từ là rất khó. Việc tối ưu hóa chính xác logarit hàm hợp lý sẽ khó kiểm soát vì sự rời rạc trong cách chọn cách phân cấp từ, không tuân theo tối ưu hóa dựa trên gradient. Tuy nhiên, người ta có thể sử dụng tối ưu hóa rời rạc để tối ưu hóa xấp xỉ các <em>phân vùng</em> (partition) của từ thành các lớp từ.</p><p>Một lợi thế quan trọng của <em>softmax phân cấp</em> (hiararchical softmax) là nếu ta muốn tính toán xác suất của các từ cụ thể tại bước kiểm thử, phương pháp này sẽ mang lại lợi ích tính toán trong cả thời gian huấn luyện và thời gian kiểm thử.</p><p>Tất nhiên, tính toán xác suất của tất cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-285"><span class="MJXp-mi undefined" id="MJXp-Span-286">V</span></span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">|\mathbb{V}|</script></span> từ vẫn sẽ tốn kém ngay cả với softmax phân cấp. Một toán tử quan trọng khác là lựa chọn từ có khả năng xuất hiện nhất cho một ngữ cảnh cụ thể. Thật không may, cấu trúc cây không cung cấp một giải pháp hiệu quả và chính xác cho vấn đề này.</p><p>Về mặt bất lợi, trong thực tế, softmax phân cấp có xu hướng cho kết quả kiểm thử kém hơn so với các phương pháp chọn mẫu mà ta sẽ đề cập trong phần tiếp theo. Điều này có thể là do sự chọn lựa nghèo nàn của các lớp từ.</p><h3 id="12433-Lấy-mẫu-theo-độ-quan-trọng-Importance-sampling">12.4.3.3 Lấy mẫu theo độ quan trọng (Importance sampling)</h3><p>Một cách để tăng tốc quá trình huấn luyện của các mô hình neuron ngôn ngữ là tránh việc tính toán rõ ràng đóng góp của gradient cho các từ ngữ không xuất hiện ở vị trí tiếp theo. Chúng nên có xác suất thấp theo mô hình. Liệt kê tất cả các từ ngữ sẽ tốn chi phí tính toán. Thay vào đó, ta có thể lấy mẫu chỉ một tập con của các từ này. Sử dụng ký hiệu đã được đề cập trong phương trình 12.8, ta có thể viết gradient như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-289"><span class="MJXp-mtable" id="MJXp-Span-290"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-291" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-292" style="text-align: right;"><span class="MJXp-mfrac" id="MJXp-Span-293" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-294">∂</span><span class="MJXp-mi" id="MJXp-Span-295">log</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">P</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">y</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">C</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-303">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">θ</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-305" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-306"></span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-308" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-309">∂</span><span class="MJXp-mi" id="MJXp-Span-310">log</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">a</span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-323">a</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-325">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">θ</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-327" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-328" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-329" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-330"></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-332" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-333">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-334">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">θ</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-336">log</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-338" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-339"><span class="MJXp-msubsup" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-342" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">y</span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-349" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-352" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-355" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">i</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-357" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-358" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-359" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-360"></span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-362" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-363">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-364">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-369" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-372">log</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-374"><span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-379" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-385" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-386" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-387" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-388"></span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-390" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-391">∂</span><span class="MJXp-msubsup" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-394" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">y</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-396">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-399"><span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">P</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">y</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">i</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">C</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-410" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-411">∂</span><span class="MJXp-msubsup" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-415">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">\begin{align} \frac{\partial\log P(y\mid C)}{\partial\theta} &= \frac{\partial\log softmax_{y}(\boldsymbol{a})}{\partial\theta} \tag{12.13} \\ 
&= \frac{\partial}{\partial\theta}\log \frac{{e^{a_{y}}}}{\sum_i e^{a_{i}}} \tag{12.14} \\
&= \frac{\partial}{\partial\theta}(a_{y} - \log\sum_i e^{a_{i}}) \tag{12.15} \\
&= \frac{\partial a_{y}}{\partial\theta} - \sum_i P(y=i\mid C)\frac{\partial a_i}{\partial\theta}, \tag{12.16}\end{align}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-418"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-419">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">\boldsymbol a</script></span> là vector của các hàm kích hoạt presoftmax (hoặc điểm số), với mỗi phần tử cho mỗi từ. Số hạng đầu tiên là <strong>kỳ pha dương</strong> (positive phase), đẩy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-msubsup" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-423" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">a_y</script></span> lên, trong khi số hạng thứ hai là <strong>kỳ pha âm</strong> (negative phase), đẩy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">a_i</script></span> xuống cho tất cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">i</script></span>, với trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">P</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">i</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">C</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">P(i\mid C)</script></span>. Vì kỳ pha âm là một kỳ vọng, chúng ta có thể ước tính nó với mẫu Monte Carlo. Tuy nhiên việc này sẽ cần phải lấy mẫu từ chính mô hình. Lấy mẫu từ mô hình yêu cầu tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">P</span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">i</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">C</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">P(i\mid C)</script></span> cho tất cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">i</script></span> trong kho từ vựng, vốn chính xác là điều chúng ta cần phải tránh.</p><p>Do đó, thay vì lấy mẫu từ mô hình, chúng ta có thể lấy mẫu từ phân phối khác: <em>phân phối đề xuất</em> (proposal distribution) (ký hiệu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">q</script></span>) và sử dụng các trọng số thích hợp để sửa sai độ chệch bởi việc lấy mẫu từ một phân phối sai [Bengio and Sénécal, 2003; Bengio and Sénécal, 2008]. Đây là ứng dụng của một kỹ thuật tổng quát hơn được gọi là <strong>lấy mẫu theo độ quan trọng</strong>, ta sẽ mô tả chi tiết hơn trong phần 17.2. Thật không may, ngay cả việc lấy mẫu theo độ quan trọng một cách chính xác cũng không hiệu quả vì nó đòi hỏi các trọng số tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-452"><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-456" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">p_i/q_i</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-msubsup" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-460" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">P</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">i</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">C</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">p_i = P (i\mid C)</script></span>, chỉ có thể được tính khi mọi điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">a_i</script></span> được tính. Giải pháp đưa ra cho ứng dụng này được gọi là <strong>lấy mẫu thiên vị theo độ quan trọng</strong>, trong đó các trọng số của độ quan trọng được chuẩn hóa để có tổng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mn" id="MJXp-Span-473">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">1</script></span>. Khi từ phủ định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-msubsup" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-477" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">n_i</script></span> được lấy mẫu, gradient tương ứng sẽ có trọng số là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-478"><span class="MJXp-mtable" id="MJXp-Span-479"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-480" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-481" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-484" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-486" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-489" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-492" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">i</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-494"><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-496"><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-499" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-502" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">i</span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-504"><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">N</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">j</span><span class="MJXp-mo" id="MJXp-Span-508">=</span><span class="MJXp-mn" id="MJXp-Span-509">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-513" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-516" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">j</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-518"><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-520"><span class="MJXp-msubsup" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-523" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-526" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">j</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-45"> w_i = \frac{p_{n_{i}}/{q_{n_{i}}}}{\sum_{j=1}^N p_{n_{j}}/{q_{n_{j}}}}. \tag{12.17}</script></span></p><p>Các trọng số này được sử dụng để đánh giá tầm quan trọng thích hợp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">m</script></span> mẫu âm tính từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">q</script></span> được sử dụng để tạo thành ước tính ước lượng pha âm cho gradient:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-533"><span class="MJXp-mtable" id="MJXp-Span-534"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-535" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-536" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-537"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-543" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mrow" id="MJXp-Span-544"><span class="MJXp-mo" id="MJXp-Span-545">|</span></span><span class="MJXp-mrow" id="MJXp-Span-546"><span class="MJXp-mi undefined" id="MJXp-Span-547">V</span></span><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-mo" id="MJXp-Span-549">|</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-539" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">i</span><span class="MJXp-mo" id="MJXp-Span-541">=</span><span class="MJXp-mn" id="MJXp-Span-542">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">P</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">i</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">C</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-556" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-557">∂</span><span class="MJXp-msubsup" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-560" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-561">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mfrac" id="MJXp-Span-564" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-565">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-567"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-569" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">i</span><span class="MJXp-mo" id="MJXp-Span-571">=</span><span class="MJXp-mn" id="MJXp-Span-572">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-576" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mfrac" id="MJXp-Span-577" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-578">∂</span><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-581" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-584" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-585">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-48"> \sum_{i=1}^{|\mathbb{V}|}P(i\mid C)\frac{\partial a_i}{\partial\theta} \approx\frac{1}{m}\sum_{i=1}^m w_i \frac{\partial a_{n_i}}{\partial\theta}. \tag{12.18}</script></span></p><p>Phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-588"><span class="MJXp-mn" id="MJXp-Span-589">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">1</script></span>-gram (unigram) hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mn" id="MJXp-Span-591">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">2</script></span>-gram (bigram) hoạt động tốt như phân phối đề xuất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">q</script></span>. Ta có thể dễ dàng tính các tham số của phân phối này từ dữ liệu. Sau đó, ta còn có thể lấy mẫu rất hiệu quả.</p><p>Lấy mẫu theo độ quan trọng không chỉ hữu ích cho việc tăng tốc các mô hình với các đầu ra softmax lớn. Tổng quát hơn, nó rất hữu ích cho việc tăng tốc huấn luyện với các tầng đầu ra thưa thớt lớn, trong đó đầu ra là một vector thưa chứ không phải là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mn" id="MJXp-Span-595">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">1</script></span>-trong-<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">n</script></span> lựa chọn. Một ví dụ là <strong>túi từ</strong> (bag of words). Một túi từ là một vector thưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">v</script></span> trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-603" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">v_i</script></span> biểu thị sự hiện diện hoặc vắng mặt của từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">i</script></span> trong văn bản, từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">i</script></span> tồn tại trong kho từ vựng. Qua đó, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-608"><span class="MJXp-msubsup" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-611" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">v_i</script></span> có thể cho biết số lần mà từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">i</script></span> xuất hiện. Các mô hình học máy cho ra các vector thưa như vậy có thể cần được huấn luyện khá tốn kém bởi vì nhiều lý do khác nhau. Trong quá trình học trước đây, mô hình thường không được chọn với mục đích làm cho đầu ra thưa thớt. Hơn nữa, hàm mất mát mà ta sử dụng để huấn luyện có thể được mô tả một cách tự nhiên nhất về mặt so sánh từng phần tử của đầu ra với từng phần tử của mục tiêu. Điều này có nghĩa là sử dụng đầu ra thưa thớt không phải lúc nào cũng có lợi về mặt tính toán, bởi vì có thể chọn mô hình sao cho phần lớn các đầu ra khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mn" id="MJXp-Span-615">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">0</script></span>, và những giá trị khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-mn" id="MJXp-Span-617">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">0</script></span> này cần phải được so sánh với mục tiêu huấn luyện tương ứng, ngay cả khi mục tiêu huấn luyện bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-mn" id="MJXp-Span-619">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">0</script></span>. Dauphin và cộng sự (2011) đã chứng minh rằng các mô hình như vậy có thể được tăng tốc bằng cách sử dụng lấy mẫu theo mức độ quan trọng. Thuật toán hiệu quả sẽ cực tiểu hóa mất mát khôi phục cho “từ dương tính - positive word” (những từ có giá trị khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-620"><span class="MJXp-mn" id="MJXp-Span-621">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">0</script></span> trong mục tiêu) và cho số lượng tương tự “từ âm tính - negative word”. Các từ âm tính được chọn ngẫu nhiên, dựa theo kinh nghiệm để lấy mẫu các từ có nhiều khả năng bị nhầm lẫn. Độ lệch gây ra bởi việc lấy quá nhiều mẫu theo kinh nghiệm này sau đó có thể được sửa chữa bằng cách sử dụng trọng số theo độ quan trọng.</p><p>Trong tất cả các trường hợp này, độ phức tạp tính toán của phép ước lượng gradient cho tầng đầu ra sẽ được giảm thiểu tỷ lệ thuận với số lượng mẫu âm tính hơn là tỷ lệ thuận với kích thước của vector đầu ra.</p><h3 id="12434-Ước-lượng-tính-tương-phản-nhiễu-và-xếp-hạng-mất-mát-Noise-Contrastive-Estimation-and-Ranking-Loss">12.4.3.4 Ước lượng tính tương phản nhiễu và xếp hạng mất mát (Noise-Contrastive Estimation and Ranking Loss)</h3><p>Các phương pháp dựa trên lấy mẫu khác đã được đề xuất để giảm bớt chi phí tính toán trong việc huấn luyện các mô hình neuron ngôn ngữ có lượng từ vựng lớn. Một ví dụ trước đây là cách xếp hạng mất mát được Collobert và Weston (2008a) đề xuất, xem mỗi từ đầu ra của mô hình neuron ngôn ngữ là một điểm số và cố gắng làm cho điểm số của từ chính xác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-622"><span class="MJXp-msubsup" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-625" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">a_y</script></span> được xếp hạng cao hơn so với các điểm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-626"><span class="MJXp-msubsup" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-629" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">a_i</script></span> khác. Xếp hạng mất mát được đề xuất sau đó là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-630"><span class="MJXp-mtable" id="MJXp-Span-631"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-632" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-633" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">L</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-636"><span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">x</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-643">0</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-645">1</span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-653" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-66"> L=\sum_i max(0, 1 - a_y + a_i).\tag{12.19} </script></span></p><p>Gradient sẽ bằng $$ cho số hạng thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">i</script></span> nếu điểm số của từ được quan sát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-658"><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-661" style="vertical-align: -0.4em;">y</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">a_y</script></span>, lớn hơn điểm của từ âm tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">a_i</script></span> theo cận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mn" id="MJXp-Span-667">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">1</script></span>. Có một vấn đề với tiêu chí này là nó không cung cấp các xác suất có điều kiện được ước lượng, thứ rất hữu ích trong một số ứng dụng, bao gồm nhận dạng giọng nói và sinh văn bản (bao gồm các tác vụ tạo văn bản có điều kiện ví dụ như dịch thuật).</p><p>Một mục tiêu huấn luyện được sử dụng gần đây cho các mô hình neuron ngôn ngữ là <em>ước lượng tính tương phản nhiễu</em> (noise contrastive estimation), sẽ trình bày trong phần 18.6. Cách tiếp cận này đã được áp dụng thành công cho các mô hình neuron ngôn ngữ [Mnih and Teh, 2012; Mnih and Kavukcuoglu, 2013].</p><h2 id="1244-Kết-hợp-các-mô-hình-neuron-ngôn-ngữ-với-n-gram">12.4.4 Kết hợp các mô hình neuron ngôn ngữ với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">n</script></span>-gram</h2><p>Ưu điểm vượt trội của các mô hình ngôn ngữ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">n</script></span>-gram so với mạng neuron là các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">n</script></span>-gram đạt được dung lượng mô hình cao (bằng cách lưu trữ các tần số của rất nhiều <em>ống</em> (tuple) dữ liệu) trong khi chỉ yêu cầu rất ít chi phí tính toán để xử lý một mẫu dữ liệu (bằng cách chỉ tra cứu một vài ống dữ liệu phù hợp với ngữ cảnh hiện tại). Nếu chúng ta sử dụng <em>bảng băm</em> (hash table) hoặc <em>cây tìm kiếm</em> (tree) để truy cập số đếm thì chi phí tính toán sử dụng cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">n</script></span>-gram gần như không phụ thuộc vào dung lượng. Trong khi đó, nếu ta gấp đôi số lượng tham số của mạng neuron thì thời gian tính toán cũng thường tăng gấp đôi. Các mô hình tránh sử dụng tất cả tham số trong từng lượt cũng nằm trong ngoại lệ này. Các <em>tầng nhúng</em> (embedding layer) <em>đánh chỉ mục</em> (index) chỉ trên một phép nhúng đơn lẻ trong mỗi lượt, vì vậy chúng ta có thể tăng kích thước kho từ vựng mà không làm tăng thời gian tính toán cho mỗi mẫu dữ liệu. Một số mô hình khác, chẳng hạn như <em>mạng tích chập xếp chồng</em> (tiled convolutional network), có thể thêm các tham số trong khi giảm mức độ chia sẻ tham số để duy trì cùng một khối lượng tính toán. Tuy nhiên, các tầng mạng neuron điển hình dựa trên phép nhân ma trận vẫn sử dụng một lượng tính toán tỷ lệ thuận với số lượng tham số.</p><p>Một cách dễ dàng để tăng dung lượng mô hình là kết hợp cả hai phương pháp thành một <em>hợp thể</em> (ensemble) bao gồm một mô hình neuron ngôn ngữ và một mô hình ngôn ngữ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">n</script></span>-gram [Bengio et al., 2001, 2003]. Như với bất kỳ hợp thể nào, kỹ thuật này có thể làm giảm sai số kiểm thử nếu các thành phần hợp thể gây ra những lỗi riêng biệt. Lĩnh vực <em>học hợp thể</em> (ensemble learning) cung cấp nhiều cách kết hợp các dự đoán của các thành phần trong hợp thể, bao gồm <em>đánh trọng số đồng dạng</em> (uniform weighting) và chọn trọng số dựa trên tập xác thực. Mikolov và cộng sự (2011a) đã mở rộng việc học hợp thể để không chỉ bao gồm hai mô hình mà có thể kết hợp một mảng nhiều mô hình. Ta cũng có thể ghép cặp một mạng neuron với một mô hình entropy cực đại và huấn luyện cùng nhau [Mikolov et al., 2011b]. Cách tiếp cận này có thể được xem như là huấn luyện một mạng neuron với một tập đầu vào bổ sung được kết nối trực tiếp với đầu ra và không kết nối với bất kỳ phần nào khác của mô hình. Các đầu vào bổ sung là bộ <em>chỉ báo</em> cho sự hiện diện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">n</script></span>-gram cụ thể trong ngữ cảnh đầu vào, do đó, các biến này có số chiều rất lớn và rất thưa thớt. Cung lượng mô hình sẽ tăng rất lớn - phần mới của kiến trúc có thể chứa đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">V</span><span class="MJXp-msubsup" id="MJXp-Span-685"><span class="MJXp-mrow" id="MJXp-Span-686" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-688" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">|sV|^n</script></span> tham số — nhưng chỉ cần tính toán thêm rất ít để xử lý đầu vào vì các đầu vào bổ sung này thưa thớt.</p><h1 id="1245-Dịch-máy-neuron">12.4.5 Dịch máy neuron</h1><p>Dịch máy là tác vụ đọc một câu từ một ngôn ngữ tự nhiên và chuyển thành một câu đồng nghĩa trong một ngôn ngữ khác. Các hệ thống dịch máy thường bao gồm nhiều bộ phận. Ở cấp độ cao hơn, thường có một bộ phận gợi ý các bản dịch. Đa phần các bản dịch này sẽ không đúng về mặt ngữ pháp do sự khác nhau giữa các ngôn ngữ. Ví dụ, nhiều ngôn ngữ đặt tính từ sau danh từ. Vì vậy, khi dịch trực tiếp sang tiếng Anh, chúng tạo ra các cụm từ như là “apple red”. Một cách lí tưởng, các hệ thống gợi ý đề xuất nhiều biến thể của các bản dịch, bao gồm cả “red apple”. Bộ phận thứ hai của hệ thống dịch là một mô hình ngôn ngữ, đánh giá các bản dịch gợi ý và có thể cho điểm “red apple” cao hơn “apple red.”</p><p>Các mạng neuron được phát triển sớm nhất cho dịch máy đã có sự kết hợp ý tưởng của bộ giải mã và bộ mã hóa [Allen 1987; Chrisman 1991, Forcada and Ñeco 1997], trong khi việc sử dụng tính cạnh tranh của mạng neuron trong dịch thuật ở quy mô lớn lần đầu tiên là để nâng cấp mô hình ngôn ngữ của hệ thống dịch thuật [Schwenk et al., 2006; Schwenk, 2010]. Trước đó, hầu hết mọi hệ thống dịch máy đều sử dụng mô hình <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-78">n</script></span>-gram</em> cho thành phần này. Các mô hình dựa trên <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">n</script></span>-gram</em> được sử dụng cho dịch máy không chỉ có các mô hình <em>back-off <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">n</script></span>-gram</em> truyền thống [Jelinek and Mercer, 1980; Katz, 1987; Chen and Goodman, 1999] mà còn có các <strong>mô hình ngôn ngữ entropy cực đại</strong> (maximum entropy language models) [Berger et al., 1996], trong đó bao gồm một tầng <em>affine-softmax</em> dự đoán từ tiếp theo khi biết sự hiện diện của các <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">n</script></span>-grams</em> thường xuyên trong một ngữ cảnh cụ thể.</p><p>Các mô hình ngôn ngữ truyền thống chỉ đơn giản báo cáo xác xuất của một câu trong ngôn ngữ tự nhiên. Bởi vì dịch máy liên quan đến việc tạo ra câu mới từ câu cho trước, cho nên việc mở rộng mô hình ngôn ngữ tự nhiên theo hướng điều kiện hóa cũng khá hợp lý. Như đã mô tả trong phần 6.2.1.1, mở rộng mô hình đã định nghĩa phân phối cận biên trên một số biến sẽ đơn giản hơn so với việc định nghĩa phân phối có điều kiện trên biến trong ngữ cảnh <em>C</em>, với <em>C</em> có thể là một biến đơn hoặc một danh sách các biến. Devlin và cộng sự (2014) đã vượt qua kỷ lục (state-of-the-art) trên các phép đánh giá dịch máy thống kê bằng việc sử dụng MLP để chấm điểm một cụm từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-700" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-704" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">t_1, t_2, \dots, t_k</script></span> ở ngôn ngữ đích tương ứng với một cụm từ được cho sẵn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-711"><span class="MJXp-msubsup" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-714" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-718" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-724" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">s_1, s_2, \dots, s_k</script></span> trong ngôn ngữ gốc. MLP ước lược <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">P</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-730" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-734" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-740" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-742"><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-744">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-747" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-751" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-757" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">P(t_1, t_2, \dots, t_k \space| \space s_1, s_2, \dots, s_k)</script></span>. Ước lượng này được dùng để thay thế cho ước lượng của các mô hình <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">n</script></span>-gram</em> có điều kiện.</p><p><img src="https://i.imgur.com/1hqb1ww.png" alt=""></p><blockquote>
<p>Hình 12.5: Kiến trúc của bộ <em>mã hóa - giải mã</em> để biểu diễn ánh xạ qua lại giữa biểu diễn tường minh (như là một chuỗi các từ hoặc một hình ảnh) và biểu diễn ngữ nghĩa. Bằng việc sử dụng đầu ra của bộ giải mã từ một ngôn ngữ (như là giải mã một câu trong tiếng Pháp thành các biểu diễn tiềm ẩn chứa nghĩa của câu) làm đầu vào cho bộ mã hóa của một ngôn ngữ khác (như là việc chuyển đổi ngữ nghĩa ở các biểu diễn tiềm ẩn thành câu trong tiếng Anh), chúng ta có thể huấn luyện các hệ thống để dịch từ ngôn ngữ này sang ngôn ngữ khác. Ý tưởng này được áp dụng thành công không chỉ trong dịch máy mà còn để tạo tiêu đề cho hình ảnh.</p>
</blockquote><p>Một hạn chế của mô hình MLP là nó đòi hỏi các câu phải trải qua khâu tiền xử lý để có một độ dài cố định. Nhằm giúp cho bản dịch linh hoạt hơn, ta chuộng một mô hình mà có thể tương thích với các đầu vào và đầu ra có độ dài không cố định. Một mạng neuron truy hồi (RNN) có thể giải quyết vấn đề này. Phần <em>10.2.4</em> mô tả một vài cách xây dựng mạng RNN để biểu diễn phân phối có điều kiện trên một chuỗi các đầu vào cho sẵn, và phần <em>10.4</em> mô tả cách tiếp cận điều kiện này khi đầu vào là một chuỗi. Trong mọi trường hợp, mô hình đều đọc chuỗi đầu vào và tạo ra một cấu trúc dữ liệu để tóm tắt chuỗi đầu vào ở bước đầu tiên. Chúng ta gọi bản tóm tắt này là “ngữ cảnh” <em>C</em>. Ngữ cảnh <em>C</em> có thể là một danh sách các vector, một vector hoặc một tensor. Mô hình tạo ra <em>C</em> từ đầu vào có thể là một mạng RNN [Cho et al., 2014a; Sutskever et al., 2014; Jean et al., 2014] hoặc là một mạng tích chập [Kalchbrenner and Blunsom, 2013]. Mô hình thứ hai, thường là mạng RNN, tạo ra câu trong ngôn ngữ đích từ ngữ cảnh <em>C</em>. Ý tưởng của bộ khung (framework) cho bộ giải mã-mã hóa cho tác vụ dịch máy được trình bày trong hình <em>12.5</em>.</p><p>Để tạo ra một câu hoàn chỉnh có điều kiện từ một câu gốc, mô hình phải có cách biểu diễn được câu gốc hoàn chỉnh. Những mô hình đầu tiên chỉ có thể biểu diễn từng từ hoặc từng cụm từ. Từ quan điểm của phương pháp <em>học biểu diễn</em> (representation learning), việc học cách biểu diễn sao cho các câu có cùng ngữ nghĩa cũng có cùng cách biểu diễn bất kể chúng được viết bằng ngôn ngữ nguồn hay ngôn ngữ đích, có thể tỏ ra hữu ích. Chiến lược này được phát hiện lần đầu đầu tiên bằng cách sử dụng kết hợp các mạng tích chập và các mạng RNN [Kalchbrenner and Blunsom, 2013]. Mô hình kết hợp này cho ta thấy ứng dụng của mạng RNN để đánh giá các bản dịch gợi ý [Cho et al., 2014a] và để tạo ra các câu dịch [Sutskever et al., 2014]. Jean và cộng sự (2014) đã mở rộng quy mô các mô hình này với một bộ từ vựng lớn hơn.</p><h3 id="12451-Cơ-chế-tập-trung-và-sắp-xếp-các-mẩu-của-dữ-liệu-aligning-pieces-of-data">12.4.5.1 Cơ chế tập trung và <em>sắp xếp các mẩu của dữ liệu</em> (aligning pieces of data)</h3><p>Để nắm bắt các chi tiết về ngữ nghĩa của một câu rất dài, ví như cỡ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mn" id="MJXp-Span-762">60</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">60</script></span> từ, bằng một biểu diễn có kích thước cố định là rất khó. [Cho et al., 2014a] và [Sutskerver et al., 2014] đã đề xuất phương pháp giải quyết vấn đề này bằng cách huấn luyện mạng RNN đủ lớn, đủ tốt trong một khoảng thời gian đủ dài. Tuy nhiên, có một cách tiếp cận hiệu quả hơn đó là đọc toàn bộ câu hoặc đoạn văn (để nắm được ngữ cảnh và ý chính được diễn tả), từ đó dịch lần lượt từng từ, mỗi lần lại tập trung vào mỗi phần khác nhau của câu gốc để lấy được các chi tiết về ngữ nghĩa nhằm tạo ra từ tiếp theo của câu đầu ra. Ý tưởng này được giới thiệu lần đầu bởi Bahdanau và cộng sự (2015). Hình <em>12.6</em> mô tả cơ chế tập trung được sử dụng trên các phần đặc biệt của câu gốc qua từng bước.</p><p><strong>Hệ thống hướng tập trung</strong> có ba phần:</p><ol>
<li>
<p>Một bộ phận <em>đọc</em> dữ liệu thô (ví dụ như các từ trong câu gốc) và chuyển đổi chúng thành các biểu diễn có dạng phân phối, với mỗi vector đặc trưng tương ứng với mỗi vị trí của từ.</p>
</li>
<li>
<p>Một chuỗi các vector đặc trưng được lưu dưới dạng đầu ra của phần đọc. Chúng được hiểu là một <em>bộ nhớ</em> có chứa chuỗi các sự thật, có thể truy xuất sau này, không nhất thiết phải có cùng thứ tự, mà không phải truy xuất tất cả.</p>
</li>
<li>
<p>Một bộ phận <em>khai thác</em> nội dung của bộ nhớ để thực hiện tuần tự từng công việc, có khả năng tập trung vào nội dung của một (hoặc một vài) ô nhớ ở từng bước, với trọng số khác nhau.</p>
</li>
</ol><p>Bộ phận thứ ba sinh ra câu ở ngôn ngữ đích.</p><p>Khi các từ trong một câu của một ngôn ngữ phù hợp với các từ tương ứng của câu đã dịch ra trong ngôn ngữ khác, việc kết hợp để tạo ra phép nhúng từ tương ứng sẽ trở nên khả thi. Những nghiên cứu trước đây chỉ ra rằng tồn tại một phương pháp có thể học một loại <em>ma trận dịch thuật</em> (translation matrix) ứng với phép nhúng từ tương ứng của ngôn ngữ gốc và ngôn ngữ đích [Kočiský et al., 2014], cho ra tỉ lệ lỗi thấp hơn so với các phương pháp truyền thống dựa trên tần số xuất hiện của từ trong bảng cụm từ. Trước đó còn có nghiên cứu về việc học các <em>vector xuyên ngôn ngữ</em> (cross-lingual word vector) [Klementiev et al., 2012]. Nhiều nghiên cứu mở rộng cho phương pháp này cũng khả thi. Ví dụ, một cách <em>căng chỉnh xuyên ngôn ngữ</em> (cross-lingual alignment) hiệu quả hơn của [Gouws et al., 2014] cho phép huấn luyện trên những bộ dữ liệu có kích thước lớn hơn.</p><p><img src="https://i.imgur.com/XK44k9w.png" alt=""></p><blockquote>
<p>Hình 12.6: Mô hình cơ chế tập trung hiện đại, do Bahdanau và cộng sự (2015) giới thiệu, về bản chất là một trung bình có trọng số. Một vector ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-763"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-764">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">\boldsymbol{c}</script></span> được tạo nên bằng cách lấy trung bình có trọng số của các vector đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-msubsup" id="MJXp-Span-766"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-767" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-768" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-769">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">t</span><span class="MJXp-mo" id="MJXp-Span-771">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">\boldsymbol{h}^{(t)}</script></span> với các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-772"><span class="MJXp-msubsup" id="MJXp-Span-773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774" style="margin-right: 0.05em;">α</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-775" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-776">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">t</span><span class="MJXp-mo" id="MJXp-Span-778">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">\alpha^{(t)}</script></span>. Ở một số ứng dụng, các vector đặc trưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-780">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">\boldsymbol{h}</script></span> là các tầng ẩn của một mạng neuron, nhưng chúng cũng có thể là đầu vào thô của mô hình. Các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-msubsup" id="MJXp-Span-782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783" style="margin-right: 0.05em;">α</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-784" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-785">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">t</span><span class="MJXp-mo" id="MJXp-Span-787">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">\alpha^{(t)}</script></span> được tạo ra bởi chính mô hình. Chúng thường có giá trị nằm trong khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-790">0</span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-792">1</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">[0,1]</script></span> và được chỉ định tập trung quanh một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-msubsup" id="MJXp-Span-795"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-796" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-797" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-798">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">t</span><span class="MJXp-mo" id="MJXp-Span-800">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">\boldsymbol{h}^{(t)}</script></span> sao cho trung bình có trọng số xấp xỉ đọc được một bước thời gian cụ thể một cách chính xác. Các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-801"><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803" style="margin-right: 0.05em;">α</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-804" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-805">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">t</span><span class="MJXp-mo" id="MJXp-Span-807">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">\alpha^{(t)}</script></span> thường được tạo ra bằng cách áp dụng hàm softmax vào các điểm số thích hợp tạo bởi các phần khác của mô hình. Cơ chế tập trung cần tính toán phức tạp hơn so với phương pháp đánh chỉ mục trực tiếp vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-808"><span class="MJXp-msubsup" id="MJXp-Span-809"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-810" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-811" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-812">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">t</span><span class="MJXp-mo" id="MJXp-Span-814">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">\boldsymbol{h}^{(t)}</script></span>, nhưng đánh chỉ mục trực tiếp lại không thể huấn luyện bằng phương pháp trượt gradient. Cơ chế tập trung dựa trên các trung bình có trọng số dễ dàng tính toán đạo hàm để huấn luyện với các thuật toán tối ưu ở thời điểm hiện tại.</p>
</blockquote><h2 id="1246-Quan-điểm-lịch-sử">12.4.6 Quan điểm lịch sử</h2><p>Ý tưởng của việc biểu diễn phân phối các <em>kí hiệu</em> (symbol) được đưa ra bởi Rumelhart và cộng sự (1986a) là một trong những khám phá sớm nhất của phương pháp lan truyền ngược, các kí hiệu tương ứng với định danh của các thành viên trong gia đình. Mạng neuron dùng để nắm bắt mối quan hệ giữa các thành viên, với dữ liệu huấn luyện có dạng bộ ba ví dụ như (Colin, Mother, Victoria). Tầng đầu tiên của mạng neuron học cách biểu diễn của mỗi thành viên. Ví dụ, các thuộc tính của Colin biểu diễn Colin đang thuộc cây gia đình nào, ở nhánh nào của cây và anh ta ở thế hệ nào, và cứ thế… Người ta có thể xem mạng neuron như là một công cụ tính toán có thể học mối liên hệ giữa các thuộc tính với nhau để có được dự đoán mong muốn. Mô hình có thể dự đoán ai là mẹ của Colin bằng suy luận.</p><p>Ý tưởng của việc hình thành phép nhúng cho các kí hiệu được mở rộng thành ý tưởng về phép nhúng cho một từ bởi Deerwester và cộng sự (1990). Các phép nhúng này được học bằng việc sử dụng phép phân tích giá trị suy biến =(Singular Vector Decomposition - SVD). Sau này, các phép nhúng được học bằng mạng neuron.</p><p>Lịch sử của xử lý ngôn ngữ tự nhiên được đánh dấu bằng những bước chuyển tiếp về tính phổ biến của các phép biểu diễn đầu vào khác nhau cho mô hình. Tiếp nối các nghiên cứu trên kí hiệu và từ ngữ, một vài ứng dụng sớm nhất của mạng neuron vào lĩnh vực xử lý ngôn ngữ tự nhiên [Miikkulainen and Dyer, 1991; Schnidhuber, 1996] đã biểu diễn đầu vào như là một chuỗi các ký tự.</p><p>Bengio và cộng sự (2001) đã tập trung vào việc mô hình hóa các từ và giới thiệu các mô hình ngôn ngữ neuron, thứ tạo ra các phép nhúng từ có thể diễn dịch được. Những mô hình neuron này đã mở rộng định nghĩa của việc biểu diễn một tập hợp nhỏ các kí hiệu ở thập niên 80 thành hàng triệu từ ở các ứng dụng hiện tại (bao gồm cả danh từ riêng và các lỗi chính tả). Nỗ lực mở rộng tính toán này đã sinh ra các kỹ thuật đã mô tở ở phần 12.4.3.</p><p>Đầu tiên, việc sử dụng các từ ngữ làm đơn vị cơ bản của mô hình đã cải thiện hiệu suất của việc mô hình hóa ngôn ngữ [Bengio et al., 2001]. Đến ngày nay, nhiều kỹ thuật mới liên tục thúc đẩy cả <em>mô hình dựa trên ký tự</em> (character-based model) [Sutskever et al., 2011] và mô <em>hình dựa trên từ</em> (word-based model) cùng phát triển. Kể cả nghiên cứu mô hình hóa từng byte trong bảng ký tự Unicode gần đây [Gillick et al., 2015].</p><p>Các ý tưởng đằng sau các mô hình ngôn ngữ neuron đã và đang được mở rộng sang một vài ứng dụng xử lý ngôn ngữ tự nhiên, như là: <em>phân tích cú pháp</em> (parsing) [Henderson, 2003, 2004, Collobert, 2011], <em>gắn nhãn từ loại</em> (part-of-speech tagging), <em>gắn nhãn vai trò ngữ nghĩa</em> (semantic role labeling), <em>phân đoạn</em> (chunking),…, thỉnh thoảng áp dụng cả kiến trúc <em>học đa nhiệm</em> (learning architecture) trong đó các phép nhúng từ được chia sẻ giữa các tác vụ.</p><p>Các minh họa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-815"><span class="MJXp-mn" id="MJXp-Span-816">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">2</script></span> chiều của các phép nhúng đã trở thành một công cụ phổ biến cho các mô hình phân tích ngôn ngữ tiếp nối sự phát triển của giải thuật giảm số chiều t-SNE [van der Maaten and Hinton, 2008] và ứng dụng đáng chú ý của nó để minh họa các phép nhúng từ bởi Joseph Turian (2009).</p><h1 id="125-Các-ứng-dụng-khác">12.5 Các ứng dụng khác</h1><p>Trong phần này, chúng tôi trình bày một số loại ứng dụng khác của học sâu khác với các tác vụ như nhận diện vật thể tiêu chuẩn, nhận diện giọng nói và xử lý ngôn ngữ tự nhiên đã thảo luận ở trên. Phần <strong>III</strong> của cuốn sách này sẽ mở rộng phạm vi đến cả các tác vụ vẫn còn đang ở lĩnh vực thuần nghiên cứu.</p><h2 id="1251-Các-hệ-thống-gợi-ý">12.5.1 Các hệ thống gợi ý</h2><p>Một trong những ứng dụng chính của học máy trong ngành công nghệ thông tin là khả năng đưa ra các gợi ý sẩn phẩm đến người dùng hoặc khách hàng tiềm năng. Các ứng dụng có thể được chia thành hai loại chính: quảng cáo trực tuyến (online advertising) và gợi ý mặt hàng (những gợi ý này thường vẫn được sử dụng cho mục đích bán sản phẩm). Cả hai dựa trên việc dự đoán mối liên hệ giữa một người dùng và một mặt hàng; để dự đoán xác suất của một vài hành động (người dùng mua hàng, hoặc một vài ủy nhiệm cho hành động này) hoặc dự đoán lợi ích mong muốn (có thể phụ thuộc vào giá trị của mặt hàng) nếu một quảng cáo được hiển thị hoặc một gợi ý được đưa ra nhằm giới thiệu mặt hàng đó cho người dùng đó. Mạng Internet đang có nhiều hình thức quảng cáo trực tuyến mang lại lợi ích kinh tế đáng kể ở thời điểm hiện tại. Các phần chính của nền kinh tế dựa trên mua sắm trực tuyến. Các công ty như Amazon và eBay sử dụng học máy, bao gồm học sâu, để gợi ý các mặt hàng của họ. Đôi khi, sản phẩm gợi ý không phải là các mặt hàng để bán. Ví dụ như lựa chọn các bài đăng để hiển thị trên bản tin mạng xã hội, gợi ý các bộ phim để xem, gợi ý các câu chuyện cười, gợi ý lời khuyên của chuyên gia, kết nối người chơi trong trò chơi điện tử hoặc bắt cặp cho những người tham gia các dịch vụ hẹn hò.</p><p>Bài toán tìm ra mối liên hệ này thường được xử lý như là một bài toán học có giám sát: cho trước một vài thông tin về mặt hàng và khách hàng, dự đoán các mặt hứng thú (người dùng nhấp chuột vào quảng cáo, người dùng nhập một đánh giá, người dùng nhấp chuột vào một nút “thích”, người dùng mua sản phẩm, người dùng chi một số tiền để mua sản phẩm, người dùng dành thời gian để truy cập trang web của sản phẩm,…). Nó thường trở thành một bài toán hồi quy (dự đoán một vài giá trị ràng buộc mong muốn) hoặc một bài toán phân loại đựa trên xác suất (dự đoán xác suất có điều kiện của một vài sự kiện rời rạc).</p><p>Những nghiên cứu đầu tiên của các hệ thống gợi ý dựa trên các thông tin rất nhỏ để làm đầu vào cho các dự đoán này: ID của người dùng và ID của mặt hàng. Trong ngữ cảnh này, cách duy nhất để khái quát hóa là dựa trên sự tương đồng giữa các mô thức của các giá trị thuộc biến đích đối với những người dùng khác nhau hoặc các mặt hàng khác nhau. Giả sử rằng người dùng 1 và người dùng 2 đều thích các mặt hàng A, B và C. Từ đó, chúng ta có thể suy ra người dùng 1 và người dùng 2 có chung sở thích. Nếu người dùng 1 thích mặt hàng D, ta có thể gợi ý rằng người dùng 2 cũng sẽ thích D. Các thuật toán dựa trên nguyên tắc này có tên là <strong>lọc cộng tác</strong> (collaborative filtering). Kể cả phương pháp không có tham số (như là các phương pháp tìm các điểm gần nhất dựa trên ước lượng sự tương đồng giữa các mô thức của sự ưa thích) và phương pháp có tham số đều khả thi. Phương pháp có tham số thường dựa trên việc học một phân phối của biểu diễn (có thể gọi là một phép nhúng) cho mỗi người dùng và mỗi mặt hàng. Dự đoán <em>song tuyến tính</em> (bilinear) của các biến đích (như là một đánh giá) là một phương pháp sử dụng tham số đơn giản mang hiệu quả cao và thường là bộ phần xuất hiện trong các hệ thống tiên tiến nhất. Hệ thống dự đoán này được tạo ra từ tích vô hướng giữa vector nhúng của người dùng và mặt hàng (thường được chỉnh sửa dựa trên các hằng số chỉ phụ thuộc vào ID của người dùng hoặc ID của mặt hàng). Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mrow" id="MJXp-Span-818"><span class="MJXp-munderover" id="MJXp-Span-819"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-820">R</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">\hat{\boldsymbol{R}}</script></span> là ma trận chứa các dự đoán của chúng ta, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-823">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol{A}</script></span> là một ma trận có các hàng ứng với các vector nhúng của người dùng, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-825">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">\boldsymbol{B}</script></span> là ma trận có các cột ứng với các vector nhúng của các mặt hàng. Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-827">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\boldsymbol{b}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-829">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">\boldsymbol{c}</script></span> là các vector tương ứng với một hệ số tự do cho mỗi người dùng (biểu hiễn mức độ cáu gắt hay tích cực của người dùng đó nói chung) và cho mỗi mặt hàng (biểu diễn sự phổ biến của nó). Dự đoán song tuyến tính vì vậy được biểu diễn như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-830"><span class="MJXp-mtable" id="MJXp-Span-831"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-832" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-833" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-834"><span class="MJXp-mrow" id="MJXp-Span-835" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-836"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">R</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-839" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">u</span><span class="MJXp-mo" id="MJXp-Span-841">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-850" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-852"><span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-857" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">u</span><span class="MJXp-mo" id="MJXp-Span-859">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-863" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">i</span><span class="MJXp-mo" id="MJXp-Span-865">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-102">\hat{R}_{u,i} = b_u + c_i + \sum_j A_{u,j}B_{i,j}. \tag{12.20} </script></span></p><p>Thông thường, chúng ta muốn tối thiểu sai số bình phương giữa đánh giá dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-868"><span class="MJXp-msubsup" id="MJXp-Span-869"><span class="MJXp-mrow" id="MJXp-Span-870" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-871"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">R</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-874" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">u</span><span class="MJXp-mo" id="MJXp-Span-876">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">\hat{R}_{u,i}</script></span> và đánh giá thực tế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-msubsup" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-881" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">u</span><span class="MJXp-mo" id="MJXp-Span-883">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">R_{u,i}</script></span>. Các vector nhúng của người dùng và mặt hàng có thể được minh họa một cách thuận tiện khi chúng đã được giảm số chiều ở bước đầu (xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mn" id="MJXp-Span-886">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">2</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mn" id="MJXp-Span-888">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">3</script></span> chiều), hoặc chúng có thể được sử dụng để so sánh giữa các người dùng hoặc các mặt hàng với nhau, giống như là các phép nhúng từ. Một cách để có được những vector nhúng này là thực hiện phép phân tích giá trị suy biến (SVD) của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-890">R</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">\boldsymbol{R}</script></span> của các mục tiêu thực tế (có thể là các đánh giá). Nó tương ứng với việc tách <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-892">R</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-894">U</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-895">D</span><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-bold MJXp-script" id="MJXp-Span-898" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">\boldsymbol{R} = \boldsymbol{U}\boldsymbol{D}\boldsymbol{V^\prime}</script></span> (hoặc một biến thể định chuẩn nào đó) thành phép nhân có hai thừa số là các ma trận có xếp hạng thấp hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-900">A</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-902">U</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-903">D</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">\boldsymbol{A} = \boldsymbol{U}\boldsymbol{D}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-905">B</span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-907"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-908" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-bold MJXp-script" id="MJXp-Span-909" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\boldsymbol{B} = \boldsymbol{V^\prime}</script></span>. Một vấn đề với SVD là nó thường xử lý các <em>mục</em> (entry) bị thiếu một cách tùy ý, như thể là chúng tương ứng với một giá trị đích bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-910"><span class="MJXp-mn" id="MJXp-Span-911">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">0</script></span>. Thay vào đó, chúng ta thường giảm chi phí dự đoán cho các mục bị thiếu. May mắn thay, tổng sai số bình phương trên các đánh giá quan sát được có thể dễ dàng được tối thiểu hóa bằng cách tối ưu hóa dựa trên phương pháp trượt gradient. Kể cả SVD và dự đoán song tuyến tính trong phương trình <strong>12.20</strong> đều thể hiện rất tốt trong cuộc thi của Netflix [Bennett and Lanning, 2007], nhằm dự đoán các đánh giá cho các bộ phim, dựa vào các đánh giá trước đó bởi một số lượng lớn các người dùng ẩn danh. Cuộc thi này diễn ra từ năm 2006 đến 2009 và có nhiều chuyên gia trong lĩnh vực học máy đã tham gia. Nó đã thúc đẩy mức nghiên cứu đối với các hệ thống gợi ý sử dụng thuật toán học máy nâng cao và tạo ra nhiều cải tiến đối với các hệ thống này. Mặc dù dự đoán song tuyến tính đơn giản hoặc SVD không phải là mô hình giành chiến thắng, chúng vẫn là một bộ phận của các mô hình hợp thể được trình bày bởi hầu hết các nhà thi đấu, kể cả những người chiến thắng [Töscher et al., 2009; Koren,2009].<br>
Ngoài những mô hình song tuyến tính với các biểu diễn có phân phối, một trong những mạng neuron được sử dụng đầu tiên cho lọc cộng tác đã được dựa trên mô hình xác suất gián tiếp máy Boltzmann hạn chế (RBM) [Salakhutdinov et al., 2007]. RBM là một bộ phận quan trọng của một nhóm các phương pháp đã chiến thắng cuộc thi của Netflix [Töscher et al., 2009; Koren,2009]. Những biến thể cải tiến hơn dựa trên ý tưởng phân tích ma trận các đánh giá cũng đã được khám phá ra trong cộng đồng nghiên cứu mạng neuron [Salakhutdinov và Mnih, 2008].</p><p>Tuy nhiên, hệ thống lọc cộng tác có một giới hạn cơ bản: khi một mặt hàng hoặc người dùng mới xuất hiện, việc thiếu lịch sử các đánh giá đồng nghĩa với việc không có cách nào để đánh giá sự tương đồng với các mặt hàng hoặc người dùng khác, hoặc là mức độ liên kết của người dùng mới và người dùng hiện có. Đây được gọi là vấn đề <em>gợi ý với xuất phát lạnh</em> (cold-start recommendations). Một cách thông thường để giải quyết vấn đề này là thêm vào các thông tin bổ sung về các người dùng và mặt hàng. Ví dụ, các thông tin bổ sung này có thể là thông tin hồ sơ của người dùng hoặc các đặc trưng của mỗi mặt hàng. Các hệ thống sử dụng những thông tin này được gọi là <strong>hệ thống gợi ý dựa trên nội dung</strong> (content-based recommender systems). Sự ánh xạ từ tập hợp phong phú chứa thông tin về đặc trưng của người dùng hoặc mục sang các vector nhúng có thể được học bằng một kiến trúc học sâu [Huang et al., 2013; Elkahky et al., 2015].</p><p>Các kiến trúc học sâu chuyên biệt, ví dụ như các mạng tích chập, cũng được áp dụng để học các đặc trưng trích xuất từ nội dung phong phú, như là gợi ý âm nhạc từ các bản thu âm bài hát liên quan tới âm nhạc [van den Oörd et al., 2013]. Trong nghiên cứu này, mạng tích chập lấy các đặc trưng âm thanh làm đầu vào và tính toán một vector nhúng cho bài hát tương ứng. Tích vô hướng giữa vector nhúng của bài hát và vector nhúng của một người dùng sẽ được sử dụng để dự đoán người dùng có nghe bài hát đó hay không.</p><h3 id="12511-Khám-phá-và-khai-thác">12.5.1.1 Khám phá và khai thác</h3><p>Khi gợi ý đến người dùng, một vấn đề phát sinh vượt xa cả học có giám sát thông thường và tiến vào lĩnh vực học tăng cường. Nhiều bài toán gợi ý thường chính xác khi mô tả trên lí thuyết như là <strong>kẻ cướp theo ngữ cảnh</strong> (contextual bandits) [Langford and Zhang, 2008; Lu et al., 2010]. Vấn đề là khi chúng ta sử dụng hệ thống gợi ý để thu thập dữ liệu, chúng ta nhận được những đánh giá thiên vị và không đầy đủ về sở thích của các người dùng: chúng ta chỉ thấy các phản ứng của người dùng đối với các mặt hàng được gợi ý nhưng không biết được phản ứng đối với các mặt hàng không được gợi ý. Thêm vào đó, trong một vài trường hợp, chúng ta có thể không lấy được bất cứ thông tin nào từ những người dùng không nhận được bất cứ gợi ý nào (ví dụ như khi đấu giá quảng cáo (ad auction), có thể mức giá ta đưa ra để trả cho một quảng cáo xuất hiện có thể thấp hơn ngưỡng giá tối thiểu, hoặc khi không thắng buổi đấu giá, vì vậy quảng cáo này sẽ không được hiện lên lần nào cả). Quan trọng hơn, chúng ta không nhận được thông tin về các kết quả sẽ có được từ việc giới thiệu các mặt hàng khác. Nó sẽ giống với việc huấn luyện một bộ phân lớp bằng cách chọn một lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mrow" id="MJXp-Span-913"><span class="MJXp-munderover" id="MJXp-Span-914"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">\hat{y}</script></span> cho mỗi mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-918">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">\boldsymbol{x}</script></span> (thường là lớp có xác xuất cao nhất theo mô hình) và sau đó chỉ lấy được phản hồi khi nó đúng hay sai. Dễ thấy, mỗi mẫu chứa ít thông tin hơn trong trường hợp có giám sát, với nhãn chính xác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">y</script></span> có thể truy cập trực tiếp, vì vậy ta cần có nhiều mẫu hơn. Tệ hơn, nếu chúng ta không cẩn thận, chúng ta có thể tạo nên một hệ thống mãi quyết định sai kể cả khi thu thập được nhiều dữ liệu, vì quyết định chính xác ngay từ đầu đã có xác xuất rất thấp: thuật toán học tập sẽ không học về quyết định đúng cho đến khi nó chọn ra được một quyết định đúng. Trường hợp này giống với tình huống trong học tăng cường, đó là chỉ khi phần thưởng cho hành động được chọn được ghi nhận. Thông thường, học tăng cường có thể bao gồm một chuỗi nhiều hành động và nhiều phần thưởng. Bài toán kẻ cướp là một trường hợp đặc biệt của học tăng cường, trong đó thuật toán học tập chỉ lấy một hành động riêng lẻ và trả về một phần thưởng riêng lẻ. Bài toán kẻ cướp sẽ dễ dàng hơn khi thuật toán học biết phần thưởng nào tương ứng với hành động nào. Trong trường hợp tổng quát của học tăng cường, một phần thưởng cao hoặc thấp có thể được nhận do hành động gần nhất hoặc hành động có từ trước đó. Khái niệm <strong>kẻ cướp theo ngữ cảnh</strong> liên quan tới trường hợp một hành động được đưa ra trong ngữ cảnh mà một vài biến đầu vào có thể cho biết quyết định. Ví dụ, chúng ta ít nhất sẽ biết được danh tính người dùng, và chúng ta muốn chọn một mặt hàng. Ánh xạ từ ngữ cảnh đến hành động được gọi là một <strong>chính sách</strong> (policy). Vòng lặp phản hồi giữa thuật toán học tập và phân phối dữ liệu (phụ thuộc vào các hành động của thuật toán học tập) là một vấn đề được nghiên cứu chủ yếu trong học tăng cường và bài toán kẻ cướp.</p><p>Học tăng cường yêu cầu sự đánh đổi giữa <strong>khám phá</strong> và <strong>khai thác</strong>. <em>Khai thác</em> đề cập tới việc đưa ra các hành động đến từ phiên bản tốt nhất của các chính sách đã được học ở thời điểm hiện tại, tức là các hành động mà ta biết sẽ thu được các phần thưởng cao. <em>Khám phá</em> đề cập tới việc đưa ra các hành động cụ thể để có thêm nhiều dữ liệu huấn luyện hơn. Nếu ta biết một ngữ cảnh cho trước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-922">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\boldsymbol{x}</script></span>, hành động <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">a</script></span> sẽ cho ta phần thưởng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-925"><span class="MJXp-mn" id="MJXp-Span-926">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">1</script></span>, chúng ta không biết nó có phải là phần thưởng tốt nhất hay không. Ta có thể muốn khai thác các chính sách hiện tại và tiếp tục đưa ra hành động <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">a</script></span> để tương đối chắc chắn về việc nhận được phần thưởng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mn" id="MJXp-Span-930">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">1</script></span>. Tuy nhiên, chúng ta cũng muốn thử khám phá hành động <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-msup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">a'</script></span>. Ta không biết những gì sẽ xảy ra nếu chúng ta thử hành động <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-msup" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-938" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">a'</script></span>. Ta hi vọng sẽ nhận được phần thưởng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mn" id="MJXp-Span-940">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">2</script></span>, nhưng cũng sẽ nguy cơ nhận được phần thưởng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mn" id="MJXp-Span-942">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">0</script></span>. Dù là cách nào thì chúng ta vẫn ít nhất thu được một số tri thức.</p><p>Khám phá có thể được khởi tạo bằng nhiều cách, từ cách thỉnh thoảng đưa ra các hành động ngẫu nhiên với mục đích bao quát toàn bộ các hành động khả thi, đến cách sử dụng các phương pháp dựa trên mô hình để tính toán lựa chọn hành động dựa trên phần thưởng mong muốn và số lượng những cái không chắc chắn của mô hình về phần thưởng đó.</p><p>Sẽ có nhiều tác nhân khiến ta quyết định nên chọn khám phá hay khai thác. Một trong những tác nhân nổi bật nhất là thang đo thời gian mà ta quan tâm. Nếu một hành động dẫn đến phần thưởng trong thời gian ngắn, ta sẽ chọn khai thác. Nếu một hành động cần thời gian dài mới cho phần thưởng, ta sẽ bắt đầu khám phá để các hành động trong tương lai có thể được hoạch định hiệu quả với nhiều tri thức hơn. Theo thời gian, khi <em>chính sách học được</em> (learned policy) có sự cải thiện, ta sẽ chuyển sang hướng khai thác.</p><p>Học có giám sát không có sự đánh đổi giữa khám phá và khai thác vì các tín hiệu giám sát luôn luôn chỉ rõ phần thưởng nào đúng tương ứng với mỗi đầu vào. Không cần phải thử các phần thưởng khác để xác định cái nào tốt hơn phần thưởng hiện tại của mô hình - vì ta luôn biết nhãn đúng là phần thưởng tốt nhất.</p><p>Một khó khăn khác nảy sinh trong phạm vi của học tăng cường, bên cạnh việc đánh đổi khám phá-khai phá là khó khăn của việc đánh giá và so sánh các chính sách khác nhau. Học tăng cường bao gồm sự tương tác giữa thuật toán học tập và môi trường. Vòng lặp phản hồi phản ánh rằng việc đánh giá hiệu quả của thuật toán học tập sẽ không dễ dàng nếu ta sử dụng một tập không đổi các giá trị đầu vào kiểm thử. Bản thân chính sách sẽ tự xác định các đầu vào nào được sử dụng. Dudik và cộng sự (2011) đã giới thiệu các kỹ thuật để đánh giá bài toán <em>kẻ cướp theo ngữ cảnh</em>.</p><h2 id="1252-Biểu-diễn-tri-thức-lý-giải-và-trả-lời-câu-hỏi">12.5.2 Biểu diễn tri thức, lý giải và trả lời câu hỏi</h2><p>Các tiếp cận sử dụng học sâu đang rất thành công trong việc mô hình hóa ngôn ngữ, dịch máy và xử lý ngôn ngữ tự nhiên nhờ vào lợi ích của các phép nhúng cho các ký hiệu và từ ngữ [Rummelhart et al., 1986a, Deerwester et al., 1990; Bengio et al., 2001]. Những vector nhúng này biểu diễn tri thức ngữ nghĩa của các từ và khái niệm đơn lẻ. Một nghiên cứu tiên phong sẽ phát triển các phép nhúng cho cụm từ và cho mối quan hệ giữa các từ và các <em>sự kiện</em> (fact). Các <em>máy tìm kiếm</em> (search engine) đã đang sử dụng học máy cho mục đích này, nhưng nhiều vấn đề vẫn còn đó cần giải quyết để cải tiến phép biểu diễn này theo hướng cao cấp hơn.</p><h3 id="12521-Tri-thức-mối-quan-hệ-và-trả-lời-câu-hỏi">12.5.2.1 Tri thức, mối quan hệ và trả lời câu hỏi.</h3><p>Có một hướng nghiên cứu thú vị là xác định cách huấn luyện các <em>biểu diễn phân phối</em> để nắm bắt <strong>mối quan hệ</strong> giữa 2 thực thể. Những mối quan hệ này cho phép ta định hình các sự kiện về các đối tượng và cách các đối tượng tác động lẫn nhau.</p><p>Trong toán học, một <strong>mối quan hệ nhị phân</strong> là một tập các cặp đối tượng có thứ tự. Các cặp trong một tập sẽ có sự liên quan còn các cặp không cùng tập sẽ không có sự liên quan. Ví dụ, ta có thể định nghĩa mối quan hệ “bé hơn” trong tập {1,2,3} bằng cách định nghĩa tập các cặp có thứ tự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mrow" id="MJXp-Span-944"><span class="MJXp-mi undefined" id="MJXp-Span-945">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">\mathbb{S}</script></span>={(1,2), (1,3), (2,3)}. Một khi mối quan hệ này đã được định nghĩa, ta có thể sử dụng nó giống như một động từ. Bởi vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-946"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-948">1</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-950">2</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">(1,2)\in</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-953"><span class="MJXp-mrow" id="MJXp-Span-954"><span class="MJXp-mi undefined" id="MJXp-Span-955">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">\mathbb{S}</script></span>, ta nói rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-mn" id="MJXp-Span-957">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">1</script></span> bé hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-mn" id="MJXp-Span-959">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">2</script></span>. Bởi vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-962">2</span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-964">1</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.333em; margin-right: 0.333em;">∉</span><span class="MJXp-mrow" id="MJXp-Span-967"><span class="MJXp-mi undefined" id="MJXp-Span-968">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">(2,1)\notin\mathbb{S}</script></span>, ta không thể nói rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-969"><span class="MJXp-mn" id="MJXp-Span-970">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">2</script></span> bé hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mn" id="MJXp-Span-972">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">1</script></span>. Tất nhiên, các đối tượng liên quan với nhau không bắt buộc phải là số. Ta có thể định nghĩa một mối quan hệ “thuộc về loại” bằng các ống dữ liệu ví dụ như (chó, động vật có vú).</p><p>Trong ngữ cảnh của trí tuệ nhân tạo, ta xem mối quan hệ như một câu có cú pháp đơn giản và ngôn ngữ mang cấu trúc bậc cao. Mối quan hệ đóng vai trò như một động từ, trong khi hai <em>lập luận</em> (argument) đóng vai trò là chủ thể và đối tượng của nó. Những câu sau (viết lại) ở dạng bộ ba token</p><blockquote>
<p>ND: trong trường hợp này, token nghĩa là một đơn vị từ ngữ quy ước. Phần lớn trường hợp, token tương đương với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mn" id="MJXp-Span-974">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">1</script></span> từ, nhưng tùy theo yêu cầu bài toán ngôn ngữ, token có thể gồm vài từ hoặc vài âm tiết)</p>
</blockquote><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-975"><span class="MJXp-mtable" id="MJXp-Span-976"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-977" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-978" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">t</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">b</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">t</span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-133">(subject, verb, object) \tag{12.21}</script></span></p><p>với các giá trị</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1000"><span class="MJXp-mtable" id="MJXp-Span-1001"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1002" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1003" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">t</span><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1012" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">o</span><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1023" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">t</span><span class="MJXp-msubsup" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1032" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-134"> (entity_i, relation_j, entity_k). \tag{12.22} </script></span></p><p>Chúng ta cũng có thể định nghĩa <strong>thuộc tính</strong>, một khái niệm tương tự với mối quan hệ, nhưng chỉ lấy một lập luận (argument):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1035"><span class="MJXp-mtable" id="MJXp-Span-1036"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1037" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1038" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">t</span><span class="MJXp-msubsup" id="MJXp-Span-1045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1047" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">t</span><span class="MJXp-msubsup" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1059" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">(entity_i, attribute_j).  \tag{12.23} </script></span></p><p>Ví dụ, chúng ta có thể định nghĩa thuộc tính <em>có lông</em> (has_fur), và áp dụng nó với các đối tượng như <em>chó</em>.</p><p>Có rất nhiều ứng dụng yêu cầu biểu diễn các mối liên hệ và lý luận về chúng. Chúng ta nên làm điều này tốt nhất thế nào trong ngữ cảnh của mạng neuron?</p><p>Tất nhiên những mô hình học máy đòi hỏi phải có dữ liệu huấn luyện. Chúng ta có thể nội suy mối quan hệ giữa các đối tượng từ tập huấn luyện bao gồm ngữ liệu ngôn ngữ tự nhiên không có cấu trúc. Nó cũng có cả những cơ sở dữ liệu đã cấu trúc sao cho mối quan hệ đã được xác định rõ ràng. Một cấu trúc thông thường cho những cơ sở dữ liệu này là <strong>cơ sở dữ liệu quan hệ</strong> (relational database), lưu giữ cùng loại thông tin, mặc dù không được định dạng như ba token câu trên. Khi một cơ sở dữ liệu có mục đích truyền tải tri thức về cuộc sống hàng ngày hoặc những tri thức chuyên sâu và một lĩnh vực áp dụng nào đó cho một hệ thống trí tuệ nhân tạo, chúng ta gọi cơ sở dữ liệu đó là một <strong>cơ sở tri thức</strong> (knowledge base). Cơ sở tri thức trải dài từ những cái tổng quát như <em>Freebase, OpenCyc, WordNet, Wikibase</em>,…, tới các cơ sở tri thức chuyên biệt hơn như <em>GeneOntology</em>. Các biểu diễn cho các thực thể và mối quan hệ có thể học được bằng cách xem xét mỗi bộ ba trong một cơ sở tri thức như một mẫu huấn luyện và tối đa hóa một mục tiêu huấn luyện để nắm được <em>phân phối đồng thời</em> (joint distribution) của chúng [Bordes et al., 2013a].</p><p>Ngoài dữ liệu huấn luyện, chúng ta cũng cần phải định nghĩa một họ mô hình để huấn luyện. Cách tiếp cận thông thường là mở rộng mô hình ngôn ngữ neuron để mô hình hóa thực thể và mối quan hệ. Mô hình ngôn ngữ neuron học ra các vector biểu diễn có phân phối của mỗi từ. Chúng cũng học cả sự tương tác giữa các từ, như là từ nào thường hay đứng sau chuỗi những từ nào, bằng cách học các chức năng của những vector này. Chúng ta có thể mở rộng cách tiếp cận này cho các thực thể và mối quan hệ bằng cách học một vector nhúng cho mỗi mối quan hệ. Trong thực tế, tính tương tự (parallel) giữa mô hình hóa ngôn ngữ và mô hình hóa tri thức đã được mã hóa bằng các mối quan hệ là rất gần nhau, đến nỗi, các nhà nghiên cứu đã huấn luyện biểu diễn của các thực thể thế này bằng cách sử dụng cả <em>nền tri thức</em> (knowledge bases) và các câu ngôn ngữ tự nhiên [Bordes et al., 2011, 2012; Wang et al., 2014a], hoặc bằng cách kết hợp dữ liệu từ nhiều cơ sở dữ liệu quan hệ [Bordes et al., 2013b]. Có nhiều khả năng tồn tại một cách tham số hóa cụ thể tương ứng với từng mô hình. Các nghiên cứu đời đầu cho giải thuật học mối quan hệ giữa các thực thể [Paccanaro and Hinton, 2000] đã đặt ra dạng tham số ràng buộc cao độ (“các phép nhúng quan hệ tuyến tính - linear relational embeddings”), thường sử dụng một dạng khác của các biểu diễn cho mối quan hệ hơn là cho các thực thể. Ví dụ, Paccanaro và Hinton (2000), Bordes và cộng sự (2011) đã dùng các vector cho các thực thể và các ma trận cho mối quan hệ, với ý tưởng rằng mối quan hệ sẽ đóng vai trò như một toán tử trên các thực thể. Ngoài ra, các mối quan hệ có thể được xem như một thực thể [Bordes et al., 2012], cho phép ta đưa ra mệnh đề về các mối quan hệ, nhưng linh hoạt hơn, đó là đặt chúng vào một cỗ máy có thể kết hợp chúng để mô hình hóa phân phối đồng thời của chúng.</p><p>Một ứng dụng thực tiễn ngắn hạn của những mô hình như thế này là <strong>dự đoán liên kết</strong>: dự đoán những mảng còn thiếu trong <em>đồ thị tri thức</em> (knowledge graph). Đây là dạng tổng quát hóa sự kiện mới dựa trên sự kiện trước đó. Hầu hết các nền tri thức hiện thời được xây dựng thủ công, dẫn đến xu hướng bỏ qua nhiều khả năng chính của các mối quan hệ đúng nhưng lại vắng mặt trong nền kiến thức. Xem trong [Wang et al., 2014b; Lin et al., 2015; Garcia-Duran et al., 2015] về ví dụ của các ứng dụng loại này.</p><p>Đánh giá hiệu năng của mô hình dựa trên tác vụ <em>dự đoán liên kết</em> là khá khó bởi chỉ có một tập dữ liệu của các <em>mẫu dương tính</em> (positive example) (các sự kiện đã được biết là đúng). Nếu mô hình kết luận một sự kiện không nằm trong tập dữ liệu, chúng ta cũng không thể chắc chắn liệu rằng mô hình đã làm sai hay tìm ra cái gì đó mới, khi mà trước đó sự kiện chưa được biết đến. Vì thế, các chuẩn đo lường (metric) phần nào đó là không chính xác và dựa trên việc kiểm tra cách mô hình xếp hạng một <em>tập chờ</em> (held-out set) chứa các sự kiện dương tính đúng so với các sự kiện khác có thể sẽ kém chính xác hơn. Cách thông thường để xây dựng các mẫu thú vị, có khả năng âm (những sự kiện mà có khả năng sai) đó là bắt đầu với một sự kiện đúng và tạo những phiên bản “sai lệch” của nó, ví dụ như thay thế một thực thể trong mối quan hệ bằng thực thể khác được chọn ngẫu nhiên. Độ chính xác phổ biến ở <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-mn" id="MJXp-Span-1063">10</span><span class="MJXp-mi" id="MJXp-Span-1064">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">10\%</script></span> trên một chuẩn đo lường cho biết bao nhiêu lần mô hình xếp hạng sự kiện “đúng” trong số top <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-mn" id="MJXp-Span-1066">10</span><span class="MJXp-mi" id="MJXp-Span-1067">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">10\%</script></span> các phiên bản “sai lệch” của sự kiện đúng ban đầu.</p><p>=============== Phát đã edit tới đây</p><p>Một ứng dụng khác của các <em>nền tri thức</em> và sự <em>biểu diễn phân phối</em> là <strong>phân giải từ có nghĩa nhập nhằng</strong> (Word-sense disambiguation) [Navigli and Velardi, 2005; Bordes et al., 2012], đó là tác vụ quyết định nghĩa nào của một từ sẽ thích hợp trong một vài ngữ cảnh.</p><p>Cuối cùng, những tri thức về mối quan hệ được kết hợp với một quá trình lý luận và sự hiểu biết về ngôn ngữ tự nhiên có thể cho phép ta xây dựng hệ thống hỏi-đáp tổng quát. Một hệ thống hỏi-đáp tổng quát phải có khả năng xử lý thông tin đầu vào và ghi nhớ những sự kiện quan trọng, tổ chức những sự kiện này theo một cách mà có thể truy xuất và diễn dịch về chúng sau này. Hiện vẫn tồn tại những câu hỏi khó mà chỉ có thể giải quyết một cách hạn chế trong những môi trường “thí nghiệm cho vui”. Hiện tại, cách tiếp cận tốt nhất để ghi nhớ và truy xuất các sự kiện tường minh cụ thể là sử dụng một cơ chế bộ nhớ rõ ràng (explicit memory mechanism), như đã được mô tả ở phần 10.12. Những mạng lưới bộ nhớ đầu tiên đã được đưa ra để giải tác vụ hỏi-đáp thí nghiệm cho vui [Weston et al., 2014]. Kumar và cộng sự (2015) đã đề xuất thêm việc sử dụng mạng hồi quy GRU để lưu đầu vào vào bộ nhớ và đưa ra câu trả lời dựa trên các nội dung nằm trong bộ nhớ.</p><p>Học sâu đã được áp dụng trong rất nhiều ứng dụng bên cạnh những thứ đã được mô tả ở đây, và chắc chắn sẽ được áp dụng thậm chí còn nhiều hơn nữa sau bài viết này. Thực sự khó có thể mô tả tất cả mọi thứ từ xa một cách bao quát với một chủ đề như vậy. Phần tổng quát này cho ta một ví dụ đại diện của những gì có thể mô tả.</p><p>Tại đây sẽ khép lại phần II của sách, nó đã mô tả được ứng dụng hiện đại sử dụng các mạng đa tầng, bao gồm tất cả các phương pháp thành công nhất. Nói chung, những phương pháp này bao gồm việc sử dụng gradient của hàm chi phí để tìm ra các tham số của một mô hình xấp xỉ một vài hàm mong muốn. Với đầy đủ dữ liệu huấn luyện, phương pháp tiếp cận này rất hiệu quả. Giờ chúng ta sẽ chuyển sang phần III, trong phần này chúng ta sẽ từng bước đi vào lãnh địa nghiên cứu chuyên sâu - các phương pháp được thiết kế để làm việc với ít dữ liệu huấn luyện hơn hoặc thi hành được những tác vụ đa dạng hơn, với những thử thách khó khăn hơn và không giống với những bài toán đã được giải quyết mà chúng tôi đã mô tả cho đến hiện tại.</p></div>