<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-8-Tối-ưu-cho-huấn-luyện-các-mô-hình-đa-tầng-giai-đoạn-2">Chương 8: Tối ưu cho huấn luyện các mô hình đa tầng (giai đoạn 2)</h1><p>--------------- SonAn bắt đầu dịch từ đây ----------------------<br>
----------------Pages: 296-300 ------------------------------</p><h2 id="833-Động-Lượng-Nesterov">8.3.3 Động Lượng Nesterov</h2><p>Sutskever và cộng sự (2013) đã giới thiệu một biến thể của thuật toán động lượng lấy cảm hứng từ phương pháp gradient tăng tốc (accelerated gradient method) của Nesterov [Nesterov, 1983, 2004]. Quy tắc cập nhật của trường hợp này như sau<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtable" id="MJXp-Span-2"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-5">v</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-8">v</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-11"><span class="MJXp-mi" id="MJXp-Span-12" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-13" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-14">θ</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-15"><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">[</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-18" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-19">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-21"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-23" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">i</span><span class="MJXp-mo" id="MJXp-Span-25">=</span><span class="MJXp-mn" id="MJXp-Span-26">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">L</span><span class="MJXp-mstyle" id="MJXp-Span-29"><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-32">f</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-36" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-37">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">i</span><span class="MJXp-mo" id="MJXp-Span-39">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-42">θ</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-45">v</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-48"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-49" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-50" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-51">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">i</span><span class="MJXp-mo" id="MJXp-Span-53">)</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-54"><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-57"><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-1">\boldsymbol{v} \gets \alpha\boldsymbol{v} - \epsilon\nabla_{\boldsymbol{\theta}}\bigg[\frac{1}{m}\sum_{i=1}^mL\Big(\boldsymbol{f}(x^{(i)});\boldsymbol{\theta}+\alpha\boldsymbol{v}),\boldsymbol{y}^{(i)}\Big)\bigg], \tag{8.21}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-61"><span class="MJXp-mtable" id="MJXp-Span-62"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-63" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-64" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-65">θ</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-67">θ</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-69">v</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-2">\boldsymbol{\theta} \gets \boldsymbol{\theta} + \boldsymbol{v},\tag{8.22}</script></span></p><p>trong đó các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">α</span></span></span><script type="math/tex" id="MathJax-Element-3">\alpha</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-4">\epsilon</script></span> đóng vai trò giống như trong phương pháp động lượng chuẩn. Sự khác biệt giữa động lượng Nesterov và động lượng chuẩn là điểm mà ta xác định gradient. Trong động lượng Nesterov, gradient được xác định tại điểm thu được sau khi vận tốc hiện thời được áp dụng. Do đó, ta có thể hiểu động lượng Nesterov như là việc cố gắng thêm vào một <em>hệ số hiệu chỉnh</em> (correction factor) cho phương pháp động lượng chuẩn. Thuật toán động lượng Nesterov đầy đủ được mô tả ở thuật toán 8.3.</p><hr><p><strong>Thuật toán 8.3</strong>: Trượt gradient ngẫu nhiên sử dụng động lượng Nesterov</p><hr><p><strong>Yêu cầu:</strong> Tốc độ học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-5">\epsilon</script></span>, tham số động lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">α</span></span></span><script type="math/tex" id="MathJax-Element-6">\alpha</script></span><br>
<strong>Yêu cầu:</strong> Tham số ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-80">θ</span></span></span><script type="math/tex" id="MathJax-Element-7">\boldsymbol{\theta}</script></span>, vận tốc ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-82">v</span></span></span><script type="math/tex" id="MathJax-Element-8">\boldsymbol{v}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mspace" id="MJXp-Span-84" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-9">\quad</script></span><strong>while</strong> điều kiện dừng chưa thỏa mãn <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mspace" id="MJXp-Span-86" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-10">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mspace" id="MJXp-Span-88" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-11">\quad</script></span> Lấy mẫu một lô nhỏ gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">m</span></span></span><script type="math/tex" id="MathJax-Element-12">m</script></span> mẫu trong tập dữ liệu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-95" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-96">(</span><span class="MJXp-mn" id="MJXp-Span-97">1</span><span class="MJXp-mo" id="MJXp-Span-98">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-104" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-105">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">m</span><span class="MJXp-mo" id="MJXp-Span-107">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-13">\{x^{(1)},\dots,x^{(m)}\}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mspace" id="MJXp-Span-110" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-14">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mspace" id="MJXp-Span-112" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-15">\quad</script></span> với nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-116" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-117">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span><span class="MJXp-mo" id="MJXp-Span-119">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-16">y^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-mspace" id="MJXp-Span-121" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-17">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mspace" id="MJXp-Span-123" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-18">\quad</script></span> Thực hiện cập nhật tạm thời: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-munderover" id="MJXp-Span-126"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-127">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-130">θ</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-133">v</span></span></span><script type="math/tex" id="MathJax-Element-19">\tilde{\boldsymbol{\theta}}\gets\boldsymbol{\theta}+\alpha\boldsymbol{v}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mspace" id="MJXp-Span-135" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-20">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mspace" id="MJXp-Span-137" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-21">\quad</script></span> Tính toán gradient (tại điểm tạm thời): <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-139">g</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-141" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-142">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mi" id="MJXp-Span-145" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-146" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-munderover" id="MJXp-Span-148"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-150" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-149">θ</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-151"><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-153" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">L</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">f</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-159"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-160" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-161" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-162">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">i</span><span class="MJXp-mo" id="MJXp-Span-164">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mrow" id="MJXp-Span-166"><span class="MJXp-munderover" id="MJXp-Span-167"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0px; margin-right: 0px;">~</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-168">θ</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-174" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-175">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">i</span><span class="MJXp-mo" id="MJXp-Span-177">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-22">\boldsymbol{g}\gets \frac{1}{m} \nabla_{\tilde{\boldsymbol{\theta}}}\sum_{i}L(f(\boldsymbol{x}^{(i)};\tilde{\boldsymbol{\theta})}, \boldsymbol{y}^{(i)})</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mspace" id="MJXp-Span-180" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-23">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mspace" id="MJXp-Span-182" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-24">\quad</script></span> Tính toán vận tốc cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-184">v</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-187">v</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-190">g</span></span></span><script type="math/tex" id="MathJax-Element-25">\boldsymbol{v}\gets\alpha\boldsymbol{v} - \epsilon\boldsymbol{g}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mspace" id="MJXp-Span-192" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-26">\quad</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-mspace" id="MJXp-Span-194" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-27">\quad</script></span>Thực hiện cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-196">θ</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-198">θ</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-200">v</span></span></span><script type="math/tex" id="MathJax-Element-28">\boldsymbol{\theta}\gets\boldsymbol{\theta}+\boldsymbol{v}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mspace" id="MJXp-Span-202" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-29">\quad</script></span><strong>end while</strong></p><hr><p>Trong trường hợp gradient lồi, động lượng Nesterov cải thiện tốc độ hội tụ của sai số quá mức từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">O</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-206">1</span><span class="MJXp-mrow" id="MJXp-Span-207"><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">k</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-30">O(1/k)</script></span> (sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">k</span></span></span><script type="math/tex" id="MathJax-Element-31">k</script></span> bước) đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">O</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-216">1</span><span class="MJXp-mrow" id="MJXp-Span-217"><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-221" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-32">O(1/k^2)</script></span>, như  đã được chứng minh bởi Nesterov (1983). Thật không may, trong trường hợp gradient ngẫu nhiên, động lượng Nesterov không giúp cải thiện tốc độ hội tụ.</p><h1 id="84-Các-chiến-lược-khởi-tạo-tham-số">8.4 Các chiến lược khởi tạo tham số</h1><p>Một số thuật toán tối ưu về bản chất là không có tính lặp và chỉ đi tìm một lời giải duy nhất. Một số thuật toán khác có tính lặp, nhưng khi được áp dụng vào đúng lớp bài toán tối ưu, chúng có thể hội tụ tới các đáp số chấp nhận được trong một khoảng thời gian chấp nhận được bất chấp cách khởi tạo tham số ban đầu. Các thuật toán huấn luyện trong học sâu thường không có những tính chất xa xỉ này. Các thuật toán huấn luyện cho các mô hình học sâu thường có tính lặp, và do đó yêu cầu người cài đặt xác định một vài điểm ban đầu để từ đó bắt đầu các vòng lặp. Huấn luyện mô hình học sâu là một tác vụ khó khăn đến mức hầu hết các thuật toán chịu ảnh hưởng lớn bởi bước khởi tạo tham số. Điểm khởi tạo có thể quyết định liệu thuật toán có hoàn toàn hội tụ hay không. Một số điểm khởi tạo không ổn định có thể khiến cho thuật toán gặp khó khăn trong tính toán số và thất bại hoàn toàn. Trong trường hợp quá trình học là hội tụ, điểm khởi tạo có thể quyết định tốc độ hội tụ và liệu nó sẽ hội tụ đến một điểm có chi phí cao hay thấp. Ngoài ra, các điểm có cùng giá trị hàm chi phí huấn luyện có thể có sai số tổng quát hóa rất khác nhau, và điểm khởi tạo do vậy cũng có thể ảnh hưởng đến quá trình tổng quát hóa.</p><p>Các chiến lược khởi tạo hiện nay đang khá đơn giản và chủ yếu dựa trên kinh nghiệm. Thiết kế những chiến lược khởi tạo tốt hơn là một nhiệm vụ khó khăn bởi chúng ta chưa hiểu rõ quá trình tối ưu hóa mạng neuron. Hầu hết các chiến lược  khởi tạo được sử dụng nhờ đạt được một số tính chất tốt khi khởi tạo mạng. Tuy nhiên, chúng ta không hay biết được tính chất nào trong số chúng được giữ nguyên và  được giữ nguyên trong trường hợp nào, sau khi bắt đầu quá trình học. Một khó khăn nữa là một số điểm khởi tạo có thể mang lại lợi ích khi nhìn từ góc độ tối ưu nhưng lại gây bất lợi trong tổng quát hóa. Sự hiểu biết của chúng ta về cách mà điểm khởi tạo ảnh hưởng đến việc tổng quát hóa là rất sơ khai, gần như chúng ta không có bất kỳ định hướng nào về cách lựa chọn điểm khởi tạo.</p><p>Có lẽ tính chất duy nhất được biết đến một cách hoàn toàn chắc chắn đó là các tham số ban đầu cần được “phá vỡ sự đối xứng” giữa các đơn vị khác nhau. Nếu hai đơn vị ẩn có cùng hàm kích hoạt được kết nối với cùng một đầu vào, thì các đơn vị này phải có các tham số ban đầu khác nhau. Nếu chúng có cùng tham số ban đầu, thì một thuật toán học máy tất định được áp dụng cho một hàm chi phí và mô hình tất định sẽ cập nhật cả hai đơn vị này theo cùng một cách. Ngay cả khi mô hình hoặc thuật toán huấn luyện có khả năng sử dụng tính ngẫu nhiên để tính toán các bước cập nhật khác nhau cho các đơn vị khác nhau (chẳng hạn, huấn luyện với cơ chế tắt ngẫu nhiên - dropout), thì giải pháp tốt nhất thường là khởi tạo mỗi đơn vị để tính toán một hàm khác với tất cả các đơn vị còn lại. Điều này có thể giúp ta chắc chắn rằng không có đầu vào nào bị mất mát trong <em>không gian rỗng</em> (null space) của quá trình lan truyền thuận và không có gradient nào bị mất mát trong không gian rỗng của quá trình lan truyền ngược. Mục đích của việc để mỗi đơn vị tính toán một hàm khác nhau là động cơ thúc đẩy việc khởi tạo ngẫu nhiên các tham số. Ta có thể đi tìm một một tập hợp lớn các hàm cơ sở mà tất cả đều khác nhau đôi một, nhưng điều này thường khiến chi phí tính toán trở nên rất lớn. Ví dụ, nếu số lượng đầu ra có thể nhiều nhất là bằng số đầu vào, ta có thể sử dụng phép trực giao hóa Gram-Schmidt trên một ma trận trọng số ban đầu và được đảm bảo rằng mỗi đơn vị sẽ tính toán một hàm rất khác với các đơn vị còn lại. Việc khởi tạo ngẫu nhiên từ một phân bố có entropy lớn trên không gian nhiều chiều sẽ tiết kiệm hơn về mặt tính toán và khả năng các đơn vị bất kỳ để tính toán hàm giống với các đơn vị còn lại xảy ra rất thấp.</p><p>Thông thường, chúng tôi thiết lập các hệ số tự do cho mỗi đơn vị bằng những hằng số được chọn theo kinh nghiệm, và chỉ khởi tạo ngẫu nhiên các trọng số. Các tham số bổ sung — ví dụ, các tham số mã hóa phương sai có điều kiện của một dự đoán — thường được đặt bằng hằng số được chọn theo kinh nghiệm giống như các hệ số tự do.</p><p>Chúng tôi hầu như luôn khởi tạo tất cả các trọng số trong mô hình với các giá trị được rút ngẫu nhiên từ một phân phối chuẩn hoặc phân phối đều. Sự lựa chọn phân bố chuẩn hoặc phân phối đều dường như không quá quan trọng và chưa được nghiên cứu một cách tường tận. Tuy nhiên, quy mô của phân phối ban đầu không có ảnh hưởng lớn đối với kết quả của cả quy trình tối ưu hóa và khả năng tổng quát hóa của mạng.</p><p>Các trọng số ban đầu lớn hơn sẽ mang lại hiệu ứng phá vỡ đối xứng mạnh hơn, giúp tránh các đơn vị dư thừa. Chúng cũng giúp tránh việc mất tín hiệu trong quá trình lan truyền thuận hoặc lan truyền ngược khi đi qua thành phần tuyến tính của mỗi tầng — các giá trị lớn hơn trong ma trận dẫn đến kết quả đầu ra lớn hơn của phép nhân ma trận. Tuy nhiên, các trọng số ban đầu quá lớn có thể dẫn đến sự bùng nổ của các giá trị trong quá trình lan truyền thuận hoặc lan truyền ngược. Trong các mạng truy hồi, trọng số lớn cũng có thể gây ra <em>sự hỗn loạn</em> (độ nhạy lớn đối với những nhiễu loạn nhỏ của đầu vào khiến cho hành vi của các thủ tục lan truyền thuận tất định trông như ngẫu nhiên). Ở một mức độ nào đó, vấn đề bùng nổ gradient có thể được giảm thiểu bằng cách siết gradient (cắt ngưỡng giá trị của các gradient trước khi thực hiện bước trượt gradient). Các trọng số lớn cũng có thể dẫn đến giá trị cực lớn khiến cho các hàm kích hoạt bão hòa, gây tiêu biến hoàn toàn gradient thông qua các đơn vị đã bị bão hòa. Những yếu tố cạnh tranh lẫn nhau này quyết định quy mô ban đầu lý tưởng của các trọng số.</p><p>Các quan điểm về cơ chế kiểm soát và tối ưu hóa có thể cho ta những nhận thức rất khác nhau về cách khởi tạo một mạng. Quan điểm tối ưu hóa cho thấy rằng trọng số phải đủ lớn để truyền đạt thông tin thành công, nhưng một số cơ chế kiểm soát khuyến khích ta nên thiết lập chúng nhỏ hơn. Việc sử dụng thuật toán tối ưu, chẳng hạn như trượt gradient ngẫu nhiên, khiến các trọng số tăng một lượng nhỏ sau mỗi bước, và có xu hướng dừng ở những khu vực gần với các tham số khởi tạo hơn (có thể là do bị kẹt trong vùng có gradient thấp hoặc do thuật toán kích hoạt một số tiêu chí kết thúc sớm để tránh hiện tượng quá khớp) thể hiện một kinh nghiệm tiền đề rằng các tham số cuối cùng nên có giá trị gần với các tham số khởi tạo. Nhắc lại từ phần 7.8 rằng thuật toán trượt gradient sử dụng tiêu chí kết thúc sớm sẽ tương đương với cơ chế suy giảm trọng số trong một số mô hình. Trong trường hợp tổng quát, kết thúc sớm không giống với suy giảm trọng số, nhưng nó cung cấp cho ta một sự tương đồng nào đó để ngẫm về hiệu ứng của khởi tạo. Chúng ta có thể coi việc khởi tạo giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-224">θ</span></span></span><script type="math/tex" id="MathJax-Element-33">\boldsymbol{\theta}</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-msubsup" id="MJXp-Span-226"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-227" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-228" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-34">\boldsymbol{\theta}_0</script></span> giống như áp đặt một tiên nghiệm Gauss <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">p</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-232">θ</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-35">p(\boldsymbol{\theta})</script></span> với kỳ vọng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-234"><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-236" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-237" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-36">\boldsymbol{\theta}_0</script></span>. Từ góc nhìn này, có thể thấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-238"><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-37">\boldsymbol{\theta}_0</script></span> nên được chọn giá trị gần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mn" id="MJXp-Span-243">0</span></span></span><script type="math/tex" id="MathJax-Element-38">0</script></span>. Tiên nghiệm này biểu thị ý nghĩa rằng khả năng các đơn vị sẽ không tương tác với nhau cao hơn khả năng chúng sẽ tương tác với nhau. Các đơn vị chỉ tương tác khi đại lượng biểu thị độ hợp lý (likelihood) trong hàm mục tiêu buộc chúng phải làm vậy. Mặt khác, nếu chúng ta khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-247" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-39">\boldsymbol{\theta}_0</script></span> với giá trị lớn thì tiên nghiệm của chúng ta chỉ ra các đơn vị nào sẽ tương tác với nhau, và chúng sẽ tương tác như thế nào.</p><p>Có vài kỹ thuật có sẵn dựa trên kinh nghiệm cho việc chọn quy mô khởi tạo của trọng số. Một trong số đó là khởi tạo các trọng số của một tầng kết nối đầy đủ (fully connected layer) với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">m</span></span></span><script type="math/tex" id="MathJax-Element-40">m</script></span> đầu vào và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">n</span></span></span><script type="math/tex" id="MathJax-Element-41">n</script></span> đầu ra bằng cách lấy mẫu mỗi trọng số từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">U</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-256" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-257">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-258"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">m</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-261" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-262">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-263"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">m</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">U(-\frac{1}{\sqrt{m}},\frac{1}{\sqrt{m}})</script></span>, trong khi Golot và Bengio (2010) đề xuất sử dụng phương pháp <em>khởi tạo có chuẩn hoá</em> (normalized initialization).</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-266"><span class="MJXp-mtable" id="MJXp-Span-267"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-268" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-269" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">i</span><span class="MJXp-mo" id="MJXp-Span-274">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">U</span><span class="MJXp-mstyle" id="MJXp-Span-278"><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msqrt" id="MJXp-Span-282"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 285%; margin-top: 0.049em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-mfrac" id="MJXp-Span-283" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-284">6</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">m</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">n</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msqrt" id="MJXp-Span-289"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 285%; margin-top: 0.049em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-mfrac" id="MJXp-Span-290" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-291">6</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">m</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">n</span></span></span></span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-295"><span class="MJXp-mrow" id="MJXp-Span-296"><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-43">W_{i,j}\sim U\bigg(-\sqrt{\frac{6}{m+n}},\sqrt{\frac{6}{m+n}}\bigg)\tag{8.23}</script></span></p><p>Phương pháp này được thiết kế để dung hoà giữa mục đích khởi tạo tất cả các tầng để có cùng phương sai của hàm kích hoạt và mục đích khởi tạo tất cả các tầng để có cùng phương sai của gradient. Công thức trên được suy ra bằng cách sử dụng giả định rằng mạng chỉ bao gồm một chuỗi các phép nhân ma trận mà không có các hàm phi tuyến. Các mạng neuron trong thực tế rõ ràng là vi phạm giả định này, nhưng nhiều chiến lược được thiết kế cho mô hình tuyến tính hoạt động khá tốt cả trên những mô hình phi tuyến có cấu trúc tương tự.</p><p>Saxe và cộng sự (2013) khuyến nghị việc khởi tạo bằng ma trận trực giao ngẫu nhiên, với hệ số nhân tỉ lệ, hay nói cách khác là hệ số <em>lợi ích</em> (gain) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">g</span></span></span><script type="math/tex" id="MathJax-Element-44">g</script></span> được lựa chọn một cách cẩn thận, nhằm tính đến tính phi tuyến được áp dụng trong mỗi tầng. Họ suy ra các giá trị cụ thể của hệ số nhân tỉ lệ cho các loại hàm kích hoạt phi tuyến khác nhau. Phương pháp khởi tạo này cũng được thúc đẩy bởi mô hình của một mạng đa tầng dưới dạng một chuỗi các phép nhân ma trận không chứa hàm phi tuyến. Với một mô hình như vậy, cách khởi tạo này đảm bảo rằng tổng số lần lặp cần thiết của quá trình huấn luyện để đạt được sự hội tụ là độc lập với chiều sâu.</p><p>Việc tăng hệ số nhân tỉ lệ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">g</span></span></span><script type="math/tex" id="MathJax-Element-45">g</script></span> sẽ đẩy mạng về trạng thái mà chuẩn (norm) của các kích hoạt tăng lên khi chúng lan truyền thuận qua mạng và chuẩn của các gradient tăng khi chúng lan truyền ngược. Sussillo (2014) cho thấy rằng việc thiết lập hệ số nhân tỉ lệ một cách chính xác là đủ để huấn luyện các mạng với số tầng lên đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mn" id="MJXp-Span-303">1</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-305">000</span></span></span><script type="math/tex" id="MathJax-Element-46">1,000</script></span> mà không cần sử dụng các khởi tạo trực giao. Chìa khoá của phương pháp này là trong các mạng lan truyền thuận, các hàm kích hoạt và các gradient có thể tăng hoặc giảm sau mỗi bước truyền thuận hoặc truyền nghịch, nhưng tuân theo quy luật của một bước ngẫu nhiên (random walk). Điều này là do các mạng lan truyền thuận sử dụng một ma trận trọng số khác nhau ở mỗi tầng. Nếu bước ngẫu nhiên này được điều chỉnh để bảo toàn các chuẩn, thì các mạng lan truyền thuận gần như có thể tránh được vấn đề tiêu biến và bùng nổ gradient phát sinh khi cùng một ma trận trọng số được sử dụng ở mỗi bước, như được mô tả trong phần 8.2.5.</p><p>Thật không may, những tiêu chuẩn tối ưu trên cho bước khởi tạo trọng số thường không dẫn đến hiệu quả tối ưu. Điều này có thể vì ba lý do khác nhau. Thứ nhất, có thể ta đã sử dụng những tiêu chuẩn không chính xác - chẳng hạn, việc bảo toàn chuẩn của một tín hiệu xuyên suốt toàn bộ mạng có thể không mang lại lợi ích. Thứ hai, các tính chất ta áp đặt lúc khởi tạo có thể không còn nữa sau khi quá trình học bắt đầu. Cuối cùng, các tiêu chuẩn này có thể thành công trong việc cải thiện tốc độ tối ưu nhưng vô tình làm tăng sai số tổng quát. Trong thực tế, chúng ta thường phải xử lý quy mô của các trọng số như một siêu tham số có giá trị tối ưu nằm đâu đó gần nhưng không hoàn toàn bằng với các dự đoán lý thuyết.</p><p>Một điểm yếu của các quy tắc nhân tỉ lệ là thiết lập toàn bộ tham số khởi tạo có cùng độ lệch chuẩn, chẳng hạn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mfrac" id="MJXp-Span-307" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-308">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-309"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">m</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-47">\frac{1}{\sqrt{m}}</script></span>, khiến cho mỗi trọng số trở nên vô cùng nhỏ khi mà số tầng trong mạng lớn dần. Martens (2010) đã giới thiệu một chiến lược khởi tạo thay thế được gọi là <em>khởi tạo thưa</em> (sparse initialization), trong đó mỗi đơn vị được khởi tạo để có  đúng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">k</span></span></span><script type="math/tex" id="MathJax-Element-48">k</script></span> trọng số không âm. Ý tưởng của phương pháp này là giữ tổng số đầu vào của đơn vị độc lập với lấy số lượng đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">m</span></span></span><script type="math/tex" id="MathJax-Element-49">m</script></span>, mà không khiến cho độ lớn của các phần tử trọng số riêng lẻ nhỏ đi theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">m</span></span></span><script type="math/tex" id="MathJax-Element-50">m</script></span>. Khởi tạo thưa cho phép đạt được sự đa dạng hơn cho các đơn vị tại thời điểm khởi tạo. Tuy nhiên, nó cũng áp đặt một tiên nghiệm rất chặt đối với các trọng số được chọn để có các giá trị Gauss lớn. Bởi phải mất một thời gian dài để cho thuật toán trượt gradient thu nhỏ các giá trị lớn “không chính xác”, chiến lược khởi tạo này có thể gây ra các vấn đề cho các đơn vị, chẳng hạn như đơn vị cực đại đầu ra, có một số bộ lọc mà các bộ lọc này phải được phối hợp một cách cẩn thận với nhau.</p><p>Khi tài nguyên tính toán cho phép, việc coi quy mô khởi tạo của các trọng số như một siêu tham số thường là ý tưởng tốt và ta sẽ chọn chúng bằng thuật toán tìm kiếm siêu tham số được mô tả trong phần 11.4.2, chẳng hạn như tìm kiếm ngẫu nhiên. Việc lựa chọn sẽ sử dụng phương pháp khởi tạo dầy đặc hay thưa cũng có thể được coi là một siêu tham số. Ngoài ra, người ta có thể tìm kiếm quy mô khởi tạo tốt nhất theo cách thủ công. Một nguyên tắc hữu ích để chọn quy mô khởi tạo là xem xét phạm vi hoặc độ lệch chuẩn của hàm kích hoạt hoặc các gradient trên một lô nhỏ dữ liệu. Nếu trọng số quá nhỏ, phạm vi của hàm kích hoạt qua lô nhỏ này sẽ nhỏ lại khi các hàm kích hoạt lan truyền thuận qua mạng. Bằng cách lặp lại việc phát hiện tầng đầu tiên với các hàm kích hoạt nhỏ quá mức cho phép và tăng trọng số của nó, cuối cùng ta có thể thu được một mạng với các hàm kích hoạt khởi tạo hợp lý cho toàn bộ mạng. Nếu quá trình học vẫn còn quá chậm tại điểm này, việc quan sát phạm vi hoặc độ lệch chuẩn của các gradient cũng như hàm kích hoạt có thể sẽ hữu ích. Thủ tục này về nguyên tắc có thể được thực hiện một cách tự động và thường tốn ít chi phí tính toán hơn so với việc tối ưu hóa siêu tham số dựa trên sai số của tập xác thực, bởi vì nó dựa trên phản hồi từ hành vi của mô hình ban đầu trên một lô dữ liệu duy nhất, thay vì phản hồi từ mô hình được huấn luyện trên tập dữ liệu xác thực. Sau thời gian dài được sử dụng theo phương pháp cảm tính, thủ tục này gần đây đã được Mishkin và Matas (2015) nghiên cứu và mô tả một cách chặt chẽ hơn.</p><p>---------------- SonAn kết thúc dịch ở đây -------------------------</p><p>--------------- Phát Võ bắt đầu dịch từ đây ----------------------<br>
<a href="https://www.deeplearningbook.org/contents/optimization.html" target="_blank" rel="noopener">https://www.deeplearningbook.org/contents/optimization.html</a><br>
----------------Pages: 301-305 ------------------------------</p><p>Cho đến nay chúng ta đã tập trung vào vấn đề khởi tạo trọng số. May mắn thay, việc khởi tạo các tham số khác thường là dễ dàng hơn.</p><p>Hướng tiếp cận cho việc thiết lập các hệ số tự do phải được phối hợp với hướng tiếp cận cho việc thiết lập trọng số. Việc đặt các hệ số tự do bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-317"><span class="MJXp-mn" id="MJXp-Span-318">0</span></span></span><script type="math/tex" id="MathJax-Element-51">0</script></span> là phù hợp với phần lớn chiến lược khởi tạo trọng số. Có một vài trường hợp mà ta có thể đặt độ lệch bằng giá trị khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-319"><span class="MJXp-mn" id="MJXp-Span-320">0</span></span></span><script type="math/tex" id="MathJax-Element-52">0</script></span> như sau:</p><ul>
<li>
<p>Nếu một hệ số tự do ứng với một đơn vị đầu ra thì việc khởi tạo hệ số tự do để đạt được các thống kê cận biên chính xác của đầu ra thường sẽ có lợi. Để thực hiện điều này, giả sử rằng các trọng số khởi tạo là đủ nhỏ để đầu ra của đơn vị chỉ được quyết định bởi hệ số tự do. Tính chất này biện minh cho việc thiết lập hệ số tự do bằng nghịch đảo của hàm kích hoạt được áp dụng cho thống kê cận biên của đầu ra trong tập huấn luyện. Ví dụ, nếu đầu ra là một phân phối của các lớp, và phân phối này có độ lệch cao với xác suất cận biên của lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mrow" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">i</span></span></span></span><script type="math/tex" id="MathJax-Element-53">{i}</script></span> được cho bởi thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-54">{c_i}</script></span> của vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-330">c</span></span></span><script type="math/tex" id="MathJax-Element-55">\boldsymbol c</script></span> nào đó, thì ta có thể thiết lập vector hệ số tự do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-331"><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">b</span></span></span></span><script type="math/tex" id="MathJax-Element-56">{b}</script></span> bằng cách giải phương trình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">x</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-343">b</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-346">c</span></span></span><script type="math/tex" id="MathJax-Element-57">softmax(\boldsymbol b)=\boldsymbol c</script></span>. Cách này không chỉ được áp dụng vào các thuật toán phân loại mà còn cho cả các mô hình chúng ta sẽ gặp trong phần III, chẳng hạn như các bộ tự mã hóa và mô hình máy Boltzmann. Những mô hình này có các tầng có đầu ra giống với dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-348">x</span></span></span><script type="math/tex" id="MathJax-Element-58">\boldsymbol x</script></span>, và việc khởi tạo sao cho các hệ số tự do của những tầng đó khớp với phân phối cận biên của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-350">x</span></span></span><script type="math/tex" id="MathJax-Element-59">\boldsymbol x</script></span> có thể sẽ rất hữu ích.</p>
</li>
<li>
<p>Đôi khi chúng ta có thể muốn chọn hệ số tự do để tránh gây ra việc quá bão hòa tại thời điểm khởi tạo. Ví dụ, chúng ta có thể thiết lập hệ số tự do của một đơn vị ẩn ReLU là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mn" id="MJXp-Span-352">0.1</span></span></span><script type="math/tex" id="MathJax-Element-60">0.1</script></span> thay vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-353"><span class="MJXp-mn" id="MJXp-Span-354">0</span></span></span><script type="math/tex" id="MathJax-Element-61">0</script></span> để tránh bão hòa đơn vị ReLU tại thời điểm khởi tạo. Dù vậy, hướng tiếp cận này không phù hợp với các chiến lược khởi tạo trọng số mà ở đó các chiến lược này không mong đợi đầu vào mạnh từ các hệ số tự do. Chẳng hạn, nó không được khuyến khích dùng cho việc khởi tạo bước ngẫu nhiên [Sussillo, 2014].</p>
</li>
<li>
<p>Đôi lúc một đơn vị kiểm soát việc liệu các đơn vị khác có thể tham gia vào một hàm số hay không. Trong những trường hợp như vậy, chúng ta có một đơn vị với đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">u</span></span></span><script type="math/tex" id="MathJax-Element-62">u</script></span> và một đơn vị khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">h</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-361">0</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-363">1</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-63">h \in [0,1]</script></span>, chúng sẽ được nhân với nhau để tạo ra đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">h</span></span></span><script type="math/tex" id="MathJax-Element-64">uh</script></span>. Ta có thể xem <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">h</span></span></span><script type="math/tex" id="MathJax-Element-65">h</script></span> như là một cổng quyết định liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">h</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">u</span></span></span><script type="math/tex" id="MathJax-Element-66">uh\approx u</script></span> hay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">h</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-379">0</span></span></span><script type="math/tex" id="MathJax-Element-67">uh\approx 0</script></span>. Trong những trường hợp này, chúng ta muốn thiết lập hệ số tự do của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">h</span></span></span><script type="math/tex" id="MathJax-Element-68">h</script></span> sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">h</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-385">1</span></span></span><script type="math/tex" id="MathJax-Element-69">h\approx 1</script></span> tại hầu hết các thời điểm khi khởi tạo. Nếu không thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">u</span></span></span><script type="math/tex" id="MathJax-Element-70">u</script></span> sẽ không có cơ hội nào để học. Ví dụ, Jozefowicz và cộng sự (2015) ủng hộ việc thiếp lập hệ số tự do bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-mn" id="MJXp-Span-389">1</span></span></span><script type="math/tex" id="MathJax-Element-71">1</script></span> cho <em>cổng quên</em> (forget gate) của mô hình LSTM, sẽ được miêu tả ở phần 10.10.</p>
<p>Một loại tham số phổ biến khác là phương sai, hay tham số độ nét. Ví dụ, chúng ta có thể thực hiện hồi quy tuyến tính với một ước lượng phương sai có điều kiện bằng cách sử dụng mô hình<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-390"><span class="MJXp-mtable" id="MJXp-Span-391"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-392" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-393" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">p</span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">y</span><span class="MJXp-mrow" id="MJXp-Span-397"><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-399">x</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-402"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-403">N</span></span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">y</span><span class="MJXp-mrow" id="MJXp-Span-406"><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-409" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-410" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-411">x</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">b</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-415">1</span><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">β</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-72">p(y |\boldsymbol{x})=\mathcal{N}(y|\boldsymbol{w}^T\boldsymbol{x}+b,1/\beta),\tag{8.24}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">β</span></span></span><script type="math/tex" id="MathJax-Element-73">\beta</script></span> là tham số độ nét. Chúng ta thường có thể khởi tạo phương sai hay tham số độ nét bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mn" id="MJXp-Span-424">1</span></span></span><script type="math/tex" id="MathJax-Element-74">1</script></span> một cách an toàn. Một hướng tiếp cận khác là giả sử các trọng số khởi tạo đủ gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mn" id="MJXp-Span-426">0</span></span></span><script type="math/tex" id="MathJax-Element-75">0</script></span> để ta có thể thiết lập hệ số tự do trong khi bỏ qua ảnh hưởng của các trọng số, sau đó thiết lập các hệ số tự do để tìm ra trung bình cận biên đúng của đầu ra, và thiết lập các tham số phương sai bằng với phương sai cận biên của đầu ra trong tập huấn luyện.</p>
</li>
</ul><p>Bên cạnh những phương pháp khởi tạo tham số đơn giản bởi các hằng số hoặc khởi tạo một cách ngẫu nhiên, ta có thể sử dụng học máy. Một chiến lược phổ biến được thảo luận ở phần III của cuốn sách này là khởi tạo một mô hình có giám sát với các tham số được học bởi một mô hình không giám sát được huấn luyện dựa trên cùng một đầu vào. Người ta cũng có thể thực hiện việc huấn luyện có giám sát trên một tác vụ liên quan. Đôi khi, việc thực hiện huấn luyện có giám sát trên một tác vụ không liên quan thậm chí có thể sinh ra một khởi tạo khiến thuật toán hội tụ nhanh hơn so với việc khởi tạo ngẫu nhiên. Một vài trọng số những chiến lược khởi tạo này có thể mang đến sự hội tụ nhanh hơn và khả năng tổng quát hóa tốt hơn, vì chúng mã hóa thông tin về phân phối dữ liệu vào bên trong các tham số khởi tạo của mô hình. Những chiến lược khác hoạt động tốt chủ yếu vì chúng thiết lập các tham số có quy mô hợp lý hoặc thiết lập các đơn vị khác nhau để tính toán các hàm số khác nhau.</p><h1 id="85-Những-thuật-toán-với-tốc-độ-học-tự-điều-chỉnh">8.5 Những thuật toán với tốc độ học tự điều chỉnh</h1><p>Các nhà nghiên cứu mạng neuron đã nhận ra từ lâu rằng việc thiết lập tốc độ học chắc chắn là một trong những tác vụ khó khăn nhất trong quá trình thiết lập các siêu tham số bởi vì nó ảnh hưởng đáng kể đến hiệu quả của mô hình. Như ta đã thảo luận ở phần 4.3 và 8.2, hàm chi phí thường rất nhạy cảm đối với một số hướng trong không gian tham số và không nhạy cảm với các hướng còn lại. Thuật toán động lượng có thể phần nào khắc phục vấn đề này, nhưng để thực hiện nó ta lại phải tìm một siêu tham số khác. Liệu có một cách nào khác hay không? Nếu ta cho rằng các hướng nhạy cảm phần nào gióng theo trục tọa độ, sẽ hợp lý khi sử dụng tốc độ học riêng biệt cho từng tham số và tự động điều chỉnh những tốc độ học này này trong suốt quá trình học.</p><p>Thuật toán <em>delta-bar-delta</em> [Jacobs, 1988] là một hướng tiếp cận dựa trên kinh nghiệm để điều chỉnh các tốc độ học riêng lẻ cho các tham số mô hình trong quá trình học. Cách tiếp cận này dựa trên một ý tưởng đơn giản: nếu đạo hàm riêng phần của hàm mất mát, đối với một tham số mô hình cho trước, giữ nguyên dấu, thì tốc độ học nên tăng lên. Ngược lại, nếu đạo hàm riêng phần đổi dấu thì tốc độ học nên giảm xuống. Dĩ nhiên, loại quy tắc này chỉ có thể được áp dụng khi ta tối ưu hóa theo toàn bộ lô.</p><p>Gần đây, một số phương pháp theo các lô nhỏ đã được đưa ra có khả năng điều chỉnh các tốc độ học của các tham số mô hình. Trong phần này, chúng ta sẽ đánh giá vắn tắt một số thuật toán này.</p><h2 id="851-AdaGrad">8.5.1 AdaGrad</h2><p>Thuật toán <strong>AdaGrad</strong>, được trình bày ở thuật toán 8.4, điều chỉnh các tốc độ học của toàn bộ tham số mô hình một cách riêng biệt bằng cách chia chúng cho nghịch đảo của căn bậc hai của tổng toàn bộ giá trị bình phương gradient trong quá khứ [Duchi và cộng sự., 2011]. Các tham số có đạo hàm riêng của hàm mất mát càng lớn thì các tốc độ học tương ứng càng giảm nhanh, trong khi những tham số có đạo hàm riêng phần nhỏ sẽ có tốc độ giảm chậm tương ứng. Hiệu quả thực sự là thuật toán sẽ học nhanh hơn ở những hướng có độ dốc vừa phải trong không gian tham số.</p><p>Trong phạm vi của tối ưu lồi, thuật toán AdaGrad sở hữu một số tính chất lý thuyết đáng giá. Tuy nhiên, trong thực tế, để huấn luyện các mô hình mạng neuron đa tầng, việc tích lũy các giá trị bình phương của gradient <em>ngay từ khi bắt đầu quá trình huấn luyện</em> có thể dẫn đến việc giảm tốc độ học sớm và quá mức cần thiết. AdaGrad đạt hiệu quả tốt đối với một số chứ không phải toàn bộ các mô hình học sâu.</p><hr><p><strong>Thuật toán 8.4</strong> Thuật toán AdaGrad</p><hr><p><strong>Yêu cầu:</strong> Tốc độ học toàn cục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-76">\epsilon</script></span><br>
<strong>Yêu cầu:</strong> Tham số khởi tạo <strong><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">θ</span></span></span><script type="math/tex" id="MathJax-Element-77">\theta</script></span></strong><br>
<strong>Yêu cầu:</strong> Hằng số ổn định nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">δ</span></span></span><script type="math/tex" id="MathJax-Element-78">\delta</script></span>, có giá trị khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mn" id="MJXp-Span-435" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-436" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-437">−</span><span class="MJXp-mn" id="MJXp-Span-438">7</span></span></span></span></span><script type="math/tex" id="MathJax-Element-79">10^{-7}</script></span> dùng để cân bằng phép chia cho số nhỏ.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mspace" id="MJXp-Span-440" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-80">\quad</script></span> Khởi tạo biến tích lũy gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-442">r</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-444">0</span></span></span><script type="math/tex" id="MathJax-Element-81">\boldsymbol r= \boldsymbol 0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mspace" id="MJXp-Span-446" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-82">\quad</script></span> <strong>while</strong> chưa thoả mãn điều kiện dừng, <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-mspace" id="MJXp-Span-448" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-449" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-83">\quad\quad</script></span> Lấy mẫu một lô nhỏ gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">m</span></span></span><script type="math/tex" id="MathJax-Element-84">m</script></span> mẫu từ tập huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-452"><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-456" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-457">(</span><span class="MJXp-mn" id="MJXp-Span-458">1</span><span class="MJXp-mo" id="MJXp-Span-459">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-467" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-468">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">m</span><span class="MJXp-mo" id="MJXp-Span-470">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-85">\{\boldsymbol x^{(1)}, ..., \boldsymbol x^{(m)}\}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mspace" id="MJXp-Span-473" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-474" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-86">\quad\quad</script></span> với nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-msubsup" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-478" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-479">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">i</span><span class="MJXp-mo" id="MJXp-Span-481">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-87">y^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mspace" id="MJXp-Span-483" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-484" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-88">\quad\quad</script></span> Tính gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-485"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-486">g</span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-488" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-489">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-491"><span class="MJXp-mi" id="MJXp-Span-492" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-493" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-494"><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-496" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">L</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">f</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-503" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-504">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">i</span><span class="MJXp-mo" id="MJXp-Span-506">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-508">θ</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-511"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-512" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-513" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-514">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">i</span><span class="MJXp-mo" id="MJXp-Span-516">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-89">\boldsymbol g \leftarrow \frac{1}{m}\nabla_\boldsymbol{\theta}\sum_iL(f(\boldsymbol{x}^{(i)};\boldsymbol \theta), \boldsymbol y^{(i)})</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mspace" id="MJXp-Span-519" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-520" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-90">\quad\quad</script></span> Tích lũy bình phương gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-522">r</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-524">r</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-526">g</span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-528">g</span></span></span><script type="math/tex" id="MathJax-Element-91">\boldsymbol r \leftarrow \boldsymbol r+ \boldsymbol g \odot \boldsymbol g</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mspace" id="MJXp-Span-530" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-531" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-92">\quad\quad</script></span> Tính toán cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi" id="MJXp-Span-533">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-534">θ</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-537" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">ϵ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">δ</span><span class="MJXp-mo" id="MJXp-Span-540">+</span><span class="MJXp-msqrt" id="MJXp-Span-541"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-542">r</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-544">g</span></span></span><script type="math/tex" id="MathJax-Element-93">\Delta \boldsymbol \theta \leftarrow - \frac{\epsilon}{\delta+\sqrt{\boldsymbol r}}\odot \boldsymbol g</script></span>. (Phép chia<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mspace" id="MJXp-Span-546" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-547" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-94">\quad\quad</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-548"><span class="MJXp-mspace" id="MJXp-Span-549" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-550" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-95">\quad\quad</script></span> và lấy căn bậc hai được áp dụng cho từng phần tử)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mspace" id="MJXp-Span-552" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-553" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-96">\quad\quad</script></span> Áp dụng cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-555">θ</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-557">θ</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-559">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-560">θ</span></span></span><script type="math/tex" id="MathJax-Element-97">\boldsymbol \theta \leftarrow \boldsymbol \theta + \Delta \boldsymbol \theta</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-mspace" id="MJXp-Span-562" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-98">\quad</script></span> <strong>end while</strong></p><hr><h2 id="852-RMSProp">8.5.2 RMSProp</h2><p>Thuật toán <strong>RMSProp</strong> [Hinton, 2012] là một phiên bản sửa đổi của AdaGrad để hoạt động tốt hơn với các bài toán tối ưu không lồi bằng cách thay đổi tích lũy gradient thành một trung bình với trọng số giảm theo hàm mũ. AdaGrad được thiết kế để hội tụ nhanh chóng khi áp dụng vào một hàm lồi. Khi áp dụng vào hàm không lồi để huấn luyện mạng neuron, quỹ đạo của quá trình học có thể bỏ qua nhiều cấu trúc khác nhau và cuối cùng tiến đến một vùng lồi cục bộ. AdaGrad thu nhỏ tốc độ học theo toàn bộ giá trị bình phương gradient trong quá khứ và có thể khiến tốc độ học trở nên quá nhỏ trước khi đạt được một cấu trúc lồi. RMSProp sử dụng một trung bình suy giảm theo hàm mũ để loại bỏ các dữ kiện từ quá khứ quá xa, giúp nó có thể hội tụ nhanh chóng sau khi tìm thấy vùng lồi, như thể nó là một trường hợp khi thuật toán AdaGrad được khởi tạo bên trong vùng lồi đó.</p><p>RMSProp được biểu diễn dưới dạng chuẩn trong thuật toán 8.5 và kết hợp với động lượng Nesterov trong thuật toán 8.6. So sánh với AdaGrad, việc sử dụng trung bình suy giảm đưa vào một siêu tham số mới, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">ρ</span></span></span><script type="math/tex" id="MathJax-Element-99">\rho</script></span>, kiểm soát tỉ lệ độ dài của trung bình suy giảm.</p><p>Qua thực nghiệm, RMSProp đã thể hiện là một thuật toán tối ưu hiệu quả và thực tiễn đối với các mạng neuron đa tầng. Nó hiện tại đang là một trong những phương pháp tối ưu hóa được áp dụng thường xuyên bởi các chuyên gia học sâu.</p><hr><p><strong>Thuật toán 8.5</strong> Thuật toán RMSProp</p><hr><p><strong>Yêu cầu:</strong> Tốc độ học toàn cục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-100">\epsilon</script></span>, tốc độ suy giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">ρ</span></span></span><script type="math/tex" id="MathJax-Element-101">\rho</script></span> (decay rate)<br>
<strong>Yêu cầu:</strong> Tham số ban đầu <strong><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-570">θ</span></span></span><script type="math/tex" id="MathJax-Element-102">\boldsymbol \theta</script></span></strong><br>
<strong>Yêu cầu:</strong> Hằng số ổn định nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">δ</span></span></span><script type="math/tex" id="MathJax-Element-103">\delta</script></span>, có giá trị khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mn" id="MJXp-Span-575" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-576" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-577">−</span><span class="MJXp-mn" id="MJXp-Span-578">6</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104">10^{-6}</script></span>.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-579"><span class="MJXp-mspace" id="MJXp-Span-580" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-105">\quad</script></span> Khởi tạo các biến tích lũy gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-581"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-582">r</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-584">0</span></span></span><script type="math/tex" id="MathJax-Element-106">\boldsymbol r=0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-585"><span class="MJXp-mspace" id="MJXp-Span-586" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-107">\quad</script></span> <strong>While</strong> chưa thoả mãn điều kiện dừng, <strong>d</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-mspace" id="MJXp-Span-588" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-589" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-108">\quad\quad</script></span> Lấy mẫu một lô nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">m</span></span></span><script type="math/tex" id="MathJax-Element-109">m</script></span> mẫu từ tập huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-595" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-596" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-597">(</span><span class="MJXp-mn" id="MJXp-Span-598">1</span><span class="MJXp-mo" id="MJXp-Span-599">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-603"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-604" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-605" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-606">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">m</span><span class="MJXp-mo" id="MJXp-Span-608">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-110">\{\boldsymbol x^{(1)}, \dots,  \boldsymbol x^{(m)}\}</script></span> với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-610"><span class="MJXp-mspace" id="MJXp-Span-611" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-612" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-111">\quad\quad</script></span>  nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-msubsup" id="MJXp-Span-614"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-615" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-616" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-617">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">i</span><span class="MJXp-mo" id="MJXp-Span-619">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-112">\boldsymbol y^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-620"><span class="MJXp-mspace" id="MJXp-Span-621" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-622" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-113">\quad\quad</script></span> Tính gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-623"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-624">g</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-626" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-627">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi" id="MJXp-Span-630" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-632"><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-634" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">L</span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">f</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-641" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-642">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">i</span><span class="MJXp-mo" id="MJXp-Span-644">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-646">θ</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-651" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-652">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">i</span><span class="MJXp-mo" id="MJXp-Span-654">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">\boldsymbol g \leftarrow \frac{1}{m}\nabla_\boldsymbol \theta\sum_iL(f(\boldsymbol x^{(i)};\boldsymbol \theta),\boldsymbol y^{(i)})</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-656"><span class="MJXp-mspace" id="MJXp-Span-657" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-658" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-115">\quad\quad</script></span> Tích lũy bình phương gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-659"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-660">r</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">ρ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-663">r</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-666">1</span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">ρ</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-670">g</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-672">g</span></span></span><script type="math/tex" id="MathJax-Element-116">\boldsymbol{r} \leftarrow \rho \boldsymbol{r} +(1 - \rho)\boldsymbol{g} \odot \boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-mspace" id="MJXp-Span-674" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-675" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-117">\quad\quad</script></span> Tính toán cập nhật tham số: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-676"><span class="MJXp-mi" id="MJXp-Span-677">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-678">θ</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-681" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">ϵ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-683"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">δ</span><span class="MJXp-mo" id="MJXp-Span-685">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-686">r</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-688">g</span></span></span><script type="math/tex" id="MathJax-Element-118">\Delta \boldsymbol \theta = - \frac{\epsilon}{\sqrt{\delta+\boldsymbol r}}\odot \boldsymbol g</script></span>. (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mfrac" id="MJXp-Span-690" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-691">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-692"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">δ</span><span class="MJXp-mo" id="MJXp-Span-694">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-695">r</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-119">\frac{1}{\sqrt{\delta+\boldsymbol{r}}}</script></span> được<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mspace" id="MJXp-Span-697" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-698" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-120">\quad\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mspace" id="MJXp-Span-700" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-701" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-121">\quad\quad</script></span> áp dụng cho từng phần tử)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mspace" id="MJXp-Span-703" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-704" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-122">\quad\quad</script></span> Áp dụng cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-705"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-706">θ</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-708">θ</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-710">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-711">θ</span></span></span><script type="math/tex" id="MathJax-Element-123">\boldsymbol \theta \leftarrow \boldsymbol \theta + \Delta \boldsymbol \theta</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mspace" id="MJXp-Span-713" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-124">\quad</script></span> <strong>end while</strong></p><hr><hr><p><strong>Thuật toán 8.6</strong> Thuật toán RMSProp với động lượng Nesterov</p><hr><p><strong>Yêu cầu:</strong> Tốc độ học toàn cục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-125">\epsilon</script></span>, tốc độ suy giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">ρ</span></span></span><script type="math/tex" id="MathJax-Element-126">\rho</script></span>, hệ số động lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">α</span></span></span><script type="math/tex" id="MathJax-Element-127">\alpha</script></span><br>
<strong>Yêu cầu:</strong> Tham số khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-721">θ</span></span></span><script type="math/tex" id="MathJax-Element-128">\boldsymbol \theta</script></span>, vận tốc ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-723">v</span></span></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol v</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-724"><span class="MJXp-mspace" id="MJXp-Span-725" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-130">\quad</script></span> Khởi tạo biến tích lũy gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-727">r</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-729">0</span></span></span><script type="math/tex" id="MathJax-Element-131">\boldsymbol r=0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-730"><span class="MJXp-mspace" id="MJXp-Span-731" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-132">\quad</script></span> <strong>While</strong> chưa thoả mãn điều kiện dừng, <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mspace" id="MJXp-Span-733" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-734" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-133">\quad\quad</script></span> Lấy mẫu một lô nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">m</span></span></span><script type="math/tex" id="MathJax-Element-134">m</script></span> mẫu từ tập huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-739"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-740" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-741" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-742">(</span><span class="MJXp-mn" id="MJXp-Span-743">1</span><span class="MJXp-mo" id="MJXp-Span-744">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-747" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-748"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-749" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-750" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-751">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">m</span><span class="MJXp-mo" id="MJXp-Span-753">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-135">\{\boldsymbol x^{(1)},\dots, \boldsymbol x^{(m)}\}</script></span> với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mspace" id="MJXp-Span-756" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-757" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-136">\quad\quad</script></span> nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-758"><span class="MJXp-msubsup" id="MJXp-Span-759"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-760" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-761" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-762">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">i</span><span class="MJXp-mo" id="MJXp-Span-764">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol y^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-mspace" id="MJXp-Span-766" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-767" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-138">\quad\quad</script></span> Tính cập nhật tạm thời: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mrow" id="MJXp-Span-769"><span class="MJXp-munderover" id="MJXp-Span-770"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-771">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-774">θ</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-777">v</span></span></span><script type="math/tex" id="MathJax-Element-139">\tilde{\boldsymbol \theta} \leftarrow \boldsymbol \theta + \alpha \boldsymbol v</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mspace" id="MJXp-Span-779" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-780" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-140">\quad\quad</script></span> Tính gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-782">g</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-784" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-785">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-787"><span class="MJXp-mi" id="MJXp-Span-788" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-789" style="vertical-align: -0.4em;"><span class="MJXp-munderover" id="MJXp-Span-790"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-792" style="margin-right: 0px; margin-left: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-791">θ</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-795" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">L</span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">f</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-800"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-801" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-802" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-803">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">i</span><span class="MJXp-mo" id="MJXp-Span-805">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mrow" id="MJXp-Span-807"><span class="MJXp-munderover" id="MJXp-Span-808"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-809">θ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-815" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-816">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">i</span><span class="MJXp-mo" id="MJXp-Span-818">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-141">\boldsymbol g \leftarrow \frac{1}{m}\nabla_\tilde{\boldsymbol \theta}\sum_i L(f(\boldsymbol x^{(i)};\tilde{\boldsymbol \theta}),\boldsymbol y^{(i)})</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-mspace" id="MJXp-Span-821" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-822" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-142">\quad\quad</script></span> Tích lũy gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-824">r</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">ρ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-827">r</span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-830">1</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">ρ</span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-834">g</span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-836">g</span></span></span><script type="math/tex" id="MathJax-Element-143">\boldsymbol r \leftarrow \rho \boldsymbol r +(1 - \rho)\boldsymbol g \odot \boldsymbol g</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-mspace" id="MJXp-Span-838" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-839" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-144">\quad\quad</script></span> Tính toán cập nhật vận tốc: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-841">v</span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-844">v</span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-846" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">ϵ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-848"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-849">r</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-851">g</span></span></span><script type="math/tex" id="MathJax-Element-145">\boldsymbol v \leftarrow \alpha \boldsymbol v - \frac{\epsilon}{\sqrt{\boldsymbol r}}\odot \boldsymbol g</script></span> (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-852"><span class="MJXp-mfrac" id="MJXp-Span-853" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-854">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-855"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-856">r</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-146">\frac{1}{\sqrt{\boldsymbol r}}</script></span> được áp dụng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-857"><span class="MJXp-mspace" id="MJXp-Span-858" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-859" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-147">\quad\quad</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mspace" id="MJXp-Span-861" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-862" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-148">\quad\quad</script></span> theo từng phần tử)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-863"><span class="MJXp-mspace" id="MJXp-Span-864" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-865" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-149">\quad\quad</script></span> Áp dụng cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-866"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-867">θ</span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-869">θ</span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-871">v</span></span></span><script type="math/tex" id="MathJax-Element-150">\boldsymbol \theta \leftarrow \boldsymbol \theta + \boldsymbol v</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-mspace" id="MJXp-Span-873" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-151">\quad</script></span> <strong>end while</strong></p><hr><h2 id="853-Adam">8.5.3 Adam</h2><p><strong>Adam</strong> [Kingma and Ba, 2014] là một thuật toán tối ưu tự điều chỉnh tốc độ học và được trình bày ở thuật toán 8.7. Cái tên “Adam” bắt nguồn từ cụm từ “adaptive moment” (moment thích nghi). Nhìn dưới góc độ các thuật toán phía trên, nó có thể được xem như một biến thể kết hợp giữa RMSProp và động lượng nhưng với một vài khác biệt quan trọng. Thứ nhất, trong Adam, động lượng được kết hợp trực tiếp như một dạng ước lượng của moment bậc một (với trọng số theo hàm mũ) của gradient. Cách dễ thấy nhất để cộng thêm động lượng vào RMSProp là áp dụng động lượng vào các gradient đã được chia tỉ lệ. Việc sử dụng động lượng trong việc kết hợp với chia tỉ lệ không có một động cơ lý thuyết rõ ràng nào. Thứ hai, Adam bao gồm các hiệu chỉnh độ chệch đối với cả moment bậc một (số hạng động lượng) và  moment bậc hai (chưa hướng tâm) để giải thích cho cách khởi tạo của chúng tại gốc (xem thuật toán 8.7). RMSProp cũng kết hợp sự ước lượng của moment bậc hai (chưa hướng tâm); tuy nhiên nó thiếu đi hệ số hiệu chỉnh. Do vậy, không như Adam, ước lượng moment bậc hai của RMSProp có thể có độ chệch cao sớm hơn trong quá trình huấn luyện. Adam thường được xem là một thuật toán kháng nhiễu khá tốt đối với việc lựa chọn các siêu tham số, mặc dù tốc độ học đôi lúc cần phải được thay đổi so với giá trị mặc định được đề xuất.</p><p>---------------- Phát Võ kết thúc dịch ở đây -------------------------</p><p>--------------- Thomas Nguyen bắt đầu dịch từ đây ----------------------<br>
----------------Pages: 306-310 ------------------------------</p><hr><p><strong>Thuật toán 8.7</strong>: Thuật toán Adam</p><hr><p><strong>Yêu cầu:</strong> độ lớn mỗi bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-152">\epsilon</script></span> (giá trị mặc định khuyến nghị là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mn" id="MJXp-Span-877">0.001</span></span></span><script type="math/tex" id="MathJax-Element-153">0.001</script></span>)<br>
<strong>Yêu cầu:</strong> Tốc độ suy giảm theo hàm mũ cho việc tính toán các ước lượng moment, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-msubsup" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-881" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-154">\rho_1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-882"><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-885" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-155">\rho_2</script></span> nằm trong khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-888">0</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-890">1</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-156">[0,1)</script></span>, giá trị mặc định khuyến nghị tương ứng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-892"><span class="MJXp-mn" id="MJXp-Span-893">0.9</span></span></span><script type="math/tex" id="MathJax-Element-157">0.9</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-mn" id="MJXp-Span-895">0.999</span></span></span><script type="math/tex" id="MathJax-Element-158">0.999</script></span>.<br>
<strong>Yêu cầu:</strong> Hằng số ổn định nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">δ</span></span></span><script type="math/tex" id="MathJax-Element-159">\delta</script></span> (giá trị mặc định khuyến nghị: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-898"><span class="MJXp-msubsup" id="MJXp-Span-899"><span class="MJXp-mn" id="MJXp-Span-900" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-901" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-902">−</span><span class="MJXp-mn" id="MJXp-Span-903">8</span></span></span></span></span><script type="math/tex" id="MathJax-Element-160">10^{-8}</script></span>)<br>
<strong>Yêu cầu:</strong> Khởi tạo tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-905">θ</span></span></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{\theta}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mspace" id="MJXp-Span-907" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-162">\quad</script></span> Khởi tạo momen bậc nhất và bậc hai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-909">s</span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-911">0</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-913">r</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-915">0</span></span></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{s}=\boldsymbol{0},\boldsymbol{r}=\boldsymbol{0}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mspace" id="MJXp-Span-917" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-164">\quad</script></span> Khởi tạo thứ tự bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">t</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-921">0</span></span></span><script type="math/tex" id="MathJax-Element-165">t=0</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-922"><span class="MJXp-mspace" id="MJXp-Span-923" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-166">\quad</script></span> <strong>While</strong> chưa thỏa điều kiện dừng, <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-924"><span class="MJXp-mspace" id="MJXp-Span-925" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-926" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-167">\quad\quad</script></span> Lấy một lô nhỏ gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">m</span></span></span><script type="math/tex" id="MathJax-Element-168">m</script></span> mẫu từ tập dữ liệu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mo" id="MJXp-Span-930" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-932" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-933" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-934">(</span><span class="MJXp-mn" id="MJXp-Span-935">1</span><span class="MJXp-mo" id="MJXp-Span-936">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-940"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-941" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-942" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-943">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">m</span><span class="MJXp-mo" id="MJXp-Span-945">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-169">\{\boldsymbol x^{(1)},\dots,\boldsymbol x^{(m)}\}</script></span> với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-947"><span class="MJXp-mspace" id="MJXp-Span-948" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-949" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-170">\quad\quad</script></span> nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-953" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-954">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">i</span><span class="MJXp-mo" id="MJXp-Span-956">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-171">\boldsymbol y^{(i)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-957"><span class="MJXp-mspace" id="MJXp-Span-958" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-959" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-172">\quad\quad</script></span> Tính gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-961">g</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-963" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-964">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mi" id="MJXp-Span-967" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-968" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-969">θ</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">L</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">f</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-980" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-981">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">i</span><span class="MJXp-mo" id="MJXp-Span-983">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-985">θ</span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-990" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-991">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">i</span><span class="MJXp-mo" id="MJXp-Span-993">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-173">\boldsymbol{g}\gets \frac{1}{m} \nabla_{\boldsymbol{\theta}}\sum_{i}L(f(x^{(i)};\boldsymbol{\theta}), y^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mspace" id="MJXp-Span-996" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-997" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-174">\quad\quad</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">t</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">t</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1003">1</span></span></span><script type="math/tex" id="MathJax-Element-175">t\gets t+1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-mspace" id="MJXp-Span-1005" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1006" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-176">\quad\quad</script></span> Cập nhật giá trị moment bậc nhất: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1008">s</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1012" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1013">s</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1016">1</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1020" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1022">g</span></span></span><script type="math/tex" id="MathJax-Element-177">\boldsymbol{s} \gets \rho_1 \boldsymbol{s}+(1-\rho_1) \boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1023"><span class="MJXp-mspace" id="MJXp-Span-1024" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1025" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-178">\quad\quad</script></span> Cập nhật giá trị moment bậc hai: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1027">r</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1031" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1032">r</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1035">1</span><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1039" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1041">g</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1043">g</span></span></span><script type="math/tex" id="MathJax-Element-179">\boldsymbol{r} \gets \rho_2 \boldsymbol{r}+(1-\rho_2) \boldsymbol{g} \odot \boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mspace" id="MJXp-Span-1045" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1046" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-180">\quad\quad</script></span> Hiệu chỉnh độ chệch trong momen bậc nhất: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1047"><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-munderover" id="MJXp-Span-1049"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1050">s</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1053" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1054">s</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1055">1</span><span class="MJXp-mo" id="MJXp-Span-1056">−</span><span class="MJXp-msubsup" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058" style="margin-right: 0.05em;">ρ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">t</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1059">1</span></span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-181">\hat{\boldsymbol{s}} \gets \frac{\boldsymbol{s}}{1-\rho_1^t}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1061"><span class="MJXp-mspace" id="MJXp-Span-1062" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1063" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-182">\quad\quad</script></span> Hiệu chỉnh độ chệch trong momen bậc hai: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mrow" id="MJXp-Span-1065"><span class="MJXp-munderover" id="MJXp-Span-1066"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1067">r</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1070" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1071">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1072">1</span><span class="MJXp-mo" id="MJXp-Span-1073">−</span><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">ρ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">t</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1076">2</span></span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-183">\hat{\boldsymbol{r}} \gets \frac{\boldsymbol{r}}{1-\rho_2^t}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mspace" id="MJXp-Span-1079" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1080" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-184">\quad\quad</script></span> Tính toán cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1081"><span class="MJXp-mi" id="MJXp-Span-1082">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1083">θ</span><span class="MJXp-mo" id="MJXp-Span-1084" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">ϵ</span><span class="MJXp-mfrac" id="MJXp-Span-1087" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1088"><span class="MJXp-munderover" id="MJXp-Span-1089"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1090">s</span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-1092"><span class="MJXp-surd"><span style="font-size: 137%; margin-top: 0.102em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1093"><span class="MJXp-munderover" id="MJXp-Span-1094"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1095">r</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1097">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">δ</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-185">\Delta\boldsymbol{\theta}=-\epsilon \frac{\hat{\boldsymbol{s}}}{\sqrt{\hat{\boldsymbol{r}}}+\delta}</script></span> (phép tính áp dụng tích theo từng phần tử)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mspace" id="MJXp-Span-1100" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1101" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-186">\quad\quad</script></span> Áp dụng cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1103">θ</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1105">θ</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1107">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1108">θ</span></span></span><script type="math/tex" id="MathJax-Element-187">\boldsymbol{\theta}= \boldsymbol{\theta} + \Delta\boldsymbol{\theta}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mspace" id="MJXp-Span-1110" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-188">\quad</script></span> <strong>end while</strong></p><hr><h2 id="854-Lựa-chọn-đúng-thuật-toán-tối-ưu">8.5.4 Lựa chọn đúng thuật toán tối ưu</h2><p>Chúng ta vừa thảo luận một loạt các thuật toán liên quan mà mỗi thuật toán đều tìm cách giải quyết vấn đề tối ưu mô hình học sâu bằng cách điều chỉnh tốc độ học cho mỗi tham số của mô hình. Lúc này, câu hỏi đặt ra là: chúng ta nên lựa chọn thuật toán nào?</p><p>Đáng tiếc là vẫn chưa có sự đồng thuận về câu trả lời cho câu hỏi này tại thời điểm hiện tại. Schaul và cộng sự (2014) đã trình bày một so sánh đầy giá trị giữa nhiều thuật toán tối ưu thông qua một phạm vi lớn các tác vụ khác nhau. Kết quả chỉ ra rằng các thuật toán có tốc độ học tự động điều chỉnh (RMSProp và AdaDelta) có hiệu suất khá ổn định, tuy vậy vẫn không có thuật toán nào là tốt nhất.</p><p>Hiện nay, các thuật toán tối ưu thông dụng nhất được sử dụng bao gồm SGD, SGD với động lượng, RMSProp, RMSProp với động lượng, AdaDelta và Adam. Việc lựa chọn thuật toán phụ thuộc phần lớn vào việc người sử dụng quen với thuật toán nào (để dễ dàng trong việc tinh chỉnh tham số).</p><h1 id="86-Phương-pháp-xấp-xỉ-đạo-hàm-bậc-hai">8.6 Phương pháp xấp xỉ đạo hàm bậc hai</h1><p>Trong phần này, chúng tôi sẽ thảo luận về ứng dụng của phương pháp bậc hai trong huấn luyện mô hình mạng neuron. LeCun và cộng sự (1998a) đã sớm thảo luận về chủ đề này. Để đơn giản hóa việc trình bày, hàm mục tiêu duy nhất mà chúng tôi xét là hàm rủi ro thực nghiệm:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1111"><span class="MJXp-mtable" id="MJXp-Span-1112"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1113" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1114" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">J</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1117">θ</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mrow" id="MJXp-Span-1121" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1122">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1124"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1125">x</span></span><span class="MJXp-mo" id="MJXp-Span-1126">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">y</span><span class="MJXp-mo" id="MJXp-Span-1128">∼</span><span class="MJXp-msubsup" id="MJXp-Span-1129"><span class="MJXp-mrow" id="MJXp-Span-1130" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1131"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1134" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1139">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1140">x</span><span class="MJXp-mo" id="MJXp-Span-1141">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">y</span><span class="MJXp-mo" id="MJXp-Span-1143">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">L</span><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">f</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1149">x</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1151">θ</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1153" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">y</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1158" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1159">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1161"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1167" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1163" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">i</span><span class="MJXp-mo" id="MJXp-Span-1165">=</span><span class="MJXp-mn" id="MJXp-Span-1166">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">L</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">f</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1174" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1175" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1176">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">i</span><span class="MJXp-mo" id="MJXp-Span-1178">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1180">θ</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1185" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1186">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">i</span><span class="MJXp-mo" id="MJXp-Span-1188">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-189">
J(\boldsymbol{\theta}) = \mathbb{E}_{\textbf x,y\sim\hat{p}_{data}(\boldsymbol x,y)}[L(f(\boldsymbol{x};\boldsymbol{\theta}),y)]=\frac{1}{m}\sum\limits_{i=1}^{m}L(f(\boldsymbol x^{(i)};\boldsymbol{\theta}), y^{(i)}). \tag{8.25}
</script></span></p><p>Các phương pháp mà chúng tôi thảo luận dưới đây là dễ mở rộng hơn với các hàm mục tiêu tổng quát hơn, chẳng hạn như khi có thêm đại lượng kiểm soát (regularization), như đã thảo luận ở chương 7.</p><h2 id="861-Phương-pháp-Newton">8.6.1 Phương pháp Newton</h2><p>Ở phần 4.3, chúng tôi đã giới thiệu về các phương pháp sử dụng gradient bậc hai. Khác với phương pháp bậc nhất, phương pháp bậc hai sử dụng đạo hàm bậc hai để cải thiện hiệu suất tối ưu. Phương pháp được sử dụng rộng rãi nhất thuộc dạng này là phương pháp Newton. Ta cùng thảo luận chi tiết về phương pháp này và đi sâu vào ứng dụng của nó trong huấn luyện các mô hình mạng neuron.</p><p>Phương pháp Newton là một chiến lược tối ưu dựa trên khai triển chuỗi Taylor bậc hai để xấp xỉ hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">J</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1194">θ</span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-190">J(\boldsymbol{\theta})</script></span> gần điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1196"><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1199" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-191">\boldsymbol{\theta}_0</script></span> nào đó, bỏ qua các đạo hàm bậc cao hơn:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1227"><span class="MJXp-mtable" id="MJXp-Span-1228"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1229" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1230" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">J</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1233">θ</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">J</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1239" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1240" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mrow" id="MJXp-Span-1244" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1246">θ</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1249" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1250" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1252" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1253">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi" id="MJXp-Span-1255" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">J</span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1264" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1265">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1266">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1268">θ</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1271" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1272" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-1273"><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1275" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1276">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1277">H</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1279">θ</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1283" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-192">
J(\boldsymbol{\theta})\approx J(\boldsymbol{\theta}_0) + {(\boldsymbol{\theta}-\boldsymbol{\theta}_0)}^{\intercal}\nabla_\boldsymbol{\theta}J(\boldsymbol{\theta}_0)+\frac{1}{2}(\boldsymbol{\theta}-\boldsymbol{\theta}_0)^{\intercal}\boldsymbol{H}(\boldsymbol{\theta}-\boldsymbol{\theta}_0),\tag{8.26}
</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1287">H</span></span></span><script type="math/tex" id="MathJax-Element-193">\boldsymbol{H}</script></span> là ma trận Hesse của hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">J</span></span></span><script type="math/tex" id="MathJax-Element-194">J</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1291">θ</span></span></span><script type="math/tex" id="MathJax-Element-195">\boldsymbol{\theta}</script></span> tại điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-msubsup" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1294" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1295" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-196">\boldsymbol{\theta}_0</script></span><br>
Nếu giải phương trình để tìm điểm tới hạn của phương trình này, ta sẽ thu được quy tắc cập nhật tham số Newton:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1296"><span class="MJXp-mtable" id="MJXp-Span-1297"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1298" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1299" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1300"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1301" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1302" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1305" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1306" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1309" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1310" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1311">−</span><span class="MJXp-mn" id="MJXp-Span-1312">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1313"><span class="MJXp-mi" id="MJXp-Span-1314" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1315" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1316">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">J</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1320" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1321" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-197">
\boldsymbol{\theta}^* = \boldsymbol{\theta}_0 - \boldsymbol{H}^{-1}\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta}_0)\tag{8.27}
</script></span></p><p>Do đó với một hàm bậc hai cục bộ (với ma trận xác định dương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1324">H</span></span></span><script type="math/tex" id="MathJax-Element-198">\boldsymbol{H}</script></span>), bằng cách nhân gradient với ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-msubsup" id="MJXp-Span-1326"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1327" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1328" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1329">−</span><span class="MJXp-mn" id="MJXp-Span-1330">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-199">\boldsymbol{H}^{-1}</script></span>, phương pháp Newton sẽ nhảy trực tiếp đến điểm cực tiểu. Nếu hàm mục tiêu là hàm lồi nhưng không ở dạng bậc hai, bước cập nhật này có thể thực hiện với vòng lặp, tạo ra thuật toán huấn luyện kết hợp với phương pháp Newton, được thể hiện ở thuật toán 8.8.</p><hr><p><strong>Thuật toán 8.8</strong>: Phương pháp Newton với hàm mục tiêu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">J</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1334">θ</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1337" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1338">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1340"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1346" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1342" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">i</span><span class="MJXp-mo" id="MJXp-Span-1344">=</span><span class="MJXp-mn" id="MJXp-Span-1345">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">L</span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">f</span><span class="MJXp-mo" id="MJXp-Span-1351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1354" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1355">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">i</span><span class="MJXp-mo" id="MJXp-Span-1357">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1359">θ</span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1364" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1365">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">i</span><span class="MJXp-mo" id="MJXp-Span-1367">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-200">J(\boldsymbol{\theta})=\frac{1}{m}\sum\limits_{i=1}^{m}L(f(x^{(i)};\boldsymbol{\theta}), y^{(i)})</script></span></p><hr><p><strong>Yêu cầu:</strong> Khởi tạo tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1369"><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1371" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1372" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-201">\boldsymbol{\theta}_0</script></span><br>
<strong>Yêu cầu:</strong> Tập huấn luyện với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">m</span></span></span><script type="math/tex" id="MathJax-Element-202">m</script></span> mẫu<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1375"><span class="MJXp-mspace" id="MJXp-Span-1376" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-203">\quad</script></span> <strong>while</strong> chưa thỏa điều kiện dừng <strong>do</strong>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1377"><span class="MJXp-mspace" id="MJXp-Span-1378" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1379" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-204">\quad\quad</script></span> Tính gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1380"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1381">g</span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1383" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1384">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1386"><span class="MJXp-mi" id="MJXp-Span-1387" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1388" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1389">θ</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1390"><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1392" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">L</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">f</span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1400" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1401">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">i</span><span class="MJXp-mo" id="MJXp-Span-1403">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1405">θ</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1410" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1411">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">i</span><span class="MJXp-mo" id="MJXp-Span-1413">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-205">\boldsymbol{g}\gets \frac{1}{m} \nabla_{\boldsymbol{\theta}}\sum_{i}L(f(x^{(i)};\boldsymbol{\theta}), y^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mspace" id="MJXp-Span-1416" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1417" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-206">\quad\quad</script></span> Tính ma trận Hesse: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1419">H</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1421" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1422">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1424"><span class="MJXp-mi" id="MJXp-Span-1425" style="margin-right: 0.05em;">∇</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1428">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1427">θ</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">L</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">f</span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1439" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1440">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">i</span><span class="MJXp-mo" id="MJXp-Span-1442">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1444">θ</span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1449" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1450">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">i</span><span class="MJXp-mo" id="MJXp-Span-1452">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">\boldsymbol{H}\gets \frac{1}{m} \nabla_{\boldsymbol{\theta}}^2\sum_{i}L(f(x^{(i)};\boldsymbol{\theta}), y^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mspace" id="MJXp-Span-1455" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1456" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-208">\quad\quad</script></span> Tính ma trận nghịch đảo: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1457"><span class="MJXp-msubsup" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1459" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1460" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1461">−</span><span class="MJXp-mn" id="MJXp-Span-1462">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-209">\boldsymbol{H}^{-1}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1463"><span class="MJXp-mspace" id="MJXp-Span-1464" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1465" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-210">\quad\quad</script></span> Tính toán cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mi" id="MJXp-Span-1467">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1468">θ</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1472" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1473" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1474">−</span><span class="MJXp-mn" id="MJXp-Span-1475">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1476">g</span></span></span><script type="math/tex" id="MathJax-Element-211">\Delta \boldsymbol{\theta} = -\boldsymbol{H}^{-1}\boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mspace" id="MJXp-Span-1478" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1479" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-212">\quad\quad</script></span> Áp dụng cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1481">θ</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1483">θ</span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-1485">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1486">θ</span></span></span><script type="math/tex" id="MathJax-Element-213">\boldsymbol{\theta}= \boldsymbol{\theta} + \Delta\boldsymbol{\theta}</script></span><br>
<strong>end while</strong></p><hr><p>Với những hàm số có bề mặt không ở dạng bậc hai, chỉ cần ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1488">H</span></span></span><script type="math/tex" id="MathJax-Element-214">\boldsymbol{H}</script></span> là xác định dương, phương pháp Newton có thể áp dụng với vòng lặp. Cách này bao gồm một thủ tục lặp hai bước. Trước tiên, cập nhật hoặc tính toán ma trận Hesse nghịch đảo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-msubsup" id="MJXp-Span-1490"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1491" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1492" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1493">−</span><span class="MJXp-mn" id="MJXp-Span-1494">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-215">\boldsymbol{H}^{-1}</script></span> (bằng cách cập nhật các xấp xỉ bậc hai). Sau đó, cập nhật các tham số theo phương trình 8.27.</p><p>Trong mục 8.2.3, ta sẽ thảo luận tại sao phương pháp Newton khả dụng chỉ khi ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1496">H</span></span></span><script type="math/tex" id="MathJax-Element-216">\boldsymbol H</script></span> là xác định dương. Trong các mô hình học sâu, hàm mục tiêu thường là không lồi, với nhiều đặc trưng, chẳng hạn như điểm yên ngựa, là vấn đề đối với phương pháp Newton. Nếu tất cả các trị riêng của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1498">H</span></span></span><script type="math/tex" id="MathJax-Element-217">\boldsymbol{H}</script></span> không cùng dương, ví dụ như khi gần gần điểm yên ngựa, thì phương pháp Newton có thể dẫn đến việc cập nhật sai hướng. Có thể giải quyết vấn đề này bằng cách kiểm soát ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1500">H</span></span></span><script type="math/tex" id="MathJax-Element-218">\boldsymbol{H}</script></span>. Các cơ chế kiểm soát ma trận phổ biến là thêm một hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">α</span></span></span><script type="math/tex" id="MathJax-Element-219">\alpha</script></span> dọc theo đường chéo của ma trận Hesse. Công thức cập nhật có kiểm soát trở thành:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1503"><span class="MJXp-mtable" id="MJXp-Span-1504"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1505" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1506" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1508" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1509" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1512" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1513" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1516">H</span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">f</span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1521" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1522" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1527">I</span><span class="MJXp-msubsup" id="MJXp-Span-1528"><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1530" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1531">−</span><span class="MJXp-mn" id="MJXp-Span-1532">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1533"><span class="MJXp-mi" id="MJXp-Span-1534" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-1535" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">f</span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1539" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1540" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-220">
\boldsymbol{\theta}^* = \boldsymbol{\theta}_0 - [\boldsymbol{H}(f(\boldsymbol{\theta}_0))+\alpha \boldsymbol{I}]^{-1}\nabla_\boldsymbol{\theta}f(\boldsymbol{\theta}_0) \tag{8.28}
</script></span></p><p>Chiến lược kiểm soát này được sử dụng để tính xấp xỉ trong phương pháp Newton, như trong thuật toán Levenberg-Marquardt [Levenberg, 1944; Marquardt, 1963], và hoạt động khá tốt miễn là các trị riêng có giá trị âm trong ma trận Hesse vẫn gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1542"><span class="MJXp-mn" id="MJXp-Span-1543">0</span></span></span><script type="math/tex" id="MathJax-Element-221">0</script></span>. Khi có nhiều hướng cong mạnh hơn, giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">α</span></span></span><script type="math/tex" id="MathJax-Element-222">\alpha</script></span> phải đủ lớn để bù cho các trị riêng nhỏ hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mn" id="MJXp-Span-1547">0</span></span></span><script type="math/tex" id="MathJax-Element-223">0</script></span>. Tuy nhiên, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">α</span></span></span><script type="math/tex" id="MathJax-Element-224">\alpha</script></span> tăng giá trị, ma trận Hesse sẽ bị ma trận đường chéo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1552">I</span></span></span><script type="math/tex" id="MathJax-Element-225">\alpha\boldsymbol{I}</script></span> lấn át, và hướng mà phương pháp Newton chọn sẽ hội tụ tới giá trị gradient chuẩn chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">α</span></span></span><script type="math/tex" id="MathJax-Element-226">\alpha</script></span>. Khi đồ thị cong mạnh về phía âm, giá trị có thể <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">α</span></span></span><script type="math/tex" id="MathJax-Element-227">\alpha</script></span> phải lớn đến mức phương pháp Newton sẽ tạo những bước cập nhật nhỏ hơn so với phương pháp trượt gradient với tốc độ học phù hợp.</p><p>Ngoài những thách thức do các đặc trưng của hàm mục tiêu gây ra, như điểm yên ngựa, ứng dụng của phương pháp Newton trong huấn luyện mô hình mạng neuron quy mô lớn sẽ bị giới hạn bởi khối lượng tính toán đáng kể mà nó thực hiện. Số lượng các phần tử trong ma trận Hesse là bình phương của số lượng các tham số, do vậy với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">k</span></span></span><script type="math/tex" id="MathJax-Element-228">k</script></span> tham số (ngay cả với những mạng neuron nhỏ, số lượng tham số có thể lên đến hàng triệu), phương pháp Newton cần tính ma trận nghịch đảo cho ma trận có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">k</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">k</span></span></span><script type="math/tex" id="MathJax-Element-229">k \times k</script></span> – với độ phức tạp tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">O</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567" style="margin-right: 0.05em;">k</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1568" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-230">O(k^3)</script></span>. Hơn nữa, vì các tham số sẽ thay đổi sau mỗi lần cập nhật, việc tính toán ma trận nghịch đảo của Hesse được tính toán <em>tại mọi lần lặp</em> trong quá trình huấn luyện. Kết quả là ta chỉ có thể áp dụng phương pháp Newton cho các mạng với số lượng tham số rất nhỏ. Trong phần còn lại của mục này, chúng ta sẽ thảo luận về các giải pháp thay thế để cố gắng tận dụng ưu điểm của phương pháp Newton nhưng có thể tránh được rào cản tính toán nói trên.</p><h2 id="862-Đạo-hàm-liên-hợp">8.6.2 Đạo hàm liên hợp</h2><p>Đạo hàm liên hợp là một phương pháp hiệu quả để tránh việc tính toán ma trận Hesse nghịch đảo bằng cách lặp lại bước trượt theo các <em>hướng liên hợp</em> (conjugate direction). Ý tưởng của hướng tiếp cận này được lấy từ các nghiên cứu kỹ càng về điểm yếu của phương pháp trượt theo sườn dốc nhất (xem mục 4.3), ở đó phương pháp dò đường được lặp lại theo hướng của gradient. Hình 8.6 mô tả cách hoạt động của phương pháp trượt theo sườn dốc nhất, khi áp dụng với một mặt bậc hai, có thể thấy đường đi đến điểm tối ưu khá zig-zag và không hiệu quả. Điều này xảy ra do hướng dò đường cho bởi gradient phải được đảm bảo rằng nó trực giao với hướng tìm được ở bước dò đường trước.</p><p>Gọi hướng tìm được ở bước trước đó là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1570"><span class="MJXp-msubsup" id="MJXp-Span-1571"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1572" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1573" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">t</span><span class="MJXp-mo" id="MJXp-Span-1575">−</span><span class="MJXp-mn" id="MJXp-Span-1576">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-231">\boldsymbol{d}_{t-1}</script></span>. Tại điểm cực tiểu, nơi mà bước dò đường kết thúc, đạo hàm sẽ bằng không theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1577"><span class="MJXp-msubsup" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1579" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1580" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">t</span><span class="MJXp-mo" id="MJXp-Span-1582">−</span><span class="MJXp-mn" id="MJXp-Span-1583">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-232">\boldsymbol{d}_{t-1}</script></span>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1584"><span class="MJXp-msubsup" id="MJXp-Span-1585"><span class="MJXp-mi" id="MJXp-Span-1586" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1587" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1588">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">J</span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1591">θ</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1595" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1596" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">t</span><span class="MJXp-mo" id="MJXp-Span-1598">−</span><span class="MJXp-mn" id="MJXp-Span-1599">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1601">0</span></span></span><script type="math/tex" id="MathJax-Element-233">\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})\cdot \boldsymbol{d}_{t-1} = 0</script></span>. Bởi vì gradient tại điểm này sẽ xác định hướng dò đường tiếp theo, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1602"><span class="MJXp-msubsup" id="MJXp-Span-1603"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1604" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mi" id="MJXp-Span-1609" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1610" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">J</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1614">θ</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-234">\boldsymbol{d}_{t}=\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})</script></span> sẽ không có tác động nào vào hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1616"><span class="MJXp-msubsup" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1618" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1619" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">t</span><span class="MJXp-mo" id="MJXp-Span-1621">−</span><span class="MJXp-mn" id="MJXp-Span-1622">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-235">\boldsymbol{d}_{t-1}</script></span>. Do đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1623"><span class="MJXp-msubsup" id="MJXp-Span-1624"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1625" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1626" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">t</span><span class="MJXp-mo" id="MJXp-Span-1628">−</span><span class="MJXp-mn" id="MJXp-Span-1629">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-236">\boldsymbol{d}_{t-1}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-237">\boldsymbol{d}_{t}</script></span> trực giao. Mối quan hệ giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-msubsup" id="MJXp-Span-1636"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1637" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1638" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">t</span><span class="MJXp-mo" id="MJXp-Span-1640">−</span><span class="MJXp-mn" id="MJXp-Span-1641">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-238">\boldsymbol{d}_{t-1}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-msubsup" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1644" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1645" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-239">\boldsymbol{d}_{t}</script></span> được mô phỏng trên hình 8.6 với nhiều vòng lặp của phương pháp trượt theo sườn dốc nhất. Như đã giải thích trong hình vẽ, việc trượt theo các hướng trực giao không bảo toàn giá trị cực tiểu dọc theo các hướng dò đường trước đó. Điều này khiến cho đường đi đến điểm tối ưu có dạng zig-zag, mà ở đó khi trượt tới điểm tối ưu theo hướng gradient hiện tại, ta phải cực tiểu hóa lại hàm mục tiêu theo hướng gradient trước đó. Do vậy, khi tìm kiếm theo hướng gradient tại cuối quá trình dò đường, theo mội nghĩa nào đó, ta đã thực hiện lại quá trình tìm kiếm theo hướng của bước dò đường trước đó. Phương pháp đạo hàm liên hợp tìm cách giải quyết vấn đề này.</p><p><img src="https://i.imgur.com/Se2wtQo.png" alt=""></p><blockquote>
<p>Hình 8.6: Phương pháp trượt theo hướng dốc nhất được áp dụng cho một hàm số có bề mặt dạng bậc hai. Phương pháp này sẽ nhảy đến điểm có giá trị hàm chi phí thấp nhất dọc theo đường xác định bởi gradient tại điểm khởi tạo của mỗi bước lặp. Phương pháp này có thể giải quyết một số vấn đề đã nêu trong hình 4.6 khi sử dụng tốc độ học cố định, tuy nhiên ngay cả khi độ lớn bước là tối ưu thì thuật toán vẫn xảy ra hiện tượng đi tới đi lui trong quá trình đi đến điểm tối ưu. Theo định nghĩa, điểm cực tiểu của hàm mục tiêu sẽ nằm dọc theo một hướng cho trước, và gradient tại điểm cuối cùng sẽ trực giao với hướng đó.</p>
</blockquote><p>Trong phương pháp đạo hàm liên hợp, chúng ta cố gắng tìm một hướng tìm kiếm <em>liên hợp</em> (conjugate) với hướng tìm được ở bước trước đó; nghĩa là, ta sẽ không phải lặp lại quá trình tìm kiếm đã thực hiện theo hướng đó nữa. Tại bước lặp thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">t</span></span></span><script type="math/tex" id="MathJax-Element-240">t</script></span> trong quá trình huấn luyện, hướng tìm kiếm tiếp theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1649"><span class="MJXp-msubsup" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1651" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1652" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-241">\boldsymbol{d}_{t}</script></span> sẽ có dạng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1654"><span class="MJXp-mtable" id="MJXp-Span-1655"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1656" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1657" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1658"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1659" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1660" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1663"><span class="MJXp-mi" id="MJXp-Span-1664" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1665" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1666">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">J</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1669">θ</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1674" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-msubsup" id="MJXp-Span-1675"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1676" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1677" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">t</span><span class="MJXp-mo" id="MJXp-Span-1679">−</span><span class="MJXp-mn" id="MJXp-Span-1680">1</span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-242">
\boldsymbol{d}_{t}=\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})+\beta_t \boldsymbol{d}_{t-1} \tag{8.29}
</script></span><br>
ở đây <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1681"><span class="MJXp-msubsup" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1684" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-243">\beta_t</script></span> là một hệ số để kiểm soát tầm quan trọng của hướng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1685"><span class="MJXp-msubsup" id="MJXp-Span-1686"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1687" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1688" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">t</span><span class="MJXp-mo" id="MJXp-Span-1690">−</span><span class="MJXp-mn" id="MJXp-Span-1691">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-244">\boldsymbol{d}_{t-1}</script></span>, mà ta sẽ thêm vào hướng tìm kiếm hiện tại.<br>
Hai hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-msubsup" id="MJXp-Span-1693"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1694" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1695" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-245">\boldsymbol{d}_{t}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1697"><span class="MJXp-msubsup" id="MJXp-Span-1698"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1699" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1700" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">t</span><span class="MJXp-mo" id="MJXp-Span-1702">−</span><span class="MJXp-mn" id="MJXp-Span-1703">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-246">\boldsymbol{d}_{t-1}</script></span> được định nghĩa là liên hợp nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-msubsup" id="MJXp-Span-1705"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1706" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1709"><span class="MJXp-mo" id="MJXp-Span-1710">⊺</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">t</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1711">H</span><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1713" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1714" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">t</span><span class="MJXp-mo" id="MJXp-Span-1716">−</span><span class="MJXp-mn" id="MJXp-Span-1717">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1719">0</span></span></span><script type="math/tex" id="MathJax-Element-247">\boldsymbol{d}_{t}^{\intercal}\boldsymbol{H}\boldsymbol{d}_{t-1}=0</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1721">H</span></span></span><script type="math/tex" id="MathJax-Element-248">\boldsymbol{H}</script></span> là ma trận Hesse.</p><p>Một cách dễ thấy để áp dụng tính liên hợp là tính các vector riêng của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1723">H</span></span></span><script type="math/tex" id="MathJax-Element-249">\boldsymbol{H}</script></span> để chọn hệ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-msubsup" id="MJXp-Span-1725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1727" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-250">\beta_t</script></span>. Phương pháp này không đáp ứng được mục đích của chúng ta là xây dựng một phương pháp thuận lợi về mặt tính toán hơn phương pháp Newton. Liệu chúng ta có thể tìm hướng liên hợp mà không cần phải dùng đến các kiểu tính toán đó hay không? May mắn thay, câu trả lời là có thể.<br>
Hai phương pháp phổ biến để tính toán giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-msubsup" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1731" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-251">\beta_t</script></span> là</p><p>---------------- Thomas Nguyen kết thúc dịch ở đây -------------------------<br>
--------------- Phan Ngọc Tiên bắt đầu dịch ở đây (311-315)</p><ol>
<li>Phương pháp Fletcher-Reeves:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1732"><span class="MJXp-mtable" id="MJXp-Span-1733"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1734" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1735" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1738" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1741" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1742"><span class="MJXp-mi" id="MJXp-Span-1743" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1744" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">J</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1749" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1750" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-msubsup" id="MJXp-Span-1751"><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1753" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1754">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1755"><span class="MJXp-mi" id="MJXp-Span-1756" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1757" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">J</span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1761"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1762" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1763" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1765"><span class="MJXp-mi" id="MJXp-Span-1766" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1767" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">J</span><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1771"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1772" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1773" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">t</span><span class="MJXp-mo" id="MJXp-Span-1775">−</span><span class="MJXp-mn" id="MJXp-Span-1776">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1777"><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1779" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1780">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1781"><span class="MJXp-mi" id="MJXp-Span-1782" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1783" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">J</span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">t</span><span class="MJXp-mo" id="MJXp-Span-1791">−</span><span class="MJXp-mn" id="MJXp-Span-1792">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1793" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-252">\begin{equation}
\beta_{t} = \frac{\nabla_{\theta}J(\boldsymbol{\theta}_t)^{\intercal} \nabla_{\theta}J(\boldsymbol{\theta}_t)}{\nabla_{\theta}J(\boldsymbol{\theta}_{t - 1})^{\intercal} \nabla_{\theta}J(\boldsymbol{\theta}_{t - 1})} \tag{8.30}
\end{equation}</script></span></li>
<li>Phương pháp Polak-Ribière:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1794"><span class="MJXp-mtable" id="MJXp-Span-1795"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1796" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1797" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1800" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1803" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1805"><span class="MJXp-mi" id="MJXp-Span-1806" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1807" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">J</span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1812" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1813" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1817"><span class="MJXp-mi" id="MJXp-Span-1818" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1819" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">J</span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1823"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1824" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1825" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">t</span><span class="MJXp-mo" id="MJXp-Span-1827">−</span><span class="MJXp-mn" id="MJXp-Span-1828">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1830"><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1832" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1833">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mi" id="MJXp-Span-1835" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1836" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">J</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1840"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1841" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1842" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1845"><span class="MJXp-mi" id="MJXp-Span-1846" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1847" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">J</span><span class="MJXp-mo" id="MJXp-Span-1850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1851"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1852" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1853" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">t</span><span class="MJXp-mo" id="MJXp-Span-1855">−</span><span class="MJXp-mn" id="MJXp-Span-1856">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1857"><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1859" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1860">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1861"><span class="MJXp-mi" id="MJXp-Span-1862" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1863" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">J</span><span class="MJXp-mo" id="MJXp-Span-1866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1867"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1868" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1869" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">t</span><span class="MJXp-mo" id="MJXp-Span-1871">−</span><span class="MJXp-mn" id="MJXp-Span-1872">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-253">\begin{equation}
\beta_{t} = \frac{(\nabla_{\theta}J(\boldsymbol{\theta}_{t}) - \nabla_{\theta}J(\boldsymbol{\theta}_{t - 1}))^{\intercal}\nabla_{\theta}J(\boldsymbol{\theta}_{t})}{\nabla_{\theta}J(\boldsymbol{\theta}_{t - 1})^{\intercal}\nabla_{\theta}J(\boldsymbol{\theta}_{t - 1})} \tag{8.31}
\end{equation}</script></span></li>
</ol><p>Với một bề mặt bậc hai, các hướng liên hợp đảm bảo rằng gradient dọc theo hướng trước có độ lớn không tăng. Do đó, chúng ta sẽ ở vị trí cực tiểu dọc theo các hướng phía trước. Hệ quả là trong không gian tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">k</span></span></span><script type="math/tex" id="MathJax-Element-254">k</script></span> chiều, phương pháp gradient liên hợp cần tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">k</span></span></span><script type="math/tex" id="MathJax-Element-255">k</script></span> phép dò đường để tìm được cực tiểu. Thuật toán gradient liên hợp được mô tả trong thuật toán 8.9.</p><hr><p><strong>Thuật toán 8.9</strong>: Phương pháp gradient liên hợp</p><hr><p><strong>Yêu cầu:</strong> Bộ tham số khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1878"><span class="MJXp-msubsup" id="MJXp-Span-1879"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1880" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-bold MJXp-script" id="MJXp-Span-1881" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-256">\boldsymbol{\theta_0}</script></span><br>
<strong>Yêu cầu:</strong> Tập huấn luyện gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">m</span></span></span><script type="math/tex" id="MathJax-Element-257">m</script></span> mẫu<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1884"><span class="MJXp-mspace" id="MJXp-Span-1885" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-258">\quad</script></span> Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1886"><span class="MJXp-msubsup" id="MJXp-Span-1887"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1888" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1889" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1891">0</span></span></span><script type="math/tex" id="MathJax-Element-259">\boldsymbol{\rho}_0 = 0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1892"><span class="MJXp-mspace" id="MJXp-Span-1893" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-260">\quad</script></span> Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1894"><span class="MJXp-msubsup" id="MJXp-Span-1895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1897" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1898">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1900">0</span></span></span><script type="math/tex" id="MathJax-Element-261">g_{0} = 0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1901"><span class="MJXp-mspace" id="MJXp-Span-1902" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-262">\quad</script></span> Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">t</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1906">1</span></span></span><script type="math/tex" id="MathJax-Element-263">t = 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-mspace" id="MJXp-Span-1908" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-264">\quad</script></span> <strong>while</strong> chưa thỏa điều kiện dừng, <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1909"><span class="MJXp-mspace" id="MJXp-Span-1910" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1911" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-265">\quad\quad</script></span> Khởi tạo gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1912"><span class="MJXp-msubsup" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1914" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1915" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1916" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-1917">0</span></span></span><script type="math/tex" id="MathJax-Element-266">\boldsymbol{g}_t = \boldsymbol 0</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1918"><span class="MJXp-mspace" id="MJXp-Span-1919" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1920" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-267">\quad\quad</script></span> Tính toán gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1921"><span class="MJXp-msubsup" id="MJXp-Span-1922"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1923" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1924" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1926" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1927">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1929"><span class="MJXp-mi" id="MJXp-Span-1930" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1931" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">θ</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1933"><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1935" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">L</span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">f</span><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1942" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1943" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1944">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">i</span><span class="MJXp-mo" id="MJXp-Span-1946">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1948">θ</span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1951"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1952" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1953" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1954">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">i</span><span class="MJXp-mo" id="MJXp-Span-1956">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-268">\boldsymbol{g}_t \leftarrow \frac{1}{m}\nabla_{\theta}\sum_{i}L(f(\boldsymbol{x}^{(i)}; \boldsymbol{\theta}), \boldsymbol{y}^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1958"><span class="MJXp-mspace" id="MJXp-Span-1959" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1960" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-269">\quad\quad</script></span> Tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-msubsup" id="MJXp-Span-1962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1964" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1966" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1967">(</span><span class="MJXp-msubsup" id="MJXp-Span-1968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1970" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1971">−</span><span class="MJXp-msubsup" id="MJXp-Span-1972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1974" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">t</span><span class="MJXp-mo" id="MJXp-Span-1976">−</span><span class="MJXp-mn" id="MJXp-Span-1977">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1978"><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1980" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1981">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1984" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">t</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987" style="margin-right: 0.05em;">g</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1992"><span class="MJXp-mo" id="MJXp-Span-1993">⊺</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">t</span><span class="MJXp-mo" id="MJXp-Span-1990">−</span><span class="MJXp-mn" id="MJXp-Span-1991">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1996" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">t</span><span class="MJXp-mo" id="MJXp-Span-1998">−</span><span class="MJXp-mn" id="MJXp-Span-1999">1</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-270">\beta_t = \frac{(g_t - g_{t - 1})^{\intercal}g_{t}}{g_{t - 1}^{\intercal}g_{t - 1}}</script></span> (Polak-Ribière)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2000"><span class="MJXp-mspace" id="MJXp-Span-2001" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2002" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-271">\quad\quad</script></span> (Gradient liên hợp phi tuyến: có thể tuỳ chọn việc thiết lập lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2003"><span class="MJXp-msubsup" id="MJXp-Span-2004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2006" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-272">\beta_t</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2007"><span class="MJXp-mn" id="MJXp-Span-2008">0</span></span></span><script type="math/tex" id="MathJax-Element-273">0</script></span>, chẳng hạn<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-mspace" id="MJXp-Span-2010" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2011" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-274">\quad\quad</script></span> như nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">t</span></span></span><script type="math/tex" id="MathJax-Element-275">t</script></span> là bội của một số hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">k</span></span></span><script type="math/tex" id="MathJax-Element-276">k</script></span> nào đó, ví dụ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">k</span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2019">5</span></span></span><script type="math/tex" id="MathJax-Element-277">k = 5</script></span>)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2020"><span class="MJXp-mspace" id="MJXp-Span-2021" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2022" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-278">\quad\quad</script></span> Tính toán hướng tìm kiếm: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2023"><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2026" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2030" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2031" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2035" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2037"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2038" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2039" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">t</span><span class="MJXp-mo" id="MJXp-Span-2041">−</span><span class="MJXp-mn" id="MJXp-Span-2042">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-279">\boldsymbol{\rho}_t = -\boldsymbol{g}_t + \beta_{t}\boldsymbol{\rho}_{t - 1}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2043"><span class="MJXp-mspace" id="MJXp-Span-2044" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2045" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-280">\quad\quad</script></span> Thực hiện phép dò đường để tìm: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2046"><span class="MJXp-msubsup" id="MJXp-Span-2047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2049" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2050">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2052"><span class="MJXp-mtext" id="MJXp-Span-2053" style="margin-right: 0.05em;">argmin</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2054" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">ϵ</span></span></span><span class="MJXp-mspace" id="MJXp-Span-2056" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-2057" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2058">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2060"><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">i</span><span class="MJXp-mo" id="MJXp-Span-2064">=</span><span class="MJXp-mn" id="MJXp-Span-2065">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">L</span><span class="MJXp-mo" id="MJXp-Span-2069" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">f</span><span class="MJXp-mo" id="MJXp-Span-2071" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2072"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2073" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2074" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2075">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">i</span><span class="MJXp-mo" id="MJXp-Span-2077">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mspace" id="MJXp-Span-2079" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2080"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2081" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2082" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2086" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2087" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2089" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2090" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2092" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2093" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2094">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2095">i</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2096">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2097" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-281">\epsilon^{*} = \text{argmin}_{\epsilon}\,\frac{1}{m}\sum^{m}_{i = 1} L(f(\boldsymbol{x}^{(i)}; \, \boldsymbol{\theta}_t + \epsilon \boldsymbol{\rho_t}), \,\boldsymbol{y^{(i)}})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2098"><span class="MJXp-mspace" id="MJXp-Span-2099" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2100" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-282">\quad\quad</script></span> (Với hàm chi phí có bậc là hai, ta có thể giải <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2101"><span class="MJXp-msubsup" id="MJXp-Span-2102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2104" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2105">∗</span></span></span></span></span><script type="math/tex" id="MathJax-Element-283">\epsilon^{*}</script></span> bằng phương pháp giải tích thay vì<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2106"><span class="MJXp-mspace" id="MJXp-Span-2107" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2108" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-284">\quad\quad</script></span> thực hiện tìm kiếm)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2109"><span class="MJXp-mspace" id="MJXp-Span-2110" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2111" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-285">\quad\quad</script></span> Cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2112"><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2114" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2115" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">t</span><span class="MJXp-mo" id="MJXp-Span-2117">+</span><span class="MJXp-mn" id="MJXp-Span-2118">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2120"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2121" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2122" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2123" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2126" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2127">∗</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2128"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2129" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2130" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-286">\boldsymbol{\theta}_{t + 1} = \boldsymbol{\theta}_t + \epsilon^{*}\boldsymbol{\rho}_t</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2131"><span class="MJXp-mspace" id="MJXp-Span-2132" style="width: 1em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2133" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-287">\quad\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">t</span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">t</span><span class="MJXp-mo" id="MJXp-Span-2138" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2139">1</span></span></span><script type="math/tex" id="MathJax-Element-288">t \leftarrow t + 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2140"><span class="MJXp-mspace" id="MJXp-Span-2141" style="width: 1em; height: 0em;"></span></span></span><script type="math/tex" id="MathJax-Element-289">\quad</script></span> <strong>end while</strong></p><hr><p><strong>Gradient liên hợp phi tuyến</strong> (Nonlinear Conjugate Gradients): Chúng ta đã thảo luận về phương pháp gradient liên hợp khi áp dụng cho các hàm mục tiêu bậc hai. Dĩ nhiên, mối quan tâm chính của chúng ta trong chương này là tìm ra các phương pháp tối ưu hóa để huấn luyện các mạng neuron và các mô hình học sâu mà hàm mục tiêu khác hẳn hàm bậc hai. Có lẽ khá bất ngờ khi biết rằng phương pháp gradient liên hợp vẫn có thể được áp dụng trong trường hợp này, mặc dù cần một vài điều chỉnh. Khi hàm mục tiêu không chắc chắn là hàm bậc hai, các hướng liên hợp cũng không còn được đảm bảo có thể duy trì ở cực tiểu của hàm mục tiêu cho hướng ở các bước trước đó. Kết quả là thuật toán gradient liên hợp phi tuyến  sẽ có vài lần bắt đầu lại việc tìm kiếm đường đi dọc theo hướng gradient không đổi.</p><p>CáC nhà nghiên cứu đã báo cáo lại một số kết quả khả quan trong việc ứng dụng thuật toán gradient liên hợp phi tuyến để huấn luyện một số mạng neuron, mặc dù ta nên khởi tạo cho bài toán tối ưu với một vài bước lặp trượt gradient ngẫu nhiên trước khi thực hiện gradient liên hợp phi tuyến. Mặc dù thuật toán gradient liên hợp (phi tuyến) thường coi như một phương pháp sử dụng toàn lô, các phiên bản theo lô nhỏ cũng được áp dụng thành công cho huấn luyện các mạng neuron [Le et al., 2011]. Một số điều chỉnh cụ thể cho thuật toán gradient liên hợp trong các mạng neuron từng được đề xuất trước đây, chẳng hạn như thuật toán gradient liên hợp chia tỉ lệ [Moller, 1993].</p><h2 id="863-BFGS">8.6.3 BFGS</h2><p><em>Thuật toán Broyden–Fletcher–Goldfarb–Shanno</em> (BFGS) cố gắng tận dụng một số lợi thế của phương pháp Newton mà không tốn quá nhiều chi phí tính toán. Về mặt này, nó giống với phương pháp gradient liên hợp. Tuy nhiên, BFGS ước tính cập nhật Newton một cách trực tiếp hơn. Nhắc lại, cập nhật Newton có dạng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2142"><span class="MJXp-mtable" id="MJXp-Span-2143"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2144" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2145" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2146"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2147" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2148" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2149">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2151"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2152" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2153" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2154">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2156"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2157" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2158" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2159">−</span><span class="MJXp-mn" id="MJXp-Span-2160">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2161"><span class="MJXp-mi" id="MJXp-Span-2162" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2163" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">J</span><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2169" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2170">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-2171" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-290">\begin{equation}
\boldsymbol{\theta}^{*} = \boldsymbol{\theta}_{0} - \boldsymbol{H}^{-1}\nabla_{\theta}J(\theta_{0}), \tag{8.32}
\end{equation}</script></span><br>
trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2174">H</span></span></span><script type="math/tex" id="MathJax-Element-291">\boldsymbol{H}</script></span> là ma trận Hesse của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">J</span></span></span><script type="math/tex" id="MathJax-Element-292">J</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2177"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2178">θ</span></span></span><script type="math/tex" id="MathJax-Element-293">\boldsymbol \theta</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2179"><span class="MJXp-msubsup" id="MJXp-Span-2180"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2181" style="margin-right: 0.05em;">θ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2182" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-294">\boldsymbol \theta_0</script></span>. Khó khăn về mặt tính toán lớn nhất trong áp dụng cập nhật Newton chính là bước tính ma trận nghịch đảo Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2183"><span class="MJXp-msubsup" id="MJXp-Span-2184"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2185" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2186" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2187">−</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-2188">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-295">\boldsymbol{H^{-1}}</script></span>. Các hướng tiếp cận bằng phương pháp <em>bán Newton</em> (quasi-Newton) (trong đó thuật toán BFGS là nổi bật nhất) đó là xấp xỉ ma trận nghịch đảo bằng ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2189"><span class="MJXp-msubsup" id="MJXp-Span-2190"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2191" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2192" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-296">\boldsymbol{M_t}</script></span> được cập nhật từng bước bằng xấp xỉ <em>có hạng nhỏ</em> (low-rank) để trở thành một xấp xỉ tốt hơn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2193"><span class="MJXp-msubsup" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2195" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2196" style="vertical-align: 0.5em;"><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2197">−</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-2198">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-297">\boldsymbol{H^{-1}}</script></span>.</p><p>Giải thích chi tiết và đặc điểm của xấp xỉ BFGS được đề cập trong nhiều sách về tối ưu, trong đó có sách của Luenberger (1984).</p><p>Một khi xấp xỉ của nghịch đảo ma trận Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2199"><span class="MJXp-msubsup" id="MJXp-Span-2200"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2201" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2202" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-298">\boldsymbol{M_t}</script></span> được cập nhật, phương của phép trượt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2203"><span class="MJXp-msubsup" id="MJXp-Span-2204"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2205" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2206" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-299">\boldsymbol{\rho}_t</script></span> được xác định bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2207"><span class="MJXp-msubsup" id="MJXp-Span-2208"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2209" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2210" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2212"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2213" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2214" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-msubsup" id="MJXp-Span-2215"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2216" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2217" style="vertical-align: -0.4em;">t</span></span></span></span><script type="math/tex" id="MathJax-Element-300">\boldsymbol{\rho}_t = \boldsymbol{M}_t \boldsymbol{g}_t</script></span>. Ta thực hiện một phép dò đường trên phương này để xác địch độ lớn của bước, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2218"><span class="MJXp-msubsup" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2221" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2222">∗</span></span></span></span></span><script type="math/tex" id="MathJax-Element-301">\epsilon^{*}</script></span>, được thực hiện theo phương đó. Bước nhật tham số cuối cùng được cho bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2223"><span class="MJXp-mtable" id="MJXp-Span-2224"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2225" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2226" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2227"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2228" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2229" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">t</span><span class="MJXp-mo" id="MJXp-Span-2231">+</span><span class="MJXp-mn" id="MJXp-Span-2232">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2235" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2236" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2240" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2241">∗</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2243" style="margin-right: 0.05em;">ρ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2244" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2245" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-302">\begin{equation}
  \boldsymbol{\theta}_{t + 1} = \boldsymbol{\theta}_t + \epsilon^{*}\boldsymbol{\rho}_t. \tag{8.33}
\end{equation}</script></span></p><p>Giống như phương pháp gradient liên hợp, thuật toán BFGS lặp lại một chuỗi các phép dò đường với hướng có chứa thông tin của đạo hàm bậc hai. Tuy nhiên, không giống như gradient liên hợp, thành công của phương pháp này không quá phụ thuộc vào việc tìm một điểm rất gần với cực tiểu bằng phương pháp dò đường. Vì vậy, so với gradient liên hợp, BFGS có ưu điểm là nó có thể dùng ít thời gian hơn cho việc điều chỉnh mỗi phép dò đường. Mặt khác, thuật toán BFGS phải lưu trữ ma trận nghịch đảo Hesse, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2246"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2247">M</span></span></span><script type="math/tex" id="MathJax-Element-303">\boldsymbol{M}</script></span>, mất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">O</span><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2253" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-304">O(n^2)</script></span> bộ nhớ, khiến cho BFGS không khả thi với hầu hết mô hình học sâu hiện đại thường có tới hàng triệu tham số.</p><p><strong>BFGS có bộ nhớ hạn chế</strong> (limited Memory BFGS, hay L-BFGS): Chi phí bộ nhớ cho thuật toán BFGS có thể được giảm đáng kể bằng cách tránh lưu trữ toàn bộ ước lượng của ma trận nghịch đảo Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2255"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2256">M</span></span></span><script type="math/tex" id="MathJax-Element-305">\boldsymbol{M}</script></span>. Thuật toán L-BFGS tính ước lượng M bằng phương pháp tương tự như BFGS nhưng bắt đầu với giả sử là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2257"><span class="MJXp-msubsup" id="MJXp-Span-2258"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2259" style="margin-right: 0.05em;">M</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2260" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2261">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">t</span><span class="MJXp-mo" id="MJXp-Span-2263">−</span><span class="MJXp-mn" id="MJXp-Span-2264">1</span><span class="MJXp-mo" id="MJXp-Span-2265">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-306">\boldsymbol{M}^{(t - 1)}</script></span> là ma trận đơn vị, thay vì lưu trữ ma trận ước lượng từng bước một. Nếu dùng với dò đường chính xác, những hướng được xác định vởi L-BFGS đôi một liên hợp với nhau. Tuy nhiên, khác với phương pháp gradient liên hợp, quá trình này vẫn thực hiện tốt kể cả khi phép dò đường chỉ đạt được cực tiểu xấp xỉ. Thuật toán L-BFGS được mô tả ở trên có thể được tổng quát hóa để bao gồm nhiều thông tin hơn về ma trận Hesse bằng cách lưu một vài vector dùng để cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2266"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2267">M</span></span></span><script type="math/tex" id="MathJax-Element-307">\boldsymbol{M}</script></span> ở mỗi bước, mỗi bước chỉ tốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">O</span><span class="MJXp-mo" id="MJXp-Span-2270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">n</span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-308">O(n)</script></span>.</p><h1 id="87-Các-chiến-thuật-tối-ưu-và-các-siêu-thuật-toán">8.7 Các chiến thuật tối ưu và các siêu thuật toán</h1><p>Có nhiều kỹ thuật tối ưu không hẳn là một thuật toán, mà giống với các khuôn mẫu tổng quát có thể được cụ thể hóa để tạo thành các thuật toán, hoặc các chương trình con mà có thể được kết hợp  thành nhiều thuật toán khác nhau.</p><h2 id="871-Chuẩn-hóa-theo-lô">8.7.1 Chuẩn hóa theo lô</h2><p><em>Chuẩn hóa theo lô</em> (batch normalization) [Ioffe and Szegedy, 2015] là một trong những phát minh thú vị nhất gần đây trong tối ưu mạng neuron sâu, và nó thực chất không phải là thuật toán tối ưu. Thay vào đó, nó là một phương pháp tái tham số hóa tùy biến, xuất phát từ khó khăn trong việc huấn luyện những mô hình rất nhiều tầng.</p><p>Các mô hình như vậy bao gồm sự hợp thành của nhiều hàm số hoặc nhiều tầng. Gradient cho biết cách cập nhật từng tham số, với giả định là những tầng khác không thay đổi. Trong thực tế, ta đồng thời cập nhật toàn bộ các tầng trong mạng. Khi thực hiện cập nhật, các kết quả không mong muốn có thể xảy ra bởi các hàm tham gia hợp thành thay đổi cùng lúc, sử dụng các cập nhật được tính toán với giả định rằng những hàm còn lại là cố định. Một ví dụ đơn giản, giả sử ta có một mạng neuron đa tầng với mỗi tầng chỉ có một đơn vị và không sử dụng hàm kích hoạt tại mỗi tầng ẩn: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2273"><span class="MJXp-mrow" id="MJXp-Span-2274"><span class="MJXp-munderover" id="MJXp-Span-2275"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">x</span><span class="MJXp-msubsup" id="MJXp-Span-2280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2282" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2283">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2286" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2287">2</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2290" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2291">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-msubsup" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2295" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296">l</span></span></span></span></span><script type="math/tex" id="MathJax-Element-309">\hat{y} = x w_{1}w_{2}w_{3}\cdots w_{l}</script></span>. Ở đây, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2297"><span class="MJXp-msubsup" id="MJXp-Span-2298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2300" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-310">w_{i}</script></span> là trọng số được sử dụng bởi tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">i</span></span></span><script type="math/tex" id="MathJax-Element-311">i</script></span>. Đầu ra của tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">i</span></span></span><script type="math/tex" id="MathJax-Element-312">i</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2306"><span class="MJXp-msubsup" id="MJXp-Span-2307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2309" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2313" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">i</span><span class="MJXp-mo" id="MJXp-Span-2315">−</span><span class="MJXp-mn" id="MJXp-Span-2316">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2319" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-313">h_i= h_{i - 1}w_{i}</script></span>.</p><p>Đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2321"><span class="MJXp-mrow" id="MJXp-Span-2322"><span class="MJXp-munderover" id="MJXp-Span-2323"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-314">\hat{y}</script></span> là một hàm tuyến tính của đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">x</span></span></span><script type="math/tex" id="MathJax-Element-315">x</script></span> nhưng là một hàm phi tuyến của các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2331" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-316">w_i</script></span>. Giả sử hàm chi phí có gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2332"><span class="MJXp-mn" id="MJXp-Span-2333">1</span></span></span><script type="math/tex" id="MathJax-Element-317">1</script></span> với giá trị hiện tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mrow" id="MJXp-Span-2335"><span class="MJXp-munderover" id="MJXp-Span-2336"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2338" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-318">\hat{y}</script></span>, nên ta muốn giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-mrow" id="MJXp-Span-2340"><span class="MJXp-munderover" id="MJXp-Span-2341"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2343" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-319">\hat{y}</script></span> một lượng nhỏ. Sau đó, thuật toán lan truyền ngược có thể tính một gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2344"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2345">g</span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2347"><span class="MJXp-mi" id="MJXp-Span-2348" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2349" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">w</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2351"><span class="MJXp-munderover" id="MJXp-Span-2352"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-320">\boldsymbol{g} = \nabla_{w}\hat{y}</script></span>. Điều gì sẽ xảy ra khi cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2355"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2356">w</span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2358">w</span><span class="MJXp-mo" id="MJXp-Span-2359" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2361">g</span></span></span><script type="math/tex" id="MathJax-Element-321">\boldsymbol{w} \leftarrow \boldsymbol{w} - \epsilon \boldsymbol{g}</script></span>. Khai triển chuỗi Taylor bậc nhất của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2362"><span class="MJXp-mrow" id="MJXp-Span-2363"><span class="MJXp-munderover" id="MJXp-Span-2364"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2366" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-322">\hat{y}</script></span> dự đoán giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2367"><span class="MJXp-mrow" id="MJXp-Span-2368"><span class="MJXp-munderover" id="MJXp-Span-2369"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-323">\hat{y}</script></span> sẽ giảm một lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2375" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2376" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2377">g</span></span></span><script type="math/tex" id="MathJax-Element-324">\epsilon \boldsymbol{g}^\top \boldsymbol{g}</script></span>. Nếu muốn giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mrow" id="MJXp-Span-2379"><span class="MJXp-munderover" id="MJXp-Span-2380"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-325">\hat{y}</script></span> một lượng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2383"><span class="MJXp-mn" id="MJXp-Span-2384">0.1</span></span></span><script type="math/tex" id="MathJax-Element-326">0.1</script></span>, dựa vào khai triển bậc một trên, ta có thể thiết lập tốc độ học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">ϵ</span></span></span><script type="math/tex" id="MathJax-Element-327">\epsilon</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2387"><span class="MJXp-mfrac" id="MJXp-Span-2388" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2389">0.1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2390"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2391" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2392" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2393">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2394">g</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-328">\frac{0.1}{\boldsymbol{g}^{\intercal}\boldsymbol{g}}</script></span>. Tuy nhiên, trong thực tế bước cập nhật sẽ bao gồm tác động của khai triển bậc hai, bậc ba cho tới bậc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">l</span></span></span><script type="math/tex" id="MathJax-Element-329">l</script></span>. Giá trị mới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mrow" id="MJXp-Span-2398"><span class="MJXp-munderover" id="MJXp-Span-2399"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-330">\hat{y}</script></span> sẽ được cho bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2402"><span class="MJXp-mtable" id="MJXp-Span-2403"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2404" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2405" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">x</span><span class="MJXp-mo" id="MJXp-Span-2407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2410" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2415" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2420" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2425" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2431" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">l</span></span></span><span class="MJXp-mo" id="MJXp-Span-2438" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-331">\begin{equation}
  x(w_1 - \epsilon g_1)(w_2 - \epsilon g_2)\dots(w_l - \epsilon g_{l}) \tag{8.34}
\end{equation}</script></span></p><p>Một ví dụ về một số hạng trong khai triển bậc hai từ cập nhật này là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2439"><span class="MJXp-msubsup" id="MJXp-Span-2440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2442" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2445" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2446">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2449" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2450">2</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2451"><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">l</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">i</span><span class="MJXp-mo" id="MJXp-Span-2455">=</span><span class="MJXp-mn" id="MJXp-Span-2456">3</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2461" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-332">\epsilon^2 g_{1}g_{2}\prod^{l}_{i = 3}w_i</script></span>. Số hạng này có thể bỏ qua được nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2462"><span class="MJXp-msubsup" id="MJXp-Span-2463"><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">l</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">i</span><span class="MJXp-mo" id="MJXp-Span-2467">=</span><span class="MJXp-mn" id="MJXp-Span-2468">3</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2473" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-333">\prod^{l}_{i = 3}w_i</script></span> nhỏ, và cũng có thể trở nên lớn theo cấp số nhân nếu trọng số từ tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2474"><span class="MJXp-mn" id="MJXp-Span-2475">3</span></span></span><script type="math/tex" id="MathJax-Element-334">3</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">l</span></span></span><script type="math/tex" id="MathJax-Element-335">l</script></span> đều lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2478"><span class="MJXp-mn" id="MJXp-Span-2479">1</span></span></span><script type="math/tex" id="MathJax-Element-336">1</script></span>. Điều đó khiến cho việc chọn tốc độ học phù hợp trở nên rất khó khăn, vì ảnh hưởng của một cập nhật lên các tham số cho một tầng phụ thuộc rất lớn vào những tầng khác. Thuật toán tối ưu bậc hai xử lý vấn đề này bằng cách tính toán một cập nhật sử dụng các mối liên hệ bậc hai, nhưng ta có thể thấy rằng trong các mạng rất nhiều tầng, những mối liên hệ bậc cao hơn cũng có thể đóng góp ảnh hưởng lớn. Ngay cả các thuật toán tối ưu bậc hai cũng đã rất tốn kém về mặt tính toán và thường đòi hỏi vô số phép xấp xỉ khiến chúng không thể thực sự bao hàm được tất cả những liên hệ bậc hai. Cho nên việc xây dựng thuật toán tối ưu hóa với bậc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">n</span></span></span><script type="math/tex" id="MathJax-Element-337">n</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483">n</span><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2485">2</span></span></span><script type="math/tex" id="MathJax-Element-338">n > 2</script></span> có vẻ không khả khi. Vậy chúng ta có thể làm gì khác?</p><p>Phép chuẩn hóa theo lô cung cấp một cách thức tinh tế để tái tham số hóa gần như bất kỳ mạng đa tầng nào. Sự tái tham số hóa làm giảm đáng kể vấn đề điều phối các cập nhật qua nhiều tầng. Chuẩn hóa theo lô có thể được áp dụng vào bất kỳ đầu vào hay tầng ẩn nào trong một mạng. Giả sử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2487">H</span></span></span><script type="math/tex" id="MathJax-Element-339">\boldsymbol{H}</script></span> là một lô nhỏ các hàm kích hoạt của tầng ta chuẩn hóa, được sắp xếp theo một ma trận thiết kế (xem phần 5.1.3), với các hàm kích hoạt cho mỗi ví dụ là một hàng của ma trận. Để chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2489">H</span></span></span><script type="math/tex" id="MathJax-Element-340">\boldsymbol{H}</script></span>, ta có thể thay thế nó bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2490"><span class="MJXp-mtable" id="MJXp-Span-2491"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2492" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2493" style="text-align: center;"><span class="MJXp-msup" id="MJXp-Span-2494"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2495" style="margin-right: 0.05em;">H</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2496" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2498" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2499">H</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2501">μ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2502">σ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-341">\begin{equation}
  \boldsymbol{H}' = \frac{\boldsymbol{H} - \boldsymbol{\mu}}{\boldsymbol{\sigma}}, \tag{8.35}
\end{equation}</script></span><br>
trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2504"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2505">μ</span></span></span><script type="math/tex" id="MathJax-Element-342">\boldsymbol{\mu}</script></span> là vector giá trị trung bình và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2506"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2507">σ</span></span></span><script type="math/tex" id="MathJax-Element-343">\boldsymbol{\sigma}</script></span> là vector độ lệch chuẩn của mỗi đơn vị. Phép toán số học ở đây dựa trên việc phát tán (broadcasting) vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2508"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2509">μ</span></span></span><script type="math/tex" id="MathJax-Element-344">\boldsymbol{\mu}</script></span> và vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2510"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2511">σ</span></span></span><script type="math/tex" id="MathJax-Element-345">\boldsymbol{\sigma}</script></span> vào mọi hàng của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2512"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2513">H</span></span></span><script type="math/tex" id="MathJax-Element-346">\boldsymbol{H}</script></span>. Trong mỗi hàng, thuật toán thực hiện theo từng phần tử, vì vậy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2514"><span class="MJXp-msubsup" id="MJXp-Span-2515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2517" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518">i</span><span class="MJXp-mo" id="MJXp-Span-2519">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-347">H_{i, j}</script></span> được chuẩn hóa bằng cách trừ đi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2521"><span class="MJXp-msubsup" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523" style="margin-right: 0.05em;">μ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2524" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-348">\mu_{j}</script></span> và chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2526"><span class="MJXp-msubsup" id="MJXp-Span-2527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528" style="margin-right: 0.05em;">σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2529" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2530">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-349">\sigma_{j}</script></span>. Sau đó, phần còn lại của mạng thực hiện trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2531"><span class="MJXp-msup" id="MJXp-Span-2532"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2533" style="margin-right: 0.05em;">H</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2534" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-350">\boldsymbol{H}'</script></span> với cách hoàn toàn giống như mạng ban đầu thực hiện trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2535"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2536">H</span></span></span><script type="math/tex" id="MathJax-Element-351">\boldsymbol{H}</script></span>.</p><blockquote>
<p><em><strong>ND:</strong></em> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2538">σ</span></span></span><script type="math/tex" id="MathJax-Element-352">\boldsymbol{\sigma}</script></span> ở trên là một vector, và do đó phép chia vector trong phương trình (8.35) là không xác định. Ý các tác giả ở đây là phép chia này được thực hiện theo từng phần tử của ma trận và vector.</p>
</blockquote><p>Tại thời điểm huấn luyện,<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2539"><span class="MJXp-mtable" id="MJXp-Span-2540"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2541" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2542" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2543">μ</span><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2545" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2546">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2548"><span><span class="MJXp-mo" id="MJXp-Span-2549" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2550" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2553" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2554" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">i</span><span class="MJXp-mo" id="MJXp-Span-2556">,</span><span class="MJXp-mo" id="MJXp-Span-2557">:</span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-353">\begin{equation}
  \boldsymbol{\mu} = \frac{1}{m}\sum_{i}\boldsymbol{H}_{i, :} \tag{8.36}
\end{equation}</script></span><br>
và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2558"><span class="MJXp-mtable" id="MJXp-Span-2559"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2560" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2561" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2562">σ</span><span class="MJXp-mo" id="MJXp-Span-2563" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-2564"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 306%; margin-top: 0.046em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">δ</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2567" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2568">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2570"><span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2572" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2575">H</span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2577">μ</span><span class="MJXp-msubsup" id="MJXp-Span-2578"><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2582">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581">i</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2583" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-354">\begin{equation}
  \boldsymbol{\sigma} = \sqrt{\delta + \frac{1}{m}\sum_{i}(\boldsymbol{H} - \boldsymbol{\mu})^2_{i}}, \tag{8.37}
\end{equation}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585">δ</span></span></span><script type="math/tex" id="MathJax-Element-355">\delta</script></span> là một giá trị dương rất nhỏ, chẳng hạn như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2586"><span class="MJXp-msubsup" id="MJXp-Span-2587"><span class="MJXp-mn" id="MJXp-Span-2588" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2589" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2590">−</span><span class="MJXp-mn" id="MJXp-Span-2591">8</span></span></span></span></span><script type="math/tex" id="MathJax-Element-356">10^{-8}</script></span>, để tránh gặp phải gradient không xác định của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2592"><span class="MJXp-msqrt" id="MJXp-Span-2593"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594">z</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-357">\sqrt{z}</script></span> tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">z</span><span class="MJXp-mo" id="MJXp-Span-2597" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2598">0</span></span></span><script type="math/tex" id="MathJax-Element-358">z = 0</script></span>. Điều quan trọng là <em>ta lan truyền ngược thông qua các phép toán trên</em> để tính toán trung bình và độ lệch chuẩn, và để áp dụng chúng cho việc chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2600">H</span></span></span><script type="math/tex" id="MathJax-Element-359">\boldsymbol{H}</script></span>. Điều này có nghĩa là gradient sẽ không bao giờ đề xuất một phép toán chỉ để tăng độ lệch chuẩn hoặc giá trị trung bình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2601"><span class="MJXp-msubsup" id="MJXp-Span-2602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2604" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-360">h_i</script></span>; các phép toán chuẩn hóa loại bỏ tác động của một hành động như vậy và triệt tiêu thành phần của nó trong gradient. Đây chính là phát kiến chủ yếu của chuẩn hoá theo lô. Các hướng tiếp cận trước đây bao gồm việc thêm mức phạt vào hàm chi phí để khuyến khích các neuron có các thống kê của hàm kích hoạt đã chuẩn hóa, hoặc bao gồm việc can thiệp để chuẩn hóa lại các thống kê của neuron sau mỗi bước trượt gradient. Cách tiếp cận đầu tiên thường gây ra việc chuẩn hóa không tốt, còn hướng thứ hai thường tiêu tốn rất nhiều thời gian vì thuật toán học phải lặp đi lặp lại việc thay đổi giá trị trung bình và phương sai, và bước chuẩn hóa lại loại bỏ sự thay đổi này. Phép chuẩn hóa theo lô giúp tái tham số hóa mô hình để khiến một số neuron luôn được chuẩn hóa, qua đó khéo léo tránh được cả hai vấn đề nêu trên.</p><p>Khi kiểm thử, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2605"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2606">μ</span></span></span><script type="math/tex" id="MathJax-Element-361">\boldsymbol{\mu}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2607"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2608">σ</span></span></span><script type="math/tex" id="MathJax-Element-362">\boldsymbol{\sigma}</script></span> có thể được thay bởi các trung bình thu thập được trong quá trình huấn luyện. Điều này cho phép mô hình có thể được đánh giá trên một mẫu đơn lẻ, mà không cần xác định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2609"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2610">μ</span></span></span><script type="math/tex" id="MathJax-Element-363">\boldsymbol{\mu}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2612">σ</span></span></span><script type="math/tex" id="MathJax-Element-364">\boldsymbol{\sigma}</script></span>, những đại lượng phụ thuộc vào toàn bộ lô nhỏ.</p><p>Quay lại ví dụ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2613"><span class="MJXp-mrow" id="MJXp-Span-2614"><span class="MJXp-munderover" id="MJXp-Span-2615"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2618" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619">x</span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2622" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2623">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2626" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2627">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2628" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-2629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2631" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">l</span></span></span></span></span><script type="math/tex" id="MathJax-Element-365">\hat{y} = x w_{1}w_{2} \dots w_{l}</script></span>, ta thấy rằng ta có thể giải quyết các khó khăn trong việc học của mô hình này bằng cách chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2633"><span class="MJXp-msubsup" id="MJXp-Span-2634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2636" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">l</span><span class="MJXp-mo" id="MJXp-Span-2638">−</span><span class="MJXp-mn" id="MJXp-Span-2639">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-366">h_{l - 1}</script></span>. Giả sử rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">x</span></span></span><script type="math/tex" id="MathJax-Element-367">x</script></span> được chọn từ một đơn vị Gauss, thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2642"><span class="MJXp-msubsup" id="MJXp-Span-2643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2645" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">l</span><span class="MJXp-mo" id="MJXp-Span-2647">−</span><span class="MJXp-mn" id="MJXp-Span-2648">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-368">h_{l - 1}</script></span> cũng là phân phối chuẩn bởi  các phép biến đổi từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">x</span></span></span><script type="math/tex" id="MathJax-Element-369">x</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2651"><span class="MJXp-msubsup" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2654" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">l</span></span></span></span></span><script type="math/tex" id="MathJax-Element-370">h_{l}</script></span> là tuyến tính. Thế nhưng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2656"><span class="MJXp-msubsup" id="MJXp-Span-2657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">l</span><span class="MJXp-mo" id="MJXp-Span-2661">−</span><span class="MJXp-mn" id="MJXp-Span-2662">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-371">h_{l - 1}</script></span> sẽ không còn giá trị trung bình là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2663"><span class="MJXp-mn" id="MJXp-Span-2664">0</span></span></span><script type="math/tex" id="MathJax-Element-372">0</script></span> và phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2665"><span class="MJXp-mn" id="MJXp-Span-2666">1</span></span></span><script type="math/tex" id="MathJax-Element-373">1</script></span>. Sau khi áp dụng chuẩn hóa theo lô, ta thu được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2667"><span class="MJXp-msubsup" id="MJXp-Span-2668"><span class="MJXp-mrow" id="MJXp-Span-2669" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2670"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">h</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2673" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674">l</span><span class="MJXp-mo" id="MJXp-Span-2675">−</span><span class="MJXp-mn" id="MJXp-Span-2676">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-374">\hat{h}_{l - 1}</script></span> đã chuẩn hóa và có lại tính chất trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2677"><span class="MJXp-mn" id="MJXp-Span-2678">0</span></span></span><script type="math/tex" id="MathJax-Element-375">0</script></span> và phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2679"><span class="MJXp-mn" id="MJXp-Span-2680">1</span></span></span><script type="math/tex" id="MathJax-Element-376">1</script></span>. Với gần như mọi cập nhật cho những tầng thấp hơn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2681"><span class="MJXp-msubsup" id="MJXp-Span-2682"><span class="MJXp-mrow" id="MJXp-Span-2683" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2684"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2686" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">h</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2687" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688">l</span><span class="MJXp-mo" id="MJXp-Span-2689">−</span><span class="MJXp-mn" id="MJXp-Span-2690">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-377">\hat{h}_{l - 1}</script></span> sẽ vẫn là một đơn vị Gauss. Đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2691"><span class="MJXp-mrow" id="MJXp-Span-2692"><span class="MJXp-munderover" id="MJXp-Span-2693"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2695" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-378">\hat{y}</script></span> sau đó có thể được học như một hàm tuyến tính đơn giản <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2696"><span class="MJXp-mrow" id="MJXp-Span-2697"><span class="MJXp-munderover" id="MJXp-Span-2698"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2700" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2701" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2704" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705">l</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2706"><span class="MJXp-mrow" id="MJXp-Span-2707" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2708"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">h</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2711" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2712">l</span><span class="MJXp-mo" id="MJXp-Span-2713">−</span><span class="MJXp-mn" id="MJXp-Span-2714">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-379">\hat{y} = w_{l}\hat{h}_{l - 1}</script></span>. Quá trình học trong mô hình này giờ đây trở nên rất đơn giản vì các tham số ở những tầng thấp hơn không có ảnh hưởng trong phần lớn các trường hợp; đầu ra của chúng luôn luôn được chuẩn hóa lại về một đơn vị Gauss.</p><p>--------------- Phan Ngọc Tiên kết thúc dịch ở đây</p><p>------------------------<br>
Bùi Kim Thành Sơn bắt đầu dịch từ đây<br>
------------------------</p><p>Trong một số trường hợp ít khi xảy ra, các tầng thấp hơn vẫn có thể có ảnh hưởng. Thay đổi một trong các trọng số của tầng thấp hơn về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2715"><span class="MJXp-mn" id="MJXp-Span-2716">0</span></span></span><script type="math/tex" id="MathJax-Element-380">0</script></span> có thể khiến đầu ra dần suy giảm, và đổi dấu của một trong những trọng số đó có thể lật ngược mối quan hệ giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2717"><span class="MJXp-msubsup" id="MJXp-Span-2718"><span class="MJXp-mrow" id="MJXp-Span-2719" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2720"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721">h</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2723" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">l</span><span class="MJXp-mo" id="MJXp-Span-2725">−</span><span class="MJXp-mn" id="MJXp-Span-2726">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-381">\hat{h}_{l-1}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728">y</span></span></span><script type="math/tex" id="MathJax-Element-382">y</script></span>. Những tình huống này rất hiếm khi xảy ra. Nếu không thực hiện chuẩn hóa, gần như mọi cập nhật sẽ ảnh hưởng rất mạnh đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2729"><span class="MJXp-msubsup" id="MJXp-Span-2730"><span class="MJXp-mrow" id="MJXp-Span-2731" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2732"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2734" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733">h</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2735" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736">l</span><span class="MJXp-mo" id="MJXp-Span-2737">−</span><span class="MJXp-mn" id="MJXp-Span-2738">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-383">\hat{h}_{l-1}</script></span>. Phép chuẩn hóa theo lô đã khiến việc học trong mô hình này trở nên dễ dàng hơn rất nhiều. Trong ví dụ trên, ta làm cho việc học trở nên dễ dàng hơn nhưng lại khiến các tầng thấp hơn trở nên ít hữu dụng hơn. Trong ví dụ tuyến tính của chúng ta, các tầng bên dưới không còn bất kỳ ảnh hưởng tiêu cực nào, nhưng đồng thời chúng cũng không còn mang lại bất kỳ lợi ích nào. Điều này là do chúng ta đã chuẩn hóa các thông kê bậc nhất và bậc hai; đó là tất cả những gì mà một mạng tuyến tính có được. Trong một mạng neuron đa tầng với các hàm kích hoạt phi tuyến, các tầng thấp hơn có thể thực hiện các phép biến đổi phi tuyến của dữ liệu, do đó chúng vẫn hữu ích. Phép chuẩn hóa theo lô chỉ chuẩn hóa trung bình và phương sai của từng đơn vị để ổn định việc học, nhưng nó cho phép thay đổi sự liên hệ giữa các đơn vị và các thống kê phi tuyến của một đơn vị.</p><p>Bởi vì lớp cuối cùng của mạng có thể học một phép biến đổi tuyến tính, trên thực tế ta có thể muốn loại bỏ tất cả các mối quan hệ tuyến tính giữa các đơn vị trong một lớp. Thật vậy, đây là cách tiếp cận được thực hiện bởi Desjardins và cộng sự (2015), người đã đưa ra nguồn cảm hứng cho phép chuẩn hóa theo lô. Không may là việc loại bỏ toàn bộ tương tác tuyến tính tốn kém về mặt tính toán hơn nhiều so với việc chuẩn hóa trung bình và độ lệch chuẩn của từng đơn vị riêng biệt, và cho đến nay chuẩn hóa theo lô vẫn là cách tiếp cận thực tế nhất.</p><p>Việc chuẩn hóa giá trị trung bình và độ lệch chuẩn một đơn vị có thể làm giảm khả năng biểu đạt của mạng neuron chứa đơn vị đó. Để duy trì khả năng biểu đạt của mạng, người ta thường thay thế toàn bộ hàm kích hoạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2739"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2740">H</span></span></span><script type="math/tex" id="MathJax-Element-384">\boldsymbol{H}</script></span> của đơn vị ẩn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2743"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2744" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2745" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2746"><span class="MJXp-mi" id="MJXp-Span-2747" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2748" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750">β</span></span></span><script type="math/tex" id="MathJax-Element-385">\gamma \boldsymbol H^{'} + \beta</script></span> thay vì đơn giản là phiên bản được chuẩn hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2751"><span class="MJXp-msubsup" id="MJXp-Span-2752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2754" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2755"><span class="MJXp-mi" id="MJXp-Span-2756" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2757" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-386">H^{'}</script></span>. Các biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759">γ</span></span></span><script type="math/tex" id="MathJax-Element-387">\gamma</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761">β</span></span></span><script type="math/tex" id="MathJax-Element-388">\beta</script></span> là các tham số được học cho phép một biến mới có thể có bất kỳ giá trị trung bình và độ lệch chuẩn nào. Thoạt nhìn, điều này có vẻ vô nghĩa - tại sao ta đã thiết lập giá trị trung bình là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2762"><span class="MJXp-mn MJXp-bold" id="MJXp-Span-2763">0</span></span></span><script type="math/tex" id="MathJax-Element-389">\boldsymbol 0</script></span>, rồi sau đó lại đưa ra một tham số cho phép nó được gán trở lại bất kỳ giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">β</span></span></span><script type="math/tex" id="MathJax-Element-390">\beta</script></span> tùy ý nào? Câu trả lời là phương pháp tham số hóa mới có thể đại diện cho cùng một họ các hàm của đầu vào như cách cũ, nhưng phương pháp mới có tiến trình học khác. Trong phương pháp cũ, giá trị trung bình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2766"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2767">H</span></span></span><script type="math/tex" id="MathJax-Element-391">\boldsymbol{H}</script></span> được xác định bởi một tương tác phức tạp giữa các tham số trong các tầng bên dưới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2768"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2769">H</span></span></span><script type="math/tex" id="MathJax-Element-392">\boldsymbol H</script></span>. Trong phương pháp mới, giá trị trung bình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2772"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2773" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2774" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2775"><span class="MJXp-mi" id="MJXp-Span-2776" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2777" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779">β</span></span></span><script type="math/tex" id="MathJax-Element-393">\gamma \boldsymbol H^{'} + \beta</script></span> chỉ được xác định duy nhất bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781">β</span></span></span><script type="math/tex" id="MathJax-Element-394">\beta</script></span>. Việc học với phương pháp tham số hóa mới này bằng thuật toán trượt gradent trở nên dễ dàng hơn nhiều.</p><p>Hầu hết các tầng mạng neuron đều có dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">ϕ</span><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2785">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2786">W</span><span class="MJXp-mo" id="MJXp-Span-2787" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2788">b</span><span class="MJXp-mo" id="MJXp-Span-2789" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-395">\phi (\boldsymbol X\boldsymbol W + \boldsymbol b)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">ϕ</span></span></span><script type="math/tex" id="MathJax-Element-396">\phi</script></span> là một số hàm kích hoạt phi tuyến được cố định, chẳng hạn như bộ tuyến tính hiệu chỉnh. Một câu hỏi được đặt ra ở đây là ta có nên áp dụng chuẩn hóa theo lô cho đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2792"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2793">X</span></span></span><script type="math/tex" id="MathJax-Element-397">\boldsymbol X</script></span> hay là giá trị được chuyển đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2794"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2795">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2796">W</span><span class="MJXp-mo" id="MJXp-Span-2797" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2798">b</span></span></span><script type="math/tex" id="MathJax-Element-398">\boldsymbol X \boldsymbol W + \boldsymbol b</script></span>. Ioffe và Szegedy (2015) khuyến nghị sử dụng phương án thứ hai. Cụ thể hơn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2799"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2800">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2801">W</span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2803">b</span></span></span><script type="math/tex" id="MathJax-Element-399">\boldsymbol X \boldsymbol W + \boldsymbol b</script></span> nên được thay thế bằng phiên bản chuẩn hóa của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2804"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2805">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2806">W</span></span></span><script type="math/tex" id="MathJax-Element-400">\boldsymbol{XW}</script></span>. Hệ số tự do nên được bỏ qua vì nó trở nên dư thừa khi tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2808">β</span></span></span><script type="math/tex" id="MathJax-Element-401">\beta</script></span> được áp dụng bởi phép tái tham số hóa trong phương pháp chuẩn hóa theo lô. Đầu vào của một tầng thường là đầu ra của một hàm kích hoạt phi tuyến trong tầng trước đó. Do đó, các thống kê của của đầu vào ít có khả năng đến từ một phân phối chuẩn hơn và ít tuân theo sự chuẩn hóa của các phép toán tuyến tính hơn.</p><p>Trong cách mạng tích chập, mô tả trong chương 9, việc áp dụng cùng một chuẩn hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810">μ</span></span></span><script type="math/tex" id="MathJax-Element-402">\mu</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812">σ</span></span></span><script type="math/tex" id="MathJax-Element-403">\sigma</script></span> cho tất cả các vị trí nằm trong một bản đồ thuộc tính là quan trọng, để cho các thống kê của bản đồ thuộc tính không thanh đổi bất kể ở vị trí nào.</p><h2 id="872-Trượt-theo-tọa-độ">8.7.2 Trượt theo tọa độ</h2><p>Trong một số trường hợp, ta có thể giải quyết nhanh bài toán tối ưu bằng cách chia nhỏ nó thành từng phần riêng biệt. Nếu ta cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">f</span><span class="MJXp-mo" id="MJXp-Span-2815" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2816">x</span><span class="MJXp-mo" id="MJXp-Span-2817" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-404">f(\boldsymbol x)</script></span> đối với một đơn biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2818"><span class="MJXp-msubsup" id="MJXp-Span-2819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2821" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2822">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-405">x_{i}</script></span>, sau đó cực tiểu hóa nó đối với một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2823"><span class="MJXp-msubsup" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2826" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-406">x_{j}</script></span> khác, vân vân, và cứ thế lặp lại quá trình này qua toàn bộ các biến, đảm bảo rằng ta sẽ đạt được một điểm cực tiểu (cục bộ). Thuật toán này được gọi là <em>trượt theo tọa độ</em> (coordinate descent), bởi ta tối ưu hóa một tọa độ tại một thời điểm. Tổng quát hơn, <em>trượt tọa độ theo khối</em> (block coordinate descent) là việc cùng lúc cực tiểu hóa đối với một tập con của các biến. Thuật ngữ “trượt theo tọa độ” thường được dùng để ám chỉ thuật toán trượt theo khối cũng như là trượt theo từng toạ độ một.</p><p>Thuật toán trượt theo tọa độ được sử dụng hợp lý nhất khi các biến khác nhau trong bài toán tối ưu có thể được phân tách rõ ràng thành các nhóm có các vai trò tương đối cô lập nhau, hoặc khi việc tối ưu được thực hiện với một nhóm biến nào đó hiệu quả hơn khi tối ưu với toàn bộ các biến. Ví dụ, xét hàm chi phí</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2828"><span class="MJXp-mtable" id="MJXp-Span-2829"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2830" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2831" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832">J</span><span class="MJXp-mo" id="MJXp-Span-2833" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2834">H</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2835" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2836">W</span><span class="MJXp-mo" id="MJXp-Span-2837" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2838" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2839"><span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2841" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2842">i</span><span class="MJXp-mo" id="MJXp-Span-2843">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2844">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2845"><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2849" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">i</span><span class="MJXp-mo" id="MJXp-Span-2851">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2853"><span class="MJXp-mo" id="MJXp-Span-2854" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2855" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2856"><span><span class="MJXp-mo" id="MJXp-Span-2857" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2858" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">i</span><span class="MJXp-mo" id="MJXp-Span-2860">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2863">X</span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2865"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2866" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2867" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2868">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2869">H</span><span class="MJXp-msubsup" id="MJXp-Span-2870"><span class="MJXp-mo" id="MJXp-Span-2871" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2876"><span class="MJXp-mn" id="MJXp-Span-2877">2</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">i</span><span class="MJXp-mo" id="MJXp-Span-2874">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">j</span></span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-407">J(\boldsymbol{H, W}) = \sum_{i, j}|H_{i, j}| + \sum_{i, j}(\boldsymbol X - \boldsymbol W^{\intercal}\boldsymbol H)_{i, j}^{2} \tag{8.38}</script></span></p><p>Hàm này mô tả một bài toán học tập gọi là mã hóa thưa (sparse coding), với mục đích là tìm một ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2878"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2879">W</span></span></span><script type="math/tex" id="MathJax-Element-408">\boldsymbol W</script></span> có thể <em>giải mã</em> (decode) tuyến tính một ma trận của các giá trị kích hoạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2880"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2881">H</span></span></span><script type="math/tex" id="MathJax-Element-409">\boldsymbol H</script></span> để tái tạo tập huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2882"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2883">X</span></span></span><script type="math/tex" id="MathJax-Element-410">\boldsymbol X</script></span>. Hầu hết các ứng dụng của mã hóa thưa cũng sử dụng suy giảm trọng số hoặc một ràng buộc về các chuẩn của các cột của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2884"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2885">W</span></span></span><script type="math/tex" id="MathJax-Element-411">\boldsymbol W</script></span>, để tránh việc kết quả thu được có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2886"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2887">H</span></span></span><script type="math/tex" id="MathJax-Element-412">\boldsymbol H</script></span> cực nhỏ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2888"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2889">W</span></span></span><script type="math/tex" id="MathJax-Element-413">\boldsymbol{W}</script></span> cực lớn.</p><p>Hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891">J</span></span></span><script type="math/tex" id="MathJax-Element-414">J</script></span> là không lồi. Tuy nhiên, ta có thể chia đầu vào của thuật toán huấn luyện thành hai tập: các tham số từ điển <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2892"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2893">W</span></span></span><script type="math/tex" id="MathJax-Element-415">\boldsymbol W</script></span> và các biểu diễn mã hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2894"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2895">H</span></span></span><script type="math/tex" id="MathJax-Element-416">\boldsymbol H</script></span>. Cực tiểu hóa hàm mục tiêu đối với một trong hai tập biến này là một bài toán tối ưu lồi. Do đó, trượt tọa độ theo khối dẫn đến một chiến lược tối ưu hóa cho phép ta sử dụng các thuật toán tối ưu hóa lồi hiệu quả, đó là xen kẽ việc tối ưu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2896"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2897">W</span></span></span><script type="math/tex" id="MathJax-Element-417">\boldsymbol W</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2898"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2899">H</span></span></span><script type="math/tex" id="MathJax-Element-418">\boldsymbol H</script></span> cố định, sau đó tối ưu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2901">H</span></span></span><script type="math/tex" id="MathJax-Element-419">\boldsymbol H</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2902"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2903">W</span></span></span><script type="math/tex" id="MathJax-Element-420">\boldsymbol W</script></span> cố định.</p><p>Trượt theo tọa độ cũng không phải là một chiến lược tối ưu nếu giá trị của một biến ảnh hưởng mạnh đến giá trị tối ưu của biến khác, chẳng hạn như trong hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2905">f</span><span class="MJXp-mo" id="MJXp-Span-2906" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907">x</span><span class="MJXp-mo" id="MJXp-Span-2908" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2909" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2910" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2913" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2914">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2915" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2918" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2919"><span class="MJXp-mo" id="MJXp-Span-2920" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2921" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2922" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923">α</span><span class="MJXp-mo" id="MJXp-Span-2924" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2928">1</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2927">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2929" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2933">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2932">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2934" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-421">f(x) = (x_{1} − x_2)^2+ \alpha(x_2^1 + x_1^2)</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">α</span></span></span><script type="math/tex" id="MathJax-Element-422">\alpha</script></span> là một hằng số dương. Số hạng đầu tiên khuyến khích hai biến có giá trị tương đương, trong khi số hạng thứ hai khuyến khích chúng có giá trị gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2937"><span class="MJXp-mn" id="MJXp-Span-2938">0</span></span></span><script type="math/tex" id="MathJax-Element-423">0</script></span>. Như vậy, giải pháp của bài toán này là thiết lập cả hai bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2939"><span class="MJXp-mn" id="MJXp-Span-2940">0</span></span></span><script type="math/tex" id="MathJax-Element-424">0</script></span>. Phương pháp Newton có thể giải quyết bài toán trong một bước duy nhất, vì nó là một bài toán bậc hai xác định dương. Tuy nhiên, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942">α</span></span></span><script type="math/tex" id="MathJax-Element-425">\alpha</script></span> nhỏ, trượt theo tọa độ sẽ tiến triển rất chậm bởi số hạng đầu tiên không cho phép một biến thay đổi thành một giá trị khác biệt đáng kể với giá trị hiện tại của biến còn lại.</p><h2 id="873-Trung-bình-Polyak">8.7.3 Trung bình Polyak</h2><p>Trung bình Polyak [Polyak and Juditsky, 1992] thực hiện việc lấy trung bình một số điểm trong quỹ đạo thông qua không gian tham số mà một thuật toán tối ưu hóa đi qua. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">t</span></span></span><script type="math/tex" id="MathJax-Element-426">t</script></span> vòng lặp của thuật toán trượt gradient đi qua các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946">θ</span><span class="MJXp-mo" id="MJXp-Span-2947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2948">1</span><span class="MJXp-mo" id="MJXp-Span-2949" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2950" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2951" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2952" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953">θ</span><span class="MJXp-mo" id="MJXp-Span-2954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955">t</span><span class="MJXp-mo" id="MJXp-Span-2956" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-427">\theta(1),\dots, \theta(t)</script></span>, thì đầu ra của thuật toán trung bình Polyak là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2957"><span class="MJXp-msubsup" id="MJXp-Span-2958"><span class="MJXp-mrow" id="MJXp-Span-2959" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2960"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2962" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961">θ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2963" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2964">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">t</span><span class="MJXp-mo" id="MJXp-Span-2966">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2968" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2969">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2970">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2971"><span class="MJXp-mo" id="MJXp-Span-2972" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2973" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-2974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2976" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2977">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978">i</span><span class="MJXp-mo" id="MJXp-Span-2979">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-428">\hat{\theta}^{(t)} = \frac{1}{2}\sum_i\theta^{(i)}</script></span>. Trong một số lớp bài toán, chẳng hạn như trượt gradient áp dụng trong các bài toán lồi, cách tiếp cận này gần như chắc chắn sẽ đạt được sự hội tụ. Khi áp dụng cho các mạng neuron, cách giải thích hoạt động của nó dựa trên kinh nghiệm là chính, nhưng nó vẫn hoạt động tốt trong thực tế. Ý tưởng cơ bản là thuật toán tối ưu hóa có thể nhảy tới lui qua một thung lũng nhiều lần mà không bao giờ đạt đến một điểm gần đáy của thung lũng. Mặc dù vậy, trung bình của toàn bộ vị trí ở hai bên có lẽ gần với đáy của thung lũng.</p><p>Trong các bài toán không lồi, quỹ đạo của thuật toán tối ưu có thể rất phức tạp và đi qua nhiều vùng khác nhau. Việc lấy cả những điểm trong không gian tham số từ quá khứ rất xa có thể bị chia cách rất lớn so với điểm hiện tại tính bằng giá trị hàm chi phí có vẻ không mang lại hiệu quả. Do đó, khi áp dụng trung bình Polyak cho các bài toán không lồi, ta thường sử dụng một trung bình suy giảm theo cấp số nhân:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2980"><span class="MJXp-mtable" id="MJXp-Span-2981"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2982" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2983" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2984"><span class="MJXp-mrow" id="MJXp-Span-2985" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2986"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2988" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2987">θ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2989" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2990">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2991">t</span><span class="MJXp-mo" id="MJXp-Span-2992">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2993" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">α</span><span class="MJXp-msubsup" id="MJXp-Span-2995"><span class="MJXp-mrow" id="MJXp-Span-2996" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2997"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2999" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2998">θ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3000" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-3001">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002">t</span><span class="MJXp-mo" id="MJXp-Span-3003">−</span><span class="MJXp-mn" id="MJXp-Span-3004">1</span><span class="MJXp-mo" id="MJXp-Span-3005">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3006" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3008">1</span><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010">α</span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3012"><span class="MJXp-mrow" id="MJXp-Span-3013" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3014"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3015">θ</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3017" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-3018">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019">t</span><span class="MJXp-mo" id="MJXp-Span-3020">−</span><span class="MJXp-mn" id="MJXp-Span-3021">1</span><span class="MJXp-mo" id="MJXp-Span-3022">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3023" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-429">\hat{\boldsymbol \theta}^{(t)} = \alpha\hat{\boldsymbol \theta}^{(t-1)} + (1-\alpha)\hat{\boldsymbol \theta}^{(t-1)}. \tag{8.39}</script></span></p><p>Hướng tiếp cần này được dùng trong nhiều ứng dụng. Tham khảo ví dụ gần đây tong công trình của Szegedy và cộng sự. (2015).</p><h2 id="874-Tiền-huấn-luyện-có-giám-sát">8.7.4 Tiền huấn luyện có giám sát</h2><p>Đôi khi, viếc trực tiếp huấn luyện một mô hình để giải quyết một tác vụ cụ thể có thể là rất khó khăn nếu mô hình quá phức tạp và khó tối ưu, hoặc nếu tác vụ có độ khó cao. Đôi khi, một giải pháp hiệu quả là huấn luyện một mô hình đơn giản hơn để giải quyết tác vụ, sau đó làm cho mô hình trở nên phức tạp dần. Hoặc là huấn luyện mô hình để giải quyết một tác vụ đơn giản hơn, sau đó chuyển sang giải quyết tác vụ cuối cùng. Những chiến lược này bao gồm việc huấn luyện các mô hình đơn giản để giải quyết các tác vụ đơn giản, trước khi huấn luyện mô hình thực sự để giải quyết tác vụ thực sự được gọi chung là <em>tiền huấn luyện</em> (pretraining).</p><p>Các <em>thuật toán tham lam</em> (greedy algorithm) chia nhỏ một bài toán thành nhiều thành phần, sau đó tìm lời giải tối ưu cho mỗi phần một cách cô lập. Thật không may, việc kết hợp các thành phần tối ưu riêng lẻ không đảm bảo sẽ mang lại một giải pháp tối ưu tổng thể. Tuy nhiên, thuật toán tham lam có thể mang lại thuận lợi về mặt tính toán hơn nhiều so với các thuật toán tìm giải pháp tối ưu cho toàn bộ bài toán cùng lúc, và chất lượng của thuật toán tham lam nếu không phải là tối ưu thì cũng thường là chấp nhận được. Sau thuật toán tham lam ta có thể áp dụng một giai đoạn <em>tinh chỉnh</em> (fine-tuning) trong đó ta áp dụng một thuật toán tối ưu hóa chung để tìm kiếm một giải pháp tối ưu cho toàn bộ bài toán. Khởi tạo thuật toán tối ưu hóa chung với một bộ tham số từ thuật toán tham lam có thể đẩy nhanh tốc độ và cải thiện chất lượng của lời giải nó tìm ra.</p><p>Các thuật toán tiền huấn luyện, đặc biệt là tiền huấn luyện tham lam, được sử dụng rất phổ biến trong học sâu. Trong phần này, chúng tôi mô tả cụ thể các thuật toán tiền huấn luyện chia nhỏ bài toán học có giám sát thành các bài toán học có giám sát đơn giản hơn. Cách tiếp cận này được biết đến với tên gọi <em>tiền huấn luyện tham lam có giám sát</em> (greedy supervised pretraining).</p><p>Trong phiên bản đầu tiên [Bengio et al., 2007] của tiền huấn luyện tham lam có giám sát, mỗi giai đoạn bao gồm một tác vụ huấn luyện học có giám sát chỉ liên quan tới một tập con các tầng trong mạng neuron. Một ví dụ về tiền huấn luyện tham lam có giám sát được minh họa trong hình 8.7, trong đó mỗi tầng ẩn thêm vào được tiền huấn luyện như là một phần của một mạng perceptron đa tầng có giám sát với số tầng nhỏ, lấy đầu vào là đầu ra của tầng được huấn luyện trước đó. Thay vì tiền huấn luyện một tầng tại mỗi thời điểm, Simonyan và Zisserman (2015) tiền huấn luyện một mạng tích chập đa tầng (với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3024"><span class="MJXp-mn" id="MJXp-Span-3025">11</span></span></span><script type="math/tex" id="MathJax-Element-430">11</script></span> tầng trọng số), sau đó sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3026"><span class="MJXp-mn" id="MJXp-Span-3027">4</span></span></span><script type="math/tex" id="MathJax-Element-431">4</script></span> tầng đầu tiên và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3028"><span class="MJXp-mn" id="MJXp-Span-3029">3</span></span></span><script type="math/tex" id="MathJax-Element-432">3</script></span> tầng cuối cùng từ mạng này để khởi tạo các mạng thậm chí sâu hơn nữa (lên đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3030"><span class="MJXp-mn" id="MJXp-Span-3031">19</span></span></span><script type="math/tex" id="MathJax-Element-433">19</script></span> tầng trọng số). Các tầng ở giữa của mạng mới được khởi tạo ngẫu nhiên. Mạng mới sau đó được huấn luyện chung. Một lựa chọn khác được khám phá bởi Yu và cộng sự (2010) là sử dụng các kết quả đầu ra của các mạng perceptron đa tầng trước đó, cũng như đầu vào ban đầu, làm đầu vào cho mỗi giai đoạn được thêm vào.</p><p><img src="https://i.imgur.com/oqOuFIU.png" alt=""></p><blockquote>
<p>Hình 8.7: Minh họa một dạng tiền huấn luyện tham lam có giám sát. (<em>a</em>) Chúng tôi bắt đầu bằng cách huấn luyện một kiến trúc với số tầng nhỏ. (<em>b</em>) Một cách thể hiện khác của kiến trúc vừa rồi. (<em>c</em>) Chúng tôi chỉ giữ nguyên đầu-vào-tới-tầng-ẩn của mạng ban đầu và loại bỏ tầng-ẩn-tới-đầu-ra. Chúng tôi đưa đầu ra của tầng ẩn đầu tiên làm đầu vào của một tầng ẩn của mạng perceptron đa tầng có giám sát khác, được huấn luyện với cùng hàm mục tiêu như mạng ban đầu, do đó thêm được một tầng ẩn thứ hai. Quá trình này có thể được lặp lại với số tầng tuỳ ý. (<em>d</em>) Một cách vẽ khác của kết quả trên, nhìn giống như một mạng lan truyền thuận. Để cải thiện khả năng tối ưu hóa hơn nữa, ta có thể cùng lúc tinh chỉnh toàn bộ các tầng, hoặc chỉ ở cuối hoặc ở mỗi giai đoạn của quá trình này.</p>
</blockquote><p>Tại sao tiền huấn luyện tham lam có giám sát sẽ hữu ích? Giả thuyết ban đầu được thảo luận bởi Bengio và cộng sự (2007) là nó giúp cung cấp các chỉ dẫn tốt hơn cho các cấp độ trung gian của một hệ thống phân cấp đa tầng. Nói chung, tiền huấn luyện có thể hữu ích với cả tối ưu hóa và tổng quát hóa.</p><p>------------------------<br>
Bùi Kim Thành Sơn kết thúc dịch từ đây Trang 316 - 320<br>
------------------------</p><p>------------------------<br>
Lại Minh Duy bắt đầu dịch từ đây - Trang 321 - 325:<br>
------------------------</p><p>Một cách tiếp cận khác liên quan đến tiền huấn luyện có giám sát mở rộng ý tưởng cho <em>học chuyển tiếp</em> (transfer learning): Yosinski và cộng sự (2014) tiền huấn luyện một mạng tích chập đa tầng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3032"><span class="MJXp-mn" id="MJXp-Span-3033">8</span></span></span><script type="math/tex" id="MathJax-Element-434">8</script></span> tầng trọng số trên một tập tác vụ (một tập con trong số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3034"><span class="MJXp-mn" id="MJXp-Span-3035">1</span><span class="MJXp-mo" id="MJXp-Span-3036" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3037">000</span></span></span><script type="math/tex" id="MathJax-Element-435">1,000</script></span> nhóm vật thể trên tập dữ liệu ImageNet) và sau đó khởi tạo một mạng có cùng kích thước với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039">k</span></span></span><script type="math/tex" id="MathJax-Element-436">k</script></span> tầng đầu tiên của mạng đầu tiên. Tất cả các tầng của mạng thứ hai (với các tầng phía trên được khởi tạo ngẫu nhiên) sau đó được huấn luyện chung để thực hiện một tập các tác vụ khác nhau (một tập hợp con khác của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3040"><span class="MJXp-mn" id="MJXp-Span-3041">1</span><span class="MJXp-mo" id="MJXp-Span-3042" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3043">000</span></span></span><script type="math/tex" id="MathJax-Element-437">1,000</script></span> loại vật thể trên tập dữ liệu ImageNet), với số mẫu huấn luyện ít hơn so với tập tác vụ đầu tiên. Các hướng tiếp cận học chuyển tiếp khác sử dụng mạng neuron được thảo luận trong phần 15.2.</p><p>Một hướng liên quan khác là cách tiếp cận <em>FitNets</em> [Romero et al., 2015]. Bắt đầu bằng việc huấn luyện một mạng có độ sâu đủ nhỏ và độ rộng đủ lớn để dễ huấn luyện. Mạng này sau đó trở thành một <em>giáo viên</em> cho một mạng thứ hai, được coi như <em>học viên</em>. Mạng học viên sẽ sâu và hẹp hơn nhiều (có thể có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3044"><span class="MJXp-mn" id="MJXp-Span-3045">11</span></span></span><script type="math/tex" id="MathJax-Element-438">11</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-mn" id="MJXp-Span-3047">19</span></span></span><script type="math/tex" id="MathJax-Element-439">19</script></span> tầng) và trở nên khó huấn luyện với trượt gradient ngẫu nhiên trong điều kiện thông thường. Việc huấn luyện mạng học viên được thực hiện dễ dàng hơn bằng cách huấn luyện chúng để không chỉ để dự đoán đầu ra cho tác vụ ban đầu, mà còn để dự đoán giá trị tầng trung gian của mạng giáo viên. Nhiệm vụ bổ sung này cung cấp một tập hợp các gợi ý về cách sử dụng các tầng ẩn và có thể giúp đơn giản hóa bài toán tối ưu. Các tham số bổ sung được đưa vào để hồi quy tầng trung gian của mạng giáo viên có 5 tầng, từ tầng trung gian trong mạng học viên. Tuy nhiên, thay vì dự đoán nhãn phân lớp cuối cùng, mục tiêu bây giờ là dự đoán tầng ẩn trung gian của mạng giáo viên. Các tầng dưới của mạng học viên do đó có hai mục tiêu: để giúp các đầu ra của mạng học viên hoàn thành tác vụ của chúng, cũng như để dự đoán tầng trung gian của mạng giáo viên. Mặc dù một mạng mỏng và sâu có vẻ như khó để huấn luyện hơn một mạng rộng và nông, nhưng chúng lại có khả năng tổng quát hóa tốt hơn và chắc chắn có chi phí tính toán thấp hơn nếu chúng đủ hẹp tới mức số tham số ít hơn hẳn. Nếu không có các gợi ý trên tầng ẩn, mạng học viên hoạt động rất tồi trong thực tế, trên cả tập huấn luyện và kiểm thử. Do đó, gợi ý trên các tầng trung gian có thể là một trong những công cụ để giúp huấn luyện các mạng neuron khó huấn luyện, nhưng các kỹ thuật tối ưu hóa khác hoặc thay đổi kiến trúc mạng cũng có thể giải quyết được vấn đề.</p><h2 id="875-Thiết-kế-mô-hình-để-hỗ-trợ-quá-trình-tối-ưu-hóa">8.7.5 Thiết kế mô hình để hỗ trợ quá trình tối ưu hóa</h2><p>Để cải thiện hiệu suất tối ưu hóa, chiến lược tốt nhất không phải lúc nào cũng là cải thiện thuật toán tối ưu hóa. Thay vào đó, nhiều cải tiến trong hiệu suất tối ưu hóa các mô hình sâu đến từ việc thiết kế các mô hình dễ dàng tối ưu hơn.</p><p>Về nguyên tắc, ta có thể sử dụng các hàm kích hoạt tăng và giảm trong các quy luật không đơn điệu, nhưng điều này sẽ khiến việc tối ưu hóa cực kỳ khó khăn. Trong thực tế, <em>việc chọn một họ mô hình dễ tối ưu quan trọng hơn là sử dụng một thuật toán tối ưu hóa mạnh mẽ</em>. Hầu hết các tiến bộ trong việc học mạng neuron trong ba mươi năm qua thu được bằng cách thay họ đổi mô hình thay vì thay đổi thủ tục tối ưu hóa. Trượt gradient ngẫu nhiên với động lượng, vốn được sử dụng để huấn luyện các mạng neuron trong những năm 1980, vẫn được sử dụng trong các ứng dụng mạng neuron hiện đại có kết quả tốt nhất.</p><p>Cụ thể, các mạng neuron hiện đại phản ánh một <em>lựa chọn thiết kế</em> để sử dụng các phép biến đổi tuyến tính giữa các tầng và các hàm kích hoạt khả vi ở hầu hết mọi nơi, với độ dốc đáng kể trong phần lớn miền xác định của chúng. Đặc biệt, các mô hình cải tiến như LSTM, bộ tuyến tính hiệu chỉnh và bộ cực đại đầu ra đều chuyển sang sử dụng nhiều hàm tuyến tính hơn thay vì các mô hình trước đó như các mạng đa tầng dựa trên các đơn vị dạng chữ S. Các mô hình trên có những thuộc tính tốt giúp việc tối ưu hóa dễ dàng hơn. Gradient truyền qua nhiều tầng với điều kiện là định thức Jacobi của phép biến đổi tuyến tính có các giá trị suy biến hợp lý. Hơn nữa, các hàm tuyến tính luôn tăng theo một hướng duy nhất, vì vậy ngay cả khi đầu ra của mô hình rất thiếu chính xác, thì dựa vào việc tính toán gradient, ta thấy ngay hướng mà đầu ra của nó nên di chuyển để giảm hàm mất mát. Nói cách khác, các mạng neuron hiện đại được thiết kế sao cho thông tin về gradient <em>cục bộ</em> tương ứng khá cao với hướng di chuyển về phía một lời giải ở xa.</p><p>Các chiến lược thiết kế mô hình khác có thể giúp việc tối ưu hóa dễ dàng hơn. Ví dụ, các phương pháp sử dụng các đường dẫn tuyến tính hoặc các kết nối nhảy cóc giữa các tầng làm đường đi ngắn nhất từ các tham số tầng thấp đến đầu ra ngắn lại, và do đó giảm nhẹ vấn đề tiêu biến gradient [Srivastava et al., 2015]. Một ý tưởng liên quan đến các kết nối nhảy cóc là thêm các bản sao bổ sung của đầu ra để gắn vào các tầng ẩn trung gian của mạng, như trong GoogLeNet [zegedy et al., 2014a] và các mạng có giám sát chặt chẽ [Lee et al., 2014]. Các “đầu bổ trợ” này được huấn luyện để thực hiện cùng tác vụ tương tự như đầu ra chính ở trên đỉnh của mạng giúp đảm bảo rằng các tầng thấp hơn nhận được một gradient lớn. Khi hoàn thành huấn luyện, các đầu bổ trợ có thể bị loại bỏ. Đây là một giải pháp thay thế cho các chiến lược tiền huấn luyện, được giới thiệu trong phần trước. Theo cách này, người ta có thể huấn luyện cùng lúc tất cả các tầng trong một giai đoạn duy nhất nhưng thay đổi kiến trúc, để các tầng trung gian (đặc biệt là các tầng thấp hơn) có thể nhận được một số gợi ý về những gì chúng nên làm, thông qua một con đường ngắn hơn. Những gợi ý này cung cấp một tín hiệu về sai số cho các tầng thấp hơn.</p><h2 id="876-Các-phương-pháp-mịn-dần-và-học-theo-giáo-trình">8.7.6 Các phương pháp mịn dần và học theo giáo trình</h2><p>Như đã đề cập trong phần 8.2.7, nhiều thách thức trong tối ưu hóa phát sinh từ cấu trúc toàn cục của hàm chi phí và không thể được giải quyết chỉ bằng cách đưa ra các ước lượng tốt hơn về các hướng cập nhật cục bộ. Chiến lược chủ yếu để khắc phục vấn đề này là cố gắng khởi tạo các tham số trong một miền được liên thông với lời giải bằng một đường dẫn ngắn thông qua không gian tham số mà thuật toán trượt cục bộ có thể phát hiện ra.</p><p><em>Các phương pháp mịn dần</em> (continuation methods) là một họ các chiến lược có thể giúp tối ưu hóa dễ dàng hơn bằng cách chọn các điểm khởi tạo để đảm bảo rằng quá trình tối ưu hóa cục bộ dành phần lớn thời gian của nó trong các vùng không gian hoạt động tốt. Ý tưởng đằng sau các phương pháp mịn dần là xây dựng một loạt các hàm mục tiêu trên cùng một bộ tham số. Để cực tiểu hóa hàm chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049">J</span><span class="MJXp-mo" id="MJXp-Span-3050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3051">θ</span><span class="MJXp-mo" id="MJXp-Span-3052" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-440">J(\boldsymbol\theta)</script></span>, chúng ta xây dựng các hàm chi phí mới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3053"><span class="MJXp-mo" id="MJXp-Span-3054" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-3055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3056" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3057" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3058">(</span><span class="MJXp-mn" id="MJXp-Span-3059">0</span><span class="MJXp-mo" id="MJXp-Span-3060">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3061" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3063" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3066" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3067">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3068">n</span><span class="MJXp-mo" id="MJXp-Span-3069">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-441">\{J^{(0)},\dots , J^{(n)}\}</script></span>. Những hàm chi phí này được thiết kế để ngày càng trở nên phức tạp hơn, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3071"><span class="MJXp-msubsup" id="MJXp-Span-3072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3073" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3074" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3075">(</span><span class="MJXp-mn" id="MJXp-Span-3076">0</span><span class="MJXp-mo" id="MJXp-Span-3077">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-442">J^{(0)}</script></span> khá dễ tối ưu và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3078"><span class="MJXp-msubsup" id="MJXp-Span-3079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3081" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3082">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">n</span><span class="MJXp-mo" id="MJXp-Span-3084">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-443">J^{(n)}</script></span> khó tối ưu nhất và cũng là hàm chi phí thực sự thúc đẩy toàn bộ quá trình. Khi ta nói rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3085"><span class="MJXp-msubsup" id="MJXp-Span-3086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3087" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3088" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3089">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090">i</span><span class="MJXp-mo" id="MJXp-Span-3091">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-444">J^{(i)}</script></span> đơn giản hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3092"><span class="MJXp-msubsup" id="MJXp-Span-3093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3095" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3096">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097">i</span><span class="MJXp-mo" id="MJXp-Span-3098">+</span><span class="MJXp-mn" id="MJXp-Span-3099">1</span><span class="MJXp-mo" id="MJXp-Span-3100">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-445">J^{(i + 1)}</script></span>, ý ta nói nó có hành vi tốt hơn trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3102">θ</span></span></span><script type="math/tex" id="MathJax-Element-446">\boldsymbol\theta</script></span> lớn hơn. Một khởi tạo ngẫu nhiên có nhiều khả năng xảy ra trong miền giá trị nơi mà thuật toán trượt dốc cục bộ có thể cực tiểu hóa thành công hàm chi phí hơn bởi vì miền tham số này lớn hơn. Chuỗi hàm chi phí được thiết kế sao cho một kết quả tối ưu của một hàm là một điểm khởi tạo tốt cho hàm tiếp theo. Do đó, chúng ta bắt đầu bằng cách giải quyết một bài toán đơn giản, sau đó cải thiện lại lời giải để giải quyết các bài toán phức tạp hơn cho đến khi chúng ta có lời giải cho bài toán thực sự.</p><p>Các phương pháp mịn dần truyền thống (trước khi sử dụng cho huấn luyện mạng neuron) thường dựa trên việc làm mịn hàm mục tiêu. Xem  ví dụ một phương pháp như vậy trong [Wu (1997)] cũng như để điểm lại một số phương pháp liên quan. Các phương pháp mịn dần cũng liên quan chặt chẽ đến tôi luyện mô phỏng (simulated annealing), chúng thêm nhiễu vào các tham số [Kirkpatrick et al., 1983]. Phương pháp mịn dần đang cực kỳ thành công trong những năm gần đây. Xem [Mobahi and Fisher (2015)] để có một cái nhìn tổng quan về các tài liệu gần đây, đặc biệt là trong các ứng dụng trí tuệ nhân tạo.</p><p>Phương pháp mịn dần truyền thống chủ yếu được thiết kế với mục tiêu vượt qua thách thức do các cực tiểu cục bộ. Cụ thể, chúng được thiết kế để đạt đến cực tiểu toàn cục bất chấp sự hiện diện của nhiều cực tiểu cục bộ. Để đạt được điều đó, các phương pháp này sẽ xây dựng các hàm chi phí đơn giản hơn bằng cách “làm mờ” hàm chi phí ban đầu. Thao tác làm mờ này có thể được thực hiện bằng cách xấp xỉ thông qua bước lấy mẫu.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3103"><span class="MJXp-mtable" id="MJXp-Span-3104"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3105" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3106" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3109" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3110">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3111">i</span><span class="MJXp-mo" id="MJXp-Span-3112">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3114">θ</span><span class="MJXp-mo" id="MJXp-Span-3115" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3116" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3117"><span class="MJXp-mrow" id="MJXp-Span-3118" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3119">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3120" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-3121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3123" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3124">∼</span><span class="MJXp-mrow" id="MJXp-Span-3125"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3126">N</span></span><span class="MJXp-mo" id="MJXp-Span-3127">(</span><span class="MJXp-msup" id="MJXp-Span-3128"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3129" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3130" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3131">;</span><span class="MJXp-mtext" id="MJXp-Span-3132">&nbsp;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3133">θ</span><span class="MJXp-mo" id="MJXp-Span-3134">,</span><span class="MJXp-msubsup" id="MJXp-Span-3135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3136" style="margin-right: 0.05em;">σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3137" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3138">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3139">i</span><span class="MJXp-mo" id="MJXp-Span-3140">)</span><span class="MJXp-mn" id="MJXp-Span-3141">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3142">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">J</span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-3145"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3146" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3147" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3148" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-447"> J^{(i)}(\boldsymbol\theta) = \mathbb{E}_{\theta'\sim \mathcal{N}(\boldsymbol\theta';\space\boldsymbol\theta,\sigma^{(i)2} )}J(\boldsymbol\theta') \tag{8.40}</script></span></p><p>Ý tưởng cho cách tiếp cận này là một số hàm không lồi trở thành gần như lồi khi bị làm mờ. Trong nhiều trường hợp, việc làm mờ này bảo toàn thông tin về vị trí của cực tiểu toàn cục mà chúng ta có thể tìm bằng cách giải quyết theo trình tự các phiên bản ít bị mờ hơn của bài toán. Hướng tiếp cận này có thể thất bại theo ba các khác nhau. Đầu tiên, nó có thể xác định thành công một chuỗi các hàm chi phí, trong đó hàm đầu tiên là lồi và tiếp theo là các đường đi tối ưu từ một hàm đến hàm kế tiếp, cho đến điểm cực tiểu toàn cục, nhưng nó có thể yêu cầu rất nhiều hàm chi phí gia tăng mà chi phí của toàn bộ thủ tục vẫn cao. Các bài toán tối ưu NP-hard vẫn thuộc lớp bài toán NP-hard, ngay cả khi các phương pháp mịn dần được áp dụng. Hai kiểu thất bại khác đều dẫn tới phương pháp không được áp dụng. Thứ nhất, hàm có thể không trở nên lồi, cho dù nó được làm mờ bao nhiêu đi nữa. Chẳng hạn, hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150">J</span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3152">θ</span><span class="MJXp-mo" id="MJXp-Span-3153" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3154" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3155" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3156"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3157" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3158" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3159">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3160">θ</span></span></span><script type="math/tex" id="MathJax-Element-448">J(\boldsymbol\theta)=-\boldsymbol\theta^{\intercal} \boldsymbol\theta</script></span> có tính chất đó. Thứ hai, hàm có thể trở thành lồi do kết quả từ việc làm mờ, nhưng cực tiểu của hàm mờ này có thể lần theo cực tiểu cục bộ thay vì cực tiểu toàn cục của hàm chi phí ban đầu.</p><p>Mặc dù các phương pháp mịn dần ban đầu được thiết kế chủ yếu để giải quyết vấn đề đến từ các cực tiểu cục bộ, đây không còn được cho là vấn đề chính trong tối ưu hóa mạng neuron. May mắn thay, các phương pháp mịn dần có thể vẫn mang lại lợi ích. Các hàm mục tiêu đơn giản hơn tạo bởi phương pháp mịn dần có thể loại bỏ các vùng phẳng, giảm phương sai trong các ước lượng gradient, cải thiện tính điều hoà của ma trận Hesse, hoặc làm bất cứ điều gì để khiến việc tính toán các cập nhật cục bộ dễ dàng hơn hoặc cải thiện sự liên đới giữa các hướng cập nhật cục bộ và tiến tới một giải pháp toàn cục.</p><p>Bengio và cộng sự (2009) đã xem xét một cách tiếp cận gọi là <em>học theo giáo trình</em> (curriculum learning), hoặc <em>tạo khuôn</em> (shaping), có thể được hiểu như là một phương pháp mịn dần. Việc học theo giáo trình dựa trên ý tưởng lập kế hoạch cho một quá trình học tập bắt đầu bằng cách học các khái niệm đơn giản và trở nên tiến bộ để học các khái niệm phức tạp hơn dựa vào các khái niệm đơn giản được học trước đó. Chiến lược cơ bản này trước đây được biết đến như là phương pháp thúc đẩy tiến bộ trong huấn luyện động vật [Skinner, 1958; Peterson, 2004; Krueger and Dayan, 2009] và trong học máy [Solomonoff, 1989; Elman, 1993; Sanger, 1994]. Bengio và cộng sự (2009) đã diễn giải chiến lược này như là một phương pháp mịn dần, khi mà hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3161"><span class="MJXp-msubsup" id="MJXp-Span-3162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3163" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3164" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3165">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">i</span><span class="MJXp-mo" id="MJXp-Span-3167">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-449">J^{(i)}</script></span> xuất hiện sớm hơn được làm cho đơn giản hơn bằng cách tăng cường tác động của các ví dụ đơn giản hơn (bằng cách gán cho đóng góp của chúng đối với hàm chi phí bởi các hệ số lớn hơn, hoặc bằng cách lấy mẫu chúng thường xuyên hơn), và đã chứng minh bằng thực nghiệm rằng ta có thể thu được kết quả tốt hơn bằng cách học theo giáo trình đối với một tác vụ mô hình hóa ngôn ngữ neuron quy mô lớn. Học theo giáo trình đã đạt được thành công rộng rãi với nhiều tác vụ xử lý ngôn ngữ tự nhiên [Spitkovsky et al., 2010;Collobert et al., 2011a; Mikolov et al., 2011b; Tu and Honavar, 2011] và thị giác máy tính [Kumar et al., 2010; Lee and Grauman, 2011; Supancic and Ramanan, 2013]. Học theo giáo trình cũng được xác nhận là phù hợp với cách thức mà con người giảng dạy (Khan et al., 2011): các giáo viên ban đầu cho các ví dụ đơn giản và căn bản, sau đó giúp người học xác định hướng quyết định với các trường hợp trừu tượng hơn. Các chiến lược dựa trên giáo trình <em>hiệu quả hơn</em> trong giảng dạy cho con người hơn các chiến lược lấy mẫu các ví dụ một cách đồng đều, và cũng có thể làm tăng tính hiệu quả của các chiến lược giảng dạy khác [Basu và Christensen, 2013].</p><p>Một đóng góp quan trọng khác cho việc nghiên cứu về học theo giáo trình phát sinh trong bối cảnh huấn luyện các mạng neuron truy hồi để nắm bắt các phụ thuộc dài hạn: Zaremba và Sutskever (2014) đã thu được kết quả tốt hơn nhiều với một <em>giáo trình ngẫu nhiên</em>, trong đó một sự pha trộn ngẫu nhiên các ví dụ dễ và khó luôn được trình bày cho người học, nhưng tỷ lệ trung bình của các ví dụ phức tạp hơn (ở đây là những phụ thuộc xa hơn) tăng dần. Với một giáo trình xác định, ta không quan sát được cải tiến nào so với phương pháp cơ sở (huấn luyện thông thường từ toàn bộ tập huấn luyện).</p><p>Đến đây, chúng tôi đã mô tả về họ cơ bản của các mô hình mạng neuron và các cơ chế kiểm soát cũng như tối ưu hóa chúng. Trong các chương tiếp theo, chúng tôi chuyển sang các họ mạng neuron được chuyên môn hóa hơn, cho phép các mạng neuron mở rộng với kích thước rất lớn và xử lý dữ liệu đầu vào có cấu trúc đặc biệt. Các phương pháp tối ưu được thảo luận trong chương này thường được áp dụng trực tiếp cho các kiến trúc đặc biệt trên với một chút hoặc không cần điều chỉnh.</p><p>------------------------<br>
Lại Minh Duy kết thúc dịch ở đây<br>
------------------------</p><p>-------- LA đã review đến đây ----------<br>
-------- Xuan Tu đã review đến đây ------<br>
-------------- Hung Le ------------</p></div>