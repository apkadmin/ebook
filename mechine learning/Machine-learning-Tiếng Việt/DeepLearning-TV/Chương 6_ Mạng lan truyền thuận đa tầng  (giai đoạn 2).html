<div id="doc" class="markdown-body container-fluid comment-enabled"><p>— ORIGINAL—<br>
<a href="https://hackmd.io/uQbuIOPXSsa4-M37u1SUzw" target="_blank" rel="noopener">https://hackmd.io/uQbuIOPXSsa4-M37u1SUzw</a><br>
— REVISION—<br>
Duong NGUYEN đã xem lại công thức<br>
Soan Duong revised công thức lần 2</p><p>TO-DO:</p><ol>
<li>Đổi thao tác (dịch cho operation) sang phép toán</li>
</ol><h1 id="Chương-6-Mạng-lan-truyền-thuận-đa-tầng-giai-đoạn-2">Chương 6: Mạng lan truyền thuận đa tầng  (giai đoạn 2)</h1><p>//------- Phạm Đình Khánh bắt đầu sửa ở đây----------------------------------------------<br>
// ------ Sơn Lâm bắt đầu dịch ở đây p193 - p197</p><h1 id="64-Thiết-kế-kiến-trúc">6.4 Thiết kế kiến trúc</h1><p>Một yếu tố thiết kế then chốt khác trong mạng neuron là xác định kiến trúc của mạng. Từ <em>kiến trúc</em> (architectiure) đề cập đến cấu trúc tổng thể của mạng: mạng đó cần bao nhiêu đơn vị và các đơn vị này sẽ kết nối với nhau như thế nào.</p><p>Phần lớn các mạng neuron được tổ chức theo các nhóm đơn vị, hay còn được gọi là các <em>tầng</em> (layer). Phần lớn các kiến trúc mạng neuron xếp những tầng này thành một cấu trúc dạng chuỗi, với mỗi tầng là một hàm số của tầng liền trước nó. Trong cấu trúc này, tầng đầu tiên được định nghĩa như sau</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtable" id="MJXp-Span-2"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-7" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-8">(</span><span class="MJXp-mn" id="MJXp-Span-9">1</span><span class="MJXp-mo" id="MJXp-Span-10">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-14" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-15">(</span><span class="MJXp-mn" id="MJXp-Span-16">1</span><span class="MJXp-mo" id="MJXp-Span-17">)</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-18"><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-23" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-24">(</span><span class="MJXp-mn" id="MJXp-Span-25">1</span><span class="MJXp-mo" id="MJXp-Span-26">)</span><span class="MJXp-mi" id="MJXp-Span-27">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-28">x</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-32" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-33">(</span><span class="MJXp-mn" id="MJXp-Span-34">1</span><span class="MJXp-mo" id="MJXp-Span-35">)</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-36"><span class="MJXp-mrow" id="MJXp-Span-37"><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0.222em;">;</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="min-width: 18.86em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.86em;"><span style="display: inline-block; position: absolute; width: 12.126em; height: 0px; clip: rect(-1.29em, 1012.07em, 0.811em, -999.997em); top: 0em; left: 50%; margin-left: -6.086em;"><span style="position: absolute; clip: rect(2.697em, 1012.07em, 4.798em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.126em; height: 0px;"><span style="position: absolute; clip: rect(2.697em, 1012.07em, 4.798em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-bold-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mo" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="mo" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mo" id="MathJax-Span-28" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 2.804em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.19em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.296em;"><span class="texatom" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mo" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-39" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-bold-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mo" id="MathJax-Span-50" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">;</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.913em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-6.40"><span class="mrow" id="MathJax-Span-5"><span class="mtext" id="MathJax-Span-6" style="font-family: MathJax_Main;">(6.40)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{align}
    \boldsymbol{h}^{(1)} = g^{(1)}\Big(\boldsymbol{W}^{(1)\top}\boldsymbol{x} + \boldsymbol{b}^{(1)}\Big);
    \tag{6.40}
\end{align}</script></span><br>
và tầng thứ hai sẽ là<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-40"><span class="MJXp-mtable" id="MJXp-Span-41"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-42" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-43" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-44"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-45" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-46" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-47">(</span><span class="MJXp-mn" id="MJXp-Span-48">2</span><span class="MJXp-mo" id="MJXp-Span-49">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-53" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-54">(</span><span class="MJXp-mn" id="MJXp-Span-55">2</span><span class="MJXp-mo" id="MJXp-Span-56">)</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-57"><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-60"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-61" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-62" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-63">(</span><span class="MJXp-mn" id="MJXp-Span-64">2</span><span class="MJXp-mo" id="MJXp-Span-65">)</span><span class="MJXp-mi" id="MJXp-Span-66">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-69" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-70">(</span><span class="MJXp-mn" id="MJXp-Span-71">1</span><span class="MJXp-mo" id="MJXp-Span-72">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-76" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-77">(</span><span class="MJXp-mn" id="MJXp-Span-78">2</span><span class="MJXp-mo" id="MJXp-Span-79">)</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-80"><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0.222em;">;</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-53"><span class="mtable" id="MathJax-Span-54" style="min-width: 19.83em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.83em;"><span style="display: inline-block; position: absolute; width: 13.149em; height: 0px; clip: rect(-1.29em, 1013.04em, 0.811em, -999.997em); top: 0em; left: 50%; margin-left: -6.571em;"><span style="position: absolute; clip: rect(2.697em, 1013.04em, 4.798em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.149em; height: 0px;"><span style="position: absolute; clip: rect(2.697em, 1013.04em, 4.798em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-bold-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mo" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-68" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mo" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mo" id="MathJax-Span-79" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 2.804em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.19em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.296em;"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mo" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-bold-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-90"><span class="mrow" id="MathJax-Span-91"><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-96" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-bold-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mo" id="MathJax-Span-107" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">;</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.913em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-6.41"><span class="mrow" id="MathJax-Span-56"><span class="mtext" id="MathJax-Span-57" style="font-family: MathJax_Main;">(6.41)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\begin{align}
    \boldsymbol{h}^{(2)} = g^{(2)}\Big(\boldsymbol{W}^{(2)\top}\boldsymbol{h}^{(1)} + \boldsymbol{b}^{(2)}\Big);
    \tag{6.41}
\end{align}</script></span></p><p>và cứ như vậy cho đến tầng cuối cùng.</p><p>Trong những kiến trúc có dạng chuỗi như vậy, các vấn đề chính mang tính kiến trúc cần cân nhắc là lựa chọn chiều sâu của mạng và chiều rộng của mỗi tầng. Như sẽ thấy, một mạng chỉ với một tầng ẩn cũng đủ để khớp với tập huấn luyện. Các mạng sâu hơn thường có thể sử dụng số đơn vị trên mỗi tầng và số tham số ít hơn rất nhiều, cũng như thường khái quát hóa tốt cho tập kiểm thử, nhưng chúng lại có xu hướng khó tối ưu hơn. Kiến trúc mạng lý tưởng cho một tác vụ chỉ có thể được tìm thấy thông qua thực nghiệm dựa vào việc quan sát sai số trên tập xác thực.</p><h2 id="641-Tính-xấp-xỉ-phổ-quát-và-độ-sâu">6.4.1 Tính xấp xỉ phổ quát và độ sâu</h2><p>Một mô hình tuyến tính ánh xạ các đặc trưng tới các đầu ra thông qua phép nhân ma trận, theo như định nghĩa, chỉ có thể biểu diễn các hàm tuyến tính. Ưu điểm của mô hình này là dễ huấn luyện, bởi quá trình cực tiểu nhiều hàm mất mát có thể quy về bài toán tối ưu lồi khi áp dụng cho các mô hình tuyến tính. Tuy nhiên, không may là các hệ thống của chúng ta lại thường xuyên cần học các hàm phi tuyến.</p><p>— Duong NGUYEN đã xem đến đây —</p><p>Thoạt nhìn, ta thường nghĩ rằng, học một hàm phi tuyến đòi hỏi phải thiết kế một họ mô hình chuyên biệt cho loại hàm phi tuyến mà chúng ta muốn học. May thay, mạng lan truyền thuận đa tầng với các tầng ẩn cung cấp cho ta một bộ khung xấp xỉ phổ quát. Đặc biệt, <em>định lý xấp xỉ phổ quát</em> (universal approximation theorem)[Horniket al., 1989; Cybenko, 1989;] phát biểu rằng, một mạng lan truyền thuận với một tầng đầu ra tuyến tính và ít nhất một tầng ẩn với bất kỳ hàm kích hoạt “ép buộc” nào (như hàm kích hoạt logit chữ S), có khả năng xấp xỉ bất kỳ hàm đo được theo Borel nào từ một không gian hữu hạn chiều tới một không gian hữu hạn chiều khác với sai số khác không cho trước, miễn là mạng đó có đủ số đơn vị ẩn cần thiết. Đạo hàm của mạng lan truyền thuận cũng có thể xấp xỉ khá tốt đạo hàm của các hàm tuỳ ý [Hornik et al., 1990]. Khái niệm “đo được theo Borel” không nằm trong phạm vi của cuốn sách này; bạn đọc chỉ cần chú ý rằng bất kỳ hàm liên tục nào trên một tập con đóng và bị chặn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mrow" id="MJXp-Span-86" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-87">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-88" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-110"><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\mathbb{R}^n</script></span> là đo được theo Borel, và vì vậy chúng đều có thể xấp xỉ được bởi một mạng neuron. Một mạng neuron cũng có thể xấp xỉ mọi hàm ánh xạ từ một không gian rời rạc hữu hạn chiều bất kỳ tới một không gian khác. Trong khi các định lý ban đầu được phát biểu cho các đơn vị kích hoạt bão hoà khi các đối số rất âm hoặc rất dương, thì các định lý xấp xỉ phổ quát đã và đang được chứng minh cho một lớp hàm kích hoạt rộng hơn, bao gồm cả đơn vị tuyến tính hiệu chỉnh được sử dụng phổ biến hiện nay [Leshno et al., 1993].</p><p>Định lý xấp xỉ phổ quát cho ta biết rằng, dù ta đang cố gắng học bất kỳ hàm nào, thì một MLP đủ lớn cũng đều có khả năng biểu diễn hàm đó. Tuy nhiên, không có gì đảm bảo thuật toán huấn luyện có thể học được hàm đó. Ngay cả khi MLP có thể biểu diễn hàm này, việc học có thể thất bại vì hai lý do khác nhau. Thứ nhất, thuật toán tối ưu được sử dụng để huấn luyện có thể không tìm được giá trị của các tham số tương ứng với hàm mong muốn. Thứ hai, thuật toán huấn luyện có thể chọn hàm sai do hiện tượng quá khớp. Nhớ lại ở phần 5.2.1, luật bù trừ cho ta biết rằng không có thuật toán học máy nào tốt hơn tất cả các thuật toán khác. Mạng lan truyền thuận cho ta một hệ thống phổ quát để biểu diễn hàm, theo nghĩa là, với một hàm cho trước, tồn tại một mạng lan truyền thuận xấp xỉ hàm đó. Không tồn tại một thủ tục phổ quát có khả năng quan sát một tập huấn luyện gồm các mẫu cụ thể và chọn ra một hàm có khả năng tổng quát hóa các điểm không có trong tập huấn luyện.</p><p>Theo định lý xấp xỉ phổ quát, tồn tại một mạng đủ lớn có khả năng đạt được bất kỳ độ chính xác nào mà chúng ta mong muốn, nhưng định lý này không nhắc đến mạng đó sẽ lớn cỡ nào. Barron (1993) đã đưa ra một vài cận về kích cỡ cần thiết của một mạng đơn tầng để xấp xỉ một lớp hàm rộng lớn. Không may là, trong trường hợp xấu nhất, số đơn vị ẩn là một hàm mũ (có thể mỗi đơn vị ẩn tương ứng với một cấu hình đầu vào khác nhau). Điều này là dễ thấy nhất trong trường hợp nhị phân: số lượng hàm nhị phần có thể có trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">v</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-92"><span class="MJXp-mrow" id="MJXp-Span-93" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-95">0</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-97">1</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">}</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-99" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-116"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.272em;">∈</span><span class="msubsup" id="MathJax-Span-120" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1002.37em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mrow" id="MathJax-Span-121"><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-123" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">;</span><span class="mn" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.469em; left: 2.427em;"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">v\in\left\{0;1\right\}^n</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mn" id="MJXp-Span-102" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mn" id="MJXp-Span-105" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: 0.5em;">n</span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-129"><span class="msubsup" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mn" id="MathJax-Span-131" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.488em;"><span class="texatom" id="MathJax-Span-132"><span class="mrow" id="MathJax-Span-133"><span class="msubsup" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.38em;"><span class="mi" id="MathJax-Span-136" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">2^{2^n}</script></span>, việc chọn một hàm như vậy yêu cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mn" id="MJXp-Span-109" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-138"><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mn" id="MathJax-Span-140" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.488em;"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">2^n</script></span> bit, và nói chung là yêu cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">O</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mn" id="MJXp-Span-115" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-116" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-146"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mn" id="MathJax-Span-147" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.488em;"><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">O(2^n)</script></span> bậc tự do.</p><p>Tóm lại, một mạng lan truyền thuận với một tầng duy nhất là đủ để biểu diễn bất kỳ hàm nào, nhưng tầng đó có thể có kích thước rất lớn và có thể thất bại trong việc học và tổng quát hoá một cách chính xác. Trong nhiều tình huống, sử dụng các mô hình sâu hơn (nhiều tầng hơn) có thể giảm số lượng đơn vị cần để biểu diễn hàm mong muốn và giảm sai số tổng quát hóa.</p><p>Nhiều họ hàm số có thể được xấp xỉ một cách hiệu quả bởi một kiến trúc với chiều sâu lớn hơn một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">d</script></span> nào đó, nhưng lại cần một mô hình lớn hơn nhiều để làm điều đó khi chiều sâu bị hạn chế thành nhỏ hơn hoặc bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">d</script></span>. Trong nhiều trường hợp, số lượng đơn vị ẩn cần thiết của mô hình nông là một hàm mũ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-157"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">n</script></span>. Những kết quả trên ban đầu được chứng minh không phải cho các mô hình mạng neuron liên tục và khả vi được sử dụng trong học máy. Tuy nhiên, các sau đó chúng đã được mở rộng cho các mô hình liên tục và khả vi. Những kết quả này lần đầu được chứng minh cho các mạch logic [Håstad, 1986]. Các công trình nghiên cứu sau đó đã mở rộng chúng cho các đơn vị có ngưỡng tuyến tính với trọng số không âm [Håstad and Goldmann, 1991; Hajnal et al., 1993], và tiếp theo là cho những mạng với các hàm kích hoạt có giá trị liên tục [Maass, 1992; Maass et al., 1994]. Nhiều mạng neuron hiện đại sử dụng các đơn vị tuyến tính hiệu chỉnh. Leshno và các cộng sự (1993) đã cho thấy các mạng nông với một họ hàm kích hoạt phi đa thức lớn, bao gồm các đơn vị tuyến tính hiệu chỉnh, có tính xấp xỉ phổ quát. Nhưng những kết quả này không giải quyết được các câu hỏi về độ sâu hoặc tính hiệu quả - họ chỉ xác định một mạng hiệu chỉnh đủ lớn có thể diễn tả bất kỳ hàm nào. Montufar và các cộng sự (2014) đã chứng minh rằng các hàm biểu diễn được bằng một mạng hiệu chỉnh sâu (đa tầng) có thể đòi hỏi một số mũ các đơn vị ẩn khi biểu diễn chúng bằng một mạng nông (một tầng ẩn). Nói chính xác hơn, họ đã chứng minh rằng các mạng tuyến tính theo từng đoạn (mà có thể thu được từ các đơn vị hiệu chỉnh phi tuyến tính hoặc đơn vị cực đại đầu ra) có thể biểu diễn các hàm có số vùng là hàm mũ theo chiều sâu của mạng. Hình 6.5 mô tả cách thức một mạng với đơn vị hiệu chỉnh giá trị tuyệt đối tạo ra các ảnh phản chiếu của một hàm áp dụng cho đầu ra của một đơn vị ẩn nào đó, đối với đầu vào của đơn vị ẩn này. Mỗi đơn vị ẩn cụ thể ở đây quy định vị trí thực hiện gấp không gian đầu vào để tạo ra các ảnh phản chiếu (trên cả hai mặt của đơn vị tuyệt đối phi tuyến). Bằng việc tạo ra những thao tác gấp, chúng ta thu được một số lượng lớn các vùng tuyến tính từng đoạn theo hàm mũ, có khả năng nắm bắt được tất cả các loại hình mẫu chính tắc (chẳng hạn như các hình mẫu lặp lại).</p><p><img src="https://i.imgur.com/VNbrfBe.png" alt=""></p><blockquote>
<p>Hình 6.5: Một cách giải thích hình học và trực quan cho lợi thế theo hàm mũ của các mạng hiệu chỉnh sâu hơn do Montufar và các cộng sự (2014) thực hiện. (<em>Bên trái</em>) Một đơn vị hiệu chỉnh giá trị tuyệt đối có cùng đầu ra cho mọi cặp điểm đầu vào đối xứng qua gương. Trục đối xứng của gương là một siêu phẳng được xác định bởi các trọng số và hệ số tự do của đơn vị này. Một hàm tính toán áp dụng cho đầu ra của đơn vị này (mặt biên màu xanh) sẽ cho kết quả là một hình ảnh phản chiếu của một mẫu hình đơn giản hơn qua trục đối xứng đó. (<em>Ở giữa</em>) Hàm có thể thu được bằng cách gấp lại không gian xung quanh trục đối xứng. (<em>Bên phải</em>) Một hình mẫu lặp lại khác thu được bằng cách gập hình mẫu trước đó (bằng một đơn vị phía dưới khác) để thu được mẫu đối xứng khác (ở đây đã lặp lại bốn lần sử dụng hai tầng ẩn). Hình ảnh được vẽ lại dưới sự cho phép của Montufar và các cộng sự (2014).</p>
</blockquote><p>Kết quả chính của Montufar và các cộng sự (2014) nói rằng số trạng thái của các vùng tuyến tính được gấp bởi một mạng hiệu chỉnh sâu với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">d</script></span> đầu vào, độ sâu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">l</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">l</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">l</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">n</script></span> đơn vị trên mỗi tầng ẩn là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-130"><span class="MJXp-mtable" id="MJXp-Span-131"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-132" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-133" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">O</span><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.65em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.6em; margin-left: -0.17em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mrow" id="MJXp-Span-138" style="margin-right: 0.05em;"><span class="MJXp-TeXmathchoice" id="MJXp-Span-139"><span class="MJXp-mstyle" id="MJXp-Span-140"><span class="MJXp-mrow" id="MJXp-Span-141"><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-143"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">d</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-146"><span class="MJXp-mstyle" id="MJXp-Span-147"><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-150" style="vertical-align: 1.15em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">d</span><span class="MJXp-mo" id="MJXp-Span-152">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">l</span><span class="MJXp-mo" id="MJXp-Span-154">−</span><span class="MJXp-mn" id="MJXp-Span-155">1</span><span class="MJXp-mo" id="MJXp-Span-156">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-157" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-160" style="vertical-align: 0.5em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.65em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.6em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">\begin{align}
    O\left(\binom{n}{d}^{d(l-1)}\,n^d\right),
    \tag{6.42}
\end{align}</script></span></p><p>đó là một hàm mũ theo độ sâu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-15">l</script></span>. Trong trường hợp các mạng cực đại đầu raa với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-16-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-16">k</script></span> bộ lọc cho mỗi đơn vị, số vùng tuyến tính là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-167"><span class="MJXp-mtable" id="MJXp-Span-168"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-169" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-170" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">O</span><span class="MJXp-mstyle" id="MJXp-Span-172"><span class="MJXp-mrow" id="MJXp-Span-173"><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176" style="margin-right: 0.05em;">k</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-177" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-178">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">l</span><span class="MJXp-mo" id="MJXp-Span-180">−</span><span class="MJXp-mn" id="MJXp-Span-181">1</span><span class="MJXp-mo" id="MJXp-Span-182">)</span><span class="MJXp-mo" id="MJXp-Span-183">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">d</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-185"><span class="MJXp-mrow" id="MJXp-Span-186"><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\begin{align}
    O\Big(k^{(l-1)+d}\Big).
    \tag{6.43}
\end{align}</script></span></p><p>Tất nhiên, không có gì đảm bảo rằng các loại hàm chúng ta muốn học trong ứng dụng học máy (và cụ thể là cho AI) đều có chung một thuộc tính như vậy.</p><p>Lý do chúng ta muốn lựa chọn một mô hình sâu cũng có thể xuất phát từ thống kê. Bất cứ khi nào chọn một thuật toán học máy cụ thể, chúng ta đang ngầm biểu thị một số kinh nghiệm tiền đề mà ta đã có về các loại hàm mà thuật toán nên học. Việc chọn lựa mô hình học sâu có thể mã hóa được một kinh nghiệm rất tổng quát, đó là hàm ta muốn học là hợp thành của một số hàm đơn giản hơn. Điều này có thể được giải thích từ quan điểm của học biểu diễn, đó là ta tin rằng một bài toán học bao gồm việc phát hiện ra một tập các biến tố đằng sau dữ liêu, và các biến tố này lại có thể được diễn tả bằng các biến tố khác đơn giản hơn. Nói cách khác, ta có thể giải thích việc sử dụng một kiến trúc sâu là thể hiện một niềm tin rằng hàm ta muốn học là một chương trình máy tính bao gồm nhiều bước, trong đó mỗi bước sử dụng kết quả của bước trước đó. Các đầu ra trung gian này không nhất thiết phải là các biến tố mà thay vào đó có thể tương tự như các bộ đếm hoặc con trỏ mà mạng sử dụng để tổ chức xử lý nội bộ. Theo thực nghiệm, chiều sâu lớn hơn dường như dẫn đến việc tổng quát hoá tốt hơn cho nhiều tác vụ khác nhau [Bengio et al., 2007; Erhan et al., 2009; Bengio, 2009;Mesnil et al., 2011; Ciresan et al., 2012; Krizhevsky et al., 2012; Sermanet et al.,2013; Farabet et al., 2013; Couprie et al., 2013; Kahou et al., 2013; Goodfellowet al., 2014d; Szegedy et al., 2014a]. Xem hình 6.6 và 6.7 cho minh họa của các ví dụ về những kết quả thực nghiệm đó. Những kết quả này gợi ý rằng việc sử dụng kiến trúc sâu thực tế là thể hiện một tiên nghiệm hữu ích về không gian các hàm mà mô hình phải học.</p><p><img src="https://i.imgur.com/1EL9BSo.png" alt=""></p><blockquote>
<p>Hình 6.6: Ảnh hưởng của độ sâu. Kết quả thực nghiệm cho thấy rằng các mạng sâu hơn sẽ tổng quát tốt hơn khi được sử dụng để đọc các số có nhiều chữ số trên các bức ảnh chụp địa chỉ. Dữ liệu từ Goodfellow và cộng sự (2014d). Độ chính xác trên tập kiểm tra luôn tăng khi độ sâu tăng lên. Hình 6.7 minh họa một thí nghiệm có kiểm soát để thấy rằng các cách gia tăng kích thước mô hình khác không mang lại hiệu quả tương tự.</p>
</blockquote><p><img src="https://i.imgur.com/iXdMgel.png" alt=""></p><blockquote>
<p>Hình 6.7: Ảnh hưởng của số các tham số. Các mô hình sâu hơn có khuynh hướng hoạt động tốt hơn. Đó không chỉ đơn thuần là do mô hình lớn hơn. Thí nghiệm này từ Goodfellow và cộng sự (2014d) cho thấy rằng việc tăng số lượng tham số trong các lớp của mạng tích chập mà không gia tăng độ sâu của chúng gần như không cải thiện độ chính xách trên tập kiểm thử, như minh họa trong hình. Phần chú thích cho biết độ sâu của mạng được sử dụng để tạo ra mỗi đường cong, và liệu đường cong có biểu thị sự thay đổi về kích thước của các lớp tích chập hoặc các lớp kết nối đầy đủ hay không. Chúng tôi nhận thấy rằng các mô hình học nông trong trường hợp này có thể quá khớp ở khoảng 20 triệu tham số trong khi các mô hình sâu có thể mạng lại hiệu quả khi có từ 60 triệu tham số trở lên. Điều này gợi ý rằng việc sử dụng một mô hình sâu thể hiện một sự ưu tiên có lợi trong không gian các hàm có thể học của mô hình. Cụ thể, nó thể hiện một kinh nghiệm tiền đề rằng hàm số biểu diễn dữ liệu nên là hợp thành của nhiều hàm đơn giản hơn. Điều này có thể dẫn đến quá trình học một biểu diễn được tạo thành từ các biểu diễn khác đơn giản hơn (ví dụ, các góc được tạo ra bởi cạnh) hoặc quá trình học một chương trình với các bước phụ thuộc tuần tự (ví dụ, đầu tiên xác định vị trí của một tập hợp các đối tượng, sau đó phân đoạn chúng ra với nhau, sau đó nhận diện chúng).</p>
</blockquote><p>//------ Sơn Lâm kết thúc dịch ở đây p193 - p197</p><p>//—Oanh Nguyễn bắt đầu dịch từ đây (page 198 to 202)</p><h2 id="642-Các-yếu-tố-thiết-kế-kiến-trúc-khác">6.4.2 Các yếu tố thiết kế kiến trúc khác</h2><p>Từ đầu đến giờ chúng tôi đã mô tả mạng neuron như là một chuỗi đơn giản của các tầng, với các mối quan tâm chính là chiều sâu của mạng và chiều rộng của mỗi lớp. Trong thực tế, các yếu tố thiết kế của mạng neuron đa dạng hơn rất nhiều.</p><p>Rất nhiều kiến trúc mạng neuron đã được phát triển cho các tác vụ cụ thể. Các kiến trúc chuyên biệt cho thị giác máy tính gọi là các mạng tích chập sẽ được mô tả trong chương 9. Các mạng lan truyền thuận cũng có thể được khái quát hóa thành các mạng neuron truy hồi để xử lý chuỗi, và sẽ được mô tả trong chương 10. Các mạng truy hồi này có các đòi hỏi thiết kế của riêng nó.</p><p>Nói chung, các tầng không cần phải kết nối thành một chuỗi, dù đây là phương pháp phổ biến nhất trong thực tế. Nhiều kiến trúc xây dựng một chuỗi chính và sau đó bổ sung các đặc tính kiến trúc khác cho nó, chẳng hạn như các kết nối nhảy cóc (skip connection) từ tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-18">i</script></span> đến tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">i</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-194">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">i+2</script></span> hoặc cao hơn. Những kết nối nhảy cóc này giúp việc hướng luồng gradient từ các tầng đầu ra tới các tầng gần với tầng đầu vào dễ dàng hơn.</p><p>Một mối quan tâm trọng yếu khác trong thiết kế kiến trúc là làm sao để kết nối một cách chính xác các tầng theo cặp. Trong tầng mạng neuron mặc định mô tả bởi phép biến đổi tuyến tính qua một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-196">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">\boldsymbol{W}</script></span>, mỗi đơn vị đầu vào được kết nối với mọi đơn vị đầu ra. Nhiều mạng chuyên biệt trong các chương tiếp theo có ít kết nối hơn, sao cho mỗi đơn vị trong tầng đầu vào được kết nối với chỉ một tập con các đơn vị ở tầng đầu ra. Các chiến lược giảm số lượng kết nối này làm giảm số lượng tham số và khối lượng tính toán cần thiết để đánh giá chất lượng của mạng, nhưng chúng thường phụ thuộc nhiều vào bài toán cần giải. Ví dụ, các mạng tích chập, được mô tả trong chương 9, sử dụng các mẫu kết nối thưa chuyên biệt rất hiệu quả trong việc xử lý các bài toán trong lĩnh vực thị giác máy tính. Trong chương này, rất khó để đưa ra lời khuyên cụ thể hơn liên quan đến kiến trúc của một mạng neuron nói chung. Trong các chương tiếp theo, chúng ta sẽ phát triển các kiến trúc cụ thể đã được tìm thấy và hoạt động tốt trên các miền ứng dụng khác nhau.</p><h1 id="65-Lan-truyền-ngược-và-các-thuật-toán-tính-đạo-hàm-khác">6.5. Lan truyền ngược và các thuật toán tính đạo hàm khác</h1><p>Khi ta sử dụng một mạng neuron lan truyền thuận lấy một đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-197"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-198">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-21">\boldsymbol{x}</script></span> và tạo ra một kết quả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-199"><span class="MJXp-mrow" id="MJXp-Span-200"><span class="MJXp-munderover" id="MJXp-Span-201"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-202">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-22">\hat{\boldsymbol{y}}</script></span>, thông tin sẽ chuyển tiếp qua mạng. Dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-205">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">\boldsymbol{x}</script></span> cung cấp thông tin ban đầu mà sau đó lan truyền tới các đơn vị ẩn tại mỗi tầng và cuối cùng tạo ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mrow" id="MJXp-Span-207"><span class="MJXp-munderover" id="MJXp-Span-208"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-209">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">\hat{\boldsymbol{y}}</script></span>. Ta gọi đó là <em>lan truyền thuận</em> (forward propagation). Trong quá trình huấn luyện, quá trình lan truyền thuận có thể tiếp tục thực hiện cho đến khi nó tạo ra một chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">J</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-214">θ</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-25">J(\boldsymbol{\theta})</script></span> vô hướng. Thuật toán <em>lan truyền ngược</em> (back-propagation algorithm) [Rumelhart et al., 1986a], thường được gọi đơn giản là <em>truyền ngược</em> (backprop), cho phép thông tin đi ngược từ hàm chi phí qua mạng để tính toán gradient.</p><p>Tính gradient của một biểu thức dạng giải tích  thường khá đơn giản, nhưng xác định trị số của biểu thức gradient như vậy có thể rất tốn kém về mặt tính toán. Thuật toán lan truyền ngược giải quyết được vấn đề này bằng một quy trình đơn giản và không hề tốn kém.</p><p>Thuật ngữ lan truyền ngược thường bị hiểu lầm thành một thuật toán học tập cho một mạng neuron nhiều tầng. Thực tế, lan truyền ngược chỉ đề cập đến phương pháp tính toán cho gradient, trong khi các thuật toán khác, như trượt gradient ngẫu nhiên, được sử dụng để thực hiện việc học bằng cách sử dụng các gradient này. Hơn nữa, lan truyền ngược thường bị hiểu lầm là chỉ dành cho các mạng neuron nhiều lớp, nhưng về nguyên tắc nó có thể tính toán đạo hàm của bất cứ hàm nào (đối với một số hàm, một kết quả trả về đúng có thể chỉ là thông báo rằng đạo hàm của hàm đó là không xác định). Cụ thể, chúng tôi sẽ mô tả cách tính toán gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-msubsup" id="MJXp-Span-217"><span class="MJXp-mi" id="MJXp-Span-218" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-219" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-220">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">f</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-223">x</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-225">y</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-26-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-26">\nabla_{\boldsymbol{x}}f(\boldsymbol{x}, \boldsymbol{y})</script></span> cho một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-27-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-27">f</script></span> tùy ý, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-230">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">\boldsymbol{x}</script></span> là một tập hợp các biến mà đạo hàm của chúng đang cần tính toán, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-232">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">\boldsymbol{y}</script></span> là một tập hợp các biến bổ sung là đầu vào của hàm nhưng không bắt buộc ta phải tính đạo hàm cho chúng. Trong các thuật toán học tập, gradient mà chúng ta cần tính chủ yếu là gradient của hàm chi phí đối với các tham số, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi" id="MJXp-Span-235" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-237">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">J</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-240">θ</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})</script></span>. Nhiều tác vụ học máy cần đến việc tính toán các đạo hàm khác, có thể là một phần của quá trình học tập, hoặc để phân tích các mô hình học được. Thuật toán lan truyền ngược có thể áp dụng cho các tác vụ này và không chỉ giới hạn ở tính toán gradient của hàm chi phí đối với các tham số của nó. Ý tưởng tính toán các đạo hàm bằng cách lan truyền thông tin qua mạng là rất tổng quát và có thể được sử dụng để tính toán các giá trị khác như ma trận Jacobi của hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">f</script></span> với nhiều đầu ra. Ở đây ta chỉ mô tả các trường hợp được sử dụng phổ biến nhất mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">f</script></span> chỉ có một đầu ra.</p><h2 id="651-Đồ-thị-tính-toán">6.5.1 Đồ thị tính toán</h2><p>Từ đầu đến giờ chúng ta đã thảo luận về mạng neuron bằng một ngôn ngữ đồ thị tương đối không chính thức. Để mô tả thuật toán lan truyền ngược một cách chính xác hơn, ta nên sử dụng một ngôn ngữ <em>đồ thị tính toán</em> (computational graph) chính xác hơn.</p><p>Tồn tại rất nhiều cách để hình thức hoá các phép tính toán bằng đồ thị.</p><p>Ở đây, chúng tôi sử dụng mỗi nút trong đồ thị để biểu thị  một biến. Biến có thể là vô hướng, vector, ma trận, tensor hoặc thậm chí là một loại biến khác.</p><p>Để định nghĩa đồ thị tính toán, ta cần hiểu khái niệm <em>phép toán</em> (operation). Một phép toán là một hàm đơn giản của một hoặc nhiều biến. Ngôn ngữ đồ thị của ta đi kèm với một tập các phép toán cho phép. Các hàm phức tạp hơn các phép toán trong tập hợp này có thể được mô tả bằng cách hợp thành nhiều phép toán với nhau</p><p>Giả sử chúng ta định nghĩa một phép toán chỉ trả về một biến đầu ra duy nhất. Điều này không làm mất tính tổng quát vì một biến đầu ra có thể bao gồm nhiều phần tử, chẳng hạn như một vector. Việc triển khai các ứng dụng thực hiện lan truyền ngược thường hỗ trợ các phép toán với nhiều đầu ra, nhưng ở đây ta tránh trường hợp này vì nó liên quan đến nhiều khái niệm không thật sự quan trọng.</p><p>Nếu một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">y</script></span> được tính toán bằng cách áp dụng một phép toán trên biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">x</script></span>, thì ta vẽ được một cạnh trực tiếp từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">x</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">y</script></span>. Đôi khi ta chú thích nút đầu ra bằng tên của phép toán được áp dụng, và đôi khi ta lại bỏ qua nhãn này khi ngữ cảnh của phép toán đã được định rõ.</p><p>Hình 6.8 minh họa một ví dụ về đồ thị tính toán.</p><p><img src="https://i.imgur.com/zTKInqU.png" alt=""></p><blockquote>
<p>Hình 6.8: Ví dụ về đồ thị tính toán. (a) Đồ thị sử dụng phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.267em; margin-right: 0.267em;">×</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">\times</script></span> để tính toán hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">z</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">z = xy</script></span>. (b) Đồ thị dự đoán hồi quy logit <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">y</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">σ</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-268" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-269">w</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">b</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">y=\sigma(\boldsymbol{x}^\top\boldsymbol{w} + b)</script></span>. Một số biểu thức trung gian không có tên trong biểu thức đại số nhưng cần có tên trong đồ thị. Chúng tôi đặt tên biến thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">i</script></span> đơn giản là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-msubsup" id="MJXp-Span-276"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-277" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-278" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-279">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">i</span><span class="MJXp-mo" id="MJXp-Span-281">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">\boldsymbol{u}^{(i)}</script></span>. (c) Đồ thị tính toán cho biểu thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-287">H</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-291">0</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-293">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-294">W</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-296">b</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">\boldsymbol{H} = \max\{0, \boldsymbol{X}\boldsymbol{W}+\boldsymbol{b}\}</script></span>, giúp tính toán một ma trận thiết kế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-299">H</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">\boldsymbol{H}</script></span> của các hàm kích hoạt sử dụng đơn vị tuyến tính hiệu chỉnh khi biết một một ma trận thiết kế chứa một lô nhỏ các đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-301">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">\boldsymbol{X}</script></span>. (d) Các ví dụ từ a đến c chỉ áp dụng nhiều nhất một phép toán cho mỗi biến, nhưng chúng ta có thể áp dụng nhiều thao tác hơn. Ở đây chúng tôi biểu diễn một đồ thị tính toán áp dụng nhiều thao tác cho trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-303">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">\boldsymbol{w}</script></span> của một mô hình hồi quy tuyến tính. Trong số này được dùng cho cả dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mrow" id="MJXp-Span-305"><span class="MJXp-munderover" id="MJXp-Span-306"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">\hat{y}</script></span> lẫn mức phạt suy giảm trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">λ</span><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-313" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-315"><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-319">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">\lambda\sum_{i}{w_i^2}</script></span>.</p>
</blockquote><p>(Oanh Nguyen kết thúc dịch tại đây (page 198 to 202))-----////</p><p>//--------- Soan Duong note: thiếu hình 6.6-6.8; thiếu caption hình 6.6-6.7</p><h2 id="652-Quy-tắc-đạo-hàm-của-hàm-hợp">6.5.2 Quy tắc đạo hàm của hàm hợp</h2><p>---- DuyNht bắt đầu dịch từ đây ----</p><p>Quy tắc đạo hàm của hàm hợp được sử dụng để tính đạo hàm của một hàm do nhiều hàm khác hợp thành khi ta đã biết đạo hàm của các hàm thành phần đó. Lan truyền ngược là một thuật toán tính toán đạo hàm của hàm hợp, theo một thứ tự vô cùng hiệu quả.</p><p>Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">x</script></span> là một số thực, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">f</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">g</script></span> là hai hàm ánh xạ một số thực tới một đầu ra thực. Giả sử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">y</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">g</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">x</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">y = g(x)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">z</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">f</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">g</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">x</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">f</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">y</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">z = f(g(x)) = f(y)</script></span>. Theo nguyên tắc đạo hàm của hàm hợp</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-348"><span class="MJXp-mtable" id="MJXp-Span-349"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-350" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-351" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-352" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-358" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">y</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-363" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-53">
\frac{dz}{dx} = \frac{dz}{dy}\frac{dy}{dx}. 
\tag{6.44}
</script></span></p><p>Ta có thể tổng quát hóa nó trên không gian vector như sau. Giả sử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-370">x</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mrow" id="MJXp-Span-373" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-374">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-375" style="vertical-align: 0.5em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-377">y</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mrow" id="MJXp-Span-380" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-381">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">\boldsymbol{x}\in\mathbb{R}^m, \boldsymbol{y} \in \mathbb{R}^n</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">g</script></span> ánh xạ từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mrow" id="MJXp-Span-387" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-388">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-389" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">\mathbb{R}^m</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mrow" id="MJXp-Span-392" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-393">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-394" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">\mathbb{R}^n</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">f</script></span> ánh xạ từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mrow" id="MJXp-Span-399" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-400">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">\mathbb{R}^n</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-402"><span class="MJXp-mrow" id="MJXp-Span-403"><span class="MJXp-mi undefined" id="MJXp-Span-404">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">\mathbb{R}</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-406">y</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">g</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-410">x</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\boldsymbol{y} = g(\boldsymbol{x})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">z</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">f</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-417">y</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">z = f(\boldsymbol{y})</script></span> thì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-419"><span class="MJXp-mtable" id="MJXp-Span-420"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-421" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-422" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-423" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-424">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-426">∂</span><span class="MJXp-msubsup" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-429" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-431"><span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-434" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-435">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-437">∂</span><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-441" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-442">∂</span><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-446">∂</span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-449" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">
\frac{\partial z}{\partial x_i} = \sum_j \frac{\partial z}{\partial y_j}\frac{\partial y_j}{\partial x_i}.
\tag{6.45}
</script></span></p><p>Sử dụng kí hiệu vector, ta có thể viết phương trình trên dưới dạng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-451"><span class="MJXp-mtable" id="MJXp-Span-452"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-453" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-454" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mi" id="MJXp-Span-456" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-457" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-458">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">z</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mrow" id="MJXp-Span-462" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-464" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-465">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-466">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-467">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-468">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-script" id="MJXp-Span-470" style="vertical-align: 1.2em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-471"><span class="MJXp-mi" id="MJXp-Span-472" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-474">y</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">z</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">
\nabla_{\boldsymbol{x}}z = \left(\frac{\partial \boldsymbol{y}}{\partial \boldsymbol{x}}\right)^\top \nabla_{\boldsymbol{y}}z ,
\tag{6.46}
</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-477"><span class="MJXp-mfrac" id="MJXp-Span-478" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-479">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-480">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-481">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-482">x</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">\frac{\partial \boldsymbol{y}}{\partial \boldsymbol{x}}</script></span> là ma trận Jacobi kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">n</span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-66">n \times m</script></span> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">g</script></span>.</p><p>Từ đó ta thấy gradient của một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-490">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">\boldsymbol{x}</script></span> có thể thu được bằng cách nhân ma trận Jacobi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-mfrac" id="MJXp-Span-492" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-493">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-494">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-495">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-496">x</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">\frac{\partial \boldsymbol{y}}{\partial \boldsymbol{x}}</script></span> với một gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi" id="MJXp-Span-499" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-501">y</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">\nabla_{\boldsymbol{y}}z</script></span>. Thuật toán lan truyền ngược thực hiện một phép nhân ma trận Jacobi với gradient cho mỗi phép toán trên đồ thị.</p><p>Thông thường ta áp dụng thuật toán lan truyền ngược cho các tensor với số chiều tùy ý, chứ không chỉ riêng các vector. Về mặt ý tưởng, việc này hoàn toàn giống với lan truyền ngược trên vector. Điểm khác biệt duy nhất là cách các số được sắp xếp theo một lưới để tạo thành một tensor. Có thể tưởng tượng là ta sẽ làm phẳng mỗi tensor thành một vector trước khi thực hiện lan truyền ngược, sau đó tính một gradient với giá trị là một vector, và cuối cùng biến đổi gradient trở lại thành một tensor. Bằng cách nhìn này, lan truyền ngược vẫn chỉ là các phép nhân các ma trận Jacobi với các gradient.</p><p>Để biểu diễn gradient của một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">z</script></span> theo một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-mi undefined" id="MJXp-Span-507">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-72-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-72">\boldsymbol{\mathsf{X}}</script></span>, ta viết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi" id="MJXp-Span-510" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-512"><span class="MJXp-mi undefined" id="MJXp-Span-513">X</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">\nabla_{\boldsymbol{\mathsf{X}}}z</script></span>, tương tự như cách viết cho vector. Các chỉ số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-515"><span class="MJXp-mrow" id="MJXp-Span-516"><span class="MJXp-mi undefined" id="MJXp-Span-517">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">\boldsymbol{\mathsf{X}}</script></span> giờ đây ứng với nhiều trục tọa độ - ví dụ, một tensor 3 chiều có ba chỉ số ứng với ba trục tọa độ. Ta có thể trừu tượng hóa việc này đi bằng cách dùng một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">i</script></span> duy nhất để biểu diễn bộ (tuple) các chỉ số hoàn chỉnh. Với mọi bộ chỉ số khả dĩ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">i</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-524"><span class="MJXp-mi" id="MJXp-Span-525" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-526" style="vertical-align: -0.4em;"><span class="MJXp-mi undefined" id="MJXp-Span-527">X</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">z</span><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-531" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">(\nabla_\boldsymbol{\mathsf{X}} z)_i</script></span> chính là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mfrac" id="MJXp-Span-533" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-534">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-536">∂</span><span class="MJXp-msubsup" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-539" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-78">\frac{\partial z}{\partial X_i}</script></span>, tương tự với vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi" id="MJXp-Span-543" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">z</span><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">(\nabla_\boldsymbol{x} z)_i</script></span> chính là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mfrac" id="MJXp-Span-550" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-551">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-553">∂</span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">\frac{\partial z}{\partial x_i}</script></span>: Bằng cách viết này, ta có thể viết quy tắc đạo hàm của hàm hợp cho tensor như sau:</p><p>Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-mrow" id="MJXp-Span-558"><span class="MJXp-mi undefined" id="MJXp-Span-559">Y</span></span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">g</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mi undefined" id="MJXp-Span-564">X</span></span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">\boldsymbol{\mathsf{Y}} = g(\boldsymbol{\mathsf{X}})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">z</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">f</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mi undefined" id="MJXp-Span-572">X</span></span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">z - f(\boldsymbol{\mathsf{X}})</script></span> thì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-574"><span class="MJXp-mtable" id="MJXp-Span-575"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-576" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-577" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-578"><span class="MJXp-mi" id="MJXp-Span-579" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-580" style="vertical-align: -0.4em;"><span class="MJXp-mi undefined" id="MJXp-Span-581">X</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">z</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-584"><span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-587"><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-589"><span class="MJXp-mi" id="MJXp-Span-590" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-591" style="vertical-align: -0.4em;"><span class="MJXp-mi undefined" id="MJXp-Span-592">X</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-593"><span class="MJXp-mrow" id="MJXp-Span-594" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-595">Y</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-596" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-598" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-599">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-601">∂</span><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mrow" id="MJXp-Span-603" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-604">Y</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-605" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-83">
\nabla_\boldsymbol{\mathsf{X}}z = \sum_j\left(\nabla_\boldsymbol{\mathsf{X}} \mathsf{Y}_j\right)\frac{\partial z}{\partial \mathsf{Y}_j}.
\tag{6.47}
</script></span></p><h2 id="653-Lan-truyền-ngược-bằng-cách-đệ-quy-quy-tắc-đạo-hàm-của-hàm-hợp">6.5.3 Lan truyền ngược bằng cách đệ quy quy tắc đạo hàm của hàm hợp</h2><p>Sử dụng quy tắc đạo hàm của hàm hợp, ta có thể dễ dàng viết ra một biểu thức đại số cho gradient của một đại lượng vô hướng tương ứng với mọi nút trên đồ thị tính toán sinh ra đại lượng vô hướng đó. Tuy nhiên, việc tính giá trị biểu thức đó trên máy tính lại phát sinh một số điểm cần lưu ý.</p><p>Cụ thể, nhiều biểu thức con có thể lặp lại nhiều lần trong biểu thức tổng thể của gradient. Bất cứ thủ tục tính gradient nào cũng sẽ cần chọn giữa việc lưu lại những biểu thức này hay tính lại chúng nhiều lần. Một ví dụ về cách mà các biểu thức con lặp lại này được minh họa ở hình 6.9. Trong một vài trường hợp, việc tính lại cùng một biểu thức con sẽ là lãng phí tài nguyên. Với những đồ thị phức tạp, số phép tính dư thừa này có thể lên đến cấp số nhân, khiến cho việc tính trực tiếp đạo hàm của hàm hợp trở nên phi thực tế. Trong những trường hợp khác, việc tính lại một một khai triển hai lần có thể là một cách phù hợp để giảm tiêu thụ bộ nhớ với cái giá là chi phí tính toán tăng lên.</p><p><img src="https://i.imgur.com/LqprnTV.png" alt=""></p><blockquote>
<p>Hình 6.9: Đồ thị tính toán thu được khi lặp lại các biểu thức con trong quá trình tính toán gradient. Cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">w</span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-610"><span class="MJXp-mi undefined" id="MJXp-Span-611">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">w \in \mathbb{R}</script></span> là đầu vào của đồ thị. Ta sẽ dùng cùng một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">f</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mrow" id="MJXp-Span-615"><span class="MJXp-mi undefined" id="MJXp-Span-616">R</span></span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mi undefined" id="MJXp-Span-619">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">f:\mathbb{R} \to \mathbb{R}</script></span> làm phép toán thực hiện ở mỗi bước của chuỗi: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">x</span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">f</span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">w</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">y</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">f</span><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">x</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">z</span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">f</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">y</span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">x = f(w), y = f(x), z=f(y)</script></span>. Để tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mfrac" id="MJXp-Span-642" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-643">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-645">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">w</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">\frac{\partial z}{\partial w}</script></span>, ta dùng phương trình (6.44) và thu được:</p>
</blockquote><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-647"><span class="MJXp-mtable" id="MJXp-Span-648"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-649" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-650" style="text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-651" style="padding-left: 0em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-652" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-653">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-655">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">w</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-657" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-658" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-660" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mspace" id="MJXp-Span-661" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-662" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-663">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-665">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">y</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-667" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-668">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">y</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-670">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">x</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-672" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-673">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">x</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-675">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">w</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-677" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-678" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-680" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mspace" id="MJXp-Span-681" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-684" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">y</span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-690" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">x</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-696" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">w</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-700" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-701" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-703" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mspace" id="MJXp-Span-704" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-707" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">f</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">f</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">w</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-719" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">f</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">w</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-728" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">w</span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-88">\begin{align}
&\frac{\partial z}{\partial w} \tag{6.49}\\
=& \,\frac{\partial z}{\partial y}\frac{\partial y}{\partial x}\frac{\partial x}{\partial w} \tag{6.50}\\
=& \,f'(y)f'(x)f'(w) \tag{6.51}\\
=& \,f'(f(f(w)))f'(f(w))f'(w) \tag{6.52}
\end{align}</script></span></p><blockquote>
<p>Phương trình (6.51) gợi ý cho chúng ta một cách thực hiện như sau: tính giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">f</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">w</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">f(w)</script></span> chỉ một lần và lưu nó và một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">x</script></span>. Đây là cách tiếp cận của thuật toán lan truyền ngược. Một cách khác là tính lại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">f</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">w</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">f(w)</script></span> mỗi khi cần. Nếu chỉ cần một phần bộ nhớ nhỏ để lưu trữ các biểu thức này, hiển nhiên ta ưa dùng cách tiếp cận lan truyền ngược của phương trình (6.51) vì nó giúp giảm thời gian chạy. Tuy nhiên, phương trình (6.52) cũng là một cách thực hiện khả thi của quy tắc đạo hàm của hàm hợp và nó hữu dụng khi bộ nhớ có hạn.</p>
</blockquote><p>Chúng tôi bắt đầu với một phiên bản của thuật toán lan truyền ngược, trong đó việc tính gradient được thực hiện trực tiếp (thuật toán 6.2 đi kèm với thuật toán 6.1 cho tính toán thuận), theo đúng thứ tự áp dụng quy tắc đạo hàm của hàm hợp bằng đệ quy. Ta có thể trực tiếp thực hiện những tính toán này hoặc coi mô tả thuật toán như một đặc tả của đồ thị tính toán cho quá trình lan truyền ngược. Tuy nhiên cách tính toán này không làm rõ thao tác và cấu trúc của đồ thị tính toán gradient. Một cách tính toán như vậy sẽ được thể hiện ở mục 6.5.6, cùng thuật toán 6.5, và ở đó chúng tôi cũng tổng quát hoá cho trường hợp các nút chứa các tensor tùy ý.</p><p>Trước tiên, ta xét một đồ thị tính toán mô tả cách tính một đại lượng vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-744"><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-747" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-748">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">n</span><span class="MJXp-mo" id="MJXp-Span-750">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">u^{(n)}</script></span> (giả sử là hàm mất mát của một mẫu huấn luyện). Đại lượng vô hướng này là đại lượng mà ta muốn tính gradient của nó, đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-msubsup" id="MJXp-Span-752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-754" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">n_i</script></span> nút đầu vào từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-758" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-759">(</span><span class="MJXp-mn" id="MJXp-Span-760">1</span><span class="MJXp-mo" id="MJXp-Span-761">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">u^{(1)}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-765" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-766">(</span><span class="MJXp-msubsup" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-769" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-770">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">u^{(n_i)}</script></span>. Nói cách khác, ta muốn tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-771"><span class="MJXp-mfrac" id="MJXp-Span-772" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-773">∂</span><span class="MJXp-msubsup" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-776" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-777">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">n</span><span class="MJXp-mo" id="MJXp-Span-779">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-780">∂</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-783" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-784">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">i</span><span class="MJXp-mo" id="MJXp-Span-786">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">\frac{\partial u^{(n)}}{\partial u^{(i)}}</script></span> với mọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">i</span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-791">1</span><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-793">2</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-801" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">i \in \{1,2,...,n_i\}</script></span>. Khi áp dụng lan truyền ngược vào quá trình tính toán các gradient dùng trong thuật toán trượt gradient để cập nhật tham số, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-803"><span class="MJXp-msubsup" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-806" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-807">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">n</span><span class="MJXp-mo" id="MJXp-Span-809">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">u^{(n)}</script></span> sẽ là chi phí tương ứng với một mẫu hoặc một lô nhỏ, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-msubsup" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-813" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-814">(</span><span class="MJXp-mn" id="MJXp-Span-815">1</span><span class="MJXp-mo" id="MJXp-Span-816">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">u^{(1)}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-msubsup" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-820" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-821">(</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-824" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-825">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">u^{(n_i)}</script></span> tương ứng với các tham số của mô hình.</p><p>Giả sử các nút của đồ thị được sắp xếp sao cho ta có thể lần lượt tính được đầu ra của mỗi nút, từ nút trước đến nút sau, bắt đầu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-msubsup" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-829" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-830">(</span><span class="MJXp-msubsup" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-833" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-834">+</span><span class="MJXp-mn" id="MJXp-Span-835">1</span><span class="MJXp-mo" id="MJXp-Span-836">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">u^{(n_i+1)}</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-840" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-841">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">n</span><span class="MJXp-mo" id="MJXp-Span-843">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">u^{(n)}</script></span>. Như định nghĩa ở thuật toán 6.1, mỗi nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-844"><span class="MJXp-msubsup" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-847" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-848">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">i</span><span class="MJXp-mo" id="MJXp-Span-850">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">u^{(i)}</script></span> ứng với một phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-854" style="vertical-align: 0.5em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">i</span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">f^(i)</script></span> và được tính bằng hàm<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-857"><span class="MJXp-mtable" id="MJXp-Span-858"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-859" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-860" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-863" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-864">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">i</span><span class="MJXp-mo" id="MJXp-Span-866">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">f</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mrow" id="MJXp-Span-871" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-872">A</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-873" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-874">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">i</span><span class="MJXp-mo" id="MJXp-Span-876">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-105">u^{(i)} = f(\mathbb{A}^{(i)}), \tag{6.48}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-msubsup" id="MJXp-Span-880"><span class="MJXp-mrow" id="MJXp-Span-881" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-882">A</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-883" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-884">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">i</span><span class="MJXp-mo" id="MJXp-Span-886">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\mathbb{A}^{(i)}</script></span> là tập tất cả nút cha của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-msubsup" id="MJXp-Span-888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-890" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-891">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">i</span><span class="MJXp-mo" id="MJXp-Span-893">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">u^{(i)}</script></span>.</p><p>Thuật toán trên đưa ra một cách tính lan truyền thuận mà ta có thể biểu diễn bằng một đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-mrow" id="MJXp-Span-895"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-896">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">\mathcal{G}</script></span>. Để thực hiện lan truyền ngược, ta xây dựng một đồ thị tính toán dựa trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-897"><span class="MJXp-mrow" id="MJXp-Span-898"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-899">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">\mathcal{G}</script></span> và thêm vào đó một tập nút mới. Những nút này tạo thành một đồ thị con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-902">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\mathcal{B}</script></span> với mỗi nút ứng với một nút của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mrow" id="MJXp-Span-904"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-905">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">\mathcal{G}</script></span>. Quá trình tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mrow" id="MJXp-Span-907"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-908">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">\mathcal{B}</script></span> được thực hiện theo thứ tự ngược lại với thứ tự trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-mrow" id="MJXp-Span-910"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-911">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">\mathcal{G}</script></span>, và mỗi nút của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mrow" id="MJXp-Span-913"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-914">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">\mathcal{B}</script></span> tính toán đạo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-mfrac" id="MJXp-Span-916" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-917">∂</span><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-920" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-921">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">n</span><span class="MJXp-mo" id="MJXp-Span-923">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-924">∂</span><span class="MJXp-msubsup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-927" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-928">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">i</span><span class="MJXp-mo" id="MJXp-Span-930">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\frac{\partial u^{(n)}}{\partial u^{(i)}}</script></span> ứng với nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-935">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">i</span><span class="MJXp-mo" id="MJXp-Span-937">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">u^{(i)}</script></span> của đồ thị thuận. Việc này được thực hiện bằng cách dùng quy tắc đạo hàm của hàm hợp cho đầu ra vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-msubsup" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-941" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-942">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">n</span><span class="MJXp-mo" id="MJXp-Span-944">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">u^{(n)}</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-945"><span class="MJXp-mtable" id="MJXp-Span-946"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-947" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-948" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-949" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-950">∂</span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-953" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-954">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span><span class="MJXp-mo" id="MJXp-Span-956">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-957">∂</span><span class="MJXp-msubsup" id="MJXp-Span-958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-960" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-961">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">j</span><span class="MJXp-mo" id="MJXp-Span-963">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-965"><span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-967" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">i</span><span class="MJXp-mo" id="MJXp-Span-969">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">j</span><span class="MJXp-mo" id="MJXp-Span-971">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">a</span><span class="MJXp-mo" id="MJXp-Span-974">(</span><span class="MJXp-msubsup" id="MJXp-Span-975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-977" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-978">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">i</span><span class="MJXp-mo" id="MJXp-Span-980">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-981">)</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-982" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-983">∂</span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-986" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-987">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">n</span><span class="MJXp-mo" id="MJXp-Span-989">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-990">∂</span><span class="MJXp-msubsup" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-993" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-994">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">i</span><span class="MJXp-mo" id="MJXp-Span-996">)</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-997" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-998">∂</span><span class="MJXp-msubsup" id="MJXp-Span-999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1001" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1002">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">i</span><span class="MJXp-mo" id="MJXp-Span-1004">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1005">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1008" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1009">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">j</span><span class="MJXp-mo" id="MJXp-Span-1011">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-118">
\frac{\partial u^{(n)}}{\partial u^{(j)}} = \sum_{i:j \in Pa(u^{(i)})} \frac{\partial u^{(n)}}{\partial u^{(i)}}\frac{\partial u^{(i)}}{\partial u^{(j)}}
\tag{6.53}
</script></span></p><p>như mô tả trong thuật toán 6.2. Đồ thị con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1014">B</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">\mathcal{B}</script></span> chứa đúng một cạnh từ nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1015"><span class="MJXp-msubsup" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1018" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1019">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">j</span><span class="MJXp-mo" id="MJXp-Span-1021">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">u^{(j)}</script></span> tới nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1025" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1026">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">i</span><span class="MJXp-mo" id="MJXp-Span-1028">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">u^{(i)}</script></span> của đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-mrow" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1031">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">\mathcal{G}</script></span>. Cạnh từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-msubsup" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1035" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1036">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">j</span><span class="MJXp-mo" id="MJXp-Span-1038">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">u^{(j)}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-msubsup" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1042" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1043">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">i</span><span class="MJXp-mo" id="MJXp-Span-1045">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">u^{(i)}</script></span> tương ứng với việc tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mfrac" id="MJXp-Span-1047" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1048">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1051" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1052">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">i</span><span class="MJXp-mo" id="MJXp-Span-1054">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1055">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1058" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1059">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">j</span><span class="MJXp-mo" id="MJXp-Span-1061">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span>. Thêm vào đó, cho mỗi nút, ta tính một tích vô hướng giữa gradient đã tính trước đó theo các nút con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-msubsup" id="MJXp-Span-1063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1065" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1066">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">i</span><span class="MJXp-mo" id="MJXp-Span-1068">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">u^{(i)}</script></span> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1072" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1073">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">j</span><span class="MJXp-mo" id="MJXp-Span-1075">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">u^{(j)}</script></span> và vector chứa đạo hàm riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mfrac" id="MJXp-Span-1077" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1078">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1081" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1082">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">i</span><span class="MJXp-mo" id="MJXp-Span-1084">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1085">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1088" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1089">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">j</span><span class="MJXp-mo" id="MJXp-Span-1091">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> cho cùng các nút con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1092"><span class="MJXp-msubsup" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1095" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1096">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">i</span><span class="MJXp-mo" id="MJXp-Span-1098">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">u^{(i)}</script></span>. Tóm lại, lượng tính toán cần cho việc thực hiện lan truyền ngược tăng tuyến tính theo số cạnh trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mrow" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1101">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\mathcal{G}</script></span>, ở đó phép tính toán cho từng cạnh ứng với phép tính một đạo hàm riêng (của một nút theo các nút cha của nó) cũng như thực hiện một phép nhân và một phép cộng. Dưới đây, chúng tôi sẽ tổng quát hoá phân tích này cho các nút có giá trị là các tensor, thực ra cũng chỉ là một cách nhóm nhiều giá trị vô hướng trong cùng một nút và cho phép thực hiện những cách cài đặt hiệu quả hơn.</p><hr><p><strong>Thuật toán 6.1</strong> Một thủ tục thực hiện ánh xạ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-msubsup" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1105" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">n_i</script></span> đầu vào từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1106"><span class="MJXp-msubsup" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1109" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1110">(</span><span class="MJXp-mn" id="MJXp-Span-1111">1</span><span class="MJXp-mo" id="MJXp-Span-1112">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">u^{(1)}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1113"><span class="MJXp-msubsup" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1116" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1117">(</span><span class="MJXp-msubsup" id="MJXp-Span-1118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1120" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1121">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">u^{(n_i)}</script></span> đến một đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1122"><span class="MJXp-msubsup" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1125" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1126">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">n</span><span class="MJXp-mo" id="MJXp-Span-1128">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">u^{(n)}</script></span>.<br>
Thủ tục này định nghĩa một đồ thị tính toán mà trong đó mỗi nút sẽ tính toán trị số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1132" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1133">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">i</span><span class="MJXp-mo" id="MJXp-Span-1135">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">u^{(i)}</script></span> bằng cách áp dụng một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1136"><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1139" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1140">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span><span class="MJXp-mo" id="MJXp-Span-1142">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">f^{(i)}</script></span> cho tập đối số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mrow" id="MJXp-Span-1144"><span class="MJXp-msubsup" id="MJXp-Span-1145"><span class="MJXp-mi undefined" id="MJXp-Span-1146" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1147" style="vertical-align: 0.5em;"><span class="MJXp-mo undefined" id="MJXp-Span-1148">(</span><span class="MJXp-mi undefined" id="MJXp-Span-1149">i</span><span class="MJXp-mo undefined" id="MJXp-Span-1150">)</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">\mathbb{A^{(i)}}</script></span> chứa giá trị của các nút trước đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-msubsup" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1154" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1155">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">j</span><span class="MJXp-mo" id="MJXp-Span-1157">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">j</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">u^{(j)}, j<i</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">j</span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">a</span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1170" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1171">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">i</span><span class="MJXp-mo" id="MJXp-Span-1173">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">j \in Pa(u^{(i)})</script></span>. Đầu vào của đồ thị tính toán là vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1176">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">\boldsymbol{x}</script></span>, và được đưa vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1177"><span class="MJXp-msubsup" id="MJXp-Span-1178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1180" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">n_i</script></span> nút từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1184" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1185">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">i</span><span class="MJXp-mo" id="MJXp-Span-1187">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">u^{(i)}</script></span> tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1188"><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1191" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1192">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">n</span><span class="MJXp-mo" id="MJXp-Span-1194">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">u^{(n)}</script></span>.</p><hr><p><strong>for <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">i</span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1198">1</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">i=1,...,n_i</script></span> do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-mspace" id="MJXp-Span-1208" style="width: 2.362em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1211" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1212">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">i</span><span class="MJXp-mo" id="MJXp-Span-1214">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1218" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">\hspace{10mm} u^{(i)} \leftarrow x_i</script></span><br>
<strong>end for</strong><br>
<strong>for <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">i</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1224" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1226">1</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">i=n_i+1,...,n</script></span> do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-mspace" id="MJXp-Span-1234" style="width: 2.362em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1235"><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mi undefined" id="MJXp-Span-1237" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1238" style="vertical-align: 0.5em;"><span class="MJXp-mo undefined" id="MJXp-Span-1239">(</span><span class="MJXp-mi undefined" id="MJXp-Span-1240">i</span><span class="MJXp-mo undefined" id="MJXp-Span-1241">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1246" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1247">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">j</span><span class="MJXp-mo" id="MJXp-Span-1249">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1250" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1251"><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-1253" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">j</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">a</span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1261" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1262">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">i</span><span class="MJXp-mo" id="MJXp-Span-1264">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">\hspace{10mm}\mathbb{A^{(i)}} \leftarrow \{u^{(j)} \,|\, j \in Pa(u^{(i)})\}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mspace" id="MJXp-Span-1268" style="width: 2.362em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1271" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1272">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">i</span><span class="MJXp-mo" id="MJXp-Span-1274">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1278" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1279">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">i</span><span class="MJXp-mo" id="MJXp-Span-1281">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1283"><span class="MJXp-mrow" id="MJXp-Span-1284" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1285">A</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1286" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1287">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">i</span><span class="MJXp-mo" id="MJXp-Span-1289">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">\hspace{10mm}u^{(i)} \leftarrow f^{(i)}(\mathbb{A}^{(i)})</script></span><br>
<strong>end for</strong><br>
<strong>return <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1291"><span class="MJXp-msubsup" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1294" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1295">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">n</span><span class="MJXp-mo" id="MJXp-Span-1297">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">u^{(n)}</script></span></strong></p><hr><p>Thuật toán lan truyền ngược được thiết kế để giảm số biểu thức con thường gặp mà không quan tâm đến bộ nhớ. Cụ thể, nó thực hiện theo thứ tự một tích Jacobi cho mỗi nút của đồ thị. Thứ tự này là do lan truyền ngược (giải thuật 6.2) thăm mỗi cạnh từ nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1298"><span class="MJXp-msubsup" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1301" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1302">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">j</span><span class="MJXp-mo" id="MJXp-Span-1304">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">u^{(j)}</script></span> tới nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1305"><span class="MJXp-msubsup" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1308" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1309">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">i</span><span class="MJXp-mo" id="MJXp-Span-1311">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">u^{(i)}</script></span> của đồ thị đúng một lần để tính đạo hàm riêng tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1312"><span class="MJXp-mfrac" id="MJXp-Span-1313" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1314">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1317" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1318">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">i</span><span class="MJXp-mo" id="MJXp-Span-1320">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1321">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1324" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1325">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">j</span><span class="MJXp-mo" id="MJXp-Span-1327">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span>. Do vậy lan truyền ngược tránh được sự bùng nổ theo cấp số nhân của số lượng các biểu thức con lặp lại. Các thuật toán khác có thể tránh nhiều biểu thức con bằng việc đơn giản hóa đồ thị tính toán, hoặc có thể bảo toàn bộ nhớ bằng cách tính lại thay vì lưu lại của một vài khai triển. Chúng tôi sẽ quay lại những tư tưởng này sau khi mô tả thuật toán lan truyền ngược.</p><hr><p><strong>Thuật toán 6.2</strong> Phiên bản đơn giản hóa của thuật toán lan truyền ngược để tính đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1328"><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1331" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1332">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">n</span><span class="MJXp-mo" id="MJXp-Span-1334">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">u^{(n)}</script></span> theo các biến trong đồ thị. Ví dụ này nhằm mục đích giúp bạn đọc hiểu rõ hơn thông qua một trường hợp đơn giản mà ở đó mọi biến là vô hướng, và ta muốn tính các đạo hàm theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-msubsup" id="MJXp-Span-1336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1338" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1339">(</span><span class="MJXp-mn" id="MJXp-Span-1340">1</span><span class="MJXp-mo" id="MJXp-Span-1341">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1349" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1350">(</span><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1354">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">u^{(1)},...,u^{(n_i)}</script></span>. Phiên bản đơn giản này tính đạo hàm của toàn bộ nút trong đồ thị. Chi phí tính toán của thuật toán này tỉ lệ với số cạnh trong đồ thị, với giả định rằng đạo hàm riêng ứng với mỗi cạnh cần một thời gian hằng số. Độ phức tạp của thuật toán lan truyền ngược này bằng với độ phức tạp khi tính toán lan truyền thuận. Mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1355"><span class="MJXp-mfrac" id="MJXp-Span-1356" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1357">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1360" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1361">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">i</span><span class="MJXp-mo" id="MJXp-Span-1363">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1364">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1367" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1368">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">j</span><span class="MJXp-mo" id="MJXp-Span-1370">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> là một hàm của các nút cha <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1371"><span class="MJXp-msubsup" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1374" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1375">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">j</span><span class="MJXp-mo" id="MJXp-Span-1377">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">u^{(j)}</script></span> đối với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1378"><span class="MJXp-msubsup" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1381" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1382">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">i</span><span class="MJXp-mo" id="MJXp-Span-1384">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">u^{(i)}</script></span>, do đó thể hiện mối liên kết giữa các nút của đồ thị thuận và các nút của đồ thị lan truyền ngược thêm vào.</p><hr><p>Thực hiện lan truyền thuận (thuật toán 6.1 cho ví dụ này) để thu được các kích hoạt của mạng.<br>
Khởi tạo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1385"><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1387">grad_table</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">\texttt{grad_table}</script></span>, một cấu trúc dữ liệu để lưu trữ các đạo hàm đã tính. Ô <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1390">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1394" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1395">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">i</span><span class="MJXp-mo" id="MJXp-Span-1397">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">\texttt{grad_table}[u^{(i)}]</script></span> lưu giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1399"><span class="MJXp-mfrac" id="MJXp-Span-1400" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1401">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1404" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1405">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">n</span><span class="MJXp-mo" id="MJXp-Span-1407">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1408">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1411" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1412">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">j</span><span class="MJXp-mo" id="MJXp-Span-1414">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">\frac{\partial u^{(n)}}{\partial u^{(j)}}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1417">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1421" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1422">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">n</span><span class="MJXp-mo" id="MJXp-Span-1424">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mn" id="MJXp-Span-1427">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">\texttt{grad_table}[u^{(n)}] \leftarrow 1</script></span><br>
<strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">j</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">n</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1433">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">j = n-1</script></span> down to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1434"><span class="MJXp-mn" id="MJXp-Span-1435">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">1</script></span> <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mspace" id="MJXp-Span-1437" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">\hspace{10mm}</script></span>Tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mfrac" id="MJXp-Span-1439" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1440">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1443" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1444">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">n</span><span class="MJXp-mo" id="MJXp-Span-1446">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1447">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1450" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1451">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">j</span><span class="MJXp-mo" id="MJXp-Span-1453">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1457" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">i</span><span class="MJXp-mo" id="MJXp-Span-1459">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">j</span><span class="MJXp-mo" id="MJXp-Span-1461">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">a</span><span class="MJXp-mo" id="MJXp-Span-1464">(</span><span class="MJXp-msubsup" id="MJXp-Span-1465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1467" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1468">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">i</span><span class="MJXp-mo" id="MJXp-Span-1470">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1471">)</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1472" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1473">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1476" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1477">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">n</span><span class="MJXp-mo" id="MJXp-Span-1479">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1480">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1483" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1484">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">i</span><span class="MJXp-mo" id="MJXp-Span-1486">)</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1487" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1488">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1491" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1492">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">i</span><span class="MJXp-mo" id="MJXp-Span-1494">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1495">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1498" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1499">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">j</span><span class="MJXp-mo" id="MJXp-Span-1501">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">\frac{\partial u^{(n)}}{\partial u^{(j)}} = \sum_{i:j \in Pa(u^{(i)})} \frac{\partial u^{(n)}}{\partial u^{(i)}}\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> bằng các giá trị đã lưu:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1502"><span class="MJXp-mspace" id="MJXp-Span-1503" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mrow" id="MJXp-Span-1505"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1506">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1510" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1511">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">j</span><span class="MJXp-mo" id="MJXp-Span-1513">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1516"><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1518" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">i</span><span class="MJXp-mo" id="MJXp-Span-1520">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">j</span><span class="MJXp-mo" id="MJXp-Span-1522">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">a</span><span class="MJXp-mo" id="MJXp-Span-1525">(</span><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1528" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1529">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">i</span><span class="MJXp-mo" id="MJXp-Span-1531">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1532">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1533"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1534">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1538" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1539">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">i</span><span class="MJXp-mo" id="MJXp-Span-1541">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mfrac" id="MJXp-Span-1543" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1544">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1547" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1548">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">i</span><span class="MJXp-mo" id="MJXp-Span-1550">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1551">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1554" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1555">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">j</span><span class="MJXp-mo" id="MJXp-Span-1557">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">\texttt{grad_table}[u^{(j)}] \leftarrow  \sum_{i:j \in Pa(u^{(i)})}\texttt{grad_table}[u^{(i)}]\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span><br>
<strong>end for</strong><br>
<strong>return <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mrow" id="MJXp-Span-1560"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1561">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1565" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1566">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">j</span><span class="MJXp-mo" id="MJXp-Span-1568">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mspace" id="MJXp-Span-1570" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1571"><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-1573" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">i</span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1576">1</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1584" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">\{\texttt{grad_table}[u^{(j)}] \,| \,i = 1,...,n_i\}</script></span></strong></p><hr><p>---- DuyNht kết thúc dịch ở đây ----</p><p>---------------------------------------------<br>
---- SonAn bắt đầu dịch từ đây ---- 208-212</p><h2 id="654-Lan-truyền-ngược-trong-mạng-MLP-kết-nối-đầy-đủ">6.5.4 Lan truyền ngược trong mạng MLP kết nối đầy đủ</h2><p>Để làm rõ các định nghĩa về tính toán lan truyền ngược đề cập ở trên, ta xét một đồ thị cụ thể ứng với một mạng MLP kết nối đầy đủ.</p><p>Trước tiên, thuật toán 6.3 thực hiện lan truyền thuận, giúp ánh xạ các tham số đến hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">L</span><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1589"><span class="MJXp-munderover" id="MJXp-Span-1590"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1591">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1594">y</span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">L(\hat{\boldsymbol{y}},\boldsymbol{y})</script></span> gắn với một mẫu huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1596"><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1598">x</span><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1600">y</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">(\boldsymbol{x},\boldsymbol{y})</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1602"><span class="MJXp-mrow" id="MJXp-Span-1603"><span class="MJXp-munderover" id="MJXp-Span-1604"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1605">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\hat{\boldsymbol{y}}</script></span> là kết quả của mạng neuron ứng với đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1608">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">\boldsymbol{x}</script></span>.</p><p>Thuật toán 6.4 mô tả tính toán lan truyền ngược áp dụng cho đồ thị này.</p><p>Thuật toán 6.3 và 6.4 khá đơn giản và dễ hiểu, nhưng nó chỉ áp dụng cho một bài toán cụ thể và chỉ mang tính minh họa.</p><p>Ngày nay, các thực thi của phần mềm đều dựa trên dạng tổng quát của lan truyền ngược được mô tả trong phần 6.5.6 dưới đây, có thể đáp ứng bất kỳ đồ thị tính toán nào thông qua các thao tác rõ ràng với một cấu trúc dữ liệu biểu diễn các tính toán với ký hiệu (symbolic computation).</p><hr><p><strong>Thuật toán 6.3</strong> Lan truyền thuận qua một mạng neuron đa tầng và cách tính toán hàm mất mát. Hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">L</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1612"><span class="MJXp-munderover" id="MJXp-Span-1613"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1614">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1617">y</span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">L(\hat{\boldsymbol{y}},\boldsymbol{y})</script></span> phụ thuộc vào đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1619"><span class="MJXp-mrow" id="MJXp-Span-1620"><span class="MJXp-munderover" id="MJXp-Span-1621"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1622">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\hat{\boldsymbol{y}}</script></span> và nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1624"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1625">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\boldsymbol{y}</script></span> (xem ví dụ hàm mất mát trong chương 6.2.1.1). Để đạt được hàm chi phí tổng thể <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">J</script></span>, hàm mất mát có thể được cộng thêm vào một đại lượng kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1628"><span class="MJXp-mi" id="MJXp-Span-1629">Ω</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">θ</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">\Omega(\theta)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">\theta</script></span> chứa toàn bộ các tham số (các trọng số và hệ số tự do). Thuật toán 6.4 biểu diễn cách tính toán gradient của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">J</script></span> theo biến là các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1637"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1638">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">\boldsymbol{W}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1640">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">\boldsymbol{b}</script></span>. Để đơn giản, giải thuật minh họa này chỉ sử dụng một mẫu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1642">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">\boldsymbol{x}</script></span>. Còn trong các ứng dụng thực tế, ta nên sử dụng một lô nhỏ. Xem một giải thuật thực tế hơn trong phần 6.5.7.</p><hr><p><strong>Yêu cầu</strong>: Chiều sâu của mạng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">l</script></span><br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1645"><span class="MJXp-msubsup" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1647" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1648" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1649">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">i</span><span class="MJXp-mo" id="MJXp-Span-1651">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">i</span><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-1656">1</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">l</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">\boldsymbol{W}^{(i)}, i \in \{1,...,l\}</script></span>, ma trận trọng số của mô hình<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-msubsup" id="MJXp-Span-1665"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1666" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1667" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1668">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">i</span><span class="MJXp-mo" id="MJXp-Span-1670">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">i</span><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-1675">1</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">l</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">\boldsymbol{b}^{(i)}, i \in \{1,...,l\}</script></span>, ma trận hệ số tự do của mô hình<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1683"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1684">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">\boldsymbol{x}</script></span>, mẫu đầu vào<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1685"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1686">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">\boldsymbol{y}</script></span>, nhãn đầu ra<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1687"><span class="MJXp-msubsup" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1689" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1690" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1691">(</span><span class="MJXp-mn" id="MJXp-Span-1692">0</span><span class="MJXp-mo" id="MJXp-Span-1693">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1695">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\boldsymbol{h}^{(0)} = \boldsymbol{x}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1696"><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1698">for</span></span><span class="MJXp-mtext" id="MJXp-Span-1699">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">k</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1702">1</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">l</span><span class="MJXp-mtext" id="MJXp-Span-1709">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1710"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1711">do</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">\textbf{for}\space k = 1,...,l \space \textbf{do}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1712"><span class="MJXp-mspace" id="MJXp-Span-1713" style="width: 2.362em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1715" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1716" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1717">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">k</span><span class="MJXp-mo" id="MJXp-Span-1719">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1721"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1722" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1723" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1724">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">k</span><span class="MJXp-mo" id="MJXp-Span-1726">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1729" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1730" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1731">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">k</span><span class="MJXp-mo" id="MJXp-Span-1733">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1736" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1737">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">k</span><span class="MJXp-mo" id="MJXp-Span-1739">−</span><span class="MJXp-mn" id="MJXp-Span-1740">1</span><span class="MJXp-mo" id="MJXp-Span-1741">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">\hspace{1cm}\boldsymbol{a}^{(k)} = \boldsymbol{b}^{(k)} + \boldsymbol{W}^{(k)}\boldsymbol{h}^{(k-1)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1742"><span class="MJXp-mspace" id="MJXp-Span-1743" style="width: 2.362em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1744"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1745" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1746" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1747">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">k</span><span class="MJXp-mo" id="MJXp-Span-1749">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">f</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1754" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1755" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1756">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">k</span><span class="MJXp-mo" id="MJXp-Span-1758">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">\hspace{1cm}\boldsymbol{h}^{(k)} = f(\boldsymbol{a}^{(k)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1760"><span class="MJXp-mrow" id="MJXp-Span-1761"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1762">end for</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">\textbf{end for}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1763"><span class="MJXp-mrow" id="MJXp-Span-1764"><span class="MJXp-munderover" id="MJXp-Span-1765"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1766">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1771" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1772">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">l</span><span class="MJXp-mo" id="MJXp-Span-1774">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">\hat{\boldsymbol{y}}=\boldsymbol{h}^{(l)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">J</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">L</span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1780"><span class="MJXp-munderover" id="MJXp-Span-1781"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1783" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1782">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1785">y</span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">λ</span><span class="MJXp-mi" id="MJXp-Span-1789">Ω</span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">θ</span><span class="MJXp-mo" id="MJXp-Span-1792" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">J = L(\hat{\boldsymbol{y}},\boldsymbol{y})+\lambda\Omega(\theta)</script></span></p><hr><hr><p><strong>Thuật toán 6.4</strong> Tính ngược cho mạng neuron đa tầng trong thuật toán 6.3 ở trên, sử dụng đầu vào là cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1794">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">\boldsymbol{x}</script></span> lẫn nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1796">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">\boldsymbol{y}</script></span>. Thuật toán này tính các gradient của hàm kích hoạt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-msubsup" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1799" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1800" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1801">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">k</span><span class="MJXp-mo" id="MJXp-Span-1803">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">\boldsymbol a^{(k)}</script></span> trong mỗi tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">k</script></span>, bắt đầu từ tầng đầu ra và tính toán ngược về tầng ẩn đầu tiên. Từ các gradient, những giá trị có thể xem như là dấu hiệu cho biết đầu ra của mỗi tầng phải thay đổi thế nào để giảm sai số, ta có thể thu được các giá trị gradient theo các tham số của mỗi tầng. Gradient theo các trọng số và hệ số tự do có thể được sử dụng tức thì trong một bước cập nhật gradient ngẫu nhiên (thực hiện cập nhật ngay sau khi các giá trị gradient được tính) hoặc sử dụng với các phương pháp tối ưu dựa trên gradient khác.</p><hr><p>Sau bước lan truyền thuận, ta tính gradient của tầng đầu ra:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1806"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1807">g</span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1809"><span class="MJXp-mi" id="MJXp-Span-1810" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1811" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1812"><span class="MJXp-munderover" id="MJXp-Span-1813"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1814">y</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">J</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1818"><span class="MJXp-mi" id="MJXp-Span-1819" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1820" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1821"><span class="MJXp-munderover" id="MJXp-Span-1822"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1823">y</span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">L</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1827"><span class="MJXp-munderover" id="MJXp-Span-1828"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1829">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1832">y</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">\boldsymbol{g} \leftarrow \nabla_{\hat{\boldsymbol{y}}} J = \nabla_{\hat{\boldsymbol{y}}} L(\hat{\boldsymbol{y}},\boldsymbol{y})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1834"><span class="MJXp-mrow" id="MJXp-Span-1835"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1836">for</span></span><span class="MJXp-mspace" id="MJXp-Span-1837" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">k</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">l</span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">l</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1844">1</span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1850">1</span><span class="MJXp-mtext" id="MJXp-Span-1851">&nbsp;</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">\textbf{for}\, k = l, l-1, ...,1\space</script></span>   <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1852"><span class="MJXp-mrow" id="MJXp-Span-1853"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1854">do</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-201">\textbf{do}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mspace" id="MJXp-Span-1856" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">\hspace{10mm}</script></span>Chuyển đổi gradient ở đầu ra của tầng thành một gradient của phần trước hàm kích hoạt<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mspace" id="MJXp-Span-1858" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">\hspace{10mm}</script></span>phi tuyến (là tích của phép nhân theo từng phần tử nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">f</script></span> là hàm theo từng phần tử):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-mspace" id="MJXp-Span-1862" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1863"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1864">g</span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1866"><span class="MJXp-mi" id="MJXp-Span-1867" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1868" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1869"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1870" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1871" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1872">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">k</span><span class="MJXp-mo" id="MJXp-Span-1874">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">J</span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1877">g</span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-msubsup" id="MJXp-Span-1879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1881" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1882"><span class="MJXp-mi" id="MJXp-Span-1883" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1884" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1885" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1887" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1888" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1889">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">k</span><span class="MJXp-mo" id="MJXp-Span-1891">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">\boldsymbol{g} \leftarrow \nabla_{\boldsymbol a^{(k)}} J = \boldsymbol{g}\odot f^{'}(\boldsymbol{a}^{(k)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1893"><span class="MJXp-mspace" id="MJXp-Span-1894" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">\hspace{10mm}</script></span>Tính gradient đối với các trọng số và hệ số tự do (bao gồm cả số hạng kiểm soát nếu cần):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1895"><span class="MJXp-mspace" id="MJXp-Span-1896" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi" id="MJXp-Span-1899" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1901"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1902" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1903" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1904">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">k</span><span class="MJXp-mo" id="MJXp-Span-1906">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">J</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1909">g</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">λ</span><span class="MJXp-msubsup" id="MJXp-Span-1912"><span class="MJXp-mi" id="MJXp-Span-1913" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1914" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1915"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1916" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1917" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1918">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">k</span><span class="MJXp-mo" id="MJXp-Span-1920">)</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-1921">Ω</span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">θ</span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">\nabla_{\boldsymbol{b}^{(k)}}J = \boldsymbol{g}+\lambda\nabla_{\boldsymbol{b}^{(k)}}\Omega(\theta)</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1925"><span class="MJXp-mspace" id="MJXp-Span-1926" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1927"><span class="MJXp-msubsup" id="MJXp-Span-1928"><span class="MJXp-mi" id="MJXp-Span-1929" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1930" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1931"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1932" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1933" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1934">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">k</span><span class="MJXp-mo" id="MJXp-Span-1936">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">J</span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1939">g</span><span class="MJXp-mspace" id="MJXp-Span-1940" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1942" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1943" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1944">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">k</span><span class="MJXp-mo" id="MJXp-Span-1946">−</span><span class="MJXp-mn" id="MJXp-Span-1947">1</span><span class="MJXp-mo" id="MJXp-Span-1948">)</span><span class="MJXp-mi" id="MJXp-Span-1949">⊤</span></span></span><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">λ</span><span class="MJXp-msubsup" id="MJXp-Span-1952"><span class="MJXp-mi" id="MJXp-Span-1953" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1954" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1955"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1956" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1957" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1958">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">k</span><span class="MJXp-mo" id="MJXp-Span-1960">)</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-1961">Ω</span><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">θ</span><span class="MJXp-mo" id="MJXp-Span-1964" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">\nabla_{\boldsymbol{W}^{(k)}}J = \boldsymbol{g}\,\boldsymbol{h}^{(k-1)\top}+\lambda\nabla_{\boldsymbol{W}^{(k)}}\Omega(\theta)</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1965"><span class="MJXp-mspace" id="MJXp-Span-1966" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">\hspace{10mm}</script></span>Tiếp tục tính gradient cho hàm kích hoạt của các tầng ẩn bậc thấp hơn nằm trước tầng hiện tại:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1967"><span class="MJXp-mspace" id="MJXp-Span-1968" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1969"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1970">g</span><span class="MJXp-mo" id="MJXp-Span-1971" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1972"><span class="MJXp-mi" id="MJXp-Span-1973" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1974" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1975"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1976" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1977" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1978">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">k</span><span class="MJXp-mo" id="MJXp-Span-1980">−</span><span class="MJXp-mn" id="MJXp-Span-1981">1</span><span class="MJXp-mo" id="MJXp-Span-1982">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">J</span><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1985"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1986" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1987" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1988">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">k</span><span class="MJXp-mo" id="MJXp-Span-1990">)</span><span class="MJXp-mi" id="MJXp-Span-1991">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1992">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">\boldsymbol{g} \leftarrow \nabla_{\boldsymbol{h}^{(k-1)}} J = \boldsymbol{W}^{(k)\top}\boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1993"><span class="MJXp-mrow" id="MJXp-Span-1994"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1995">end for</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">\textbf{end for}</script></span></p><hr><h2 id="655-Đạo-hàm-dạng-kí-hiệu-kí-hiệu">6.5.5 Đạo hàm dạng kí hiệu-kí hiệu</h2><p>Các biểu thức đại số và đồ thị tính toán đều hoạt động với các <em>kí hiệu</em> (symbol), hoặc các biến không có giá trị cụ thể. Các biểu diễn đại số và biểu diễn dựa trên đồ thị được gọi là <em>biểu diễn dạng kí hiệu</em> (symbolic representation). Khi thực sự sử dụng hoặc huấn luyện một mạng neuron, chúng ta phải khai báo các giá trị cụ thể cho các kí hiệu này. Ta thay thế một đầu vào dạng ký hiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1996"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1997">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">\boldsymbol{x}</script></span> của mạng bằng một giá trị <em>số</em> (numeric) cụ thể, chẳng hạn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1998"><span class="MJXp-mo" id="MJXp-Span-1999" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2000">1.2</span><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2002">3.765</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2005">1.8</span><span class="MJXp-msubsup" id="MJXp-Span-2006"><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2008" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">[1.2,3.765,-1.8]^\top</script></span>.</p><p>Một vài hướng tiếp cận để tính lan truyền ngược sử dụng một đồ thị tính toán và một tập đầu vào có các giá trị cụ thể, sau đó nó sẽ trả về tập giá trị của gradient tìm được tương ứng với đầu vào. Chúng ta gọi hướng tiếp cận này là <em>phép tính đạo hàm ký hiệu-số</em> (symbol-to-number differentiation). Đây là phương pháp được sử dụng bởi các thư viện như Torch [Collobert et al., 2011b] và Caffe [Jia, 2013].</p><p>Một phương pháp khác là dùng một đồ thị tính toán và thêm vào các nút phụ cho đồ thị. Các nút này cung cấp một mô tả dạng kí hiệu cho đạo hàm cần tính. Phương pháp này được sử dụng bởi các thư viện như Theano [Bergstra et al., 2010; Bastien et al., 2012] và Tensorflow [Abadi et al., 2015]. Hình 6.10 minh họa một ví dụ cụ thể của phương pháp này. Ưu điểm chính của hướng tiếp cận này là các đạo hàm được mô tả đúng với dạng biểu thức toán học của nó. Bởi các đạo hàm chỉ là một đồ thị tính toán khác, ta có thể chạy lại thuật toán lan truyền ngược, tính đạo hàm của các đạo hàm này để thu được các đạo hàm bậc cao hơn.  (Việc tính toán các đạo hàm bậc cao hơn được mô tả trong phần 6.5.10.)</p><p><img src="https://i.imgur.com/iBnjPOs.png" alt=""></p><blockquote>
<p>Hình 6.10: Một ví dụ về phương pháp tính toán đạo hàm dưới dạng ký hiệu-ký hiệu (symbol-to-symbol). Trong phương pháp này, ta không cần đưa bất kỳ giá trị số cụ thể nào vào thuật toán lan truyền ngược. Thay vào đó, nó sẽ thêm nút vào đồ thị tính toán mô tả cách tính đạo hàm. Sau đó, ta sử dụng một công cụ chung sử dụng trên đồ thị để tính đạo hàm của bất kỳ đầu vào cụ thể nào. (<em>Hình trái</em>) Trong ví dụ này, ta bắt đầu với một đồ thị biểu diễn hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">z</span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">f</span><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">f</span><span class="MJXp-mo" id="MJXp-Span-2015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">f</span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">w</span><span class="MJXp-mo" id="MJXp-Span-2019" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2020" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">z=f(f(f(w)))</script></span>. (<em>Hình phải</em>) Chạy thuật toán lan truyền ngược, xây dựng đồ thị tính toán tương ứng với quá trình tính đạo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2022"><span class="MJXp-mfrac" id="MJXp-Span-2023" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">w</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\frac{dz}{dw}</script></span>. Trong ví dụ này, chúng tôi không giải thích cách hoạt động của thuật toán lan truyền ngược. Mục đích của ví dụ này chỉ nhằm minh họa kết quả mong muốn: một đồ thị tính toán với một mô tả của đạo hàm dưới dạng ký hiệu.</p>
</blockquote><p>Chúng tôi sẽ sử dụng phương pháp thứ hai để tiếp cận và mô tả thuật toán lan truyền ngược khi xây dựng đồ thị tính toán đạo hàm. Bất kỳ một nhánh con nào trong đồ thị đều có thể được tính bằng cách đưa vào các giá trị số cụ thể khi tính toán. Điều này cho phép chúng ta tránh việc phải xác định chính xác khi nào ta cần phải tính toán các giá trị. Thay vào đó, ta chỉ cần một công cụ tính chung bằng đồ thị để tính giá trị của mỗi nút con ngay sau khi xác định nút cha của nó.</p><p>Mô tả của phương pháp tính toán dạng ký hiệu-ký hiệu đã bao gồm cả mô tả của phương pháp ký hiệu-số. Ta có thể hiểu phương pháp ký hiệu-số giống như việc thực hiện chính xác các phép toán trong đồ thị xây dựng bởi phương pháp dạng ký hiệu-ký hiệu. Khác biệt chính đó là phương pháp ký hiệu-số không đưa ra đồ thị.</p><h2 id="656-Lan-truyền-ngược-tổng-quát">6.5.6 Lan truyền ngược tổng quát</h2><p>Thuật toán lan truyền ngược rất đơn giản. Để tính toán gradient của một giá trị vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">z</script></span> theo một nút <em>tổ tiên</em> (ancestor) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2030"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2031">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">\boldsymbol{x}</script></span> bất kỳ của nó trong đồ thị, ta có thể bắt đầu từ gradient của nó theo chính nó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2032"><span class="MJXp-mfrac" id="MJXp-Span-2033" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">z</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">z</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2039">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">\frac{dz}{dz}=1</script></span>. Sau đó, ta có thể tính toán gradient theo mỗi nút <em>cha</em> (parent) của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">z</script></span> trong đồ thị bằng cách nhân giá trị gradient hiện tại với ma trận Jacobi của phép toán sinh ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">z</script></span> trong mô hình. Chúng ta cứ tiếp tục nhân các ma trận Jacobi tìm được ngược về phía trước của đồ thị theo cách này cho đến khi tới được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2045">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">\boldsymbol x</script></span>. Với các nút có thể tới được thông qua từ hai đường đi trở lên trong quá trình tính toán ngược từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">z</script></span>, ta chỉ cần cộng gradient đến từ các đường đi khác nhau đó lại.</p><p>Nói một cách chặt chẽ hơn, mỗi nút trong đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2048"><span class="MJXp-mrow" id="MJXp-Span-2049"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2050">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\mathcal{G}</script></span> tương ứng với một biến. Để đạt được tính tổng quát tối đa, chúng tôi biểu diễn biến dưới dạng một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2051"><span class="MJXp-mrow" id="MJXp-Span-2052"><span class="MJXp-mi undefined" id="MJXp-Span-2053">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">\boldsymbol{\mathsf{V}}</script></span>. Tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2054"><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mi undefined" id="MJXp-Span-2056">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">\boldsymbol{\mathsf{V}}</script></span> nói chung có kích thước bất kì. Chúng có thể là các đại lượng vô hướng, vector hay ma trận.</p><p>Giả sử mỗi biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2057"><span class="MJXp-mrow" id="MJXp-Span-2058"><span class="MJXp-mi undefined" id="MJXp-Span-2059">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">\boldsymbol{\mathsf{V}}</script></span> đươc gắn với các hàm con sau:</p><ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2060"><span class="MJXp-mrow" id="MJXp-Span-2061"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2062">get_operation</span></span><span class="MJXp-mo" id="MJXp-Span-2063" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2064"><span class="MJXp-mi undefined" id="MJXp-Span-2065">V</span></span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">\texttt{get_operation}(\boldsymbol{\mathsf{V}})</script></span>: Hàm này trả về phép toán tính giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2067"><span class="MJXp-mrow" id="MJXp-Span-2068"><span class="MJXp-mi undefined" id="MJXp-Span-2069">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">\boldsymbol{\mathsf{V}}</script></span>, được biểu diễn bằng các cạnh đi tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2070"><span class="MJXp-mrow" id="MJXp-Span-2071"><span class="MJXp-mi undefined" id="MJXp-Span-2072">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">\boldsymbol{\mathsf{V}}</script></span> trong đồ thị tính toán. Ví dụ, ta có thể biểu diễn phép nhân ma trận và hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2073"><span class="MJXp-mrow" id="MJXp-Span-2074"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2075">get_operation</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">\texttt{get_operation}</script></span> dưới dạng một class trong Python hoặc C++. Giả sử chúng ta có một biến được tạo thành bởi phép nhân ma trận, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2077">C</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2078" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2079">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2080">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">\boldsymbol{C = AB}</script></span>. Hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2081"><span class="MJXp-mrow" id="MJXp-Span-2082"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2083">get_operation</span></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2085"><span class="MJXp-mi undefined" id="MJXp-Span-2086">V</span></span><span class="MJXp-mo" id="MJXp-Span-2087" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">\texttt{get_operation}(\boldsymbol{\mathsf{V}})</script></span> sau đó sẽ trả về một con trỏ trỏ đến một đối tượng của class C++ tương ứng với phép nhân hai ma trận.</li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2088"><span class="MJXp-mrow" id="MJXp-Span-2089"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2090">get_consumers</span></span><span class="MJXp-mo" id="MJXp-Span-2091" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2092"><span class="MJXp-mi undefined" id="MJXp-Span-2093">V</span></span><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2095"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2096">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">\texttt{get_consumers}(\boldsymbol{\mathsf{V}}, \mathcal{G}</script></span>): Hàm này trả về danh sách các biến là con của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2097"><span class="MJXp-mrow" id="MJXp-Span-2098"><span class="MJXp-mi undefined" id="MJXp-Span-2099">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">\boldsymbol{\mathsf{V}}</script></span> trong đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2100"><span class="MJXp-mrow" id="MJXp-Span-2101"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2102">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">\mathcal{G}</script></span>.</li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2103"><span class="MJXp-mrow" id="MJXp-Span-2104"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2105">get_inputs</span></span><span class="MJXp-mo" id="MJXp-Span-2106" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2107"><span class="MJXp-mi undefined" id="MJXp-Span-2108">V</span></span><span class="MJXp-mo" id="MJXp-Span-2109" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2110"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2111">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">\texttt{get_inputs}(\boldsymbol{\mathsf{V}}, \mathcal{G}</script></span>): Hàm này trả về danh sách các biến là cha của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2112"><span class="MJXp-mrow" id="MJXp-Span-2113"><span class="MJXp-mi undefined" id="MJXp-Span-2114">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\boldsymbol{\mathsf{V}}</script></span> trong đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2115"><span class="MJXp-mrow" id="MJXp-Span-2116"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2117">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\mathcal{G}</script></span>.</li>
</ul><p>Mỗi phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2118"><span class="MJXp-mrow" id="MJXp-Span-2119"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2120">op</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">\texttt{op}</script></span> cũng gắn với một phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2121"><span class="MJXp-mrow" id="MJXp-Span-2122"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2123">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">\texttt{bprop}</script></span>. Phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2124"><span class="MJXp-mrow" id="MJXp-Span-2125"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2126">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">\texttt{bprop}</script></span> này tính toán tích giữa một ma trân Jacobi với một vector như được mô tả trong công thức 6.47. Đây là lý do mà thuật toán lan truyền ngược đạt được tính tổng quát cao. Mỗi phép toán cần phải biết cách lan truyền ngược qua các cạnh của đồ thị tham gia vào phép toán đó. Ví dụ, ta có thể sử dụng phép toán nhân ma trận để tạo ra biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2127"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2128">C</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-2129" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2130">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2131">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">\boldsymbol{C = AB}</script></span>. Giả sử rằng gradient của một đại lượng vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">z</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2134"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2135">C</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">\boldsymbol{C}</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2136"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2137">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">\boldsymbol{G}</script></span>. Theo đó, phép toán nhân ma trận phải xác định được hai quy tắc lan truyền ngược, mỗi quy tắc tương ứng với một đối số. Nếu ta sử dụng phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2138"><span class="MJXp-mrow" id="MJXp-Span-2139"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2140">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">\texttt{bprop}</script></span> để tính gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2141"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2142">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">\boldsymbol{A}</script></span> khi đã biết giá trị gradient tại đầu ra là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2143"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2144">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">\boldsymbol{G}</script></span>, thì phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2145"><span class="MJXp-mrow" id="MJXp-Span-2146"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2147">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">\texttt{bprop}</script></span> gắn với phép toán nhân ma trận phải cho ra kết quả là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2148"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2149">G</span><span class="MJXp-msubsup" id="MJXp-Span-2150"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2151" style="margin-right: 0.05em;">B</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2152" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2153">⊤</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">\boldsymbol{GB^{\top}}</script></span>. Tương tự như vậy, nếu dùng phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2154"><span class="MJXp-mrow" id="MJXp-Span-2155"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2156">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">\texttt{bprop}</script></span> tính gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2157"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2158">B</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">\boldsymbol{B}</script></span>, với giá trị gradient tại đầu ra là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2159"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2160">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">\boldsymbol{G}</script></span>, thì phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2161"><span class="MJXp-mrow" id="MJXp-Span-2162"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2163">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">\texttt{bprop}</script></span> gắn với phép nhân ma trận phải trả về kết quả là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2164"><span class="MJXp-msubsup" id="MJXp-Span-2165"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2166" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2167" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2168">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2169">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">\boldsymbol{A^{\top}G}</script></span>. Bản thân thuật toán lan truyền ngược không cần hiểu đạo hàm được tính như thế nào. Nó chỉ cần gọi phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2170"><span class="MJXp-mrow" id="MJXp-Span-2171"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2172">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">\texttt{bprop}</script></span> với các đối số đầu vào phù hợp. Về mặt toán học, kết quả của phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2173"><span class="MJXp-mrow" id="MJXp-Span-2174"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2175">op.bprop</span></span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2177"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2178">inputs</span></span><span class="MJXp-mo" id="MJXp-Span-2179" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2180"><span class="MJXp-mi undefined" id="MJXp-Span-2181">X</span></span><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2183"><span class="MJXp-mi undefined" id="MJXp-Span-2184">G</span></span><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">\texttt{op.bprop}(\texttt{inputs}, \boldsymbol{\mathsf{X}}, \boldsymbol{\mathsf{G}})</script></span> phải trả về kết quả:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2186"><span class="MJXp-mtable" id="MJXp-Span-2187"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2188" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2189" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-2190"><span><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2192" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2194" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2195"><span class="MJXp-mi" id="MJXp-Span-2196" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2197" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2198"><span class="MJXp-mi undefined" id="MJXp-Span-2199">X</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2200"><span class="MJXp-mrow" id="MJXp-Span-2201" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2202">op.f(inputs)</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2203" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2204" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-2205" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2208" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-262">\begin{align}
\sum_{i}(\nabla_{\boldsymbol{\mathsf{X}}}\texttt{op.f(inputs)}_i)\,G_i.
\tag{6.54}
\end{align}</script></span></p><p>Đây là chỉ là một cách thực thi dựa trên quy tắc đạo hàm của hàm hợp được mô tả trong phương trình 6.47. Ở đây, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2210"><span class="MJXp-mrow" id="MJXp-Span-2211"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2212">inputs</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">\texttt{inputs}</script></span> là danh sách đầu vào của phép toán, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2213"><span class="MJXp-mrow" id="MJXp-Span-2214"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2215">op.f</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">\texttt{op.f}</script></span> là hàm toán học thực hiện phép toán, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2216"><span class="MJXp-mrow" id="MJXp-Span-2217"><span class="MJXp-mi undefined" id="MJXp-Span-2218">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-265">\boldsymbol{\mathsf{X}}</script></span> là đầu vào mà ta muốn tính gradient cho nó, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2219"><span class="MJXp-mrow" id="MJXp-Span-2220"><span class="MJXp-mi undefined" id="MJXp-Span-2221">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">\boldsymbol{\mathsf{G}}</script></span> là gradient ở đầu ra của phép toán.</p><p>Phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2222"><span class="MJXp-mrow" id="MJXp-Span-2223"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2224">op.bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">\texttt{op.bprop}</script></span> luôn coi các tham số đầu vào của nó đôi một khác nhau, ngay cả khi chúng là giống nhau. Chẳng hạn, nếu toán tử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2225"><span class="MJXp-mrow" id="MJXp-Span-2226"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2227">mul</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-268-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-268">\texttt{mul}</script></span> được đưa vào tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2228"><span class="MJXp-msubsup" id="MJXp-Span-2229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2231" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-269">x^2</script></span> từ hai biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-270">x</script></span>, phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2234"><span class="MJXp-mrow" id="MJXp-Span-2235"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2236">op.bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-271">\texttt{op.bprop}</script></span> sẽ vẫn trả về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-272">x</script></span> khi tính đạo hàm theo hai tham số đầu vào. Thuật toán lan truyền ngược sau đó cộng hai giá trị này với nhau để thu được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2239"><span class="MJXp-mn" id="MJXp-Span-2240">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-273-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-273">2x</script></span> - giá trị đạo hàm chính xác theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-274">x</script></span>.</p><p>Các thực thi phần mềm của thuật toán lan truyền ngược luôn luôn cung cấp các phép toán và phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2244"><span class="MJXp-mrow" id="MJXp-Span-2245"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2246">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-275-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-275">\texttt{bprop}</script></span> tương ứng, để người sử dụng các thư viện học sâu có thể tính lan truyền ngược trong các đồ thị thông qua các phép toán cơ bản của ma trận như phép nhân ma trận, lũy thừa, logarit v.v. Những lập trình viên muốn cài đặt một thuật toán tính lan truyền ngược mới hoặc những người dùng chuyên sâu muốn tự thêm vào thư viện sẵn có các phép toán do họ tự phát triển đều phải tự xây dựng phương thức <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2247"><span class="MJXp-mrow" id="MJXp-Span-2248"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2249">op.bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-276">\texttt{op.bprop}</script></span> tương ứng cho mỗi phép toán.</p><p>Thuật toán lan truyền ngược được mô tả một cách toán học trong thuật toán 6.5.</p><p>---- Thomas Nguyen bắt đầu dịch từ đây ----</p><hr><p><strong>Thuật toán 6.5</strong> Khung ngoài cùng của thuật toán lan truyền ngược. Phần này mô tả các thiết lập và hoạt động đơn giản của thuật toán. Hầu hết các hoạt động quan trọng được mô tả trong thủ tục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2250"><span class="MJXp-mrow" id="MJXp-Span-2251"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2252">build_grad</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-277">\texttt{build_grad}</script></span> của thuật toán.</p><hr><p><strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2253"><span class="MJXp-mrow" id="MJXp-Span-2254"><span class="MJXp-mi undefined" id="MJXp-Span-2255">T</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-278">\mathbb{T}</script></span>, danh sách các biến mà ta cần tính gradient theo chúng<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2256"><span class="MJXp-mrow" id="MJXp-Span-2257"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2258">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-279-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-279">\mathcal{G}</script></span>, đồ thị tính toán<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-280">z</script></span>, biến cần tính đạo hàm<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2261"><span class="MJXp-mspace" id="MJXp-Span-2262" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-281">\hspace{10mm}</script></span>Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2263"><span class="MJXp-mrow" id="MJXp-Span-2264"><span class="MJXp-msubsup" id="MJXp-Span-2265"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2266" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2267" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2268"><span class="MJXp-mi" id="MJXp-Span-2269" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2270" style="vertical-align: 0.4em;">′</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-282">\mathcal{G^{'}}</script></span> là đồ thị con của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2271"><span class="MJXp-mrow" id="MJXp-Span-2272"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2273">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-283">\mathcal{G}</script></span> chỉ chứa các nút tổ tiên của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-284-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-284">z</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2276"><span class="MJXp-mspace" id="MJXp-Span-2277" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-285">\hspace{10mm}</script></span>và con cháu của các nút trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-mrow" id="MJXp-Span-2279"><span class="MJXp-mi undefined" id="MJXp-Span-2280">T</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-286">\mathbb{T}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2281"><span class="MJXp-mspace" id="MJXp-Span-2282" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-287">\hspace{10mm}</script></span>Khởi tạo grad_table, một cấu trúc dữ liệu gắn mỗi tensor với giá trị gradient của nó<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2283"><span class="MJXp-mspace" id="MJXp-Span-2284" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-288">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-mrow" id="MJXp-Span-2286"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2287">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-2288" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">z</span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mn" id="MJXp-Span-2292">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-289">\texttt{grad_table}[z] \leftarrow 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2293"><span class="MJXp-mspace" id="MJXp-Span-2294" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-290">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2295"><span class="MJXp-mrow" id="MJXp-Span-2296"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2297">for</span></span><span class="MJXp-mtext" id="MJXp-Span-2298">&nbsp;</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-291">\textbf{for}\space</script></span>  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2299"><span class="MJXp-mrow" id="MJXp-Span-2300"><span class="MJXp-mi undefined" id="MJXp-Span-2301">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-292">\boldsymbol{\mathsf{V}}</script></span> in <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2302"><span class="MJXp-mrow" id="MJXp-Span-2303"><span class="MJXp-mi undefined" id="MJXp-Span-2304">T</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-293">\mathbb{T}</script></span>   <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2305"><span class="MJXp-mrow" id="MJXp-Span-2306"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2307">do</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-294">\textbf{do}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2308"><span class="MJXp-mspace" id="MJXp-Span-2309" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-295-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-295">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2310"><span class="MJXp-mspace" id="MJXp-Span-2311" style="width: 2.362em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2312"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2313">build_grad</span></span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2315"><span class="MJXp-mi undefined" id="MJXp-Span-2316">V</span></span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2319">G</span></span><span class="MJXp-mo" id="MJXp-Span-2320" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2321"><span class="MJXp-msubsup" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2323" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2324" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2325"><span class="MJXp-mi" id="MJXp-Span-2326" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2327" style="vertical-align: 0.4em;">′</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2329"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2330">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-296">\hspace{10mm}\texttt{build_grad}(\boldsymbol{\mathsf{V}},\mathcal{G},\mathcal{G^{'}}, \texttt{grad_table})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2332"><span class="MJXp-mspace" id="MJXp-Span-2333" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-297">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mrow" id="MJXp-Span-2335"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2336">end for</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-298">\textbf{end for}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2337"><span class="MJXp-mspace" id="MJXp-Span-2338" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-299">\hspace{10mm}</script></span>Trả về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-mrow" id="MJXp-Span-2340"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2341">grad_table</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-300">\texttt{grad_table}</script></span> chỉ chứa các giá trị ứng với các nút trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2342"><span class="MJXp-mrow" id="MJXp-Span-2343"><span class="MJXp-mi undefined" id="MJXp-Span-2344">T</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-301">\mathbb{T}</script></span></p><hr><hr><p><strong>Thuật toán 6.6</strong> Thủ tục lặp con <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2345"><span class="MJXp-mrow" id="MJXp-Span-2346"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2347">build_grad</span></span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2349"><span class="MJXp-mi undefined" id="MJXp-Span-2350">V</span></span><span class="MJXp-mo" id="MJXp-Span-2351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2352"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2353">G</span></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2355"><span class="MJXp-msubsup" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2357" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2358" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2359"><span class="MJXp-mi" id="MJXp-Span-2360" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2361" style="vertical-align: 0.4em;">′</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2362" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2363"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2364">build_grad</span></span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-302">\texttt{build_grad}(\boldsymbol{\mathsf{V}},\mathcal{G},\mathcal{G^{'}}, \texttt{build_grad})</script></span> của thuật toán lan truyền ngược được gọi trong thuật toán 6.5.</p><hr><p><strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2366"><span class="MJXp-mrow" id="MJXp-Span-2367"><span class="MJXp-mi undefined" id="MJXp-Span-2368">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-303">\boldsymbol{\mathsf{V}}</script></span>, biến có gradient được thêm vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2369"><span class="MJXp-mrow" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2371">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-304">\mathcal{G}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mrow" id="MJXp-Span-2373"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2374">grad_table</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-305">\texttt{grad_table}</script></span><br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2375"><span class="MJXp-mrow" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2377">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-306">\mathcal{G}</script></span>, đồ thị cần điều chỉnh<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mrow" id="MJXp-Span-2379"><span class="MJXp-msubsup" id="MJXp-Span-2380"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2381" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2382" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2383"><span class="MJXp-mi" id="MJXp-Span-2384" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2385" style="vertical-align: 0.4em;">′</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-307">\mathcal{G^{'}}</script></span>, đồ thị con của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-mrow" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2388">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-308">\mathcal{G}</script></span> chỉ chứa các nút tham gia vào tính toán gradient.<br>
<strong>Yêu cầu</strong>: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2389"><span class="MJXp-mrow" id="MJXp-Span-2390"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2391">grad_table</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-309-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-309">\texttt{grad_table}</script></span>, cấu trúc dữ liệu ánh xạ các nút đến các gradient của nó<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2392"><span class="MJXp-mspace" id="MJXp-Span-2393" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-310-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-310">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2394"><span class="MJXp-mrow" id="MJXp-Span-2395"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2396">if&nbsp;</span></span><span class="MJXp-mspace" id="MJXp-Span-2397" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2398"><span class="MJXp-mi undefined" id="MJXp-Span-2399">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-311-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-311">\textbf{if } \,\boldsymbol{\mathsf{V}}</script></span> is in <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2400"><span class="MJXp-mrow" id="MJXp-Span-2401"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2402">grad_table</span></span><span class="MJXp-mspace" id="MJXp-Span-2403" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2404"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2405">then</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-312">\texttt{grad_table}\, \textbf{then}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2406"><span class="MJXp-mspace" id="MJXp-Span-2407" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-313">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2408"><span class="MJXp-mspace" id="MJXp-Span-2409" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-314">\hspace{10mm}</script></span>Return <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2410"><span class="MJXp-mrow" id="MJXp-Span-2411"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2412">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-2413" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-2414"><span class="MJXp-mi undefined" id="MJXp-Span-2415">V</span></span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-315-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-315">\texttt{grad_table}[\boldsymbol{\mathsf{V}}]</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mspace" id="MJXp-Span-2418" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-316">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2419"><span class="MJXp-mrow" id="MJXp-Span-2420"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2421">end if</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-317">\textbf{end if}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2422"><span class="MJXp-mspace" id="MJXp-Span-2423" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-318">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">i</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mn" id="MJXp-Span-2427">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-319">i \leftarrow 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2428"><span class="MJXp-mspace" id="MJXp-Span-2429" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-320-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-320">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2430"><span class="MJXp-mrow" id="MJXp-Span-2431"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2432">for&nbsp;</span></span><span class="MJXp-mspace" id="MJXp-Span-2433" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-2435">C</span></span><span class="MJXp-mspace" id="MJXp-Span-2436" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2437">&nbsp;in&nbsp;</span><span class="MJXp-mspace" id="MJXp-Span-2438" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2439"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2440">get_consumers</span></span><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2442"><span class="MJXp-mi undefined" id="MJXp-Span-2443">V</span></span><span class="MJXp-mo" id="MJXp-Span-2444" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2445"><span class="MJXp-mrow" id="MJXp-Span-2446" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2447">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2448" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2449"><span class="MJXp-mi" id="MJXp-Span-2450" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2451" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-2453" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2454"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2455">do</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-321-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-321">\textbf{for }\, \mathsf{C}\, \text{ in }\, \texttt{get_consumers}(\boldsymbol{\mathsf{V}}, \mathcal{G}^{'})\, \textbf{do}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2456"><span class="MJXp-mspace" id="MJXp-Span-2457" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-322-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-322">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-mspace" id="MJXp-Span-2459" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-323-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-323">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-mrow" id="MJXp-Span-2461"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2462">op</span></span><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mrow" id="MJXp-Span-2464"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2465">get_operation</span></span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2467"><span class="MJXp-mi undefined" id="MJXp-Span-2468">C</span></span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-324-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-324">\texttt{op} \leftarrow \texttt{get_operation}(\boldsymbol{\mathsf{C}})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2470"><span class="MJXp-mspace" id="MJXp-Span-2471" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-325-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-325">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2472"><span class="MJXp-mspace" id="MJXp-Span-2473" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-326-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-326">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2474"><span class="MJXp-mrow" id="MJXp-Span-2475"><span class="MJXp-mi undefined" id="MJXp-Span-2476">D</span></span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mrow" id="MJXp-Span-2478"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2479">build_grad</span></span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2481"><span class="MJXp-mi undefined" id="MJXp-Span-2482">C</span></span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2485">G</span></span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2487"><span class="MJXp-msubsup" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2489" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2490" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2491"><span class="MJXp-mi" id="MJXp-Span-2492" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2493" style="vertical-align: 0.4em;">′</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2495"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2496">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-327-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-327">\boldsymbol{\mathsf{D}} \leftarrow \texttt{build_grad}(\boldsymbol{\mathsf{C}},\mathcal{G}, \mathcal{G^{'}},\texttt{grad_table})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2498"><span class="MJXp-mspace" id="MJXp-Span-2499" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-328-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-328">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2500"><span class="MJXp-mspace" id="MJXp-Span-2501" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-329-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-329">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2502"><span class="MJXp-msubsup" id="MJXp-Span-2503"><span class="MJXp-mrow" id="MJXp-Span-2504" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2505">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2506" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2507">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">i</span><span class="MJXp-mo" id="MJXp-Span-2509">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mrow" id="MJXp-Span-2511"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2512">op.bprop</span></span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2514"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2515">get_inputs</span></span><span class="MJXp-mo" id="MJXp-Span-2516" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2517"><span class="MJXp-mi undefined" id="MJXp-Span-2518">C</span></span><span class="MJXp-mo" id="MJXp-Span-2519" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2520"><span class="MJXp-mrow" id="MJXp-Span-2521" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2522">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2523" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2524"><span class="MJXp-mi" id="MJXp-Span-2525" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2526" style="vertical-align: 0.4em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2529"><span class="MJXp-mi undefined" id="MJXp-Span-2530">V</span></span><span class="MJXp-mo" id="MJXp-Span-2531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-2532"><span class="MJXp-mi undefined" id="MJXp-Span-2533">D</span></span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-330-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-330">\boldsymbol{\mathsf{G}}^{(i)} \leftarrow \texttt{op.bprop}(\texttt{get_inputs}(\boldsymbol{\mathsf{C}},\mathcal{G}^{'}), \boldsymbol{\mathsf{V}}, \boldsymbol{\mathsf{D}})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2535"><span class="MJXp-mspace" id="MJXp-Span-2536" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-331-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-331">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2537"><span class="MJXp-mspace" id="MJXp-Span-2538" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-332-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-332">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-333-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-333">i</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2541"><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0.333em; margin-right: 0.333em;">←</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-334-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-334">\leftarrow</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">i</span><span class="MJXp-mo" id="MJXp-Span-2545" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2546">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-335-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-335">i + 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-mspace" id="MJXp-Span-2548" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-336-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-336">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2549"><span class="MJXp-mrow" id="MJXp-Span-2550"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2551">end for</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-337-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-337">\textbf{end for}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2552"><span class="MJXp-mspace" id="MJXp-Span-2553" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-338-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-338">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2554"><span class="MJXp-mrow" id="MJXp-Span-2555"><span class="MJXp-mi undefined" id="MJXp-Span-2556">G</span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-2558"><span class="MJXp-mo" id="MJXp-Span-2559" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2560" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-2561"><span class="MJXp-mrow" id="MJXp-Span-2562" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2563">G</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2564" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2565">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566">i</span><span class="MJXp-mo" id="MJXp-Span-2567">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-339-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-339">\boldsymbol{\mathsf{G}} \leftarrow \sum _i\boldsymbol{\mathsf{G}}^{(i)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2568"><span class="MJXp-mspace" id="MJXp-Span-2569" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-340-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-340">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2570"><span class="MJXp-mrow" id="MJXp-Span-2571"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2572">grad_table</span></span><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-2574"><span class="MJXp-mi undefined" id="MJXp-Span-2575">V</span></span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2578"><span class="MJXp-mi undefined" id="MJXp-Span-2579">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-341-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-341">\texttt{grad_table}[\boldsymbol{\mathsf{V}}] = \boldsymbol{\mathsf{G}}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2580"><span class="MJXp-mspace" id="MJXp-Span-2581" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-342-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-342">\hspace{10mm}</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2582"><span class="MJXp-mspace" id="MJXp-Span-2583" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-343-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-343">\hspace{10mm}</script></span>Chèn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2584"><span class="MJXp-mrow" id="MJXp-Span-2585"><span class="MJXp-mi undefined" id="MJXp-Span-2586">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-344-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-344">\boldsymbol{\mathsf{G}}</script></span> và phép toán tạo ra nó vào đồ thị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2587"><span class="MJXp-mrow" id="MJXp-Span-2588"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2589">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-345-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-345">\mathcal{G}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2590"><span class="MJXp-mspace" id="MJXp-Span-2591" style="width: 2.362em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-346-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-346">\hspace{10mm}</script></span>Trả về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2592"><span class="MJXp-mrow" id="MJXp-Span-2593"><span class="MJXp-mi undefined" id="MJXp-Span-2594">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-347-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-347">\boldsymbol{\mathsf{G}}</script></span></p><hr><p>Trong phần 6.5.2, chúng tôi đã giải thích rằng thuật toán lan truyền ngược được phát triển để tránh việc tính toán nhiều lần các biểu thức con giống nhau trong quy tắc chuỗi. Thời gian chạy của thuật toán trực tiếp có thể có thể là một hàm mũ do lặp đi lặp lại việc tính toán các biểu thức con đó. Sau khi đã hiểu thuật toán lan truyền ngược, ta cần tìm hiểu về chi phí tính toán của nó. Nếu ta giả sử rằng mỗi phép toán có chi phí tính toán gần như nhau, thì ta có thể chỉ cần phân tích chi phí tính toán theo số lượng các phép toán đã thực thi. Cần lưu ý rằng ở đây ta coi một phép toán là một đơn vị tính toán cơ bản trong đồ thị tính toán. Trong thực tế, phép toán đó có thể bao gồm nhiều các phép toán số học (ví dụ, ta có thể có một đồ thị coi phép nhân ma trận như một phép toán duy nhất). Việc tính toán một gradient trong một đồ thị có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-348-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-348">n</script></span> nút sẽ không bao giờ cần thực hiện quá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598">O</span><span class="MJXp-mo" id="MJXp-Span-2599" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2602" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2603" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-349-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-349">O(n^2)</script></span> phép toán hoặc lưu trữ quá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">O</span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2609" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-350-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-350">O(n^2)</script></span> đầu ra của các phép toán. Ở đây, chúng tôi đang nói đến số phép toán trong đồ thị, chứ không phải các phép toán riêng lẻ được thực thi bởi phần cứng máy tính, do đó một điều quan trọng cần nhớ là thời gian thực thi mỗi phép toán cũng rất khác nhau. Chẳng hạn, một phép nhân hai ma trận chứa hàng triệu phần tử cũng có thể tương đương với một phép toán đơn lẻ trong đồ thị. Có thể thấy rằng việc tính toán gradient yêu cầu tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612">O</span><span class="MJXp-mo" id="MJXp-Span-2613" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2616" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-351-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-351">O(n^2)</script></span> phép toán, bởi quá trình lan truyền thuận sẽ phải thực thi toàn bộ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-352-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-352">n</script></span> nút của đồ thị ban đầu trong trường hợp xấu nhất (điều này phụ thuộc vào giá trị ta cần tính toán, ta không nhất thiết phải thực thi toàn bộ đồ thị). Thuật toán lan truyền ngược thêm vào một phép toán nhân một ma trận Jacobi với một vector mà ta có thể biểu diễn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">O</span><span class="MJXp-mo" id="MJXp-Span-2622" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2623">1</span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-353-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-353">O(1)</script></span> nút cho mỗi cạnh trong đồ thị ban đầu. Bởi vì đồ thị tính toán là một đồ thị có hướng không có chu trình, nên nó có nhiều nhất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626">O</span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2630" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-354-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-354">O(n^2)</script></span> cạnh. Với các dạng đồ thị thường dùng trong thực tế, chi phí tính toán sẽ còn thấp hơn nữa. Hầu hết hàm mất mát trong mạng neuron gần như là cấu trúc dạng chuỗi, khiến quá trình lan truyền ngược có chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2633">O</span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635">n</span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-355-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-355">O(n)</script></span>. Điều này tốt hơn nhiều so với phương pháp tính trực tiếp, mà ở đó ta có thể cần thực thi số phép toán theo hàm mũ khi số lượng nút trong đồ thị tăng. Việc chi phí tính toán tăng theo hàm mũ có thể được thấy thông qua khai triển quy tắc chuỗi đệ quy (phương trình 6.53):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2637"><span class="MJXp-mtable" id="MJXp-Span-2638"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2639" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2640" style="text-align: right;"><span class="MJXp-mfrac" id="MJXp-Span-2641" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2642">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2645" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2646">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">n</span><span class="MJXp-mo" id="MJXp-Span-2648">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2649">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2651" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2652" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2653">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654">j</span><span class="MJXp-mo" id="MJXp-Span-2655">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2656" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2657"><span><span class="MJXp-mo" id="MJXp-Span-2658" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2659" style="margin-left: 0px;"><span class="MJXp-mtext" id="MJXp-Span-2660">path</span><span class="MJXp-mo" id="MJXp-Span-2661">(</span><span class="MJXp-msubsup" id="MJXp-Span-2662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2664" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2665">(</span><span class="MJXp-msubsup" id="MJXp-Span-2666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2668" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2669">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2670">,</span><span class="MJXp-msubsup" id="MJXp-Span-2671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2673" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2674">(</span><span class="MJXp-msubsup" id="MJXp-Span-2675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2677" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2678">)</span><span class="MJXp-mo" id="MJXp-Span-2679">,</span><span class="MJXp-mo" id="MJXp-Span-2680">.</span><span class="MJXp-mo" id="MJXp-Span-2681">.</span><span class="MJXp-mo" id="MJXp-Span-2682">.</span><span class="MJXp-mo" id="MJXp-Span-2683">,</span><span class="MJXp-msubsup" id="MJXp-Span-2684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2686" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2687">(</span><span class="MJXp-msubsup" id="MJXp-Span-2688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2689" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2690" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2691">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2692">)</span><span class="MJXp-mo" id="MJXp-Span-2693">,</span><span class="MJXp-mspace" id="MJXp-Span-2694" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2695">from</span><span class="MJXp-mtext" id="MJXp-Span-2696">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2699" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2700">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">j</span><span class="MJXp-mtext" id="MJXp-Span-2702">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-2703">to</span><span class="MJXp-mtext" id="MJXp-Span-2704">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2706" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2707" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2708">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">n</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2710"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2716" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">t</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2712" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713">k</span><span class="MJXp-mo" id="MJXp-Span-2714">=</span><span class="MJXp-mn" id="MJXp-Span-2715">2</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2718" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2719">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2722" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2723">(</span><span class="MJXp-msubsup" id="MJXp-Span-2724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2726" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-2727">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2728">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2731" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2732">(</span><span class="MJXp-msubsup" id="MJXp-Span-2733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2734" style="margin-right: 0.05em;">π</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2735" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736">k</span><span class="MJXp-mo" id="MJXp-Span-2737">−</span><span class="MJXp-mn" id="MJXp-Span-2738">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2739">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-356-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-356">\begin{align}
\frac{\partial u^{(n)}}{\partial u^{(j)}} =\sum\limits_{\text{path}(u^{(\pi_1)},u^{(\pi_2), ..., u^{(\pi_t)}}),\\\text{from} \space \pi_1=j \space \text{to} \space \pi_t=n} \prod\limits_{k=2}^{t} \frac{\partial u^{(\pi_k)}}{\partial u^{(\pi_{k-1})}}.
\tag{6.55}
\end{align}</script></span></p><p>Do số lượng các đường đi từ nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-357-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-357">j</script></span> đến nút <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-358-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-358">n</script></span> có thể tăng theo hàm mũ, số lượng các số hạng ở tổng trên (bằng với số lượng các đường đi) có thể tăng theo hàm mũ đối với độ sâu của mạng lan truyền thuận. Chi phí tính toán phát sinh lớn như vậy là do việc tính toán cùng một biểu thức tính đạo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2745"><span class="MJXp-mfrac" id="MJXp-Span-2746" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2747">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2750" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2751">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752">i</span><span class="MJXp-mo" id="MJXp-Span-2753">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2754">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2757" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2758">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759">j</span><span class="MJXp-mo" id="MJXp-Span-2760">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-359-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-359">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> được thực hiện lại nhiều lần. Để tránh việc tính toán lặp lại, ta coi thuật toán lan truyền ngược như một thuật toán dạng điền vào bảng với ưu điểm là có thể lưu trữ các giá trị đạo hàm trung gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2761"><span class="MJXp-mfrac" id="MJXp-Span-2762" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2763">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2766" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2767">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">i</span><span class="MJXp-mo" id="MJXp-Span-2769">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2770">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2772" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2773" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2774">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775">j</span><span class="MJXp-mo" id="MJXp-Span-2776">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-360-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-360">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span>. Mỗi nút trong đồ thị tương ứng với một ô trong bảng lưu trữ giá trị gradient của nút đó. Bằng việc điền các phần tử vào trong bảng, thuật toán lan truyền ngược sẽ giúp ta tránh được việc tính toán nhiều lần một biểu thức chung trong đồ thị. Kỹ thuật điền vào bảng này đôi khi còn được gọi là <em>quy hoạch động</em> (dynamic programming).</p><h2 id="657-Ví-dụ-Lan-truyền-ngược-áp-dụng-trong-huấn-luyện-mạng-MLP">6.5.7 Ví dụ: Lan truyền ngược áp dụng trong huấn luyện mạng MLP</h2><p>Với ví dụ này, ta sẽ đi vào việc áp dụng lan truyền ngược cho một mô hình mạng perceptron đa tầng.</p><p>Ở đây, chúng ta sẽ xây dựng một mô hình mạng perceptron đa tầng rất đơn giản với chỉ một tầng ẩn. Để huấn luyện mô hình này chúng ta sẽ sử dụng thuật toán trượt gradient ngẫu nhiên với lô nhỏ (minibatch). Thuật toán lan truyền ngược được áp dụng để tính gradient của hàm mất mát theo mỗi lô nhỏ. Cụ thể, ta sử dụng một lô nhỏ các mẫu huấn luyện trong tập huấn luyện dưới dạng một ma trận thiết kế <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2777"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2778">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-361-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-361">\boldsymbol{X}</script></span> và một vector chứa các nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2780">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-362-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-362">\boldsymbol{y}</script></span>. Mạng sẽ tính toán một lớp các đặc trưng ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2781"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2782">H</span><span class="MJXp-mo" id="MJXp-Span-2783" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-2785" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-2786">0</span><span class="MJXp-mo" id="MJXp-Span-2787" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2788"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2789" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2790">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2791" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2792">(</span><span class="MJXp-mn" id="MJXp-Span-2793">1</span><span class="MJXp-mo" id="MJXp-Span-2794">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-363-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-363">\boldsymbol{H}=\max\{0,\boldsymbol{XW}^{(1)}\}</script></span>. Để đơn giản, ta sẽ không sử dụng hệ số tự do trong mô hình này. Ta giả sử rằng ngôn ngữ biểu diễn đồ thị có bao gồm một phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2796"><span class="MJXp-mrow" id="MJXp-Span-2797"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2798">relu</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-364-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-364">\texttt{relu}</script></span> để tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2799"><span class="MJXp-mo" id="MJXp-Span-2800" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-2801" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-2802">0</span><span class="MJXp-mo" id="MJXp-Span-2803" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2804">Z</span><span class="MJXp-mo" id="MJXp-Span-2805" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-365-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-365">\max\{0,\boldsymbol{Z}\}</script></span> theo từng phần tử. Giá trị dự đoán của logarit các xác suất chưa chuẩn hóa sẽ là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2806"><span class="MJXp-msubsup" id="MJXp-Span-2807"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2808" style="margin-right: 0.05em;">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2809">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2810" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2811">(</span><span class="MJXp-mn" id="MJXp-Span-2812">2</span><span class="MJXp-mo" id="MJXp-Span-2813">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-366-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-366">\boldsymbol{HW}^{(2)}</script></span>. Ta giả sử rằng ngôn ngữ biểu diễn đồ thị bao gồm một phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2814"><span class="MJXp-mrow" id="MJXp-Span-2815"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2816">cross_entropy</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-367-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-367">\texttt{cross_entropy}</script></span> (entropy chéo) để tính khoảng cách giữa vector nhãn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2817"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2818">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-368-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-368">\boldsymbol{y}</script></span> và phân phối xác suất xác định bởi logrit của các xác suất chưa chuẩn hóa. Entropy chéo này cho ta hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2819"><span class="MJXp-msubsup" id="MJXp-Span-2820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2822" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2823"><span class="MJXp-mi" id="MJXp-Span-2824">M</span><span class="MJXp-mi" id="MJXp-Span-2825">L</span><span class="MJXp-mi" id="MJXp-Span-2826">E</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-369-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-369">J_{\mathrm{MLE}}</script></span>. Quá trình cực tiểu hóa entropy chéo sẽ thực hiện ước lượng hợp lý cực đại cho bộ phân loại. Tuy nhiên, để ví dụ này trở nên thực tế hơn, ta sẽ cộng thêm đại lượng kiểm soát vào. Hàm chi phí tổng cộng sẽ là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2827"><span class="MJXp-mtable" id="MJXp-Span-2828"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2829" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2830" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">J</span><span class="MJXp-mo" id="MJXp-Span-2832" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2835" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2836"><span class="MJXp-mi" id="MJXp-Span-2837">M</span><span class="MJXp-mi" id="MJXp-Span-2838">L</span><span class="MJXp-mi" id="MJXp-Span-2839">E</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841">λ</span><span class="MJXp-mstyle" id="MJXp-Span-2842"><span class="MJXp-mrow" id="MJXp-Span-2843"><span class="MJXp-mo" id="MJXp-Span-2844" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2845"><span><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2847" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848">i</span><span class="MJXp-mo" id="MJXp-Span-2849">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">j</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2851"><span class="MJXp-mrow" id="MJXp-Span-2852" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2853" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2860"><span class="MJXp-mo" id="MJXp-Span-2861">(</span><span class="MJXp-mn" id="MJXp-Span-2862">1</span><span class="MJXp-mo" id="MJXp-Span-2863">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">i</span><span class="MJXp-mo" id="MJXp-Span-2858">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2865" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2866" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2867"><span><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2869" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">i</span><span class="MJXp-mo" id="MJXp-Span-2871">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872">j</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2873"><span class="MJXp-mrow" id="MJXp-Span-2874" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2875" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2882"><span class="MJXp-mo" id="MJXp-Span-2883">(</span><span class="MJXp-mn" id="MJXp-Span-2884">2</span><span class="MJXp-mo" id="MJXp-Span-2885">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879">i</span><span class="MJXp-mo" id="MJXp-Span-2880">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2881">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2887" style="vertical-align: 0.82em;"><span class="MJXp-mn" id="MJXp-Span-2888">2</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-2889"><span class="MJXp-mrow" id="MJXp-Span-2890"><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-370-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-370">\begin{align}
J = J_{\mathrm{MLE}} + \lambda\Big(\sum_{i,j}\left(W_{i,j}^{(1)}\right)^2 + \sum_{i,j}\left(W_{i,j}^{(2)}\right)^{2}\Big)
\tag{6.56}
\end{align}</script></span></p><p>Hàm mất mát ở trên bao gồm entropy chéo và đại lượng kiểm soát với hệ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2893">λ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-371-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-371">\lambda</script></span>. Đồ thị tính toán được mô phỏng trên hình 6.11.</p><p><img src="https://i.imgur.com/3E4YAyY.png" alt=""></p><blockquote>
<p>Hình 6.11: Đồ thị tính toán sử dụng để tính hàm chi phí trong quá trình huấn luyện MLP một tầng ẩn, sử dụng mất mát entropy chéo và suy giảm trọng số.</p>
</blockquote><p>Đồ thị tính toán giá trị gradient trong ví dụ này khá lớn và phức tạp, khiến nó khó có thể vẽ hoặc đọc được. Đây cũng là một trong số những ưu điểm của thuật toán lan truyền ngược. Nó có thể tự động tính toán giá trị gradient một cách dễ dàng và trực tiếp, trong khi việc tính gradient này bằng tay là vô cùng tẻ nhạt.</p><p>Chúng ta gần như có thể theo dõi cách thức hoạt động của lan truyền ngược thông qua đồ thị lan truyền thuận trong hình 6.11. Để huấn luyện mô hình, ta cần tính toán được hai giá trị gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2894"><span class="MJXp-msubsup" id="MJXp-Span-2895"><span class="MJXp-mi" id="MJXp-Span-2896" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2897" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2898"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2899" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2900" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2901">(</span><span class="MJXp-mn" id="MJXp-Span-2902">1</span><span class="MJXp-mo" id="MJXp-Span-2903">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-372-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-372">\nabla_{\boldsymbol{W}^{(1)}}J</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2905"><span class="MJXp-msubsup" id="MJXp-Span-2906"><span class="MJXp-mi" id="MJXp-Span-2907" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2908" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2909"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2910" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2911" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2912">(</span><span class="MJXp-mn" id="MJXp-Span-2913">2</span><span class="MJXp-mo" id="MJXp-Span-2914">)</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-373-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-373">\nabla_{\boldsymbol{W}^{(2)}}J</script></span>. Có hai đường đi khác nhau dẫn ngược từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-374-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-374">J</script></span> về các ma trận trọng số: một thông qua hàm chi phí entropy chéo, một thông qua hàm chi phí của số hạng suy giảm trọng số. Tính toán gradient của số hạng suy giảm trọng số tương đối đơn giản; nó đóng góp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2918"><span class="MJXp-mn" id="MJXp-Span-2919">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920">λ</span><span class="MJXp-msubsup" id="MJXp-Span-2921"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2922" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2923" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2924">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">i</span><span class="MJXp-mo" id="MJXp-Span-2926">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-375-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-375">2\lambda \boldsymbol{W}^{(i)}</script></span> vào gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2927"><span class="MJXp-msubsup" id="MJXp-Span-2928"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2929" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2930" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2931">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932">i</span><span class="MJXp-mo" id="MJXp-Span-2933">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-376-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-376">\boldsymbol{W}^{(i)}</script></span>.</p><p>Đường đi còn lại thông qua hàm entropy chéo khá phức tạp. Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2934"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2935">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-377-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-377">\boldsymbol{G}</script></span> là gradient của logarit xác suất chưa chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2936"><span class="MJXp-msubsup" id="MJXp-Span-2937"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2938" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2939" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2940">(</span><span class="MJXp-mn" id="MJXp-Span-2941">2</span><span class="MJXp-mo" id="MJXp-Span-2942">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-378-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-378">\boldsymbol{u}^{(2)}</script></span> sinh bởi phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2943"><span class="MJXp-mrow" id="MJXp-Span-2944"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2945">cross-entropy</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-379-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-379">\texttt{cross-entropy}</script></span>. Thuật toán lan truyền ngược cần phải đi trên hai nhánh khác nhau. Ở nhánh ngắn hơn, nó sẽ thêm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2946"><span class="MJXp-msubsup" id="MJXp-Span-2947"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2948" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2949" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-2950">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2951">G</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-380-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-380">\boldsymbol{H}^{\top}\boldsymbol{G}</script></span> vào gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2952"><span class="MJXp-msubsup" id="MJXp-Span-2953"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2954" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2955" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2956">(</span><span class="MJXp-mn" id="MJXp-Span-2957">2</span><span class="MJXp-mo" id="MJXp-Span-2958">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-381-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-381">\boldsymbol{W}^{(2)}</script></span>, sau khi sử dụng quy tắc lan truyền ngược cho đối số thứ hai của phép toán nhân ma trận. Nhánh còn lại tương ứng với chuỗi dài hơn trong mô hình mạng. Đầu tiên, thuật toán lan truyền ngược sẽ tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2959"><span class="MJXp-msubsup" id="MJXp-Span-2960"><span class="MJXp-mi" id="MJXp-Span-2961" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2962" style="vertical-align: -0.4em;">H</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">J</span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2965"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2966" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2967">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2968" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2969">(</span><span class="MJXp-mn" id="MJXp-Span-2970">2</span><span class="MJXp-mo" id="MJXp-Span-2971">)</span><span class="MJXp-mi" id="MJXp-Span-2972">⊤</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-382-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-382">\nabla_\boldsymbol{H}J=\boldsymbol{GW}^{(2)\top}</script></span> bằng cách sử dụng quy tắc lan truyền ngược cho đối số đầu tiên của phép nhân hai ma trận. Tiếp theo, phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2973"><span class="MJXp-mrow" id="MJXp-Span-2974"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2975">relu</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-383-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-383">\texttt{relu}</script></span> sử dụng quy tắc lan truyền ngược để đặt các thành phần của gradient tương ứng với các phần tử của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2976"><span class="MJXp-msubsup" id="MJXp-Span-2977"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2978" style="margin-right: 0.05em;">U</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2979" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2980">(</span><span class="MJXp-mn" id="MJXp-Span-2981">1</span><span class="MJXp-mo" id="MJXp-Span-2982">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-384-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-384">\boldsymbol{U}^{(1)}</script></span> có giá trị âm về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2983"><span class="MJXp-mn" id="MJXp-Span-2984">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-385-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-385">0</script></span>. Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2985"><span class="MJXp-msubsup" id="MJXp-Span-2986"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2987" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2988" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-2989"><span class="MJXp-mi" id="MJXp-Span-2990" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2991" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-386-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-386">\boldsymbol{G}^{'}</script></span> là kết quả của phép toán trên. Bước cuối cùng của thuật toán lan truyền ngược là áp dụng quy tắc lan truyền ngược cho đối số thứ hai của phép toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2992"><span class="MJXp-mrow" id="MJXp-Span-2993"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-2994">matmul</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-387-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-387">\texttt{matmul}</script></span> để cộng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2995"><span class="MJXp-msubsup" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2997" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2998" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-2999">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3000"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3001" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3002" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-3003"><span class="MJXp-mi" id="MJXp-Span-3004" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3005" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-388-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-388">\boldsymbol{X}^{\top}\boldsymbol{G}^{'}</script></span> vào gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3006"><span class="MJXp-msubsup" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3008" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3009" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3010">(</span><span class="MJXp-mn" id="MJXp-Span-3011">1</span><span class="MJXp-mo" id="MJXp-Span-3012">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-389-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-389">\boldsymbol{W}^{(1)}</script></span>.</p><p>Sau khi tính toán các giá trị gradient trên, ta có thể áp dụng thuật toán trượt gradient, hoặc các thuật toán tối ưu khác dựa trên gradient để cập nhật tham số.</p><p>Với mạng MLP trong ví dụ này, chi phí tính toán chủ yếu bị chi phối bởi chi phí của phép nhân ma trận. Trong quá trình lan truyền thuận, ta sử dụng phép nhân với mỗi ma trận trọng số, dẫn tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3014">O</span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3016">w</span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-390-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-390">O(w)</script></span> phép nhân-cộng, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019">w</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-391-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-391">w</script></span> là số lượng các trọng số. Trong quá trình lan truyền ngược, ta sử dụng phép nhân với chuyển vị của mỗi ma trận trọng số, với cùng chi phí tính toán. Chi phí bộ nhớ của thuật toán chủ yếu dùng để lưu trữ đầu vào của các hàm phi tuyến trong tầng ẩn của mô hình. Giá trị này được lưu trữ từ thời điểm nó được tính toán cho đến khi quá trình truyền ngược quay lại điểm đó. Chi phí bộ nhớ do đó bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3021">O</span><span class="MJXp-mo" id="MJXp-Span-3022" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3023">m</span><span class="MJXp-mspace" id="MJXp-Span-3024" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3027" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mo" id="MJXp-Span-3028" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-392-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-392">O(m\,n_h)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-393-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-393">m</script></span> là số lượng mẫu trong lô nhỏ, còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3031"><span class="MJXp-msubsup" id="MJXp-Span-3032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3034" style="vertical-align: -0.4em;">h</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-394-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-394">n_h</script></span> là số phần tử trong lớp ẩn.</p><h2 id="658-Một-số-vấn-đề-phức-tạp">6.5.8 Một số vấn đề phức tạp</h2><p>Mô tả về thuật toán lan truyền ngược trong chương này đơn giản hơn nhiều so với việc triển khai nó trong thực tế.</p><p>Như đã nêu ở trên, chúng ta mới chỉ giới hạn việc định nghĩa phép toán là một hàm trả về dữ liệu là một tensor. Hầu hết các thực thi phần mềm cần hỗ trợ các phép toán có thể trả về nhiều hơn một tensor. Chẳng hạn, nếu ta cần tính cả giá trị cực đại trong một tensor lẫn chỉ số của nó trong tensor đó, cách tốt nhất đó là tính cả hai đại lượng này bằng cách duyệt qua tensor đúng một lần. Do vậy cách thực thi thủ tục này hiệu quả nhất đó là thực hiện một phép toán nhưng cho ra hai kết quả đầu ra.</p><p>Ở đây chúng tôi vẫn chưa mô tả cách kiểm soát bộ nhớ của thuật toán lan truyền ngược. Quá trình lan truyền ngược thường bao gồm nhiều phép các tính tổng tensor với nhau. Trong hướng tiếp cận trực tiếp, mỗi tensor sẽ được tính toán riêng biệt, rồi mới cộng toàn bộ chúng lại với nhau. Cách tiếp cận này sẽ gây nên tình trạng “nghẽn cổ chai” bộ nhớ. Ta có thể tránh tình trạng này bằng cách chỉ sử dụng một bộ đệm và sau đó cộng luôn các giá trị mỗi khi nó được tính xong.</p><p>Các cài đặt của thuật toán lan truyền ngược trong thực tế cần xử lý được nhiều kiểu dữ liệu như: kiểu dấu phẩy động 32 bit, dấu phẩy động 64 bit, và các số nguyên. Cần phải đặc biệt chú ý vấn đề này trong quá trình xây dựng mô hình. Một số phép toán có gradient không xác định, và ta cần theo dõi những trường hợp này để xác định liệu gradient cần tính có xác định hay không. Việc tính toán đạo hàm trong thực tế sẽ phức tạp hơn bởi nhiều vấn đề mang tính kỹ thuật khác. Những vấn đề này không phải là khổng thể giải quyết, và chương này đã mô tả các công cụ chính yếu cần thiết để tính toán đạo hàm, nhưng bạn cần biết rằng còn  nữa nhiều vấn đề tinh vi hơn nữa tồn tại trong thực tế.</p><p>-------------------------------------------------<br>
---- Thomas Nguyễn kết thúc ở đây ----<br>
-------------------------------------------------\</p><p>---------------------------------------------<br>
---- SonAn bắt đầu dịch từ đây ----</p><h2 id="659-Phép-đạo-hàm-bên-ngoài-cộng-đồng-học-sâu">6.5.9 Phép đạo hàm bên ngoài cộng đồng học sâu</h2><p>Cộng đồng nghiên cứu học sâu đã và đang phần nào tách biệt khỏi cộng đồng khoa học máy tính, và phần lớn đã tự phát triển văn hóa riêng liên quan đến cách thực hiện việc tính toán đạo hàm. Nhìn chung, lĩnh vực tính toán <em>đạo hàm tự động</em> (automatic differentiation) có liên quan tới cách tính toán các đạo hàm theo thuật toán. Thuật toán lan truyền ngược được mô tả trong chương này chỉ là một hướng tiếp cận của đạo hàm tự động. Đây là một trường hợp đặc biệt của một lớp vấn đề kỹ thuật rộng hơn gọi là <em>tích lũy chế độ ngược</em> (reverse mode accumulation). Các hướng tiếp cận khác tính toán các biểu thức con của quy tắc chuỗi theo các thứ tự khác. Nói chung, việc xác định thứ tự đánh giá sao cho chi phí tính toán thấp nhất là một bài toán khó. Bài toán tìm một chuỗi tối ưu các phép toán để tính toán gradient được gọi là là bài toán NP-hard [Naumann, 2008], theo nghĩa là nó có thể yêu cầu đơn giản hóa các biểu thức đại số thành dạng ít tốn kém nhất.</p><blockquote>
<p>Hung Le: Tác giả nói NP-complete là chưa chính xác vì NP-complete chỉ dành cho các bài toán quyết định, đầu ra dạng Yes/No. Còn bài toán nhắc tới ở đây là bài toán tối ưu, nên nói nó thuộc NP-hard thì mới đúng.</p>
</blockquote><p>Ví dụ, chúng ta có các biến số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3035"><span class="MJXp-msubsup" id="MJXp-Span-3036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3037" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3038" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3039" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3041" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3042" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3045" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3050" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-395-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-395">p_1,p_2,...,p_n</script></span> biểu diễn các xác suất, và các biến số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3051"><span class="MJXp-msubsup" id="MJXp-Span-3052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3053" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3054" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3057" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3058" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3061" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3063" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3066" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-396-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-396">z_1,z_2,...,z_n</script></span> biểu diễn cho logarith của xác suất chưa chuẩn hóa. Giả sử ta định nghĩa<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3067"><span class="MJXp-mtable" id="MJXp-Span-3068"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3069" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3070" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3073" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3075" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3076">exp</span><span class="MJXp-mo" id="MJXp-Span-3077" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3078" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3081" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3082" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3083"><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3085" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-3086">exp</span><span class="MJXp-mo" id="MJXp-Span-3087" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3088" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3091" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3092" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3093" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-397-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-397">q_i=\frac{\exp(z_i)}{\sum_i\exp(z_i)}, \tag{6.57}</script></span><br>
ở đây chúng ta xây dựng hàm softmax từ các phép toán lũy thừa, phép tính tổng và phép chia, và xây dựng một hàm mất mát entropy chéo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095">J</span><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3098"><span class="MJXp-mo" id="MJXp-Span-3099" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3100" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3103" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-3104">log</span><span class="MJXp-mo" id="MJXp-Span-3105" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-3106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3107" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3108" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-398-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-398">J=-\sum_ip_i\log q_i</script></span>. Về mặt toán học, ta có thể dễ thấy rằng đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3110">J</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-399-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-399">J</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3111"><span class="MJXp-msubsup" id="MJXp-Span-3112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3113" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3114" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-400-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-400">z_i</script></span> có dạng đơn giản: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3115"><span class="MJXp-msubsup" id="MJXp-Span-3116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3118" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3119" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3122" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-401-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-401">q_i-p_i</script></span>. Nhưng thuật toán lan truyền ngược không có khả năng tối giản gradient như vậy, và thay vào đó nó sẽ lan truyền gradient một cách rõ ràng tất cả các phép toán logarit và các lũy thừa trong đồ thị ban đầu. Một số thư viện phần mềm như Theano [Bergstra et al., 2010; Bastien et al., 2012] có thể thực hiện một số kiểu thay thế biểu thức đại số để cải tiến đồ thị do thuật toán lan truyền ngược thuần túy tạo ra.</p><p>Khi mà đồ thị lan truyền thuận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3123"><span class="MJXp-mrow" id="MJXp-Span-3124"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3125">G</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-402-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-402">\mathcal{G}</script></span> chỉ có một nút đầu ra duy nhất và mỗi đạo hàm riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3126"><span class="MJXp-mfrac" id="MJXp-Span-3127" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3128">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3130" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3131" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3132">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3133">i</span><span class="MJXp-mo" id="MJXp-Span-3134">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3135">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3138" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3139">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140">j</span><span class="MJXp-mo" id="MJXp-Span-3141">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-403-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-403">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> có thể được tính toán với một số lượng phép toán không đổi, thuật toán lan truyền ngược đảm bảo rằng độ phức tạp tính toán để tính gradient có cùng bậc với số lượng tính toán trong lan truyền thuận: ta có thể thấy điều này trong thuật toán 6.2, bởi vì mỗi đạo hàm riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3142"><span class="MJXp-mfrac" id="MJXp-Span-3143" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3144">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3146" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3147" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3148">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3149">i</span><span class="MJXp-mo" id="MJXp-Span-3150">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3151">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3153" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3154" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3155">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156">j</span><span class="MJXp-mo" id="MJXp-Span-3157">)</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-404-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-404">\frac{\partial u^{(i)}}{\partial u^{(j)}}</script></span> chỉ cần được tính toán một lần cùng với một phép nhân và phép cộng để thực hiện theo quy tắc đạo hàm của hàm hợp kiểu đệ quy (phương trình 6.53). Tổng số phép toán vì vậy là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3159">O</span><span class="MJXp-mo" id="MJXp-Span-3160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-3161">#</span><span class="MJXp-mtext" id="MJXp-Span-3162">cạnh</span><span class="MJXp-mo" id="MJXp-Span-3163" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-405-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-405">O(\#\text{cạnh})</script></span>. Tuy nhiên, ta có giảm số phép toán này hơn nữa bằng cách tối giản đồ thị tính toán của thuật toán lan truyền ngược, và đây là một bài toán NP-hard. Các thực thi như Theano và TensorFlow sử dụng các phương pháp dựa trên kinh nghiệm bằng cách so khớp với các biểu thức mẫu đơn giản đã biết để cố gắng đơn giản đồ thị tính toán qua nhiều lần lặp. Ở trên ta định nghĩa thuật toán lan truyền ngược chỉ để tính gradient của đầu ra khi nó là một số vô hướng, tuy nhiên thuật toán này có thể mở rộng ra để tính với một ma trận Jacobi (của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-406-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-406">k</script></span> nút vô hướng của đồ thị, hoặc của một nút có giá trị kiểu tensor bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-407-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-407">k</script></span> phần tử). Các thực thi theo hướng tiếp cận trực tiếp có thể cần số lượng tính toán nhiều hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-408-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-408">k</script></span> lần: đối với mỗi nút trong vô hướng của đồ thị lan truyền thuận ban đầu, hướng thực thi trực tiếp cần tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3171">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-409-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-409">k</script></span> gradient thay vì một gradient duy nhất. Khi số lượng đầu ra của đồ thị lớn hơn số lượng đầu vào, đôi khi ta ưa dùng một dạng tự động khác được gọi là <em>tích lũy chế độ thuận</em> (forward mode accumulation). Tích lũy chế độ thuận được đề xuất để tính toán gradient cho các mạng truy hồi theo thời gian thực, ví dụ [Williams và Zipser, 1989]. Cách tiếp cận này giúp tránh việc phải lưu trữ các giá trị và gradient cho toàn bộ đồ thị, đánh đổi thời gian tính toán lấy bộ nhớ. Mối quan hệ giữa chế độ thuận và chế độ ngược tương tự với mối quan hệ giữa phép nhân trái so với phép nhân phải của một chuỗi các ma trận, chẳng hạn như<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3172"><span class="MJXp-mtable" id="MJXp-Span-3173"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3174" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3175" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3176">A</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3177">B</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3178">C</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3179">D</span><span class="MJXp-mo" id="MJXp-Span-3180" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-410-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-410">\boldsymbol{ABCD}, \tag{6.58}</script></span><br>
trong đó ta có thể coi các ma trận này như ma trận Jacobi. Ví dụ, nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3181"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3182">D</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-411-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-411">\boldsymbol{D}</script></span> là một vector cột trong khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3183"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3184">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-412-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-412">\boldsymbol{A}</script></span> có nhiều hàng, đồ thị sẽ có một đầu ra đơn và nhiều đầu vào, và việc bắt đầu phép nhân từ cuối ngược về chỉ yêu cầu các phép nhân vector-ma trận. Thứ tự này tương ứng với chế độ ngược. Thay vào đó, khi bắt đầu nhân từ bên trái, quá trình sẽ bao gồm một chuỗi các phép nhân ma trận-ma trận, khiến cho toàn bộ quá trình tính toán có chi phí cao hơn. Nếu số hàng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3185"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3186">A</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-413-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-413">\boldsymbol{A}</script></span> ít hơn số cột ở <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3188">D</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-414-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-414">\boldsymbol{D}</script></span>, thực hiện phép nhân từ trái sang phải, tương ứng với chế độ thuận, sẽ có chi phí thấp hơn.</p><p>Trong nhiều cộng đồng ngoài ngành học máy, người ta thường thực thi đạo hàm dựa trực tiếp trên ngôn ngữ lập trình truyền thống, chẳng hạn như mã Python hoặc C và tự động tạo ra các chương trình đạo hàm các hàm được viết bằng các ngôn ngữ này. Trong cộng đồng học sâu, đồ thị tính toán thường được biểu diễn bằng cấu trúc dữ liệu rõ ràng được tạo ra bởi các thư viện chuyên biệt. Cách tiếp cận chuyên biệt có nhược điểm là yêu cầu nhà phát triển thư viện xác định các phương pháp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3189"><span class="MJXp-mrow" id="MJXp-Span-3190"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-3191">bprop</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-415-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-415">\texttt{bprop}</script></span> cho mọi phép toán và hạn chế người sử dụng chỉ được dùng những phép toán đã được cung cấp. Tuy nhiên, phương pháp tiếp cận chuyên biệt cũng mang lại lợi ích, đó là cho phép phát triển các quy tắc truyền ngược được tùy chỉnh cho mỗi phép toán, cho phép nhà phát triển cải thiện tốc độ hoặc tính ổn định theo những cách không tầm thường mà một thủ tục tự động có lẽ sẽ không làm được.</p><p>Lan truyền ngược do đó không phải là cách duy nhất hay cách tối ưu để tính toán gradient, nhưng nó là một phương pháp thực tế vẫn đang phục vụ tốt cho cộng đồng học sâu. Trong tương lai, kỹ thuật tính đạo hàm cho các mạng đa tầng có thể cải thiện khi các nhà nghiên cứu học sâu hiểu biến hơn về những tiến bộ của ngành nghiên cứu phương pháp đạo hàm tự động.</p><h2 id="6510-Đạo-hàm-bậc-cao">6.5.10 Đạo hàm bậc cao</h2><p>Một số khung phần mềm hỗ trợ tính các đạo hàm bậc cao hơn. Trong số các khung phần mềm học sâu, Theano và TensorFlow có hỗ trợ tính năng này. Các thư viện này sử dụng cùng một loại cấu trúc dữ liệu để mô tả hàm cần tính đạo hàm và biểu thức đạo hàm tính được. Điều này có nghĩa là ta có thể áp dụng các cơ chế tính đạo hàm kiểu kí hiệu để lấy đạo hàm.</p><p>Trong ngữ cảnh học sâu, hiếm khi ta tính toán đạo hàm bậc hai một biến của một hàm vô hướng. Thay vào đó, ta thường quan tâm đến các tính chất của ma trận Hesse. Nếu ta có một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3193">f</span><span class="MJXp-mo" id="MJXp-Span-3194" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-3195"><span class="MJXp-mrow" id="MJXp-Span-3196" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3197">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3198" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-3199" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mrow" id="MJXp-Span-3200"><span class="MJXp-mi undefined" id="MJXp-Span-3201">R</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-416-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-416">f: \mathbb{R}^n \rightarrow \mathbb{R}</script></span>, thì ma trận Hesse có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3203">n</span><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3205">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-417-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-417">n \times n</script></span>. Trong các ứng dụng học sâu, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3207">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-418-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-418">n</script></span> thường sẽ là số lượng tham số trong mô hình, mà có thể dễ dàng lên đến hàng tỷ. Do đó, chỉ việc biểu diễn ma trận Hesse đã là không khả thi.</p><p>Thay vì tính toán ma trận Hesse một cách tường mình, cách tiếp cận của học sâu điển hình là sử dụng các <em>phương pháp Krylov</em>. Các phương thức Krylov là một tập hợp các phương pháp lặp để thực hiện các phép toán khác nhau, như đảo ngược một ma trận, hoặc xấp xỉ các vector riêng hoặc các giá trị riêng của nó, mà không sử dụng bất kỳ thao tác nào khác ngoài các phép nhân vector-ma trận.</p><p>Để sử dụng các phương pháp Krylov với ma trận Hesse, ta chỉ cần có khả năng tính toán phép nhân giữa ma trận Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3208"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3209">H</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-419-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-419">\boldsymbol{H}</script></span> và một vectơ tùy ý <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3210"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3211">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-420-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-420">\boldsymbol{v}</script></span>. Một kỹ thuật tính trực tiếp [Christianson, 1992] là tính<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3212"><span class="MJXp-mtable" id="MJXp-Span-3213"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3214" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3215" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3216">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3217">v</span><span class="MJXp-mo" id="MJXp-Span-3218" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3219"><span class="MJXp-mi" id="MJXp-Span-3220" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3221" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mstyle" id="MJXp-Span-3222"><span class="MJXp-mrow" id="MJXp-Span-3223"><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">[</span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-3225"><span class="MJXp-mrow" id="MJXp-Span-3226"><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3228"><span class="MJXp-mi" id="MJXp-Span-3229" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3230" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231">f</span><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3233">x</span><span class="MJXp-mo" id="MJXp-Span-3234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3235"><span class="MJXp-mstyle" id="MJXp-Span-3236" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3237"><span class="MJXp-mo" id="MJXp-Span-3238" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span><span class="MJXp-mi MJXp-script" id="MJXp-Span-3239" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3240">v</span><span class="MJXp-mstyle" id="MJXp-Span-3241"><span class="MJXp-mrow" id="MJXp-Span-3242"><span class="MJXp-mo" id="MJXp-Span-3243" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3244" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-421-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-421">\boldsymbol{H}\boldsymbol{v}=\nabla_x\big[\big(\nabla_xf(x)\big)^\top\boldsymbol{v}\big].
\tag{6.59}</script></span><br>
Cả hai tính toán gradient trong biểu thức này có thể được tính tự động bởi thư viện phần mềm thích hợp. Lưu ý rằng biểu thức gradient bên ngoài bao gồm gradient của một hàm của biểu thức gradient bên trong.</p><p>Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3245"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3246">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-422-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-422">\boldsymbol{v}</script></span> là một vector được tạo ra bởi một đồ thị tính toán, một lưu ý quan trọng là phải thông báo cho các phần mềm tính đạo hàm tự động là không nên tính đạo hàm thông qua đồ thị sinh ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3247"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3248">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-423-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-423">\boldsymbol{v}</script></span>.<br>
Mặc dù việc tính toán ma trận Hesse không được khuyến khích, ta vẫn có thể làm điều đó bằng cách tính tích của vector với ma trận Hesse, chỉ đơn giản là tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3249"><span class="MJXp-msubsup" id="MJXp-Span-3250"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3251" style="margin-right: 0.05em;">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3252">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3253" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3254">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3255">i</span><span class="MJXp-mo" id="MJXp-Span-3256">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-424-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-424">\boldsymbol{He}^{(i)}</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258">i</span><span class="MJXp-mo" id="MJXp-Span-3259" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3260">1</span><span class="MJXp-mo" id="MJXp-Span-3261" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3262" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3264" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3266">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-425-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-425">i=1,...,n</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3267"><span class="MJXp-msubsup" id="MJXp-Span-3268"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3269" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3270" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3271">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272">i</span><span class="MJXp-mo" id="MJXp-Span-3273">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-426-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-426">\boldsymbol e^{(i)}</script></span> là một vector đơn trội với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3274"><span class="MJXp-msubsup" id="MJXp-Span-3275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3276" style="margin-right: 0.05em;">e</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3278"><span class="MJXp-mo" id="MJXp-Span-3279">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3280">i</span><span class="MJXp-mo" id="MJXp-Span-3281">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3282" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3283">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-427-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-427">e_i^{(i)}=1</script></span> và toàn bộ phần tử còn lại bằng 0.</p><h1 id="66-Vài-nét-lịch-sử">6.6 Vài nét lịch sử</h1><p>Các mạng lan truyền thuận có thể được xem như là các bộ xấp xỉ hàm phi tuyến hiệu quả dựa trên trượt gradient để giảm thiểu sai số xấp xỉ. Từ quan điểm này, mạng lan truyền thuận hiện đại là tổng kết của các tiến bộ qua hàng thế kỷ trong quá trình giải quyết các tác vụ xấp xỉ hàm tổng quát.</p><p>Quy tắc chuỗi, hạt nhân của thuật toán lan truyền ngược, được phát minh vào thế kỷ XVIII [Leibniz, 1676; L’Hôpital, 1696]. Phương pháp tính và đại số từ lâu đã được sử dụng để giải quyết các vấn đề tối ưu ở dạng đóng, nhưng phương pháp trượt gradient không được sử dụng như một kỹ thuật lặp để xấp xỉ kết quả cho các bài toán tối ưu cho đến tận thế kỷ XIX [Cauchy, 1847].</p><p>Đầu những năm 1940, các kỹ thuật xấp xỉ hàm này thúc đẩy các mô hình học máy như perceptron. Tuy nhiên, các mô hình ra đời đầu tiên lại dựa trên mô hình tuyến tính. Các nhà phê bình bao gồm Marvin Minsky đã chỉ ra một số thiếu sót trong họ các mô hình tuyến tính, chẳng hạn như không có khả năng học hàm XOR, dẫn đến làn sóng chống lại toàn bộ phương pháp mạng neuron.</p><p>Việc học các hàm phi tuyến yêu cầu phát triển của một perceptron đa tầng và một phương pháp tính toán gradient cho các mô hình đó. Các ứng dụng hiệu quả của quy tắc chuỗi dựa trên quy hoạch động bắt đầu xuất hiện trong những năm 1960 và 1970, chủ yếu cho các ứng dụng điều khiển [Kelley, 1960; Bryson và Denham, 1961; Dreyfus, 1962; Bryson and Ho, 1969; Dreyfus, 1973] và phân tích độ nhạy [Linnainmaa, 1976]. Werbos (1981) đã đề xuất áp dụng những kỹ thuật này để huấn luyện mạng neuron nhân tạo. Ý tưởng này cuối cùng được đưa vào thực tế sau khi được phát hiện một cách độc lập theo những cách khác nhau [LeCun, 1985; Parker, 1985; Rumelhart et al., 1986a]. Cuốn sách <em>Xử lý phân tán song song</em> (Parallel Distributed Processing) trình bày kết quả của một số thực nghiệm thành công đầu tiên với mạng lan truyền ngược trong một chương [Rumelhart et al., 1986b] đã đóng góp rất nhiều cho sự phổ biến của thuật toán lan truyền ngược và khởi đầu một giai đoạn nghiên cứu rất tích cực về các mạng neuron đa lớp. Những ý tưởng được đưa ra bởi các tác giả của cuốn sách đó, đặc biệt là của Rumelhart và Hinton, có tầm quan trọng vượt xa cả thuật toán lan truyền ngược. Chúng bao gồm các ý tưởng quan trọng về khả năng thực thi được về mặt tính toán của một số khía cạnh trung tâm của nhận thức và học tập, dưới cái tên “thuyết kế nối” (connectionism) bởi vì trường phái tư tưởng này nhấn mạnh sự quan trong của các các kết nối giữa các neuron đóng vai trò chính yếu trong học tập và ký ức. Đặc biệt, những ý tưởng này bao gồm khái niệm về biểu diễn phân tán (Hinton et al., 1986).</p><p>Theo bước thành công của phương pháp lan truyền ngược, làn sóng nghiên cứu mạng neuron đã trở nên phổ biến và đạt đến đỉnh điểm vào đầu những năm 1990. Sau đó, các kỹ thuật học máy khác trở nên phổ biến hơn cho đến thời kỳ phục hưng của học sâu hiện đại bắt đầu vào năm 2006.</p><p>Những ý tưởng cốt lõi đằng sau các mạng lan truyền thuận hiện đại không có nhiều thay đổi đáng kể kể từ những năm 1980. Các thuật toán truyền ngược và các phương pháp tiếp cận thuật toán trượt gradient tương tự vẫn đang được sử dụng từ đó đến giờ. Hầu hết các cải tiến về hiệu suất của mạng neuron từ năm 1986 đến năm 2015 có thể là do hai yếu tố. Đầu tiên, các bộ dữ liệu lớn hơn đã giúp các mạng neuron giảm được thách thức về tổng quát hoát về mặt thống kê. Thứ hai, mạng neuron đã trở nên lớn hơn nhiều, bởi vì các máy tính mạnh hơn và cơ sở hạ tầng phần mềm tốt hơn. Một vài thay đổi về thuật toán cũng đã cải thiện hiệu suất của mạng neuron một cách đáng kể.</p><p>Một trong những thay đổi mang tính thuật toán này là sự thay thế sai số bình phương trung bình bằng các hàm mất mát thuộc họ entropy chéo. Sai số bình phương trung bình được sử dụng phổ biến trong những năm 1980 và 1990 nhưng dần dần được thay thế bằng các hàm mất mát entropy chéo và nguyên tắc hợp lý cực đại bởi những ý tưởng của cộng đồng thống kê và cộng đồng học máy. Việc sử dụng hàm mất mát entropy chéo cải thiện đáng kể hiệu suất của các mô hình với các đầu ra là hàm chữ S và softmax, trong khi trước đây hiệu suất bị ảnh hưởng bởi vấn đề bão hòa và tốc độ học chậm khi sử dụng hàm mất mát là trung bình của bình phương sai số.</p><p>Các thay đổi lớn khác về mặt thuật toán đã cải thiện đáng kể hiệu suất của các mạng lan truyền thuận là sự thay thế các đơn vị ẩn chữ S với các đơn vị ẩn tuyến tính từng phần, chẳng hạn như các đơn vị tuyến tính hiệu chỉnh. Sự hiệu chỉnh bằng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3285">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3286">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3287">x</span><span class="MJXp-mo" id="MJXp-Span-3288" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-3289">0</span><span class="MJXp-mo" id="MJXp-Span-3290" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">z</span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-428-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-428">max\{0,z\}</script></span> được đưa vào các mô hình mạng neuron thời kì đầu và có mốc thời gian cùng thời với cognitron và neocognitron [Fukushima, 1975, 1980]. Những mô hình thời kì đầu này không sử dụng các đơn vị tuyến tính hiệu chỉnh, mà thay vào đó là áp dụng hiệu chỉnh cho các hàm phi tuyến. Bất chấp sự phổ biến ban đầu của phương pháp hiệu chỉnh, nó đã bị thay thế phần lớn bởi các hàm chữ S trong những năm 1980, có lẽ bởi vì hàm chữ S hoạt động tốt hơn khi mạng neuron rất nhỏ. Vào đầu những năm 2000, người ta tránh dùng các đơn vị tuyến tính hiệu chỉnh do một niềm tin kiểu mê tín rằng tốt nhất nên tránh các hàm kích hoạt không khả vi trên một miền nhất định. Điều này bắt đầu thay đổi vào khoảng năm 2009. Jarrett và cộng sự (2009) nhật xét rằng “sử dụng một hàm phi tuyến hiệu chỉnh là yếu tố quan trọng nhất trong việc cải thiện hiệu suất của một hệ thống nhận dạng”, trong số nhiều yếu tố khác nhau trong thiết kế kiến trúc mạng neuron.</p><p>Đối với các tập dữ liệu nhỏ, Jarrett và cộng sự (2009) quan sát thấy rằng việc sử dụng các hàm phi tuyến hiệu chỉnh thậm chí còn quan trọng hơn việc học trọng số của các lớp ẩn. Trọng số ngẫu nhiên là đủ để truyền bá các thông tin hữu ích thông qua một mạng tuyến tính hiệu chỉnh, cho phép lớp phân loại ở trên cùng học cách ánh xạ các vector đặc trưng khác nhau vào định dạng của các lớp.</p><p>Khi ta có nhiều dữ liệu hơn, quá trình học bắt đầu trích xuất kiến thức đủ hữu ích để vượt qua hiệu suất của các tham số được chọn ngẫu nhiên. Glorot và cộng sự (2011a) chứng minh rằng việc học các mạng học sâu tuyến tính hiệu chỉnh dễ dàng hơn rất nhiều các mạng sâu có các hàm kích hoạt cong hoặc có tính bão hòa hai phía.</p><p>Các đơn vị tuyến tính hiệu chỉnh cũng có ý nghĩa về mặt lịch sử vì chúng cho thấy rằng khoa học thần kinh tiếp tục có ảnh hưởng đến sự phát triển của các thuật toán học sâu. Glorot và cộng sự (2011a) cho rằng các đơn vị tuyến tính hiệu chỉnh có cảm hứng từ sinh học. Tính phi tuyến hiệu chỉnh nửa vời này nhằm mục đích nắm bắt các đặc tính tương tự của các tế bào neuron sinh học: (1) Đối với một số đầu vào, các tế bào neuron sinh học hoàn toàn không có phản ứng nào. (2) Đối với một số đầu vào, đầu ra của một neuron sinh học tỷ lệ với đầu vào của nó. (3) Phần lớn thời gian, các tế bào neuron sinh học hoạt động trong chế độ nghỉ (nghĩa là chúng có tính <em>kích hoạt thưa</em>).</p><p>Gần đây khi học sâu bắt đầu hồi sinh vào năm 2006, phương pháp mạng lan truyền thuận tiếp tục mang tiếng xấu. Từ khoảng năm 2006 đến năm 2012, người ta tin rằng các mạng lan truyền thuận sẽ không hoạt động tốt trừ khi chúng được hỗ trợ bởi các mô hình khác, chẳng hạn như các mô hình xác suất. Bây giờ thì người ta đã biết rằng với các nguồn lực và thực hành kỹ thuật phù hợp, các mạng lan truyền thuận hoạt động rất tốt. Ngày nay, việc học dựa trên gradient trong các mạng lan truyền thuận được sử dụng như một công cụ để phát triển các mô hình xác suất, chẳng hạn như bộ mã hóa tự động biến phân (variational autoencoder) và mạng sinh mẫu đối kháng (adversarial generative network) mà ta mô tả trong chương 20. Thay vì được xem như là một công nghệ không đáng tin cậy cần phải được hỗ trợ bởi các kỹ thuật khác, học dựa trên gradient trong các mạng lan truyền thuận từ năm 2012 đã được xem như là một công nghệ mạnh mẽ có thể được áp dụng cho nhiều tác vụ học máy khác nhau. Năm 2006, cộng đồng đã sử dụng học không giám sát để hỗ trợ việc học có giám sát và trớ trêu thay, giờ đây việc sử dụng học có giám sát để hỗ trợ việc học không giám sát trở nên ngày càng phổ biến.</p><p>Các mạng lan truyền thuận tiếp tục có những tiềm năng chưa được khai phá. Trong tương lai, chúng tôi hy vọng chúng sẽ được áp dụng cho nhiều tác vụ khác, và những tiến bộ trong thuật toán tối ưu hóa và thiết kế mô hình sẽ cải thiện hiệu suất của chúng hơn nữa. Chương này đã mô tả chủ yếu một họ các mô hình mạng neuron. Trong các chương tiếp theo, chúng ta sẽ chuyển sang cách sử dụng những mô hình này - về việc làm thế nào để kiểm soát và huấn luyện chúng.<br>
-------------------------------------------------<br>
---- SonAn kết thúc ở đây ----<br>
-------------------------------------------------<br>
---- Duong NGUYEN đã xem lại công thức đến đây (không chỉnh nội dung dịch) ----</p><p>-----------------------Hung Le đã review đến đây ------------------------<br>
-----------LA đã review đến đây --------------</p></div>