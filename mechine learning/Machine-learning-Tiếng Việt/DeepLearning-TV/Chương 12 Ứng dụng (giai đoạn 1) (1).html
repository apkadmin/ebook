<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-12-Ứng-dụng-giai-đoạn-1">Chương 12 Ứng dụng (giai đoạn 1)</h1><p>--------------<br>
<strong>Tình hình review</strong><br>
NguyenTT: Cơ bản đã hoàn thành</p><ul>
<li>Hoàn thành kiểm tra công thức</li>
<li>Hoàn thành phần thuật ngữ (format)</li>
<li>Hoàn thành phần citation  (format)</li>
<li>Hoàn thành phần nội dung</li>
</ul><p>Note:</p><ul>
<li>NguyenTT: Vì ràng buộc giới hạn độ dài của 1 note trong hackmd nên mình sẽ copy về máy bản gốc của phần dịch. Bạn nào cần xem bản dịch gốc liên hệ mình</li>
<li>Trong phần dịch có nhiều đoạn (ND:aaa) là diễn giải thêm của người dịch và chapter editor để dễ hiểu hơn.</li>
</ul><p>TODO:</p><ul>
<li>Sẽ check thuật ngữ so với các chapter khác.</li>
<li>2nd review for sure.</li>
<li></li>
</ul><p>--------------<br>
---------------<br>
438-440<br>
Linux bắt đầu dịch, NguyenTT đã review<br>
----------------<br>
Trong chương này, chúng tôi sẽ mô tả cách áp dụng học sâu cho các ứng dụng trong <em>thị giác máy tính</em> (computer vision), <em>nhận dạng giọng nói</em> (speech recognition), <em>xử lý ngôn ngữ tự nhiên</em> (natural language processing) và các lĩnh vực khác mang đến lợi ích thương mại. Chúng tôi bắt đầu bằng thảo luận về việc triển khai mạng neuron quy mô lớn, một phần không thể thiếu trong hầu hết các ứng dụng trí tuệ nhân tạo quan trọng. Tiếp theo, chúng ta cùng xem xét một số lĩnh vực ứng dụng cụ thể đã được ứng dụng học sâu để giải quyết vấn đề. Mặc dù, một trong những mục tiêu của học sâu là thiết kế các thuật toán có khả năng giải quyết đa dạng các tác vụ khác nhau, tuy nhiên cho đến nay, một mức độ chuyên biệt nào đó vẫn là cần thiết. Ví dụ, các tác vụ thị giác máy tính đòi hỏi xử lý một lượng lớn đặc trưng đầu vào (các điểm ảnh) trên mỗi mẫu huấn luyện. Các tác vụ xử lý ngôn ngữ đòi hỏi một mô hình có một lượng lớn các giá trị khả dĩ (các từ trong kho từ vựng) trên mỗi đặc trưng đầu vào.</p><h1 id="121-Học-sâu-quy-mô-lớn">12.1 Học sâu quy mô lớn</h1><p>Học sâu dựa trên triết lý của thuyết kết nối: mặc dù một neuron sinh học hoặc đặc trưng đơn lẻ trong mô hình học máy là không thông minh, nhưng khi một lượng lớn các neuron sinh học hoặc các đặc trưng này hoạt động cùng nhau, chúng có thể biểu hiện những hành vi thông minh. Điều này nhấn mạnh sự thật rằng số lượng neuron phải <em>lớn</em>. Một trong những nhân tố chính giúp nâng cao độ chính xác của mạng neuron và tăng độ phức tạp của các tác vụ mà chúng ta có thể giải quyết được từ thập kỉ 80 đến nay chính là sự gia tăng mạnh mẽ về kích thước của mạng neuron. Tuy nhiên, như đã thấy ở mục 1.2.3, dẫu cho kích cỡ mạng neuron tăng theo hàm mũ trong suốt 3 thập kỷ, chúng mới chỉ đạt được độ lớn xấp xỉ với hệ thần kinh của các loài côn trùng.</p><p>Kích cỡ của mạng neuron đóng vai trò quan trọng, nên học sâu yêu cầu cơ sở hạ tầng phần cứng và phần mềm đều phải có hiệu năng cao.</p><h2 id="1211-Triển-khai-trên-CPU-tốc-độ-cao">12.1.1 Triển khai trên CPU tốc độ cao</h2><p>Trước kia, mạng neuron được huấn luyện bằng CPU trên một máy đơn lẻ. Cách làm này nhìn chung là không hiệu quả vào những năm gần đây. Ngày nay, lựa chọn phổ biến là thực hiện tính toán trên GPU hoặc các CPU của nhiều máy tính được kết nối với nhau. Trước khi chuyển sang sử dụng các thiết bị tốn kém này, nhiều nhà nghiên cứu đã từng cố gắng chứng minh rằng các hệ nhiều CPU không thể quản lý lượng tính toán lớn theo yêu cầu của mạng neuron.</p><p>Tuy việc mô tả cách thực thi tính toán trên CPU một cách hiệu quả nằm ngoài phạm vi của cuốn sách này, nhưng chúng tôi nhấn mạnh rằng, việc cài đặt một cách cẩn thận cho từng dòng CPU riêng biệt có thể mang lại những cải thiện đáng kể. Ví dụ, năm 2011, CPU nhanh nhất sẵn có thể xử lý khối lượng tính toán của mạng neuron nhanh hơn khi sử dụng kỹ thuật tính toán số học với <em>dấu phẩy tĩnh</em> (fixed-point arithmetic) thay vì <em>dấu phẩy động</em> (floating-point arithmetic). Bằng cách thực thi với sự tinh chỉnh kỹ lưỡng dấu phẩy tĩnh, Vanhoucke và cộng sự (2011) đã đạt được tốc độ nhanh gấp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">3</script></span> lần so với hệ thống sử dụng dấu phẩy động. Mỗi mô hình CPU mới lại có những đặc tính hiệu năng khác nhau, nên thỉnh thoảng, việc thực thi dấu phẩy động cũng có thể mang lại tốc độ nhanh hơn (so với dấu phẩy tĩnh). Điều quan trọng chúng tôi muốn nhấn mạnh ở đây là việc tinh chỉnh cẩn thận các phép tính số học theo từng dòng CPU có thể mang lại hiệu quả cao. Ngoài lựa chọn dấu phẩy động hay tĩnh, người ta còn dùng nhiều thủ thuật khác bao gồm tối ưu cấu trúc dữ liệu để tránh <em>trượt bộ đệm</em> (cache miss) và sử dụng <em>tập lệnh vector</em> (vector intructions). Nhiều nhà nghiên cứu học máy không để ý đến những chi tiết này, nhưng khi hiệu năng của việc triển khai hạn chế kích thước của mô hình, độ chính xác của mô hình sẽ bị ảnh hưởng.</p><h2 id="1212-Triển-khai-trên-GPU">12.1.2 Triển khai trên GPU</h2><p>Hầu hết khối lượng tính toán của mạng neuron hiện đại ngày nay đều được thực hiện trên các bộ xử lý đồ họa. Các bộ xử lý đồ họa (GPU) là các linh kiện phần cứng vốn được phát triển cho các ứng dụng đồ họa. Thị trường video game đã thúc đẩy sự phát triển của các phần cứng xử lý đồ họa. Các đặc tính về mặt hiệu năng cần thiết cho các hệ thống game hóa ra lại có lợi cho các mạng neuron.</p><p>Hiển thị hình ảnh trong game đòi hỏi việc thực hiện hàng loạt phép tính toán song song với tốc độ cao. Mô hình của các nhân vật và môi trường trong game được xác định thông qua một danh sách các tọa độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mn" id="MJXp-Span-4">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">3</script></span> chiều của các đỉnh (ND: các khối đa diện hợp thành những hình thù trong game). Card đồ họa phải thực hiện các phép nhân và chia ma trận của nhiều đỉnh đồng thời để chuyển đổi những tọa độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-8"><span class="mn" id="MathJax-Span-9" style="font-family: MathJax_Main;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">3</script></span> chiều này thành tọa độ 2$ chiều trên màn hình. Sau đó chúng phải thực hiện nhiều tính toán đồng thời trên mỗi điểm ảnh để xác định màu sắc của những điểm ảnh đó. Trong cả 2 trường hợp, các phép tính toán đều tương đối đơn giản và không bao gồm các thao tác so sánh rẽ nhánh như các thao tác tính toán thường thấy trên CPU. Ví dụ, mỗi đỉnh của một vật thể rắn đều sẽ được nhân với cùng một ma trận; ta không cần thiết phải thực thi lệnh if trên mỗi đỉnh để xác định xem nó sẽ nhân với ma trận nào. Các tính toán cũng hoàn toàn độc lập với nhau, và vì thế có thể thực hiện song song một cách dễ dàng. Quá trình tính toán cũng bao gồm việc xử lý các <em>bộ nhớ đệm</em> (buffer) lớn, bao gồm các ma trận điểm ảnh mô tả bề mặt (mảng màu sắc) của mỗi vật thể cần hiển thị. Tóm lại, những điều này dẫn đến việc các card đồ họa được thiết kế để có khả năng song song hoá và băng thông bộ nhớ ở cấp độ cao. Đổi lại, chúng có tốc độ xung nhịp thấp hơn và ít khả năng phân nhánh hơn so với các CPU truyền thống.</p><p>Các thuật toán mạng neuron yêu cầu các đặc tính về hiệu năng tương tự như các thuật toán đồ họa thời gian thực kể trên. Mạng neuron thường bao gồm một lượng lớn bộ đệm chứa các tham số của mô hình, các giá trị kích hoạt và gradient, mỗi trong số chúng đều phải được cập nhật hoàn toàn sau mỗi bước huấn luyện. Lượng bộ đệm cần dùng ở đây vượt quá bộ nhớ cache của các máy tính để bàn truyền thống, vì vậy băng thông bộ nhớ của hệ thống thường trở thành yếu tố hạn chế tốc độ. GPU cung cấp một lợi thế rõ rệt so với CPU nhờ băng thông bộ nhớ cao của chúng. Các thuật toán huấn luyện mạng neuron thường không bao gồm nhiều nhánh hay những thao tác điều khiển phức tạp, vì vậy chúng phù hợp với các thiết bị GPU. Bởi mạng neuron có thể được chia thành nhiều nhóm neuron riêng lẻ có thể xử lý độc lập với các neuron khác trên cùng một tầng, nên chúng tận dụng được lợi thế tính toán song song của GPU.</p><p>Phần cứng GPU ban đầu được thiết kế chuyên biệt đến nỗi chỉ có thể được áp dụng trong các tác vụ đồ họa. Theo thời gian, chúng trở nên linh hoạt hơn, cho phép các chương trình con tùy biến có thể được sử dụng để chuyển đổi tọa độ của các đỉnh hoặc gán màu cho các điểm ảnh. Về nguyên tắc, không có yêu cầu nào buộc các giá trị điểm ảnh này thực sự dựa trên một tác vụ dựng hình (render). Những GPU này có thể được sử dụng cho các tính toán khoa học bằng cách ghi lại kết quả tính toán xuống một bộ nhớ đệm các giá trị điểm ảnh. Steinkrau và cộng sự (2005) đã thực thi mạng neuron hai tầng kết nối đầy đủ trên GPU và cho thấy tốc độ nhanh gấp ba lần so với CPU. Ngay sau đó, Chellapilla và cộng sự (2006) đã chứng minh rằng có thể tăng tốc độ tính toán các mạng tích chập có giám sát với cùng một kỹ thuật như trên.</p><p>Sự phổ biến của card đồ họa trong việc huấn luyện mạng neuron thực sự bùng nổ sau khi các <em>GPU đa mục đích</em> (General Purpose GPU - GP-GPU) ra đời. Các GP-GPU có thể thực thi các đoạn mã tùy ý, thay vì dành riêng cho các chương trình con dựng hình như trước đây. Ngôn ngữ lập trình CUDA của NVIDIA cung cấp một cách để viết đoạn mã tùy ý này bằng ngôn ngữ tương tự như C. Với mô hình lập trình tương đối thuận lợi, tính toán song song mạnh mẽ, bằng thông bộ nhớ cao, GP-GPU giờ đây cho ta một nền tảng lý tưởng cho lập trình mạng neuron. Các nhà nghiên cứu học sâu đã nhanh chóng chấp nhận nền tảng này ngay sau khi nó trở nên sẵn có [Raina et al., 2009; Ciresan et al., 2010]</p><p>---------<br>
NguyenTT bắt đầu dịch từ đây: p441-447<br>
NguyenTT: đã tự review. LA sẽ kiểm tra chéo<br>
------------------<br>
Viết mã hiệu quả cho GP-GPU vẫn là một tác vụ khó cho các chuyên gia. Các kĩ thuật cần thiết để đạt được hiệu năng tốt trên GPU rất khác với kĩ thuật được sử dụng trên CPU. Ví dụ, mã hiệu quả trên nền tảng CPU thường được thiết kế để đọc thông tin từ bộ nhớ cache càng nhiều càng tốt. Trên GPU, hầu hết các vị trí bộ nhớ có thể ghi được đều không được ghi vào cache, do đó, thực tế là tính một giá trị hai lần sẽ nhanh hơn so với tính một lần và đọc lại nó từ bộ nhớ vào lần sau. Mã cho GPU cũng là đa luồng và các luồng khác nhau phải được phối hợp với nhau một cách cẩn thận. Ví dụ, các thao tác bộ nhớ sẽ nhanh hơn nếu chúng được <em>hợp nhất</em> (coalesced). Việc đọc hoặc ghi hợp nhất xảy ra khi một số luồng có thể đọc hoặc ghi một giá trị mà chúng cần cùng lúc, như là một phần của một giao dịch bộ nhớ. Các mô hình khác nhau của GPU có thể kết hợp các kiểu đọc khác nhau và các kiểu ghi khác nhau. Thông thường, các thao tác bộ nhớ thường dễ kết hợp hơn nếu giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">n</script></span> luồng, luồng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">i</script></span> truy cập byte thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">i</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">i+j</script></span> của bộ nhớ, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">j</script></span> là một bội số của số lũy thừa của 2. Các mô tả chính xác cũng khác nhau giữa các mô hình của GPU. Một mối quan tâm phổ biến khác với GPU là đảm bảo rằng mỗi luồng trong cùng một nhóm nào đó đồng thời thực thi cùng một <em>câu lệnh</em> (instruction). Nghĩa là kĩ thuật phân nhánh có thể khó thực hiện trên GPU. Luồng được chia thành các nhóm nhỏ gọi là <strong>warp</strong>. Mỗi luồng trong một warp thực thi cùng một câu lệnh trong mỗi chu kì, vì vậy nếu các luồng khác nhau trong cùng một warp cần thực thi những đoạn code khác nhau, các đường dẫn code khác nhau này cần được thực thi tuần tự thay vì song song.</p><p>Do những khó khăn đó trong việc viết code hiệu năng cao trên GPU, các nhà nghiên cứu nên xây dựng luồng làm việc sao cho tránh việc phải viết code mới trên GPU để kiểm nghiệm một mô hình hoặc giải thuật mới. Thông thường, người ta có thể giải quyết vấn đề này bằng cách xây dựng một thư viện phần mềm gồm các thao tác tính toán hiệu năng cao như phép tích chập và phép nhân ma trận, sau đó đặc tả mô hình bằng cách gọi các thao tác tính toán của thư viện này. Ví dụ, thư viện học máy Pylearn2 [Goodfellow et al., 2013c] đặc tả tất cả thuật toán học máy của mình bằng các lời gọi đến Theano [Bergstra et al., 2010; Bastien et al., 2012] và cuda-convnet [Krizhevsky, 2010], những thư viện cung cấp các thao tác tính toán hiệu năng cao. Cách tiếp cận này có thể dễ dàng hỗ trợ nhiều nền tảng phần cứng khác nhau. Ví dụ, cùng một chương trình Theano có thể chạy trên cả CPU và GPU mà không cần bất kì thay đổi nào trong lúc gọi hàm trong thư viện Theano. Các thư viện khác như TensorFlow [Abadi et al., 2015] và Torch [Collobert et al., 2011b] cũng cung cấp các tính năng tương tự.</p><h2 id="1213-Triển-khai-phân-tán-quy-mô-lớn">12.1.3 Triển khai phân tán quy mô lớn</h2><p>Trong nhiều trường hợp, tài nguyên tính toán trên một máy tính đơn lẻ là không đủ. Do đó, chúng ta muốn phân chia khối lượng công việc của quá trình học và suy luận trên nhiều máy tính.</p><p>Phân chia quá trình suy luận khá đơn giản, bởi vì chúng ta muốn mỗi mẫu đầu vào có thể được thực thi bởi một máy riêng biệt. Điều này được gọi là <strong>song song dữ liệu</strong> (data parallelism).</p><p>Cũng có thể có <strong>song song mô hình</strong> (model parallelism), trong đó nhiều máy làm việc với nhau trên một điểm dữ liệu, mỗi máy thực thi một phần khác nhau của mô hình. Điều này là khả thi cho cả quá trình suy luận và quá trình huấn luyện.</p><p>Song song dữ liệu trong quá trình huấn luyện một phần nào đó là khó hơn. Chúng ta có thể tăng kích thước của lô nhỏ được sử dụng trong một bước của trượt gradient ngẫu nhiên, nhưng thông thường chúng ta nhận được hiệu suất tối ưu hóa dưới mức tuyến tính. Cho phép các máy tính toán các bước của trượt gradient một cách song song sẽ cho kết quả tốt hơn. Thật không may, định nghĩa tiêu chuẩn của trượt gradient là một giải thuật tuần tự hoàn toàn: gradient của bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">t</script></span> là một hàm của các tham số được tạo bởi bước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-22">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">t-1</script></span>.</p><p>Điều này có thể được giải quyết bằng cách sử dụng <strong>trượt gradient ngẫu nhiên không đồng bộ</strong> (asynchronous stochastic gradient descent) [Bengio et al., 2001; Recht et al., 2011]. Trong phương pháp này, một vài <em>lõi</em> (core) của bộ xử lý chia sẻ bộ nhớ đại diện cho các tham số. Mỗi lõi đọc tham số mà không cần <em>khóa</em> (lock) lại. Điều này làm giảm lượng cải thiện trung bình mà mỗi bước trượt gradient tạo ra, bởi vì một số lõi sẽ ghi đè tiến độ của nhau, nhưng tăng tốc độ của các bước làm cho tổng thể quá trình học diễn ra nhanh hơn. Dean et al. (2012) đi tiên phong trong triển khai nhiều máy với phương pháp không khóa này cho trượt gradient, ở đó các tham số được quản lý bởi một <strong>máy chủ tham số</strong> (parameter server) thay vì được lưu trong bộ nhớ dùng chung. Trượt gradient không đồng bộ phân tán (distributed asynchronous gradient descent) vẫn là một chiến lược chính để huấn luyện mạng học sâu lớn và được sử dụng bởi hầu hết các nhóm làm về học sâu trong doanh nghiệp [Chilimbi et al., 2014; Wu et al., 2015]. Các nhà nghiên cứu học sâu trong môi trường học thuật thông thường không có khả năng chi trả cho các hệ thống học sâu phân tán có cùng quy mô, nhưng một số nhà nghiên cứu đã tập trung vào cách xây dựng mạng phân tán với phần cứng có chi phí phần cứng tương đối thấp cho việc lắp đặt trong môi trường đại học [Coates et al., 2013].</p><h2 id="1214-Nén-mô-hình-Model-compression">12.1.4 Nén mô hình (Model compression)</h2><p>Trong nhiều ứng dụng thương mại của các mô hình học máy, việc giảm thời gian và chi phí bộ nhớ của quá trình suy luận quan trọng hơn nhiều so với việc giảm thời gian chi phí bộ nhớ trong quá trình huấn luyện. Đối với các ứng dụng không đòi hỏi tính cá nhân hóa của người dùng, ta có thể huấn luyện mô hình một lần, sau đó triển khai để sử dụng cho hàng tỉ người dùng khác nhau. Trong nhiều trường hợp, người dùng cuối bị hạn chế về tài nguyên nhiều hơn so với các nhà phát triển. Chẳng hạn, ta có thể huấn luyện một mô hình nhận dạng tiếng nói trên một cụm máy tính mạnh mẽ, sau đó triển khai nó thành ứng dụng cài đặt lên điện thoại di động.</p><p>Chiến lược chính để giảm chi phí của quá trình suy luận là <strong>nén mô hình</strong> (model compression) [Bucilua et al., 2006]. Ý tưởng cơ sở của nén mô hình là thay thế mô hình gốc có chi phí cao bởi một mô hình nhỏ hơn, yêu cầu ít hơn bộ nhớ và thời gian cho việc lưu trữ và đánh giá.</p><p>Nén mô hình có thể ứng dụng khi kích thước của mô hình gốc được thiết kế nhằm mục đích tránh sự quá khớp. Trong hầu hết các trường hợp, mô hình với sai số tổng quát hóa thấp nhất là tập hợp của một vài mô hình được huấn luyện độc lập. Việc đánh giá toàn bộ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">n</script></span> thành viên của tập hợp này khá tốn kém. Đôi khi, một mô hình đơn lẻ thậm chí có thể tổng quát hóa tốt hơn nếu đó là một mô hình lớn (chẳng hạn nếu nó được kiểm soát với cơ chế tắt ngẫu nhiên ).</p><p>Những mô hình lớn này học một số hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">f</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-28">x</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-35"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">f(\boldsymbol{x})</script></span>, nhưng bằng cách sử dụng nhiều tham số hơn mức cần thiết cho tác vụ. Kích thước của những mô hình này chỉ cần thiết khi số lượng điểm dữ liệu huấn luyện bị giới hạn. Sau khi khớp với hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">f</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-33">x</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">f(\boldsymbol{x})</script></span> này, ta có thể sinh ra một tập huấn luyện bao gồm rất nhiều điểm dữ liệu, đơn giản bằng cách áp dụng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">f</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">f</script></span> cho các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-38">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\boldsymbol{x}</script></span> được lấy mẫu ngẫu nhiên. Sau đó chúng ta học một mô hình mới nhỏ hơn, sao cho khớp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">f</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-42">x</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">f(\boldsymbol{x})</script></span> trên những điểm dữ liệu này. Để tận dụng hiệu quả dung lượng của mô hình nhỏ hơn này, tốt hơn hết ta nên lấy mẫu các điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-45">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\boldsymbol{x}</script></span> từ một phân phối tương tự với các điểm dữ liệu kiểm thử đầu vào thực tế sẽ được cung cấp cho mô hình sau này. Điều này có thể thực hiện bằng cách lấy các điểm từ một mô hình sinh được đào tạo trên tập huấn luyện ban đầu.</p><blockquote>
<p>ND: Đoạn trên đang nói về việc sau khi học xong hàm f(x) phức tạp (pre-train), có thể học mô hình mới nhỏ hơn trên một tập dữ liệu mới bằng cách thay các giá trị x ngẫu nhiên vào f(x) để có 1 cặp x,f(x) mới -&gt; một sample mới dành cho supervisor learning.</p>
</blockquote><p>Ngoài ra, người ta có thể huấn luyện mô hình nhỏ hơn chỉ trên các điểm dữ liệu huấn luyện ban đầu để sao chép các đặc trưng khác của mô hình (gốc), chẳng hạn như phân phối hậu nghiệm trên các lớp không chính xác [Hinton et al., 2014, 2015].</p><h2 id="1215-Cấu-trúc-động-Dynamic-Structure">12.1.5 Cấu trúc động (Dynamic Structure)</h2><p>Một chiến lược để tăng tốc hệ thống xử lý dữ liệu nói chung là xây dựng những hệ thống có <strong>cấu trúc động</strong> (dynamic structure) trong biểu đồ mô tả sự tính toán cần thiết để xử lý một điểm dữ liệu đầu vào. Hệ thống xử lý dữ liệu có thể xác định một cách linh động những tập con nào trong các mạng neuron nhân tạo nên được thực thi đối với một điểm dữ liệu đầu vào cho trước. Cấu trúc động cũng có thể được sử dụng bên trong các mạng neuron riêng lẻ bằng cách xác định tập con của các đặc trưng (các đơn vị ẩn) để tính toán khi đã biết trước thông tin từ dữ liệu đầu vào. Dạng cấu trúc động bên trong các mạng neuron này đôi khi được gọi là <strong>tính toán có điều kiện</strong> (conditional computation) [Bengio, 2013; Bengio et al., 2013b]. Bởi vì rất nhiều thành phần của kiến trúc có thể liên quan tới một lượng nhỏ các điểm dữ liệu đầu vào, nên hệ thống có thể chạy nhanh hơn bằng cách chỉ tính toán các đặc trưng khi cần thiết.</p><p>Cấu trúc động trong tính toán là một nguyên tắc cơ bản của khoa học máy tính được áp dụng rất nhiều trong các quy tắc của kỹ sư phần mềm. Những phiên bản đơn giản nhất của cấu trúc động áp dụng cho mạng neuron nhân tạo dựa trên việc xác định tập con nào trong nhóm các mạng neuron nhân tạo (hoặc các mô hình học máy khác) nên được áp dụng cho một điểm dữ liệu đầu vào cụ thể.</p><p>Một chiến lược đáng cân nhắc để tăng tốc quá trình suy luận trong một bộ phân lớp chính là dùng một <strong>chuỗi phân tầng</strong> (cascade) của các bộ phân lớp. Chiến lược phân tầng có thể được sử dụng với mục đích phát hiện sự hiện diện của một đối tượng (hoặc sự kiện) hiếm gặp. Để biết chắc rằng đối tượng có xuất hiện, chúng ta phải sử dụng một bộ phân lớp tinh vi với dung lượng lớn và rất tốn kém khi thực thi. Tuy nhiên, vì đối tượng này hiếm gặp, nên ta có thể sử dụng lượng tính toán ít hơn nhiều để loại bỏ các dữ liệu đầu vào vốn không chứa đối tượng. Trong trường hợp này, chúng ta có thể huấn luyện trên một chuỗi các bộ phân lớp. Những bộ phân lớp đầu tiên trong chuỗi có dung lượng thấp và được huấn luyện để sử dụng lại nhiều lần. Nói cách khác, chúng được huấn luyện để đảm bảo rằng chúng ta không loại bỏ sai một dữ liệu đầu vào nào mà đối tượng xuất hiện trong đó. Bộ phân lớp cuối cùng được huấn luyện để có độ chính xác cao. Khi kiểm thử, chúng ta thực hiện suy luận bằng cách thực thi các bộ phân lớp theo chuỗi, loại bỏ bất cứ ví dụ huấn luyện nào bị từ chối bởi một thành phần trong chuỗi phân tầng. Nói chung, điều này cho phép chúng ta xác định sự xuất hiện của các đối tượng với độ chắc chắn cao, và theo cách này, mặc dù ta sử dụng một mô hình dung lượng cao, nhưng lại không phải bỏ ra chi phí suy luận trên mọi ví dụ huấn luyện. Có hai cách khác nhau để chuỗi phân tầng có thể đạt được hiệu quả cao. Một cách là làm cho các thành phần sau của chuỗi phân tầng có hiệu quả cao. Trong trường hợp này, toàn hệ thống rõ ràng là có hiệu quả cao, nhờ một vài thành phần riêng lẻ của nó. Cũng có thể tạo ra một chuỗi phân tầng mà ở đó tất cả các mô hình đơn lẻ có hiệu quả thấp nhưng toàn hệ thống lại có hiệu quả cao nhờ sự kết hợp của nhiều mô hình nhỏ. Viola và Jones (2001) sử dụng một chuỗi phân tầng gồm các <em>cây quyết định tăng cường</em> (boosted decision tree) để cài đặt một bộ phát hiện khuôn mặt nhanh và mạnh mẽ phù hợp để sử dụng trong các máy ảnh kĩ thuật số cầm tay. Bộ phân lớp của họ cục bộ hóa một khuôn mặt bằng cách sử dụng phương pháp tiếp cận <em>cửa sổ trượt</em> (sliding window) mà ở đó rất nhiều các cửa sổ bị kiểm tra và từ chối nếu chúng không chứa khuôn mặt. Một phiên bản khác của chuỗi phân tầng sử dụng các mô hình trước đó để cài đặt một loại <em>cơ chế chú ý cứng</em> (hard attention mechanism): các thành phần ban đầu của chuỗi phân tầng cục bộ hóa một đối tượng, và các thành phần sau của chuỗi phân tầng thực hiện các xử lý tiếp theo cho vị trí của đối tượng. Ví dụ, Google phiên dịch số địa chỉ từ hình ảnh Street View bằng cách sử dụng một chuỗi phân tầng hai bước, đầu tiên xác định vị trí của bảng địa chỉ với một mô hình học máy và sau đó nhận dạng số địa chỉ bằng một mô hình khác [Goodfellow et al., 2014d].</p><p>// ----- Xuan Tu review đến đây ----------</p><blockquote>
<p>Cascading is a particular case of ensemble learning based on the concatenation of several Classifiers, using all information collected from the output from a given classifier as additional information for the next classifier in the cascade. Nguồn: <a href="https://en.wikipedia.org/wiki/Cascading_classifiers" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Cascading_classifiers</a></p>
</blockquote><p>Bản thân <em>cây quyết định</em> (decision tree) là một ví dụ của cấu trúc động, bởi vì mỗi nút của cây sẽ xác định xem cây con nào của nó nên được đánh giá cho mỗi đầu vào. Một cách đơn giản để hoàn thiện sự kết hợp giữa học sâu và cấu trúc động là huấn luyện một cây quyết định, ở đó mỗi nút sử dụng một mạng neuron để tạo ra các quyết định chia tách [Guo and Gelfand, 1992], mặc dù điều này thường không được thực hiện với mục tiêu chính là tăng tính toán suy luận.</p><p>Với cùng tinh thần như vậy, người ta sử dụng một mạng neuron nhân tạo được gọi là <strong>gater</strong> để chọn một trong số các <em>mạng chuyên gia</em> (expert networks) để tính toán đầu ra cho một đầu vào xác định. Phiên bản đầu tiên của ý tưởng này được gọi là <em>hỗn hợp nhiều chuyên gia</em> (mixture of experts) [Nowlan, 1990; Jacobs et al., 1991], trong đó gater đưa ra một tập hợp các xác suất hoặc trọng số (thu được thông qua một softmax phi tuyến), mỗi chuyên gia tương ứng với một xác suất và trọng số, và kết quả cuối cùng thu được bằng cách kết hợp trọng số đầu ra của các chuyên gia này. Trong trường hợp này, việc sử dụng gater không làm giảm chi phí tính toán nhưng nếu một chuyên gia đơn lẻ được chọn bởi gater cho mỗi ví dụ đầu vào, chúng ta đạt được <strong><em>hỗn hợp cứng nhiều chuyên gia</em> (the hard mixture of experts)</strong> [Collobert et al., 2001, 2002], điều mà có thể tăng tốc đáng kể thời gian của quá trình học và suy luận. Chiến lược này cho hiệu quả tốt khi số lượng lựa chọn của gater là nhỏ bởi vì nó không có tính tổ hợp. Nhưng khi chúng ta muốn lựa chọn các tập con khác nhau của các đơn vị hoặc tham số, không thể sử dụng một <em>“chuyển đổi mềm”</em> (soft switch) bởi vì nó yêu cầu ta phải liệt kê (và tính toán giá trị đầu ra cho) tất cả các lựa chọn của gater. Để đối phó với vấn đề này, một vài phương pháp đã tìm cách huấn luyện tổ hợp của gater. Bengio và cộng sự (2013b)  thử nghiệm với một vài ước lượng của gradient trên xác suất của gater, trong khi Bacon và cộng sự. (2015), Bengio và cộng sự (2015a) sử dụng kĩ thuật <em>học tăng cường</em> (reinforcement learning) để học một dạng của <em>cơ chế tắt ngẫu nhiên có điều kiện</em> (conditional dropout) trên các khối của các đơn vị ẩn và thực tế làm giảm chi phí tính toán mà không ảnh hưởng xấu đến chất lượng của quá trình xấp xỉ.</p><p>Một trở ngại lớn trong việc sử dụng các hệ thống có cấu trúc động là khả năng tính toán song song bị giảm do hệ thống sử dụng các nhánh code khác nhau cho các đầu vào khác nhau. Điều này có nghĩa là một số thao tác trong mạng có thể được mô tả như phép nhân hoặc phép nhân theo lô trên một số mẫu nhỏ. Chúng ta có thể viết các chương trình con chuyên biệt để biến đổi mỗi mẫu với các lõi khác nhau hoặc nhân mỗi hàng của một ma trận với một tập các cột trọng số khác. Thật không may, khó có thể thực thi những chương trình con chuyên biệt này một cách hiệu quả. Thực thi trên CPU thì sẽ chậm do thiếu sự kết hợp với bộ đệm, và thực thi trên GPU cũng sẽ chậm vì thiếu giao dịch với bộ nhớ liên hợp và vì nhu cầu tuần tự hóa các warp khi các các thành phần của warp nằm trên các nhánh code khác nhau. Trong một số trường hợp, những vấn đề này có thể được giảm thiểu bằng cách phân vùng các ví dụ thành các nhóm mà tất cả các ví dụ của nhóm đều nằm trên cùng một nhánh, sau đó xử lý các nhóm này cùng một lúc. Đây có thể là một chiến lược chấp nhận được để tối thiểu hóa thời gian cần thiết dùng để xử lý một lượng ví dụ cố định khi làm việc thiết lập offline. Đối với thiết lập thời gian thực, khi mà các ví dụ cần được xử lý liên tục, phân vùng khối lượng công việc có thể gây ra vấn đề về cân bằng tải. Ví dụ, nếu chúng ta chỉ định một máy để xử lý bước đầu tiên trong chuỗi phân tầng và một máy khác để xử lý bước cuối của chuỗi phân tầng, thì máy đầu tiên có xu hướng bị quá tải và máy cuối sẽ bị dư tải. Các vấn đề tương tự nảy sinh nếu mỗi máy được chỉ định để thực thi các nút khác nhau của cây quyết định.</p><blockquote>
<p>warp: nhóm các luồng. Xem thêm ở 12.1.2</p>
</blockquote><h2 id="1216-Thực-thi-mạng-học-sâu-trên-phần-cứng-chuyên-dụng">12.1.6 Thực thi mạng học sâu trên phần cứng chuyên dụng</h2><p>Từ những ngày đầu nghiên cứu mạng neuron nhân tạo, các nhà nghiên cứu, thiết kế phần cứng đã xây dựng các phần cứng chuyên dụng nhằm tăng tốc quá trình huấn luyện và/hoặc quá trình suy luận của các thuật toán mạng neuron nhân tạo. Bạn đọc có thể xem thêm các tổng kết về phần cứng chuyên dụng dành cho mạng học sâu ở [Lindsey and Lindblad, 1994; Beiu et al., 2003; Misra and Saha, 2010].</p><p>Các dạng khác nhau của phần cứng chuyên dụng [Graf and Jackel, 1989; Mead and Ismail, 2012; Kim et al., 2009; Pham et al., 2012; Chen et al., 2014a,b] đã được phát triển trong những thập kỉ gần đây với ASICs (<em>mạch tích hợp chuyên dụng</em> - application-specific intergated circuits), hoặc với kỹ thuật số (dựa trên biểu diễn số nhị phân), công nghệ analog [Graf and Jackel, 1989; Mead and Ismail, 2012] (dựa trên những thực thi vật lý của các giá trị liên tục như điện áp hoặc cường độ dòng điện), hoặc với công nghệ hỗn hợp (kết hợp các thành phần số và analog). Những năm gần đây thực thi linh động hơn bằng FPGA (field progammable gated array) (ở đó các chi tiết mạch có thể được ghi lên chip sau khi chế tạo xong) đã được phát triển.</p><p>Mặc dù các thực thi phần mềm trên các bộ xử lý đa dụng (CPU và GPU) thường sử dụng độ chính xác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mn" id="MJXp-Span-47">32</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-63"><span class="mn" id="MathJax-Span-64" style="font-family: MathJax_Main;">32</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">32</script></span>-bit hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-mn" id="MJXp-Span-49">64</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-66"><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main;">64</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">64</script></span>-bit để biểu diễn số thực dấu phẩy động nhưng từ lâu người ta đã biết có thể sử dụng độ chính xác thấp hơn, ít nhất là trong quá trình suy luận [Holt and Baker, 1991; Holi and Hwang, 1993; Presley and Haggard, 1994; Simard and Graf, 1994; Wawrzynek et al., 1996; Savich et al., 2007]. Vấn đề này trở nên cấp thiết hơn trong những năm gần đây bởi học sâu đã trở nên phổ biến trong các sản phẩm công nghiệp thực tế, và bởi sự tác động lớn mang tính tích cực của các phần cứng tốc độ cao hơn đã được chứng minh với các GPU. Một yếu tố khác thúc đẩy những nghiên cứu hiện tại về phần cứng chuyên dụng cho mạng học sâu đó là tốc độ phát triển của một CPU hay GPU đơn lẻ đã chậm lại, và hầu hết những tiến bộ trong tốc độ tính toán đến từ việc song song hóa các bộ xử lý (trong các CPU hoặc GPU). Điều này rất khác với tình hình trong thập niên 1990 (kỷ nguyên gần nhất của mạng neuron nhân tạo), khi mà các thực thi phần cứng của các mạng neuron nhân tạo (có thể mất hai năm từ khi bắt đầu đến khi xuất hiện trên một con chip) không thể theo kịp tốc độ phát triển và giá thành rẻ của bộ xử lý đa chức năng CPU. Do đó, xây dựng một phần cứng chuyên dụng là một cách để vượt qua giới hạn, ở thời đại mà các thiết kế phần cứng mới được phát triển cho các thiết bị có công suất thấp như điện thoại, nhằm ứng dụng chung cho học sâu (chẳng hạn: nhận dạng giọng nói, thị giác máy tính hoặc ngôn ngữ tự nhiên).</p><p>Nghiên cứu gần đây về các thực thi mạng neuron với số thập phân độ chính xác thấp dựa trên lan truyền ngược [Vanhoucke et al., 2011; Courbariaux et al., 2015; Gupta et al., 2015] cho thấy rằng độ chính xác từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mn" id="MJXp-Span-51">8</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-69"><span class="mn" id="MathJax-Span-70" style="font-family: MathJax_Main;">8</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">8</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-52"><span class="MJXp-mn" id="MJXp-Span-53">16</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-72"><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main;">16</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">16</script></span> bit là đủ dùng cho quá trình huấn luyện các mạng neuron nhân tạo đa tầng dựa trên lan truyền ngược. Rõ ràng, quá trình huấn luyện yêu cầu độ chính xác cao hơn quá trình suy luận, và do đó một vài cấu trúc biểu diễn số với dấu phẩy tĩnh linh hoạt có thể được sử dụng để giảm số bit cần thiết khi biểu diễn một số. Các số thập phân dấu phẩy tĩnh truyền thống bị giới hạn trong một khoảng cố định (phụ thuộc vào thành phần số mũ trong biểu diễn dấu phẩy động). Trong khi các biểu diễn dấu phẩy tĩnh linh hoạt chia sẻ phạm vi này giữa một tập các số (chẳng hạn như tất cả các trọng số trong một tầng của mạng neuron). Sử dụng dấu phẩy tĩnh thay cho các biểu diễn dấu phẩy động và việc sử dụng một lượng bit nhỏ hơn cho mỗi số giúp giảm kích thước phần cứng, năng lượng tiêu thụ và thời gian tính toán cần thiết để thực hiện phép nhân, và phép nhân chính là phép tính được sử dụng nhiều nhất trong quá trình suy luận và huấn luyện của một mạng học sâu hiện tại dựa trên lan truyền ngược.</p><blockquote>
<p>ND: Để dễ hình dung, giá trị cuối cùng của một số dấu phẩy động là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mtext" id="MJXp-Span-56">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">s</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-61" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">e</span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-74"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-75"><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="mtext" id="MathJax-Span-78" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="msubsup" id="MathJax-Span-81" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.434em;"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">{\ s\times b^{e}}</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">s</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">s</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">s</script></span> là phần định trị, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">e</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-italic;">e</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">e</script></span> là phần số mũ. Nguồn: Wikipedia</p>
</blockquote><h1 id="122-Thị-giác-máy-tính-Computer-Vision">12.2 Thị giác máy tính (Computer Vision)</h1><p>Thị giác máy tính là một trong những lĩnh vực nghiên cứu tích cực nhất cho các ứng dụng của học sâu, bởi vì thị giác là một nhiệm vụ đơn giản đối với con người và rất nhiều loài động vật nhưng lại là thách thức đối với máy tính [Ballard et al., 1983]. Rất nhiều các tác vụ quy chuẩn phổ biến nhất cho các giải thuật học sâu nằm dưới dạng nhận diện vật thể hoặc nhận diện kí tự.</p><p>Thị giác máy tính là một lĩnh vực rất rộng bao gồm nhiều cách để xử lý hình ảnh với rất nhiều những ứng dụng đa dạng. Những ứng dụng của thị giác máy tính trải rộng từ việc tái tạo khả năng thị giác của con người, như là nhận diện khuôn mặt, đến việc tạo ra các phạm trù mới về khả năng thị giác. Ví dụ về thể loại thứ hai, một ứng dụng thị giác máy tính gần đây là nhận dạng sóng âm từ những rung động mà chúng tạo ra trên vật thể xuất hiện trong video [Davis et al., 2014]. Hầu hết các nghiên cứu học sâu trong thị giác máy tính không chỉ tập trung vào những ứng dụng kì lạ như vậy mà hơn nữa còn tập trung vào một mục tiêu cốt lõi của trí tuệ nhân tạo là hướng đến tái hiện khả năng của con người. Hầu hết học sâu trong thị giác máy tính được sử dụng để nhận dạng đối tượng hoặc phát hiện một số khuôn dạng, với nghĩa là báo cáo đối tượng nào đó có mặt trong một bức ảnh, chú thích một bức ảnh bằng những hình hộp xung quanh mỗi đối tượng, phiên dịch ra một chuỗi các kí tự từ một bức ảnh, hoặc dán nhãn mỗi điểm ảnh trong một bức ảnh với đối tượng mà nó thuộc về. Bởi vì mô hình sinh mẫu đã là một nguyên tắc dẫn dắt các nghiên cứu về học sâu, tổng hợp hình ảnh bằng các mô hình học sâu vẫn là một công việc nặng nhọc. Trong khi tổng hợp hình ảnh <em>ex nihilo</em> thường không được coi là vấn đề thị giác máy tính cần bỏ công sức, những mô hình có khả năng tổng hợp hình ảnh thường hữu ích cho việc khôi phục hình ảnh, một tác vụ trong thị giác máy tính liên quan tới sửa lỗi trong ảnh hoặc xóa đối tượng khỏi ảnh.</p><p>---------<br>
NguyenTT kết thúc dịch từ đây<br>
-----------------</p><p>//-- Trang 448 -452<br>
Nguyễn Văn Thành bắt đầu dịch từ đây</p><h2 id="1221-Tiền-xử-lý">12.2.1 Tiền xử lý</h2><p>Nhiều lĩnh vực ứng dụng của học sâu đòi hỏi quá trình tiền xử lý dữ liệu phức tạp, bởi các kiến trúc học sâu khó có khả năng xử lý dữ liệu này ở dạng nguyên gốc. Thị giác máy tính thường yêu cầu ít khâu tiền xử lý hơn so với các lĩnh vực khác. Các bức ảnh thường được chuẩn hóa để toàn bộ điểm ảnh của chúng nằm trong một dải xác định, chẳng hạn như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-67"><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-70"><span><span class="MJXp-mtr" id="MJXp-Span-71" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-72" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-73">0</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-75">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">]</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px; margin-right: 0.164em; margin-left: 0.164em;"><span style="position: absolute; clip: rect(3.235em, 1001.35em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1001.35em, 4.367em, -999.997em); top: -3.93em; left: 50%; margin-left: -0.698em;"><span class="mtd" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mn" id="MathJax-Span-99" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">]</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\begin{bmatrix} 0, 1 \end{bmatrix}</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-80"><span><span class="MJXp-mtr" id="MJXp-Span-81" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-82" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-84">1</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-86">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">]</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; margin-right: 0.164em; margin-left: 0.164em;"><span style="position: absolute; clip: rect(3.235em, 1002.16em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.367em, -999.997em); top: -3.93em; left: 50%; margin-left: -1.129em;"><span class="mtd" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-111" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">]</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\begin{bmatrix} -1, 1\end{bmatrix}</script></span>. Việc trộn các hình ảnh nằm trong dải <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mrow" id="MJXp-Span-89"><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-91"><span><span class="MJXp-mtr" id="MJXp-Span-92" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-93" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-94">0</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-96">1</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">]</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px; margin-right: 0.164em; margin-left: 0.164em;"><span style="position: absolute; clip: rect(3.235em, 1001.35em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1001.35em, 4.367em, -999.997em); top: -3.93em; left: 50%; margin-left: -0.698em;"><span class="mtd" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">]</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\begin{bmatrix} 0, 1\end{bmatrix}</script></span> với hình ảnh trong dải <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-101"><span><span class="MJXp-mtr" id="MJXp-Span-102" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-103" style="text-align: center;"><span class="MJXp-mn" id="MJXp-Span-104">0</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-106">255</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.111em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.444em; margin-left: 0.03em;">]</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; margin-right: 0.164em; margin-left: 0.164em;"><span style="position: absolute; clip: rect(3.235em, 1002.37em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1002.37em, 4.367em, -999.997em); top: -3.93em; left: 50%; margin-left: -1.237em;"><span class="mtd" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mn" id="MathJax-Span-133" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.164em;">255</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">]</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\begin{bmatrix} 0, 255 \end{bmatrix}</script></span> thường không thành công. Định dạng các hình ảnh về cùng một thang đo là bước tiền xử lý bắt buộc duy nhất. Nhiều kiến trúc thị giác máy tính yêu cầu các hình ảnh phải có cùng một kích thước chuẩn, do đó các hình ảnh phải được cắt bỏ hoặc thay đổi tỉ lệ để phù hợp với kích thước đó. Tuy nhiên, việc chuẩn hóa kích thước trên là không bắt buộc với một số kiến trúc mạng nhất định. Một số mô hình tích chập cho phép dữ liệu đầu vào có kích thước khác nhau, và mô hình sẽ tự điều chỉnh một cách linh hoạt kích thước các vùng “gộp” để cho đầu ra có kích thước xác định. Một số mô hình tích chập khác có thể tự điều chỉnh kích cỡ của đầu ra để giống với kích cỡ của ảnh đầu vào, chẳng hạn như các mô hình giảm nhiễu, hoặc các mô hình gán nhãn từng điểm ảnh [Hadsell et al., 2007].</p><p>Có một hình thức tiền xử lý chỉ dành cho tập huấn luyện là <em>tăng cường dữ liệu</em> (dataset augmentation). Đây là một phương pháp rất hiệu quả để giảm các sai số tổng quát hóa của hầu hết các mô hình thị giác máy tính. Một ý tưởng tương tự cho quá trình kiểm thử là ta có thể thử kiểm tra mô hình với các biến thể khác nhau của cùng một đầu vào. Ví dụ, ta có thể dùng một bức ảnh để kiểm thử, nhưng mỗi lần ta cắt lệch đi một chút. Một cách khác là ta có thể khởi tạo việc bình chọn mô hình theo nhiều cách khác nhau để xác định kết quả. Ý tưởng có thể được hiểu như là một cách tiếp cận đồng bộ, và nó có thể giúp làm giảm sai số tổng quát hóa.</p><p>Một số quá trình tiền xử lý khác có thể áp dụng cho cả tập huấn luyện lẫn tập kiểm thử đó là điều chỉnh các ví dụ học về gần dạng chính tắc hơn, để có thể giảm mức độ biến động mà mô hình phải chịu. Giảm mức độ biến động trong dữ liệu có thể đồng thời giảm được cả sai số tổng quát hóa lẫn kích thước mô hình cần thiết để khớp với tập huấn luyện. Có thể sử dụng các mô hình đơn giản hơn để giải quyết các nhiệm vụ đơn giản, và thường thì các giải pháp đơn giản có khả năng khái quát khá tốt. Quá trình tiền xử lý này thường được thực hiện để loại bỏ một vài loại biến động của dữ liệu nếu người thiết kế mô hình có thể mô tả và hiểu rằng nó không ảnh hưởng tới vấn đề cần giải quyết. Khi sử dụng một mô hình lớn để huấn luyện tập dữ liệu lớn, ta thường không cần đến khâu tiền xử lý kiểu này, mà chỉ cần để mô hình tự học xem loại biến động nào sẽ tự động được đánh giá là không ảnh hưởng tới chất lượng mô hình. Ví dụ, kiến trúc mạng AlexNet dùng để phân loại tập ImageNet chỉ có một quá trình tiền xử lý: trừ đi giá trị trung bình trong toàn tập huấn luyện với từng điểm ảnh.</p><h3 id="12211-Chuẩn-hóa-độ-tương-phản">12.2.1.1 Chuẩn hóa độ tương phản.</h3><p>Một trong những nguồn biến động rõ ràng nhất mà ta có thể yên tâm loại bỏ trong nhiều bài toán đó là mức độ tương phản của ảnh. Độ tương phản của ảnh chỉ đơn giản là mức độ khác biệt sáng tối trong ảnh. Có nhiều cách để định lượng độ tương phản này. Trong bối cảnh của học sâu, độ tương phản của ảnh thường được dùng để chỉ độ lệch chuẩn của các điểm ảnh trong một vùng hay toàn bộ bức ảnh. Giả sử, ta có một bức ảnh được biểu diễn bởi một tensor <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mrow" id="MJXp-Span-109"><span class="MJXp-mi undefined" id="MJXp-Span-110">X</span></span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mrow" id="MJXp-Span-113" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-114">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-115" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-116">r</span><span class="MJXp-mo" id="MJXp-Span-117">×</span><span class="MJXp-mi" id="MJXp-Span-118">c</span><span class="MJXp-mo" id="MJXp-Span-119">×</span><span class="MJXp-mn" id="MJXp-Span-120">3</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-138"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_SansSerif-bold;">X</span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main; padding-left: 0.272em;">∈</span><span class="msubsup" id="MathJax-Span-143" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="texatom" id="MathJax-Span-147"><span class="mrow" id="MathJax-Span-148"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">r</span><span class="mo" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">c</span><span class="mo" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mn" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\boldsymbol {\mathsf{X}} \in \mathbb{R} ^{\rm r \times c \times 3}</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-msubsup" id="MJXp-Span-122"><span class="MJXp-mrow" id="MJXp-Span-123" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-124">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-125" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">i</span><span class="MJXp-mo" id="MJXp-Span-127">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">j</span><span class="MJXp-mo" id="MJXp-Span-129">,</span><span class="MJXp-mn" id="MJXp-Span-130">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-157"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_SansSerif;">X</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\mathsf{X}_{i,j,1}</script></span> là cường độ màu đỏ tại hàng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">i</script></span>, cột <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-italic;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">j</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mrow" id="MJXp-Span-137" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-138">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">i</span><span class="MJXp-mo" id="MJXp-Span-141">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">j</span><span class="MJXp-mo" id="MJXp-Span-143">,</span><span class="MJXp-mn" id="MJXp-Span-144">2</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_SansSerif;">X</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">\mathsf{X}_{i,j,2}</script></span> tương ứng với cường độ màu xanh lá cây và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mrow" id="MJXp-Span-147" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-148">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-149" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">i</span><span class="MJXp-mo" id="MJXp-Span-151">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">j</span><span class="MJXp-mo" id="MJXp-Span-153">,</span><span class="MJXp-mn" id="MJXp-Span-154">3</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-187"><span class="msubsup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_SansSerif;">X</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">\mathsf{X}_{i,j,3}</script></span> ứng với cường độ màu xanh dương. Từ đây ta có độ tương phản của cả bức ảnh là : <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-155"><span class="MJXp-mtable" id="MJXp-Span-156"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-157" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-158" style="text-align: center;"><span class="MJXp-msqrt" id="MJXp-Span-159"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale5" style="font-size: 350%; margin-top: 0.04em; margin-left: -0.273em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.113em solid;"></span><span class="MJXp-box"><span class="MJXp-mfrac" id="MJXp-Span-160" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-161">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-162">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">c</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-165"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-171" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">r</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-167" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">i</span><span class="MJXp-mo" id="MJXp-Span-169">=</span><span class="MJXp-mn" id="MJXp-Span-170">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-173"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-179" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">c</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-175" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">j</span><span class="MJXp-mo" id="MJXp-Span-177">=</span><span class="MJXp-mn" id="MJXp-Span-178">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-181"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-187" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-188">3</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-183" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">k</span><span class="MJXp-mo" id="MJXp-Span-185">=</span><span class="MJXp-mn" id="MJXp-Span-186">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mrow" id="MJXp-Span-191" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-192">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-193" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">i</span><span class="MJXp-mo" id="MJXp-Span-195">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">j</span><span class="MJXp-mo" id="MJXp-Span-197">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-200"><span class="MJXp-mrow" id="MJXp-Span-201"><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-munderover" id="MJXp-Span-203"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo undefined" id="MJXp-Span-205" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span><span class="MJXp-mi undefined" id="MJXp-Span-204">X</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-206"><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-208" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-209">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-200"><span class="mtable" id="MathJax-Span-201" style="min-width: 19.776em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.776em;"><span style="display: inline-block; position: absolute; width: 13.041em; height: 0px; clip: rect(-2.206em, 1012.99em, 1.727em, -999.997em); top: 0em; left: 50%; margin-left: -6.517em;"><span style="position: absolute; clip: rect(2.427em, 1012.99em, 6.36em, -999.997em); top: -4.631em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.041em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1012.99em, 6.414em, -999.997em); top: -4.685em; left: 50%; margin-left: -6.517em;"><span class="mtd" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="msqrt" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 12.772em; height: 0px;"><span style="position: absolute; clip: rect(2.158em, 1011.75em, 5.552em, -999.997em); top: -4.038em; left: 1.026em;"><span class="mrow" id="MathJax-Span-208"><span class="mfrac" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1001.4em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.698em;"><span class="mrow" id="MathJax-Span-211"><span class="mn" id="MathJax-Span-212" style="font-family: MathJax_Main;">3</span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.51em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.511em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-215" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.33em, 4.151em, -999.997em); top: -5.116em; left: 0.541em;"><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-225" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.13em, 4.421em, -999.997em); top: -2.907em; left: 0.11em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.33em, 4.151em, -999.997em); top: -5.116em; left: 0.595em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-235" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-237"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.33em, 4.151em, -999.997em); top: -5.116em; left: 0.541em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="mn" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_SansSerif;">X</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="texatom" id="MathJax-Span-258" style="padding-left: 0.218em;"><span class="mrow" id="MathJax-Span-259"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="texatom" id="MathJax-Span-262"><span class="mrow" id="MathJax-Span-263"><span class="munderover" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_SansSerif-bold;">X</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.49em, 3.613em, -999.997em); top: -4.254em; left: 0.057em;"><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main-bold;">¯</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="mn" id="MathJax-Span-271" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.044em;"></span></span><span style="position: absolute; clip: rect(3.559em, 1011.7em, 3.936em, -999.997em); top: -5.655em; left: 1.026em;"><span style="display: inline-block; position: relative; width: 11.695em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: -0.105em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: 10.994em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 0.434em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 1.026em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 1.565em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 2.158em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 2.697em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 3.235em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 3.828em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 4.367em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 4.96em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 5.498em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 6.037em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 6.63em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 7.169em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 7.707em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 8.3em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 8.839em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 9.432em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 9.97em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.984em; left: 10.509em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(4.475em, 1001.08em, 8.408em, -999.997em); top: -6.624em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.392em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.237em; left: 0em;">⎷<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.799em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.152em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.636em;"></span></span></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.636em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.636em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-12.1"><span class="mrow" id="MathJax-Span-203"><span class="mtext" id="MathJax-Span-204" style="font-family: MathJax_Main;">(12.1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">\sqrt{\frac{1}{3rc} \sum\limits_{i=1}^{r} \sum\limits_{j=1}^{c} \sum\limits_{k=1}^{3} (\mathsf{X}_{i,j,k} - \boldsymbol{\mathsf{{\bar{X}}}}) ^{\rm 2}}, \tag{12.1}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-munderover" id="MJXp-Span-215"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo undefined" id="MJXp-Span-217" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span><span class="MJXp-mi undefined" id="MJXp-Span-216">X</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">\boldsymbol{\mathsf{{\bar{X}}}}</script></span> là cường độ trung bình của cả bức ảnh: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-218"><span class="MJXp-mtable" id="MJXp-Span-219"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-220" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-221" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-222"><span class="MJXp-mrow" id="MJXp-Span-223"><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-munderover" id="MJXp-Span-225"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo undefined" id="MJXp-Span-227" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span><span class="MJXp-mi undefined" id="MJXp-Span-226">X</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-mfrac" id="MJXp-Span-230" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-231">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-232">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">c</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-235"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-241" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">r</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-237" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">i</span><span class="MJXp-mo" id="MJXp-Span-239">=</span><span class="MJXp-mn" id="MJXp-Span-240">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-243"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-249" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">c</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-245" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">j</span><span class="MJXp-mo" id="MJXp-Span-247">=</span><span class="MJXp-mn" id="MJXp-Span-248">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-251"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-257" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-258">3</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-253" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">k</span><span class="MJXp-mo" id="MJXp-Span-255">=</span><span class="MJXp-mn" id="MJXp-Span-256">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mrow" id="MJXp-Span-260" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-261">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">i</span><span class="MJXp-mo" id="MJXp-Span-264">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">j</span><span class="MJXp-mo" id="MJXp-Span-266">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">\boldsymbol{\mathsf{{\bar{X}}}} = {\frac{1}{3rc} \sum\limits_{i=1}^{r} \sum\limits_{j=1}^{c} \sum\limits_{k=1}^{3} \mathsf{X}_{i,j,k}}. \tag{12.2}</script></span></p><p><strong>Chuẩn hóa độ tương phản toàn cục</strong> (Global contrast normalization - GCN) có mục đích giảm mức độ tương phản của ảnh bằng cách trừ đi giá trị trung bình trong từng bức ảnh, sau đó co giãn chúng để độ lệch chuẩn trên toàn bộ các điểm ảnh bằng một hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">s</script></span> nào đó. Cách tiếp cận này khá phức tạp vì trong thực tế ta không có hệ số co giãn nào có thể thay đổi độ tương phản của ảnh không-tương-phản (ảnh có tất cả các điểm ảnh có giá trị bằng nhau). Những bức ảnh có độ tương phản thấp thường có rất ít thông tin về mặt nội dung. Trong trường hợp này, nếu ta chia ảnh cho độ lệch chuẩn thực thì chẳng những không thu được gì mà còn làm tăng nhiễu của cảm biến và nén các chi tiết của ảnh.</p><p><img src="https://i.imgur.com/mbhK5s9.png" alt=""></p><blockquote>
<p>Hình 12.1: GCN ánh xạ các ví dụ lên trên một hình cầu. (<em>Hình bên trái</em>) Đầu vào dữ liệu thô có thể có bất kỳ chuẩn nào. (<em>Giữa</em>) GCN với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">λ</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-274">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">\lambda=0</script></span> ánh xạ tất cả các ví dụ khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mn" id="MJXp-Span-276">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">0</script></span> lên mặt cầu một cách hoàn hảo. Ở đây ta sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">s</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-280">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">s=1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">ϵ</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mn" id="MJXp-Span-285" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-286" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-287">−</span><span class="MJXp-mn" id="MJXp-Span-288">8</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">\epsilon=10^{\rm -8}</script></span>. Bởi vì ta sử dụng GCN dựa trên chuẩn hóa độ lệch chuẩn chứ không dựa trên chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-msubsup" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-292" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-293">2</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">L^{\rm 2}</script></span>, vậy nên mặt cầu kết quả không phải là mặt cầu đơn vị. (<em>Hình bên phải</em>) GCN đã có kiểm soát, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">λ</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-297">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">\lambda>0</script></span>, ta đã vẽ các ví dụ lên mặt cầu nhưng không hoàn toàn loại bỏ độ phương sai trong chuẩn của chúng. Ta giữ nguyên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">s</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">\epsilon</script></span> như trước.</p>
</blockquote><p>Điều này hướng ta tới việc tạo ra một tham số kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">λ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">\lambda</script></span> để làm thiên lệch ước tính của độ lệch chuẩn. Một cách khác là ta có thể giới hạn mẫu số có giá trị nhỏ nhất bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-47-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-47">\epsilon</script></span>. Cho trước ảnh đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mrow" id="MJXp-Span-307"><span class="MJXp-mi undefined" id="MJXp-Span-308">X</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">\boldsymbol{\mathsf{X}}</script></span>, GCN sinh ảnh đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mrow" id="MJXp-Span-310"><span class="MJXp-mrow" id="MJXp-Span-311"><span class="MJXp-mi undefined" id="MJXp-Span-312">X</span></span></span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-msup" id="MJXp-Span-314"><span class="MJXp-mi" id="MJXp-Span-315" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-316" style="vertical-align: 0.4em;">′</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">{\boldsymbol {\mathsf{X}}}{'}</script></span>, được định nghĩa là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-317"><span class="MJXp-mtable" id="MJXp-Span-318"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-319" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-320" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mrow" id="MJXp-Span-322" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-323">X</span></span><span class="MJXp-script-box" style="height: 2.036em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-330"><span class="MJXp-msup" id="MJXp-Span-331"><span class="MJXp-mi" id="MJXp-Span-332" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-333" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -1.07em;"><span class="MJXp-mrow" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">i</span><span class="MJXp-mo" id="MJXp-Span-326">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">j</span><span class="MJXp-mo" id="MJXp-Span-328">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">s</span><span class="MJXp-mfrac" id="MJXp-Span-336" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mrow" id="MJXp-Span-338" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-339">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">i</span><span class="MJXp-mo" id="MJXp-Span-342">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">j</span><span class="MJXp-mo" id="MJXp-Span-344">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-mrow" id="MJXp-Span-348"><span class="MJXp-munderover" id="MJXp-Span-349"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo MJXp-sf" id="MJXp-Span-352" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span><span class="MJXp-mrow" id="MJXp-Span-350"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-351">X</span></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mtext" id="MJXp-Span-353">max</span><span class="MJXp-mstyle" id="MJXp-Span-354"><span class="MJXp-mrow" id="MJXp-Span-355"><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.162em;">{</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">ϵ</span></span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msqrt" id="MJXp-Span-360"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale6" style="font-size: 285%; margin-top: 0.049em; margin-left: -0.218em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.103em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">λ</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-363" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-364">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-365">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">c</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">r</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">i</span><span class="MJXp-mo" id="MJXp-Span-372">=</span><span class="MJXp-mn" id="MJXp-Span-373">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-376"><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">c</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">j</span><span class="MJXp-mo" id="MJXp-Span-380">=</span><span class="MJXp-mn" id="MJXp-Span-381">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-390"><span class="MJXp-mn" id="MJXp-Span-391">3</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">k</span><span class="MJXp-mo" id="MJXp-Span-388">=</span><span class="MJXp-mn" id="MJXp-Span-389">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-393"><span class="MJXp-mrow" id="MJXp-Span-394" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-sf" id="MJXp-Span-395">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">i</span><span class="MJXp-mo" id="MJXp-Span-398">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">j</span><span class="MJXp-mo" id="MJXp-Span-400">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-403"><span class="MJXp-mrow" id="MJXp-Span-404"><span class="MJXp-munderover" id="MJXp-Span-405"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo MJXp-sf" id="MJXp-Span-407" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span><span class="MJXp-mi MJXp-sf" id="MJXp-Span-406">X</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-410" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-411">2</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-412"><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.162em;">}</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\mathsf{X}_{i,j,k}^{\rm '} =s\frac{\mathsf{X}_{i,j,k}-\mathsf{\bar{{X}}}}{ \text{max} \bigg\{{\epsilon},\sqrt{\lambda + \frac{1}{3rc}\sum_{i=1}^{r} \sum_{j=1}^{c}\sum_{k=1}^{3} (\mathsf{X}_{i,j,k} - \mathsf{\bar{X}})^{\rm 2}}\bigg\}}.\tag{12.3}</script></span></p><p>Tập dữ liệu chứa nhiều ảnh lớn được cắt ra thành các đối tượng đáng quan tâm thường ít khi chứa ảnh có cường độ gần như bằng hằng số. Trong trường hợp này, về mặt thực hành, ta có thể yên tâm bỏ qua vấn đề tử số khá nhỏ bằng cách đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">λ</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-419">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">\lambda = 0</script></span> và tránh việc chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mn" id="MJXp-Span-421">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">0</script></span> (trường hợp này cực hiếm gặp) bằng cách đặt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">\epsilon</script></span> tới một giá trị cực thấp, ví dụ như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mn" id="MJXp-Span-426" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-428">−</span><span class="MJXp-mn" id="MJXp-Span-429">8</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">10^{\rm -8}</script></span>. Goodfellow và cộng sự đã sử dụng cách tiếp cận này trên tập dữ liệu CIFAR-10. Những tấm ảnh nhỏ được cắt ngẫu nhiên thường có mật độ gần như hằng số, điều này làm cho các cơ chế kiểm soát chặt chẽ hữu ích hơn. Coates và cộng sự (2011) đã sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">ϵ</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-433">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\epsilon = 0</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">λ</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-437">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-56-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-56">\lambda = 10</script></span> trong các gói nhỏ được chọn ngẫu nhiền từ tập CIFAR-10.</p><p>Tham số tỉ lệ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-57-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-57">s</script></span> thì có thể cài đặt bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-440"><span class="MJXp-mn" id="MJXp-Span-441">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-58-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-58">1</script></span>, như trong [Coates et al., (2011)], hoặc ta để từng điểm ảnh có độ lệch chuẩn trong suốt các mẫu gần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mn" id="MJXp-Span-443">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-59-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-59">1</script></span>, như trong [Goodfellow et al., (2013)].</p><p>Độ lệch chuẩn trong phương trình 12.3 chỉ là tái tỉ lệ của chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-msubsup" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-447" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-448">2</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">L^{\rm 2}</script></span> của ảnh (giả sử giá trị trung bình của ảnh đã bị loại bỏ). Ta thường ưu tiên dùng hệ số này để định nghĩa GCN theo độ lệch chuẩn thay vì định nghĩa theo chuẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-449"><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-452" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-453">2</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">L^{\rm 2}</script></span>, bởi vì độ lệch chuẩn đã chia sẵn cho tổng số điểm ảnh. Vậy nên GCN dựa trên độ lệch chuẩn cho phép sử dụng hệ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">s</script></span> cho mọi kích cỡ ảnh. Tuy nhiên, việc quan sát thấy chuẩn  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-msubsup" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-459" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-460">2</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-63-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-63">L^{\rm 2}</script></span> tỉ lệ với độ lệch chuẩn giúp ta hình thành một số trực giác hữu ích. Ta có thể hiểu GCN ánh xạ các ví dụ tới một bề mặt cầu. Hình 12.1 minh họa điều này. Đây là một tính chất hữu ích vì mạng neuron thường đáp  ứng với hướng trong không gian tốt hơn là đáp ứng với vị trí cụ thể trong không gian. Đáp ứng với nhiều khoảng cách khác nhau trong cùng một hướng cần có các đơn vị ẩn có các vector trọng số cộng tuyến với nhau nhưng có hệ số tự do khác nhau. Các thuật toán học tập gặp khó khăn trong việc phát hiện sự phối hợp như vậy. Hơn nữa, nhiều mô hình đồ thị nông gặp nhiều vấn đề khi biểu diễn nhiều mô hình đồ thị tách biệt trên cùng một đường thẳng. GCN tránh các vấn đề này bằng cách giảm từng ví dụ về một hướng thay vì giảm về một hướng và một khoảng cách.</p><p>Một cách phản trực giác, có một quá trình tiền xử lý được gọi là <strong>cầu hóa</strong> (sphering) nhưng không giống với GCN. Cầu hóa không có nghĩa là đặt dữ liệu trên một mặt hình cầu, thay vào đó nó chỉ tới quá trình co dãn các thành phần chính để chúng có phương sai bằng nhau. Nhờ đó, các phân phối chuẩn đa biến được dùng bởi PCA có đường bao hình cầu. Cầu hóa thường được gọi là <strong>tẩy trắng</strong> (whitening).</p><p>Chuẩn hóa độ tương phản toàn cục thường không thể làm rõ các đặc trưng của ảnh mà ta muốn làm nổi bật, ví dụ như các cạnh và các góc. Nếu chúng ta có một cảnh mà trong đó có một vùng tối có diện tích lớn và một vùng sáng có diện tích lớn (ví dụ như một quảng trường thành phố có một nửa ảnh nằm trong bóng của một toà nhà), thì chuẩn hóa độ tương phản toàn cục sẽ đảm bảo rằng sẽ có sự khác biệt đáng kể về độ sáng giữa vùng sáng và vùng tối. Tuy nhiên, nó không đảm bảo rằng các cạnh trong vùng tối sẽ được làm nổi bật.</p><p>Điều này khiến chúng ta nghĩ tới <strong>chuẩn hóa độ tương phản cục bộ</strong> (local contrast normalization). Độ tương phản cục bộ đảm bảo rằng độ tương phản sẽ được chuẩn hóa theo từng cửa sổ nhỏ, thay vì trên toàn bức ảnh. Hình 12.2 so sánh chuẩn hóa độ tương phản toàn cục và sự tương phản cục bộ.</p><p><img src="https://i.imgur.com/VENUDNE.png" alt=""></p><blockquote>
<p>Hình 12.2 So sánh giữa chuẩn hóa cục bộ và chuẩn hóa toàn cục. Về mặt thị giác, chuẩn hóa toàn cục cho kết quả rõ ràng hơn. Nó đưa toàn bộ ảnh về gần như cùng một dải, điều này làm giảm gánh nặng đặt lên các thuật toán học tập khi phải xử lý nhiều dải khác nhau. Chuẩn hóa cục bộ điều chỉnh ảnh nhiều hơn, loại bỏ tất cả các vùng có cường độ bằng hằng số. Điều này giúp mô hình chỉ tập trung vào các cạnh. Các vùng có kết cấu đều (fine texture) như căn nhà ở hàng 2, có thể mất đi một số chi tiết do băng thông của lõi chuẩn hóa quá cao.</p>
</blockquote><p>Ta có thể định nghĩa độ tương phản cục bộ theo nhiều cách khác nhau. Trong tất cả các trường hợp, ta đều điều chỉnh từng điểm ảnh bằng cách trừ chúng cho giá trị trung bình và chia cho độ lệch chuẩn của các điểm ảnh lân cận. Trong vài trường hợp, đây chính là giá trị trung bình là độ lệch chuẩn của mọi điểm ảnh trong cửa số đó [Pinto et al., 2008]. Trong các trường hợp khác, đó là giá trị trung bình có trọng số hoặc độ lệch chuẩn có trọng số sử dụng trọng số theo phân phối Gauss lấy trung tâm là điểm ảnh cần điều chỉnh. Với trường hợp ảnh màu, ta có một số chiến lược xử lý từng kênh màu tách biệt, trong khi đó, một số chiến lược khác kết hợp thông tin từ các kênh màu khác nhau để chuẩn hóa từng điểm ảnh [Sermanet et al., 2012].</p><p>Chuẩn hóa độ tương phản cục bộ thường có thể được thực thi hiệu quả bằng cách sử dụng các phép tích chập tách biệt (xem phần 9.8) để tính toán các bản đồ đặc trưng của các giá trị trung bình cục bộ và độ lệch chuẩn cục bộ. Sau đó, ta sẽ dùng phép trừ và phép chia theo từng phần trên từng bản đồ đặc trưng. Chuẩn hóa độ tương phản cục bộ là một phép toán khả vi và cũng có thể được dùng như một phần tử phi tuyến áp dụng cho các tầng ẩn của mạng, cũng như một phép toán tiền xử lý áp dụng cho đầu vào.</p><p>Cũng như độ tương phản toàn cục, ta cần kiểm soát độ tương phản cục bộ để tránh lỗi chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mn" id="MJXp-Span-462">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">0</script></span>. Thực tế, vì độ tương phản cục bộ thường chỉ áp dụng trên một cửa sổ nhỏ, ta còn cần kiểm soát nó hơn nữa. Cửa sổ nhỏ hơn dễ có các giá trị gần nhau hơn, từ đó dễ có độ lệch chuẩn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mn" id="MJXp-Span-464">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">0</script></span> hơn.</p><h3 id="12212-Tăng-cường-tập-dữ-liệu">12.2.1.2 Tăng cường tập dữ liệu</h3><p>Như đã nói ở phần 7.4, ta có thể dễ dàng cải thiện tính tổng quát hóa của bộ phân loại bằng cách tăng cường kích cỡ của tập huấn luyện khi chèn thêm các phiên bản mẫu huấn luyện tăng cường. Các phiên bản này là các phiên bản được sinh ra từ mẫu gốc thông qua một số phép biến đổi nhưng không làm thay đổi nhãn của mẫu gốc. Nhận diện vật thể là một tác vụ phân loại đặc biệt thích hợp với kiểu tăng cường dữ liệu này vì các lớp bất biến với nhiều phép biến đổi và đầu vào có thể biến đổi với nhiều phép biến đổi hình học. Như đã nói tới trước đó, ta có thể nâng cao chất lượng bộ phân loại với các phép  tịnh tiến ngẫu nhiên, quay và trong một số trường hợp là lật ngược mẫu đầu vào để tăng cường tập dữ liệu. Trong các ứng dụng thị giác máy tính chuyên biệt, ta có thể dùng nhiều phép biến đổi nâng cao để tăng cường dữ liệu. Các phép này bao gồm: tạo nhiễu màu sắc một cách ngẫu nhiên trong ảnh [Krizhevsky et al., 2012] và làm méo hình học phi tuyến của đầu vào [LeCun et al., 1998b].</p><p>//-- Nguyễn Văn Thành kết thúc dịch tại đây</p><p>------------------------------------------------<br>
------------------------ Thomas Nguyen bắt đầu dịch từ đây ------------------------</p><p>Trang 453 – 457:</p><h1 id="123-Nhận-dạng-giọng-nói">12.3 Nhận dạng giọng nói</h1><p>Nhiệm vụ của bài toán nhận dạng giọng nói là ánh xạ tín hiệu âm học chứa tiếng nói giao tiếp thường ngày thành một chuỗi tương ứng các từ ngữ mà con người thường hay sử dụng. Cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-466">X</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-471" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-472">(</span><span class="MJXp-mn" id="MJXp-Span-473">1</span><span class="MJXp-mo" id="MJXp-Span-474">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-478" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-479">(</span><span class="MJXp-mn" id="MJXp-Span-480">1</span><span class="MJXp-mo" id="MJXp-Span-481">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-487" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-488">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">T</span><span class="MJXp-mo" id="MJXp-Span-490">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-66-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-66">\boldsymbol{X}=(x^{(1)},x^{(1)},\dots,x^{(T)})</script></span> biểu thị một chuỗi các vector dạng tín hiệu âm thanh đầu vào (thông thường nó được tạo ra bằng cách chia tách âm thanh thành các khung có độ dài <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mn" id="MJXp-Span-493">20</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-67-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-67">20</script></span>ms). Hầu hết các hệ thống nhận dạng giọng nói sẽ tiền xử lý các tín hiệu đầu vào bằng cách sử dụng các đặc trưng chuyên biệt của tiếng nói, tuy nhiên, một số mô hình học sâu [Jaitly and Hinton, 2011] cũng có khả năng học các đặc trưng về giọng nói từ dữ liệu đầu vào. Gọi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-494"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-495">y</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-504" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">\boldsymbol{y}=(y_1,y_2,\dots,y_N)</script></span> biểu diễn chuỗi các giá trị mục tiêu đầu ra (thông thường là một chuỗi các ký tự hoặc từ). Nhiệm vụ của <em>tự động nhận dạng giọng nói</em> (Automatic Speech Recognition - ASR) sẽ bao gồm việc tạo một hàm số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">f</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-519">∗</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">R</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">f^*_{ASR}</script></span> để tính toán tần suất các từ ngữ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-521">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">\boldsymbol{y}</script></span> được cho bởi tập dữ liệu tín hiệu âm thanh đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-523">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">\boldsymbol{X}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-544"><span class="MJXp-mtable" id="MJXp-Span-545"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-546" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-547" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549" style="margin-right: 0.05em;">f</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-554">∗</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">R</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-556">X</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">g</span><span class="MJXp-munderover" id="MJXp-Span-562"><span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564" style="margin-left: 0px;">y</span></span></span><span class="MJXp-mrow" id="MJXp-Span-565"><span class="MJXp-msubsup" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567" style="margin-right: 0.05em;">P</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-568" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">y</span><span class="MJXp-mspace" id="MJXp-Span-571" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-572"><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-574" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-575">X</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-577">X</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-72">f^*_{ASR}(\boldsymbol{X}) = arg\max_y{P^*(y\,|\,\boldsymbol{\text{X}}=\boldsymbol{X})},\tag{12.4}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-msubsup" id="MJXp-Span-581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582" style="margin-right: 0.05em;">P</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-583" style="vertical-align: 0.5em;">∗</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-73-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-73">P^*</script></span> là phân phối có điều kiện thực tế của dữ liệu đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-585">X</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">\boldsymbol{X}</script></span> tương ứng với mục tiêu đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-586"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-587">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol{y}</script></span>.</p><p>Từ những năm 1980 cho đến những năm 2009-2012, sự phát triển của các hệ thống nhận dạng giọng nói chủ yếu là sự kết hợp giữa <em>mô hình Markov ẩn</em> (Hidden Markov Model - HMM) và các <em>mô hình Markov-Gauss</em> (Gaussian Markov Model - GMM). GMM là sự kết hợp giữa các đặc trưng về giọng nói và các <em>âm vị</em> (phonemes) [Bahl et al., 1987], trong khi HMM sẽ mô hình hóa chuỗi các âm vị. Các hệ thống HMM-GMM sẽ xử lý sóng âm học theo các bước sau: đầu tiên HMM sẽ tạo ra chuỗi các âm vị và các trạng thái <em>dưới âm vị</em> (subphonemic) (như ở đầu, giữa hoặc cuối của mỗi âm vị), sau đó một GMM sẽ biến đổi mỗi ký tự rời rạc thành từng đoạn ngắn gọn dưới dạng sóng âm. Mặc dù các hệ thống GMM-HMM thống trị trong tác vụ tự động nhận dạng giọng nói cho đến nay, tuy nhiên, hiện tại người ta đã bắt đầu áp dụng mô hình mạng neuron vào nhận dạng giọng nói, và đó cũng là một trong số những ứng dụng của mạng neuron vào thực tế. Từ cuối những năm 1980 đến đầu những năm 1990, đã có số lượng lớn các hệ thống nhận dạng giọng nói đã sử dụng mạng neuron [Bourlard and Wellekens, 1989; Waibel et al., 1989; Robinson and Fallside, 1991; Bengio et al., 1991, 1992; Konig et al., 1996]. Tại thời điểm này, hiệu suất khi sử dụng mô hình mạng neuron vào hệ thống nhận dạng tiếng nói đã xấp xỉ bằng với hiệu suất khi sử dụng hệ thống HMM-GMM. Ví dụ Robinson và Fallside (1991) đã đạt được tỉ lệ lỗi âm vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-588"><span class="MJXp-mn" id="MJXp-Span-589">26</span><span class="MJXp-mi" id="MJXp-Span-590">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-76-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-76">26\%</script></span> trên bộ dữ liệu TIMIT [Garofolo et al., 1993] (bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-mn" id="MJXp-Span-592">39</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-77-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-77">39</script></span> âm vị riêng biệt), hiệu suất này đã tốt hơn so với việc sử dụng hệ thống dựa trên HMM. Kể từ đó, bộ dữ liệu TIMIT là một bộ dữ liệu tiêu chuẩn trong việc đánh giá mô hình nhận dạng giọng nói, nó đóng vai trò tương đương với bộ dữ liệu MNIST trong nhận dạng đối tượng. Tuy nhiên do sự phức tạp liên quan đến hệ thống phần mềm trong việc triển khai hệ thống nhận dạng giọng nói và những nỗ lực đã gặt hái được trong việc xây dựng hệ thống dựa trên GMM-HMM, thời điểm đó ta chưa có được những lý do thuyết phục để có thể chuyển sang áp dụng mô hình mạng neuron vào nhận dạng giọng nói. Kết quả là cho đến đầu những năm 2000, cả trong nghiên cứu và thực tiễn, mạng neuron chỉ được áp dụng trong việc học tăng cường các đặc trưng cho hệ thống GMM-HMM.</p><p>Sau đó, với những <em>mô hình sâu hơn và lớn hơn</em> và với tập dữ liệu lớn hơn nhiều lần, tỉ lệ chính xác trong việc nhận dạng đã được cải thiện một cách đáng kể khi sử dụng mạng neuron thay thế GMM cho tác vụ liên quan đến các đặc trưng âm học, âm vị (hoặc trạng trái dưới âm vị). Bắt đầu từ năm 2009, các nhà nghiên cứu giọng nói đã áp dụng các mô hình học sâu dựa trên phương pháp học không giám sát để nhận dạng giọng nói. Cách tiếp cận với học sâu dựa trên các mô hình huấn luyện xác suất không xác định gọi là mô hình <em>máy Boltzmann hạn chế</em> (Restricted Boltzmann Machine - RBM) để mô hình hóa dữ liệu đầu vào. RBM được mô tả ở phần III. Để giải quyết các bài toán nhận dạng giọng nói, phương pháp tiền huấn luyện không giám sát đã được sử dụng để xây dựng mô hình mạng học sâu lan truyền thuận, nó bao gồm các tầng mà mỗi tầng được khởi tạo bằng việc huấn luyện theo RBM. Các mạng này biểu diễn phổ của tín hiệu âm thanh dưới dạng một cửa sổ dữ liệu đầu vào có kích thước cố định (xung quanh khung trung tâm) và dự đoán xác suất có điều kiện trạng thái của HMM cho khung trung tâm đó. Việc huấn luyện các mạng học sâu như vậy đã làm cải thiện đáng kể tỉ lệ nhận dạng trên bộ dữ liệu TIMIT [Mohamed et al., 2009, 2012a], đưa tỉ lệ lỗi âm vị từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-mn" id="MJXp-Span-594">26</span><span class="MJXp-mi" id="MJXp-Span-595">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-78-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-78">26\%</script></span> xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mn" id="MJXp-Span-597">20.7</span><span class="MJXp-mi" id="MJXp-Span-598">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">20.7\%</script></span>. Mohamed và cộng sự (2012b) đã phân tích lý do đạt tỉ lệ nhận dạng cao của mô hình. Việc mở rộng nguồn nhận dạng tiếng nói cơ bản bao gồm việc thêm vào các đặc trưng thích ứng với tiếng nói đã dẫn đến việc giảm tỉ lệ nhận dạng lỗi của mô hình. Điều này đã nhanh chóng được áp dụng để mở rộng bài toán từ nhận dạng âm vị thành hệ thống nhận dạng tiếng nói có lượng từ cực lớn, nó không chỉ được áp dụng cho nhận dạng âm vị (sử dụng bộ dữ liệu TIMIT) mà còn được áp dụng cho việc nhận dạng chuỗi các từ khóa trong bộ từ điển lớn. Mạng học sâu được áp dụng cho bài toán nhận dạng giọng nói cuối cùng đã được chuyển đổi từ việc dựa trên tiền huấn luyện và mô hình Boltzmann machine sang sử dụng các kỹ thuật như sử dụng đơn vị tuyến tính hiệu chỉnh làm hàm kích hoạt phi tuyến và sử dụng cơ chế tắt ngẫu nhiên. Thời điểm đó, có rất nhiều nhóm lớn trong ngành đã bắt đầu hợp tác với các các nhà nghiên cứu học thuật về việc áp dụng các mô hình mạng học sâu.  Hinton và cộng sự (2012a) đã mô tả những thành quả đột phá đạt được nhờ sự hợp tác này. Ngày nay chúng đã được triển khai vào thực tế trên các thiết bị điện thoại di động.</p><p>Sau đó, các nhóm này áp dụng với các bộ dữ liệu ngày càng lớn và kết hợp với các phương pháp cho việc khởi tạo, huấn luyện và thiết lập xây dựng mạng học sâu, họ nhận ra rằng việc tiền huấn luyện không giám sát giờ đây là không cần thiết nữa và nó cũng không tác động đến việc cải thiện tỉ lệ nhận dạng.</p><p>Những đột phá về tỉ lệ nhận dạng lỗi trong bài toán nhận dạng giọng nói khi áp dụng mạng học sâu giờ đây được cải thiện không ngừng (cải thiện khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mn" id="MJXp-Span-600">30</span><span class="MJXp-mi" id="MJXp-Span-601">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">30\%</script></span> hiệu suất) trong một thời gian dài, khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-602"><span class="MJXp-mn" id="MJXp-Span-603">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">10</script></span> năm. Trong khi đó thì hiệu suất nhận dạng khi áp dụng các kỹ thuật truyền thống dựa trên GMM-HMM không được cải thiện, mặc dù kích thước của dữ liệu huấn luyện ngày càng lớn (xem hình 2.4 của Deng và Yu [2014]). Điều này đã tạo một làn sóng trong cộng đồng nghiên cứu nhận dạng giọng nói trong việc chuyển đổi sang nghiên cứu áp dụng các mô hình học sâu. Trong khoảng vài năm trở lại đây, phần lớn các sản phẩm ứng dụng nhận dạng giọng nói đều dựa trên mô hình học sâu, thành công này cũng khiến cho các nhà nghiên cứu trên thế giới đổ vào nghiên cứu các thuật toán học sâu và áp dụng chúng cho hệ thống tự động nhận dạng ARS.</p><p>Một trong số những khám phá mới đó là sử dụng mạng neuron tích chập [Sainath et al., 2013] trong việc sao chép các trọng số theo thời gian và tần số, cải thiện thời gian chậm trễ trong mạng neuron. Mô hình tích chập hai chiều coi ảnh phổ không giống như một vector mà là một ảnh với một trục tương ứng với thành phần về thời gian còn trục còn lại tương ứng với thành phần tần số.</p><p>Một động lực quan trọng khác đó là loại bỏ hoàn toàn mô hình HMM ra khỏi các hệ thống nhận dạng giọng nói. Đột phá lớn đầu tiên theo hướng đi này là của Graves và cộng sự (2013), người đã huấn luyện một mạng bộ nhớ ngắn hạn hướng dài hạn (xem phần 10.10) sử dụng suy luận cực đại hóa ước tính hậu nghiệm (MAP) liên kết khung và âm vị (frame-to-phoneme) như trong [LeCun et al. (1998b)] và bộ khung (framework )CTC [Graves et al.,2006; Graves, 2012] đã đưa ra. Một mạng học sâu truy hồi có các biến trạng thái từ nhiều tầng, đưa ra một mô hình với hai loại học sâu: học sâu thông thường do một dãy xếp chồng các tầng, và học sâu theo thời gian. Phương pháp này đã đưa tỉ lệ lỗi âm vị trong bộ dữ liệu TIMIT giảm xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-mn" id="MJXp-Span-605">17.7</span><span class="MJXp-mi" id="MJXp-Span-606">%</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">17.7\%</script></span>.</p><p>Một hướng phát triển khác hiện tại trong việc đưa mô hình học sâu áp dụng từ đầu đến cuối vào bài toán ASR đó là để cho mô hình tự học làm cách nào để sắp xếp theo mức độ quan trọng cho các thông tin về mức độ âm vị [Chorowski et al., 2014; Lu et al., 2015].</p><h1 id="124-Xử-lý-ngôn-ngữ-tự-nhiên">12.4 Xử lý ngôn ngữ tự nhiên</h1><p>Xử lý ngôn ngữ tự nhiên (NLP-Natural Language Processing) là “dạy” cho máy tính có thể sử dụng các ngôn ngữ của con người như tiếng Anh, tiếng Pháp. Xử lý ngôn ngữ tự nhiên bao gồm nhiều ứng dụng ví dụ như dịch máy, trong đó nó sẽ phải đọc một câu hay một đoạn văn bản từ một ngôn ngữ, sau đó dịch câu đó sang một ngôn ngữ khác. Nhiều ứng dụng xử lý ngôn ngữ tự nhiên được dựa trên các mô hình ngôn ngữ định ra phân phối xác suất trên chuỗi các từ, ký tự, hay giá trị byte trong một ngôn ngữ tự nhiên thông thường.</p><p>Trong các ứng dụng được thảo luận trong chương này, các kỹ thuật sử dụng mạng neuron tổng quát có thể được áp dụng khá thành công trong việc xử lý ngôn ngữ tự nhiên. Để đạt được hiệu quả tốt nhất và có thể mở rộng các ứng dụng lớn, các chiến lược chuyên ngành sẽ trở nên quan trọng. Để xây dựng một mô hình hiệu quả của ngôn ngữ tự nhiên, chúng ta thường phải sử dụng các kỹ thuật chuyên biệt cho việc xử lý dữ liệu chuỗi. Trong nhiều trường hợp, chúng ta coi ngôn ngữ tự nhiên là một chuỗi các từ ngữ, thay vì coi chúng như một chuỗi các ký tự hoặc byte. Bởi vì tổng số lượng các từ ngữ là cực lớn, các mô hình dựa trên từ ngữ phải hoạt động tốt trên miền không gian dữ liệu có nhiều chiều và rời rạc. Vài chiến lược đã được phát triển để tạo ra các mô hình trên các miền không gian như vậy, chứa ý nghĩa về mặt tính toán và thống kê.</p><h2 id="1241-n-gram">12.4.1 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">n</script></span>-gram</h2><p>Một <strong>mô hình ngôn ngữ</strong> định nghĩa phân phối xác suất một chuỗi các token trong một ngôn ngữ tự nhiên. Phụ thuộc vào cách thiết kế mô hình, một token có thể là một từ, một ký tự hay một byte dữ liệu. Token luôn luôn là một thực thể rời rạc. Các mô hình ngôn ngữ thành công trước đây đều dựa trên mô hình các chuỗi token có kích thước cố định, gọi là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">n</script></span>-gram. Một <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">n</script></span>-gram là một chuỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">n</script></span> token.</p><p>Các mô hình dựa trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">n</script></span>-gram định nghĩa xác suất có điều kiện của token thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">n</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">n</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-622">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">n-1</script></span> token cho trước. Mô hình sử dụng tích các phân phối có điều kiên này để  định nghĩa phân phối xác suất trên các chuỗi dài hơn:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-623"><span class="MJXp-mtable" id="MJXp-Span-624"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-625" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-626" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">P</span><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-635" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">τ</span></span></span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">P</span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-653" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">n</span><span class="MJXp-mo" id="MJXp-Span-661">−</span><span class="MJXp-mn" id="MJXp-Span-662">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-664"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-670" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">τ</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-666" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">t</span><span class="MJXp-mo" id="MJXp-Span-668">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">n</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">P</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-676" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-677"><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">t</span><span class="MJXp-mo" id="MJXp-Span-683">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">n</span><span class="MJXp-mo" id="MJXp-Span-685">+</span><span class="MJXp-mn" id="MJXp-Span-686">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-692" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">t</span><span class="MJXp-mo" id="MJXp-Span-694">−</span><span class="MJXp-mn" id="MJXp-Span-695">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-90">P(x_1,x_2,\dots,x_{\tau})=P(x_1,x_2,\dots,x_{n-1})\prod\limits_{t=n}^{\tau}P(x_t|x_{t-n+1},\dots,x_{t-1}). \tag{12.5}</script></span></p><p>Phép phân tích này đã được chứng minh bằng quy tắc chuỗi cho xác suất. Một phân phối xác suất của một chuỗi xác suất ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">P</span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-703" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-707" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">n</span><span class="MJXp-mo" id="MJXp-Span-715">−</span><span class="MJXp-mn" id="MJXp-Span-716">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">P(x_1,x_2,\dots,x_{n-1})</script></span> có thể được mô hình hóa bởi một mô hình khác với giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-92-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-92">n</script></span> nhỏ hơn.</p><p>Việc huấn luyện mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">n</script></span>-gram là trực tiếp bởi việc ước lượng hợp lý cực đại có thể được tính toán một cách đơn giản bằng cách đếm có bao nhiêu lần mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">n</script></span>-gram xuất hiện trong tập huấn luyện. Các mô hình dựa trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">n</script></span>-gram đã từng là một khối cốt lõi của mô hình ngôn ngữ thống kê trong nhiều thập kỉ [Jelinek and Mercer, 1980; Katz, 1987; Chen and Goodman, 1999].</p><p>Với giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">n</script></span> nhỏ, mô hình này gọi là <strong>unigram</strong> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">n</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-731">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">n =1</script></span>, <strong>bigram</strong> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">n</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-735">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">n =2</script></span> và <strong>trigram</strong> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">n</span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-739">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">n =3</script></span>. Những cái tên này bắt nguồn từ tiền tố Latinh cho số tương ứng và hậu tố Hy Lạp “-gram” để biểu thị cách viết.</p><p>Thông thường chúng ta huấn luyện đồng thời cả hai mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">n</script></span>-gram và mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">n</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-745">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">n-1</script></span>-gram. Điều này khiến cho việc tính toán</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-746"><span class="MJXp-mtable" id="MJXp-Span-747"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-748" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-749" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">P</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-754" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-755"><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-759" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">t</span><span class="MJXp-mo" id="MJXp-Span-761">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">n</span><span class="MJXp-mo" id="MJXp-Span-763">+</span><span class="MJXp-mn" id="MJXp-Span-764">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-770" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">t</span><span class="MJXp-mo" id="MJXp-Span-772">−</span><span class="MJXp-mn" id="MJXp-Span-773">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-776" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-779" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-783" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">t</span><span class="MJXp-mo" id="MJXp-Span-785">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">n</span><span class="MJXp-mo" id="MJXp-Span-787">+</span><span class="MJXp-mn" id="MJXp-Span-788">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-794" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-799" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">n</span><span class="MJXp-mo" id="MJXp-Span-801">−</span><span class="MJXp-mn" id="MJXp-Span-802">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-806" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">t</span><span class="MJXp-mo" id="MJXp-Span-808">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">n</span><span class="MJXp-mo" id="MJXp-Span-810">+</span><span class="MJXp-mn" id="MJXp-Span-811">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-817" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">t</span><span class="MJXp-mo" id="MJXp-Span-819">−</span><span class="MJXp-mn" id="MJXp-Span-820">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-102"> P(x_t|x_{t-n+1},\dots,x_{t-1})= \frac{P_n(x_{t-n+1},\dots,x_{t})}{P_{n-1}(x_{t-n+1},\dots,x_{t-1})} \tag{12.6}</script></span></p><p>trở nên dễ dàng bằng cách tra cứu hai giá trị xác suất đã được lưu lại. Để thu được chính xác giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-msubsup" id="MJXp-Span-823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-825" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">P_n</script></span>, chúng ta phải bỏ qua ký tự cuối cùng của mỗi chuỗi khi chúng ta huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-msubsup" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-829" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">n</span><span class="MJXp-mo" id="MJXp-Span-831">−</span><span class="MJXp-mn" id="MJXp-Span-832">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">P_{n-1}</script></span>.</p><p>Ví dụ, chúng ta muốn làm rõ làm cách nào mô hình trigram có thể tính được xác suất của câu “<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-833"><span class="MJXp-mrow" id="MJXp-Span-834"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-835">THE DOG RAN AWAY</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">\mathtt{\text{THE DOG RAN AWAY}}</script></span>”. Từ đầu tiên của câu không được xử lý bằng công thức mặc định cho xác suất có điều kiện bởi vì không có ngữ cảnh ở phía trước đó. Thay vào đó, chúng ta phải sử dụng xác suất biên tại khởi đầu của câu. Do vậy chúng ta phải tính toán xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-msubsup" id="MJXp-Span-837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-839" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mrow" id="MJXp-Span-840"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-841">(THE DOG RAN)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">P_3\mathtt{\text{(THE DOG RAN)}}</script></span>. Từ cuối cùng của câu có thể được dự đoán bằng cách sử dụng trường hợp thông thường, sử dụng phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">P</span><span class="MJXp-mrow" id="MJXp-Span-844"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-845">(AWAY|DOG RAN)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">P\mathtt{\text{(AWAY|DOG RAN)}}</script></span>. Đưa vào công thức 12.6 ở trên ta được:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-846"><span class="MJXp-mtable" id="MJXp-Span-847"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-848" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-849" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">P</span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-852"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-853">THE DOG RAN AWAY</span></span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-858" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-860"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-861">THE DOG RAN</span></span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-865" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-867"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-868">DOG RAN AWAY</span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-870"><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873" style="margin-right: 0.05em;">P</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-874" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-876"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-877">DOG RAN</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-108">P(\mathtt{\text{THE DOG RAN AWAY}})=P_3(\mathtt{\text{THE DOG RAN}})P_3(\mathtt{\text{DOG RAN AWAY}})/P_2(\mathtt{\text{DOG RAN}}) \tag{12.7}</script></span></p><p>Hạn chế cơ bản của phương pháp hợp lý cực đại cho các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">n</script></span>-gram đó là do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-881"><span class="MJXp-msubsup" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-884" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">P_n</script></span> được tính bằng việc đếm tập huấn luyện, xảy ra nhiều trường hợp bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mn" id="MJXp-Span-886">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">0</script></span>, mặc dù <em>ống</em> (tuple) dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-891" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">t</span><span class="MJXp-mo" id="MJXp-Span-893">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">n</span><span class="MJXp-mo" id="MJXp-Span-895">+</span><span class="MJXp-mn" id="MJXp-Span-896">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">(x_{t-n+1},\dots,x_{t})</script></span> có thể xuất hiện trong tập kiểm thử. Điều này dẫn đến hai loại kết quả thảm họa. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-905"><span class="MJXp-msubsup" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-908" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">n</span><span class="MJXp-mo" id="MJXp-Span-910">−</span><span class="MJXp-mn" id="MJXp-Span-911">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-113-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-113">P_{n-1}</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mn" id="MJXp-Span-913">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">0</script></span>, tỉ lệ sẽ không được xác định, do vậy mô hình sẽ không đưa ra được kết quả. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-msubsup" id="MJXp-Span-915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-917" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">n</span><span class="MJXp-mo" id="MJXp-Span-919">−</span><span class="MJXp-mn" id="MJXp-Span-920">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">P_{n-1}</script></span> khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-mn" id="MJXp-Span-922">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">0</script></span>, nhưng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-msubsup" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-926" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">P_n</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mn" id="MJXp-Span-928">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">0</script></span>, thì giá trị kiểm thử của hàm hợp lý dạng logarit bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mo" id="MJXp-Span-930" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-931">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">-\infty</script></span>. Để tránh các trường hợp như vậy xảy ra, hầu hết các mô hình n-gram đều sử dụng một vài dạng của hàm <em>làm mượt</em> (smoothing). Các kỹ thuật làm mượt dịch chuyển khối lượng xác suất từ các ống dữ liệu quan sát được thành các ống dữ liệu không quan sát được có dạng tương tự. Xem đánh giá và so sánh thực nghiệm trong [Chen and Goodman (1999)] để biết thêm chi tiết. Một kỹ thuật cơ bản bao gồm việc thêm khối lượng xác suất khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-932"><span class="MJXp-mn" id="MJXp-Span-933">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">0</script></span> vào tất cả các giá trị ký tự có thể xảy ra tiếp theo. Phương pháp này có thể được suy luận từ định lý Bayes với một giá trị tiền nhiệm đồng đều hoặc tiên nghiệm Dirichlet trên các tham số thuộc về phép đếm. Một ý tưởng thông dụng khác đó là xây dựng mô hình hỗn hợp bao gồm các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">n</script></span>-gram bậc cao và bậc thấp, với mô hình bậc cao để tăng dung lượng của mô hình còn mô hình bậc thấp để tránh các lần đếm bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-mn" id="MJXp-Span-937">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">0</script></span>. Các phương pháp <strong>back-off</strong> sẽ tra cứu các <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">n</script></span>-gram bậc thấp nếu tần suất của ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-msubsup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-943" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">t</span><span class="MJXp-mo" id="MJXp-Span-945">−</span><span class="MJXp-mn" id="MJXp-Span-946">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-952" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">t</span><span class="MJXp-mo" id="MJXp-Span-954">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span><span class="MJXp-mo" id="MJXp-Span-956">+</span><span class="MJXp-mn" id="MJXp-Span-957">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">x_{t−1}, \dots, x_{t−n+1}</script></span> quá nhỏ để sử dụng mô hình bậc cao. Hơn nữa, chúng sẽ tính toán phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-msubsup" id="MJXp-Span-959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-961" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">x_t</script></span> bằng cách sử dụng ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-962"><span class="MJXp-msubsup" id="MJXp-Span-963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-965" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">t</span><span class="MJXp-mo" id="MJXp-Span-967">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">n</span><span class="MJXp-mo" id="MJXp-Span-969">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-976" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">t</span><span class="MJXp-mo" id="MJXp-Span-978">−</span><span class="MJXp-mn" id="MJXp-Span-979">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">x_{t−n+k}, \dots, x_{t−1}</script></span> để tăng giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">k</script></span> cho đến khi tìm được giá trị hợp lý.</p><p>Các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">n</script></span>-gram cổ điển có những nhược điểm là tương đối nhạy cảm khi chiều dữ liệu lớn. Có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-987"><span class="MJXp-mi undefined" id="MJXp-Span-988">V</span></span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mrow" id="MJXp-Span-990" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-992" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">|\mathbb{V}|^n</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">n</script></span>-gram và |<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mrow" id="MJXp-Span-996"><span class="MJXp-mi undefined" id="MJXp-Span-997">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">\mathbb{V}</script></span>| thông thường sẽ rất lớn. Dù với tập huấn luyện khổng lồ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">n</script></span> vừa phải, hầu hết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">n</script></span>-gram sẽ không xuất hiện lại trong tập huấn luyện. Một cách để quan sát mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">n</script></span>-gram cổ điển là thực hiện tra cứu các điểm gần nhất. Nói cách khác, nó có thể xem như là <em>bộ dự đoán cục bộ không tham số</em> (local nonparametric predictor), cũng giống với thuật toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">k</script></span> điểm gần nhất. Các bài toán thống kê phải đối mặt với vấn đề dự đoán cục bộ này đã được mô tả trong mục 5.11.2. Vấn đề cho một mô hình ngôn ngữ còn nghiêm trọng hơn so với thông thường, bởi bất kỳ hai từ khác nhau thì khoảng cách giữa chúng là như nhau trong <em>không gian vector mã hóa đơn trội</em> (one-hot vector space). Do đó phải sử dụng các thông tin từ bất cứ “láng giềng” nào - chỉ có các mẫu huấn luyện lặp lại theo cùng một ngữ cảnh là hữu ích cho việc tổng quát hóa cục bộ. Để có thể giải quyết các vấn đề như vậy, một mô hình ngôn ngữ phải có khả năng chia sẻ kiến thức giữa các từ đồng nghĩa.</p><p>Để cải thiện hiệu suất thống kê của mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">n</script></span>-gram, các mô hình ngôn ngữ dựa theo phân lớp mà [Brown et al., 1992; Ney and Kneser, 1993; Niesler et al., 1998] đã giới thiệu về khái niệm hạng mục từ ngữ sau đó chia sẻ sức mạnh thống kê giữa các từ thuộc cùng một hạng mục. Ý tưởng về việc sử dụng thuật toán phân cụm để phân chia các từ vào các lớp hay các cụm dựa trên tần số xuất hiện đồng thời của chúng với các từ khác. Mô hình có thể sử dụng ID của các lớp từ thay vì sử dụng ID của từng từ riêng biệt để biểu diễn ngữ cảnh ở phía bên phải của thanh điều kiện. Cũng có thể sử dụng mô hình tổng hợp kết hợp các mô hình dựa trên từ và dựa trên lớp. Mặc dù các lớp từ giúp tổng quát các chuỗi chứa các từ đồng nghĩa trong cùng một lớp, cách biểu diễn này vẫn làm mất mát rất nhiều thông tin.</p><p>------------------------<br>
Xuan Tu review đến đây<br>
\</p><p>--------------------------------------------------<br>
Thomas Nguyen kết thúc ở đây<br>
-----------------------------------------------------------------------------------------</p><p>------------------------<br>
Lại Minh Duy bắt đầu dịch từ đây<br>
------------------------</p><p>Trang 458 – 462:</p><h2 id="1242-Mô-hình-Neuron-Ngôn-ngữ">12.4.2 Mô hình Neuron Ngôn ngữ</h2><p><strong>Mô hình neuron Ngôn ngữ (Neural language model)</strong>, hay NLM, là một lớp mô hình ngôn ngữ sử dụng biểu diễn có phân phối của các từ ngữ (distributed representation of words) để khắc phục vấn đề số chiều lớn cho việc mô hình hóa các chuỗi ngôn ngữ tự nhiên [Bengio et al., 2001]. Không giống như các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">n</script></span>-gram dựa theo lớp từ, các mô hình neuron ngôn ngữ có thể nhận diện hai từ giống nhau mà không làm mất khả năng mã hóa riêng biệt hai từ này. Các mô hình neuron ngôn ngữ chia sẻ sức mạnh thống kê giữa một từ (và ngữ cảnh của nó) với các từ và ngữ cảnh tương tự khác. Biểu diễn có phân phối mà mô hình học được cho mỗi từ, kích hoạt chia sẻ này bằng cách cho phép mô hình xem các từ có các đặc trưng tương tự nhau. Ví dụ, nếu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1010"><span class="MJXp-mrow" id="MJXp-Span-1011"><span class="MJXp-mtext MJXp-sf" id="MJXp-Span-1012">dog</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">\mathsf{\text{dog}}</script></span> và từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1013"><span class="MJXp-mrow" id="MJXp-Span-1014"><span class="MJXp-mtext MJXp-sf" id="MJXp-Span-1015">cat</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">\mathsf{\text{cat}}</script></span> ánh xạ đến các biểu diễn chia sẻ nhiều thuộc tính, sau đó các câu chứa từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-mrow" id="MJXp-Span-1017"><span class="MJXp-mtext MJXp-sf" id="MJXp-Span-1018">cat</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">\mathsf{\text{cat}}</script></span> có thể cung cấp các dự đoán được tạo ra bởi mô hình cho các câu chứa từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1019"><span class="MJXp-mrow" id="MJXp-Span-1020"><span class="MJXp-mtext MJXp-sf" id="MJXp-Span-1021">dog</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">\mathsf{\text{dog}}</script></span> và ngược lại. Bởi vì có nhiều thuộc tính như vậy, nên có rất nhiều cách để tổng quát hóa, truyền tải thông tin từ mỗi câu huấn luyện sang một số lượng khổng lồ các câu khác liên quan về mặt ngữ nghĩa. Vấn đề số chiều lớn đòi hỏi mô hình phải khái quát hóa số lượng câu có chiều dài câu tăng theo hàm mũ. Mô hình xử lý vấn đề này bằng cách liên hệ mỗi câu huấn luyện với một số lượng câu tương tự khổng lồ.</p><p>Đôi khi chúng ta gọi cách biểu diễn từ này là <strong><em>phép nhúng từ</em> (word embedding)</strong>. Trong cách diễn dịch này, chúng ta xem các ký hiệu thô như các điểm trong không gian có số chiều bằng với kích thước kho từ vựng. Phép biểu diễn từ sẽ nhúng các điểm đó vào một không gian đặc trưng có chiều thấp hơn. Trong không gian gốc, mỗi từ được biểu diễn bằng một <em>vector đơn trội</em> (one-hot vector), do đó mỗi cặp từ cách nhau một khoảng Euclid là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-msqrt" id="MJXp-Span-1023"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1024">2</span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">\sqrt{2}</script></span>. Trong không gian nhúng, các từ thường xuất hiện trong các ngữ cảnh tương tự (hoặc bất kỳ cặp từ nào chia sẻ một số “đặc trưng”  được học bởi mô hình) đều gần nhau. Điều này thường dẫn đến việc những từ có ý nghĩa tương tự sẽ ở gần nhau. Hình 12.3 phóng to các khu vực cụ thể của không gian nhúng từ đã được học bởi mô hình, thể hiện việc các từ giống nhau đồng nghĩa được ánh xạ thành các biểu diễn gần nhau.</p><p><img src="https://i.imgur.com/FzCBYfZ.png" alt=""></p><blockquote>
<p>Hình 12.3: Minh họa hai chiều của phương pháp nhúng từ thu được từ một mô hình neuron dịch máy [Bahdanau et al., 2015], phóng to các khu vực cụ thể nơi các từ ngữ có mối quan hệ ngữ nghĩa có các vector nhúng gần nhau. Các quốc gia xuất hiện ở bên trái và các con số ở bên phải. Xin lưu ý rằng các vector nhúng này là 2 chiều nhằm mục đích trực quan hóa. Trong các ứng dụng thực tế, các vector nhúng thường có chiều dữ liệu cao hơn và có thể đồng thời nắm bắt được nhiều khía cạnh tương đồng giữa các từ.</p>
</blockquote><p>Các mạng neuron trong những lĩnh vực khác cũng định nghĩa các phép nhúng. Ví dụ, một tầng ẩn của một mạng tích chập cung cấp một “phép nhúng hình ảnh”. Thông thường, những người giải quyết bài toán ngôn ngữ tự nhiên sẽ quan tâm đến ý tưởng nhúng này nhiều hơn bởi vì ngôn ngữ tự nhiên ban đầu không nằm trong một không gian vector có giá trị thực. Tầng ẩn đã cung cấp một sự thay đổi đáng kể về mặt chất lượng biểu diễn dữ liệu.</p><p>Ý tưởng cơ bản của việc sử dụng các biểu diễn có phân phối để cải thiện các mô hình xử lý ngôn ngữ tự nhiên không bị hạn chế đối với các mạng neuron. Nó cũng có thể được sử dụng với các mô hình đồ họa chứa biểu diễn có phân phối dưới dạng các biến tiểm ẩn [Mnih and Hinton, 2007].</p><p>============== Phát đã edit tới đây</p><h2 id="1243-Những-đầu-ra-đa-chiều">12.4.3 Những đầu ra đa chiều</h2><p>Trong nhiều ứng dụng ngôn ngữ tự nhiên, chúng ta thường muốn các mô hình phải tạo ra các từ (chứ không phải là ký tự) như là đơn vị cơ bản của đầu ra. Đối với kho từ vựng lớn, khâu tính toán phân phối đầu ra theo từng từ có thể rất tốn kém, bởi vì số lượng từ quá lớn. Trong rất nhiều ứng dụng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1025"><span class="MJXp-mrow" id="MJXp-Span-1026"><span class="MJXp-mi undefined" id="MJXp-Span-1027">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">\mathbb{V}</script></span> chứa hàng trăm nghìn từ. Cách tiếp cận kiểu ngây thơ trong việc biểu diễn những phân phối như thế chính là áp dụng một phép biến đổi affine từ một biểu diễn ẩn sang không gian đầu ra, sau đó áp dụng hàm softmax. Giả sử chúng ta có kho từ vựng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1028"><span class="MJXp-mrow" id="MJXp-Span-1029"><span class="MJXp-mi undefined" id="MJXp-Span-1030">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">\mathbb{V}</script></span> có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mrow" id="MJXp-Span-1032"><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1034"><span class="MJXp-mi undefined" id="MJXp-Span-1035">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1036"><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">|\mathbb{V}|</script></span>. Ma trận trọng số mô tả thành phần tuyến tính của phép biến đổi affine này là rất lớn vì đầu ra của nó có số chiều là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-mrow" id="MJXp-Span-1039"><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1041"><span class="MJXp-mi undefined" id="MJXp-Span-1042">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1043"><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">|\mathbb{V}|</script></span>. Để biểu diễn ma trận, cách tiếp cận này phải đánh đổi chi phí bộ nhớ cao cũng như chi phí tính toán cao để thực hiện phép nhân. Bởi vì softmax được chuẩn hóa trên tổng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1045"><span class="MJXp-mrow" id="MJXp-Span-1046"><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-mi undefined" id="MJXp-Span-1049">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1050"><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">|\mathbb{V}|</script></span> đầu ra, cho nên cần phải thực hiện phép nhân ma trận đầy đủ trong thời gian huấn luyện cũng như trong thời gian kiểm thử — chúng ta không thể chỉ tính toán tích vô hướng với vector trọng số để có đầu ra chính xác. Do đó tầng đầu ra phát sinh chi phí tính toán cao trong thời gian huấn luyện (để tính toán khả năng và gradient của nó) và tại thời gian kiểm thử (để tính toán xác suất cho tất cả hoặc các từ đã chọn). Đối với các hàm mất mát chuyên biệt, gradient có thể được tính toán một cách hiệu quả [Vincent et al., 2015], nhưng chuẩn mất mát entropy-chéo được áp dụng cho tầng đầu ra của hàm softmax truyền thống lại vô cùng khó khăn.</p><p>Giả sử rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1053">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">\boldsymbol{h}</script></span> là tầng ẩn trên cùng được sử dụng để dự đoán xác suất đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mrow" id="MJXp-Span-1055"><span class="MJXp-munderover" id="MJXp-Span-1056"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1057">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">\hat{\boldsymbol{y}}</script></span>. Nếu chúng ta biến đổi tham số hóa từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1060">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">\boldsymbol{h}</script></span> sang <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1061"><span class="MJXp-mrow" id="MJXp-Span-1062"><span class="MJXp-munderover" id="MJXp-Span-1063"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1064">y</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">\hat{\boldsymbol{y}}</script></span> với trọng số đã học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1067">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\boldsymbol{W}</script></span> và hệ số đã học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1069">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">\boldsymbol{b}</script></span> thì tầng đầu ra affine softmax sẽ thực hiện các tính toán sau đây:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1070"><span class="MJXp-mtable" id="MJXp-Span-1071"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1072" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1073" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1076" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1078" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1081" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-1084"><span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1087"><span class="MJXp-msubsup" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1090" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1095" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">j</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-1097" style="width: 1.654em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1098">∀</span><span class="MJXp-mrow" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">i</span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-1103">1</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1107"><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1109"><span class="MJXp-mi undefined" id="MJXp-Span-1110">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1111"><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-154"> a_{i} = b_{i} + \sum_j{W_{ij}h_{j}} \hspace{0.7cm} \forall{i} \in \{1,\dots,|\mathbb{V}|\}, \tag{12.8}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1115"><span class="MJXp-mtable" id="MJXp-Span-1116"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1117" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1118" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1119"><span class="MJXp-munderover" id="MJXp-Span-1120"><span><span class="MJXp-over"><span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0px; margin-right: 0px;">^</span></span><span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">i</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1127" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1130" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1133" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">i</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1135"><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1143"><span class="MJXp-mrow" id="MJXp-Span-1144"><span class="MJXp-mo" id="MJXp-Span-1145">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1146"><span class="MJXp-mi undefined" id="MJXp-Span-1147">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-mo" id="MJXp-Span-1149">|</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1137"><span class="MJXp-msup" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1140" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1141">=</span><span class="MJXp-mn" id="MJXp-Span-1142">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">e</span><span class="MJXp-msubsup" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1154" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1157" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-155"> \hat{y_{i}} = \frac{e^{a_{i}}}{\sum_{i'=1}^{|\mathbb{V}|}{ea_{i'}}}. \tag{12.9}</script></span></p><p>Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1160">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">\boldsymbol{h}</script></span> chứa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1164" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">n_{h}</script></span> phần tử thì phép toán trên có độ phức tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">O</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1169"><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1171"><span class="MJXp-mi undefined" id="MJXp-Span-1172">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1173"><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1177" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">h</span></span></span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">O(|\mathbb{V}|n_{h})</script></span>. Với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1180"><span class="MJXp-msubsup" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1183" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">n_{h}</script></span> khoảng hàng ngàn và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mi undefined" id="MJXp-Span-1189">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1190"><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">|\mathbb{V}|</script></span> khoảng hàng trăm ngàn, phép toán này thống trị việc tính toán của hầu hết các mô hình neuron ngôn ngữ.</p><h3 id="12431-Sử-dụng-danh-sách-rút-gọn">12.4.3.1 Sử dụng danh sách rút gọn</h3><p>Các mô hình neuron ngôn ngữ đầu tiên [Bengio et al., 2001, 2003] xử lý vấn đề chi phí cao khi sử dụng softmax trên một số lượng lớn từ đầu ra bằng cách giới hạn kích thước kho từ vựng xuống cỡ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1192"><span class="MJXp-mn" id="MJXp-Span-1193">10.000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">10.000</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1194"><span class="MJXp-mn" id="MJXp-Span-1195">20.000</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">20.000</script></span> từ. Schwenk và Gauvain (2002) và Schwenk (2007) đã dựa trên cách tiếp cận này bằng cách tách kho từ vựng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1196"><span class="MJXp-mrow" id="MJXp-Span-1197"><span class="MJXp-mi undefined" id="MJXp-Span-1198">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">\mathbb{V}</script></span> thành một <strong><em>danh sách rút gọn</em> (shortlist)</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-mrow" id="MJXp-Span-1200"><span class="MJXp-mi undefined" id="MJXp-Span-1201">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">\mathbb{L}</script></span> từ thường xuyên xuất hiện (xử lý bởi mạng neuron) và phần đuôi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1202"><span class="MJXp-mrow" id="MJXp-Span-1203"><span class="MJXp-mi undefined" id="MJXp-Span-1204">T</span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1206"><span class="MJXp-mi undefined" id="MJXp-Span-1207">V</span></span><span class="MJXp-mi" id="MJXp-Span-1208">∖</span><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mi undefined" id="MJXp-Span-1210">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">\mathbb{T}=\mathbb{V}\backslash\mathbb{L}</script></span> từ hiếm khi xuất hiện (được xử lý bởi một mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">n</script></span>-gram). Để có thể kết hợp hai dự đoán, mạng neural phải dự đoán xác suất mà một từ xuất hiện sau ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">C</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">C</script></span> thuộc danh sách đuôi. Điều này có thể đạt được bằng cách cung cấp thêm một đơn vị bổ trợ hàm chữ S ở đầu ra để ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">P</span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">i</span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1220"><span class="MJXp-mrow" id="MJXp-Span-1221"><span class="MJXp-mi undefined" id="MJXp-Span-1222">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">C</span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">P(i\in{\mathbb{T}}\mid C)</script></span>. Đầu ra bổ sung sau đó có thể được sử dụng để ước tính phân phối xác suất trên tất cả các từ trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1226"><span class="MJXp-mrow" id="MJXp-Span-1227"><span class="MJXp-mi undefined" id="MJXp-Span-1228">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">\mathbb{V}</script></span> như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">P</span><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">y</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">i</span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">C</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mn" id="MJXp-Span-1240" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1241" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">i</span><span class="MJXp-mo" id="MJXp-Span-1243">∈</span><span class="MJXp-mrow" id="MJXp-Span-1244"><span class="MJXp-mi undefined" id="MJXp-Span-1245">L</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">P</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">y</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">i</span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">C</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">i</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1256"><span class="MJXp-mi undefined" id="MJXp-Span-1257">L</span></span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1260">1</span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">P</span><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">i</span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1266"><span class="MJXp-mrow" id="MJXp-Span-1267"><span class="MJXp-mi undefined" id="MJXp-Span-1268">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">C</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">P(y=i\mid C)=1_{i\in\mathbb{L}}P(y=i\mid C, i \in\mathbb{L})(1-P(i\in{\mathbb{T}}\mid C))</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1273"><span class="MJXp-mtable" id="MJXp-Span-1274"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1275" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1276" style="text-align: center;"><span class="MJXp-mspace" id="MJXp-Span-1277" style="width: 7.087em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mspace" id="MJXp-Span-1279" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1280"><span class="MJXp-mn" id="MJXp-Span-1281" style="margin-right: 0.05em;">1</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1282" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">i</span><span class="MJXp-mo" id="MJXp-Span-1284">∈</span><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mi undefined" id="MJXp-Span-1286">T</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">P</span><span class="MJXp-mo" id="MJXp-Span-1288" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">y</span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">i</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">C</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">i</span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1297"><span class="MJXp-mi undefined" id="MJXp-Span-1298">T</span></span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">P</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">i</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1304"><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mi undefined" id="MJXp-Span-1306">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">C</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-171">\hspace{3cm} +\,1_{i\in\mathbb{T}}P(y=i\mid C, i \in\mathbb{T})P(i\in{\mathbb{T}}\mid C),\tag{12.10}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">P</span><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">y</span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">i</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">C</span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">i</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1322"><span class="MJXp-mi undefined" id="MJXp-Span-1323">L</span></span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">P(y=i\mid C,i\in\mathbb{L})</script></span> được cung cấp bởi mô hình neuron ngôn ngữ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">P</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">y</span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">i</span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">C</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">i</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-1336"><span class="MJXp-mi undefined" id="MJXp-Span-1337">T</span></span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">P(y=i\mid C,i\in\mathbb{T})</script></span> được cung cấp bởi mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">n</script></span>-gram. Với một thay đổi nhỏ như thế, phương pháp này cũng có thể hoạt động bằng cách sử dụng một giá trị đầu ra bổ sung trong tầng softmax của mô hình neuron ngôn ngữ, thay vì sử dụng một đơn vị hàm chữ S riêng biệt.</p><p>Một điểm hạn chế hiển nhiên của phương pháp tiếp cận bằng danh sách rút gọn là thế mạnh tổng quát hóa tiềm năng của các mô hình neuron ngôn ngữ bị giới hạn bởi những từ thường gặp nhất dù nó được tranh cãi là ít hữu dụng. Chính điều này đã thôi thúc việc khám phá ra các phương pháp thay thế để đối phó với các đầu ra đa chiều, được mô tả dưới đây.</p><h3 id="12432-Softmax-phân-cấp">12.4.3.2 Softmax phân cấp</h3><p>Cách tiếp cận cổ điển [Goodman, 2001] để giảm tải gánh nặng tính toán của các tầng đầu ra đa chiều trên các tập từ vựng lớn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1341"><span class="MJXp-mrow" id="MJXp-Span-1342"><span class="MJXp-mi undefined" id="MJXp-Span-1343">V</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\mathbb{V}</script></span> là phân tích xác suất theo cấp độ. Thay vì yêu cầu mức độ tính toán tỷ lệ thuận với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mrow" id="MJXp-Span-1345"><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1347"><span class="MJXp-mi undefined" id="MJXp-Span-1348">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1349"><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">|\mathbb{V}|</script></span> (và cũng tỷ lệ thuận với số lượng các đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1351"><span class="MJXp-msubsup" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1354" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">n_{h}</script></span>), hệ số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-mrow" id="MJXp-Span-1357"><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1359"><span class="MJXp-mi undefined" id="MJXp-Span-1360">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1361"><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">|\mathbb{V}|</script></span> có thể giảm xuống thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-mi" id="MJXp-Span-1364">log</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1366"><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1368"><span class="MJXp-mi undefined" id="MJXp-Span-1369">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">\log|\mathbb{V}|</script></span>. Bengio (2002), Morin và Bengio (2005) đã giới thiệu hướng tiếp cận nhân tố hóa cho ngữ cảnh của các mô hình neuron ngôn ngữ.</p><p>Ta có thể xem hệ thống phân cấp này như xây dựng các hạng mục từ, sau đó tiếp tục phân loại các hạng mục từ, cứ thế tiếp tục. Những hạng mục lồng nhau này sẽ tạo thành một cây hạng mục, với lá là các từ vựng. Với một cây cân bằng, độ sâu của cây là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">O</span><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1375">log</span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1377"><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-mi undefined" id="MJXp-Span-1380">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1381"><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">O(\log|\mathbb{V}|)</script></span>. Xác suất chọn từ được đưa ra bởi tích các xác suất chọn nhánh dẫn đến từ đó tại mọi nút trên đường dẫn từ gốc đến lá chứa từ đó. Hình 12.4 minh họa một ví dụ đơn giản cho chuyện này. Mnih và Hinton (2009) cũng mô tả cách sử dụng nhiều đường dẫn để xác định một từ duy nhất để mô hình hóa các từ đa nghĩa tốt hơn. Tính toán xác suất của một từ sau đó tổng kết dựa trên tất cả các đường dẫn dẫn đến từ đó.</p><p>Để dự đoán các xác suất có điều kiện được cần có tại mỗi nút của cây, chúng ta thường sử dụng mô hình hồi quy logit tại mỗi nút của cây và cung cấp cùng một ngữ cảnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">C</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">C</script></span> làm đầu vào cho tất cả các mô hình này. Bởi vì đầu ra chính xác được mã hóa trong tập huấn luyện, chúng ta có thể sử dụng thuật toán học có giám sát để huấn luyện các mô hình hồi quy logit. Điều này thường được thực hiện bằng cách sử dụng mất mát chuẩn entropy chéo tương ứng để tối đa hóa khả năng của logarit hàm hợp lý trong chuỗi các quyết định đúng.</p><p>Bởi vì đầu ra logarit hàm hợp lý có thể được tính toán một cách hiệu quả (thấp như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mi" id="MJXp-Span-1387">log</span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1391"><span class="MJXp-mi undefined" id="MJXp-Span-1392">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1393"><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">\log|\mathbb{V}|</script></span> thay vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1395"><span class="MJXp-mrow" id="MJXp-Span-1396"><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1398"><span class="MJXp-mi undefined" id="MJXp-Span-1399">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1400"><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">|\mathbb{V}|)</script></span>, các gradient của nó cũng có thể được tính toán một cách hiệu quả. Điều này không chỉ bao gồm gradient liên quan đến các tham số đầu ra mà còn có các gradient liên quan đến các hàm kích hoạt trong tầng ẩn.</p><p>Thông thường, tối ưu hóa cấu trúc cây để cực tiểu hóa số lượng tính toán dự kiến là khả thi, nhưng không thực tế. Với tần số tương quan giữa các từ, các công cụ từ lý thuyết thông tin đã chỉ cách chọn mã nhị phân tối ưu. Để làm như vậy, chúng ta có thể xây dựng cây để số lượng bit liên kết với một từ xấp xỉ bằng logarit tần số xuất hiện của từ đó. Tuy nhiên trên thực tế, phần tính toán tiết kiệm được thường không đáng vì tính toán xác suất đầu ra chỉ là một phần trên tổng số tính toán trong mô hình neuron ngôn ngữ. Ví dụ, giả sử có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">l</script></span> tầng ẩn kết nối đầy đủ với chiều rộng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1405"><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">n_{h}</script></span>. Cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-msubsup" id="MJXp-Span-1411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">b</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">n_{b}</script></span> là trung bình đã được đánh trọng số của số lượng bit cần thiết để xác định một từ, với việc đánh trọng số được thực hiện bởi tần số của các từ này. Trong ví dụ này, số lượng toán tử cần thiết để tính toán các hàm kích hoạt ẩn tăng đến độ phức tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">O</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">l</span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">n</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1423">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">h</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">O(ln_{h}^2)</script></span>, trong khi các tính toán đầu ra tăng đến độ phức tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">O</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1430" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">h</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1434" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">b</span></span></span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">O(n_{h}n_{b})</script></span>. Miễn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1437"><span class="MJXp-msubsup" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1440" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">b</span></span></span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">l</span><span class="MJXp-msubsup" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1446" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">n_{b} \leq  l n_{h}</script></span>, chúng ta có thể giảm quá trình tính toán bằng cách thu nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-msubsup" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1451" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">n_{h}</script></span> thay vì thu nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1453"><span class="MJXp-msubsup" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1456" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">b</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">n_{b}</script></span>. Thật vậy, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-msubsup" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1461" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">b</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">n_{b}</script></span> thường nhỏ hơn. Vì kích thước của kho từ vựng hiếm khi vượt quá một triệu từ và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">o</span><span class="MJXp-msubsup" id="MJXp-Span-1466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1468" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1469">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mn" id="MJXp-Span-1472" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1473" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1474" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-1476">20</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">log_{2}(10^6)\approx20</script></span>, ta có thể giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-msubsup" id="MJXp-Span-1478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1480" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">b</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">n_{b}</script></span> xuống cỡ 20, trong khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1482"><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1485" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">h</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">n_{h}</script></span> thường lớn hơn nhiều - khoảng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-msubsup" id="MJXp-Span-1488"><span class="MJXp-mn" id="MJXp-Span-1489" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1490" style="vertical-align: 0.5em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">10^3</script></span> trở lên. Thay vì cẩn thận tối ưu hóa một cây có hệ số phân nhánh là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mn" id="MJXp-Span-1492">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">2</script></span>, người ta có thể xây dựng một cây có độ sâu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mn" id="MJXp-Span-1494">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">2</script></span> và hệ số phân nhánh là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-msqrt" id="MJXp-Span-1496"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1497"><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1499"><span class="MJXp-mi undefined" id="MJXp-Span-1500">V</span></span><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">\sqrt{|\mathbb{V}|}</script></span>. Cây này tương ứng với việc định nghĩa đơn giản một tập hợp các lớp từ loại trừ lẫn nhau. Cách tiếp cận đơn giản dựa trên cây có độ sâu bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1503"><span class="MJXp-mn" id="MJXp-Span-1504">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">2</script></span> tận dụng hầu hết các lợi thế tính toán của chiến lược phân cấp.</p><p>------------------------<br>
Lại Minh Duy kết thúc dịch từ đây<br>
------------------------</p></div>