<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Chương 17: Phương pháp Monte Carlo - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-17-Phương-pháp-Monte-Carlo"><a class="anchor hidden-xs" href="#Chương-17-Phương-pháp-Monte-Carlo" title="Chương-17-Phương-pháp-Monte-Carlo"><span class="octicon octicon-link"></span></a>Chương 17: Phương pháp Monte Carlo</h1><p>------- HungTran bắt đầu dịch từ đây -------------<br>
Các thuật toán ngẫu nhiên được chia thành hai nhóm chính: các thuật toán Las Vegas và các thuật toán Monte Carlo. Các thuật toán Las Vegas luôn đưa ra câu trả lời chính xác (hoặc thông báo rằng thuật toán đã thất bại). Những thuật toán này sử dụng lượng tài nguyên một cách ngẫu nhiên, thông thường là tài nguyên về bộ nhớ hoặc thời gian. Ngược lại, các thuật toán Monte Carlo đưa ra câu trả lời với một lượng sai số ngẫu nhiên. Lượng sai số này thường có thể giảm bằng cách sử dụng nhiều tài nguyên hơn (thông thường là thời gian thực thi và bộ nhớ). Đối với các dự án có ngân sách đã được tính toán cố định, thuật toán Monte Carlo có thể đưa ra một câu trả lời gần đúng.</p><p>-------- HungTran kết thúc dịch ở đây ------------<br>
-------- Nguyen Thanh Chinh bắt đầu dịch ở đây ------------<br>
Nhiều bài toán trong học máy rất khó để tìm được câu trả lời chính xác. Điều này loại trừ các thuật toán xác định chính xác và các thuật toán Las Vegas. Thay vào đó, chúng ta phải sử dụng các thuật toán xấp xỉ quyết định hay xấp xỉ Monte Carlo. Cả hai phương pháp này đều phổ biến trong học máy. Trong chương này, chúng ta tập trung chủ yếu vào các phương pháp Monte Carlo.</p><h2 id="171-Lấy-mẫu-và-các-phương-pháp-Monte-Carlo"><a class="anchor hidden-xs" href="#171-Lấy-mẫu-và-các-phương-pháp-Monte-Carlo" title="171-Lấy-mẫu-và-các-phương-pháp-Monte-Carlo"><span class="octicon octicon-link"></span></a>17.1 Lấy mẫu và các phương pháp Monte Carlo</h2><p>Rất nhiều kĩ thuật quan trọng được sử dụng để hoàn thành các mục tiêu học máy dựa vào việc lấy các mẫu từ một vài phân phối xác suất nào đó và sử dụng các mẫu này để xây dựng một ước tính Monte Carlo của các đại lượng mong muốn.</p><h3 id="1711-Lý-do-lấy-mẫu"><a class="anchor hidden-xs" href="#1711-Lý-do-lấy-mẫu" title="1711-Lý-do-lấy-mẫu"><span class="octicon octicon-link"></span></a>17.1.1 Lý do lấy mẫu</h3><p>Chúng ta mong muốn lấy các mẫu từ một phân phối xác suất vì nhiều lý do. Việc lấy mẫu cung cấp một cách linh hoạt để tính xấp xỉ các tổng và tích phân với chi phí nhỏ hơn. Đôi khi chúng ta cũng sử dụng việc lấy mẫu này để cung cấp một sự tăng tốc đáng kể cho một tác vụ có chi phí lớn nhưng có thể xử lý dễ dàng, như trong trường hợp lấy <em>mẫu con</em> (subsample) của toàn bộ chi phí huấn luyện với lô nhỏ. Trong một số trường hợp khác, các thuật toán học yêu cầu phải xấp xỉ một tổng hoặc một tích phân, chẳng hạn như gradient của <em>hàm phân hoạch logarit</em> (log partition function) trong mô hình vô hướng. Trong nhiều trường hợp khác nữa, việc lấy mẫu thực sự là mục tiêu của chúng ta, khi chúng ta muốn huấn luyện một mô hình có thể lấy mẫu từ phân phối trong tập huấn luyện.</p><h3 id="1712-Khái-niệm-cơ-bản-của-lấy-mẫu-Monte-Carlo"><a class="anchor hidden-xs" href="#1712-Khái-niệm-cơ-bản-của-lấy-mẫu-Monte-Carlo" title="1712-Khái-niệm-cơ-bản-của-lấy-mẫu-Monte-Carlo"><span class="octicon octicon-link"></span></a>17.1.2 Khái niệm cơ bản của lấy mẫu Monte Carlo</h3><p>Khi một tổng hoặc một tích phân không thể tính được chính xác (ví dụ tổng có số lượng phần tử là một số có dạng hàm mũ, và không có công thức rút gọn chính xác), nó thường được xấp xỉ bằng cách sử dụng lấy mẫu Monte Carlo. Ý tưởng là xem tổng hoặc tích phân như một kì vọng theo một phân phối nào đó, và <em>xấp xỉ kì vọng đó bằng mức trung bình tương ứng</em>. Đặt</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 100%; display: inline-block; min-width: 18.968em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 18.968em;"><span style="position: absolute; clip: rect(2.535em, 1012.13em, 4.96em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="min-width: 18.968em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.968em;"><span style="display: inline-block; position: absolute; width: 12.233em; height: 0px; clip: rect(-1.452em, 1012.13em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -6.086em;"><span style="position: absolute; clip: rect(2.535em, 1012.13em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.233em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1012.13em, 5.283em, -999.997em); top: -4.362em; left: 50%; margin-left: -6.086em;"><span class="mtd" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-11" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.259em, -999.997em); top: -2.961em; left: 0.488em;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.237em, 1002.48em, 0.057em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="mjx-eqn-17.1"><span class="mrow" id="MathJax-Span-5"><span class="mtext" id="MathJax-Span-6" style="font-family: MathJax_Main;">(17.1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1"> s = \sum_{\boldsymbol x}p(\boldsymbol x) \mathcal{f}(\boldsymbol x)=E_p[\mathcal{f}(\mathrm{x})]
\tag{17.1} </script></span></p><p>hoặc</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-40" style="width: 100%; display: inline-block; min-width: 18.429em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 18.429em;"><span style="position: absolute; clip: rect(2.481em, 1011.59em, 5.013em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-41"><span class="mtable" id="MathJax-Span-42" style="min-width: 18.429em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.429em;"><span style="display: inline-block; position: absolute; width: 11.748em; height: 0px; clip: rect(-1.506em, 1011.59em, 1.026em, -999.997em); top: 0em; left: 50%; margin-left: -5.87em;"><span style="position: absolute; clip: rect(2.481em, 1011.59em, 5.013em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.748em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1011.59em, 5.013em, -999.997em); top: -3.984em; left: 50%; margin-left: -5.87em;"><span class="mtd" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-50" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1000.97em, 5.013em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.38em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-56"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-63" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="mi" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.913em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.2"><span class="mrow" id="MathJax-Span-44"><span class="mtext" id="MathJax-Span-45" style="font-family: MathJax_Main;">(17.2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2"> s = \int_{}p(\boldsymbol x) \mathcal{f}(\boldsymbol x)=E_p[\mathcal{f}(\mathrm{x})]
\tag{17.2} </script></span></p><p>là tổng hoặc tích phân cần ước lượng, được viết lại dưới dạng một kì vọng, với ràng buộc rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-76" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">p</script></span> là một phân phối xác suất (khi xấp xỉ tổng) hay mật độ xác suất (khi xấp xỉ tích phân) của biến ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-79" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-80"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Main-bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\mathbf{x}</script></span>.</p><p>Chúng ta có thể xấp xỉ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-84" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">s</script></span> bằng cách lấy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-87" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">n</script></span> mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-90" style="width: 6.468em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.552em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1005.55em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-102" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mo" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\boldsymbol x^{(1)},\dots,\boldsymbol x^{(n)}</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-109" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">p</script></span> sau đó tính trung bình thực nghiệm</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-112" style="width: 100%; display: inline-block; min-width: 14.981em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 14.981em;"><span style="position: absolute; clip: rect(2.212em, 1008.19em, 5.283em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-113"><span class="mtable" id="MathJax-Span-114" style="min-width: 14.981em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.981em;"><span style="display: inline-block; position: absolute; width: 8.246em; height: 0px; clip: rect(-1.775em, 1008.19em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -4.092em;"><span style="position: absolute; clip: rect(2.212em, 1008.19em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.246em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1008.19em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -4.092em;"><span class="mtd" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-121"><span class="mrow" id="MathJax-Span-122"><span class="munderover" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-128" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-129" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.7em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.703em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-131" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-133"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 0.488em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-139" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-17.3"><span class="mrow" id="MathJax-Span-116"><span class="mtext" id="MathJax-Span-117" style="font-family: MathJax_Main;">(17.3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.372em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-9"> \hat s_n = \frac{1}{n} \sum_{i=1}^n \mathcal{f}(\boldsymbol x^{(i)}).
\tag{17.3} </script></span></p><p>Xấp xỉ này được xác minh bởi một vài tính chất khác nhau. Quan sát dễ nhận thấy nhất trước tiên là ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-152" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="texatom" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="munderover" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\hat{s}</script></span> không chệch, vì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-159" style="width: 100%; display: inline-block; min-width: 23.71em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 23.71em;"><span style="position: absolute; clip: rect(2.212em, 1016.92em, 5.283em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-160"><span class="mtable" id="MathJax-Span-161" style="min-width: 23.71em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.71em;"><span style="display: inline-block; position: absolute; width: 17.029em; height: 0px; clip: rect(-1.775em, 1016.92em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -8.51em;"><span style="position: absolute; clip: rect(2.212em, 1016.92em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.029em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1016.92em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -8.51em;"><span class="mtd" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-171"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="munderover" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-180" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-181" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.7em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.703em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-183" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 0.488em;"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-191" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-192"><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-209" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.7em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.703em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-212" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 0.488em;"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">s</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-17.4"><span class="mrow" id="MathJax-Span-163"><span class="mtext" id="MathJax-Span-164" style="font-family: MathJax_Main;">(17.4)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.372em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">
\mathbb{E}[\hat {s}_n] = \frac{1}{n}\sum_{i=1}^n\mathbb{E}[\mathcal{f}(\boldsymbol x^{(i)})] = \frac{1}{n}\sum_{i=1}^ns = s
\tag{17.4}. </script></span></p><p>Nhưng thêm vào đó, <strong><em>luật số lớn</em> (law of large numbers)</strong> phát biểu rằng nếu các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-224" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1001.51em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\boldsymbol x^{(i)}</script></span> <em>có cùng phân phối xác suất và độc lập với nhau</em> (i.i.d), trung bình của chúng gần như chắc chắn hội tụ về giá trị kì vọng:</p><blockquote>
<p>[Thang Le] i.i.d = Independent and identically distributed<br>
[NguyenTT] In probability theory and statistics, a sequence or collection of random variables is independent and identically distributed (i.i.d. or iid or IID) if each random variable has the same probability distribution as the others and all are mutually independent.[1]<br>
Ref: <a href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables</a></p>
</blockquote><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-233" style="width: 100%; display: inline-block; min-width: 11.856em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 11.856em;"><span style="position: absolute; clip: rect(2.804em, 1005.07em, 4.636em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-234"><span class="mtable" id="MathJax-Span-235" style="min-width: 11.856em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.856em;"><span style="display: inline-block; position: absolute; width: 5.121em; height: 0px; clip: rect(-1.183em, 1005.07em, 0.649em, -999.997em); top: 0em; left: 50%; margin-left: -2.584em;"><span style="position: absolute; clip: rect(2.858em, 1005.07em, 4.636em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.121em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1005.07em, 4.852em, -999.997em); top: -4.2em; left: 50%; margin-left: -2.584em;"><span class="mtd" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="munderover" id="MathJax-Span-241"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.4em, 4.151em, -999.997em); top: -3.984em; left: 0.218em;"><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1001.78em, 4.259em, -999.997em); top: -3.392em; left: 0em;"><span class="texatom" id="MathJax-Span-243"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Main;">→</span><span class="mi" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-248" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-249"><span class="mrow" id="MathJax-Span-250"><span class="munderover" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">s</span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.129em, 1002.48em, 0.218em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.2em; right: 0em;"><span class="mtd" id="mjx-eqn-17.5"><span class="mrow" id="MathJax-Span-237"><span class="mtext" id="MathJax-Span-238" style="font-family: MathJax_Main;">(17.5)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.878em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\lim_{n \to \infty}\hat{s}_n=s,\tag{17.5} </script></span></p><p>với điều kiện phương sai của từng đại lượng riêng lẻ, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-258" style="width: 5.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.013em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1004.91em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-259"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-268"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-270"><span class="mrow" id="MathJax-Span-271"><span class="mo" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\mathrm{Var}[f(\boldsymbol x^{(i)})]</script></span>, bị chặn. Thật vậy, xét phương sai của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-277" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.08em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="munderover" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\hat{s}_n</script></span> khi tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-286" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">n</script></span>. Phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-289" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.18em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-290"><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="munderover" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\mathrm{Var}[\hat{s}_n]</script></span> giảm dần và hội tụ về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-305" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mn" id="MathJax-Span-307" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">0</script></span>, miễn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-308" style="width: 8.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.276em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1007.22em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-309"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="mo" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.272em;">&lt;</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.272em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\mathrm{Var}[f(\boldsymbol{\mathrm{x}}^{(i)})]<\infty</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-331" style="width: 100%; display: inline-block; min-width: 18.591em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 18.591em;"><span style="position: absolute; clip: rect(3.235em, 1011.75em, 8.785em, -999.997em); top: -6.247em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-332"><span class="mtable" id="MathJax-Span-333" style="min-width: 18.591em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.591em;"><span style="display: inline-block; position: absolute; width: 11.856em; height: 0px; clip: rect(-3.015em, 1011.75em, 2.535em, -999.997em); top: 0em; left: 50%; margin-left: -5.924em;"><span style="position: absolute; clip: rect(2.535em, 1003.13em, 6.576em, -999.997em); top: -4.739em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1003.13em, 4.421em, -999.997em); top: -5.277em; right: 0em;"><span class="mtd" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="texatom" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-346"><span class="mrow" id="MathJax-Span-347"><span class="munderover" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.314em; right: 0em;"><span class="mtd" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.744em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1008.52em, 8.785em, -999.997em); top: -6.247em; left: 3.235em;"><span style="display: inline-block; position: relative; width: 8.623em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1008.52em, 5.337em, -999.997em); top: -5.277em; left: 0em;"><span class="mtd" id="MathJax-Span-353"><span class="mrow" id="MathJax-Span-354"><span class="mi" id="MathJax-Span-355"></span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-357" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-358" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.151em, -999.997em); top: -3.23em; left: 50%; margin-left: -0.536em;"><span class="msubsup" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.595em;"><span class="mn" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.13em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.134em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-362" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-364"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 0.488em;"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-370" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-373" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-376"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1006.04em, 4.852em, -999.997em); top: -2.314em; left: 0em;"><span class="mtd" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392"></span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-394" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.259em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.99em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.045em;"><span class="mrow" id="MathJax-Span-395"><span class="texatom" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-406"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1004.26em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.259em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.253em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-2.206em, 1002.48em, 2.104em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -5.277em; right: 0em;"><span class="mtd" id="mjx-eqn-17.6"><span class="mrow" id="MathJax-Span-335"><span class="mtext" id="MathJax-Span-336" style="font-family: MathJax_Main;">(17.6)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -2.314em; right: 0em;"><span class="mtd" id="mjx-eqn-17.7"><span class="mrow" id="MathJax-Span-386"><span class="mtext" id="MathJax-Span-387" style="font-family: MathJax_Main;">(17.7)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.253em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.809em; border-left: 0px solid; width: 0px; height: 6.191em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{align*}
\mathrm{Var}[\hat{s}_n] 
&= \frac{1}{n^2}\sum_{i=1}^n\mathrm{Var}[\mathcal{f}(\boldsymbol{\mathrm{x}})] 
\tag{17.6} \\
&= \frac{\mathrm{Var}[\mathcal{f}(\boldsymbol{\mathrm{x}})]}{n}.
\tag{17.7}
\end{align*}</script></span></p><p>Kết quả này cho ta biết cách để ước lượng sự bất định trong trung bình Monte Carlo hay còn gọi là sai số dự kiến của xấp xỉ Monte Carlo. Chúng ta tính cả giá trị trung bình thực nghiệm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-413" style="width: 3.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1002.75em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="texatom" id="MathJax-Span-415"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mo" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\mathcal{f}(\boldsymbol x^{(i)})</script></span> và phương sai thực nghiệm của chúng,<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> sau đó chia phương sai đã ước lượng cho số lượng mẫu thử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-427" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">n</script></span> để thu được một ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-430" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.18em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="texatom" id="MathJax-Span-432"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="munderover" id="MathJax-Span-441"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\mathrm{Var}[\hat{s}_n]</script></span>. Theo <strong><em>định lý giới hạn trung tâm</em> (central limit theorem)</strong> về phân phối của đại lượng trung bình, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-446" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.08em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-447"><span class="msubsup" id="MathJax-Span-448"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="munderover" id="MathJax-Span-451"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\hat{s}_n</script></span> hội tụ về phân phối chuẩn với trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-455" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-456"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">s</script></span> và phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-458" style="width: 3.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.08em, 1003.18em, 2.912em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-459"><span class="mfrac" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.289em, 1002.8em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -1.452em;"><span class="mrow" id="MathJax-Span-461"><span class="texatom" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-467" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="mi" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 50%; margin-left: -0.213em;"><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.97em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.966em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\frac{\mathrm{Var}[\mathcal{f}(\mathrm{x})]}{n}</script></span>. Điều này cho phép chúng ta ước tính khoảng sai số tin cậy xung quanh ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-478" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.08em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="msubsup" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-481"><span class="mrow" id="MathJax-Span-482"><span class="munderover" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\hat{s}_n</script></span>, bằng cách sử dụng phân phối luỹ tích của hàm mật độ chuẩn.</p><p>Tất cả điều trên chỉ đúng với giả thiết rằng các mẫu có thể lấy dễ dàng từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-487" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">p(\mathbf{x})</script></span>, tuy nhiên việc này không phải lúc nào cũng có thể thực hiện được. Khi việc lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-495" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-496"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">p</script></span> không khả thi, một giải pháp thay thế là sử dụng phương pháp lấy mẫu theo mức độ quan trọng, được trình bày trong phần <strong>17.2</strong>. Một cách tiếp cận tổng quát hơn là xây dựng một chuỗi các ước lượng hội tụ hướng về phân phối mong muốn. Nó được gọi là phương pháp chuỗi Markov Monte Carlo (phần <strong>17.3</strong>).</p><h2 id="172-Lấy-mẫu-theo-mức-độ-quan-trọng"><a class="anchor hidden-xs" href="#172-Lấy-mẫu-theo-mức-độ-quan-trọng" title="172-Lấy-mẫu-theo-mức-độ-quan-trọng"><span class="octicon octicon-link"></span></a>17.2 Lấy mẫu theo mức độ quan trọng</h2><p>Một bước quan trọng khi phân tích biểu thức dưới dấu tích phân (hoặc tổng) dùng trong phương pháp Monte Carlo ở phương trình <strong>17.2</strong> là quyết định phần nào của tích phân đóng vai trò của xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-498" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.84em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">p(\boldsymbol x)</script></span> và phần nào của tích phân đóng vai trò của định lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-504" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.89em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-505"><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">\mathcal{f}(\boldsymbol x)</script></span> mà giá trị kì vọng của nó (theo phân bố xác suất trên) sẽ được ước tính. Có nhiều hơn một cách để phân tích vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-512" style="width: 4.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.936em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.83em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">p(\boldsymbol x)f(\boldsymbol x)</script></span> luôn có thể viết lại dưới dạng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-522" style="width: 100%; display: inline-block; min-width: 18.429em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 18.429em;"><span style="position: absolute; clip: rect(2.373em, 1011.64em, 5.121em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-523"><span class="mtable" id="MathJax-Span-524" style="min-width: 18.429em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.429em;"><span style="display: inline-block; position: absolute; width: 11.695em; height: 0px; clip: rect(-1.614em, 1011.64em, 1.134em, -999.997em); top: 0em; left: 50%; margin-left: -5.87em;"><span style="position: absolute; clip: rect(2.373em, 1011.64em, 5.121em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.695em; height: 0px;"><span style="position: absolute; clip: rect(2.373em, 1011.64em, 5.121em, -999.997em); top: -3.984em; left: 50%; margin-left: -5.87em;"><span class="mtd" id="MathJax-Span-528"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-535" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.83em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.937em;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1001.78em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1004.04em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.044em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.913em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.8"><span class="mrow" id="MathJax-Span-526"><span class="mtext" id="MathJax-Span-527" style="font-family: MathJax_Main;">(17.8)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">p(\boldsymbol x)f(\boldsymbol x)=q(\boldsymbol x)\frac{p(\boldsymbol x)f(\boldsymbol x)}{q(\boldsymbol x)},
\tag{17.8}</script></span></p><p>khi đó, ta có thể lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-559" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">q</script></span> và giá trị trung bình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-562" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.134em, 1001.08em, 3.02em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-563"><span class="mfrac" id="MathJax-Span-564"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.76em, 4.313em, -999.997em); top: -4.523em; left: 50%; margin-left: -0.374em;"><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.661em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-568" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.87em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.865em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">\frac{pf}{q}</script></span>. Trong nhiều trường hợp, ta muốn tính toán kì vọng cho cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-569" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">p</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-572" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-573"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">f</script></span> đã cho, và thực tế là vấn đề đã được xác định ngay từ đầu vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-575" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">p</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-578" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-579"><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">f</script></span> sẽ là một lựa chọn tự nhiên của phân tích. Tuy vậy, đặc điểm ban đầu của vấn đề có thể không phải là lựa chọn tối ưu về mặt số lượng mẫu cần thiết để đạt được độ chính xác đưa ra. May mắn thay, có thể lựa chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-581" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-582"><span class="msubsup" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-585" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">q^*</script></span> một cách dễ dàng. Tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-586" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-587"><span class="msubsup" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">q^*</script></span> tương ứng với phương pháp lấy mẫu theo độ quan trọng tối ưu.</p><p>Như đã trình bày ở phương trình 17.8, một ước lượng Monte Carlo bất kì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-591" style="width: 100%; display: inline-block; min-width: 16.436em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 16.436em;"><span style="position: absolute; clip: rect(2.104em, 1009.65em, 5.498em, -999.997em); top: -4.038em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-592"><span class="mtable" id="MathJax-Span-593" style="min-width: 16.436em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.436em;"><span style="display: inline-block; position: absolute; width: 9.755em; height: 0px; clip: rect(-1.937em, 1009.65em, 1.457em, -999.997em); top: 0em; left: 50%; margin-left: -4.846em;"><span style="position: absolute; clip: rect(2.104em, 1009.65em, 5.498em, -999.997em); top: -4.038em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.755em; height: 0px;"><span style="position: absolute; clip: rect(2.32em, 1009.65em, 5.714em, -999.997em); top: -4.254em; left: 50%; margin-left: -4.846em;"><span class="mtd" id="MathJax-Span-597"><span class="mrow" id="MathJax-Span-598"><span class="msubsup" id="MathJax-Span-599"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-600"><span class="mrow" id="MathJax-Span-601"><span class="munderover" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-607" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-608" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.7em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.703em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-610" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.919em;"><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1003.29em, 4.367em, -999.997em); top: -2.745em; left: 0em;"><span class="texatom" id="MathJax-Span-612"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-615" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-616" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-617" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.434em;"><span class="texatom" id="MathJax-Span-622"><span class="mrow" id="MathJax-Span-623"><span class="mo" id="MathJax-Span-624" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-625" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-626" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-627" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 1.457em;"><span class="mi" id="MathJax-Span-629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-632"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-634"><span class="mrow" id="MathJax-Span-635"><span class="mo" id="MathJax-Span-636" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.044em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.044em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-1.129em, 1002.48em, 0.218em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.2em; right: 0em;"><span class="mtd" id="mjx-eqn-17.9"><span class="mrow" id="MathJax-Span-595"><span class="mtext" id="MathJax-Span-596" style="font-family: MathJax_Main;">(17.9)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.044em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.691em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">\hat s_p = \frac{1}{n} \sum_{i=1, \mathbf{x}^{(i)}\sim p}^nf(\boldsymbol x^{(i)})
\tag{17.9}</script></span></p><p>có thể biến đổi thành một ước lượng lấy mẫu theo độ quan trọng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-640" style="width: 100%; display: inline-block; min-width: 20.854em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 20.854em;"><span style="position: absolute; clip: rect(2.158em, 1013.04em, 5.552em, -999.997em); top: -4.092em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-641"><span class="mtable" id="MathJax-Span-642" style="min-width: 20.854em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.854em;"><span style="display: inline-block; position: absolute; width: 13.149em; height: 0px; clip: rect(-1.937em, 1013.04em, 1.457em, -999.997em); top: 0em; left: 50%; margin-left: -6.571em;"><span style="position: absolute; clip: rect(2.158em, 1013.04em, 5.552em, -999.997em); top: -4.092em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.149em; height: 0px;"><span style="position: absolute; clip: rect(2.32em, 1013.04em, 5.768em, -999.997em); top: -4.254em; left: 50%; margin-left: -6.571em;"><span class="mtd" id="MathJax-Span-646"><span class="mrow" id="MathJax-Span-647"><span class="msubsup" id="MathJax-Span-648"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="munderover" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-656" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-657" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.7em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.703em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-659" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.919em;"><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1003.29em, 4.367em, -999.997em); top: -2.745em; left: 0em;"><span class="texatom" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-665" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-666" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-667"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.434em;"><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mo" id="MathJax-Span-673" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-674" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-675" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-677" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -5.116em; left: 1.404em;"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-679" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 5.768em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(2.912em, 1005.55em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.853em;"><span class="mrow" id="MathJax-Span-680"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-685"><span class="mrow" id="MathJax-Span-686"><span class="mo" id="MathJax-Span-687" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-689" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-692" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-693"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-694" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-695"><span class="mrow" id="MathJax-Span-696"><span class="mo" id="MathJax-Span-697" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-699" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1002.7em, 4.421em, -999.997em); top: -3.176em; left: 50%; margin-left: -1.398em;"><span class="mrow" id="MathJax-Span-701"><span class="mi" id="MathJax-Span-702" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-703" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.649em;"><span class="texatom" id="MathJax-Span-706"><span class="mrow" id="MathJax-Span-707"><span class="mo" id="MathJax-Span-708" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-709" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1005.77em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.768em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.098em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.098em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-1.075em, 1002.97em, 0.218em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -4.146em; right: 0em;"><span class="mtd" id="mjx-eqn-17.10"><span class="mrow" id="MathJax-Span-644"><span class="mtext" id="MathJax-Span-645" style="font-family: MathJax_Main;">(17.10)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.098em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">\hat s_q = \frac{1}{n} \sum_{i=1, \mathbf{x}^{(i)}\sim q}^n\frac{p(\boldsymbol x^{(i)})f(\boldsymbol x^{(i)})}{q(\boldsymbol x^{(i)})}.\tag{17.10}</script></span></p><p>Chúng ta dễ thấy rằng giá trì kì vọng của ước lượng không phụ thuộc vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-713" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-714"><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">q</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-716" style="width: 100%; display: inline-block; min-width: 16.274em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 16.274em;"><span style="position: absolute; clip: rect(3.02em, 1008.52em, 4.421em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-717"><span class="mtable" id="MathJax-Span-718" style="min-width: 16.274em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.274em;"><span style="display: inline-block; position: absolute; width: 8.57em; height: 0px; clip: rect(-0.967em, 1008.52em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -4.308em;"><span style="position: absolute; clip: rect(3.074em, 1008.52em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.57em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1008.52em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -4.308em;"><span class="mtd" id="MathJax-Span-722"><span class="mrow" id="MathJax-Span-723"><span class="msubsup" id="MathJax-Span-724"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mi" id="MathJax-Span-727" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-730"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-731"><span class="mrow" id="MathJax-Span-732"><span class="munderover" id="MathJax-Span-733"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-739" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-743" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="munderover" id="MathJax-Span-748"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-753" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">s</span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.913em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.11"><span class="mrow" id="MathJax-Span-720"><span class="mtext" id="MathJax-Span-721" style="font-family: MathJax_Main;">(17.11)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\mathbb{E}_q[\hat{s}_q]=\mathbb{E}_q[\hat{s}_p]=s.\tag{17.11}</script></span></p><p>Tuy nhiên, phương sai của ước lượng lấy mẫu theo độ quan trọng lại rất nhạy cảm với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-756" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-757"><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">q</script></span>. Phương sai được cho bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-759" style="width: 100%; display: inline-block; min-width: 19.776em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 19.776em;"><span style="position: absolute; clip: rect(2.373em, 1012.02em, 5.121em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-760"><span class="mtable" id="MathJax-Span-761" style="min-width: 19.776em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.776em;"><span style="display: inline-block; position: absolute; width: 12.072em; height: 0px; clip: rect(-1.614em, 1012.02em, 1.134em, -999.997em); top: 0em; left: 50%; margin-left: -6.032em;"><span style="position: absolute; clip: rect(2.373em, 1012.02em, 5.121em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.072em; height: 0px;"><span style="position: absolute; clip: rect(2.373em, 1012.02em, 5.121em, -999.997em); top: -3.984em; left: 50%; margin-left: -6.032em;"><span class="mtd" id="MathJax-Span-765"><span class="mrow" id="MathJax-Span-766"><span class="texatom" id="MathJax-Span-767"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"><span class="munderover" id="MathJax-Span-776"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-782" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-783"><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 3.774em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.56em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.829em;"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-792"><span class="mrow" id="MathJax-Span-793"><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-798"><span class="mrow" id="MathJax-Span-799"><span class="mi" id="MathJax-Span-800" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1001.67em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.859em;"><span class="mrow" id="MathJax-Span-802"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-805"><span class="mrow" id="MathJax-Span-806"><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1003.77em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.774em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-810"><span class="mrow" id="MathJax-Span-811"><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-814" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.913em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.12"><span class="mrow" id="MathJax-Span-763"><span class="mtext" id="MathJax-Span-764" style="font-family: MathJax_Main;">(17.12)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">\mathrm{Var}[\hat{s}_q]=\mathrm{Var}[\frac{p(\mathrm{x})f(\mathrm{x})}{q(\mathrm{x})}]/n.
\tag{17.12}</script></span></p><p>Giá trị nhỏ nhất của phương sai đạt được khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-815" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-816"><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">q</script></span> là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-818" style="width: 100%; display: inline-block; min-width: 16.544em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 16.544em;"><span style="position: absolute; clip: rect(2.481em, 1008.73em, 4.96em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-819"><span class="mtable" id="MathJax-Span-820" style="min-width: 16.544em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.544em;"><span style="display: inline-block; position: absolute; width: 8.839em; height: 0px; clip: rect(-1.506em, 1008.73em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -4.415em;"><span style="position: absolute; clip: rect(2.481em, 1008.73em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.839em; height: 0px;"><span style="position: absolute; clip: rect(2.373em, 1008.73em, 4.852em, -999.997em); top: -3.823em; left: 50%; margin-left: -4.415em;"><span class="mtd" id="MathJax-Span-824"><span class="mrow" id="MathJax-Span-825"><span class="msubsup" id="MathJax-Span-826"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mo" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-832" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-833" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.582em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1004.37em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.26em;"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-839"><span class="mrow" id="MathJax-Span-840"><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-843" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-845" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-846"><span class="mrow" id="MathJax-Span-847"><span class="mo" id="MathJax-Span-848" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.374em;"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1004.58em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.582em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.752em, 1002.97em, 0.541em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.823em; right: 0em;"><span class="mtd" id="mjx-eqn-17.13"><span class="mrow" id="MathJax-Span-822"><span class="mtext" id="MathJax-Span-823" style="font-family: MathJax_Main;">(17.13)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">q^*(\boldsymbol x)=\frac{p(\boldsymbol x)|f(\boldsymbol x)|}{Z},\tag{17.13}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-851" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.76em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-852"><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">Z</script></span> là hằng số chuẩn hoá, được chọn sao cho phép lấy tổng hoặc tích phân của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-854" style="width: 2.751em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.373em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.27em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-855"><span class="msubsup" id="MathJax-Span-856"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-857" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-858" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-861" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">q^*(\boldsymbol x)</script></span> có giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-862" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-863"><span class="mn" id="MathJax-Span-864" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">1</script></span>. Các phân phối lấy mẫu theo độ quan trọng tốt hơn đặt các trọng số nhiều hơn khi biểu thức dưới dấu tích phân lớn hơn. Trong thực tế, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-865" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.89em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-866"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-870" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">f(\boldsymbol x)</script></span> không đổi dấu, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-871" style="width: 6.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.337em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1005.28em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-872"><span class="texatom" id="MathJax-Span-873"><span class="mrow" id="MathJax-Span-874"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-880"><span class="mrow" id="MathJax-Span-881"><span class="munderover" id="MathJax-Span-882"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="texatom" id="MathJax-Span-885"><span class="mrow" id="MathJax-Span-886"><span class="msubsup" id="MathJax-Span-887"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.38em;"><span class="mo" id="MathJax-Span-889" style="font-size: 50%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-890" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-892" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">\mathrm{Var}[\hat{s}_{q^*}]=0</script></span>, nghĩa là <em>chỉ cần một mẫu là đủ</em> khi phân phối tối ưu được sử dụng. Tất nhiên, điều này là vì việc tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-893" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-894"><span class="msubsup" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">q^*</script></span> về cơ bản đã giải quyết được vấn đề ban đầu, vì vậy việc sử dụng phương pháp lấy một mẫu từ phân phối tối ưu là không thực tế.</p><p>Bất kì sự lựa chọn của phân phối lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-898" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-899"><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">q</script></span> đều là hợp lệ (để tính được giá trị kì vọng chính xác), và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-901" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-902"><span class="msubsup" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">q^*</script></span> là phân phối tối ưu (để phương sai là nhỏ nhất). Phép lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-906" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-907"><span class="msubsup" id="MathJax-Span-908"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">q^*</script></span> thường không khả thi, nhưng các lựa chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-911" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-912"><span class="mi" id="MathJax-Span-913" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">q</script></span> khác có thể khả thi trong khi vẫn giảm phương sai ở một mức độ nào đó.</p><p>Một cách tiếp cận khác là sử dụng <strong><em>lấy mẫu theo độ quan trọng có thiên kiến</em> (biased importance sampling)</strong>, ưu điểm của nó là không yêu cầu chuẩn hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-914" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-915"><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">p</script></span> hay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-917" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-918"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">q</script></span>. Trong trường hợp các biến rời rạc, ước lượng lấy mẫu theo độ quan trọng có thiên kiến được cho bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-920" style="width: 100%; display: inline-block; min-width: 19.399em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 19.399em;"><span style="position: absolute; clip: rect(7.169em, 1011.64em, 20.585em, -999.997em); top: -14.114em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-921"><span class="mtable" id="MathJax-Span-922" style="min-width: 19.399em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.399em;"><span style="display: inline-block; position: absolute; width: 11.695em; height: 0px; clip: rect(-6.948em, 1011.64em, 6.468em, -999.997em); top: 0em; left: 50%; margin-left: -5.87em;"><span style="position: absolute; clip: rect(5.337em, 1002em, 15.304em, -999.997em); top: -10.665em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1002em, 4.313em, -999.997em); top: -8.402em; right: 0em;"><span class="mtd" id="MathJax-Span-926"><span class="mrow" id="MathJax-Span-927"><span class="msubsup" id="MathJax-Span-928"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-929"><span class="mrow" id="MathJax-Span-930"><span class="munderover" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="texatom" id="MathJax-Span-934"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mi" id="MathJax-Span-937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-938" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-1021"><span class="mrow" id="MathJax-Span-1022"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 0.488em; right: 0em;"><span class="mtd" id="MathJax-Span-1113"><span class="mrow" id="MathJax-Span-1114"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.671em;"></span></span><span style="position: absolute; clip: rect(7.169em, 1009.65em, 20.585em, -999.997em); top: -14.114em; left: 1.996em;"><span style="display: inline-block; position: relative; width: 9.701em; height: 0px;"><span style="position: absolute; clip: rect(2.643em, 1009.32em, 7.169em, -999.997em); top: -9.588em; left: 0em;"><span class="mtd" id="MathJax-Span-939"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941"></span><span class="mo" id="MathJax-Span-942" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-943" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 7.761em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(2.589em, 1007.55em, 4.798em, -999.997em); top: -5.116em; left: 50%; margin-left: -3.823em;"><span class="mrow" id="MathJax-Span-944"><span class="munderover" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-946" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-947" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-948"><span class="mrow" id="MathJax-Span-949"><span class="mi" id="MathJax-Span-950" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-951" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-952" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-953" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1001.94em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-954"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-956" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-957"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-958" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.488em;"><span class="texatom" id="MathJax-Span-959"><span class="mrow" id="MathJax-Span-960"><span class="mo" id="MathJax-Span-961" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-962" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-963" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-964" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1001.89em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-965"><span class="mi" id="MathJax-Span-966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-968"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-969" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-970"><span class="mrow" id="MathJax-Span-971"><span class="mo" id="MathJax-Span-972" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-973" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-974" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-975" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.1em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.104em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-976" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-977" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-978"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-980"><span class="mrow" id="MathJax-Span-981"><span class="mo" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-984" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.643em, 1004.8em, 4.798em, -999.997em); top: -2.853em; left: 50%; margin-left: -2.368em;"><span class="mrow" id="MathJax-Span-986"><span class="munderover" id="MathJax-Span-987"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-990"><span class="mrow" id="MathJax-Span-991"><span class="mi" id="MathJax-Span-992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-995" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.235em, 1001.94em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-996"><span class="mi" id="MathJax-Span-997" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-999"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1001"><span class="mrow" id="MathJax-Span-1002"><span class="mo" id="MathJax-Span-1003" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1004" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1005" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1001.89em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-1007"><span class="mi" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1010"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1012"><span class="mrow" id="MathJax-Span-1013"><span class="mo" id="MathJax-Span-1014" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1015" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1016" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1017" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.1em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.104em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1007.76em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.761em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.175em;"></span></span><span style="position: absolute; clip: rect(2.643em, 1009.43em, 7.169em, -999.997em); top: -5.17em; left: 0em;"><span class="mtd" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"><span class="mi" id="MathJax-Span-1025"></span><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-1027" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(2.589em, 1007.65em, 4.798em, -999.997em); top: -5.116em; left: 50%; margin-left: -3.877em;"><span class="mrow" id="MathJax-Span-1028"><span class="munderover" id="MathJax-Span-1029"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1030" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1031" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1032"><span class="mrow" id="MathJax-Span-1033"><span class="mi" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1035" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1037" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1001.94em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-1038"><span class="mi" id="MathJax-Span-1039" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1041"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1043"><span class="mrow" id="MathJax-Span-1044"><span class="mo" id="MathJax-Span-1045" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1046" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1047" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1002.05em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1049"><span class="texatom" id="MathJax-Span-1050"><span class="mrow" id="MathJax-Span-1051"><span class="munderover" id="MathJax-Span-1052"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1058"><span class="mrow" id="MathJax-Span-1059"><span class="mo" id="MathJax-Span-1060" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1061" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1062" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1063" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.21em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.212em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1065" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1066"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1068"><span class="mrow" id="MathJax-Span-1069"><span class="mo" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1073" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.643em, 1004.91em, 4.798em, -999.997em); top: -2.853em; left: 50%; margin-left: -2.422em;"><span class="mrow" id="MathJax-Span-1074"><span class="munderover" id="MathJax-Span-1075"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1078"><span class="mrow" id="MathJax-Span-1079"><span class="mi" id="MathJax-Span-1080" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1081" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1083" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.235em, 1001.94em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -0.967em;"><span class="mrow" id="MathJax-Span-1084"><span class="mi" id="MathJax-Span-1085" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1086" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1087"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1089"><span class="mrow" id="MathJax-Span-1090"><span class="mo" id="MathJax-Span-1091" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1092" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1093" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1094" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1002.05em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1095"><span class="texatom" id="MathJax-Span-1096"><span class="mrow" id="MathJax-Span-1097"><span class="munderover" id="MathJax-Span-1098"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1099" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1102"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1104"><span class="mrow" id="MathJax-Span-1105"><span class="mo" id="MathJax-Span-1106" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1107" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1108" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.21em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.212em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1007.87em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.869em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.175em;"></span></span><span style="position: absolute; clip: rect(2.643em, 1009.65em, 7.169em, -999.997em); top: -0.698em; left: 0em;"><span class="mtd" id="MathJax-Span-1115"><span class="mrow" id="MathJax-Span-1116"><span class="mi" id="MathJax-Span-1117"></span><span class="mo" id="MathJax-Span-1118" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-1119" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 7.869em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(2.589em, 1007.65em, 4.798em, -999.997em); top: -5.116em; left: 50%; margin-left: -3.877em;"><span class="mrow" id="MathJax-Span-1120"><span class="munderover" id="MathJax-Span-1121"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1122" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1124"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1127" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1129" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1002em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1130"><span class="texatom" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="munderover" id="MathJax-Span-1133"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1137"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1139"><span class="mrow" id="MathJax-Span-1140"><span class="mo" id="MathJax-Span-1141" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1142" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1143" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1144" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1002.05em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1145"><span class="texatom" id="MathJax-Span-1146"><span class="mrow" id="MathJax-Span-1147"><span class="munderover" id="MathJax-Span-1148"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1152"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1154"><span class="mrow" id="MathJax-Span-1155"><span class="mo" id="MathJax-Span-1156" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1157" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1158" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1159" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.21em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.212em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1160" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1161" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1162"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1163" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1164"><span class="mrow" id="MathJax-Span-1165"><span class="mo" id="MathJax-Span-1166" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1168" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.643em, 1004.91em, 4.798em, -999.997em); top: -2.853em; left: 50%; margin-left: -2.422em;"><span class="mrow" id="MathJax-Span-1170"><span class="munderover" id="MathJax-Span-1171"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1172" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1174"><span class="mrow" id="MathJax-Span-1175"><span class="mi" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1177" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1178" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1179" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.235em, 1002em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1180"><span class="texatom" id="MathJax-Span-1181"><span class="mrow" id="MathJax-Span-1182"><span class="munderover" id="MathJax-Span-1183"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1185" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1186" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1187"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1188" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mo" id="MathJax-Span-1191" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1192" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1193" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1194" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1002.05em, 4.313em, -999.997em); top: -3.499em; left: 50%; margin-left: -1.021em;"><span class="mrow" id="MathJax-Span-1195"><span class="texatom" id="MathJax-Span-1196"><span class="mrow" id="MathJax-Span-1197"><span class="munderover" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.313em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.613em, 1000.27em, 3.99em, -999.997em); top: -4.254em; left: 0.11em;"><span class="mo" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1201" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1202"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.2em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="mo" id="MathJax-Span-1206" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1207" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1208" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1209" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.21em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.212em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1007.87em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.869em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1210" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 5.175em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.119em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-5.331em, 1002.97em, 4.906em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -8.402em; right: 0em;"><span class="mtd" id="mjx-eqn-17.14"><span class="mrow" id="MathJax-Span-924"><span class="mtext" id="MathJax-Span-925" style="font-family: MathJax_Main;">(17.14)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.15"><span class="mrow" id="MathJax-Span-1019"><span class="mtext" id="MathJax-Span-1020" style="font-family: MathJax_Main;">(17.15)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: 0.488em; right: 0em;"><span class="mtd" id="mjx-eqn-17.16"><span class="mrow" id="MathJax-Span-1111"><span class="mtext" id="MathJax-Span-1112" style="font-family: MathJax_Main;">(17.16)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 14.119em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -7.372em; border-left: 0px solid; width: 0px; height: 15.316em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-62">\begin{align*} \hat{s}_{BIS} 
 &=  \frac{\sum_{i=1}^n\frac{p(\boldsymbol x^{(i)})}{q(\boldsymbol x^{(i)})}f(\boldsymbol x^{(i)})}{\sum_{i=1}^n\frac{p(\boldsymbol x^{(i)})}{q(\boldsymbol x^{(i)})}}\tag{17.14}\\ 
 &= \frac{\sum_{i=1}^n\frac{p(\boldsymbol x^{(i)})}{\tilde{q}(\boldsymbol x^{(i)})}f(\boldsymbol x^{(i)})}{\sum_{i=1}^n\frac{p(\boldsymbol x^{(i)})}{\tilde{q}(\boldsymbol x^{(i)})}}\tag{17.15}\\
 &= \frac{\sum_{i=1}^n\frac{\tilde{p}(\boldsymbol x^{(i)})}{\tilde{q}(\boldsymbol x^{(i)})}f(\boldsymbol x^{(i)})}{\sum_{i=1}^n\frac{\tilde{p}(\boldsymbol x^{(i)})}{\tilde{q}(\boldsymbol x^{(i)})}},\tag{17.16}
\end{align*}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1211" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1212"><span class="texatom" id="MathJax-Span-1213"><span class="mrow" id="MathJax-Span-1214"><span class="munderover" id="MathJax-Span-1215"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1216" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.362em; left: 0.11em;"><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">\tilde{q}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1218" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1219"><span class="texatom" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="munderover" id="MathJax-Span-1222"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1223" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.362em; left: 0.11em;"><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">\tilde{p}</script></span> là các dạng không chuẩn hoá của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1225" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1226"><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">p</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1228" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1229"><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">q</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1231" style="width: 1.727em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1001.46em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1232"><span class="msubsup" id="MathJax-Span-1233"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mo" id="MathJax-Span-1237" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1239" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">x^{(i)}</script></span> là các mẫu được lấy từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1240" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">q</script></span>. Ước lượng này là ước lượng chệch vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1243" style="width: 5.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.013em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.673em, 1004.96em, 3.02em, -999.997em); top: -2.584em; left: 0em;"><span class="mrow" id="MathJax-Span-1244"><span class="texatom" id="MathJax-Span-1245"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-1248" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1249"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="munderover" id="MathJax-Span-1252"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.43em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-1254" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="mi" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mi" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-1259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1261" style="font-family: MathJax_Main; padding-left: 0.272em;">≠</span><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">s</span></span><span style="display: inline-block; width: 0px; height: 2.589em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">\mathbb{E}[\hat{s}_{BIS}]\neq s</script></span>, trừ khi tiệm cận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1263" style="width: 3.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.727em, 1003.07em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1264"><span class="mi" id="MathJax-Span-1265" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1266" style="font-family: MathJax_Main; padding-left: 0.272em;">→</span><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Main; padding-left: 0.272em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.753em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">n \to \infty</script></span> và mẫu số ở phương trình <strong>17.14</strong> hội tụ về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1268" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1269"><span class="mn" id="MathJax-Span-1270" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">1</script></span>. Do đó ước lượng này còn được gọi là tiệm cận không chệch.</p><p>Một lựa chọn tốt của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1271" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1272"><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">q</script></span> có thể cải thiện đáng kể hiệu suất của ước lượng Monte Carlo. Ngược lại, một lựa chọn tồi của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1274" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1275"><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">q</script></span> sẽ làm cho hiệu suất trở nên tệ hại hơn rất nhiều. Trở lại với phương trình <strong>17.12</strong>, chúng ta thấy nếu các mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1277" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1278"><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">q</script></span> mà tại đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1280" style="width: 4.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.08em, 1003.5em, 3.128em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1281"><span class="mfrac" id="MathJax-Span-1282"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.289em, 1003.07em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-1283"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1288"><span class="mrow" id="MathJax-Span-1289"><span class="mo" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1295"><span class="mrow" id="MathJax-Span-1296"><span class="mo" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1001.3em, 4.313em, -999.997em); top: -3.553em; left: 50%; margin-left: -0.644em;"><span class="mrow" id="MathJax-Span-1298"><span class="mi" id="MathJax-Span-1299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1301" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1003.29em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.289em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">\frac{p(\boldsymbol x)|f(\boldsymbol x)|}{q(\boldsymbol x)}</script></span> lớn, thì phương sai của ước lượng có thể nhận giá trị rất lớn. Điều này có thể xảy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1303" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1304"><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1308" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">q(\boldsymbol x)</script></span> nhỏ trong khi cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1309" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.84em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1310"><span class="mi" id="MathJax-Span-1311" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1314" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">p(\boldsymbol x)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1315" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.89em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1316"><span class="mi" id="MathJax-Span-1317" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1318" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1319" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">f(\boldsymbol x)</script></span> đều không đủ nhỏ để loại bỏ nó. Phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1321" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1322"><span class="mi" id="MathJax-Span-1323" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">q</script></span> thường được chọn là một phân phối đơn giản để thuận tiện cho quá trình lấy mẫu. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1324" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1325"><span class="mi" id="MathJax-Span-1326" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">x</script></span> có nhiều chiều, sự đơn giản này của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1327" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1328"><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">q</script></span> lại khiến nó khó khớp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1330" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1331"><span class="mi" id="MathJax-Span-1332" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">p</script></span> hay <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1333" style="width: 1.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.51em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1334"><span class="mi" id="MathJax-Span-1335" style="font-family: MathJax_Math-italic;">p</span><span class="texatom" id="MathJax-Span-1336"><span class="mrow" id="MathJax-Span-1337"><span class="mo" id="MathJax-Span-1338" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="texatom" id="MathJax-Span-1340"><span class="mrow" id="MathJax-Span-1341"><span class="mo" id="MathJax-Span-1342" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">p|f|</script></span>. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1343" style="width: 12.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.455em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1010.35em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1344"><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1347"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1348" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1349"><span class="mrow" id="MathJax-Span-1350"><span class="mo" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1353" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1354" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1355" style="font-family: MathJax_Main; padding-left: 0.272em;">≫</span><span class="mi" id="MathJax-Span-1356" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mo" id="MathJax-Span-1357" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1358"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1360"><span class="mrow" id="MathJax-Span-1361"><span class="mo" id="MathJax-Span-1362" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1363" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1364" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1365" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1366"><span class="mrow" id="MathJax-Span-1367"><span class="mo" id="MathJax-Span-1368" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1369" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1370" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1371"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1373"><span class="mrow" id="MathJax-Span-1374"><span class="mo" id="MathJax-Span-1375" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1378" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1379"><span class="mrow" id="MathJax-Span-1380"><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">q(\boldsymbol x^{(i)}) \gg p(\boldsymbol x^{(i)})|f(\boldsymbol x^{(i)})|</script></span>, lấy mẫu theo độ quan trọng chỉ thu được các mẫu vô ích (tổng của các số rất nhỏ hoặc bằng không). Mặt khác, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1382" style="width: 12.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.455em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1010.35em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1383"><span class="mi" id="MathJax-Span-1384" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1385" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1386"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1388"><span class="mrow" id="MathJax-Span-1389"><span class="mo" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1393" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1394" style="font-family: MathJax_Main; padding-left: 0.272em;">≪</span><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mo" id="MathJax-Span-1396" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1397"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1398" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1399"><span class="mrow" id="MathJax-Span-1400"><span class="mo" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1403" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1404" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1405"><span class="mrow" id="MathJax-Span-1406"><span class="mo" id="MathJax-Span-1407" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1408" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1409" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1410"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1412"><span class="mrow" id="MathJax-Span-1413"><span class="mo" id="MathJax-Span-1414" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1416" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1417" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="mo" id="MathJax-Span-1420" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">q(\boldsymbol x^{(i)}) \ll  p(\boldsymbol x^{(i)})|f(\boldsymbol x^{(i)})|</script></span>, trường hợp này hiếm khi xảy ra hơn, tỉ số (của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1421" style="width: 4.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.08em, 1003.5em, 3.128em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1422"><span class="mfrac" id="MathJax-Span-1423"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.289em, 1003.07em, 4.313em, -999.997em); top: -4.577em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-1424"><span class="mi" id="MathJax-Span-1425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1428" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1429"><span class="mrow" id="MathJax-Span-1430"><span class="mo" id="MathJax-Span-1431" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1436"><span class="mrow" id="MathJax-Span-1437"><span class="mo" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1001.3em, 4.313em, -999.997em); top: -3.553em; left: 50%; margin-left: -0.644em;"><span class="mrow" id="MathJax-Span-1439"><span class="mi" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1003.29em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.289em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.747em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">\frac{p(\boldsymbol x)|f(\boldsymbol x)|}{q(\boldsymbol x)}</script></span>) có thể trở nên rất lớn. Vì trường hợp sau hiếm khi xảy ra, chúng thường không xuất hiện trong một mẫu thử điển hình, dẫn đến các ước lượng thấp điển hình của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1444" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1445"><span class="mi" id="MathJax-Span-1446" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">s</script></span>, được bù đắp bởi các ước lượng cao bất thường nhưng hiếm gặp. Các giá trị rất lớn hoặc rất nhỏ là điển hình khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1447" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1448"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">\boldsymbol x</script></span> có nhiều chiều, vì trong không gian nhiều chiều, phạm vi động của các xác suất đồng thời có thể rất lớn.</p><p>Mặc cho những rủi ro trên, lấy mẫu theo độ quan trọng và các biến thể của nó vẫn rất hữu dụng trong nhiều thuật toán học máy, bao gồm cả các thuật toán học sâu. Ví dụ như việc sử dụng lấy mẫu theo độ quan trọng nhằm tăng tốc độ huấn luyện trong mô hình ngôn ngữ neuron với một lượng từ vựng lớn (phần <strong>12.4.3.3</strong>) hoặc các mạng neuron khác với số lượng các đầu ra lớn. Có thể tham khảo thêm cách mà lấy mẫu theo độ quan trọng được sử dụng để ước tính một hàm phân hoạch (hằng số chuẩn hoá của một phân phối xác suất) trong phần <strong>18.7</strong>, và để ước tính logarit hàm hợp lý trong mô hình học sâu có hướng, chẳng hạn như bộ tự mã hoá biến phân, được giới thiệu trong phần<strong>20.10.3</strong>. Lấy mẫu theo độ quan trọng còn được sử dụng để cải thiện ước lượng gradient của hàm chi phí để huấn luyện các tham số mô hình với trượt gradient ngẫu nhiên, đặc biệt với các mô hình như các bộ phân loại, ở đó phần lớn tổng giá trị của hàm chi phí đến từ số ít các mẫu bị phân lớp sai. Việc lấy mẫu các mẫu khó một cách thường xuyên hơn có thể làm giảm phương sai của gradient trong những trường hợp như vậy(Hinton, 2006).</p><p>-------- Nguyen Thanh Chinh kết thúc dịch ở đây ------------</p><p>--------------- Thuấn bắt đầu dịch ở đây --------------</p><h2 id="173-Phương-pháp-chuỗi-Markov-Monte-Carlo"><a class="anchor hidden-xs" href="#173-Phương-pháp-chuỗi-Markov-Monte-Carlo" title="173-Phương-pháp-chuỗi-Markov-Monte-Carlo"><span class="octicon octicon-link"></span></a>17.3 Phương pháp chuỗi Markov Monte Carlo</h2><p>Trong nhiều trường hợp, chúng ta muốn dùng kĩ thuật Monte Carlo nhưng không có một phương pháp đơn giản nào cho việc lấy chính xác các mẫu từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1450" style="width: 4.475em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.828em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.72em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1451"><span class="msubsup" id="MathJax-Span-1452"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1456"><span class="mrow" id="MathJax-Span-1457"><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1459" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">p_\text{model}(\mathbf{x})</script></span> hoặc từ một phân phối lấy mẫu theo độ quan trọng có chất lượng tốt (phương sai nhỏ) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1460" style="width: 2.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.73em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1461"><span class="mi" id="MathJax-Span-1462" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">q(\mathbf{x})</script></span>. Trong bối cảnh của học sâu, việc này thường xuyên xảy ra khi mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1468" style="width: 4.475em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.828em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.72em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1469"><span class="msubsup" id="MathJax-Span-1470"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1471" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1473" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1474"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1477" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">p_\text{model}(\mathbf{x})</script></span> được biểu diễn bởi một mô hình vô hướng. Trong những trường hợp đó, chúng ta đưa ra một công cụ toán học gọi là <strong>chuỗi Markov</strong> để xấp xỉ mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1478" style="width: 4.475em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.828em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.72em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1479"><span class="msubsup" id="MathJax-Span-1480"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1481" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-1482" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1483" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1484"><span class="mrow" id="MathJax-Span-1485"><span class="mi" id="MathJax-Span-1486" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-1487" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">p_\text{model}(\mathbf{x})</script></span>. Họ các thuật toán dùng chuỗi Markov để thực hiện các ước tính Monte Carlo được gọi là  <strong>phương pháp chuỗi Markov Monte Carlo</strong> (MCMC). Phương pháp chuỗi Markov Monte Carlo cho học máy  được miêu tả chi tiết trong <em>Koller và Friedman</em> (<em>2009</em>). Điều kiện cơ bản và chung nhất để kĩ thuật MCMC có thể áp dụng là chỉ khi mô hình không gán xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1488" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1489"><span class="mn" id="MathJax-Span-1490" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">0</script></span> cho bất kì trạng thái nào. Vì vậy, cách thuận tiện nhất để trình bày các kĩ thuật này là lấy mẫu từ một mô hình hướng năng lượng (EBM) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1491" style="width: 9.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.516em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1008.41em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1492"><span class="mi" id="MathJax-Span-1493" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1494" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1495" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1496" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1497" style="font-family: MathJax_Main; padding-left: 0.272em;">∝</span><span class="mi" id="MathJax-Span-1498" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">e</span><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1501" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1502" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1503" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1504" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1507" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">p(\boldsymbol{x}) \propto exp(-E(\boldsymbol x))</script></span> được miêu tả ở phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1508" style="width: 2.966em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.535em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.48em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1509"><span class="mstyle" id="MathJax-Span-1510" style="color: red;"><span class="mrow" id="MathJax-Span-1511" style="color: red;"><span class="mn" id="MathJax-Span-1512" style="font-family: MathJax_Main; color: red;">16.2.4</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">\color{red}{16.2.4}</script></span>. Trong công thức EBM, tất cả trạng thái được đảm bảo có xác suất khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1513" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1514"><span class="mn" id="MathJax-Span-1515" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">0</script></span>. Phương pháp MCMC được áp dụng rộng rãi trong thực tế và có thể được dùng với nhiều phân phối xác suất chứa trạng thái có xác suất bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1516" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1517"><span class="mn" id="MathJax-Span-1518" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">0</script></span>. Tuy nhiên, các đảm bảo về mặt lý thuyết liên quan đến việc thực thi của phương pháp MCMC phải được chứng minh trên cở sở của từng trường hợp cụ thể cho từng họ phân phối khác nhau. Trong bối cảnh của học sâu, phổ biến nhất là dựa vào sự đảm bảo của lý thuyết tổng quát mà ứng dụng một cách hiển nhiên cho tất cả các mô hình hướng năng lượng.</p><p>Để hiểu vì sao lấy mẫu từ một mô hình hướng năng lượng là một việc làm khó khăn, chúng ta xét một EBM với chỉ hai biến, định nghĩa một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1519" style="width: 3.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.804em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.7em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1520"><span class="mi" id="MathJax-Span-1521" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1522" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1523"><span class="mrow" id="MathJax-Span-1524"><span class="mi" id="MathJax-Span-1525" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-1526" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1527" style="font-family: MathJax_Main; padding-left: 0.164em;">b</span></span></span><span class="mo" id="MathJax-Span-1528" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">p(\mathrm{a,b})</script></span>. Để lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1529" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1530"><span class="texatom" id="MathJax-Span-1531"><span class="mrow" id="MathJax-Span-1532"><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Main;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">\mathrm{a}</script></span>, chúng ta phải thực hiện phép lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1534" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1535"><span class="texatom" id="MathJax-Span-1536"><span class="mrow" id="MathJax-Span-1537"><span class="mi" id="MathJax-Span-1538" style="font-family: MathJax_Main;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">\mathrm{a}</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1539" style="width: 3.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.07em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1540"><span class="mi" id="MathJax-Span-1541" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1542" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1543"><span class="mrow" id="MathJax-Span-1544"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-1546" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-1547" style="font-family: MathJax_Main; padding-left: 0.272em;">b</span></span></span><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">p(\mathrm{a \mid b})</script></span>, và tương tự để lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1549" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1550"><span class="texatom" id="MathJax-Span-1551"><span class="mrow" id="MathJax-Span-1552"><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">\mathrm{b}</script></span>, ta phải thực hiện phép lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1554" style="width: 3.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.07em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1555"><span class="mi" id="MathJax-Span-1556" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1557" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1558"><span class="mrow" id="MathJax-Span-1559"><span class="mi" id="MathJax-Span-1560" style="font-family: MathJax_Main;">b</span><span class="mo" id="MathJax-Span-1561" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-1562" style="font-family: MathJax_Main; padding-left: 0.272em;">a</span></span></span><span class="mo" id="MathJax-Span-1563" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">p(\mathrm{b \mid a})</script></span>. Nó dường như giống với bài toán con gà và quả trứng (con gà có trước hay quả trứng có trước). Các mô hình có hướng tránh được vấn đề này bởi vì đồ thị của nó có hướng và không có chu trình. Để thực hiện <strong>lấy mẫu di truyền</strong> (<em>ancestral sampling</em>), ta lấy mẫu cho từng biến theo thứ tự tôpô (<em>topological order</em>), dựa theo phân phối có điều kiện trên các biến cha của biến con được đảm bảo đã được lấy mẫu (phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1564" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1001.73em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1565"><span class="mstyle" id="MathJax-Span-1566" style="color: red;"><span class="mrow" id="MathJax-Span-1567" style="color: red;"><span class="mn" id="MathJax-Span-1568" style="font-family: MathJax_Main; color: red;">16.3</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">\color{red}{16.3}</script></span>). Lấy mẫu di truyền định nghĩa một phương pháp lấy mẫu hiệu quả và đơn giản.</p><p>Trong một EBM, chúng ta có thể tránh vấn đề con gà và quả trứng bằng cách dùng chuỗi Markov để lấy mẫu. Ý tưởng cốt lõi của chuỗi Markov là bắt đầu từ một trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1569" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1570"><span class="mi" id="MathJax-Span-1571" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\boldsymbol{x}</script></span> có giá trị tùy ý. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1572" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1573"><span class="mi" id="MathJax-Span-1574" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">\boldsymbol{x}</script></span> được cập nhật một cách ngẫu nhiên theo thời gian. Cuối cùng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1575" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1576"><span class="mi" id="MathJax-Span-1577" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">\boldsymbol{x}</script></span> trở thành (rất gần) một mẫu hợp lí từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1578" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.84em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1579"><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1581" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1582" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1583" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">p(\boldsymbol{x})</script></span>. Chính xác hơn, một chuỗi Markov được định nghĩa bởi một trạng thái ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1584" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1585"><span class="mi" id="MathJax-Span-1586" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">\boldsymbol{x}</script></span> và một phân phối chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1587" style="width: 4.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.882em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.77em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1588"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1590" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1591"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1592" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-1593" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1594" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-1595" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-1596" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">T(\boldsymbol{x'} \mid \boldsymbol{x})</script></span> xác định xác suất cập nhật ngẫu nhiên sẽ đi tới trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1597" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.92em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1598"><span class="msup" id="MathJax-Span-1599"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">\boldsymbol{x'}</script></span> nếu nó bắt đầu từ trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1602" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1603"><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">\boldsymbol{x}</script></span>. Vận hành một chuỗi Markov nghĩa là lặp đi lặp lại việc cập nhật trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1605" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1606"><span class="mi" id="MathJax-Span-1607" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\boldsymbol{x}</script></span> tới giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1608" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.92em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1609"><span class="msup" id="MathJax-Span-1610"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1611" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-1612" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">\boldsymbol{x'}</script></span> được lẫy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1613" style="width: 4.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.774em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.67em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1614"><span class="mi" id="MathJax-Span-1615" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1616" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1617"><span class="mrow" id="MathJax-Span-1618"><span class="msup" id="MathJax-Span-1619"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1620" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-1621" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1622" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-1623" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-1624" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">T(\mathrm{x'} \mid \boldsymbol{x})</script></span>.</p><p>Để có một số hiểu biết lí thuyết về cách thức hoạt động của MCMC, việc tái tham số hoá bài toán là rất hữu ích. Đầu tiên, chúng ta giới hạn sự chú ý của chúng ta vào trường hợp mà biến ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1625" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1626"><span class="texatom" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">\mathrm{x}</script></span> có số lượng trạng thái hữu hạn. Sau đó, chúng ta có thể biểu diễn trạng thái như là một số nguyên dương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1630" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1631"><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">x</script></span>. Các giá trị nguyên khác nhau của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1633" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1634"><span class="mi" id="MathJax-Span-1635" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">x</script></span> ánh xạ ngược về các trạng thái khác nhau của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1636" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1637"><span class="mi" id="MathJax-Span-1638" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">\boldsymbol{x}</script></span> trong bài toán ban đầu.</p><p>Xem xét điều gì xảy ra khi chúng ta chạy nhiều chuỗi Markov song song nhau mà không có sự kết thúc. Tất cả các trạng thái của các chuỗi Markow khác nhau được lấy mẫu từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1639" style="width: 3.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1002.64em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1640"><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1642" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1643"><span class="mrow" id="MathJax-Span-1644"><span class="mo" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1647" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1648" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1649" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1650" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">q^{(t)}(x)</script></span> nào đó, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1651" style="width: 0.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.38em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.33em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1652"><span class="mi" id="MathJax-Span-1653" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">t</script></span> là số bước đã duyệt qua. Ban đầu, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1654" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1001.51em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1655"><span class="msubsup" id="MathJax-Span-1656"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1657" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1658"><span class="mrow" id="MathJax-Span-1659"><span class="mo" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1661" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1662" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">q^{(0)}</script></span> là một phân phối nào đó mà chúng ta đã dùng để khởi tạo ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1663" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1664"><span class="mi" id="MathJax-Span-1665" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">x</script></span> cho mỗi một chuỗi Markov. Sau đó, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1666" style="width: 1.619em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1001.4em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1667"><span class="msubsup" id="MathJax-Span-1668"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1669" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1670"><span class="mrow" id="MathJax-Span-1671"><span class="mo" id="MathJax-Span-1672" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">q^{(t)}</script></span> bị ảnh hưởng bởi tất cả các bước trong chuỗi Markov đã chạy. Mục đích là để <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1675" style="width: 3.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1002.64em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1676"><span class="msubsup" id="MathJax-Span-1677"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1678" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1679"><span class="mrow" id="MathJax-Span-1680"><span class="mo" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1683" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1684" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1686" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">q^{(t)}(x)</script></span> hội tụ về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1687" style="width: 2.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.73em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1688"><span class="mi" id="MathJax-Span-1689" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1690" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1691" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1692" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">p(x)</script></span>.</p><p>Bởi vì chúng ta đã tái tham số hoá bài toán dưới dạng một số nguyên dương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1693" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1694"><span class="mi" id="MathJax-Span-1695" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">x</script></span>, chúng ta có thể mô tả phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1696" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1697"><span class="mi" id="MathJax-Span-1698" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">q</script></span> bằng cách sử dụng một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1699" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1700"><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math-bold-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol{v}</script></span> với</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax MathJax_FullWidth" id="MathJax-Element-130-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1702" style="width: 100%; display: inline-block; min-width: 13.526em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 13.526em;"><span style="position: absolute; clip: rect(3.074em, 1005.77em, 4.421em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1703"><span class="mtable" id="MathJax-Span-1704" style="min-width: 13.526em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.526em;"><span style="display: inline-block; position: absolute; width: 5.822em; height: 0px; clip: rect(-0.913em, 1005.77em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.907em;"><span style="position: absolute; clip: rect(3.128em, 1005.77em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.822em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1005.77em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.907em;"><span class="mtd" id="MathJax-Span-1708"><span class="mrow" id="MathJax-Span-1709"><span class="mi" id="MathJax-Span-1710" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1711" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1712"><span class="mrow" id="MathJax-Span-1713"><span class="mtext" id="MathJax-Span-1714" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-1715" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1716" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">i</span><span class="mo" id="MathJax-Span-1717" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1718" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-1719" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1720" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1721"><span class="mrow" id="MathJax-Span-1722"><span class="mi" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1724" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.17"><span class="mrow" id="MathJax-Span-1706"><span class="mtext" id="MathJax-Span-1707" style="font-family: MathJax_Main;">(17.17)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">q(\textrm{x}=i)=v_{i}. \tag{17.17}</script></span></p><p>Xem xét điều gì xảy ra khi chúng ta cập nhật một trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1725" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1726"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">x</script></span> của một chuỗi Markov thành một trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1728" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.87em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1729"><span class="msup" id="MathJax-Span-1730"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mo" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">x'</script></span> mới. Xác suất một trạng thái đơn lẻ rơi vào trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1733" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.87em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1734"><span class="msup" id="MathJax-Span-1735"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1736" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mo" id="MathJax-Span-1737" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">x'</script></span> được cho bởi</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-134-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1738" style="width: 100%; display: inline-block; min-width: 19.938em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 19.938em;"><span style="position: absolute; clip: rect(2.535em, 1012.18em, 4.96em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1739"><span class="mtable" id="MathJax-Span-1740" style="min-width: 19.938em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.938em;"><span style="display: inline-block; position: absolute; width: 12.233em; height: 0px; clip: rect(-1.452em, 1012.18em, 0.973em, -999.997em); top: 0em; left: 50%; margin-left: -6.14em;"><span style="position: absolute; clip: rect(2.535em, 1012.18em, 4.96em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.233em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1012.18em, 5.283em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="MathJax-Span-1744"><span class="mrow" id="MathJax-Span-1745"><span class="msubsup" id="MathJax-Span-1746"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1747" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1748"><span class="mrow" id="MathJax-Span-1749"><span class="mo" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1752" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1753" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1755" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1756"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1757" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mo" id="MathJax-Span-1758" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1759" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1761" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1762" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.259em, -999.997em); top: -2.961em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1763"><span class="mrow" id="MathJax-Span-1764"><span class="mi" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1766" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1767" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1768"><span class="mrow" id="MathJax-Span-1769"><span class="mo" id="MathJax-Span-1770" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1771" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1773" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1774" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1775"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1776" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mo" id="MathJax-Span-1777" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1778" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-1779" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-1780" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1781" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-1.237em, 1002.97em, 0.057em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -4.362em; right: 0em;"><span class="mtd" id="mjx-eqn-17.18"><span class="mrow" id="MathJax-Span-1742"><span class="mtext" id="MathJax-Span-1743" style="font-family: MathJax_Main;">(17.18)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-134">\begin{align}
q^{(t+1)}(x') = \sum_{x}q^{(t)}T(x'\mid x). \tag{17.18}
\end{align}</script></span></p><p>Sử dụng phép tham số hóa số nguyên, chúng ta có thể biểu diễn ảnh hưởng của toán tử chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1782" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1783"><span class="mi" id="MathJax-Span-1784" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-135">T</script></span> bằng một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1785" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1786"><span class="mi" id="MathJax-Span-1787" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">\boldsymbol{A}</script></span>. Chúng ta định nghĩa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1788" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1789"><span class="mi" id="MathJax-Span-1790" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol{A}</script></span> sao cho</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-138-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1791" style="width: 100%; display: inline-block; min-width: 17.891em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 17.891em;"><span style="position: absolute; clip: rect(3.02em, 1010.13em, 4.475em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1792"><span class="mtable" id="MathJax-Span-1793" style="min-width: 17.891em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.891em;"><span style="display: inline-block; position: absolute; width: 10.186em; height: 0px; clip: rect(-0.967em, 1010.13em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -5.116em;"><span style="position: absolute; clip: rect(3.02em, 1010.13em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.186em; height: 0px;"><span style="position: absolute; clip: rect(3.02em, 1010.13em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-1797"><span class="mrow" id="MathJax-Span-1798"><span class="msubsup" id="MathJax-Span-1799"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1800" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="texatom" id="MathJax-Span-1801"><span class="mrow" id="MathJax-Span-1802"><span class="mi" id="MathJax-Span-1803" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1805" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1806" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1807" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1808" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1809"><span class="mrow" id="MathJax-Span-1810"><span class="msup" id="MathJax-Span-1811"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mo" id="MathJax-Span-1813" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1814" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1815" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">i</span><span class="mo" id="MathJax-Span-1816" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="texatom" id="MathJax-Span-1817" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-1818"><span class="mi" id="MathJax-Span-1819" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-1820" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">j</span><span class="mo" id="MathJax-Span-1822" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1823" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.913em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.19"><span class="mrow" id="MathJax-Span-1795"><span class="mtext" id="MathJax-Span-1796" style="font-family: MathJax_Main;">(17.19)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-138">\begin{align}
A_{i,j} = T(\mathrm{x'}=i \mid \mathrm{x}=j).
\tag{17.19}
\end{align}</script></span></p><p>Bây giờ chúng ta có thể viết lại phương trình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1824" style="width: 2.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.21em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1825"><span class="mstyle" id="MathJax-Span-1826" style="color: red;"><span class="mrow" id="MathJax-Span-1827" style="color: red;"><span class="mn" id="MathJax-Span-1828" style="font-family: MathJax_Main; color: red;">17.18</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">\color{red}{17.18}</script></span> bằng cách sử dụng định nghĩa này. Thay vì viết phương trình này theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1829" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1830"><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-140">q</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1832" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1833"><span class="mi" id="MathJax-Span-1834" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-141">T</script></span> để hiểu cách thức một trạng thái đơn lẻ được cập nhật, chúng ta có thể dùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1835" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1836"><span class="mi" id="MathJax-Span-1837" style="font-family: MathJax_Math-bold-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-142">\boldsymbol{v}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1838" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1839"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-143">\boldsymbol{A}</script></span> để mô tả cách toàn bộ phân phối trên tất cả các chuỗi Markov (chạy song song) dịch chuyển như thế nào khi chúng ta cập nhật:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-144-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1841" style="width: 100%; display: inline-block; min-width: 13.957em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 13.957em;"><span style="position: absolute; clip: rect(2.966em, 1006.2em, 4.475em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1842"><span class="mtable" id="MathJax-Span-1843" style="min-width: 13.957em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.957em;"><span style="display: inline-block; position: absolute; width: 6.253em; height: 0px; clip: rect(-1.021em, 1006.2em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -3.122em;"><span style="position: absolute; clip: rect(2.966em, 1006.2em, 4.259em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1006.2em, 4.151em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="MathJax-Span-1847"><span class="mrow" id="MathJax-Span-1848"><span class="msubsup" id="MathJax-Span-1849"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1850" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1851"><span class="mrow" id="MathJax-Span-1852"><span class="mo" id="MathJax-Span-1853" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1855" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1856" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1857" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">A</span><span class="msubsup" id="MathJax-Span-1858"><span style="display: inline-block; position: relative; width: 2.373em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1859" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1860"><span class="mrow" id="MathJax-Span-1861"><span class="mo" id="MathJax-Span-1862" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1864" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1865" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.805em, 1002.97em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-17.20"><span class="mrow" id="MathJax-Span-1845"><span class="mtext" id="MathJax-Span-1846" style="font-family: MathJax_Main;">(17.20)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-144">\begin{align}
\boldsymbol{v}^{(t)} = \boldsymbol{A}\boldsymbol{v}^{(t-1)}. \tag{17.20}
\end{align}</script></span></p><p>Áp dụng cập nhật chuỗi Markov liên tục tương ứng với phép nhân ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1868" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1869"><span class="mi" id="MathJax-Span-1870" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">\boldsymbol{A}</script></span> nhiều lần. Nói cách khác, chúng ta có thể xem quá trình này như phép nhân lũy thừa ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1871" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.76em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1872"><span class="mi" id="MathJax-Span-1873" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">A</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-147-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1874" style="width: 100%; display: inline-block; min-width: 12.934em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 12.934em;"><span style="position: absolute; clip: rect(2.966em, 1005.17em, 4.475em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1875"><span class="mtable" id="MathJax-Span-1876" style="min-width: 12.934em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.934em;"><span style="display: inline-block; position: absolute; width: 5.229em; height: 0px; clip: rect(-1.021em, 1005.17em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -2.637em;"><span style="position: absolute; clip: rect(2.966em, 1005.17em, 4.259em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.229em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1005.17em, 4.151em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="MathJax-Span-1880"><span class="mrow" id="MathJax-Span-1881"><span class="msubsup" id="MathJax-Span-1882"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1883" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1884"><span class="mrow" id="MathJax-Span-1885"><span class="mi" id="MathJax-Span-1886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1887" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-1888" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1889" style="font-family: MathJax_Math-bold-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.865em;"><span class="texatom" id="MathJax-Span-1890"><span class="mrow" id="MathJax-Span-1891"><span class="mi" id="MathJax-Span-1892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1893"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1894" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="mo" id="MathJax-Span-1897" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1898" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1899" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1900" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.805em, 1002.97em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-17.21"><span class="mrow" id="MathJax-Span-1878"><span class="mtext" id="MathJax-Span-1879" style="font-family: MathJax_Main;">(17.21)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-147">\begin{align}
\boldsymbol{v}^{t}=\boldsymbol{A}^{t}\boldsymbol{v}^{(0)}. \tag{17.21}
\end{align}</script></span></p><p>Ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1901" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1902"><span class="mi" id="MathJax-Span-1903" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">\boldsymbol{A}</script></span> có cấu trúc đặc biệt vì mỗi cột của nó biểu diễn một phân phối xác suất. Những ma trận như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1904" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.76em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1905"><span class="mi" id="MathJax-Span-1906" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-149">A</script></span> được gọi là <strong>ma trận ngẫu nhiên</strong> (<em>stochastic matrices</em>). Nếu có một xác suất khác không chuyển từ bất kỳ trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1907" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1908"><span class="mi" id="MathJax-Span-1909" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">x</script></span> nào sang bất kỳ trạng thái <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1910" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1000.87em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1911"><span class="msup" id="MathJax-Span-1912"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1913" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mo" id="MathJax-Span-1914" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-151">x'</script></span> khác với một số mũ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1915" style="width: 0.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.38em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.33em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1916"><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-152">t</script></span> nào đó, thì định lí Perron-Frobenius (<em>Perron, 1907: Frobenius, 1908</em>) đảm bảo rằng giá trị riêng lớn nhất là số thực và bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1918" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1919"><span class="mn" id="MathJax-Span-1920" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">1</script></span>. Theo thời gian, chúng ta có thể thấy rằng tất cả các giá trị riêng được lũy thừa:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-154-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1921" style="width: 100%; display: inline-block; min-width: 29.044em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 29.044em;"><span style="position: absolute; clip: rect(2.966em, 1021.23em, 4.475em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1922"><span class="mtable" id="MathJax-Span-1923" style="min-width: 29.044em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 29.044em;"><span style="display: inline-block; position: absolute; width: 21.339em; height: 0px; clip: rect(-1.021em, 1021.23em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -10.665em;"><span style="position: absolute; clip: rect(2.966em, 1021.23em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 21.339em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1021.23em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="MathJax-Span-1927"><span class="mrow" id="MathJax-Span-1928"><span class="msubsup" id="MathJax-Span-1929"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1930" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1931"><span class="mrow" id="MathJax-Span-1932"><span class="mo" id="MathJax-Span-1933" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1934" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1935" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-1937" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-1938" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1939" style="font-family: MathJax_Main;">diag</span><span class="mo" id="MathJax-Span-1940" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1941" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-1942" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1943"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1944" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.026em;"><span class="texatom" id="MathJax-Span-1945"><span class="mrow" id="MathJax-Span-1946"><span class="mo" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1948" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1949"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1950" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="mi" id="MathJax-Span-1953" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1954"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1955" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1956"><span class="mrow" id="MathJax-Span-1957"><span class="mo" id="MathJax-Span-1958" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1959" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1960" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1961" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1962" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1963" style="font-family: MathJax_Main;">diag</span><span class="mo" id="MathJax-Span-1964" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1965" style="font-family: MathJax_Math-italic;">λ</span><span class="msubsup" id="MathJax-Span-1966"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1967" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-1968"><span class="mrow" id="MathJax-Span-1969"><span class="mi" id="MathJax-Span-1970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1971"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1972" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.026em;"><span class="texatom" id="MathJax-Span-1973"><span class="mrow" id="MathJax-Span-1974"><span class="mo" id="MathJax-Span-1975" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1976" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1977" style="font-family: MathJax_Math-bold-italic;">v</span><span class="texatom" id="MathJax-Span-1978"><span class="mrow" id="MathJax-Span-1979"><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1981" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1982" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-1983" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.805em, 1002.97em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-17.22"><span class="mrow" id="MathJax-Span-1925"><span class="mtext" id="MathJax-Span-1926" style="font-family: MathJax_Main;">(17.22)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-154">\begin{align}
\boldsymbol{v}^{(t)}= (\boldsymbol{V}\text{diag}(\lambda)\boldsymbol{V}^{-1})^{t}\boldsymbol{v}^{(0)} = \boldsymbol{V} \text{diag}(\lambda)^{t}\boldsymbol{V}^{-1}\boldsymbol{v}{(0)}. 
\tag{17.22}
\end{align}</script></span></p><p>Quá trình này khiến cho tất cả các giá trị riêng khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1984" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1985"><span class="mn" id="MathJax-Span-1986" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-155">1</script></span> đều giảm dần về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1987" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1988"><span class="mn" id="MathJax-Span-1989" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-156">0</script></span>. Dưới một số điều kiện bổ sung khác, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1990" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1991"><span class="mi" id="MathJax-Span-1992" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-157">\boldsymbol{A}</script></span> được đảm bảo chỉ có duy nhất một vector riêng với giá trị riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1993" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-1994"><span class="mn" id="MathJax-Span-1995" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-158">1</script></span>. Do đó, quá trình hội tụ về <strong>phân phối dừng</strong>, đôi khi còn được gọi là <strong>phân phối cân bằng</strong>. Tại điểm hội tụ</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-159-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1996" style="width: 100%; display: inline-block; min-width: 13.473em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 13.473em;"><span style="position: absolute; clip: rect(3.074em, 1005.71em, 4.421em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1997"><span class="mtable" id="MathJax-Span-1998" style="min-width: 13.473em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.473em;"><span style="display: inline-block; position: absolute; width: 5.768em; height: 0px; clip: rect(-0.913em, 1005.71em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.853em;"><span style="position: absolute; clip: rect(3.074em, 1005.71em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.768em; height: 0px;"><span style="position: absolute; clip: rect(3.02em, 1005.71em, 4.367em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="MathJax-Span-2002"><span class="mrow" id="MathJax-Span-2003"><span class="msup" id="MathJax-Span-2004"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2005" style="font-family: MathJax_Math-bold-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mo" id="MathJax-Span-2006" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2007" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mrow" id="MathJax-Span-2008" style="padding-left: 0.272em;"><span class="mi" id="MathJax-Span-2009" style="font-family: MathJax_Math-bold-italic;">A</span><span class="mi" id="MathJax-Span-2010" style="font-family: MathJax_Math-bold-italic;">v</span></span><span class="mo" id="MathJax-Span-2011" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-2012" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">v</span><span class="mo" id="MathJax-Span-2013" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-17.23"><span class="mrow" id="MathJax-Span-2000"><span class="mtext" id="MathJax-Span-2001" style="font-family: MathJax_Main;">(17.23)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-159">\begin{align}
\boldsymbol{v'} = \boldsymbol{Av} = \boldsymbol{v}, 
\tag{17.23}
\end{align}</script></span></p><p>và điều kiện này tương tự với tất cả các bước tiếp theo. Đây là một phương trình vetor riêng. Để trở thành điểm dừng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2014" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2015"><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math-bold-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">\boldsymbol{v}</script></span> phải là vector riêng với giá trị riêng tương ứng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2017" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2018"><span class="mn" id="MathJax-Span-2019" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">1</script></span>. Điều kiện này đảm bảo rằng một khi chúng ta đạt đến phân phối dừng, việc áp dụng các biện pháp lấy mẫu nhiều lần không thay đổi <em>phân phối</em> trên các trạng thái của tất cả chuỗi Markov khác nhau (mặc dù, tất nhiên là toán tử chuyển tiếp thay đổi mỗi trạng thái riêng lẻ).</p><p>Nếu chúng ta chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2020" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2021"><span class="mi" id="MathJax-Span-2022" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">T</script></span> chính xác, phân phối dừng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2023" style="width: 0.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2024"><span class="mi" id="MathJax-Span-2025" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">q</script></span> sẽ bằng phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2026" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2027"><span class="mi" id="MathJax-Span-2028" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">p</script></span> mà chúng ta muốn lấy mẫu. Chúng tôi mô tả cách chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2029" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2030"><span class="mi" id="MathJax-Span-2031" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">T</script></span> trong phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2032" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.73em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2033"><span class="mstyle" id="MathJax-Span-2034" style="color: red;"><span class="mrow" id="MathJax-Span-2035" style="color: red;"><span class="mn" id="MathJax-Span-2036" style="font-family: MathJax_Main; color: red;">17.4</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">\color{red}{17.4}</script></span>.</p><p>Hầu hết các tính chất của chuỗi Markov với những trạng thái hữu hạn có thể được tổng quát hóa thành các biến liên tục. Trong tình huống này, một số tác giả gọi chuỗi Markov là <strong>chuỗi Harris</strong>, nhưng chúng tôi dùng khái niệm chuỗi Markov cho cả hai trường hợp. Nhìn chung, một chuỗi Markov với toán tử chuyển tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2037" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2038"><span class="mi" id="MathJax-Span-2039" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-167">T</script></span> sẽ hội tụ, dưới các điều kiện mềm, về một điểm cố định được biểu diễn bằng phương trình</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-168-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2040" style="width: 100%; display: inline-block; min-width: 17.567em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 17.567em;"><span style="position: absolute; clip: rect(3.02em, 1009.81em, 4.475em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2041"><span class="mtable" id="MathJax-Span-2042" style="min-width: 17.567em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.567em;"><span style="display: inline-block; position: absolute; width: 9.863em; height: 0px; clip: rect(-0.967em, 1009.81em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -4.954em;"><span style="position: absolute; clip: rect(3.02em, 1009.81em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.863em; height: 0px;"><span style="position: absolute; clip: rect(3.02em, 1009.81em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-2046"><span class="mrow" id="MathJax-Span-2047"><span class="msup" id="MathJax-Span-2048"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2049" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mo" id="MathJax-Span-2050" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2051" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2052"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-2053"><span class="mrow" id="MathJax-Span-2054"><span class="mi" id="MathJax-Span-2055" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mo" id="MathJax-Span-2056" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2057" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2058" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-2059" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-2060"><span class="mrow" id="MathJax-Span-2061"><span class="mi" id="MathJax-Span-2062" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-2063"><span class="mrow" id="MathJax-Span-2064"><span class="texatom" id="MathJax-Span-2065"><span class="mrow" id="MathJax-Span-2066"><span class="mi" id="MathJax-Span-2067" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-2068" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-2069" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2070" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2071" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2072"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-2073"><span class="mrow" id="MathJax-Span-2074"><span class="mi" id="MathJax-Span-2075" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mo" id="MathJax-Span-2076" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2077" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="texatom" id="MathJax-Span-2078" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-2079"><span class="mi" id="MathJax-Span-2080" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-2081" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2082" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.913em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.24"><span class="mrow" id="MathJax-Span-2044"><span class="mtext" id="MathJax-Span-2045" style="font-family: MathJax_Main;">(17.24)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-168">\begin{align}
q'(\mathbf{x}') = \mathbb{E}_{\mathbf{x} \sim q}T(\mathbf{x}'\mid \mathbf{x}),
\tag{17.24}
\end{align}</script></span></p><p>trong trường hợp biến rời rạc được viết lại từ phương trình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2083" style="width: 2.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.21em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2084"><span class="mstyle" id="MathJax-Span-2085" style="color: red;"><span class="mrow" id="MathJax-Span-2086" style="color: red;"><span class="mn" id="MathJax-Span-2087" style="font-family: MathJax_Main; color: red;">17.23</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-169">\color{red}{17.23}</script></span>. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2088" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2089"><span class="texatom" id="MathJax-Span-2090"><span class="mrow" id="MathJax-Span-2091"><span class="mi" id="MathJax-Span-2092" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-170">\mathrm{x}</script></span> rời rạc, kì vọng tương ứng với một tổng, và khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2093" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2094"><span class="texatom" id="MathJax-Span-2095"><span class="mrow" id="MathJax-Span-2096"><span class="mi" id="MathJax-Span-2097" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-171">\mathrm{x}</script></span> liên tục, kì vọng tương ứng với một tích phân.</p><p>Bất kể trạng thái là liên tục hay rời rạc, tất cả các phương pháp chuỗi Markov đều lặp lại nhiều lần các cập nhật ngẫu nhiên cho đến khi trạng thái bắt đầu thu mẫu từ phân phối cân bằng. Quá trình vận hành chuỗi Markov đến khi đạt được phân phối cân bằng được gọi là <strong>loại bỏ</strong> trong chuỗi Markov. Sau khi chuỗi đã cân bằng, ta có thể thu được một chuỗi vô hạn các mẫu được lấy mẫu từ phân phối cân bằng. Chúng có cùng phân phối đồng nhất, nhưng bất kì 2 mẫu liên tiếp nào cũng có tương quan cao với nhau. Do đó, một chuỗi hữu hạn các mẫu có thể không đại diện cho phân phối cân bằng. Một cách để giảm nhẹ vấn đề này là ta chỉ trả về mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2098" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2099"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-172">n</script></span> mẫu liên tiếp, để các ước lượng thống kê của phân phối cân bằng không bị chệch bởi sự tương quan giữa một mẫu MCMC và các mẫu kế tiếp. Do vậy, dùng các chuỗi Markov khá tốn kém bởi vì cần có thời gian loại bỏ mẫu để đạt phân phối cân bằng và thời gian chuyển tiếp từ mẫu này sang mẫu đã được giảm độ tương quan đáng kể khác sau khi đạt trạng thái cân bằng. Nếu một người momg muốn các mẫu hoàn toàn độc lập, họ có thể chạy nhiều chuỗi Markov song song. Phương pháp này dùng tính toán song song để loại trừ độ trễ. Chiến lược chỉ sử dụng một chuỗi Markov duy nhất để tạo ra tất cả các mẫu và chiến lược sử dụng một chuỗi Markov cho mỗi mẫu mong muốn là hai thái cực trong phương pháp chuỗi Monte Carlo; các chuyên gia về học sâu thường dùng số chuỗi tương đương với số lượng các ví dụ trong một lô nhỏ và sau đó lấy mẫu với số lượng cần thiết từ tập cố định các chuỗi Markov. Số lượng chuỗi Markov thường dùng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2101" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1001.46em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2102"><span class="mn" id="MathJax-Span-2103" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-173">100</script></span>.</p><p>Một vấn đề khác là chúng ta không biết trước bao nhiêu bước mà chuỗi Markov phải thực hiện cho đến khi đạt đến phân phối cân bằng của nó. Quãng thời gian này được gọi là <strong>thời gian trộn</strong> (<em>mixing time</em>). Việc kiểm tra liệu rằng chuỗi Markov đã đạt đến trạng thái cân bằng hay chưa là một công việc khó khăn. Không có một lý thuyết đủ chính xác để giúp chúng ta trả lời câu hỏi này. Lý thuyết chỉ ra rằng chuỗi sẽ hội tụ, mà không giải thích gì thêm. Nếu chúng ta phân tích  chuỗi Markov từ góc nhìn của một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2104" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2105"><span class="mi" id="MathJax-Span-2106" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-174">\boldsymbol{A}</script></span> hoạt động trên một vector xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2107" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2108"><span class="mi" id="MathJax-Span-2109" style="font-family: MathJax_Math-bold-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">\boldsymbol v</script></span>, chúng ta biết được chuỗi sẽ trộn lẫn khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2110" style="width: 1.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1001.19em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2111"><span class="msubsup" id="MathJax-Span-2112"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2113" style="font-family: MathJax_Math-bold-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.865em;"><span class="texatom" id="MathJax-Span-2114"><span class="mrow" id="MathJax-Span-2115"><span class="mi" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-176">\boldsymbol{A}^{t}</script></span> mất đi tất cả giá trị riêng nhận được từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2117" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2118"><span class="mi" id="MathJax-Span-2119" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-177">\boldsymbol{A}</script></span> ngoại trừ giá trị riêng duy nhất là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2120" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2121"><span class="mn" id="MathJax-Span-2122" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-178">1</script></span>. Điều đó có nghĩa là độ lớn của giá trị riêng lớn thứ hai sẽ xác định thời gian trộn. Mặc dù trong thực tế, chúng ta không thể biểu diễn chuỗi Markov bằng ma trận. Số trạng thái mà mô hình xác suất có thể duyệt qua rất lớn so với số lượng biến, nên việc biểu diễn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2123" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2124"><span class="mi" id="MathJax-Span-2125" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-179">v</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2126" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2127"><span class="mi" id="MathJax-Span-2128" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-180">\boldsymbol{A}</script></span> hay giá trị riêng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2129" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2130"><span class="mi" id="MathJax-Span-2131" style="font-family: MathJax_Math-bold-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-181">\boldsymbol{A}</script></span> là không khả thi. Do những trở ngại trên mà chúng ta thường không biết một chuỗi Markov đã trộn hay chưa. Thay vào đó, chúng ta chạy chuỗi Markov trong một khoảng thời gian mà chúng ta tự ước tính là vừa đủ, và dùng phương pháp heuristic để xác định chuỗi đã được trộn chưa. Những phương pháp này bao gồm kiểm tra mẫu một cách thủ công hay đo lường mức độ tương quan giữa các mẫu liên tiếp.</p><h2 id="174-Lấy-mẫu-Gibbs"><a class="anchor hidden-xs" href="#174-Lấy-mẫu-Gibbs" title="174-Lấy-mẫu-Gibbs"><span class="octicon octicon-link"></span></a>17.4 Lấy mẫu Gibbs</h2><p>Đến đây, chúng tôi đã nói về cách lấy mẫu từ một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2132" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2133"><span class="mi" id="MathJax-Span-2134" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2135" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2136" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2137" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-182">q(\boldsymbol x)</script></span> bằng cách lặp đi lặp lại cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2138" style="width: 9.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.3em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1008.19em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2139"><span class="mi" id="MathJax-Span-2140" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2141" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="msup" id="MathJax-Span-2142" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2143" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-2144" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2145" style="font-family: MathJax_Main; padding-left: 0.272em;">∼</span><span class="mi" id="MathJax-Span-2146" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2147" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2148"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-2150" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2151" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2152" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-183">\boldsymbol{x} \leftarrow \boldsymbol{x'}\sim T(\boldsymbol{x'} \mid \boldsymbol{x})</script></span>. Chúng tôi chưa mô tả làm thế nào để đảm bảo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2154" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2155"><span class="mi" id="MathJax-Span-2156" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2157" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2159" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-184">q(\boldsymbol{x})</script></span> là một phân phối hữu dụng. Có hai cách tiếp cận cơ bản được xem xét trong cuốn sách này. Cách thứ nhất là lấy đạo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2160" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2161"><span class="mi" id="MathJax-Span-2162" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-185">T</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2163" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1002.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2164"><span class="msubsup" id="MathJax-Span-2165"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2166" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2167" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-186">p_\text{model}</script></span> cho trước, được mô tả bên dưới trong trường hợp lấy mẫu từ EBMs. Cách thứ hai là tham số hóa trực tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2168" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2169"><span class="mi" id="MathJax-Span-2170" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-187">T</script></span> và học nó, khi đó phân phối dừng của nó ngầm định nghĩa mô hình mong muốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2171" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1002.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2172"><span class="msubsup" id="MathJax-Span-2173"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2174" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2175" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-188">p_\text{model}</script></span>. Các ví dụ của cách thứ hai được mô tả trong phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2176" style="width: 2.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1002.21em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2177"><span class="mstyle" id="MathJax-Span-2178" style="color: red;"><span class="mrow" id="MathJax-Span-2179" style="color: red;"><span class="mn" id="MathJax-Span-2180" style="font-family: MathJax_Main; color: red;">20.12</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-189">\color{red}{20.12}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2181" style="width: 2.643em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1002.21em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2182"><span class="mstyle" id="MathJax-Span-2183" style="color: red;"><span class="mrow" id="MathJax-Span-2184" style="color: red;"><span class="mn" id="MathJax-Span-2185" style="font-family: MathJax_Main; color: red;">20.13</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-190">\color{red}{20.13}</script></span>.</p><p>Trong ngữ cảnh của học sâu, chúng ta thường dùng chuỗi Markov để lấy mẫu từ một mô hình hướng năng lượng định nghĩa một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2186" style="width: 4.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.882em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.77em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2187"><span class="msubsup" id="MathJax-Span-2188"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2189" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2190" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2191" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2192" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2193" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-191">p_\text{model}(\boldsymbol{x})</script></span>. Trong trường hợp này, chúng ta muốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2194" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2195"><span class="mi" id="MathJax-Span-2196" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2197" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2198" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2199" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-192">q(\boldsymbol{x})</script></span> trong chuỗi Markov trùng khớp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2200" style="width: 4.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.882em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.77em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2201"><span class="msubsup" id="MathJax-Span-2202"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2203" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2204" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2205" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2206" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2207" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-193">p_\text{model}(\boldsymbol{x})</script></span>. Để thu được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2208" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2209"><span class="mi" id="MathJax-Span-2210" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2211" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2212" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2213" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-194">q(\boldsymbol x)</script></span> như mong muốn, chúng ta phải chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2214" style="width: 4.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.882em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.77em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2215"><span class="mi" id="MathJax-Span-2216" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2217" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2218"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2219" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2221" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2222" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-2223" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">T(\boldsymbol{x'} \mid \boldsymbol{x})</script></span> phù hợp.</p><p>Một cách đơn giản và hiệu quả để xây dựng một chuỗi Markov lấy mẫu từ mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2224" style="width: 9.97em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.57em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1008.46em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2225"><span class="msubsup" id="MathJax-Span-2226"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2227" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2228" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2229" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2230" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-2231" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-2232" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-2233" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2234" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-2235" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2236" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-2237" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-2238" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-2239" style="font-family: MathJax_Math-italic;">l</span><span class="texatom" id="MathJax-Span-2240"><span class="mrow" id="MathJax-Span-2241"><span class="mi" id="MathJax-Span-2242" style="font-family: MathJax_Math-italic;">x</span></span></span><span class="mo" id="MathJax-Span-2243" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-196">p_\text{model}(boldsymbol{x})</script></span> là dùng <strong>lấy mẫu Gibbs</strong>, trong đó việc lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2244" style="width: 4.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.882em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.77em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2245"><span class="mi" id="MathJax-Span-2246" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2247" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2248"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2249" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2251" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2252" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-2253" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-197">T(\boldsymbol{x'} \mid \boldsymbol{x})</script></span> được thực hiện bằng cách chọn một biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2254" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.87em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2255"><span class="msubsup" id="MathJax-Span-2256"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-2257"><span class="mrow" id="MathJax-Span-2258"><span class="mi" id="MathJax-Span-2259" style="font-family: MathJax_Main;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-198">\mathrm{x}_i</script></span> và áp dụng phép lấy mẫu từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2261" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1002.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2262"><span class="msubsup" id="MathJax-Span-2263"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2264" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2265" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-199">p_\text{model}</script></span> có điều kiện trên những biến lân cận của biến được chọn trong đồ thị vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2266" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.643em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2267"><span class="texatom" id="MathJax-Span-2268"><span class="mrow" id="MathJax-Span-2269"><span class="mi" id="MathJax-Span-2270" style="font-family: MathJax_Caligraphic;">G<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">\mathcal{G}</script></span> định nghĩa cấu trúc của mô hình hướng năng lượng. Chúng ta cũng có thể lấy mẫu nhiều biến một cách đồng thời miễn là chúng độc lập có điều kiện với tất cả các biến lân cận của chúng. Như đã nói trong ví dụ về RBM trong phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2271" style="width: 2.966em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.535em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.48em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2272"><span class="mstyle" id="MathJax-Span-2273" style="color: red;"><span class="mrow" id="MathJax-Span-2274" style="color: red;"><span class="mn" id="MathJax-Span-2275" style="font-family: MathJax_Main; color: red;">16.7.1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-201">\color{red}{16.7.1}</script></span>, tất cả các đơn vị ẩn của một RBM có thể được lấy mẫu đồng thời vì chúng độc lập có điều kiện với tất cả các đơn vị khả kiến được cho trước. Tương tự, tất cả các đơn vị khả kiến có thể được lấy mẫu đồng thời bởi vì chúng độc lập có điều kiện với tất cả các đơn vị ẩn được cho trước. Phương pháp lấy mẫu Gibbs cập nhật nhiều biến đồng thời theo cách này được gọi là <strong>lấy mẫu Gibbs theo khối</strong>.</p><p>Còn có những cách khác để thiết kế chuỗi Markov nhằm lấy mẫu từ mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2276" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1002.43em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2277"><span class="msubsup" id="MathJax-Span-2278"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2279" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2280" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-202">p_\text{model}</script></span>. Ví dụ, thuật toán Metropolis-Hastings được dùng rộng rãi trong những lĩnh vực khác. Trong bối cảnh của phương pháp học sâu với mô hình vô hướng, lấy mẫu Gibbs thường được sử dụng hơn các phương pháp khác. Việc cải tiến các kĩ thuật lấy mẫu là một biên giới khả thi cho nghiên cứu.<br>
---------------- Thuấn kết thúc dịch ở đây -------------</p><p>// ------ Sơn Lâm bắt đầu dịch ở đây p597 - p602</p><h2 id="175-Thách-thức-về-sự-pha-trộn-giữa-các-chế-độ-riêng-biệt"><a class="anchor hidden-xs" href="#175-Thách-thức-về-sự-pha-trộn-giữa-các-chế-độ-riêng-biệt" title="175-Thách-thức-về-sự-pha-trộn-giữa-các-chế-độ-riêng-biệt"><span class="octicon octicon-link"></span></a>17.5 Thách thức về sự pha trộn giữa các chế độ riêng biệt</h2><p>Khó khăn chính liên quan đến các phương pháp MCMC là chúng có xu hướng <strong>trộn</strong> kém. Trong điều kiện lý tưởng, các mẫu liên tiếp của một chuỗi Markov được thiết kế để lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2281" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.84em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2282"><span class="mi" id="MathJax-Span-2283" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2284" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2285" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2286" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-203">p(\boldsymbol x)</script></span> sẽ hoàn toàn độc lập với nhau và sẽ duyệt qua nhiều vùng khác nhau trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2287" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2288"><span class="mi" id="MathJax-Span-2289" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-204">\boldsymbol x</script></span> tỷ lệ với xác suất của chúng. Thay vào đó, đặc biệt trong các trường hợp số chiều lớn, các mẫu MCMC trở nên rất tương quan. Chúng tôi gọi hành vi này là sự pha trộn chậm hoặc thậm chí sự pha trộn thất bại. Phương pháp MCMC với sự pha trộn chậm có thể được xem như việc thực hiện không có chủ ý một điều gì đó giống như việc trượt gradient có nhiễu trên hàm năng lượng, hoặc tương đương với việc leo đồi có nhiễu trên xác suất, tương ứng với trạng thái của chuỗi (tức là các biến ngẫu nhiên đang được lấy mẫu). Chuỗi có xu hướng tiến các bước nhỏ (trong không gian trạng thái của chuỗi Markov), từ một cấu hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2290" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1002.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2291"><span class="msubsup" id="MathJax-Span-2292"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2293" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-2294"><span class="mrow" id="MathJax-Span-2295"><span class="mo" id="MathJax-Span-2296" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2298" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2299" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2300" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-205">\boldsymbol{x}^{(t-1)}</script></span> đến một cấu hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2301" style="width: 1.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1001.57em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2302"><span class="msubsup" id="MathJax-Span-2303"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2304" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-2305"><span class="mrow" id="MathJax-Span-2306"><span class="mo" id="MathJax-Span-2307" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2309" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-206">\boldsymbol{x}^{(t)}</script></span>, với năng lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2310" style="width: 3.559em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.074em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1002.97em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2311"><span class="mi" id="MathJax-Span-2312" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2313" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2314"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2315" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-2316"><span class="mrow" id="MathJax-Span-2317"><span class="mo" id="MathJax-Span-2318" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2320" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2321" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-207">E(\boldsymbol x^{(t)})</script></span> thường thấp hơn, hoặc xấp xỉ bằng với năng lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2322" style="width: 4.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.936em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.296em, 1003.83em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2323"><span class="mi" id="MathJax-Span-2324" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2325" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2326"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-2328"><span class="mrow" id="MathJax-Span-2329"><span class="mo" id="MathJax-Span-2330" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2331" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2332" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2333" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2334" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2335" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-208">E(\boldsymbol x^{(t-1)})</script></span>, với sự ưu tiên cho bước đi đạt được cấu hình năng lượng thấp hơn. Khi bắt đầu từ một cấu hình không ổn định (có năng lượng cao hơn so với các cấu hình điển hình từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2336" style="width: 2.212em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2337"><span class="mi" id="MathJax-Span-2338" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2339" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2340"><span class="mrow" id="MathJax-Span-2341"><span class="mi" id="MathJax-Span-2342" style="font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-2343" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-209">p(\mathbf{x})</script></span> ), chuỗi có xu hướng giảm dần năng lượng của trạng thái và chỉ thỉnh thoảng mới dịch chuyển sang dạng thức khác. Khi chuỗi tìm thấy một vùng năng lượng thấp (ví dụ, nếu các biến là các điểm ảnh trong một bức ảnh, một vùng năng lượng thấp có thể là một đa tạp liên thông đến hình ảnh của cùng một đối tượng), mà ta gọi là dạng thức, chuỗi sẽ có xu hướng đi vòng quanh dạng thức này (theo một kiểu đi ngẫu nhiên). Đôi khi, chuỗi sẽ bước ra khỏi dạng thức đó và thường quay trở lại hoặc (nếu chuỗi tìm thấy một đường thoát) di chuyển sang dạng thức khác. Vấn đề là các đường thoát thành công hiếm gặp đối với nhiều phân phối mong muốn, do vậy chuỗi Markov sẽ tiếp tục lấy mẫu tại một dạng thức lâu hơn mức cần thiết.</p><p>Đây là vấn đề rất rõ ràng khi chúng ta xem xét thuật toán lấy mẫu Gibbs (phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2344" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.73em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2345"><span class="mstyle" id="MathJax-Span-2346" style="color: red;"><span class="mrow" id="MathJax-Span-2347" style="color: red;"><span class="mn" id="MathJax-Span-2348" style="font-family: MathJax_Main; color: red;">17.4</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-210">\color{red}{17.4}</script></span>). Trong ngữ cảnh này, xét xác suất đi từ dạng thức này sang dạng thức khác gần nó trong một số bước cho trước. Xác suất này sẽ được xác định bởi hình dạng “rào chắn năng lượng” giữa các dạng thức. Việc chuyển tiếp giữa hai dạng thức được phân chia bởi một rào chắn có năng lượng cao (một vùng có xác suất thấp) có khả năng xảy ra thấp theo cấp số luỹ thừa (xét theo chiều cao của rào chắn năng lượng). Điều này được minh hoạ trong hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2349" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.73em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2350"><span class="mstyle" id="MathJax-Span-2351" style="color: red;"><span class="mrow" id="MathJax-Span-2352" style="color: red;"><span class="mn" id="MathJax-Span-2353" style="font-family: MathJax_Main; color: red;">17.1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-211">\color{red}{17.1}</script></span>. Như vậy, vấn đề trên phát sinh khi có nhiều dạng thức với xác suất cao được phân cách bởi các vùng có xác suất thấp, đặc biệt là khi mỗi bước lấy mẫu Gibbs chỉ phải cập nhật một tập con nhỏ của các biến có giá trị được xác định bởi các biến khác.</p><p>Một ví dụ đơn giản, xét một mô hình hướng năng lượng của hai biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2354" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2355"><span class="texatom" id="MathJax-Span-2356"><span class="mrow" id="MathJax-Span-2357"><span class="mi" id="MathJax-Span-2358" style="font-family: MathJax_Main;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-212">\mathrm a</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2359" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2360"><span class="texatom" id="MathJax-Span-2361"><span class="mrow" id="MathJax-Span-2362"><span class="mi" id="MathJax-Span-2363" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-213">\mathrm b</script></span>, đều là biến nhị phân có dấu, nhận các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2364" style="width: 1.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1001.24em, 2.643em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2365"><span class="mo" id="MathJax-Span-2366" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2367" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-214">-1</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2368" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2369"><span class="mn" id="MathJax-Span-2370" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-215">1</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2371" style="width: 8.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.899em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1006.85em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2372"><span class="mi" id="MathJax-Span-2373" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2374" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2375"><span class="mrow" id="MathJax-Span-2376"><span class="mi" id="MathJax-Span-2377" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-2378" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2379" style="font-family: MathJax_Main; padding-left: 0.164em;">b</span></span></span><span class="mo" id="MathJax-Span-2380" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2381" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-2382" style="font-family: MathJax_Main; padding-left: 0.272em;">−</span><span class="mi" id="MathJax-Span-2383" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-2384"><span class="mrow" id="MathJax-Span-2385"><span class="mi" id="MathJax-Span-2386" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-2387" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-216">E(\mathrm{a, b}) = - w \mathrm{ab}</script></span>, với một số dương lớn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2388" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2389"><span class="mi" id="MathJax-Span-2390" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-217">w</script></span> nào đó, thì mô hình sẽ biểu thị một sự chắc chắn rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2391" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2392"><span class="texatom" id="MathJax-Span-2393"><span class="mrow" id="MathJax-Span-2394"><span class="mi" id="MathJax-Span-2395" style="font-family: MathJax_Main;">a</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-218">\mathrm a</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2396" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2397"><span class="texatom" id="MathJax-Span-2398"><span class="mrow" id="MathJax-Span-2399"><span class="mi" id="MathJax-Span-2400" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-219">\mathrm b</script></span> cùng dấu. Xét việc cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2401" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2402"><span class="texatom" id="MathJax-Span-2403"><span class="mrow" id="MathJax-Span-2404"><span class="mi" id="MathJax-Span-2405" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-220">\mathrm b</script></span> sử dụng một bước lấy mẫu Gibbs với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2406" style="width: 2.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1002.27em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2407"><span class="texatom" id="MathJax-Span-2408"><span class="mrow" id="MathJax-Span-2409"><span class="mi" id="MathJax-Span-2410" style="font-family: MathJax_Main;">a</span></span></span><span class="mo" id="MathJax-Span-2411" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-2412" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-221">\mathrm{a} = 1</script></span>. Phân phối có điều kiện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2413" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2414"><span class="texatom" id="MathJax-Span-2415"><span class="mrow" id="MathJax-Span-2416"><span class="mi" id="MathJax-Span-2417" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-222">\mathrm b</script></span> được cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2418" style="width: 12.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.401em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1010.29em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2419"><span class="mi" id="MathJax-Span-2420" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2421" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2422"><span class="mrow" id="MathJax-Span-2423"><span class="mi" id="MathJax-Span-2424" style="font-family: MathJax_Main;">b</span></span></span><span class="mo" id="MathJax-Span-2425" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-2426" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-2427" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="texatom" id="MathJax-Span-2428" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-2429"><span class="mi" id="MathJax-Span-2430" style="font-family: MathJax_Main;">a</span></span></span><span class="mo" id="MathJax-Span-2431" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-2432" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-2433" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2434" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-2435" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2436" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2437" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-2438" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-223">P(\mathrm{b} =1 \mid \mathrm{a} =1) = \sigma(w)</script></span>. Nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2439" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.7em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2440"><span class="mi" id="MathJax-Span-2441" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-224">w</script></span> lớn, hàm chữ S bão hoà, và xác suất gán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2442" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.49em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2443"><span class="texatom" id="MathJax-Span-2444"><span class="mrow" id="MathJax-Span-2445"><span class="mi" id="MathJax-Span-2446" style="font-family: MathJax_Main;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-225">\mathrm{b}</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2447" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2448"><span class="mn" id="MathJax-Span-2449" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-226">1</script></span> gần như là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2450" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2451"><span class="mn" id="MathJax-Span-2452" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-227">1</script></span>. Tương tự, nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2453" style="width: 2.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1002.27em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2454"><span class="texatom" id="MathJax-Span-2455"><span class="mrow" id="MathJax-Span-2456"><span class="mi" id="MathJax-Span-2457" style="font-family: MathJax_Main;">a</span></span></span><span class="mo" id="MathJax-Span-2458" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-2459" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-228">\mathrm{a}=1</script></span>, xác suất gán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2460" style="width: 3.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.07em, 2.643em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2461"><span class="texatom" id="MathJax-Span-2462"><span class="mrow" id="MathJax-Span-2463"><span class="mi" id="MathJax-Span-2464" style="font-family: MathJax_Main;">b</span></span></span><span class="mo" id="MathJax-Span-2465" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-2466" style="font-family: MathJax_Main; padding-left: 0.272em;">−</span><span class="mn" id="MathJax-Span-2467" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-229">\mathrm{b}=-1</script></span> cũng gần như là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2468" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2469"><span class="mn" id="MathJax-Span-2470" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-230">1</script></span>. Theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2471" style="width: 5.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.852em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1004.74em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2472"><span class="msubsup" id="MathJax-Span-2473"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2474" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mtext" id="MathJax-Span-2475" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2476" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2477"><span class="mrow" id="MathJax-Span-2478"><span class="mi" id="MathJax-Span-2479" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-2480" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2481" style="font-family: MathJax_Main; padding-left: 0.164em;">b</span></span></span><span class="mo" id="MathJax-Span-2482" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-231">P_\text{model}(\mathrm{a, b})</script></span>, dấu của cả hai biến giống nhau. Theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2483" style="width: 6.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.229em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1005.12em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2484"><span class="msubsup" id="MathJax-Span-2485"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2486" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mtext" id="MathJax-Span-2487" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2488" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2489"><span class="mrow" id="MathJax-Span-2490"><span class="mi" id="MathJax-Span-2491" style="font-family: MathJax_Main;">a</span><span class="mo" id="MathJax-Span-2492" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2493" style="font-family: MathJax_Main; padding-left: 0.272em;">b</span></span></span><span class="mo" id="MathJax-Span-2494" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-232">P_\text{model}(\mathrm{a \mid b})</script></span>, cả hai biến nên có cùng một dấu. Nghĩa là lấy mẫu Gibbs sẽ ít khi đổi dấu của các biến này.</p><p>Trong các tình huống thực tế, thách thức thậm chí còn lớn hơn bởi vì chúng ta quan tâm tới việc chuyển tiếp không chỉ giữa hai dạng thức mà thường là giữa tất cả các dạng thức có trong mô hình thực. Nếu việc chuyển tiếp gặp trở ngại do sự khó khăn trong việc pha trộn các dạng thức, việc thu được một tập đáng tin cậy gồm các mẫu bao phủ hầu hết các dạng thức thường rất tốn kém, và sự hội tụ của chuỗi Markov về phân phối dừng của nó cũng rất chậm chạp.</p><p>Đôi khi vấn đề này có thể được giải quyết bằng cách tìm kiếm nhóm các đơn vị có độ phụ thuộc cao và cập nhật chúng đồng thời theo một khối. Không may thay, khi sự phụ thuộc trở nên phức tạp, lấy mẫu từ một nhóm có thể gặp khó khăn về mặt tính toán. Xét cho cùng, bài toán mà chuỗi Markov ban đầu được đưa ra để giải quyết là vấn đề lấy mẫu từ một nhóm lớn có nhiều biến.</p><p>Trong bối cảnh các mô hình với các biến tiềm ẩn, định nghĩa một phân phối đồng thời <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2495" style="width: 5.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.013em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1004.91em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2496"><span class="msubsup" id="MathJax-Span-2497"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2498" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2499" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2500" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2501"><span class="mi" id="MathJax-Span-2502" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2503" style="font-family: MathJax_Main-bold;">,</span><span class="mi" id="MathJax-Span-2504" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">h</span></span><span class="mo" id="MathJax-Span-2505" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-233">p_\text{model}(\boldsymbol{x,h})</script></span>, chúng ta thường lấy các mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2506" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2507"><span class="mi" id="MathJax-Span-2508" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-234">\boldsymbol{x}</script></span> bằng cách thay phiên lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2509" style="width: 6.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.337em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1005.23em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2510"><span class="msubsup" id="MathJax-Span-2511"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2512" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2513" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2514" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2515" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2516" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2517" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">h</span><span class="mo" id="MathJax-Span-2518" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-235">p_\text{model}(\boldsymbol{x} \mid \boldsymbol{h})</script></span> và lấy mẫu từ  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2519" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.391em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1005.28em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2520"><span class="msubsup" id="MathJax-Span-2521"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2522" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mtext" id="MathJax-Span-2523" style="font-size: 70.7%; font-family: MathJax_Main;">model</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2524" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2525"><span class="mi" id="MathJax-Span-2526" style="font-family: MathJax_Math-bold-italic;">h</span><span class="mo" id="MathJax-Span-2527" style="font-family: MathJax_Main-bold; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2528" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span></span><span class="mo" id="MathJax-Span-2529" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-236">p_\text{model}(\boldsymbol{h \mid x})</script></span>. Từ quan điểm của pha trộn nhanh, chúng ta muốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2530" style="width: 6.307em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.445em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1005.34em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2531"><span class="msubsup" id="MathJax-Span-2532"><span style="display: inline-block; position: relative; width: 2.481em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2533" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2534"><span class="mrow" id="MathJax-Span-2535"><span class="mi" id="MathJax-Span-2536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-2537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-2538" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-2540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2541" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-2542"><span class="mi" id="MathJax-Span-2543" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2544" style="font-family: MathJax_Main-bold; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-2545" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">h</span></span><span class="mo" id="MathJax-Span-2546" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-237">p_{model}(\boldsymbol{x \mid h})</script></span> có Entropy cao. Từ quan điểm của học một biểu diễn hữu ích của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2547" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.65em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2548"><span class="mi" id="MathJax-Span-2549" style="font-family: MathJax_Math-bold-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-238">\boldsymbol{h}</script></span>, chúng ta muốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2550" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.65em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2551"><span class="mi" id="MathJax-Span-2552" style="font-family: MathJax_Math-bold-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-239">\boldsymbol{h}</script></span> mã hoá đủ thông tin về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2553" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2554"><span class="mi" id="MathJax-Span-2555" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-240">\boldsymbol{x}</script></span> để khôi phục lại nó, ngầm định rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2556" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.65em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2557"><span class="mi" id="MathJax-Span-2558" style="font-family: MathJax_Math-bold-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-241">\boldsymbol{h}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2559" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2560"><span class="mi" id="MathJax-Span-2561" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-242">\boldsymbol{x}</script></span> nên có nhiều thông tin chung. Hai mục tiêu này mâu thuẫn lẫn nhau. Chúng ta thường học các mô hình sinh mẫu có khả năng mã hoá chính xác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2562" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2563"><span class="mi" id="MathJax-Span-2564" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-243">\boldsymbol{x}</script></span> thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2565" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.65em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2566"><span class="mi" id="MathJax-Span-2567" style="font-family: MathJax_Math-bold-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-244">\boldsymbol{h}</script></span> nhưng không thể pha trộn tốt. Tình huống này phát sinh thường xuyên với các máy Boltzmann — phân phối mà máy Boltzmann học  được càng nhọn, thì chuỗi Markov lấy mẫu từ phân phối mô hình càng khó pha trộn. Vấn đề này được minh hoạ trong hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2568" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.781em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.73em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2569"><span class="mstyle" id="MathJax-Span-2570" style="color: red;"><span class="mrow" id="MathJax-Span-2571" style="color: red;"><span class="mn" id="MathJax-Span-2572" style="font-family: MathJax_Main; color: red;">17.2</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">\color{red}{17.2}</script></span>.</p><p>Tất cả điều này có thể làm cho phương pháp MCMC kém hữu dụng hơn khi phân phối được quan tâm có cấu trúc đa hình với một sự đa dạng riêng biệt cho mỗi lớp: các phân phối tập trung xung quanh nhiều dạng thức, và các dạng thức này được phân cách bởi các vùng rộng lớn có năng lượng cao. Loại phân phối này là những gì chúng ta mong muốn trong nhiều bài toán phân loại, và nó sẽ làm cho các phương pháp MCMC hội tụ rất chậm bởi vì sự pha trộn kém giữa các dạng thức.</p><p><img src="https://i.imgur.com/UAqBczE.png" alt=""></p><blockquote>
<p>Hình 17.1: Các đường biểu diễn lấy mẫu Gibbs cho ba phân phối, với chuỗi Markov được khởi tạo tại dạng thức trong cả hai trường hợp. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2573" style="width: 4.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.205em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1004.21em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2574"><span class="texatom" id="MathJax-Span-2575"><span class="mrow" id="MathJax-Span-2576"><span class="mtext" id="MathJax-Span-2577" style="font-family: MathJax_Main-italic;">(B<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ê</span>n tr<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">á</span>i)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">\textit{(Bên trái)}</script></span> Một phân phối chuẩn đa chiều với hai biến độc lập. Lấy mẫu Gibbs trộn tốt vì các biến độc lập với nhau. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2578" style="width: 4.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.451em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1003.45em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2579"><span class="texatom" id="MathJax-Span-2580"><span class="mrow" id="MathJax-Span-2581"><span class="mtext" id="MathJax-Span-2582" style="font-family: MathJax_Main-italic;">(<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">Ở</span> gi<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ữ</span>a)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">\textit{(Ở giữa)}</script></span> Một phân phối chuẩn đa chiều với các biến có sự tương quan cao. Tương quan giữa các biến làm cho sự pha trộn của chuỗi Markov trở nên khó khăn. Vì việc cập nhật cho mỗi biến phải lấy điều kiện trên các biến còn lại, sự tương quan làm giảm tốc độ chuỗi Markov có thể di chuyển ra xa khỏi điểm bắt đầu. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2583" style="width: 5.229em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.475em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1004.48em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2584"><span class="texatom" id="MathJax-Span-2585"><span class="mrow" id="MathJax-Span-2586"><span class="mtext" id="MathJax-Span-2587" style="font-family: MathJax_Main-italic;">(B<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ê</span>n ph<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ả</span>i)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-248">\textit{(Bên phải)}</script></span> Một mô hình hỗn hợp Gauss với các dạng thức tách biệt không thẳng hàng theo trục toạ độ. Lấy mẫu Gibbs pha trộn rất chậm vì khó thay đổi dạng thức khi chỉ có một biến được thay đổi tại một thời điểm.</p>
</blockquote><h3 id="1751-Điều-hoà-để-pha-trộn-giữa-các-mode"><a class="anchor hidden-xs" href="#1751-Điều-hoà-để-pha-trộn-giữa-các-mode" title="1751-Điều-hoà-để-pha-trộn-giữa-các-mode"><span class="octicon octicon-link"></span></a>17.5.1 Điều hoà để pha trộn giữa các mode</h3><p>Khi một phân phối có các đỉnh nhọn với xác suất cao được bao quanh bởi các vùng xác suất thấp, việc pha trộn giữa các mode khác nhau của phân phối đó rất khó khăn. Một vài kĩ thuật giúp pha trộn nhanh hơn dựa việc xây dựng các phiên bản thay thế của phân phối đích trong đó các đỉnh không quá cao và các thung lũng xung quanh không quá thấp. Mô hình hướng năng lượng cung cấp một cách đặc biệt đơn giản để thực hiện điều này. Đến đây, chúng ta đã mô tả một mô hình hướng năng lượng bằng cách định nghĩa một phân phối xác suất<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-249-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2588" style="width: 100%; display: inline-block; min-width: 16.544em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 16.544em;"><span style="position: absolute; clip: rect(3.074em, 1008.78em, 4.421em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2589"><span class="mtable" id="MathJax-Span-2590" style="min-width: 16.544em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.544em;"><span style="display: inline-block; position: absolute; width: 8.839em; height: 0px; clip: rect(-0.913em, 1008.78em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -4.415em;"><span style="position: absolute; clip: rect(3.128em, 1008.78em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.839em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1008.78em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-2594"><span class="mrow" id="MathJax-Span-2595"><span class="mi" id="MathJax-Span-2596" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2597" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2598" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2599" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2600" style="font-family: MathJax_Main; padding-left: 0.272em;">∝</span><span class="mi" id="MathJax-Span-2601" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">e</span><span class="mi" id="MathJax-Span-2602" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2603" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2604" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2605" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2606" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2607" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2608" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2609" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2610" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2611" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.25"><span class="mrow" id="MathJax-Span-2592"><span class="mtext" id="MathJax-Span-2593" style="font-family: MathJax_Main;">(17.25)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-249">\begin{align}
    p(\boldsymbol x) \propto exp(-E(\boldsymbol x)).
    \tag{17.25}
\end{align}</script></span><br>
Mô hình hướng năng lượng có thể được gia cố thêm một tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2612" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2613"><span class="mi" id="MathJax-Span-2614" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-250">\beta</script></span> kiểm soát độ nhọn các đỉnh của phân phối là:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-251-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2615" style="width: 100%; display: inline-block; min-width: 17.621em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 17.621em;"><span style="position: absolute; clip: rect(3.02em, 1009.81em, 4.421em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2616"><span class="mtable" id="MathJax-Span-2617" style="min-width: 17.621em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.621em;"><span style="display: inline-block; position: absolute; width: 9.916em; height: 0px; clip: rect(-0.967em, 1009.81em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -4.954em;"><span style="position: absolute; clip: rect(3.074em, 1009.81em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.916em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1009.81em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="MathJax-Span-2621"><span class="mrow" id="MathJax-Span-2622"><span class="msubsup" id="MathJax-Span-2623"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2624" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-2625" style="font-size: 70.7%; font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2626" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2627" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2628" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2629" style="font-family: MathJax_Main; padding-left: 0.272em;">∝</span><span class="mi" id="MathJax-Span-2630" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">e</span><span class="mi" id="MathJax-Span-2631" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-2632" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2633" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2634" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2635" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2636" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2637" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2638" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-2639" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2640" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2641" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.913em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-17.26"><span class="mrow" id="MathJax-Span-2619"><span class="mtext" id="MathJax-Span-2620" style="font-family: MathJax_Main;">(17.26)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-251">\begin{align}
    p_\beta(\boldsymbol x) \propto exp(-\beta E(\boldsymbol x)).
    \tag{17.26}
\end{align}</script></span><br>
Tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2642" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2643"><span class="mi" id="MathJax-Span-2644" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-252">\beta</script></span> thường được mô tả như là nghịch đảo của <strong>nhiệt độ</strong> (<em>temperature</em>), phản ánh nguồn gốc của mô hình hướng năng lượng trong vật lý thống kê. Khi nhiệt độ giảm về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2645" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2646"><span class="mn" id="MathJax-Span-2647" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">0</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2648" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2649"><span class="mi" id="MathJax-Span-2650" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">\beta</script></span> tăng tới vô cực, mô hình hướng năng lượng trở thành tất định. Khi nhiệt độ tăng tới vô cực và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2651" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2652"><span class="mi" id="MathJax-Span-2653" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-255">\beta</script></span> giảm về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2654" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2655"><span class="mn" id="MathJax-Span-2656" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-256">0</script></span>, phân phối (với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2657" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2658"><span class="mi" id="MathJax-Span-2659" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-257">\boldsymbol x</script></span> rời rạc) trở thành phân phối đều.</p><p><img src="https://i.imgur.com/XeZ28TO.png" alt=""></p><blockquote>
<p>Hình 17.2: Một ví dụ minh hoạ cho vấn đề pha trộn chậm trong mô hình xác suất đa tầng. Mỗi bảng nên được đọc từ trái sang phải, từ trên xuống dưới. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2660" style="width: 4.852em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.151em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1004.04em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2661"><span class="mo" id="MathJax-Span-2662" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2663"><span class="mrow" id="MathJax-Span-2664"><span class="mtext" id="MathJax-Span-2665" style="font-family: MathJax_Main-italic;">B<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ê</span>n tr<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">á</span>i</span></span></span><span class="mo" id="MathJax-Span-2666" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-258">(\textit{Bên trái})</script></span> Các mẫu liên tiếp từ phép lấy mẫu Gibbs áp dụng cho một máy Boltzmann đa tầng khi huấn luyện với tập dữ liệu MNIST. Các mẫu liên tiếp này nhìn tương tự nhau. Vì phép lấy mẫu Gibbs được thực hiện trên một mô hình đồ thị đa tầng, sự tương tự này dựa trên tính ngữ nghĩa nhiều hơn các đặc trưng trực quan thô, nhưng chuỗi Gibbs vẫn sẽ gặp khó khăn khi chuyển tiếp từ một mode này sang mode khác của cùng một phân phối, ví dụ, bằng cách thay đổi chữ số. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2667" style="width: 5.121em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.404em, 1004.31em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2668"><span class="mo" id="MathJax-Span-2669" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2670"><span class="mrow" id="MathJax-Span-2671"><span class="mtext" id="MathJax-Span-2672" style="font-family: MathJax_Main-italic;">B<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ê</span>n ph<span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: italic; font-weight: normal;">ả</span>i</span></span></span><span class="mo" id="MathJax-Span-2673" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-259">(\textit{Bên phải})</script></span> Các mẫu liên tiếp được lấy mẫu từ một mạng đối kháng sinh mẫu. Bởi vì lấy mẫu di truyền tạo ra các mẫu độc lập với nhau, do đó vấn đề pha trộn không xảy ra.</p>
</blockquote><p>Thông thường, một mô hình được huấn luyện để được đánh giá tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2674" style="width: 2.751em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.373em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.32em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2675"><span class="mi" id="MathJax-Span-2676" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2677" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-2678" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">\beta = 1</script></span>. Tuy nhiên, chúng ta có thể tận dụng các nhiệt độ khác, đặc biệt những điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2679" style="width: 2.751em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.373em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.32em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2680"><span class="mi" id="MathJax-Span-2681" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2682" style="font-family: MathJax_Main; padding-left: 0.272em;">&lt;</span><span class="mn" id="MathJax-Span-2683" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">\beta < 1</script></span>. <strong>Điều hoà</strong> là một chiến lược chung cho việc pha trộn giữa các mode của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2684" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.92em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2685"><span class="msubsup" id="MathJax-Span-2686"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-2687" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mn" id="MathJax-Span-2688" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-262">p_1</script></span> nhanh chóng bằng việc lấy mẫu với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-263-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2689" style="width: 2.751em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.373em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.32em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2690"><span class="mi" id="MathJax-Span-2691" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2692" style="font-family: MathJax_Main; padding-left: 0.272em;">&lt;</span><span class="mn" id="MathJax-Span-2693" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">\beta < 1</script></span>.</p><p>Chuỗi Markov dựa trên <strong>chuyển tiếp điều hoà</strong> (<em>tempered transitions</em>) (<em>Neal, 1994</em>) lấy mẫu tạm thời từ phân phối nhiệt độ cao để pha trộn các mode, sau đó tiếp tục lấy mẫu từ phân phối nhiệt độ đơn vị. Các kỹ thuật này đã được áp dụng cho các mô hình như RBM (<em>Salakhutdinov, 2010</em>). Một phương pháp khác là sử dụng <strong>điều hoà song song</strong> (<em>parallel tempering</em>) (<em>Iba, 2001</em>), trong đó chuỗi Markov mô phỏng song song nhiều trạng thái khác nhau, tại các nhiệt độ khác nhau. Trạng thái có nhiệt độ cao nhất pha trộn một cách chậm chạp, trong khi đó trạng thái có nhiệt độ thấp nhất, tại nhiệt độ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2694" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2695"><span class="mn" id="MathJax-Span-2696" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">1</script></span>, cung cấp các mẫu chính xác từ mô hình. Toán tử chuyển tiếp bao gồm việc hoán đổi ngẫu nhiên trạng thái giữa hai mức nhiệt độ khác nhau, sao cho một mẫu xác suất cao từ vị trí có nhiệt độ cao có thể nhảy xuống vị trí nhiệt độ thấp hơn. Phương pháp này cũng được áp dụng cho các RBM (<em>Desjardins và et al., 2010; Cho và et al., 2010</em>). Mặc dù điều hoà là một phương pháp đầy triển vọng, tại thời điểm đó nó không cho phép các nhà nghiên cứu tạo ra một bước tiến mạnh mẽ trong việc giải quyết thách thức của phép lấy mẫu từ các mô hình EBM phức tạp. Một lý do khả dĩ là có <strong>những nhiệt độ tới hạn</strong> mà xung quanh chúng sự chuyển tiếp nhiệt độ phải rất chậm (khi nhiệt độ giảm dần) thì việc điều hoà mới thực sự có hiệu quả.</p><h3 id="1752-Độ-sâu-có-thể-giúp-cho-việc-pha-trộn"><a class="anchor hidden-xs" href="#1752-Độ-sâu-có-thể-giúp-cho-việc-pha-trộn" title="1752-Độ-sâu-có-thể-giúp-cho-việc-pha-trộn"><span class="octicon octicon-link"></span></a>17.5.2 Độ sâu có thể giúp cho việc pha trộn</h3><p>Khi lấy mẫu từ một mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2697" style="width: 3.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.75em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2698"><span class="mi" id="MathJax-Span-2699" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2700" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2701" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-2702" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2703" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">x</span><span class="mo" id="MathJax-Span-2704" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-265">p(h, x)</script></span> có biến ẩn, chúng ta thấy rằng nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2705" style="width: 3.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.07em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2706"><span class="mi" id="MathJax-Span-2707" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2708" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2709" style="font-family: MathJax_Math-italic;">h</span><span class="mtext" id="MathJax-Span-2710" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2711"><span class="mrow" id="MathJax-Span-2712"><span class="mo" id="MathJax-Span-2713" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-2714" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2715" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2716" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">p(h\space|\space x)</script></span> mã hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2717" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2718"><span class="mi" id="MathJax-Span-2719" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-267">x</script></span> quá tốt, thì việc lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2720" style="width: 3.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.07em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2721"><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2723" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2724" style="font-family: MathJax_Math-italic;">x</span><span class="mtext" id="MathJax-Span-2725" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2726"><span class="mrow" id="MathJax-Span-2727"><span class="mo" id="MathJax-Span-2728" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-2729" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2730" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-2731" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-268">p(x\space|\space h)</script></span> sẽ không thay đổi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2732" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2733"><span class="mi" id="MathJax-Span-2734" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-269">x</script></span> quá nhiều, và sự pha trộn càng trở nên tồi tệ. Một cách để giải quyết vấn đề này là chuyển <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2735" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2736"><span class="mi" id="MathJax-Span-2737" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-270">h</script></span> thành một biểu diễn sâu, mã hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2738" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2739"><span class="mi" id="MathJax-Span-2740" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-271">x</script></span> thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2741" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2742"><span class="mi" id="MathJax-Span-2743" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-272">h</script></span> theo cách mà một chuỗi Markov trong không gian của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2744" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2745"><span class="mi" id="MathJax-Span-2746" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">h</script></span> có thể pha trộn dễ dàng hơn. Nhiều thuật toán học cách biểu diễn, như bộ tự mã hoá và các RBM, có xu hướng đạt được một phân phối lề của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2747" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2748"><span class="mi" id="MathJax-Span-2749" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">h</script></span> đều hơn và mang tính đơn mode hơn so với phân phối dữ liệu ban đầu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2750" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2751"><span class="mi" id="MathJax-Span-2752" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-275">x</script></span>. Có thể lập luận rằng điều này phát sinh từ việc cố gắng tối thiểu hoá sai số khôi phục trong khi sử dụng tất cả các không gian biểu diễn khả dụng, bởi vì việc tối thiểu hoá sai số khôi phục trên tập mẫu huấn luyện sẽ tốt hơn khi các mẫu huấn luyện khác nhau được phân biệt dễ dàng trong không gian-<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2753" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2754"><span class="mi" id="MathJax-Span-2755" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-276">h</script></span>, và do đó được phân cách tốt. <em>Bengio et al.</em> (<em>2013a</em>) đã quan sát thấy rằng các ngăn xếp của bộ tự mã hoá chuẩn hoá hoặc các RBM càng sâu thì càng đạt được một phân phối lề trong không gian-<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2756" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2757"><span class="mi" id="MathJax-Span-2758" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">h</script></span> bậc cao có tính dàn trải hơn và đều hơn, đồng thời khoảng cách giữa các vùng tương ứng với các mode cũng giảm đi (các phạm trù, trong các thực nghiệm). Huấn luyện một RBM trong không gian bậc cao hơn đã cho phép lấy mẫu Gibbs pha trộn các mode nhanh hơn. Tuy nhiên, cách để tận dụng quan sát trên nhằm giúp việc huấn luyện và lấy mẫu từ các mô hình sinh mẫu đa tầng trở nên tốt hơn vẫn còn chưa rõ ràng.</p><p>Mặc dù gặp khó khăn trong việc thực hiện trộn, kỹ thuật Monte Carlo rất hữu dụng và thường là công cụ tốt nhất hiện có. Thật vậy, chúng là công cụ chính được sử dụng để đối mặt với hàm phân hoạch khó tính toán của các mô hình vô hướng, sẽ được thảo luận tiếp theo sau đây.<br>
// ------ Sơn Lâm kết thúc dịch ở đây p597 - p602</p><hr class="footnotes-sep"><section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Ước lượng không chệch của phương sai thường được ưu tiên, trong đó tổng của phương sai bình phương được chia cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-278-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2759" style="width: 2.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1002.27em, 2.643em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2760"><span class="mi" id="MathJax-Span-2761" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2762" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-2763" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-278">n - 1</script></span> thay cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2764" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2765"><span class="mi" id="MathJax-Span-2766" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-279">n</script></span> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-17-Phương-pháp-Monte-Carlo" title="Chương 17: Phương pháp Monte Carlo">Chương 17: Phương pháp Monte Carlo</a><ul class="nav">
<li><a href="#171-Lấy-mẫu-và-các-phương-pháp-Monte-Carlo" title="17.1 Lấy mẫu và các phương pháp Monte Carlo">17.1 Lấy mẫu và các phương pháp Monte Carlo</a><ul class="nav">
<li><a href="#1711-Lý-do-lấy-mẫu" title="17.1.1 Lý do lấy mẫu">17.1.1 Lý do lấy mẫu</a></li>
<li><a href="#1712-Khái-niệm-cơ-bản-của-lấy-mẫu-Monte-Carlo" title="17.1.2 Khái niệm cơ bản của lấy mẫu Monte Carlo">17.1.2 Khái niệm cơ bản của lấy mẫu Monte Carlo</a></li>
</ul>
</li>
<li><a href="#172-Lấy-mẫu-theo-mức-độ-quan-trọng" title="17.2 Lấy mẫu theo mức độ quan trọng">17.2 Lấy mẫu theo mức độ quan trọng</a></li>
<li><a href="#173-Phương-pháp-chuỗi-Markov-Monte-Carlo" title="17.3 Phương pháp chuỗi Markov Monte Carlo">17.3 Phương pháp chuỗi Markov Monte Carlo</a></li>
<li><a href="#174-Lấy-mẫu-Gibbs" title="17.4 Lấy mẫu Gibbs">17.4 Lấy mẫu Gibbs</a></li>
<li><a href="#175-Thách-thức-về-sự-pha-trộn-giữa-các-chế-độ-riêng-biệt" title="17.5 Thách thức về sự pha trộn giữa các chế độ riêng biệt">17.5 Thách thức về sự pha trộn giữa các chế độ riêng biệt</a><ul class="nav">
<li><a href="#1751-Điều-hoà-để-pha-trộn-giữa-các-mode" title="17.5.1 Điều hoà để pha trộn giữa các mode">17.5.1 Điều hoà để pha trộn giữa các mode</a></li>
<li><a href="#1752-Độ-sâu-có-thể-giúp-cho-việc-pha-trộn" title="17.5.2 Độ sâu có thể giúp cho việc pha trộn">17.5.2 Độ sâu có thể giúp cho việc pha trộn</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-17-Phương-pháp-Monte-Carlo" title="Chương 17: Phương pháp Monte Carlo">Chương 17: Phương pháp Monte Carlo</a><ul class="nav">
<li><a href="#171-Lấy-mẫu-và-các-phương-pháp-Monte-Carlo" title="17.1 Lấy mẫu và các phương pháp Monte Carlo">17.1 Lấy mẫu và các phương pháp Monte Carlo</a><ul class="nav">
<li><a href="#1711-Lý-do-lấy-mẫu" title="17.1.1 Lý do lấy mẫu">17.1.1 Lý do lấy mẫu</a></li>
<li><a href="#1712-Khái-niệm-cơ-bản-của-lấy-mẫu-Monte-Carlo" title="17.1.2 Khái niệm cơ bản của lấy mẫu Monte Carlo">17.1.2 Khái niệm cơ bản của lấy mẫu Monte Carlo</a></li>
</ul>
</li>
<li><a href="#172-Lấy-mẫu-theo-mức-độ-quan-trọng" title="17.2 Lấy mẫu theo mức độ quan trọng">17.2 Lấy mẫu theo mức độ quan trọng</a></li>
<li><a href="#173-Phương-pháp-chuỗi-Markov-Monte-Carlo" title="17.3 Phương pháp chuỗi Markov Monte Carlo">17.3 Phương pháp chuỗi Markov Monte Carlo</a></li>
<li><a href="#174-Lấy-mẫu-Gibbs" title="17.4 Lấy mẫu Gibbs">17.4 Lấy mẫu Gibbs</a></li>
<li><a href="#175-Thách-thức-về-sự-pha-trộn-giữa-các-chế-độ-riêng-biệt" title="17.5 Thách thức về sự pha trộn giữa các chế độ riêng biệt">17.5 Thách thức về sự pha trộn giữa các chế độ riêng biệt</a><ul class="nav">
<li><a href="#1751-Điều-hoà-để-pha-trộn-giữa-các-mode" title="17.5.1 Điều hoà để pha trộn giữa các mode">17.5.1 Điều hoà để pha trộn giữa các mode</a></li>
<li><a href="#1752-Độ-sâu-có-thể-giúp-cho-việc-pha-trộn" title="17.5.2 Độ sâu có thể giúp cho việc pha trộn">17.5.2 Độ sâu có thể giúp cho việc pha trộn</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
