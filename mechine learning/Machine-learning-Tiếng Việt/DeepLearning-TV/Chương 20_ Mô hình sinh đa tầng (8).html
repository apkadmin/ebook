<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Chương 20: Mô hình sinh đa tầng - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-20-Mô-hình-sinh-đa-tầng"><a class="anchor hidden-xs" href="#Chương-20-Mô-hình-sinh-đa-tầng" title="Chương-20-Mô-hình-sinh-đa-tầng"><span class="octicon octicon-link"></span></a>Chương 20: Mô hình sinh đa tầng</h1><p>(Giai đoạn 1)</p><p>Link bản gốc: <a href="https://hackmd.io/OamxyCkjQ9CTxQs98BYFoA#" target="_blank" rel="noopener">https://hackmd.io/OamxyCkjQ9CTxQs98BYFoA#</a></p><p>-------------------------------------------------------<br>
\ Hưng Nguyễn bắt đầu dịch từ trang 651<br>
-------------------------------------------------------</p><p>Trong chương này chúng tôi sẽ trình bày một số <s>dạng đặc trưng của</s>loại <em>mô hình sinh</em> đặc biệt (generative model) có thể được xây dựng và huấn luyện bằng cách sử dụng các kĩ thuật đã được trình bày trong các chương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">16</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-4">19</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">16</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main; padding-left: 0.218em;">19</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">16-19</script></span>. Tất cả các mô hình này thể hiện các phân phối xác suất nhiều biến theo một vài cách nào đó. Một số mô hình cho phép đánh giá các hàm phân phối một cách tường minh. Số khác không hỗ trợ việc <s>ước lượng hàm</s> thực hiện các phép đánh giá đó<s>phân phối</s> nhưng hỗ trợ các phép <s>toán ngầm</s> xử lý ngầm đòi hỏi phải có hiểu biết nhất định <s>kiến thức</s> về phân phối như <s>cách</s> <s>lấy mẫu từ phân phối</s> <s>phép trực quan hóa các mẫu lấy từ phân phối</s>lấy mẫu từ phân phối. Một số mô hình là các mô hình xác suất có cấu trúc được biểu diễn theo các đồ thị và thừa số, sử dụng ngôn ngữ của các mô hình đồ thị <s>được xây dựng từ các mô hình thống kê theo ngôn ngữ đồ thị và nhân tố</s> được trình bày trong chương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">16</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">16</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">16</script></span>. Số khác thì không dễ được  biểu diễn <s>tả</s> theo <s>ngôn ngữ nhân tố</s> theo các thừa số nhưng dù sao cũng thể hiện phân bố xác suất.</p><h1 id="201-Các-máy-Mô-hình-Boltzmann"><a class="anchor hidden-xs" href="#201-Các-máy-Mô-hình-Boltzmann" title="201-Các-máy-Mô-hình-Boltzmann"><span class="octicon octicon-link"></span></a>20.1 Các máy <s>Mô hình</s> Boltzmann</h1><p><s>Các máy/m</s>Mô hình Boltzman được <s>trình bày</s>giới thiệu lần đầu tiên như một hướng tiếp cận chung của <em>“trường phái kết nối”</em> (connectionist) để học các phân phối xác suất bất kì theo các vector nhị phân (<em>Fahlman et al., 1983; Ackley et al., 1985; Hinton et al., 1984; Hinton and Sejnowski, 1986</em>). Các biến thể của mô hình Boltzmann bao gồm các dạng biến số khác nhau, <s>qua một thời gian dài đã vượt qua dạng ban đầu về mặt số lượng</s> đã <s>phổ biến</s> <s>đa dạng hơn phiên bản gốc từ rất lâu</s> từ lâu đã trở nên phổ biến hơn dạng gốc ban đầu. Trong phần này chúng tôi giới thiệu ngắn gọn về <s>mô hình nhị phân Boltzmann</s> máy Boltzmann nhị phân và thảo luận các vấn đề gặp phải khi huấn luyện và dùng mô hình để suy luận.</p><blockquote>
<p>DN: Boltzmann machine mình nghĩ nên dịch là “máy Boltzmann”, tuy nhiên trong chương này mình vẫn để “mô hình Boltmann” như bản gốc, CE sau nếu đồng ý dịch là “mấy Boltzmann” chỉ cần Ctrl+H.</p>
</blockquote><p>Chúng ta định nghĩa mô hình Boltzmann theo một vector ngẫu nhiên nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">d</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">d</script></span>-chiều <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">x</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-13">0</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-15">1</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-18" style="vertical-align: 0.5em;">d</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.272em;">∈</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.272em;">{</span><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="msubsup" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.43em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.488em;"><span class="mi" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">x \in \{ 0,1\}^d</script></span>. Mô hình Boltzmann là một mô hình <s>dựa trên</s> <s>mức</s> hướng năng lượng(EBM) (<em>xem phần 16.2.4</em>), có nghĩa là chúng ta định nghĩa một phân phối xác suất <s>hợp</s> đồng thời sử dụng một hàm năng lượng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-19"><span class="MJXp-mtable" id="MJXp-Span-20"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-21" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-22" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">P</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-25">x</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-28" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-29">exp</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">E</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-35">x</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">Z</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">P(\boldsymbol{x})=\frac{\exp(-E(\boldsymbol{x}))}{Z} \tag{20.1}</script></span></p><p>Trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">E</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-42">x</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-6-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-6">E(\boldsymbol{x})</script></span> là hàm năng lượng, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-7-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-7">Z</script></span> là hàm phân hoạch sao cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-50">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">P</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-53">x</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-8-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-8">\sum_{\boldsymbol{x}}P(\boldsymbol{x})=1</script></span>. Hàm năng lượng của mô hình Boltzmann được định nghĩa là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-57"><span class="MJXp-mtable" id="MJXp-Span-58"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-59" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-60" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">E</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-63">x</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-69" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-70">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-71">U</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-72">x</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-76" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-77">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-78">x</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">E(\boldsymbol{x})=-\boldsymbol{x}^{\top}\boldsymbol{U}\boldsymbol{x}-\boldsymbol{b}^{\top}\boldsymbol{x}, \tag{20.2}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-81">U</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-10-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-10">\boldsymbol{U}</script></span> là ma trận “trọng số” của các tham số trong mô hình và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-83">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-11-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-11">\boldsymbol{b}</script></span> là vector các hệ số tự do.</p><p>Theo thiết lập chung của mô hình Boltzmann, chúng ta được cho trước tập các ví dụ huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-12-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-12">n</script></span>-chiều. Phương trình 20.1 mô tả phân phối xác suất <s>hợp</s> đồng thời của các biến quan sát được. Mặc dù kịch bản này là khã dĩ, nó cũng giới hạn các dạng tương tác giữa các biến <s>quan sát được</s> khả kiến và các biến được mô tả bằng ma trận trọng số. Cụ thể, nó có nghĩa là xác xuất một <s>nút</s> đơn vị đang bật được mô tả bằng một mô hình tuyến tính (hồi quy logit) theo giá trị của các <s>nút</s> đơn vị khác.</p><p>Các mô hình Boltzmann <s>trở nên có hiệu lực</s> trở nên hiệu quả hơn khi không phải tất cả các biến đều được quan sát. Trong trường hợp này, các biến ẩn có thể hoạt động tương tự các <s>nút</s> đơn vị ẩn trong mạng perceptron đa tầng và mô hình hóa các tương tác bậc cao hơn giữa các <s>nút quan sát được</s> đơn vị khả kiến. Giống như việc thêm vào các <s>nút</s> đơn vị ẩn  để chuyển đổi hồi quy logit thành <s>trong</s> mạng perceptron đa tầng giúp <s>kết quả của mạng</s> <s>này</s> mạng perceptron đa tầng <s>và thông qua đó</s> trở thành bộ xấp xỉ phổ quát của các hàm số, mô hình Boltzmann với các <s>nút</s> đơn vị ẩn không còn bị giới hạn trong việc mô hình hóa các mối quan hệ tuyến tính giữa các biến. Thay vào đó, mô hình Boltzmann trở thành một bộ <s>chuyển đổi phổ quát</s> xấp xỉ phổ quát của các hàm <s>phân phối khối lượng</s> khối xác suất <s>của</s> trên các biến rời rạc. (<em>Le Roux and Bengio, 2008</em>).</p><p>Về mặt hình thức chúng ta phân tách các <s>nút</s> đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-86"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-87">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-13-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol{x}</script></span> thành hai nhóm: nhóm các <s>nút</s> đơn vị khả kiến <s>quan sát được</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-89">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-14-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-14">\boldsymbol{v}</script></span> và các <s>nút</s> đơn vị ẩn (ẩn) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-91">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-15-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-15">\boldsymbol{h}</script></span>. Phương trình năng lượng trở thành</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-92"><span class="MJXp-mtable" id="MJXp-Span-93"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-94" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-95" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">E</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-98">v</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-100">h</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-106" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-107">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-108">R</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-109">v</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-113" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-114">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-115">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-116">h</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-120" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-121">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-122">S</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-123">h</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-127" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-128">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-129">v</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-131"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-132" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-133" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-134">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-135">h</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">E(\boldsymbol{v}, \boldsymbol{h})=-\boldsymbol{v}^{\top}\boldsymbol{Rv}-\boldsymbol{v}^{\top}\boldsymbol{Wh}-\boldsymbol{h}^{\top}\boldsymbol{Sh}-\boldsymbol{b}^{\top}\boldsymbol{v}-\boldsymbol{c}^{\top}\boldsymbol{h}.  \tag{20.3}</script></span></p><p><strong>Học máy Boltzmann<s>Mô hình Boltzmann học</s></strong> Các thuật toán học của mô hình Boltzmann thường dựa trên <s>hàm tối ưu cực đại</s> <s>việc tối ưu hàm hợp lí</s> hợp lý cực đại. Các mô hình Boltzmann đều có một hàm phân hoạch rất khó tính, do đó gradient <s>độ dốc</s> của hàm hợp lý <s>tối ưu</s> cực đại phải được xấp xỉ bằng các kĩ thuật mô tả trong chương 18.</p><p>Một tính chất thú vị của các mô hình Boltzmann khi huấn luyện với các quy tắc dựa trên hợp lý cực đại <s>tối ưu cực đại</s> là việc cập nhật một trọng số riêng kết nối hai nút chỉ phụ thuộc vào thông tin thống kê của các <s>nút</s> đơn vị đó, được thu thập theo các phân phối khác nhau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-140" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-141">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-143">v</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-17-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-17">P_{\text{model}}(\boldsymbol{v})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mrow" id="MJXp-Span-147" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-148"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">P</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-152">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-154">v</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">P</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-159">model</span></span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-161">h</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-163">v</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-18-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-18">\hat{P}_{\text{data}}(\boldsymbol{v})P_{\text{model}}(\boldsymbol{h}\mid\boldsymbol{v}).</script></span> Phần còn lại của mạng tham gia vào việc hình thành các thông tin thống kê đó, tuy nhiên trọng số có thể được cập nhật mà không cần biết về phần còn lại của mạng hay bằng cách nào các thống kê đó được sinh ra. Điều này có nghĩa rằng quy tắc học là “cục bộ”, khiến cho việc học của mô hình Boltzmann bằng cách nào đó trở nên khá hợp lý về mặt sinh học. Có thể hiểu rằng nếu mỗi nơ-ron là một <s>giá trị</s> biến ngẫu nhiên trong mô hình Boltzmann thì các sợi trục (axon) và các sợi nhánh (dendrit) kết nối hai <s>giá trị</s> biến ngẫu nhiên có thể học chỉ bằng cách quan sát <s>mẫu mồi</s> mẫu kích hoạt (firing pattern) của các tế bào mà chúng thực sự chạm vào. <s>Nói riêng thì</s> Cụ thể, trong pha dương (positive phase) hai nút thường kích hoạt <s>với</s> cùng nhau thì mối liên kết giữa chúng được tăng cường<s>được tăng cương kê nối</s>. Đây là một ví dụ của luật học Hebb (<em>Hebb, 1949</em>) <s>đã được tổng kết cho</s> thường được gọi với tên dễ nhớ là <s>“cùng mồi, cùng nối”</s> “kích hoạt cùng nhau, nối cùng nhau” ( “ﬁre together, wire together”). Các quy tắc học <s>của</s> Hebb là một trong những giải thích mang tính giả thuyết lâu đời nhất <s>ở trong số các giải thích giả định cho việc học</s> <s>trong</s> cho việc học trong các hệ sinh học và vẫn còn xác đáng tới ngày nay (<em>Giudice et al., 2009</em>).</p><p>Các giải thuật học khác sử dụng nhiều thông tin hơn các thống kê cục bộ có vẻ như yêu cầu chúng ta gỉa định rằng cấu trúc của bộ máy phức tạp hơn vậy. Ví dụ, <s>như</s> để bộ não <s>việc</s> hiện thực hóa lan truyền ngược trong mạng perceptron đa tầng, <s>đối với bộ não gần như là cần thiết để</s> có vẻ như việc bộ não cần duy trì một mạng liên lạc thứ cấp để việc truyền đạt thông tin của gradient ngược lại theo qua mạng nơ-ron. Người ta đã đề xuất quá trình hiện thực hóa (xấp xỉ) hợp lí theo sinh học của việc lan truyền ngược (<em>Hinton, 2007a; Bengio, 2015</em>) nhưng cần được kiểm định thêm, <em>Bengio (2015)</em> đã kết nối lan truyền ngược <s>gradient</s> với suy luận trong các mô hình <s>dựa vào</s> hướng năng lượng <s>cho</s> giống với mô hình Boltzmann (nhưng với các biến ẩn liên tục).</p><p>Pha âm trong huấn luyện mô hình Boltzmann có vẻ như khó giải thích hơn từ quan điểm sinh học. Như đã trao đổi trong phần 18.2, ngủ mơ có thể là một dạng của lấy mẫu trong pha âm. Ý tưởng này dù thế vẫn là suy đoán.</p><h1 id="202-Mô-hình-Boltzmann-hạn-chế-RBM"><a class="anchor hidden-xs" href="#202-Mô-hình-Boltzmann-hạn-chế-RBM" title="202-Mô-hình-Boltzmann-hạn-chế-RBM"><span class="octicon octicon-link"></span></a>20.2 Mô hình Boltzmann hạn chế (RBM)</h1><blockquote>
<p>Hôm trước anh Hùng Lê có đề xuất dịch restricted Boltzmann Machines là Máy Boltzmann hẹp, mình cũng đồng ý với cách dịch này. Tuy nhiên mình vẫn để Máy Boltzmann hạn chế, editor sau nếu đồng ý thì Ctrl+H đổi toàn bộ thành Máy Boltzmann hẹp giúp nhé. Tks</p>
</blockquote><p>Được phát minh với cái tên <strong>harmonium</strong> (đàn đạp hơi) (<em>Smolensky, 1986</em>), các mô hình Boltzamnn hạn chế là một trong những <s>viên gạch chung</s> khối nền tảng của các mô hình thống kê <s>sâu</s> đa tầng. Chúng tôi đã mô tả ngắn gọn RBM trong phần 16.7.1. Ở đây chúng ta điểm lại các kiến thức trước và đi sâu hơn vào chi tiết. <s>RMB</s>RBM là các mô hình đồ thị xác suất vô hướng chứa một tầng các biến <s>quan sát được</s> khả kiến và một tầng <s>đơn lẻ</s>duy nhất các biến ẩn. RBM có thể được xếp chồng (một RBM trên RBM khác) để tạo nên các mô hình sâu hơn <s>đa tầng</s> hơn như các ví dụ trong hình 20.1. Cụ thể, hình 20.1a thể hiện cấu trúc đồ thị của RBM này. Nó là một đồ thị hai phía (đồ thị lưỡng phân)  không có bất kì một kết nối nào giữa các nút trong lớp <s>quan sát được</s> khả kiến hay lớp ẩn.</p><blockquote>
<p>Tiếng Việt không có từ harmonium, tạm dịnh là Dương cầm được không? Mặc dù harmonium không phải là dương cầm (piano)</p>
</blockquote><p>Chúng ta bắt đầu với mô hình nhị phân của các mô hình Boltzamnn hạn chế, nhưng như chúng ta sẽ thấy về sau có sự mở rộng thêm các kiểu khác của <s>nút</s> đơn vị khả kiến và đơn vị ẩn <s>và không ẩn.</s><br>
<img src="https://i.imgur.com/o47ycvt.png" alt=""></p><p>Hình 20.1: Ví dụ về các mô hình được xây dựng dựa trên RBM. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">a</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-19-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-19">(a)</script></span> Mô hình Bolztmann <s>bản thân</s> <s>có bản chất</s> là một mô hình đồ thị vô hướng dựa đồ thị hai phía, với một phía là các đơn vị khả kiến<s>nút quan sát được</s> và phía còn lại là các nút ẩn. Không có bất kì kết nối nào giữa các <s>nút</s> đơn vị khả kiến hay giữa các đơn vị ẩn trong cùng một tầng. Thương thì mỗi đơn vị khả kiến <s>nút không ẩn</s> kết nối với mọi <s>nút</s>đơn vị ẩn, tuy nhiên người ta cũng có thể cấu trúc các RBM kết nối thưa như các RBM tích chập. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">b</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-20-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-20">(b)</script></span> Mạng phân phối đa <s>lớp</s> tầng (deep belief network - DBN) là một mô hình đồ thị lai bao gồm các kết nối vô hướng và có hướng. Như một RBM, DBN không có các kết nối trong mỗi lớp. Tuy nhiên một DBN lại có nhiều tầng ẩn, do đó tồn tại các liên kết giữa các đơn vị ẩn trong các tầng khác nhau. Các phân phối xác suất có điều kiện cục bộ cần phải có trong mạng phân phối đa tầng được sao chép trực tiếp từ các phân phối xác suất có điều kiệu cục bộ của phần RBM trong mạng đó. Theo cách khác, ta có thể biểu diễn một mạng phân phối đa tầng với một đồ thị vô hướng đầy đủ, nhưng khi đó nó cần các kết nối nội bộ trong một tầng để nắm bắt những sự phụ thuộc giữa các nút cha (parents). <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">c</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-21-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-21">(c)</script></span> Một mô hình Boltzmann sâu (DBM) là một mô hình đồ thị vô hướng với vài tầng của các biến ẩn. Như trong RBM và DBN, trong DBM cũng không có các liên kết nội bộ lớp. DBM <s>ít gắn chặt</s> có ít điểm tương đồng với RBM hơn DBN. Khi khởi tạo một DBM từ chuỗi các RBM, chúng ta cần điều chỉnh các tham số của RBM một ít. Một vài kiểu DBM có thể được huấn luyện không cần huấn luyện các RBM trước.</p><p>Về mặt hình thức, ta quy ước lớp <s>quan sát được</s> khả kiến là một tập <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-msubsup" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-181" style="vertical-align: -0.4em;">v</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-22-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-22">n_v</script></span> biến ngẫu nhiên nhị phân liên quan đến vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-183">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-23-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-23">\boldsymbol{v}</script></span>. Lớp ẩn gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;">h</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-24-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-24">n_h</script></span> biến ngẫu nhiên nhị phân được quy ước là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-189">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-25-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-25">\boldsymbol{h}</script></span>.</p><p>Như một mô hình Boltzmann tổng quát <s>nói chung</s>, mô hình Boltzamnn hạn chế cũng là một mô hình hướng năng lượng với phân phối xác suất <s>hợp</s> đồng thời và được định nghĩa bởi phương trình năng lượng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-190"><span class="MJXp-mtable" id="MJXp-Span-191"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-192" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-193" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">P</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-196"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-197">v</span></span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-199">v</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-201"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-202">h</span></span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-204">h</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-207" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-208">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">Z</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-210">exp</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">E</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-216">v</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-218">h</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">P(\mathbf{v}=\boldsymbol{v}, \mathbf{h}=\boldsymbol{h})=\frac{1}{Z}\exp(-E(\boldsymbol{v},\boldsymbol{h})).\tag{20.4}</script></span></p><p>Phương trình năng lượng của một RBM cho bởi<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-222"><span class="MJXp-mtable" id="MJXp-Span-223"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-224" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-225" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">E</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-228">v</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-230">h</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-236" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-237">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-238">v</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-241" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-242" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-243">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-244">h</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-246"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-247" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-248" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-249">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-250">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-251">h</span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">E(\boldsymbol{v},\boldsymbol{h})=-\boldsymbol{b}^{\top}\boldsymbol{v}-\boldsymbol{c}^{\top}\boldsymbol{h}-\boldsymbol{v}^{\top}\boldsymbol{Wh},\tag{20.5}</script></span></p><p>và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">Z</script></span> là hằng số chuẩn hóa được biết như hàm phân hoạch:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-255"><span class="MJXp-mtable" id="MJXp-Span-256"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-257" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-258" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">Z</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-261"><span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-263" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">v</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-265"><span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-267" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">h</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-269">exp</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">E</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-275">v</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-277">h</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">Z=\sum_{v}\sum_{h}\exp\{-E(\boldsymbol{v},\boldsymbol{h})\}.\tag{20.6}</script></span></p><p>Định nghĩa hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">Z</script></span> cho thấy rõ ràng rằng việc tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">Z</script></span> bằng phương pháp đơn giản (vét cạn các trường hợp và tính tổng) có thể rất khó tính, trừ phi một thuật toán được <s>định nghĩa</s> thiết kế khôn ngoan mới có thể khai thác tính quy tắc trong phân phối xác suất và tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">Z</script></span> nhanh hơn. Trong trường hợp của mô hình Boltzmann hạn chế, <em>Long và Servedio (2010)</em> <s>đã chính thức</s> chứng minh rằng hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">Z</script></span> là rất khó tính. Hàm phân hoạch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">Z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">Z</script></span> rất khó tính đồng nghĩa với việc hàm phân phối xác suất đồng thời <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">P</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-294">v</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">P(\boldsymbol{v})</script></span>  cũng rất khó tính.</p><h2 id="2021-Phân-phối-có-điều-kiện"><a class="anchor hidden-xs" href="#2021-Phân-phối-có-điều-kiện" title="2021-Phân-phối-có-điều-kiện"><span class="octicon octicon-link"></span></a>20.2.1 Phân phối có điều kiện</h2><p>Mặc dù <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">P</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-299">v</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-36-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-36">P(\boldsymbol{v})</script></span> rất khó tính, cấu trúc đồ thị hai phía<s>chia đôi</s> của RBM có một tính chất đặc biệt là các phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">P</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-305">h</span></span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mrow" id="MJXp-Span-307"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-308">v</span></span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">P(\mathbf{h}\mid\mathbf{v})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">P</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-314">v</span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mrow" id="MJXp-Span-316"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-317">h</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">P(\mathbf{v}\mid\mathbf{h})</script></span> có thể nhân tử hóa và tương đối đơn giản để tính toán và lấy mẫu.<br>
Các phân phối có điều kiện được tính toán trực tiếp từ phân phối <s>hợp</s> đồng thời:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-319"><span class="MJXp-mtable" id="MJXp-Span-320"><span><span class="MJXp-mtr" id="MJXp-Span-321" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-322" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-323" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-324" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">P</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-327">h</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-329">v</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-331" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-332"></span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-334" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-335" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">P</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-338">h</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-340">v</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">P</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-344">v</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-346" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-347" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-348" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-349"></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-351" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-352" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-353">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">P</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-356">v</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-358" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-359">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">Z</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-361">exp</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-msubsup" id="MJXp-Span-365"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-366" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-367" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-368">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-369">v</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-371"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-372" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-373" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-374">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-375">h</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-379" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-380">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-381">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-382">h</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-384" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-385" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-386" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-387"></span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-389" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-390" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-391">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393" style="margin-right: 0.05em;">Z</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-394" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-395">exp</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-397"><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-401" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-402">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-403">h</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-405"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-406" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-407" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-408">⊤</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-409">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-410">h</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-412" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-413" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-414" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-415"></span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-417" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-418" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-419">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;">Z</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-422" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-423">exp</span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-425"><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.896em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.582em; margin-left: -0.336em;">{</span></span><span class="MJXp-munderover" id="MJXp-Span-427"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-433" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">h</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-429" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">j</span><span class="MJXp-mo" id="MJXp-Span-431">=</span><span class="MJXp-mn" id="MJXp-Span-432">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-442" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-444"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-450" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-453" style="vertical-align: -0.4em;">h</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-446" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">j</span><span class="MJXp-mo" id="MJXp-Span-448">=</span><span class="MJXp-mn" id="MJXp-Span-449">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-456" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-457">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-458"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-459" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-460" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-461">:</span><span class="MJXp-mo" id="MJXp-Span-462">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-464"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-465" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-466" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.896em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.582em; margin-left: -0.336em;">}</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-468" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-469" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-470" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-471"></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-473" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-474" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-475">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msup" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477" style="margin-right: 0.05em;">Z</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-478" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-479"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-485" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-488" style="vertical-align: -0.4em;">h</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-481" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">j</span><span class="MJXp-mo" id="MJXp-Span-483">=</span><span class="MJXp-mn" id="MJXp-Span-484">1</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-489">exp</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-491"><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-msubsup" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-495" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-498" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-501" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-502" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-503">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-504"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-505" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-506" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-507">:</span><span class="MJXp-mo" id="MJXp-Span-508">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\begin{eqnarray}\\
P(\boldsymbol{h}\mid\boldsymbol{v}) &=& \frac{P(\boldsymbol{h},\boldsymbol{v})}{P(\boldsymbol{v})} \tag{20.7}\\
 &=& \frac{1}{P(\boldsymbol{v})}\frac{1}{Z}\exp\left\{\boldsymbol{b}^{\top}\boldsymbol{v}+\boldsymbol{c}^{\top}\boldsymbol{h}+\boldsymbol{v}^{\top}\boldsymbol{Wh}\right\} \tag{20.8}\\
 &=& \frac{1}{Z'}\exp\left\{\boldsymbol{c}^{\top}\boldsymbol{h}+\boldsymbol{v}^{\top}\boldsymbol{Wh}\right\}\tag{20.9}\\
&=&\frac{1}{Z'}\exp\left\{\sum_{j=1}^{n_h}c_jh_j+\sum_{j=1}^{n_h}\boldsymbol{v}^{\top}\boldsymbol{W}_{:,j}\boldsymbol{h}_j\right\}\tag{20.10}\\
 &=&\frac{1}{Z'}\prod_{j=1}^{n_h}\exp\left\{c_jh_j+\boldsymbol{v}^{\top}\boldsymbol{W}_{:,j}\boldsymbol{h}_j\right\}.\tag{20.11}
\\\end{eqnarray}</script></span></p><p>-------------------------------------------------------<br>
\ Hưng Nguyễn kết t<br>
húc dịch ở đây đầu trang 656<br>
-------------------------------------------------------</p><p>-------------------------------------------------------<br>
\ Phan Lan bắt đầu dịch từ đầu trang 656<br>
-------------------------------------------------------<br>
\ Edit: 18/11</p><p>Vì chúng ta đang lấy điều kiện trên các đơn vị <s>nhìn thấy</s> khả kiến v, chúng ta có thể coi chúng là hằng số theo phân bố <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">P</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-518">h</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-520">v</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">P(\boldsymbol{h}\mid\boldsymbol{v})</script></span>. Tính nhân tử hoá được của phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">P</span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-525">h</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-527">v</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-41-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-41">P(\boldsymbol{h}\mid\boldsymbol{v})</script></span> xuất hiện ngay lập tức từ khả năng viết ra các xác xuất <s>hợp</s>  đồng thời trên vector h như là tích của các phân phối (chưa chuẩn hoá) của các phần tử riêng lẻ, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-532" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-42-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-42">h_j</script></span>. Bây giờ việc chuẩn hóa các phân phối trên nhị phân riêng lẻ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-msubsup" id="MJXp-Span-534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-536" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-43-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-43">h_j</script></span> là tương đối đơn giản.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-537"><span class="MJXp-mtable" id="MJXp-Span-538"><span><span class="MJXp-mtr" id="MJXp-Span-539" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-540" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-541" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-542" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">P</span><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-547" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-549">1</span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-551">v</span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-553" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-554"></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-556" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-557" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-558"><span class="MJXp-munderover" id="MJXp-Span-559"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">P</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-565" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-567">1</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-569">v</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-munderover" id="MJXp-Span-572"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">P</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-578" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-580">0</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-582">v</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-munderover" id="MJXp-Span-586"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">P</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-592" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-594">1</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-596">v</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-598" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-599" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-600" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-601"></span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-603" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-604" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">p</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-611" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-615" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-616">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-619" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-620">:</span><span class="MJXp-mo" id="MJXp-Span-621">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">}</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">p</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-628">0</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">p</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-641" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-642">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-645" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-646">:</span><span class="MJXp-mo" id="MJXp-Span-647">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">}</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-651" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-652" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-653" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-654"></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-656" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">σ</span><span class="MJXp-mrow" id="MJXp-Span-658"><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-662" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-666" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-667">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-671">:</span><span class="MJXp-mo" id="MJXp-Span-672">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-675" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-676" style="padding-top: 0.3em; text-align: right;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-44">\begin{eqnarray}\\
P(h_j=1\mid\boldsymbol{v}) &=&
\frac{\tilde{P}(h_j=1\mid\boldsymbol{v})}{\tilde{P}(h_j=0\mid\boldsymbol{v})+\hat{P}(h_j=1\mid\boldsymbol{v})} \tag{20.12}\\
  &=& \frac{exp\{c_j+\boldsymbol{v}^{\top}\boldsymbol{W}_{:,j}\}}{exp\{0\}+exp\{c_j+\boldsymbol{v}^{\top}\boldsymbol{W}_{:,j}\}}\ \tag{20.13}\\
 &=& \sigma \left( c_j+\boldsymbol{v}^{\top}\boldsymbol{W}_{:,j} \right)\tag{20.14}\\
 \\\end{eqnarray}</script></span></p><p>Chúng ta có thể biểu đầy đủ hàm phân phối xác suất có điều kiện của lớp ẩn như một tích của các phân phối độc lập:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-677"><span class="MJXp-mtable" id="MJXp-Span-678"><span><span class="MJXp-mtr" id="MJXp-Span-679" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-680" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-681" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-682" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">P</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-685">h</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-687">v</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-689" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-690"></span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-692" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-693"></span><span class="MJXp-munderover" id="MJXp-Span-694"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-700" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-703" style="vertical-align: -0.4em;">h</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-696" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">j</span><span class="MJXp-mo" id="MJXp-Span-698">=</span><span class="MJXp-mn" id="MJXp-Span-699">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">σ</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-707">2</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-708">h</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-710">1</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-714">c</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-715" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-716">W</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">h</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-719"><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-721" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">\begin{eqnarray}\\
P(\boldsymbol{h}\mid\boldsymbol{v}) 
 &=&{}\prod_{j=1}^{n_h}\sigma ((2\boldsymbol{h}-1)\odot(\boldsymbol{c
+W}h))_i.\tag{20.15}
\\\end{eqnarray}</script></span></p><p>Một phép suy diễn tương tự sẽ cho thấy rằng hàm phân phối khác mà chúng ta quan tâm, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">P</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-726">v</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-727" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-728">h</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-46-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-46">P(\boldsymbol{v \mid h})</script></span>, cũng là một phân phối có thể được biểu diễn bởi tích của các phân phối độc lập:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-730"><span class="MJXp-mtable" id="MJXp-Span-731"><span><span class="MJXp-mtr" id="MJXp-Span-732" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-733" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-734" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-735" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">P</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-738">v</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-740">h</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-742" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-743"></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-745" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-746"></span><span class="MJXp-munderover" id="MJXp-Span-747"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-753" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-756" style="vertical-align: -0.4em;">h</span></span></span></span><span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-749" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">j</span><span class="MJXp-mo" id="MJXp-Span-751">=</span><span class="MJXp-mn" id="MJXp-Span-752">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">σ</span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-760">2</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-761">v</span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-763">1</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-767">b</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-768" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-769">W</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">h</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">\begin{eqnarray}\\
P(\boldsymbol{v}\mid\boldsymbol{h}) 
 &=&{}\prod_{j=1}^{n_h}\sigma ((2\boldsymbol{v}-1)\odot(\boldsymbol{b
+W}h))_i.\tag{20.16}
\\\end{eqnarray}</script></span></p><h2 id="2022-Huấn-luyện-máy-Boltzmann-hạn-chế"><a class="anchor hidden-xs" href="#2022-Huấn-luyện-máy-Boltzmann-hạn-chế" title="2022-Huấn-luyện-máy-Boltzmann-hạn-chế"><span class="octicon octicon-link"></span></a>20.2.2 Huấn luyện máy Boltzmann hạn chế</h2><p>Bởi vì RBM thừa hưởng sự đánh giá hiệu quả và tính khả vi <s>thừa nhận sự đánh giá hiệu quả</s> <s>được đánh giá là hiệu quả và <s>sự</s> đạo hàm của</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mrow" id="MJXp-Span-777"><span class="MJXp-munderover" id="MJXp-Span-778"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">P</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-782">v</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">\tilde{P}(\boldsymbol{v})</script></span> và lấy mẫu MCMC hiệu quả ở dạng lấy mẫu khối Gibbs, nó có thể sẵn sàng được huấn luyện với bất kỳ kỹ thuật nào được mô tả ở chương 18 cho mô hình huấn luyện mà có hàm phân hoạch có chi phí tính toán lớn.<br>
Nó bao gồm CD, SML (PCD), hợp nhất tỷ lệ, v.v. So với các mô hình vô hướng <s>gián tiếp</s> được sử dụng trong học tập sâu, RBM tương đối đơn giản để huấn luyện vì chúng tôi có thể tính toán P (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">h</span><span class="MJXp-mrow" id="MJXp-Span-786"><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">h | v</script></span>) chính xác ở dạng đóng. Một số mô hình <s>sâu</s> đa tầng khác, như máy Boltzmann <s>sâu</s> đa tầng, kết hợp cả những cái khó của một hàm phân hoạch rất khó tính, bao gồm CD, SML (PCD), ghép tỉ số, <a href="http://v.v.So" target="_blank" rel="noopener">v.v.So</a> với các mô hình vô hướng khác được sử dụng trong học sâu, RBM tương đối dễ huấn luyện vì ta có thể tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">P</span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-792"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-793">h</span></span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-795">v</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">P(\mathbf{h}\mid\boldsymbol{v})</script></span> chính xác ở dạng đóng. Một vài mô hình đa tầng khác, ví dụ máy Boltzmann đang tầng, có cả hàm phân hoạch và hàm suy luận rất khó tính.</p><h1 id="203-Mạng-phân-phối-đa-lớp-tầng"><a class="anchor hidden-xs" href="#203-Mạng-phân-phối-đa-lớp-tầng" title="203-Mạng-phân-phối-đa-lớp-tầng"><span class="octicon octicon-link"></span></a>20.3 Mạng phân phối đa <s>lớp</s> tầng</h1><p>Mạng phân phối đa <s>lớp</s> tầng (DBNs) là một trong những mô hình phi tích chập đầu tiên được thừa nhận huấn luyện thành công  kiến trúc <s>sâu</s> đa tầng (Hinton và cộng sự, 2006; Hinton, 2007b). Sự mở đầu của mạng phân phối đa <s>lớp</s> tầng vào năm 2006 đã bắt đầu sự phục hưng của học sâu <s>sắc</s> ngày nay. Trước khi <s>phần giới thiệu</s> các mạng phân phối đa <s>lớp</s>tầng được giới thiệu, các mô hình đa tầng<s>sâu</s> được coi là rất khó để tối ưu hóa. Máy Kernel với hàm mục tiêu lồi chiếm ưu thế trong lĩnh vực nghiên cứu. Mạng phân phối đa <s>lớp</s> tầng đã cho thấy rằng các kiến trúc đa tầng <s>sâu</s> có thể thành công bằng cách cho các kết quả tốt hơn so với các máy vector hỗ trợ <s>được</s> <s>các thể hiện ngoạn mục những vector máy có hỗ trợ</s> <s>hạt nhân hoá</s>kết hợp với hàm nhân trên bộ dữ liệu MNIST (Hinton et al., 2006). Ngày nay, mạng phân phối đa <s>lớp</s> tầng hầu như không được ưa chuộng và hiếm khi được sử dụng, dù có so với các thuật toán học máy không giám sát hoặc sinh <s>trưởng</s> mẫu khác, nhưng chúng vẫn xứng đáng được công nhận vai trò quan trọng của chúng trong lịch sử học <s>tập</s> sâu.</p><p>Mạng phân phối đa tầng là các mô hình sinh <s>trưởng</s>mẫu với nhiều lớp biến ẩn. Các biến ẩn thường là biến nhị phân, trong khi các đơn vị khả kiến <s>hiển thị</s> có thể là nhị phân hoặc là số thực. Không có kết nối nội bộ trong một tầng. Thông thường, mỗi đơn vị trong mỗi tầng được kết nối với mọi đơn vị trong mỗi tầng lân cận, tuy nhiên, cũng có thể xây dựng các DBN được kết nối thưa. Các kết nối giữa hai tầng trên cùng là <s>gián tiếp</s> vô hướng. Các kết nối giữa tất cả các lớp khác là <s>trực tiếp</s> có hướng, với các mũi tên chỉ về phía lớp gần với dữ liệu nhất. Hình 20.1b là một ví dụ.</p><p>Một DBN với <em>l</em> lớp ẩn có chứa <em>l</em> ma trận trọng số : <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-800" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-801">(</span><span class="MJXp-mn" id="MJXp-Span-802">1</span><span class="MJXp-mo" id="MJXp-Span-803">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-51-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-51">\boldsymbol{W}^{(1)}</script></span>,…,<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-806" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-807" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-808">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">l</span><span class="MJXp-mo" id="MJXp-Span-810">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-52-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-52">\boldsymbol{W}^{(l)}</script></span>  …. Nó cũng chứa <em>l</em> + 1 <s>vector lệch</s> hệ số tự do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-811"><span class="MJXp-msubsup" id="MJXp-Span-812"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-813" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-814" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-815">(</span><span class="MJXp-mn" id="MJXp-Span-816">0</span><span class="MJXp-mo" id="MJXp-Span-817">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-53-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-53">\boldsymbol{b}^{(0)}</script></span>,…, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-821" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-822">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">l</span><span class="MJXp-mo" id="MJXp-Span-824">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">\boldsymbol{b}^{(l)}</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-825"><span class="MJXp-msubsup" id="MJXp-Span-826"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-827" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-828" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-829">(</span><span class="MJXp-mn" id="MJXp-Span-830">0</span><span class="MJXp-mo" id="MJXp-Span-831">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\boldsymbol{b}^{(0)}</script></span> cung cấp <s>độ lệch</s>hệ số tự do cho các lớp khả kiến <s>hiển thị</s> . Phân bố xác xuất <s>đại điện</s> được biểu diễn bởi DBN được cho bởi:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-832"><span class="MJXp-mtable" id="MJXp-Span-833"><span><span class="MJXp-mtr" id="MJXp-Span-834" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-835" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-836" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-837" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">P</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-840"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-841" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-842" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-843">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">l</span><span class="MJXp-mo" id="MJXp-Span-845">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-847" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-848"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-849" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-850" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-851">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">l</span><span class="MJXp-mo" id="MJXp-Span-853">−</span><span class="MJXp-mn" id="MJXp-Span-854">1</span><span class="MJXp-mo" id="MJXp-Span-855">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-857">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-mi" id="MJXp-Span-859">exp</span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-863" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-864" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-865">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">l</span><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mo" id="MJXp-Span-868" style="margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-869" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-870">⊤</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-872" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-873" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-874">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">l</span><span class="MJXp-mo" id="MJXp-Span-876">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-878"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-879" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-880" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-881">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">l</span><span class="MJXp-mo" id="MJXp-Span-883">−</span><span class="MJXp-mn" id="MJXp-Span-884">1</span><span class="MJXp-mo" id="MJXp-Span-885">)</span><span class="MJXp-mi" id="MJXp-Span-886">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-887"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-888" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-889" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-890">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">l</span><span class="MJXp-mo" id="MJXp-Span-892">−</span><span class="MJXp-mn" id="MJXp-Span-893">1</span><span class="MJXp-mo" id="MJXp-Span-894">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-898" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-899">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">l</span><span class="MJXp-mo" id="MJXp-Span-901">−</span><span class="MJXp-mn" id="MJXp-Span-902">1</span><span class="MJXp-mo" id="MJXp-Span-903">)</span><span class="MJXp-mi" id="MJXp-Span-904">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-907" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-908">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">l</span><span class="MJXp-mo" id="MJXp-Span-910">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-912" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-913" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-914">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">l</span><span class="MJXp-mo" id="MJXp-Span-916">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">\begin{eqnarray}\\
P(\boldsymbol{h}^{(l)},\,\boldsymbol{h}^{(l-1)})\ \propto\exp(\boldsymbol{b}^{(l)^{\top}}\boldsymbol{h}^{(l)}+\boldsymbol{b}^{(l-1)\top}\boldsymbol{h}^{(l-1)}+\boldsymbol{h}^{(l-1)\top}\boldsymbol{W}^{(l)}\boldsymbol{h}^{(l)}),
 \tag{20.17}
\\\end{eqnarray}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-919"><span class="MJXp-mtable" id="MJXp-Span-920"><span><span class="MJXp-mtr" id="MJXp-Span-921" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-922" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-923" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-924" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">P</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-930"><span class="MJXp-mo" id="MJXp-Span-931">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">l</span><span class="MJXp-mo" id="MJXp-Span-933">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-935">1</span><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-937"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-938" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-939" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-940">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">k</span><span class="MJXp-mo" id="MJXp-Span-942">+</span><span class="MJXp-mn" id="MJXp-Span-943">1</span><span class="MJXp-mo" id="MJXp-Span-944">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-946">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">σ</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-mo" id="MJXp-Span-954">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">k</span><span class="MJXp-mo" id="MJXp-Span-956">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-958"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-959" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-964"><span class="MJXp-mo" id="MJXp-Span-965">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">k</span><span class="MJXp-mo" id="MJXp-Span-967">+</span><span class="MJXp-mn" id="MJXp-Span-968">1</span><span class="MJXp-mo" id="MJXp-Span-969">)</span><span class="MJXp-mrow" id="MJXp-Span-970"><span class="MJXp-mi" id="MJXp-Span-971">⊤</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mo" id="MJXp-Span-961">:</span><span class="MJXp-mo" id="MJXp-Span-962">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-972"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-973" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-974" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-975">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">k</span><span class="MJXp-mo" id="MJXp-Span-977">+</span><span class="MJXp-mn" id="MJXp-Span-978">1</span><span class="MJXp-mo" id="MJXp-Span-979">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-981">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">i</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-984">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">k</span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mn" id="MJXp-Span-987">1</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">l</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-995">2</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-57">\begin{eqnarray}\\
P(h_i^{(l)}=1\mid\boldsymbol{h}^{(k
+1)})\ =\sigma(b_i^{(k)}+\boldsymbol{W}_{:,i}^{(k+1){\top}}\boldsymbol{h}^{(k+1)})\forall i,\forall k\in1,...,l-2
 \tag{20.18}
\\\end{eqnarray}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-996"><span class="MJXp-mtable" id="MJXp-Span-997"><span><span class="MJXp-mtr" id="MJXp-Span-998" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-999" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1000" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1001" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">P</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1006" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1008">1</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1012" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1013">(</span><span class="MJXp-mn" id="MJXp-Span-1014">1</span><span class="MJXp-mo" id="MJXp-Span-1015">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1017">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">σ</span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1024"><span class="MJXp-mo" id="MJXp-Span-1025">(</span><span class="MJXp-mn" id="MJXp-Span-1026">0</span><span class="MJXp-mo" id="MJXp-Span-1027">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1030" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1035"><span class="MJXp-mo" id="MJXp-Span-1036">(</span><span class="MJXp-mn" id="MJXp-Span-1037">1</span><span class="MJXp-mo" id="MJXp-Span-1038">)</span><span class="MJXp-mrow" id="MJXp-Span-1039"><span class="MJXp-mi" id="MJXp-Span-1040">⊤</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1031"><span class="MJXp-mo" id="MJXp-Span-1032">:</span><span class="MJXp-mo" id="MJXp-Span-1033">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1042" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1043" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1044">(</span><span class="MJXp-mn" id="MJXp-Span-1045">1</span><span class="MJXp-mo" id="MJXp-Span-1046">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1048">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">i</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-58">\begin{eqnarray}\\
P(v_i=1\mid\boldsymbol{h}^{(1)})\ =\sigma(b_i^{(0)}+\boldsymbol{W}_{:,i}^{(1){\top}}\boldsymbol{h}^{(1)})\forall i. \tag{20.19}
\\\end{eqnarray}</script></span></p><p>Trong trường hợp của các đơn vị <s>hiển thị</s> khả kiến có giá trị thực, thay</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1051"><span class="MJXp-mtable" id="MJXp-Span-1052"><span><span class="MJXp-mtr" id="MJXp-Span-1053" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1054" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1055" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1056" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-1057">v</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-scr" id="MJXp-Span-1060">N</span></span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">v</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1065" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1066" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1067">(</span><span class="MJXp-mn" id="MJXp-Span-1068">0</span><span class="MJXp-mo" id="MJXp-Span-1069">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1072" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1073" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1074">(</span><span class="MJXp-mn" id="MJXp-Span-1075">1</span><span class="MJXp-mo" id="MJXp-Span-1076">)</span><span class="MJXp-mrow" id="MJXp-Span-1077"><span class="MJXp-mi" id="MJXp-Span-1078">⊤</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1080" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1081" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1082">(</span><span class="MJXp-mn" id="MJXp-Span-1083">1</span><span class="MJXp-mo" id="MJXp-Span-1084">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1088" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1089">−</span><span class="MJXp-mn" id="MJXp-Span-1090">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-59">\begin{eqnarray}\\
\text{v}\sim\mathscr{N}(v;\boldsymbol{b}^{(0)}+\boldsymbol{W}^{(1){\top}}\boldsymbol{h}^{(1)},\beta^{-1}) \tag{20.20}
\\\end{eqnarray}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">β</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-60-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-60">\beta</script></span> là ma trận đường chéo  để dễ xử lý. <s>Suy rộng</s> Tổng quát hoá cho họ các hàm số mũ của các đơn vị khả kiến <s>hiển thị</s> khá đơn giản, ít nhất là theo lý thuyết. Một DBN vởi chỉ một tầng ẩn thì chỉ là một RBM.</p><blockquote>
<p>DN đã xem tới đây</p>
</blockquote><p>Để tạo một mẫu từ một DBN, đầu tiên chúng ta chạy một vài bước lấy mẫu Gibbs dùng hai lớp ẩn <s>hàng</s> đầu tiên. Giai đoạn này là cần thiết để <s>tạo</s> lấy một mẫu từ RBM được xác định bởi hai lớp ẩn <s>hàng</s> đầu tiên. <s><s><s>Sau đó, chúng ta có thể sử dụng một lần lấy mẫu tổ tiên di truyền thông qua phần còn lại của mô hình để tạo lấy ra một mẫu từ các đơn vị hiển thị khả kiến.</s></s></s><br>
Mạng phân phối đa <s>lớp</s> tầng gây ra nhiều vấn đề liên quan đến cả hai mô hình có hướng và vô hướng<s>trực tiếp và gián tiếp</s>.</p><p>Suy luận trong mạng phân phối đa <s>lớp</s> tầng <s>là không dễ dàng</s> tốn nhiều chi phí tính toán do hiệu ứng chối bỏ trong mỗi lớp <s>trực tiếp</s> có hướng và sự tương tác giữa hai lớp ẩn có các kết nối <s>gián tiếp</s> vô hướng. Việc ước lượng hoặc tối đa hóa các dấu hiệu tiêu chuẩn thấp hơn <s>ràng buộc về khả năng truy nhập</s> phụ thuộc vào logarit hàm hợp lí cũng không dễ dàng bởi các dấu hiện thấp hơn ràng buộc được đặt ra với kỳ vọng về một nhóm có kích cỡ bằng với độ rộng của mạng lưới.<br>
Sự ước lượng hoặc tối đa hoá <s>khả năng truy nhập</s>logarit hàm hợp lí <s>yêu cầu sự đối diện với không chỉ các</s> gặp phải vấn đề về hàm phân hoạch có chi phí tính toán lớn trong mô hình gián tiếp 2 lớp đầu tiên.<br>
Để huấn luyện một mạng phân phối đa <s>lớp</s> tầng, ta phải bắt đầu bằng việc huấn luyện một RBM để tối đa hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-msubsup" id="MJXp-Span-1095"><span class="MJXp-mrow" id="MJXp-Span-1096" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1097">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1098" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1099">v</span><span class="MJXp-mo" id="MJXp-Span-1100">∼</span><span class="MJXp-msubsup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1103" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">a</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-61-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-61">\mathbb{E}_{\text{v}\sim p_{data}}</script></span>log<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">p</span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">v</span></span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-62-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-62">p({v})</script></span> sử dụng sự tương phản phân kỳ hoặc hợp lý cực đại ngẫu nhiên<s>khả năng tối đa ngẫu nhiên</s>. Các hệ số của RBM sau đó định nghĩa các hệ số của lớp đầu tiên của DBN. Tiếp theo, một RBM thứ hai sẽ được huấn luyện để đạt được mức cực đại gần đúng.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1114"><span class="MJXp-mtable" id="MJXp-Span-1115"><span><span class="MJXp-mtr" id="MJXp-Span-1116" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1117" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1118" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1119" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mrow" id="MJXp-Span-1121" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1122">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1124">v</span><span class="MJXp-mo" id="MJXp-Span-1125">∼</span><span class="MJXp-msubsup" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1128" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">a</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1133"><span class="MJXp-mrow" id="MJXp-Span-1134" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1135">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1136" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1139" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1140">(</span><span class="MJXp-mn" id="MJXp-Span-1141">1</span><span class="MJXp-mo" id="MJXp-Span-1142">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1143">∼</span><span class="MJXp-msubsup" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1146" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1147">(</span><span class="MJXp-mn" id="MJXp-Span-1148">1</span><span class="MJXp-mo" id="MJXp-Span-1149">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1151" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1152" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1153">(</span><span class="MJXp-mn" id="MJXp-Span-1154">1</span><span class="MJXp-mo" id="MJXp-Span-1155">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1156">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">v</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1158">log</span><span class="MJXp-msubsup" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1161" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1162">(</span><span class="MJXp-mn" id="MJXp-Span-1163">2</span><span class="MJXp-mo" id="MJXp-Span-1164">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1167" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1168" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1169">(</span><span class="MJXp-mn" id="MJXp-Span-1170">1</span><span class="MJXp-mo" id="MJXp-Span-1171">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">\begin{eqnarray}\\
\mathbb{E}_{\text{v}\sim p_{data}}\mathbb{E}_{h^{(1)}\sim p^{(1)}\boldsymbol{h}^{(1)}\mid v} \text{log} p^{(2)}(\boldsymbol{h}^{(1)}), \tag{20.21}
\\\end{eqnarray}</script></span></p><p>Với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1174"><span class="MJXp-msubsup" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1177" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1178">(</span><span class="MJXp-mn" id="MJXp-Span-1179">1</span><span class="MJXp-mo" id="MJXp-Span-1180">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-64-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-64">p^{(1)}</script></span> là phân phôi xác suất <s>đại diện</s> được biểu diễn bởi RBM đầu tiên và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1181"><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1184" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1185">(</span><span class="MJXp-mn" id="MJXp-Span-1186">2</span><span class="MJXp-mo" id="MJXp-Span-1187">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-65-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-65">p^{(2)}</script></span> là phân phối xác suất <s>đại diện cho</s>được biểu diễn bởi RBM thứ hai. Nói cách khác, RBM thứ hai được huấn luyện <s>tới</s> để mô hình hoá <s>mà</s> phân phối được xác định bởi sự lấy mẫu các đợn vị ẩn của RBM đầu tiên, khi mà RBM đầu tiên được điều chỉnh bởi dữ liệu. Thủ tục này có thể lặp lại vô tận để thêm nhiều lớp vào DBN như mong muốn, với mỗi RBM mới mô hình hoá mẫu của cái trước đó. Mỗi RBM xác định một tầng khác của DBN. Thủ tục này có thể được chỉnh định khi tăng một ràng buộc  biến phân thấp về khả năng truy nhập của dự liệu dưới DBN (Hinton et al., 2006)<br>
Trong hầu hết các ứng dụng, không cần cố để huấn luyện đồng thời DBN sau khi thủ tục <s>tham lam theo lớp</s> <s>tiền huần luyện</s> tiền huấn luyện được thực hiện <s>hoàn thiện</s>. Dù vậy, <s>có khả năng việc</s> ta vẫn có thể thực hiện tinh chỉnh sinh <s>trưởng</s> mẫu bằng cách <s>việc</s> sử dụng thuật toán đánh  <em>wake-sleep</em> (wake-sleep algorithm)<s>thức giấc ngủ.</s><br>
DBN đã được <s>đào tạo</s> huấn luyện có thể được sử dụng trực tiếp như là một mô hình sinh mẫu, nhưng hầu hết các lợi ích trong DBN phát sinh từ khả năng ~~của họ để ~~cải thiện các mô hình phân loại. Chúng <s>tôi</s> ta có thể lấy các trọng số từ DBN và sử dụng chúng để xác định một mô hình MLP.</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1188"><span class="MJXp-mtable" id="MJXp-Span-1189"><span><span class="MJXp-mtr" id="MJXp-Span-1190" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1191" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1192" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1193" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1196" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1197">(</span><span class="MJXp-mn" id="MJXp-Span-1198">1</span><span class="MJXp-mo" id="MJXp-Span-1199">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">σ</span><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1205" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1206">(</span><span class="MJXp-mn" id="MJXp-Span-1207">1</span><span class="MJXp-mo" id="MJXp-Span-1208">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1212" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1213">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1216" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1217">(</span><span class="MJXp-mn" id="MJXp-Span-1218">1</span><span class="MJXp-mo" id="MJXp-Span-1219">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">\begin{eqnarray}\\
h^{(1)}=\sigma(b^{(1)}+v^{\top}W^{(1)}), \tag{20.22}
\\\end{eqnarray}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1222"><span class="MJXp-mtable" id="MJXp-Span-1223"><span><span class="MJXp-mtr" id="MJXp-Span-1224" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1225" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1226" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1227" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1230" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1231">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">l</span><span class="MJXp-mo" id="MJXp-Span-1233">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">σ</span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1239" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1240">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">l</span><span class="MJXp-mo" id="MJXp-Span-1242">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1246" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1247">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">l</span><span class="MJXp-mo" id="MJXp-Span-1249">−</span><span class="MJXp-mn" id="MJXp-Span-1250">1</span><span class="MJXp-mo" id="MJXp-Span-1251">)</span><span class="MJXp-mi" id="MJXp-Span-1252">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1255" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1256">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">l</span><span class="MJXp-mo" id="MJXp-Span-1258">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1260">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">l</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mn" id="MJXp-Span-1263">2</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">m</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">\begin{eqnarray}\\
h^{(l)}=\sigma(b^{(l)}+h^{(l-1)\top}W^{(l)})\forall l \in 2,...,m\tag{20.23}
\\\end{eqnarray}</script></span><br>
Sau khi khởi tạo mô hình MLP này với trọng số và hệ số tự do<s>giá trị lệch</s> được học <s>được</s> thông qua huấn luyện sinh mẫu<s>trưởng</s> của DBN, chúng ta có thể <s>đào tạo</s>huấn luyện MLP để thực hiện một tác vụ phân loại. Sự huấn luyện mở rộng <s>thêm</s> này của MLP là một ví dụ về sự tinh chỉnh rõ ràng.<br>
Sự lựa chọn đặc biệt này của MLP có phần tuỳ tiện, so với nhiều phương trình suy diễn trong chương 19 mà đã được <s>bắt nguồn</s> suy ra từ các quy luật đầu tiên. Mô hình MLP này là một lựa chọn phỏng đoán mà có vẻ hoạt động tốt trong thực tế và được sử dụng <s>nhất quán</s> thường xuyên trong lý thuyết. Nhiều kỹ thuật suy luận gần đúng được thúc đẩy bởi <s>tính</s> khả năng <s>thi để</s> xác định giới hạn biến đổi dưới tối đa chặt chẽ của logarit hàm hợp lí <s>về khả năng gia nhập</s>  dưới một số tập ràng buộc. Người ta có thể xây dựng một giới hạn biến đổi dưới của logarit hàm hợp lí<s>về  khả năng của gia nhập</s> bằng cách sử dụng các đơn vị kỳ vọng ẩn được xác định bởi mô hình MLP của DBN, nhưng điều này đúng với bất kỳ phân bố xác suất nào trên toàn bộ các đơn vị ẩn, và không có lý do gì để tin rằng MLP này có thể cung cấp một ràng buộc chặt chẽ cụ thể. <s>Cụ thể</s>Đặc biệt, MLP bỏ qua nhiều tương tác quan trọng trong mô hình đồ <s>họa</s>thị DBN. MLP lan truyền <s>đi</s> các thông tin lên trên từ các đơn vị <s>nhìn thấy được</s> khả kiến đến các đơn vị ẩn ở tầng sâu nhất, nhưng nó không truyền đi bất kỳ thông tin nào đi xuống hoặc sang hai bên. Mô hình đồ thị <s>hoạ</s> DBN có những tương tác biện giữa tất cả các đơn vị ẩn trong cùng một tầng cũng như trong các tương tác từ trên xuống giữa các lớp.</p><p>Mặc dù k<s>hả năng gia nhập</s> logarit hàm hợp lí của DBN có chi phí tính toán lớn <s>là</s> <s>khó nắm bắt</s> nhưng nó có thể được xấp xỉ với AIS (Salakhutdinov và Murray, 2008). Điều này cho phép đánh giá chất lượng của nó như là mô hình sinh mẫu<s>đa tầng</s>.</p><p>Thuật ngữ “mạng phân phối đa tầng<s>lớp</s>” thường được sử dụng không chính xác khi đề cập đến bất kỳ mạng nơron sâu nào, kể cả các mạng không có lớp nghĩa biến đổi ẩn. Thuật ngữ nên đề cập một cách cụ thể đến các mô hình với các kết nối <s>gián tiếp</s>vô hướng ở các tầng sâu nhất và <s>chỉ</s> kết nối có hướng, chỉ xuống dưới giữa tất cả các cặp đơn vị của các lớp liền nhau.</p><p>Thuật ngữ này cũng có thể gây ra một số nhầm lẫn bởi vì “mạng phân thối <s>đa tầng</s>” đôi khi được sử dụng để chỉ các mô hình có hướng thuần túy, trong khi các mạng phân phối đa <s>lớp</s> tầng có chứa một tầng vô hướng. Mạng phân phối đa tầng<s>lưới tín ngưỡng sâu</s> cũng chia sẻ từ viết tắt DBN với mạng Bayesian động (Dean và Kanazawa, 1989), là mạng Bayesian mà <s>đại diện cho</s>biểu diễn chuỗi Markov.</p><h1 id="204-Máy-Boltzmann-sâu-đa-tầng"><a class="anchor hidden-xs" href="#204-Máy-Boltzmann-sâu-đa-tầng" title="204-Máy-Boltzmann-sâu-đa-tầng"><span class="octicon octicon-link"></span></a>20.4 Máy Boltzmann <s>sâu</s> đa tầng</h1><p>Một máy Boltzmann đa tầng<s>sâu</s>, hoặc DBM (Salakhutdinov và Hinton, 2009a) là một loại mô hình sinh đa tầng khác. Không giống như mạng phân phối đa <s>lớp</s>tầng (DBN), nó là một mô hình hoàn toàn vô hướng. Không giống như RBM, DBM có một số lớp biến <s>ngầm</s>ẩn (RBM chỉ có một tầng). Nhưng giống như RBM, bên trong mỗi lớp, mỗi biến là độc lập lẫn nhau, được điều chỉnh theo các biến trong các lớp lân cận. Cấu trúc đồ thị được biểu diễn trong hình 20.2<s>H là ví dụ về biểu đồ cấu trúc</s>. Các máy Boltzmann đa tầng<s>sâu</s> đã được áp dụng cho nhiều <s>công việ</s>tác vụ khác nhau, bao gồm cả mô hình hóa tài liệu (Srivastava và cộng sự, 2013).</p><p>Giống như RBM và DBN, DBM thường chỉ chứa các đơn vị nhị phân — như chúng ta giả định để tạo sự đơn giản trong <s>trình bày</s>việc biểu diễn mô hình của chúng ta — nhưng nó đơn giản để chứa các đơn vị khả kiến<s>hiển thị</s> có giá trị thực.</p><p>Một DBM là một mô hình <s>dựa trên</s>hướng năng lượng, có nghĩa là phân bố xác suất <s>chung</s>đồng thời trên các biến mô hình được tham số hoá bởi một hàm năng lượng E. Trong trường hợp của một máy Boltzmann đa tầng<s>sâu</s> với một tầng <s>có thể nhìn thấy,</s> khả kiến, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1271">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-68-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-68">\boldsymbol{v}</script></span>, và ba lớp ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-msubsup" id="MJXp-Span-1273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1275" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1276">(</span><span class="MJXp-mn" id="MJXp-Span-1277">1</span><span class="MJXp-mo" id="MJXp-Span-1278">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-69-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-69">h^{(1)}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1279"><span class="MJXp-msubsup" id="MJXp-Span-1280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1282" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1283">(</span><span class="MJXp-mn" id="MJXp-Span-1284">2</span><span class="MJXp-mo" id="MJXp-Span-1285">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-70-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-70">h^{(2)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1289" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1290">(</span><span class="MJXp-mn" id="MJXp-Span-1291">3</span><span class="MJXp-mo" id="MJXp-Span-1292">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-71-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-71">h^{(3)}</script></span>, xác suất <s>chung</s>đồng thời được đưa ra bởi:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1293"><span class="MJXp-mtable" id="MJXp-Span-1294"><span><span class="MJXp-mtr" id="MJXp-Span-1295" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1296" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1297" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1298" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">P</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">v</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1305" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1306">(</span><span class="MJXp-mn" id="MJXp-Span-1307">1</span><span class="MJXp-mo" id="MJXp-Span-1308">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1312" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1313">(</span><span class="MJXp-mn" id="MJXp-Span-1314">2</span><span class="MJXp-mo" id="MJXp-Span-1315">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1319" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1320">(</span><span class="MJXp-mn" id="MJXp-Span-1321">3</span><span class="MJXp-mo" id="MJXp-Span-1322">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1325" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1326"><span class="MJXp-mn" id="MJXp-Span-1327">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">Z</span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">θ</span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">p</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">E</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">v</span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1343" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1344">(</span><span class="MJXp-mn" id="MJXp-Span-1345">1</span><span class="MJXp-mo" id="MJXp-Span-1346">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1350" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1351">(</span><span class="MJXp-mn" id="MJXp-Span-1352">2</span><span class="MJXp-mo" id="MJXp-Span-1353">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1357" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1358">(</span><span class="MJXp-mn" id="MJXp-Span-1359">3</span><span class="MJXp-mo" id="MJXp-Span-1360">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">θ</span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-72">\begin{eqnarray}\\
P(v,h^{(1)},h^{(2)},h^{(3)})=\frac{\mathrm 1}{Z(\theta)}exp(-E(v,h^{(1)},h^{(2)},h^{(3)};\theta)).\tag{20.24}
\\\end{eqnarray}</script></span></p><p>Để đơn giản hóa <s>bản trình bày</s>việc biểu diễn của chúng tôi, chúng tôi bỏ qua các <s>tham số lệch</s>hệ số tự do bên dưới. Hàm năng lượng DBM sau đó được xác định như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1366"><span class="MJXp-mtable" id="MJXp-Span-1367"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1368" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1369" style="text-align: center;"><span class="MJXp-mtable" id="MJXp-Span-1370"><span><span class="MJXp-mtr" id="MJXp-Span-1371" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">E</span><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">v</span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1379" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1380">(</span><span class="MJXp-mn" id="MJXp-Span-1381">1</span><span class="MJXp-mo" id="MJXp-Span-1382">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1386" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1387">(</span><span class="MJXp-mn" id="MJXp-Span-1388">2</span><span class="MJXp-mo" id="MJXp-Span-1389">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1393" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1394">(</span><span class="MJXp-mn" id="MJXp-Span-1395">3</span><span class="MJXp-mo" id="MJXp-Span-1396">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">θ</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1400" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1404" style="vertical-align: 0.5em;"><span class="MJXp-mi" id="MJXp-Span-1405">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1408" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1409">(</span><span class="MJXp-mn" id="MJXp-Span-1410">1</span><span class="MJXp-mo" id="MJXp-Span-1411">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1414" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1415">(</span><span class="MJXp-mn" id="MJXp-Span-1416">1</span><span class="MJXp-mo" id="MJXp-Span-1417">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1421" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1422">(</span><span class="MJXp-mn" id="MJXp-Span-1423">1</span><span class="MJXp-mo" id="MJXp-Span-1424">)</span><span class="MJXp-mi" id="MJXp-Span-1425">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1428" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1429">(</span><span class="MJXp-mn" id="MJXp-Span-1430">2</span><span class="MJXp-mo" id="MJXp-Span-1431">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1434" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1435">(</span><span class="MJXp-mn" id="MJXp-Span-1436">2</span><span class="MJXp-mo" id="MJXp-Span-1437">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1441" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1442">(</span><span class="MJXp-mn" id="MJXp-Span-1443">2</span><span class="MJXp-mo" id="MJXp-Span-1444">)</span><span class="MJXp-mi" id="MJXp-Span-1445">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1448" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1449">(</span><span class="MJXp-mn" id="MJXp-Span-1450">3</span><span class="MJXp-mo" id="MJXp-Span-1451">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1454" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1455">(</span><span class="MJXp-mn" id="MJXp-Span-1456">3</span><span class="MJXp-mo" id="MJXp-Span-1457">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1460" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1461" style="padding-top: 0.4em;"></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\begin{array}\\
E(v,h^{(1)},h^{(2)},h^{(3)};\theta)=-v^{\top}W^{(1)}h^{(1)}-h^{(1)\top}W^{(2)}h^{(2)}-h^{(2)\top}W^{(3)}h^{(3)}).\\ 
\tag{20.25}
\\\end{array}</script></span></p><p><img src="https://i.imgur.com/y54QMeo.png" alt=""></p><blockquote>
<p>Hình 20.2: Mô hình <s>đồ họa</s>đồ thị cho một máy Boltzmann đa tầng<s>sâu</s> với một tầng <s>nhìn thấy được</s>khả kiến (dưới cùng) và hai lớp ẩn. Kết nối chỉ có ở giữa các đơn vị <s>trong</s>ở các lớp lân cận. Không có kết nối nội bộ giữa các đơn vị trong cùng một tầng.<s>intralayer</s></p>
</blockquote><p>-------------------------------------------------------<br>
\ Phan Lan kết thúc dịch từ cuối trang 660<br>
-------------------------------------------------------</p><p>-------------------------------------------------------<br>
\ Killi bắt đầu dịch từ trang 661<br>
-------------------------------------------------------<br>
So sánh với hàm năng lượng RBM (công thức 20.5), hàm năng lượng DBM bao gồm cả kết nối giữa các đơn vị ẩn (các biến ẩn) theo dạng các ma trận trọng số (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-msubsup" id="MJXp-Span-1463"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1464" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1465" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1466">(</span><span class="MJXp-mn" id="MJXp-Span-1467">2</span><span class="MJXp-mo" id="MJXp-Span-1468">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-74-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-74">\boldsymbol{W}^{(2)}</script></span>) và (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1469"><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1472" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1473">(</span><span class="MJXp-mn" id="MJXp-Span-1474">3</span><span class="MJXp-mo" id="MJXp-Span-1475">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-75-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol{W}^{(3)}</script></span>). Chúng ta sẽ thấy sau đây những kết nối này có hệ quả quan trọng với <s>dáng điệu</s>trạng thái của mô hình cũng như việc chúng ta suy diễn trong mô hình như thế nào.</p><p>So sánh với máy Boltzmann kết nối đầy đủ (mọi đơn vị được kết nối lẫn nhau), DBM đem lại một vài lợi thế tương tự như RBM. Cụ thể, như được minh họa ở hình 20.3, các lớp của DBM có thể được tổ chức theo <s>biểu đồ hai nhánh</s> đồ thị hai phía <em>(bipartite graph)</em>, với các lớp lẻ ở một bên và lớp chẵn ở bên còn lại. Điều này <s>ngay lập tức ngụ ý rằng khi</s> có nghĩa rằng chúng ta đặt điều kiện cho các biến ở lớp chẵn, các biến ở lớp lẻ trở nên độc lập có điều kiện. Tất nhiên, khi chúng ta đặt điều kiện cho các biến ở lớp lẻ, các biến ở lớp chẵn cũng trở nên độc lập có điều kiện.</p><p>Cấu trúc hai nhánh của DBM có nghĩa rằng chúng ta có thể áp dụng các phương trình tương tự như trước đó đã dùng cho các <s>hàm</s> phân phối có điều kiện của một hàm RBM để <s>quyết</s>xác định các <s>hàm</s> phân phối có điều kiện trong DBM. Các đơn vị trong mỗi lớp là độc lập có điều kiện với nhau nếu giá trị của các lớp kế cận đã được biết, nên các hàm phân phối của các biến nhị phân có thể được miêu tả đầy đủ bởi các tham số của phân phối Bernoulli, nếu xác suất của mỗi đơn vị được kích hoạt đã được biết. Trong ví dụ của chúng ta với hai lớp ẩn, các xác suất kích hoạt này được biểu diễn bởi<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1476"><span class="MJXp-mtable" id="MJXp-Span-1477"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1478" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1479" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">P</span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1484" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1486">1</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1488"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1489" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1490" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1491">(</span><span class="MJXp-mn" id="MJXp-Span-1492">1</span><span class="MJXp-mo" id="MJXp-Span-1493">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">σ</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1504"><span class="MJXp-mo" id="MJXp-Span-1505">(</span><span class="MJXp-mn" id="MJXp-Span-1506">1</span><span class="MJXp-mo" id="MJXp-Span-1507">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">i</span><span class="MJXp-mo" id="MJXp-Span-1502">,</span><span class="MJXp-mo" id="MJXp-Span-1503">:</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1510" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1511">(</span><span class="MJXp-mn" id="MJXp-Span-1512">1</span><span class="MJXp-mo" id="MJXp-Span-1513">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-76"> P(v_i = 1\mid \boldsymbol{h}^{(1)}) = \sigma (\boldsymbol{W}_{i,:}^{(1)}\boldsymbol{h}^{(1)})), \tag{20.26}</script></span><br>
<img src="https://i.imgur.com/lpCYRuS.png" alt=""><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1517"><span class="MJXp-mtable" id="MJXp-Span-1518"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1519" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1520" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">P</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1526"><span class="MJXp-mo" id="MJXp-Span-1527">(</span><span class="MJXp-mn" id="MJXp-Span-1528">1</span><span class="MJXp-mo" id="MJXp-Span-1529">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1531">1</span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1533">v</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1536" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1537" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1538">(</span><span class="MJXp-mn" id="MJXp-Span-1539">2</span><span class="MJXp-mo" id="MJXp-Span-1540">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">σ</span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-1547" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-msubsup" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1549" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1554"><span class="MJXp-mo" id="MJXp-Span-1555">(</span><span class="MJXp-mn" id="MJXp-Span-1556">1</span><span class="MJXp-mo" id="MJXp-Span-1557">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1550"><span class="MJXp-mo" id="MJXp-Span-1551">:</span><span class="MJXp-mo" id="MJXp-Span-1552">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1559"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1560" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1565"><span class="MJXp-mo" id="MJXp-Span-1566">(</span><span class="MJXp-mn" id="MJXp-Span-1567">2</span><span class="MJXp-mo" id="MJXp-Span-1568">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">i</span><span class="MJXp-mo" id="MJXp-Span-1563">,</span><span class="MJXp-mo" id="MJXp-Span-1564">:</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1571" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1572">(</span><span class="MJXp-mn" id="MJXp-Span-1573">2</span><span class="MJXp-mo" id="MJXp-Span-1574">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-77"> P(h_i^{(1)} = 1\mid \boldsymbol{v},\boldsymbol{h}^{(2)}) = \sigma (\boldsymbol{v}^\top\boldsymbol{W}_{:,i}^{(1)}+\boldsymbol{W}_{i,:}^{(2)}\boldsymbol{h}^{(2)}), \tag{20.27}</script></span><br>
và<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1577"><span class="MJXp-mtable" id="MJXp-Span-1578"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1579" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1580" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">P</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1586"><span class="MJXp-mo" id="MJXp-Span-1587">(</span><span class="MJXp-mn" id="MJXp-Span-1588">2</span><span class="MJXp-mo" id="MJXp-Span-1589">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1591">1</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1594" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1595" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1596">(</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-mo" id="MJXp-Span-1598">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">σ</span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1603"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1604" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1605" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1606">(</span><span class="MJXp-mn" id="MJXp-Span-1607">1</span><span class="MJXp-mo" id="MJXp-Span-1608">)</span><span class="MJXp-mi" id="MJXp-Span-1609">⊤</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1616"><span class="MJXp-mo" id="MJXp-Span-1617">(</span><span class="MJXp-mn" id="MJXp-Span-1618">2</span><span class="MJXp-mo" id="MJXp-Span-1619">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1612"><span class="MJXp-mo" id="MJXp-Span-1613">:</span><span class="MJXp-mo" id="MJXp-Span-1614">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-78"> P(h_k^{(2)} = 1\mid \boldsymbol{h}^{(1)}) = \sigma (\boldsymbol{h}^{(1)\top}\boldsymbol{W}_{:,k}^{(2)}). \tag{20.28}</script></span><br>
Cấu trúc hai nhánh giúp cho việc áp dụng phương pháp lấy mẫu Gibbs trong một máy Boltzmann đa tầng<s>sâu</s> trở nên hiệu quả. Cách tiếp cận đơn giản của phương pháp lấy mẫu Gibbs là cập nhật một biến mỗi lần. RBM cho phép tất cả các biến khả kiến được cập nhật trong một khối và tất cả các biến ẩn được cập nhật trong một khối thứ hai. Theo một cách đơn giản, chúng ta có thể giả thiết rằng một DBM với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1622"><span class="MJXp-mrow" id="MJXp-Span-1623"><span class="MJXp-mi undefined" id="MJXp-Span-1624">l</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-79-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-79">\mathit{l}</script></span> lớp cần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-mrow" id="MJXp-Span-1626"><span class="MJXp-mi undefined" id="MJXp-Span-1627">l</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-80-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-80">\mathit{l}</script></span> +1 lần cập nhật, với mỗi bước lặp thì một khối gồm một tầng các đơn vị được cập nhật. Theo một cách khác, việc cập nhật tất cả các đơn vị trong hai bước là có thể. Phương pháp lấy mẫu Gibbs có thể được chia thành hai khối cập nhật, một khối chứa các lớp chẵn (bao gồm cả lớp khả kiến) và khối còn lại chứa các lớp lẻ. Nhờ cách thức kết nối hai nhánh của DBM, nếu các lớp chẵn được biết, thì hàm phân phối của các lớp lẻ là có thể phân tích thành thừa số<s>tích của các hàm phân phối độc lập <em>(factorial)</em></s> và có thể được lấy mẫu đồng thời và độc lập theo một khối. Tương tự như vậy, nếu các lớp lẻ được biết, các lớp chẵn có thể được lấy mẫu đồng thời và độc lập theo một khối. Phương pháp lấy mẫu hiệu quả là đặc biệt quan trọng trong việc huấn luyện <s>với</s> thuật toán hợp lí <s>ước lượng khả năng</s> cực đại ngẫu nhiên.</p><h2 id="2041-Các-tính-chất-đáng-chú-ý"><a class="anchor hidden-xs" href="#2041-Các-tính-chất-đáng-chú-ý" title="2041-Các-tính-chất-đáng-chú-ý"><span class="octicon octicon-link"></span></a>20.4.1 Các tính chất đáng chú ý</h2><p>Máy Boltzman sâu có rất nhiều tính chất đáng chú ý.</p><p>DBM được phát triển dựa trên DBN. So với DBN, hàm phân phối hậu nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">P</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1631">h</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1633">v</span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-81-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-81">P(\boldsymbol{h}\mid\boldsymbol{v})</script></span> của DBM là đơn giản hơn. Mặc dù phản trực giác nhưng chính sự đơn giản của hàm phân phối hậu nghiệm này cho phép ước lượng hậu nghiệm phong phú hơn. Trong trường hợp DBN, chúng ta có thể phân loại bằng việc dùng một phương pháp suy diễn xấp xỉ dựa trên suy nghiệm, trong đó chúng ta đoán rằng một giá trị hợp lý cho trường trung bình kỳ vọng của các đơn vị ẩn có thể được cung cấp bởi một sự truyền lên qua mạng lưới trong một MLP sử dụng hàm kích hoạt sigmoid và cùng trọng số với hàm DBN ban đầu. <em>Bất kỳ</em> hàm phân phối nào cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">Q</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1639">h</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-82-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-82">*Q(\boldsymbol{h})*</script></span> đều có thể được sử dụng để đạt được một giới hạn biến phân dưới của logarit hàm hợp lý. Vì vậy, phương pháp suy nghiệm này  cho phép chúng ta thiết lập được một giới hạn như đã đề cập ở trên. Tuy vậy, giới hạn này không được tối ưu rõ ràng theo bất cứ cách nào, bởi vậy đây có thể là một giới hạn tương đối rộng. Cụ thể hơn, ước lượng suy nghiệm của <em>Q</em> bỏ qua tương tác giữa các đơn vị ẩn ở trong cùng một tầng cũng như tác động phản hồi từ trên xuống của các đơn vị ẩn ở các tầng sâu hơn với các đơn vị ẩn ở gần đầu vào. Chính bởi việc phương pháp suy diễn dựa trên MLP có tính suy nghiệm trong DBN <s>không thể giải thích được</s> bỏ qua những tương tác trên, kết quả của <em>Q</em> thường được coi là không tối ưu. Trong các DBM, tất cả các đơn vị ẩn trong một tầng đều là độc lập có điều kiện nếu các lớp khác được biết. Việc thiếu tương tác nội bộ trong các lớp này khiến việc dùng các phương trình định điểm để tối ưu giới hạn biến phân dưới và tìm các trường trung bình kỳ vọng là khả dĩ (trong một giới hạn tính toán chấp nhận được).</p><p>Việc sử dụng một trường trung bình thích hợp cho phép phương pháp suy diễn xấp xỉ của các DBM thu nạp được ảnh hưởng của các tương tác phản hồi từ trên xuống. Điều này khiến cho các DBM trở nên đáng chú ý trong lĩnh vực khoa học thần kinh, bởi bộ não người cũng sử dụng rất nhiều kết nối phản hồi từ trên xuống. Chính bởi tính chất này mà các DBM được sử dụng làm mô hình tính toán trong các hiện tượng thực của ngành khoa học thần kinh (Series et al, 2010; Reichert et al, 2011).</p><p>Một trong nhưng tính chất đáng tiếc của các DBM là việc lấy mẫu từ các DBM là tương đối khó. Các DBN chỉ cần sử dụng phương phấp lấy mẫu MCMC ở các cặp của các lớp trên cùng. Các lớp khác được sử dụng ở bước cuối trong lấy mẫu, bằng cách sử dụng một bước lấy mẫu di truyền. Để có thể lấy được một mẫu từ một DBM, phương pháp MCMC phải được áp dụng ở tất cả các lớp, với tất cả lớp của mô hình đều tham gia vào tất cả các biến đổi của chuỗi Markov.</p><h2 id="2042-Suy-Diễn-Trường-Trung-Bình-DBM"><a class="anchor hidden-xs" href="#2042-Suy-Diễn-Trường-Trung-Bình-DBM" title="2042-Suy-Diễn-Trường-Trung-Bình-DBM"><span class="octicon octicon-link"></span></a>20.4.2 Suy Diễn Trường Trung Bình DBM</h2><p>Hàm phân phối có điều kiện trên một tầng của DBM nếu các lớp lân cận được biết có thể phân tách thành thừa số của các hàm phân phối độc lập (<em>factorial</em>). Trong ví dụ DBM với hai lớp ẩn, những hàm này này là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">P</span><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1645">v</span><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1647"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1648" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1649" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1650">(</span><span class="MJXp-mn" id="MJXp-Span-1651">1</span><span class="MJXp-mo" id="MJXp-Span-1652">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-83-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-83">P(\boldsymbol{v}\mid\boldsymbol{h}^{(1)})</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">P</span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1657"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1658" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1659" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1660">(</span><span class="MJXp-mn" id="MJXp-Span-1661">1</span><span class="MJXp-mo" id="MJXp-Span-1662">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1664">v</span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1666"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1667" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1668" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1669">(</span><span class="MJXp-mn" id="MJXp-Span-1670">2</span><span class="MJXp-mo" id="MJXp-Span-1671">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-84-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-84">P(\boldsymbol{h}^{(1)}\mid\boldsymbol{v},\boldsymbol{h}^{(2)})</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">P</span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1677" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1678" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1679">(</span><span class="MJXp-mn" id="MJXp-Span-1680">2</span><span class="MJXp-mo" id="MJXp-Span-1681">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1683"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1684" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1685" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1686">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-85-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-85">P(\boldsymbol{h}^{(2)}\mid \boldsymbol{h}^{1})</script></span>. Hàm phân phối trên tất cả các lớp ẩn thường không thể phân tách thành <s>tích</s> thừa số của các hàm phân phối độc lập bởi sự tương tác giữa các lớp. Trong ví dụ DBM với hai lớp ẩn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">P</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1692" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1693" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1694">(</span><span class="MJXp-mn" id="MJXp-Span-1695">1</span><span class="MJXp-mo" id="MJXp-Span-1696">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-1698"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1699" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1700" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1701">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1703">v</span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-86-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-86">P(\boldsymbol{h}^{(1)}\mid\boldsymbol{h}^{2}\mid\boldsymbol{v})</script></span> không thể phân tách được bởi tồn tại ma trận trọng số tương tác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1705"><span class="MJXp-msubsup" id="MJXp-Span-1706"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1707" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1708" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1709">(</span><span class="MJXp-mn" id="MJXp-Span-1710">2</span><span class="MJXp-mo" id="MJXp-Span-1711">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-87-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-87">\boldsymbol{W}^{(2)}</script></span> giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1712"><span class="MJXp-msubsup" id="MJXp-Span-1713"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1714" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1715" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1716">(</span><span class="MJXp-mn" id="MJXp-Span-1717">1</span><span class="MJXp-mo" id="MJXp-Span-1718">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-88-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-88">\boldsymbol{h}^{(1)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1722" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1723">(</span><span class="MJXp-mn" id="MJXp-Span-1724">2</span><span class="MJXp-mo" id="MJXp-Span-1725">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-89-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-89">\boldsymbol{h}^{(2)}</script></span>, khiến cho những biến trên phụ thuộc lẫn nhau.</p><p>Tương tự như trong trường hợp với DBN, chúng ta phải tìm cách tính xấp xỉ hàm phân phối hậu nghiệm của DBM. Tuy nhiên khác với DBN, hàm phân phối hậu nghiệm trên các đơn vị ẩn của DBN - dù phức tạp - nhưng lại dễ dàng để tính xấp xỉ dựa trên phép xấp xỉ biển phân (như đã đề cập ở mục 19.4), đặc biệt với phép xấp xỉ trường trung bình. Phép xấp xỉ trường trung bình là một dạng đơn giản của suy diễn biến phân, trong đó chúng ta giới hạn rằng hàm phân phối đang được xấp xỉ được phân tách hoàn toàn thành <s>tích</s> thừa số của các phân phối độc lập. Đối với các DBM, các phương trình trường trung bình thu nạp được các tương tác hai chiều giữa các lớp. Trong phần này, chúng ta sẽ suy luận ra phương pháp suy diễn xấp xỉ lặp được đề ra trong Salakhutdinov và Hilton (2009a).</p><p>Trong các phép xấp xỉ biến phân nhằm mục đích suy diễn, chúng ta tiếp cận bằng cách ước lượng xấp xỉ một hàm phân phối mục tiêu nhất định - trong trường hợp của chúng ta, hàm phân phối hậu nghiệm <s>trên</s> của các tầng ẩn được ước lượng xấp xỉ bằng một họ hàm phân phối đơn giản ở mức tương đối nếu các đơn vị khả kiến đã được biết . Trong phép ước lượng xấp xỉ trường trung bình, họ hàm xấp xỉ này là tập hợp của các hàm phân phối mà các đơn vị ẩn là độc lập có điều kiện.</p><p>Sau đây chúng ta phát triển phương pháp trường trung bình với ví dụ hai tầng ẩn. Ký kiệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">Q</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1730" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1731" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1732">(</span><span class="MJXp-mn" id="MJXp-Span-1733">1</span><span class="MJXp-mo" id="MJXp-Span-1734">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1737" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1738" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1739">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1741">v</span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-90-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-90">Q(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v})</script></span> là ước lượng xấp xỉ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">P</span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1746"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1747" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1748" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1749">(</span><span class="MJXp-mn" id="MJXp-Span-1750">1</span><span class="MJXp-mo" id="MJXp-Span-1751">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1754" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1755" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1756">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1758">v</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-91-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-91">P(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v})</script></span>. Phương pháp xấp xỉ trường trung bình ám chỉ rằng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1760"><span class="MJXp-mtable" id="MJXp-Span-1761"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1762" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1763" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">Q</span><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1767" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1768" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1769">(</span><span class="MJXp-mn" id="MJXp-Span-1770">1</span><span class="MJXp-mo" id="MJXp-Span-1771">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1773"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1774" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1775" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1776">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1778">v</span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1781"><span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">Q</span><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1790"><span class="MJXp-mo" id="MJXp-Span-1791">(</span><span class="MJXp-mn" id="MJXp-Span-1792">1</span><span class="MJXp-mo" id="MJXp-Span-1793">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1795">v</span><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-1797"><span><span class="MJXp-mo" id="MJXp-Span-1798" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799" style="margin-left: 0px;">k</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">Q</span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1806"><span class="MJXp-mo" id="MJXp-Span-1807">(</span><span class="MJXp-mn" id="MJXp-Span-1808">2</span><span class="MJXp-mo" id="MJXp-Span-1809">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1810" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1811">v</span><span class="MJXp-mo" id="MJXp-Span-1812" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">Q(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v}) = \prod_j Q(h_{j}^{(1)}\mid\boldsymbol{v}) \prod_k Q(h_{k}^{(2)}\mid \boldsymbol{v}). \tag{20.29}</script></span><br>
Phép xấp xỉ trung bình hướng đến việc tìm một thành viên trong họ các hàm phân phối ở trên sao cho phù hợp nhất với phân phối hậu nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">P</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1817"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1818" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1819" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1820">(</span><span class="MJXp-mn" id="MJXp-Span-1821">1</span><span class="MJXp-mo" id="MJXp-Span-1822">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1824"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1825" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1826" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1827">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1829">v</span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-93-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-93">P(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v})</script></span>. Cần phải lưu ý rằng quá trình suy diễn cần phải được thực hiện lại để tìm hàm phân phối khác cho <em>Q</em> mỗi lần chúng ta dùng một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1831"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1832">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-94">\boldsymbol{v}</script></span> mới.</p><p>Có rất nhiều cách để đo lường độ tương hợp giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">Q</span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1836">h</span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1838">v</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">Q(\boldsymbol{h}\mid \boldsymbol{v})</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">P</span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1843">h</span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1845">v</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-96-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-96">P(\boldsymbol{h}\mid \boldsymbol{v})</script></span>. Phương pháp trường trung bình hướng đến việc tìm giá trị cực tiểu của<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1856"><span class="MJXp-mtable" id="MJXp-Span-1857"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1858" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1859" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">L</span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">Q</span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">P</span><span class="MJXp-mo" id="MJXp-Span-1866" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1868"><span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870" style="margin-left: 0px;">h</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">Q</span><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1873"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1874" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1875" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1876">(</span><span class="MJXp-mn" id="MJXp-Span-1877">1</span><span class="MJXp-mo" id="MJXp-Span-1878">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1880"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1881" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1882" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1883">(</span><span class="MJXp-mn" id="MJXp-Span-1884">2</span><span class="MJXp-mo" id="MJXp-Span-1885">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1887">v</span><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">g</span><span class="MJXp-mrow" id="MJXp-Span-1892"><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1894" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">Q</span><span class="MJXp-mo" id="MJXp-Span-1896" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1898" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1899" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1900">(</span><span class="MJXp-mn" id="MJXp-Span-1901">1</span><span class="MJXp-mo" id="MJXp-Span-1902">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1904"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1905" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1906" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1907">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1909">v</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">P</span><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1914" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1915" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1916">(</span><span class="MJXp-mn" id="MJXp-Span-1917">1</span><span class="MJXp-mo" id="MJXp-Span-1918">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1920"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1921" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1922" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1923">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1925">v</span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1928" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-97">KL(Q\|P) = \sum_h Q(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{(2)}\mid \boldsymbol{v})log\left(\frac{Q(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v})}{P(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{2}\mid \boldsymbol{v})}\right). \tag{20.30}</script></span><br>
Nhìn chung, chúng ta không cần phải đưa ra một dạng có tham số của hàm phân phối xấp xỉ, vượt quá việc tuân theo các giả định độc lập. Phương pháp xấp xỉ biến phân <s>thuông</s> thông thường có thể phục hồi một dạng hàm số của phân phối xấp xỉ. Tuy nhiên, trong trường hợp giả thuyết của trường trung bình đối với hai đơn vị ẩn (chính là trường hợp chúng ta đang phát triển), thì tính tổng quát không bị mất qua việc cố định trước một dạng có tham số cho mô hình.</p><p>Chúng ta tham số hoá Q như là tích số của các phân phối Bernoulli; nghĩa là chúng ta liên đới mỗi phần tử của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1929"><span class="MJXp-msubsup" id="MJXp-Span-1930"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1931" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1932" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1933">(</span><span class="MJXp-mn" id="MJXp-Span-1934">1</span><span class="MJXp-mo" id="MJXp-Span-1935">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol{h}^{(1)}</script></span> với một tham số. Cụ thể hơn, với mỗi j thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1936"><span class="MJXp-msubsup" id="MJXp-Span-1937"><span class="MJXp-mrow" id="MJXp-Span-1938" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1939"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1943"><span class="MJXp-mo" id="MJXp-Span-1944">(</span><span class="MJXp-mn" id="MJXp-Span-1945">1</span><span class="MJXp-mo" id="MJXp-Span-1946">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">Q</span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1953"><span class="MJXp-mo" id="MJXp-Span-1954">(</span><span class="MJXp-mn" id="MJXp-Span-1955">1</span><span class="MJXp-mo" id="MJXp-Span-1956">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1958">1</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1960">v</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">\hat{h}_j^{(1)} = Q(h_j^{(1)} = 1\mid\boldsymbol{v})</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1962"><span class="MJXp-msubsup" id="MJXp-Span-1963"><span class="MJXp-mrow" id="MJXp-Span-1964" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1965"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1969"><span class="MJXp-mo" id="MJXp-Span-1970">(</span><span class="MJXp-mn" id="MJXp-Span-1971">1</span><span class="MJXp-mo" id="MJXp-Span-1972">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1973" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1975">0</span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1977">1</span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\hat{h}_j^{(1)}\in [0,1]</script></span>, và với mỗi k thì thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1979"><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mrow" id="MJXp-Span-1981" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1982"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1984" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1986"><span class="MJXp-mo" id="MJXp-Span-1987">(</span><span class="MJXp-mn" id="MJXp-Span-1988">1</span><span class="MJXp-mo" id="MJXp-Span-1989">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">Q</span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1996"><span class="MJXp-mo" id="MJXp-Span-1997">(</span><span class="MJXp-mn" id="MJXp-Span-1998">1</span><span class="MJXp-mo" id="MJXp-Span-1999">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2000" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2001">1</span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2003">v</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">\hat{h}_k^{(1)} = Q(h_k^{(1)} = 1\mid\boldsymbol{v})</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-msubsup" id="MJXp-Span-2006"><span class="MJXp-mrow" id="MJXp-Span-2007" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2008"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2010" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2012"><span class="MJXp-mo" id="MJXp-Span-2013">(</span><span class="MJXp-mn" id="MJXp-Span-2014">1</span><span class="MJXp-mo" id="MJXp-Span-2015">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2018">0</span><span class="MJXp-mo" id="MJXp-Span-2019" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2020">1</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">\hat{h}_k^{(1)}\in [0,1]</script></span>. Bởi vậy chúng ta có ước lượng xấp xỉ sau cho hàm phân phối hậu nghiệm:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2022"><span class="MJXp-mtable" id="MJXp-Span-2023"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2024" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2025" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">Q</span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2028"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2029" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2030" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2031">(</span><span class="MJXp-mn" id="MJXp-Span-2032">1</span><span class="MJXp-mo" id="MJXp-Span-2033">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2035"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2036" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2037" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2038">(</span><span class="MJXp-mn" id="MJXp-Span-2039">2</span><span class="MJXp-mo" id="MJXp-Span-2040">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2041" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2042">v</span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2044" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2045"></span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-2047" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-2048"><span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">Q</span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2057"><span class="MJXp-mo" id="MJXp-Span-2058">(</span><span class="MJXp-mn" id="MJXp-Span-2059">1</span><span class="MJXp-mo" id="MJXp-Span-2060">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2062">v</span><span class="MJXp-mo" id="MJXp-Span-2063" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-2064"><span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066" style="margin-left: 0px;">k</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">Q</span><span class="MJXp-mo" id="MJXp-Span-2068" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2073"><span class="MJXp-mo" id="MJXp-Span-2074">(</span><span class="MJXp-mn" id="MJXp-Span-2075">2</span><span class="MJXp-mo" id="MJXp-Span-2076">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2077" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2078">v</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2080" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2081" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-2082" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2083"></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-2085" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-2086"><span><span class="MJXp-mo" id="MJXp-Span-2087" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2090"><span class="MJXp-mrow" id="MJXp-Span-2091" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2092"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2096"><span class="MJXp-mo" id="MJXp-Span-2097">(</span><span class="MJXp-mn" id="MJXp-Span-2098">1</span><span class="MJXp-mo" id="MJXp-Span-2099">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2100"><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2102" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2106"><span class="MJXp-mo" id="MJXp-Span-2107">(</span><span class="MJXp-mn" id="MJXp-Span-2108">1</span><span class="MJXp-mo" id="MJXp-Span-2109">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2111">1</span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mrow" id="MJXp-Span-2114" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2115"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2119"><span class="MJXp-mo" id="MJXp-Span-2120">(</span><span class="MJXp-mn" id="MJXp-Span-2121">1</span><span class="MJXp-mo" id="MJXp-Span-2122">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mo" id="MJXp-Span-2124" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2125" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2126">(</span><span class="MJXp-mn" id="MJXp-Span-2127">1</span><span class="MJXp-mo" id="MJXp-Span-2128">−</span><span class="MJXp-msubsup" id="MJXp-Span-2129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2132"><span class="MJXp-mo" id="MJXp-Span-2133">(</span><span class="MJXp-mn" id="MJXp-Span-2134">1</span><span class="MJXp-mo" id="MJXp-Span-2135">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2136">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-munderover" id="MJXp-Span-2138"><span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140" style="margin-left: 0px;">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2142"><span class="MJXp-mrow" id="MJXp-Span-2143" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2144"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2148"><span class="MJXp-mo" id="MJXp-Span-2149">(</span><span class="MJXp-mn" id="MJXp-Span-2150">1</span><span class="MJXp-mo" id="MJXp-Span-2151">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">k</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2152"><span class="MJXp-mo" id="MJXp-Span-2153" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2154" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2158"><span class="MJXp-mo" id="MJXp-Span-2159">(</span><span class="MJXp-mn" id="MJXp-Span-2160">1</span><span class="MJXp-mo" id="MJXp-Span-2161">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">k</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2163">1</span><span class="MJXp-mo" id="MJXp-Span-2164" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2165"><span class="MJXp-mrow" id="MJXp-Span-2166" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2167"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2171"><span class="MJXp-mo" id="MJXp-Span-2172">(</span><span class="MJXp-mn" id="MJXp-Span-2173">2</span><span class="MJXp-mo" id="MJXp-Span-2174">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">k</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2175"><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2177" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2178">(</span><span class="MJXp-mn" id="MJXp-Span-2179">1</span><span class="MJXp-mo" id="MJXp-Span-2180">−</span><span class="MJXp-msubsup" id="MJXp-Span-2181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2184"><span class="MJXp-mo" id="MJXp-Span-2185">(</span><span class="MJXp-mn" id="MJXp-Span-2186">2</span><span class="MJXp-mo" id="MJXp-Span-2187">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2188">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-103">\begin{eqnarray}Q(\boldsymbol{h}^{(1)}, \boldsymbol{h}^{(2)}\mid \boldsymbol{v}) &=& \prod_j Q(h_{j}^{(1)}\mid\boldsymbol{v}) \prod_k Q(h_{k}^{(2)}\mid \boldsymbol{v}) \tag{20.31}\\
&=& \prod_j (\hat{h}_j^{(1)})^{h_j^{(1)}}(1-\hat{h}_j^{(1)})^{(1-h_j^{(1)})} \times \prod_k (\hat{h}_k^{(1)})^{h_k^{(1)}}(1-\hat{h}_k^{(2)})^{(1-h_k^{(2)})}.\tag{20.32}\\
\end{eqnarray}</script></span><br>
Tất nhiên với các DBM có nhiều lớp, việc <s>cố định</s> tham số hoá cho hậu nghiệm xấp xỉ có thể được mở rộng theo cách hiển nhiên, lợi dụng cấu trúc phân hai nhánh của đồ thị <em>(bipartite structure of the graph)</em> để cập nhật tất cả các lớp chẵn một cách đồng thời và sau đó cập nhật tất cả các lớp lẻ đồng thời, <s>dựa theo</s> <s>chu trình lấy mẫu</s> tương tự các bước của phương pháp lấy mẫu Gibbs.</p><p>Sau khi chúng ta đã xác định được họ của hàm phân phối xấp xỉ <em>Q</em>, việc còn lại là xác định một quy trình để chọn <s>các</s> một thành viên trong họ này phù hợp nhất với <em>P</em>. Cách <s>trực tiếp</s>dễ dàng nhất là sử dụng phương trình miền trung bình ở phương trình \19.56. Những phương trình trên được suy ra bằng cách giải phương trình khi đạo hàm của giới hạn biến phân dưới bằng 0. Những phương trình trên diễn tả một cách trừu tượng phương thức tối ưu giới hạn biến phân dưới cho bất kỳ mô hình nào, đơn giản bằng cách lấy giá trị kỳ vọng <s>với</s> của <em>Q</em>.</p><p>Áp dụng phương trình chung trên, chúng ta có những điều kiện cập nhật sau (bỏ qua các <s>độ chệch</s> hệ số tự do):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2190"><span class="MJXp-mtable" id="MJXp-Span-2191"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2192" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2193" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-2194"><span class="MJXp-mrow" id="MJXp-Span-2195" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2196"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2198" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2200"><span class="MJXp-mo" id="MJXp-Span-2201">(</span><span class="MJXp-mn" id="MJXp-Span-2202">1</span><span class="MJXp-mo" id="MJXp-Span-2203">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">j</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2204" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2205"></span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-2207" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">σ</span><span class="MJXp-mrow" id="MJXp-Span-2209"><span class="MJXp-mo" id="MJXp-Span-2210" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-2211"><span><span class="MJXp-mo" id="MJXp-Span-2212" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2216" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-2217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2223"><span class="MJXp-mo" id="MJXp-Span-2224">(</span><span class="MJXp-mn" id="MJXp-Span-2225">1</span><span class="MJXp-mo" id="MJXp-Span-2226">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">i</span><span class="MJXp-mo" id="MJXp-Span-2221">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2227" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2228"><span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2230" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2233" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2242"><span class="MJXp-mo" id="MJXp-Span-2243">(</span><span class="MJXp-mn" id="MJXp-Span-2244">2</span><span class="MJXp-mo" id="MJXp-Span-2245">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">j</span><span class="MJXp-mo" id="MJXp-Span-2238">,</span><span class="MJXp-msup" id="MJXp-Span-2239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2241" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2246"><span class="MJXp-mrow" id="MJXp-Span-2247" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2248"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2255"><span class="MJXp-mo" id="MJXp-Span-2256">(</span><span class="MJXp-mn" id="MJXp-Span-2257">2</span><span class="MJXp-mo" id="MJXp-Span-2258">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2251"><span class="MJXp-msup" id="MJXp-Span-2252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2254" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2259" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-2261">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">j</span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0.222em;">,</span></span><span class="MJXp-mtd" id="MJXp-Span-2264" style="padding-left: 0.278em; text-align: left;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-2265" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2266" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-2267"><span class="MJXp-mrow" id="MJXp-Span-2268" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2269"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2273"><span class="MJXp-mo" id="MJXp-Span-2274">(</span><span class="MJXp-mn" id="MJXp-Span-2275">2</span><span class="MJXp-mo" id="MJXp-Span-2276">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272">k</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2277" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-2278"></span><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-2280" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">σ</span><span class="MJXp-mrow" id="MJXp-Span-2282"><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-2284"><span><span class="MJXp-mo" id="MJXp-Span-2285" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2286" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2289" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2298"><span class="MJXp-mo" id="MJXp-Span-2299">(</span><span class="MJXp-mn" id="MJXp-Span-2300">2</span><span class="MJXp-mo" id="MJXp-Span-2301">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2292"><span class="MJXp-msup" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2295" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2296">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">k</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2302"><span class="MJXp-mrow" id="MJXp-Span-2303" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2304"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2311"><span class="MJXp-mo" id="MJXp-Span-2312">(</span><span class="MJXp-mn" id="MJXp-Span-2313">1</span><span class="MJXp-mo" id="MJXp-Span-2314">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2307"><span class="MJXp-msup" id="MJXp-Span-2308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2310" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.764em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.058em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-2317">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318">k</span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0em; margin-right: 0.222em;">,</span></span><span class="MJXp-mtd" id="MJXp-Span-2320" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-104">\begin{eqnarray}\hat{h}_j^{(1)} &=& \sigma \left( \sum_i v_i W_{i,j}^{(1)} + \sum_{k'} W_{j, k'}^{(2)}\hat{h}_{k'}^{(2)} \right), \forall j, &\tag{20.33}\\
\hat{h}_k^{(2)} &=& \sigma \left(\sum_{j'} W_{j', k}^{(2)}\hat{h}_{j'}^{(1)} \right), \forall k, &\tag{20.34}\\
\end{eqnarray}</script></span><br>
Tại một điểm cố định của hệ thống các phương trình trên, chúng ta có cực đại địa phương của cận dưới biến phân <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2321"><span class="MJXp-mrow" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2323">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">\mathcal{L}</script></span>(Q)</em>. Bởi vậy các phương trình cập nhật <s>dựa trên</s> của điểm cố định trên định nghĩa một thuật toán lặp trong đó chúng ta luân phiên cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2324"><span class="MJXp-msubsup" id="MJXp-Span-2325"><span class="MJXp-mrow" id="MJXp-Span-2326" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2327"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2331"><span class="MJXp-mo" id="MJXp-Span-2332">(</span><span class="MJXp-mn" id="MJXp-Span-2333">1</span><span class="MJXp-mo" id="MJXp-Span-2334">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330">j</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\hat{h}_j^{(1)}</script></span> (sử dụng phương trình 20.33) và cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2335"><span class="MJXp-msubsup" id="MJXp-Span-2336"><span class="MJXp-mrow" id="MJXp-Span-2337" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2338"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2342"><span class="MJXp-mo" id="MJXp-Span-2343">(</span><span class="MJXp-mn" id="MJXp-Span-2344">2</span><span class="MJXp-mo" id="MJXp-Span-2345">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">k</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">\hat{h}_k^{(2)}</script></span> (sử dụng phương trình 20.34). Đối với bài toán<s>vấn đề</s> nhỏ như dữ liệu MNIST, thường khoảng tầm mười phép lặp là đủ để tìm được một giá trị gradient <s>dương</s> xấp xỉ của pha dương <em>(approximate positive phase gradient)</em> cho việc học, và 50 phép lặp thường là đủ để đạt được một hình mẫu của một ví dụ cụ thể được sử dụng trong việc phân loại với độ chính xác cao. Mở rộng phương pháp suy diễn biến phân cho những DBM <s>sâu</s> đa tầng <s>hơn</s> là không phức tạp.<br>
-------------------------------------------------------<br>
\ Killi hoàn thành ở 665<br>
--------------------------------------------------------</p><p>---------------------------------------------------------------------------<br>
\ Hoà bắt đầu dịch từ trang 666</p><h2 id="2043-Quá-trình-học-các-tham-số-của-máy-Boltzman-đa-tầngsâu-DBM"><a class="anchor hidden-xs" href="#2043-Quá-trình-học-các-tham-số-của-máy-Boltzman-đa-tầngsâu-DBM" title="2043-Quá-trình-học-các-tham-số-của-máy-Boltzman-đa-tầngsâu-DBM"><span class="octicon octicon-link"></span></a>20.4.3. Quá trình học các tham số của máy Boltzman đa tầng<s>sâu</s> (DBM)</h2><p>Việc học <s>ở máy Boltzmann sâu <s>tầngg của DBM</s>(<em>deep Boltzmann machine</em>)</s> phải giải quyết được cả 2 thách thức: hàm phân hoạch có chi phí tính toán lớn (sử dụng các kỹ thuật ở chương 18) và phân phối hậu nghiệm có chi phí tính toán lớn (sử dụng các kỹ thuật ở chương 19).<br>
Như được mô tả ở phần 20.4.2, suy diễn biến phân (<em>variational inference</em>) cho phép xây dựng một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">Q</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2349">h</span><span class="MJXp-mspace" id="MJXp-Span-2350" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2351"><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2353" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2354">v</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">Q(\boldsymbol{h}\,|\,\boldsymbol{v})</script></span> mà<s>sao cho</s> xấp xỉ phân phối có chi phí tính toán lớn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">P</span><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2359">h</span><span class="MJXp-mspace" id="MJXp-Span-2360" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-2361"><span class="MJXp-mo" id="MJXp-Span-2362" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-2363" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2364">v</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">P(\boldsymbol{h}\,|\,\boldsymbol{v})</script></span>. Việc học được tiến hành bằng cách cực đại hoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2366"><span class="MJXp-mrow" id="MJXp-Span-2367"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2368">L</span></span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2370">v</span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">Q</span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2374">θ</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\mathcal{L}(\boldsymbol{v},Q,\boldsymbol{\theta})</script></span>, tức là giới hạn dưới biến phân <s>đổi</s> trên logarit của hàm hợp lý có chi phí tính toán lớn, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mi" id="MJXp-Span-2377">log</span><span class="MJXp-mspace" id="MJXp-Span-2378" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">P</span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2381">v</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2383">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">\log\, P(\boldsymbol{v};\boldsymbol{\theta}</script></span>).<br>
Đối với một máy Boltzmann <s>sâu</s>đa tầng có 2 lớp,  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2384"><span class="MJXp-mrow" id="MJXp-Span-2385"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2386">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-112-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-112">\mathcal{L}</script></span> được định nghĩa:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2387"><span class="MJXp-mrow" id="MJXp-Span-2388"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2389">L</span></span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">Q</span><span class="MJXp-mo" id="MJXp-Span-2392" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2393">θ</span><span class="MJXp-mo" id="MJXp-Span-2394" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2396"><span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2398" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">i</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2400"><span><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2402" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2405" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2408" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2418"><span class="MJXp-mo" id="MJXp-Span-2419">(</span><span class="MJXp-mn" id="MJXp-Span-2420">1</span><span class="MJXp-mo" id="MJXp-Span-2421">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">i</span><span class="MJXp-mo" id="MJXp-Span-2414">,</span><span class="MJXp-msup" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2417" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2422"><span class="MJXp-mrow" id="MJXp-Span-2423" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2424"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2431"><span class="MJXp-mo" id="MJXp-Span-2432">(</span><span class="MJXp-mn" id="MJXp-Span-2433">1</span><span class="MJXp-mo" id="MJXp-Span-2434">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2427"><span class="MJXp-msup" id="MJXp-Span-2428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2430" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2435" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-2436"><span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2438" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2441" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2442"><span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2444" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2447" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2448"><span class="MJXp-mrow" id="MJXp-Span-2449" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2450"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-mo" id="MJXp-Span-2458">(</span><span class="MJXp-mn" id="MJXp-Span-2459">1</span><span class="MJXp-mo" id="MJXp-Span-2460">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2453"><span class="MJXp-msup" id="MJXp-Span-2454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2456" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2471"><span class="MJXp-mo" id="MJXp-Span-2472">(</span><span class="MJXp-mn" id="MJXp-Span-2473">2</span><span class="MJXp-mo" id="MJXp-Span-2474">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2463"><span class="MJXp-msup" id="MJXp-Span-2464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465" style="margin-right: 0.05em;">j</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2466" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2467">,</span><span class="MJXp-msup" id="MJXp-Span-2468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2470" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2475"><span class="MJXp-mrow" id="MJXp-Span-2476" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2477"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2479" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">h</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2484"><span class="MJXp-mo" id="MJXp-Span-2485">(</span><span class="MJXp-mn" id="MJXp-Span-2486">2</span><span class="MJXp-mo" id="MJXp-Span-2487">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2480"><span class="MJXp-msup" id="MJXp-Span-2481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482" style="margin-right: 0.05em;">k</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2483" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-2489">log</span><span class="MJXp-mspace" id="MJXp-Span-2490" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491">Z</span><span class="MJXp-mo" id="MJXp-Span-2492" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2493">θ</span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2496"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2497">H</span></span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499">Q</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-2502" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2504">20.35</span><span class="MJXp-mo" id="MJXp-Span-2505" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">\mathcal{L}(Q,\boldsymbol{\theta})=\sum\limits_{i}\sum\limits_{j'}v_{i}W_{i,j'}^{(1)}\hat{h}_{j'}^{(1)}+\sum\limits_{j'}\sum\limits_{k'}\hat{h}_{j'}^{(1)}W_{j',k'}^{(2)}\hat{h}_{k'}^{(2)}-\log\,Z(\boldsymbol{\theta})+\mathcal{H}(Q). \qquad (20.35)</script></span><br>
Biểu thức này vẫn chứa logarit của hàm phân hoạch, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2506"><span class="MJXp-mi" id="MJXp-Span-2507">log</span><span class="MJXp-mspace" id="MJXp-Span-2508" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">Z</span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2511">θ</span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">\log\,Z(\boldsymbol{\theta})</script></span>. Vì một máy Boltzmann <s>sâu</s> đa tầng chứa các thành phần là các máy Boltzmann hạn chế (<em>restricted Boltzmann machine</em>) nên các kết quả  quan trọng cho việc tính toán hàm phân hoạch và lấy mẫu trong các máy Boltzmann <s>giới</s> hạn chế cũng được <s>ứng</s> áp dụng <s>trong</s>cho máy Boltzmann <s>sâu</s> đa tầng. Điều này có nghĩa việc tính toán hàm khối xác suất (<em>probability mass function</em>) của một máy Boltzmann cần một phương pháp xấp xỉ, chẳng hạn như phương pháp <s>ủ</s> lấy mẫu theo độ quan trọng (<em>annealed importance sampling</em>). Tương tự như vậy, việc huấn luyện mô hình cần xấp xỉ gradient của logarit hàm phân hoạch. Xem mô tả chung về các phương pháp này trong chương 18. <s>Máy Boltzmann sâu</s> Các DBM thường được huấn luyện sử dụng phương pháp hợp lý cực đại ngẫu nhiên (<em>stochastic maximum likelihood</em>). Nhiều kỹ thuật được mô tả trong chương 18 không có tính ứng dụng. Các kỹ thuật như hợp lý giả (<em>pseudolikelihood</em>) đòi hỏi khả năng tính toán các xác suất chưa được chuẩn hoá chứ không chỉ đơn thuần sẽ đạt được giới hạn dưới biến đổi (<em>variational lower bound</em>) dựa trên các kỹ thuật đó.Phương pháp phân kỳ tương phản (<em>contrasive divergence</em>) hoạt động chậm cho máy Boltzman sâu vì chúng không cho phép lấy mẫu một cách hiệu quả cho các đơn <s>vị ẩn mà thay vào đó là</s>nếu biết trước các đơn vị khả kiến, phương pháp phân kỳ tương phản đòi hỏi <s>đốt mẫu</s> phương pháp loại bỏ trong chuỗi Markov mỗi khi cần một mẫu mới cho pha âm.<br>
Phiên bản bất biến phân<s>đổi</s> của thuật toán hợp lý cực đại ngầu nhiên được thảo luận trong phần 18.2. Hợp lý cực đại ngẫu nhiên biến <s>đổi</s> phân được <s>ứng chung</s> dùng cho DBM được trình bày ở thuật toán 20.1. Lưu ý chúng ta đang mô tả một biến thể đơn giản của DBM trong đó thiếu đi tham số~~ điều chỉnh~~ tự do, <s>bao gồm cả việc chúng không đáng kể</s> thêm các tham số tự do này vào không tạo ra nhiều sự khác biệt.</p><h2 id="2044-Tiền-huấn-luyện-theo-lớp"><a class="anchor hidden-xs" href="#2044-Tiền-huấn-luyện-theo-lớp" title="2044-Tiền-huấn-luyện-theo-lớp"><span class="octicon octicon-link"></span></a>20.4.4. Tiền huấn luyện theo lớp</h2><p>Thật không may là việc huấn luyện một DBM với hợp lý cực đại ngẫu nhiên (đã được mô tả ở trên) từ việc khởi tạo ngẫu nhiên thường dẫn đến thất bại. Trong vài trường hợp, mô hình thất bại trong việc học <s>sao cho đại diện</s>để biểu diễn phân phối một cách đầy đủ. Trong các trường hợp khác, DBM có thể biểu diễn tốt <s>đại diện tốt cho</s> phân phối nhưng <s>khả năng không cao</s>hàm hợp lí không tốt hơn so với việc chỉ sử dụng một RBM. Một DBM với tất cả các trọng số rất bé nhưng lớp đầu tiên <s>đại diện</s> biểu diễn <s>xấp xỉ</s> <s>cho</s> phân phối gần giống với một RBM.<br>
Các kỹ thuật khác nhau cho phép việc huấn luyện đồng thời đã được phát triển và được mô tả trong phần 20.4.5. Tuy nhiên, phương pháp đầu tiên và phổ biến nhất để giải quyết <s>vấn đề</s>bài toán huấn luyện đồng thời là tiền huấn luyện hoàn thiện theo từng lớp. Trong phương pháp này, mỗi lớp của DBM được huấn luyện độc <s>cô</s> lập như một RBM. Lớp đầu tiên được huấn luyện để mô hình hoá dữ liệu đầu vào. Mỗi RBM tiếp theo được huấn luyện <s>với</s>để mô hình hoá các mẫu từ phân phối hậu nghiệm của RBM trước đó. Sau khi tất cả các RBM được huấn luyện bằng cách này, chúng có thể được kết hợp để hình thành nên một DBM. DBM này có thể được huấn luyện với PCD. Thông thường huấn luyện PCD chỉ tạo nên một thay đổi nhỏ trong các tham số của mô hình và hiệu suất của nó được tính toán bằng lograit của hàm hợp lý khi PCD được áp dụng vào <s>nó chuyển</s> dữ liệu đến hoặc khả năng phân loại đầu vào của nó. Xem mô tả quy trình huấn luyện trên hình 20.4.</p><blockquote>
<p><strong>Thuật toán 20.1</strong> Thuật toán hợp lý cực đại ngẫu nhiên biến phân <s>đổi</s> để huấn luyện một DBM với 2 lớp ẩn</p>
<blockquote>
<p>Gán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">\epsilon</script></span>, số <s>kích thước</s> bước nhảy, với một số dương nhỏ<br>
Gán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2515"><span class="MJXp-mrow" id="MJXp-Span-2516"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2517">k</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">\mathcal{k}</script></span>, số bước nhảy Gibbs, đủ lớn để cho phép  một chuỗi Markov <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">p</span><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2521">v</span><span class="MJXp-mo" id="MJXp-Span-2522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2523" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2526" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2527">(</span><span class="MJXp-mn" id="MJXp-Span-2528">1</span><span class="MJXp-mo" id="MJXp-Span-2529">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2530" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2531" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2534" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2535">(</span><span class="MJXp-mn" id="MJXp-Span-2536">2</span><span class="MJXp-mo" id="MJXp-Span-2537">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mspace" id="MJXp-Span-2539" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">θ</span><span class="MJXp-mo" id="MJXp-Span-2541" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mi" id="MJXp-Span-2544" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2545" style="vertical-align: -0.4em;"><span class="MJXp-mi" id="MJXp-Span-2546">Θ</span></span></span><span class="MJXp-mo" id="MJXp-Span-2547" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">p(\boldsymbol{v},\,h^{(1)},\,h^{(2)};\,\theta+\epsilon\Delta_{\Theta})</script></span> đốt mẫu, bắt đầu từ mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">p</span><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2551">v</span><span class="MJXp-mo" id="MJXp-Span-2552" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2553" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2556" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2557">(</span><span class="MJXp-mn" id="MJXp-Span-2558">1</span><span class="MJXp-mo" id="MJXp-Span-2559">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2560" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2561" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2564" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2565">(</span><span class="MJXp-mn" id="MJXp-Span-2566">2</span><span class="MJXp-mo" id="MJXp-Span-2567">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mspace" id="MJXp-Span-2569" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">θ</span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">p(\boldsymbol{v},\,h^{(1)},\,h^{(2)};\,\theta)</script></span>.<br>
Khởi tạo 3 ma trận, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2572"><span class="MJXp-mrow" id="MJXp-Span-2573"><span class="MJXp-munderover" id="MJXp-Span-2574"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2575">V</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">\tilde{\boldsymbol{V}}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2577"><span class="MJXp-msubsup" id="MJXp-Span-2578"><span class="MJXp-mrow" id="MJXp-Span-2579" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2580"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2582" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2581">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2583" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2584">(</span><span class="MJXp-mn" id="MJXp-Span-2585">1</span><span class="MJXp-mo" id="MJXp-Span-2586">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">\tilde{\boldsymbol{H}}^{(1)}</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2587"><span class="MJXp-msubsup" id="MJXp-Span-2588"><span class="MJXp-mrow" id="MJXp-Span-2589" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2590"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2591">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2593" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2594">(</span><span class="MJXp-mn" id="MJXp-Span-2595">2</span><span class="MJXp-mo" id="MJXp-Span-2596">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-121-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-121">\tilde{\boldsymbol{H}}^{(2)}</script></span>, mỗi ma trận có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">m</script></span> hàng được gán với các giá trị ngẫu nhiên (ví dụ từ phân phối Bernoulli, có thể với các giá trị cận biên phù hợp với các cận biên của mô hình).<br>
<strong>while</strong> chưa hội tụ (vòng lặp học) <strong>do</strong></p>
</blockquote>
<blockquote>
<blockquote>
<p>Lấy một mẫu nhỏ gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600">m</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-123-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-123">m</script></span> mẫu từ dữ liệu huấn luyện và sắp xếp chúng thành các hàng của ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2601"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2602">V</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">\boldsymbol{V}</script></span>.<br>
Khởi tạo ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2603"><span class="MJXp-msubsup" id="MJXp-Span-2604"><span class="MJXp-mrow" id="MJXp-Span-2605" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2606"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2608" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2607">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2609" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2610">(</span><span class="MJXp-mn" id="MJXp-Span-2611">1</span><span class="MJXp-mo" id="MJXp-Span-2612">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">\hat{\boldsymbol{H}}^{(1)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2613"><span class="MJXp-msubsup" id="MJXp-Span-2614"><span class="MJXp-mrow" id="MJXp-Span-2615" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2616"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2618" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2617">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2619" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2620">(</span><span class="MJXp-mn" id="MJXp-Span-2621">2</span><span class="MJXp-mo" id="MJXp-Span-2622">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">\hat{\boldsymbol{H}}^{(2)}</script></span> , có thể đến cận biên của mô hình.<br>
<strong>while</strong> chưa hội tụ (vòng lặp suy diễn trường trung bình, <em>mean field inference loop</em>) <strong>do</strong></p>
<blockquote>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2660"><span class="MJXp-msubsup" id="MJXp-Span-2661"><span class="MJXp-mrow" id="MJXp-Span-2662" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2663"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2665" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2664">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2666" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2667">(</span><span class="MJXp-mn" id="MJXp-Span-2668">1</span><span class="MJXp-mo" id="MJXp-Span-2669">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">σ</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2673">V</span><span class="MJXp-msubsup" id="MJXp-Span-2674"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2675" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2676" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2677">(</span><span class="MJXp-mn" id="MJXp-Span-2678">1</span><span class="MJXp-mo" id="MJXp-Span-2679">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2680" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2681"><span class="MJXp-mrow" id="MJXp-Span-2682" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2683"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2685" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2684">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2686" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2687">(</span><span class="MJXp-mn" id="MJXp-Span-2688">2</span><span class="MJXp-mo" id="MJXp-Span-2689">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2690"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2691" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2692" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2693">(</span><span class="MJXp-mn" id="MJXp-Span-2694">2</span><span class="MJXp-mo" id="MJXp-Span-2695">)</span><span class="MJXp-mo" id="MJXp-Span-2696">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-2697" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">\hat{\boldsymbol{H}}^{(1)} \leftarrow \sigma(\boldsymbol{V}\boldsymbol{W}^{(1)}+\hat{\boldsymbol{H}}^{(2)}\boldsymbol{W}^{(2)\intercal})</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2698"><span class="MJXp-msubsup" id="MJXp-Span-2699"><span class="MJXp-mrow" id="MJXp-Span-2700" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2701"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2702">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2704" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2705">(</span><span class="MJXp-mn" id="MJXp-Span-2706">2</span><span class="MJXp-mo" id="MJXp-Span-2707">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">σ</span><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2711"><span class="MJXp-mrow" id="MJXp-Span-2712" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2713"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2715" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2714">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2716" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2717">(</span><span class="MJXp-mn" id="MJXp-Span-2718">1</span><span class="MJXp-mo" id="MJXp-Span-2719">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2720"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2721" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2722" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2723">(</span><span class="MJXp-mn" id="MJXp-Span-2724">2</span><span class="MJXp-mo" id="MJXp-Span-2725">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">\hat{\boldsymbol{H}}^{(2)} \leftarrow \sigma(\hat{\boldsymbol{H}}^{(1)}\boldsymbol{W}^{(2)})</script></span>.</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote><blockquote>
<blockquote>
<blockquote>
<p><strong>end while</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-msubsup" id="MJXp-Span-2728"><span class="MJXp-mi" id="MJXp-Span-2729" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2730" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2731"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2732" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2733" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2734">(</span><span class="MJXp-mn" id="MJXp-Span-2735">1</span><span class="MJXp-mo" id="MJXp-Span-2736">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2737" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-2738" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2739">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2742" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2743" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2744">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2745"><span class="MJXp-mrow" id="MJXp-Span-2746" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2747"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2748">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2750" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2751">(</span><span class="MJXp-mn" id="MJXp-Span-2752">1</span><span class="MJXp-mo" id="MJXp-Span-2753">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">\Delta_{\boldsymbol{W}^{(1)}} \leftarrow \frac{1}{m}\boldsymbol{V}^{\intercal}\hat{\boldsymbol{H}}^{(1)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2754"><span class="MJXp-msubsup" id="MJXp-Span-2755"><span class="MJXp-mi" id="MJXp-Span-2756" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2757" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2759" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2760" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2761">(</span><span class="MJXp-mn" id="MJXp-Span-2762">2</span><span class="MJXp-mo" id="MJXp-Span-2763">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2764" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-2765" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2766">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2768"><span class="MJXp-mrow" id="MJXp-Span-2769" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2770"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2771">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2773" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2774">(</span><span class="MJXp-mn" id="MJXp-Span-2775">1</span><span class="MJXp-mo" id="MJXp-Span-2776">)</span><span class="MJXp-mo" id="MJXp-Span-2777">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2778"><span class="MJXp-mrow" id="MJXp-Span-2779" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2780"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2782" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2781">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2783" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-2784">(</span><span class="MJXp-mn" id="MJXp-Span-2785">2</span><span class="MJXp-mo" id="MJXp-Span-2786">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\Delta_{\boldsymbol{W}^{(2)}} \leftarrow \frac{1}{m}\hat{\boldsymbol{H}}^{(1) \intercal}\hat{\boldsymbol{H}}^{(2)}</script></span><br>
<strong>for</strong> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788">l</span><span class="MJXp-mo" id="MJXp-Span-2789" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2790">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">l=1</script></span> to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">k</script></span> (lấy mẫu Gibbs) <strong>do</strong></p>
<blockquote>
<p>Khối Gibbs 1:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2793"><span class="MJXp-mi" id="MJXp-Span-2794">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795">i</span><span class="MJXp-mo" id="MJXp-Span-2796" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797">j</span><span class="MJXp-mo" id="MJXp-Span-2798" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2799"><span class="MJXp-mrow" id="MJXp-Span-2800" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2801"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2803" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2802">V</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2804" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805">i</span><span class="MJXp-mo" id="MJXp-Span-2806">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807">j</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">\forall i,j,\tilde{V}_{i,j}</script></span> được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809">P</span><span class="MJXp-mo" id="MJXp-Span-2810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2811"><span class="MJXp-mrow" id="MJXp-Span-2812" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2813"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2815" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">V</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2816" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817">i</span><span class="MJXp-mo" id="MJXp-Span-2818">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2820" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2821">1</span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824">σ</span><span class="MJXp-mo" id="MJXp-Span-2825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2827" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2832"><span class="MJXp-mo" id="MJXp-Span-2833">(</span><span class="MJXp-mn" id="MJXp-Span-2834">1</span><span class="MJXp-mo" id="MJXp-Span-2835">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829">j</span><span class="MJXp-mo" id="MJXp-Span-2830">,</span><span class="MJXp-mo" id="MJXp-Span-2831">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2837"><span class="MJXp-mrow" id="MJXp-Span-2838" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2839"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2840">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2846"><span class="MJXp-mo" id="MJXp-Span-2847">(</span><span class="MJXp-mn" id="MJXp-Span-2848">1</span><span class="MJXp-mo" id="MJXp-Span-2849">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843">i</span><span class="MJXp-mo" id="MJXp-Span-2844">,</span><span class="MJXp-mo" id="MJXp-Span-2845">:</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2850"><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2852" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2853">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-2854" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2855" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">P(\tilde{V}_{i,j}=1)=\sigma(\boldsymbol{W}_{j,:}^{(1)}(\tilde{\boldsymbol{H}}_{i,:}^{(1)})^{\intercal}).</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2856"><span class="MJXp-mi" id="MJXp-Span-2857">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858">i</span><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860">j</span><span class="MJXp-mo" id="MJXp-Span-2861" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2862"><span class="MJXp-mrow" id="MJXp-Span-2863" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2864"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2866" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2865">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2871"><span class="MJXp-mo" id="MJXp-Span-2872">(</span><span class="MJXp-mn" id="MJXp-Span-2873">2</span><span class="MJXp-mo" id="MJXp-Span-2874">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">i</span><span class="MJXp-mo" id="MJXp-Span-2869">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">j</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">\forall i,j,\tilde{H}_{i,j}^{(2)}</script></span> được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">P</span><span class="MJXp-mo" id="MJXp-Span-2877" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2878"><span class="MJXp-mrow" id="MJXp-Span-2879" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2880"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2882" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2881">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2887"><span class="MJXp-mo" id="MJXp-Span-2888">(</span><span class="MJXp-mn" id="MJXp-Span-2889">2</span><span class="MJXp-mo" id="MJXp-Span-2890">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884">i</span><span class="MJXp-mo" id="MJXp-Span-2885">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2892">1</span><span class="MJXp-mo" id="MJXp-Span-2893" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895">σ</span><span class="MJXp-mo" id="MJXp-Span-2896" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2897"><span class="MJXp-mrow" id="MJXp-Span-2898" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2899"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2901" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2900">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2906"><span class="MJXp-mo" id="MJXp-Span-2907">(</span><span class="MJXp-mn" id="MJXp-Span-2908">1</span><span class="MJXp-mo" id="MJXp-Span-2909">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2903">i</span><span class="MJXp-mo" id="MJXp-Span-2904">,</span><span class="MJXp-mo" id="MJXp-Span-2905">:</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2910"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2911" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2916"><span class="MJXp-mo" id="MJXp-Span-2917">(</span><span class="MJXp-mn" id="MJXp-Span-2918">2</span><span class="MJXp-mo" id="MJXp-Span-2919">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2912"><span class="MJXp-mo" id="MJXp-Span-2913">:</span><span class="MJXp-mo" id="MJXp-Span-2914">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2920" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2921" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">P(\tilde{H}_{i,j}^{(2)}=1)=\sigma(\tilde{\boldsymbol{H}}_{i,:}^{(1)}\boldsymbol{W}_{:,j}^{(2)}).</script></span><br>
Khối Gibbs 2:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2922"><span class="MJXp-mi" id="MJXp-Span-2923">∀</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">i</span><span class="MJXp-mo" id="MJXp-Span-2925" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">j</span><span class="MJXp-mo" id="MJXp-Span-2927" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2928"><span class="MJXp-mrow" id="MJXp-Span-2929" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2930"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2937"><span class="MJXp-mo" id="MJXp-Span-2938">(</span><span class="MJXp-mn" id="MJXp-Span-2939">1</span><span class="MJXp-mo" id="MJXp-Span-2940">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934">i</span><span class="MJXp-mo" id="MJXp-Span-2935">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">j</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">\forall i,j,\tilde{H}_{i,j}^{(1)}</script></span> được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942">P</span><span class="MJXp-mo" id="MJXp-Span-2943" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2944"><span class="MJXp-mrow" id="MJXp-Span-2945" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2946"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2948" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2953"><span class="MJXp-mo" id="MJXp-Span-2954">(</span><span class="MJXp-mn" id="MJXp-Span-2955">1</span><span class="MJXp-mo" id="MJXp-Span-2956">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950">i</span><span class="MJXp-mo" id="MJXp-Span-2951">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2952">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2957" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2958">1</span><span class="MJXp-mo" id="MJXp-Span-2959" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961">σ</span><span class="MJXp-mo" id="MJXp-Span-2962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2963"><span class="MJXp-mrow" id="MJXp-Span-2964" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2965"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2967" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2966">V</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2968" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969">i</span><span class="MJXp-mo" id="MJXp-Span-2970">,</span><span class="MJXp-mo" id="MJXp-Span-2971">:</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2973" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2978"><span class="MJXp-mo" id="MJXp-Span-2979">(</span><span class="MJXp-mn" id="MJXp-Span-2980">1</span><span class="MJXp-mo" id="MJXp-Span-2981">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2974"><span class="MJXp-mo" id="MJXp-Span-2975">:</span><span class="MJXp-mo" id="MJXp-Span-2976">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2982" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mrow" id="MJXp-Span-2984" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2985"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2987" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2986">H</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.084em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2992"><span class="MJXp-mo" id="MJXp-Span-2993">(</span><span class="MJXp-mn" id="MJXp-Span-2994">2</span><span class="MJXp-mo" id="MJXp-Span-2995">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2989">i</span><span class="MJXp-mo" id="MJXp-Span-2990">,</span><span class="MJXp-mo" id="MJXp-Span-2991">:</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2997" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3002"><span class="MJXp-mo" id="MJXp-Span-3003">(</span><span class="MJXp-mn" id="MJXp-Span-3004">2</span><span class="MJXp-mo" id="MJXp-Span-3005">)</span><span class="MJXp-mo" id="MJXp-Span-3006">⊺</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2999">j</span><span class="MJXp-mo" id="MJXp-Span-3000">,</span><span class="MJXp-mo" id="MJXp-Span-3001">:</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3008" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">P(\tilde{H}_{i,j}^{(1)}=1)=\sigma(\tilde{\boldsymbol{V}}_{i,:}\boldsymbol{W}_{:,j}^{(1)}+\tilde{\boldsymbol{H}}_{i,:}^{(2)}\boldsymbol{W}_{j,:}^{(2)\intercal}).</script></span></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote><blockquote>
<blockquote>
<blockquote>
<p><strong>end for</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3009"><span class="MJXp-msubsup" id="MJXp-Span-3010"><span class="MJXp-mi" id="MJXp-Span-3011" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3012" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3014" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3015" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3016">(</span><span class="MJXp-mn" id="MJXp-Span-3017">1</span><span class="MJXp-mo" id="MJXp-Span-3018">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3019" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-3020"><span class="MJXp-mi" id="MJXp-Span-3021" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3022" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3023"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3024" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3025" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3026">(</span><span class="MJXp-mn" id="MJXp-Span-3027">1</span><span class="MJXp-mo" id="MJXp-Span-3028">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3029" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-3030" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3031">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3033"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3034" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3035" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3036">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3037"><span class="MJXp-mrow" id="MJXp-Span-3038" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3039"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3040">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3042" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-3043">(</span><span class="MJXp-mn" id="MJXp-Span-3044">1</span><span class="MJXp-mo" id="MJXp-Span-3045">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">\Delta_{\boldsymbol{W}^{(1)}}\leftarrow\Delta_{\boldsymbol{W}^{(1)}} - \frac{1}{m}\boldsymbol{V}^{\intercal}\tilde{\boldsymbol{H}}^{(1)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3046"><span class="MJXp-msubsup" id="MJXp-Span-3047"><span class="MJXp-mi" id="MJXp-Span-3048" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3049" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3050"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3051" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3052" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3053">(</span><span class="MJXp-mn" id="MJXp-Span-3054">2</span><span class="MJXp-mo" id="MJXp-Span-3055">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-3057"><span class="MJXp-mi" id="MJXp-Span-3058" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3059" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3060"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3061" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3062" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3063">(</span><span class="MJXp-mn" id="MJXp-Span-3064">2</span><span class="MJXp-mo" id="MJXp-Span-3065">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3066" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-3067" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3068">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3070"><span class="MJXp-mrow" id="MJXp-Span-3071" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3072"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3073">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3075" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-3076">(</span><span class="MJXp-mn" id="MJXp-Span-3077">1</span><span class="MJXp-mo" id="MJXp-Span-3078">)</span><span class="MJXp-mo" id="MJXp-Span-3079">⊺</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3080"><span class="MJXp-mrow" id="MJXp-Span-3081" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-3082"><span><span class="MJXp-over"><span style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0px; margin-right: 0px;">˜</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3083">H</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3085" style="vertical-align: 0.724em;"><span class="MJXp-mo" id="MJXp-Span-3086">(</span><span class="MJXp-mn" id="MJXp-Span-3087">2</span><span class="MJXp-mo" id="MJXp-Span-3088">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">\Delta_{\boldsymbol{W}^{(2)}} \leftarrow\Delta_{\boldsymbol{W}^{(2)}}-\frac{1}{m}\tilde{\boldsymbol{H}}^{(1) \intercal}\tilde{\boldsymbol{H}}^{(2)}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3089"><span class="MJXp-msubsup" id="MJXp-Span-3090"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3091" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3092" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3093">(</span><span class="MJXp-mn" id="MJXp-Span-3094">1</span><span class="MJXp-mo" id="MJXp-Span-3095">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3096" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-3097"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3098" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3099" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3100">(</span><span class="MJXp-mn" id="MJXp-Span-3101">1</span><span class="MJXp-mo" id="MJXp-Span-3102">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3103" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-3105"><span class="MJXp-mi" id="MJXp-Span-3106" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3107" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3108"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3109" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3110" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3111">(</span><span class="MJXp-mn" id="MJXp-Span-3112">1</span><span class="MJXp-mo" id="MJXp-Span-3113">)</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">\boldsymbol{W}^{(1)}\leftarrow\boldsymbol{W}^{(1)}+\epsilon\Delta_{\boldsymbol{W}^{(1)}}</script></span> (đây là một minh hoạ, <s>khi thực hành</s> trong thực tế, ta sử dụng một thuật toán hiệu quả hơn, ví dụ như sử dụng đà vời tốc độ học <s>phân rã</s>giảm dần)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3114"><span class="MJXp-msubsup" id="MJXp-Span-3115"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3116" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3117" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3118">(</span><span class="MJXp-mn" id="MJXp-Span-3119">2</span><span class="MJXp-mo" id="MJXp-Span-3120">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3121" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-3122"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3123" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3124" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3125">(</span><span class="MJXp-mn" id="MJXp-Span-3126">2</span><span class="MJXp-mo" id="MJXp-Span-3127">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3128" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-3130"><span class="MJXp-mi" id="MJXp-Span-3131" style="margin-right: 0.05em;">Δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3132" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3133"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3134" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3135" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3136">(</span><span class="MJXp-mn" id="MJXp-Span-3137">2</span><span class="MJXp-mo" id="MJXp-Span-3138">)</span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">\boldsymbol{W}^{(2)}\leftarrow\boldsymbol{W}^{(2)}+\epsilon\Delta_{\boldsymbol{W}^{(2)}}</script></span></p>
</blockquote>
</blockquote>
</blockquote><blockquote>
<blockquote>
<p><strong>end while</strong></p>
</blockquote>
</blockquote><p>Quy trình huấn luyện hoàn thiện từng lớp này không phải chỉ là thuật toán tăng dần theo toạ độ (<em>coordinate ascent</em>). Nó mang một sổ điểm khá giống với thuật toán tăng dần theo toạ độ vì chúng ta tối ưu hoá một tập con của các tham số tại mỗi bước chạy. Hai phương pháp khác nhau bởi vì quy trình huấn luyện hoàn thiện theo từng lớp sử dụng một hàm mục tiêu (<em>objective function</em>) khác nhau ở mỗi bước.<br>
Tiền huấn luyện hoàn thiện từng lớp của DBM khác với của DBN. Tham số của mỗi RBM đơn lẻ có thể được sao chép trực tiếp đến một DBN tương ứng. Trong trường hợp của DBM, tham số của RBM phải được biến đổi trước khi đưa vào DBM. một tầng nằm ở giữa stack của RBM được huấn luyện chỉ với đầu vào từ dưới lên nhưng sau khi stack được kết hợp để tạo thành DBM, lớp này sẽ có cả đầu vào từ dưới lên và từ trên xuống. Để giải thích cho hiệu ứng này, Salakhutdinov và Hinton (2009a) ủng hộ việc phân chia trọng số của tất cả RBM, trừ trọng số của RBM ở trên cùng và dưới cùng, sẽ được chia 2 trước khi chèn vào DBM. Ngoài ra, RBM dưới cùng phải được huấn luyện bằng cách sử dụng hai “bản sao” của mỗi đơn vị khả kiến và các trọng số~~ gắn với nhau~~ phải bằng nhau giữa hai bản sao. Điều này có nghĩa là trọng số được tăng gấp đôi trong quá trình đi ngược lên. Tương tự, RBM ở trên cùng cũng nên được huấn luyện với hai bản sao của lớp trên cùng.<br>
Việc thu được các kết quả~~ hiện đại~~ mới và tốt nhất với máy Boltzmann đa tầng <s>sâu</s> cần sửa đổi thuật toán SML tiêu chuẩn, đó là sử dụng một số lượng nhỏ trường trung bình trong suốt pha âm của bước huấn luyện PCD đồng thời (Salakhutdinov). Đặc biệt, kỳ vọng của gradient năng lượng nên được tính toán <s>đối với</s> theo phân phối trường trung bình trong đó tất cả các đơn vị đều độc lập với nhau. Các tham số của phân phối trường trung bình cần đạt được bằng cách chạy các phương trình điểm cố định trường trung bình <s>chỉ trong</s>với một bước. Xem <s>bài báo</s> Goodfellow và cộng sự (2013b) để so sánh hiệu suất của DBMs trung tâm khi có và không có sử dụng trường trung bình một phần ở pha âm.</p><h2 id="2045-Huấn-luyện-đồng-thời-các-máy-Boltzman-sâuđa-tầng"><a class="anchor hidden-xs" href="#2045-Huấn-luyện-đồng-thời-các-máy-Boltzman-sâuđa-tầng" title="2045-Huấn-luyện-đồng-thời-các-máy-Boltzman-sâuđa-tầng"><span class="octicon octicon-link"></span></a>20.4.5. Huấn luyện đồng thời các máy Boltzman <s>sâu</s>đa tầng</h2><p>Các DBM cổ điển cần tiền huấn luyện <s>tham lam</s> hoàn thiện không giám sát (<em>greedy unsupervised pretraining</em>) và để phân loại được tốt, cần có<s>đòi hỏi</s> một bộ phân loại tách biệt dựa trên MLP ở trên cùng của các thuộc tính ẩn mà chúng lấy ra. Việc này gây ra một số tính chất không mong muốn. Rất khó để theo dõi hiệu suất trong quá trình huấn luyện vì chúng ta không thể đánh giá tính chất của toàn bộ DBM trong khi huấn luyện RBM đầu tiên. Vì vậy, rất khó để kết luận các siêu tham số hoạt động tốt như thế nào cho đến những giai đoạn khá muộn trong quá trình huấn luyện. Việc triển khai phần mềm của các DBM cần phải có nhiều thành tố khác nhau cho việc huấn luyện CD của từng RBM, huấn luyện PCD của toàn bộ DBM, và huấn luyện dựa trên lan truyền ngược thông qua MLP. Cuối cùng, MLP ở trên cùng của máy Boltzmann mất nhiều lợi thế từ mô hình xác suất của máy Boltzmann, chẳng hạn như có thể suy diễn khi một vài giá trị đầu vào bị mất.<br>
Có 2 cách chính để giải quyết vấn đề huấn luyện đồng thời của máy Boltzmann đa tầng. Cách thứ nhất là <strong>máy Boltzmann <s>sâu</s>đa tầng trung tâm</strong> (<em>centered deep Boltzmann machine</em>) (Montavon and Muller, 2012), tham số hoá lại mô hình để làm cho ma trận Hess của hàm mất mát được điều <s>hoà</s>chỉnh tốt hơn ở giai đoạn đầu của quá trình học. Cách này tạo ra một mô hình có thể huấn luyện mà không có bước tiền huấn luyện hoàn thiện theo từng lớp. Mô hình tạo thành đạt được logarit hàm hợp lý của tập kiểm tra rất tốt và tạo ra các mẫu chất lượng cao. Tuy nhiên, cách này chưa thể cạnh tranh với các MLP được chuẩn hoá thích hợp như một bộ phân loại. Cách thứ hai để huấn luyện đồng thời một máy Boltzmann đa tầng<s>sâu</s> là sử dụng một <strong>máy Boltzman <s>sâu</s>đa tầng, đa dự đoán</strong> (<em>multi-prediction deep Boltzmann machine</em>) (Goodfellow <em>et al</em>, 2013b). Mô hình này sử dụng tiêu chí huấn luyện <s>thay thế</s>tuần tự, cho phép sử dụng thuật toán lan truyền ngược để tránh vấn đề với các ước tính MCMC của gradient. Tuy nhiên, tiêu chí mới không cho hàm hợp lý hoặc mẫu tốt, nhưng, so với phương pháp MCMC, cách này cho hiệu quả phân loại tốt hơn và khả năng suy luận tốt về các dự liệu đầu vào bị mất.<br>
<img src="https://i.imgur.com/X2j88KS.png" alt=""></p><blockquote>
<p>Hình 20.4: Quy trình huấn luyện máy Boltzmann <s>sâu</s>đa tầng được sử dụng để phân loại tập dữ liệu MNIST (Salakhutdinov and Hinton, 2009a; Srivastava <em>et al</em>, 2014). *(a)*Huấn luyện một RBM bằng cách sử dụng CD để xấp xỉ tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3139"><span class="MJXp-mi" id="MJXp-Span-3140">log</span><span class="MJXp-mspace" id="MJXp-Span-3141" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142">P</span><span class="MJXp-mo" id="MJXp-Span-3143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3144">v</span><span class="MJXp-mo" id="MJXp-Span-3145" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">\log\,P(\boldsymbol{v})</script></span>. <em>(b)</em> Huấn luyện RBM thứ hai chứa các mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3146"><span class="MJXp-msubsup" id="MJXp-Span-3147"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3148" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3149" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3150">(</span><span class="MJXp-mn" id="MJXp-Span-3151">1</span><span class="MJXp-mo" id="MJXp-Span-3152">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">\boldsymbol{h}^{(1)}</script></span> và lớp đích <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">y</script></span> bằng cách sử dụng CD-<em>k</em> để xấp xỉ tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3155"><span class="MJXp-mi" id="MJXp-Span-3156">log</span><span class="MJXp-mspace" id="MJXp-Span-3157" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3158">P</span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3160"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3161" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3162" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3163">(</span><span class="MJXp-mn" id="MJXp-Span-3164">1</span><span class="MJXp-mo" id="MJXp-Span-3165">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3166" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167">y</span><span class="MJXp-mo" id="MJXp-Span-3168" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-146-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-146">\log\,P(\boldsymbol{h}^{(1)},y)</script></span> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3169"><span class="MJXp-msubsup" id="MJXp-Span-3170"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3171" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3172" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3173">(</span><span class="MJXp-mn" id="MJXp-Span-3174">1</span><span class="MJXp-mo" id="MJXp-Span-3175">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">\boldsymbol{h}^{(1)}</script></span> được rút ra từ hàm hậu nghiệm được điều <s>hoà</s>chỉnh dựa trên dữ liệu của RBM đầu tiên. Tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3177">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">k</script></span> từ 1 đến 20 trong quá trình học. *©*Kết hợp 2 RBM thành một DBM. Huấn luyện để xấp xỉ tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3178"><span class="MJXp-mi" id="MJXp-Span-3179">log</span><span class="MJXp-mspace" id="MJXp-Span-3180" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181">P</span><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3183">v</span><span class="MJXp-mo" id="MJXp-Span-3184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">y</span><span class="MJXp-mo" id="MJXp-Span-3186" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">\log\,P(\boldsymbol{v},y)</script></span>, sử dụng hợp lý cực đại ngẫu nhiên với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188">k</span><span class="MJXp-mo" id="MJXp-Span-3189" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3190">5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">k=5</script></span>. *(d)*Xoá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3192">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">y</script></span> ra khỏi mô hình. Định nghĩa các thuộc tính mới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3193"><span class="MJXp-msubsup" id="MJXp-Span-3194"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3195" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3196" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3197">(</span><span class="MJXp-mn" id="MJXp-Span-3198">1</span><span class="MJXp-mo" id="MJXp-Span-3199">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\boldsymbol{h}^{(1)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3200"><span class="MJXp-msubsup" id="MJXp-Span-3201"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3202" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3203" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3204">(</span><span class="MJXp-mn" id="MJXp-Span-3205">2</span><span class="MJXp-mo" id="MJXp-Span-3206">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">\boldsymbol{h}^{(2)}</script></span> bằng cách suy diễn trường trung bình trong mô hình thiếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-154-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-154">y</script></span>. Sử dụng các thuộc tính này làm đầu vào cho một MLP mà cấu trúc của nó giống như đường truyền thêm vào của trường trung bình, với một tầng đầu ra thêm vào để ước tính <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">y</script></span>. Khởi tạo trọng số của MLP giống với trọng số của DBM. Huấn luyện MLP để xấp xỉ tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3211"><span class="MJXp-mi" id="MJXp-Span-3212">log</span><span class="MJXp-mspace" id="MJXp-Span-3213" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3214">P</span><span class="MJXp-mo" id="MJXp-Span-3215" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3216">y</span><span class="MJXp-mrow" id="MJXp-Span-3217"><span class="MJXp-mo" id="MJXp-Span-3218" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3219">v</span><span class="MJXp-mo" id="MJXp-Span-3220" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">\log\,P(y/\boldsymbol{v})</script></span>, sử dụng giảm theo gradient ngẫu nhiên và cơ chế tắt ngẫu nhiên. Hình được in lại từ Goodfellow et ak. (2013b).</p>
</blockquote><p>Mẹo định tâm cho máy Boltzmann là cách dễ nhất để mô tả nếu chúng ta trở lại với một cái nhìn tổng quát của máy Boltzmann như một máy chứa một bộ các đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3221"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3222">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">\boldsymbol{x}</script></span> với một ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3224">U</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">U</script></span> và hệ số tự do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3225"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3226">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">\boldsymbol{b}</script></span>. Từ phương trình 20.2, hàm năng lượng được định nghĩa bằng phương trình:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3228">E</span><span class="MJXp-mo" id="MJXp-Span-3229" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3230">x</span><span class="MJXp-mo" id="MJXp-Span-3231" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3233" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3235" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3236" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3237">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3238">U</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3239">x</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3241"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3242" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3243" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3244">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3245">x</span><span class="MJXp-mo" id="MJXp-Span-3246" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3247" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3248" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3249">20.36</span><span class="MJXp-mo" id="MJXp-Span-3250" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-160">E(\boldsymbol{x})=-\boldsymbol{x}^{\intercal}\boldsymbol{Ux}-\boldsymbol{b}^{\intercal}\boldsymbol{x}. \qquad (20.36)</script></span><br>
Sử dụng các mẫu thưa khác nhau trong ma trận trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3251"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3252">U</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{U}</script></span>, chúng ta có thể cài đặt cấu trúc của các máy Boltzmann như các RBM và DBM với số lớp khác nhau. Điều này có thể đạt được bằng cách chia <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3253"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3254">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">\boldsymbol{x}</script></span> thành các đơn vị khả kiến và đơn vị ẩn và chuyển các phần tử trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3255"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3256">U</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{U}</script></span> thành 0 tương ứng với những đơn vị không tương tác. Máy Boltzmann trung tâm tạo ra một vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3257"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3258">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">\boldsymbol{\mu}</script></span> được lấy ra từ tất cả các trạng thái:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3259"><span class="MJXp-msup" id="MJXp-Span-3260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261" style="margin-right: 0.05em;">E</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3262" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3264">x</span><span class="MJXp-mo" id="MJXp-Span-3265" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3266">U</span><span class="MJXp-mo" id="MJXp-Span-3267" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3268">b</span><span class="MJXp-mo" id="MJXp-Span-3269" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3273">x</span><span class="MJXp-mo" id="MJXp-Span-3274" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3275">μ</span><span class="MJXp-msubsup" id="MJXp-Span-3276"><span class="MJXp-mo" id="MJXp-Span-3277" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3278" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3279">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3280">U</span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3282">x</span><span class="MJXp-mo" id="MJXp-Span-3283" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3284">μ</span><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3286" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3288">x</span><span class="MJXp-mo" id="MJXp-Span-3289" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3290">μ</span><span class="MJXp-msubsup" id="MJXp-Span-3291"><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3293" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3294">⊺</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3295">b</span><span class="MJXp-mo" id="MJXp-Span-3296" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3297" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3299">20.37</span><span class="MJXp-mo" id="MJXp-Span-3300" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-165">E'(\boldsymbol{x};\boldsymbol{U},\boldsymbol{b})=-(\boldsymbol{x}-\boldsymbol{\mu})^{\intercal}\boldsymbol{U}(\boldsymbol{x}-\boldsymbol{\mu})- (\boldsymbol{x}-\boldsymbol{\mu})^{\intercal}\boldsymbol{b}. \qquad (20.37)</script></span><br>
Thông thường <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3301"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3302">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">\boldsymbol{\mu}</script></span> là một siêu tham số được <s>bất biến</s> cố định <s>đặt cố định</s> khi bắt đầu huấn luyện. Nó thường được chọn để đảm bảo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3303"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3304">x</span><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3306">μ</span><span class="MJXp-mo" id="MJXp-Span-3307" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn MJXp-bold" id="MJXp-Span-3308">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">\boldsymbol{x}-\boldsymbol{\mu}\approx\boldsymbol{0}</script></span> khi mô hình được khởi tạo. Việc tái tham số hoá này không thay đổi phân phối xác suất mà mô hình có thể biểu diễn <s>đại diện</s> nhưng nó sẽ thay đổi động lực của việc giảm gradient ngẫu nhiên áp dụng trên hàm hợp lý. Đặc biệt trong nhiều trường hợp, việc tái tham số hoá này giúp cho ma trận Hess được điều <s>hoà</s> chỉnh tốt hơn. Melchior et al.<s>và cộng sự</s> (2013) đã chứng minh rằng việc điều <s>hoà</s>chỉnh ma trận Hess cải thiện và chỉ ra rằng mẹo định tâm thì tương ứng với một kĩ thuật học máy Boltzman khác, <strong>gradient tăng cường</strong> (<strong>enhanced gradient</strong>) (Cho et al., 2011). Việc điều chỉnh ma trận Hess được cải thiện giúp cho việc học thành công, ngay cả các trường hợp khó như huấn luyện một máy Boltzmann <s>sâu</s>đa tầng với nhiều lớp.</p><p>\ Hoà kết thúc dịch ở trang 670</p><p>---------------------------------------------------------------------------<br>
\ Soan Duong bắt đầu dịch từ t.671<br>
---------------------------------------------------------------------------<br>
Cách tiếp cận khác trong việc~~ kết hợp~~ huấn luyện đồng thời các máy Boltzmann <s>sâu</s> đa tầng (<em>deep Boltzmann machine</em>) là máy Boltzmann đa dự đoán <s>sâu</s>đa tầng (<em>multiple deep Boltzmann machine</em>) (MP-DBM). Máy này hoạt động bằng cách xem <s>lại</s> các phương trình trường trung bình (*mean field equation) giống như việc định nghĩa một họ các mạng hồi quy (<em>recurrent network</em>) để giải <s>quyết</s> một cách xấp xỉ mọi bài toán suy diễn <s>luận</s> (Goodfellow và cộng sự, 2013b). Thay vì huấn luyện mô hình để cực đại hóa độ hợp lý, mô hình được huấn luyện để làm cho mỗi mạng hồi quy có được một câu trả lời chính xác cho bài toán suy diễn <s>luận</s> tương ứng. Quá trình huấn luyện được minh họa như trong hình 20.5. Quá trình này bao gồm~~: (i)~~ lấy mẫu ngẫu nhiên một tập huấn luyện, <s>(ii)</s> lấy mẫu ngẫu nhiên một tập con các đầu vào <s>vào</s>cho mạng suy <s>luận</s> diễn (<em>inference network</em>)~~ (iii)~~ và sau đó huấn luyện mạng suy <s>luận</s> diễn này để dự đoán giá trị của các đơn vị còn lại.</p><p><img src="https://i.imgur.com/0iiEKb6.png" alt=""></p><p>Hình 20.5: Minh họa quá trình huấn luyện đa dự đoán cho một máy Boltzmann đa tầng <s>sâu</s>. Mỗi hàng là một mẫu khác trong một lô nhỏ (<em>minibatch</em>) cho cùng một bước huấn luyện. Mỗi cột <s>đại diện</s>biểu diễn cho một bước theo thời gian trong quá trình suy <s>luận</s> diễn trường trung bình (<em>mean field inference</em>). Đối với mỗi mẫu, một tập con của các biến dữ liệu được lấy mẫu để làm đầu vào cho quá trình suy diễn <s>luận</s>. Các biến này được tô màu đen để biểu thị sự điều chỉnh <s>điều kiện</s>. Sau đó quá trình suy diễn <s>luận</s> trường trung bình được thực hiện, với các mũi tên chỉ ra biến nào cảnh hưởng đến các biến khác trong quá trình. Trong các ứng dụng thực tế, trường trung bình cho nhiều bước bị tháo ra (không được thực hiện). Trong hình minh họa này, chỉ có 2 bước không được thực hiện. Mũi tên gạch ngang cho biết cách quá trình có thể được tháo ra trong nhiều bước. Các biến dữ liệu (không được sử dụng làm đầu vào cho quá trình suy diễn <s>luận</s>) trở thành mục tiêu, được tô màu xám. Chúng ta có thể xem quá trình suy <s>luận</s> diễn cho mỗi mẫu như một mạng hồi quy. Phương pháp <s>giảm dốc</s>trượt gradient và lan truyền ngược được sử dụng để huấn luyện những mạng hồi quy này nhằm đưa ra các mục tiêu chính xác khi <s>cung cấp</s> cho trước các đầu vào cho các mạng này. <s>Điều này</s> Quá trình này huấn luyện quá trình trường trung bình cho MP-DBM để đưa ra các ước lượng chính xác. Hình này được điều chỉnh từ Goodfellow và cộng sự (2013b).</p><p>Nguyên lý chung này của lan truyền ngược thông qua đồ thị tính toán (<em>computational graph</em>) cho suy diễn <s>gần đúng</s> xấp xỉ đã được áp dụng cho các mô hình khác (Stoyanov và cộng sự, 2011; Brakel và cộng sự, 2013). Trong các mô hình này và trong MP-DBM, giá trị <s>tổn thất</s>mất mát cuối cùng không phải là cận dưới của hàm hợp lý (<em>likelihood</em>). Thay vào đó, giá trị mất mát <s>tổn thất</s> cuối cùng thường dựa trên phân phối có điều kiện gần đúng mà mạng suy diễn <s>luận</s> gần đúng áp đặt lên các giá trị <s>bị</s> còn thiếu. Điều này có nghĩa là việc huấn luyện các mô hình này phần nào được thúc đẩy theo lối kinh nghiệm. Nếu chúng ta kiểm tra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3310">p</span><span class="MJXp-mo" id="MJXp-Span-3311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3312">v</span><span class="MJXp-mo" id="MJXp-Span-3313" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">p(\boldsymbol{v})</script></span> được biểu diễn bởi máy Boltzmann đã học được theo phương pháp MP-DBM, <s>nó</s> (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3315">p</span><span class="MJXp-mo" id="MJXp-Span-3316" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3317">v</span><span class="MJXp-mo" id="MJXp-Span-3318" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">p(\boldsymbol{v})</script></span>) có xu hướng phần nào bị lỗi, theo nghĩa là lấy mẫu Gibbs cho ra các mẫu kém.</p><p>Lan truyền ngược thông qua đồ thị suy diễn <s>luận</s> có hai ưu điểm chính. Đầu tiên, <s>Ưu điểm đầu tiên của lan truyền ngược thông qua đồ thị suy luậndiễn ~~ nó huấn luyện mô hình như cách nó thực sự được sử dụng – <s>bởi</s> suy diễn xấp xỉ</s>luận~~ <s>gần đúng</s>. Điều này có nghĩa là suy diễn xấp xỉ <s>luận</s> <s>gần đúng</s>, chẳng hạn như điền vào các đầu vào <s>bị</s>còn thiếu hoặc thực hiện phân lớp dù đầu vào <s>bị</s>còn thiếu, trong MP-DBM chính xác hơn so với trong DBM gốc. DBM gốc không tự thân tạo ra một bộ phân lớp chính xác; kết quả phân lớp tốt nhất với DBM gốc là dựa trên việc huấn luyện một bộ phân lớp riêng biệt để sử dụng các đặc trưng được trích xuất bởi DBM, thay vì sử dụng suy diễn<s>luận</s> trong DBM để tính toán phân bố trên các lớp. Suy diễn <s>luận</s> trường trung bình trong MP-DBM hoạt động tốt như một bộ phân lớp mà không cần cải biến nào. Ưu điểm thứ hai của lan truyền ngược thông qua suy luận xấp xỉ<s>gần đúng</s> là thuật toán lan truyền truyền <s>lại</s> ngược tính toán chính xác <s>độ dốc (<em><s>gradient</s></em>)</s> của hàm mất mát <s>tổn thất</s> <s>chính xác</s>. Việc tính toán chính xác gradient này đem lại nhiều lợi ích hơn so với việc xấp xỉ gradient trong các phương pháp huấn luyện SML, những phương pháp mà phải chịu tổn thất từ hệ số tự do (<em>bias</em>) và phương sai. Điều này giải thích lý do tại sao MP-DBMs có thể được huấn luyện đồng thời <s>kết hợp</s> trong khi DBM đòi hỏi một tiền huấn luyện hoàn thiện từng lớp <s>tầng</s> (<em>greedy layer-wise pretraining</em>). Nhược điểm của việc truyền ngược thông qua đồ thị suy luận xấp xỉ<s>gần đúng</s> là phương pháp này không cung cấp một cách để tối ưu hàm logarit của hàm hợp lý, mà là đưa ra một xấp xỉ theo lối kinh nghiệm của hàm giả hợp lý tổng quát (<em>generalized pseudolikelihood</em>).</p><p>MP-DBM <s>lấy</s> truyền cảm hứng <s>từ phần mở rộng của</s> NADE-k (Raiko và cộng sự, 2014), phần mở rộng của <s>tới</s> bộ khung NADE (<em>NADE framework</em>), được mô tả trong phần 20.10.10.</p><p>MP-DBM có một số kết nối được tắt ngẫu nhiên (<em>dropout</em>). Cơ chế tắt ngẫu nghiên chia sẻ các tham số giống nhau giữa các đồ thị tính toán khác nhau, với sự khác biệt giữa mỗi đồ thị là chúng có bao gồm hoặc loại trừ mỗi đơn vị (<em>unit</em>) trong đồ thị hay không. MP-DBM cũng chia sẻ các tham số trên nhiều đồ thị tính toán. Trong trường hợp của MP-DBM, sự khác biệt giữa các đồ thị là liệu mỗi đơn vị đầu vào có được quan sát hay không. Khi một đơn vị không được quan sát, MP-DBM không xóa đơn vị này một cách hoàn toàn như trong cơ chế tắt ngẫn nhiên. Thay vào đó, MP-DBM coi nó như một biến ẩn cần được suy luận. Người ta có thể tưởng tượng áp dụng cơ chết tắt ngẫu nhiên cho MP-DBM bằng cách loại bỏ thêm một số đơn vị hơn là coi các đơn vị này như là các đơn vị ẩn.</p><h1 id="205-Máy-Boltzmann-cho-dữ-liệu-có-giá-trị-thực-Real-Valued-Data"><a class="anchor hidden-xs" href="#205-Máy-Boltzmann-cho-dữ-liệu-có-giá-trị-thực-Real-Valued-Data" title="205-Máy-Boltzmann-cho-dữ-liệu-có-giá-trị-thực-Real-Valued-Data"><span class="octicon octicon-link"></span></a>20.5 Máy Boltzmann cho dữ liệu có giá trị thực (<em>Real-Valued Data</em>)</h1><p>Trong khi, các máy Boltzmann ban đầu được phát triển để sử dụng cho dữ liệu nhị phân, nhưng nhiều ứng dụng, chẳng hạn như các bài toán liên quan tới mô hình hoá ảnh và âm thanh đều yêu cầu khả năng biểu diễn phân bố xác suất trên các giá trị thực. Trong một số trường hợp, dữ liệu có thể được đưa về dạng giá trị thực trong khoảng [0, 1] như biểu diễn kỳ vọng của một biến nhị phân. Ví dụ, Hinton (2000) xử lý các ảnh xám trong tập huấn luyện như các giá trị xác suất [0,1]. Mỗi <s>pixel</s> điểm ảnh định nghĩa xác suất của một giá trị nhị phân là 1 và các <s>pixel</s> điểm ảnh nhị phân đều được lấy mẫu độc lập với nhau. Đây là một <s>thủ tục</s> phương pháp phổ biến để đánh giá các mô hình nhị phân trên các tập dữ liệu ảnh <s>xám</s>trắng đen. Tuy nhiên, đây không phải là một cách tiếp cận thỏa mãn về mặt lý thuyết, và các hình ảnh nhị phân được lấy mẫu độc lập theo cách này gây nên sự xuất hiện của nhiễu. Trong phần này, chúng tôi giới thiệu các máy Boltzmann, mà xác định mật độ xác suất trên dữ liệu có giá trị thực.</p><h2 id="2051-Các-máy-Boltzmann-bị-hạn-chế-dạng-Gaussian-Bernoulli"><a class="anchor hidden-xs" href="#2051-Các-máy-Boltzmann-bị-hạn-chế-dạng-Gaussian-Bernoulli" title="2051-Các-máy-Boltzmann-bị-hạn-chế-dạng-Gaussian-Bernoulli"><span class="octicon octicon-link"></span></a>20.5.1 Các máy Boltzmann <s>bị</s> hạn chế dạng Gaussian-Bernoulli</h2><p>Các máy Boltzmann <s>bị</s> hạn chế (RMB) được phát triển cho nhiều họ phân phối <s>bố</s> có điều kiện và có dạng luỹ thừa <s>số mũ <s>(Welling và cộng sự, 2005). Trong số các máy này, phổ biến nhất là RBM với các đơn vị ẩn dạng nhị phân và các đơn vị khả kiến</s>hữu hình</s> (<em>visible unit</em>) <s>dạng</s>có giá trị thực, với phân bố có điều kiện trên các đơn vị <s>hữu hình</s>khả kiến là một phân bố Gaussian, trong đó <s>kỳ vọng</s>giá trị trung bình của phân bố này là một hàm của các đơn vị ẩn.</p><p>Có nhiều cách tham số hóa các RBM dạng Gauss-Bernoulli. Một trong số các lựa chọn để tham số hóa là <s>nên</s> sử dụng ma trận hiệp phương sai hay ma trận chính xác (<em>precision matrix</em>) cho phân bố Gaussian. Ở đây chúng tôi trình bày <s>cách phát biểu</s> công thức của ma trận chính xác (<em>precision formulation</em>). <s>Có thể sửa đổi đơn giản để thu được cách phát biểu hiệp phương sai</s> Ta dễ dàng chỉnh sửa để tạo ra được công thức cho ma trận hiệp phương sai. (<em>covariance formulation</em>). Chúng ta mong muốn muốn có phân <s>bố</s> phối có điều kiện</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">p</span><span class="MJXp-mo" id="MJXp-Span-3321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3322">v</span><span class="MJXp-mspace" id="MJXp-Span-3323" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3324"><span class="MJXp-mo" id="MJXp-Span-3325" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-3326" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3327">h</span><span class="MJXp-mo" id="MJXp-Span-3328" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3330"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3331">N</span></span><span class="MJXp-mo" id="MJXp-Span-3332" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3333">v</span><span class="MJXp-mo" id="MJXp-Span-3334" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3335">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3336">h</span><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3338"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3339" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3340" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3341">−</span><span class="MJXp-mn" id="MJXp-Span-3342">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3343" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3344" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3345" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3347">20.38</span><span class="MJXp-mo" id="MJXp-Span-3348" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">p(\boldsymbol{v}\,|\,\boldsymbol{h}) = \mathcal{N}(\boldsymbol{v}; \boldsymbol{W}\boldsymbol{h}, \boldsymbol{\beta}^{-1}).  \qquad (20.38)</script></span></p><p>Chúng ta có thể tìm các <s>thành phần</s> số hạng để đưa vào hàm năng lượng (<em>energy function</em>) bằng cách mở rộng hàm logarit không chuẩn hóa của phân phối có điều kiện<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3349"><span class="MJXp-mrow" id="MJXp-Span-3350"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3351">N</span></span><span class="MJXp-mo" id="MJXp-Span-3352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3353">v</span><span class="MJXp-mo" id="MJXp-Span-3354" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3355">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3356">h</span><span class="MJXp-mo" id="MJXp-Span-3357" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3358"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3359" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3360" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3361">−</span><span class="MJXp-mn" id="MJXp-Span-3362">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3365" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-3366" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3367">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3368">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3370">v</span><span class="MJXp-mo" id="MJXp-Span-3371" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3372">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3373">h</span><span class="MJXp-msubsup" id="MJXp-Span-3374"><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3376" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mspace" id="MJXp-Span-3377" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3378">β</span><span class="MJXp-mspace" id="MJXp-Span-3379" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3380" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3381">v</span><span class="MJXp-mo" id="MJXp-Span-3382" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3383">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3384">h</span><span class="MJXp-mo" id="MJXp-Span-3385" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3386" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3387">f</span><span class="MJXp-mo" id="MJXp-Span-3388" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3389">β</span><span class="MJXp-mo" id="MJXp-Span-3390" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3392" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3394">20.39</span><span class="MJXp-mo" id="MJXp-Span-3395" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-171">\mathcal{N}(\boldsymbol{v}; \boldsymbol{W}\boldsymbol{h}, \boldsymbol{\beta}^{-1}) = -\frac{1}{2}(\boldsymbol{v} - \boldsymbol{W}\boldsymbol{h})^\
\,\boldsymbol{\beta}\, (\boldsymbol{v} - \boldsymbol{W}\boldsymbol{h}) + f(\boldsymbol{\beta}) .  \qquad (20.39)</script></span></p><p>Ở đây <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3397">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">f</script></span> đóng gói tất cả các <s>thành phần</s> thừa số thành một hàm duy nhất của các tham số và nó không phải là các biến ngẫu nhiên trong mô hình. Chúng ta có thể loại bỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3399">f</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">f</script></span> bởi vì vai trò duy nhất của nó là chuẩn hóa phân phối <s>bố</s>, và <s>chức năng</s> hàm phân hoạch<s>vùng</s> của bất kỳ <s>chức năng</s>hàm năng lượng nào mà ta <s>được</s> chọn sẽ thực hiện vai trò chuẩn hóa phân bố này.</p><p>Nếu hàm năng lượng chỉ chứa tất cả các số hạng <s>thành phần</s> (với dấu đối <s>đảo</s> của chúng) bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3400"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3401">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\boldsymbol{v}</script></span> từ phương trình 20.39 trong hàm năng lượng và ~~(~~không <s>có</s>thêm bất kỳ số hạng nào khác kể cả <s>thành phần</s> <s>bao gồm</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3402"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3403">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\boldsymbol{v}</script></span> nào khác), thì hàm năng lượng sẽ biểu diễn <s>đại diện</s> cho phân phối có điều kiện mong muốn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405">p</span><span class="MJXp-mo" id="MJXp-Span-3406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3407">v</span><span class="MJXp-mspace" id="MJXp-Span-3408" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3409"><span class="MJXp-mo" id="MJXp-Span-3410" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-3411" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3412">h</span><span class="MJXp-mo" id="MJXp-Span-3413" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">p(\boldsymbol{v}\,|\,\boldsymbol{h})</script></span>.</p><p>Chúng tôi có một <s>số bậc</s> sự tự do liên quan đến phân bố có điều kiện  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3415">p</span><span class="MJXp-mo" id="MJXp-Span-3416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3417">v</span><span class="MJXp-mspace" id="MJXp-Span-3418" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3419"><span class="MJXp-mo" id="MJXp-Span-3420" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-3421" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3422">h</span><span class="MJXp-mo" id="MJXp-Span-3423" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">p(\boldsymbol{v}\,|\,\boldsymbol{h})</script></span> khác. Lưu ý rằng phương trình 20.39 có số hạng <s>chứa thành phần</s><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3424"><span class="MJXp-mfrac" id="MJXp-Span-3425" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3426">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3427">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3428"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3429" style="margin-right: 0.05em;">h</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3430" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-3431"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3432" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3433" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mspace" id="MJXp-Span-3434" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3435">β</span><span class="MJXp-mspace" id="MJXp-Span-3436" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3437">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3438">h</span><span class="MJXp-mo" id="MJXp-Span-3439" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3440" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3442">20.40</span><span class="MJXp-mo" id="MJXp-Span-3443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-178">\frac{1}{2}\boldsymbol{h}^\intercal\boldsymbol{W}^\intercal\,\boldsymbol{\beta}\,\boldsymbol{W}\boldsymbol{h}.  \qquad (20.40)</script></span></p><p><s>Thành phần</s>Số hạng này không thể được thêm vào một cách trọn vẹn<s>bao gồm toàn bộ</s> vì nó bao gồm các <s>thành phần</s> số hạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3444"><span class="MJXp-msubsup" id="MJXp-Span-3445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3446" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3447" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3449" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3450" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">h_ih_j</script></span>. Các số hạng<s>thành phần</s> này tương ứng với các cạnh giữa các đơn vị ẩn. Nếu ta thêm vào các số hạng này vào công thức, ta<s>Sự có mặt của cá thành phần này sẽ</s> tạo ra một mô hình nhân tử tuyến tính thay vì máy Boltzmann <s>bị</s> hạn chế. Khi thiết kế máy Boltzmann, chúng ta bỏ qua các <s>thành phần</s>số hạng chéo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3451"><span class="MJXp-msubsup" id="MJXp-Span-3452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3453" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3454" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-3455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3456" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3457" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">h_ih_j</script></span> này. Việc bỏ qua các <s>thành phần</s> số hạng này không làm thay đổi xác suất có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">p</span><span class="MJXp-mo" id="MJXp-Span-3460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3461">v</span><span class="MJXp-mspace" id="MJXp-Span-3462" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3463"><span class="MJXp-mo" id="MJXp-Span-3464" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-3465" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3466">h</span><span class="MJXp-mo" id="MJXp-Span-3467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">p(\boldsymbol{v}\,|\,\boldsymbol{h})</script></span>, do đó biểu thức 20.39 vẫn được bảo toàn. Tuy nhiên, chúng ta vẫn có một lựa chọn về việc có nên thêm các thừa số<s>ưa các thành phần</s> chỉ chứa một giá trị đơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3468"><span class="MJXp-msubsup" id="MJXp-Span-3469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3470" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3471" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">h_i</script></span> <s>vào</s> hay không. Nếu chúng ta giả định một ma trận đường chéo chính xác (<em>diagonal precision matrix</em>), chúng ta tìm ma trận đó cho mỗi đơn vị ẩn, chúng ta có <s>thành phần</s>số hạng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3472"><span class="MJXp-mfrac" id="MJXp-Span-3473" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3474">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3475">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3477" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3478" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-munderover" id="MJXp-Span-3479"><span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3481" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3483" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3484" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-3485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3486" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3491">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488">j</span><span class="MJXp-mo" id="MJXp-Span-3489">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3490">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3492" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3493" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3495">20.41</span><span class="MJXp-mo" id="MJXp-Span-3496" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-183">\frac{1}{2} h_i \sum_j \beta_j W^2_{j,i} .  \qquad (20.41)</script></span><br>
<s>Trong thành phần số hạng trên</s> Ở trên, chúng ta đã sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3497"><span class="MJXp-msubsup" id="MJXp-Span-3498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3499" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3501">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3500">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3502" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3504" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3505" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">h_i^2 = h_i</script></span> bởi vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3506"><span class="MJXp-msubsup" id="MJXp-Span-3507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3508" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3509" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3510" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-3511"><span class="MJXp-mn" id="MJXp-Span-3512">0</span><span class="MJXp-mo" id="MJXp-Span-3513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3514">1</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">h_i \in {0, 1}</script></span>. Nếu hàm năng lượng chứa <s>thành phần</s> số hạng này (với dấu <s>đảo</s> đối), thì hàm này sẽ tự nhiên hướng về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3515"><span class="MJXp-msubsup" id="MJXp-Span-3516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3517" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3518" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">h_i</script></span> để được tắt khi các trọng số của đơn vị đó lớn và được kết nối với các đơn vị <s>hữu hình</s> khả kiến có <s>với</s> độ chính xác cao. Việc chọn liệu có đưa hệ số tự do này vào hay không không làm ảnh hưởng tới họ của các phân <s>bố</s> phối mà mô hình có thể biểu diễn (giả sử rằng các tham số tự do được thêm vào các đơn vị ẩn), nhưng nó có ảnh hưởng đến tính động về phương pháp học của mô hình. Mô hình có chứa <s>thành phần</s>số hạng này có thể giúp các hàm kích hoạt của đơn vị ẩn được giữ ở trạng thái hợp lý ngay cả khi trọng số tăng nhanh về độ lớn<br>
Một cách để định nghĩa hàm năng lượng trên RBM có dạng Gaussian-Bernoulli là<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3520">E</span><span class="MJXp-mo" id="MJXp-Span-3521" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3522">v</span><span class="MJXp-mo" id="MJXp-Span-3523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3524">h</span><span class="MJXp-mo" id="MJXp-Span-3525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3526" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3527" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3528">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3529">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3530"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3531" style="margin-right: 0.05em;">v</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3532" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mspace" id="MJXp-Span-3533" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3535">β</span><span class="MJXp-mo" id="MJXp-Span-3536" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3537">v</span><span class="MJXp-mo" id="MJXp-Span-3538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3539" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3540" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3541">v</span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3543">β</span><span class="MJXp-msubsup" id="MJXp-Span-3544"><span class="MJXp-mo" id="MJXp-Span-3545" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3546" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mspace" id="MJXp-Span-3547" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3548">W</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3549">h</span><span class="MJXp-mo" id="MJXp-Span-3550" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3551"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3552" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3553" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3554">h</span><span class="MJXp-mo" id="MJXp-Span-3555" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3556" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3558">20.42</span><span class="MJXp-mo" id="MJXp-Span-3559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-187"> E(\boldsymbol{v}, \boldsymbol{h}) = \frac{1}{2}\boldsymbol{v}^\intercal \, (\boldsymbol{\beta} \odot \boldsymbol{v}) - (\boldsymbol{v} \odot \boldsymbol{\beta})^\intercal\, \boldsymbol{W}\boldsymbol{h} - \boldsymbol{b}^\intercal\boldsymbol{h},   \qquad (20.42)</script></span></p><p>nhưng chúng ta cũng có thể chọn lựa việc thêm một số <s>thành phần</s> số hạng bổ sung hoặc tham số hóa năng lượng theo <s>nghĩa</s> phương sai hơn là độ chính xác.</p><p>Trong phiên bản này, chúng ta đã không đưa~~ thành phần~~ hệ số tự do vào các đơn vị <s>hữu hình</s>khả kiến, nhưng các thành phần tự do này có thể được thêm vào dễ dàng. Việc lựa chọn cách xử lý ma trận độ chính xác là một nguồn cuối cùng tác động đến tính biến thiên trong việc tham số hóa của RBM dạng Gaussian-Bernoulli. Ma trận này có thể được cố định bởi hằng số (có thể ước tính dựa trên độ chính xác biên của dữ liệu) hoặc giá trị của nó được xác định thông qua một phương pháp học. Ma trận này cũng có thể là bội số của ma trận đơn vị hoặc cũng có thể là một ma trận đường chéo. Thông thường, trong trường hợp này, ma trận chính xác không được phép là ma trận không phải là ma trận đường chéo, bởi vì một số phép toán trên phân bố Gaussian yêu cầu phép nghịch đảo ma trận, và với ma trận đường chéo thì phép nghịch đảo có thể thực hiện một cách đơn giản. Trong các phần tiếp theo, các dạng khác của máy Boltzmann khác sẽ được trình bày, các dạng máy này cho phép mô hình hoá cấu trúc hiệp phương sai, sử dụng các kỹ thuật khác nhau để tránh phép nghịch đảo ma trận độ chính xác.</p><h2 id="2052-Các-mô-hình-không-trực-tiếp-vô-hướng-của-hiệp-phương-sai-có-điều-kiện"><a class="anchor hidden-xs" href="#2052-Các-mô-hình-không-trực-tiếp-vô-hướng-của-hiệp-phương-sai-có-điều-kiện" title="2052-Các-mô-hình-không-trực-tiếp-vô-hướng-của-hiệp-phương-sai-có-điều-kiện"><span class="octicon octicon-link"></span></a>20.5.2 Các mô hình <s>không trực tiếp</s> vô hướng của hiệp phương sai có điều kiện</h2><p>Trong khi RBM dạng Gaussian là mô hình năng lượng kinh điển cho dữ liệu có giá trị thực, Ranzato et al. <s>và cộng sự</s> (2010a) lập luận rằng thiên kiến <s>vị</s> quy nạp RBM Gaussian không phù hợp với các biến thể thống kê có trong một số loại dữ liệu có giá trị thực, đặc biệt là hình ảnh tự nhiên. Vấn đề là phần lớn nội dung thông tin có trong hình ảnh tự nhiên được nhúng vào hiệp phương sai giữa các điểm ảnh thay vì trong các giá trị thô của điểm ảnh. Nói cách khác, nó là mối quan hệ giữa các điểm ảnh chứ không phải là giá trị tuyệt đối của các điểm ảnh nơi chứa đựng hầu hết các thông tin hữu ích của ảnh. Vì Gaussian RBM chỉ mô hình hoá <s>kỳ vọng <s>giá trị trung bình có điều kiện của đầu vào khi cho trước các đơn vị ẩn, nên nó (Gaussian RBM) không thể nắm được hiệp phương sai có điều kiện. Để giải quyết vấn đề này, nhiều mô hình thay thế đã được đề xuất, các mô hình thay thế này đều cố gắng tính đến hiệp phương sai của dữ liệu có giá trị thực. Những mô hình này gồm <s>kỳ vọng</s>giá trị trung bình và hiệp phương sai RBM (mcRBM\footnote{Cụm từ “mcRBM” được phát âm bằng cách đọc tên của các ký tự M-C-R-B-M, không phát âm “mc” như “Mc” trong “McDonnal’s”.}), tích trung bình</s>kỳ vọng</s> của phân bố Student (mPoT) và phân bố cây đinh và tấm phản RBM (ssRBM).</p><p>\textbf{<s>Kỳ vọng</s> Giá trị trung bình và hiệp phương sai RBM} Các mcRBM sử dụng các đơn vị ẩn của nó để mã hóa độc lập hiệp phương sai và giá trị trung bình<s>kỳ vọng</s> có điều kiện của tất cả các đơn vị được quan sát. Các đơn vị trong tầng ẩn mcRBM được chia thành hai nhóm: đơn vị <s>kỳ vọng</s> có giá trị trung bình và đơn vị hiệp phương sai. Nhóm mà mô hình hoá <s>kỳ vọng</s> giá trị trung bình có điều kiện chỉ đơn giản là một RBM Gaussian. Phần còn lại là RBM hiệp phương sai (Ranzato và cộng sự, 2010a), cũng được gọi là cRBM, trong đó các thành phần của chúng mô hình hoá cấu trúc hiệp phương sai có điều kiện, như được mô tả dưới đây.</p><p>---------------------------------------------------------------------------<br>
\ Soan Duong kết thúc ở t.675<br>
---------------------------------------------------------------------------</p><p>---------------------------------------------------------------------------<br>
\ Huy Thai bat dau dich o day (676 - 680)<br>
---------------------------------------------------------------------------</p><p>Cụ thể, với các đơn vị trung bình nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">h</span><span class="MJXp-mo" id="MJXp-Span-3562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3563">m</span><span class="MJXp-mo" id="MJXp-Span-3564" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">h(m)</script></span> và các đơn vị hiệp phương sai nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3566">h</span><span class="MJXp-mo" id="MJXp-Span-3567" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3568">c</span><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">h(c)</script></span>, mô hình mcRBM được định nghĩa như là tổ hợp của hai hàm năng lượng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3570"><span class="MJXp-msubsup" id="MJXp-Span-3571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3572" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3573" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3574">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3575">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-3576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">x</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3580" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3581" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3582">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3583">m</span><span class="MJXp-mo" id="MJXp-Span-3584">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3585" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3587" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3588" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3589">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3590">c</span><span class="MJXp-mo" id="MJXp-Span-3591">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3592" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3595" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3596" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3597" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3598">x</span><span class="MJXp-mo" id="MJXp-Span-3599" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3601" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3602" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3603">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604">m</span><span class="MJXp-mo" id="MJXp-Span-3605">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3607" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3609" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3610" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-3611" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3612">x</span><span class="MJXp-mo" id="MJXp-Span-3613" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3615" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3616" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3617">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3618">c</span><span class="MJXp-mo" id="MJXp-Span-3619">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3620" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3621" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3622" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3624">20.43</span><span class="MJXp-mo" id="MJXp-Span-3625" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-190">E_{mc}(x, h^{(m)}, h^{(c)}) = E_m(x,h^{(m)}) + E_c(x,h^{(c)}), \qquad (20.43)</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3626"><span class="MJXp-msubsup" id="MJXp-Span-3627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3628" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3629" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">E_m</script></span> là hàm năng lượng Gaussian - Bernoulli RBM chuẩn<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3630"><span class="MJXp-msubsup" id="MJXp-Span-3631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3632" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3633" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-3634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3635">x</span><span class="MJXp-mo" id="MJXp-Span-3636" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3638" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3639" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3640">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3641">m</span><span class="MJXp-mo" id="MJXp-Span-3642">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3643" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3644" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3645" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3646">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3647">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3650" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3651">x</span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-3653"><span><span class="MJXp-mo" id="MJXp-Span-3654" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3657" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3658" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-3659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3660" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3661" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-3662">:</span><span class="MJXp-mo" id="MJXp-Span-3663">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3666" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3668"><span class="MJXp-mo" id="MJXp-Span-3669">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3670">m</span><span class="MJXp-mo" id="MJXp-Span-3671">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3667">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3672" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-3673"><span><span class="MJXp-mo" id="MJXp-Span-3674" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3677" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3679"><span class="MJXp-mo" id="MJXp-Span-3680">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3681">m</span><span class="MJXp-mo" id="MJXp-Span-3682">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3678">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3686"><span class="MJXp-mo" id="MJXp-Span-3687">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3688">m</span><span class="MJXp-mo" id="MJXp-Span-3689">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3685">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3690" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3691" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3693">20.44</span><span class="MJXp-mo" id="MJXp-Span-3694" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-192">E_m(x,h^{(m)})=\frac{1}{2}x^\intercal x-\sum_jx^\intercal W_{:,j}h_j^{(m)} - \sum_jb_j^{(m)}h_j^{(m)},\qquad (20.44) </script></span><br>
và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3695"><span class="MJXp-msubsup" id="MJXp-Span-3696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3698" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">E_c</script></span> là hàm năng lượng cRBM mô hình thông tin phương sai có điều kiện:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3699"><span class="MJXp-msubsup" id="MJXp-Span-3700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3701" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3702" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-3703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3704">x</span><span class="MJXp-mo" id="MJXp-Span-3705" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3707" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3708" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3709">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3710">c</span><span class="MJXp-mo" id="MJXp-Span-3711">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3712" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3713" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3714" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3715">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3716">2</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3717"><span><span class="MJXp-mo" id="MJXp-Span-3718" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3723"><span class="MJXp-mo" id="MJXp-Span-3724">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3725">c</span><span class="MJXp-mo" id="MJXp-Span-3726">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3722">j</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-3727"><span class="MJXp-mrow" id="MJXp-Span-3728"><span class="MJXp-mo" id="MJXp-Span-3729" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3731" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3732" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-3733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3734" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3735" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3736">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737">j</span><span class="MJXp-mo" id="MJXp-Span-3738">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3739"><span class="MJXp-mstyle" id="MJXp-Span-3740" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3741"><span class="MJXp-mo" id="MJXp-Span-3742" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3743" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3744" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-3745"><span><span class="MJXp-mo" id="MJXp-Span-3746" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3747" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3749" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3751"><span class="MJXp-mo" id="MJXp-Span-3752">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">c</span><span class="MJXp-mo" id="MJXp-Span-3754">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3750">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3756" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3758"><span class="MJXp-mo" id="MJXp-Span-3759">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3760">c</span><span class="MJXp-mo" id="MJXp-Span-3761">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3762" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3763" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3764" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3765">20.45</span><span class="MJXp-mo" id="MJXp-Span-3766" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-194">E_c(x,h^{(c)}) = \frac{1}{2}\sum_jh_j^{(c)}\Big(x^\intercal r^{(j)}\Big)^2 - \sum_jb_j^{(c)}h_j^{(c)}.\qquad (20.45) </script></span><br>
Tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3767"><span class="MJXp-msubsup" id="MJXp-Span-3768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3769" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3770" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3771">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3772">j</span><span class="MJXp-mo" id="MJXp-Span-3773">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">r^{(j)}</script></span> tương ứng với vector trọng số hiệp phương sai liên quan tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3774"><span class="MJXp-msubsup" id="MJXp-Span-3775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3778"><span class="MJXp-mo" id="MJXp-Span-3779">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3780">c</span><span class="MJXp-mo" id="MJXp-Span-3781">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3777">j</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">h_j^{(c)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3782"><span class="MJXp-msubsup" id="MJXp-Span-3783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3784" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3785" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3786">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3787">c</span><span class="MJXp-mo" id="MJXp-Span-3788">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">b^{(c)}</script></span> là vector offset hiệp phương sai. Hàm năng lượng hợp nhất định nghĩa một phân phối kết hợp,<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3789"><span class="MJXp-msubsup" id="MJXp-Span-3790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3792" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3793">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-3795" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3796">x</span><span class="MJXp-mo" id="MJXp-Span-3797" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3799" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3800" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3801">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3802">m</span><span class="MJXp-mo" id="MJXp-Span-3803">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3804" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3806" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3807" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3808">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3809">c</span><span class="MJXp-mo" id="MJXp-Span-3810">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3811" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3812" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3813" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3814">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3815">Z</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3816">exp</span><span class="MJXp-mo" id="MJXp-Span-3817" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mstyle" id="MJXp-Span-3818"><span class="MJXp-mrow" id="MJXp-Span-3819"><span class="MJXp-mo" id="MJXp-Span-3820" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.104em;">{</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3821" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3823" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3824" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3825">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3826">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-3827" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3828">x</span><span class="MJXp-mo" id="MJXp-Span-3829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3831" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3832" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3833">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3834">m</span><span class="MJXp-mo" id="MJXp-Span-3835">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3838" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3839" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3840">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3841">c</span><span class="MJXp-mo" id="MJXp-Span-3842">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3843" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mstyle" id="MJXp-Span-3844"><span class="MJXp-mrow" id="MJXp-Span-3845"><span class="MJXp-mo" id="MJXp-Span-3846" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.104em;">}</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3848" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3849" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3850">20.46</span><span class="MJXp-mo" id="MJXp-Span-3851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-198">p_{mc}(x,h^{(m)},h^{(c)})=\frac{1}{Z}\exp\Big\{-E_{mc}(x,h^{(m)},h^{(c)})\Big\},\qquad (20.46)</script></span><br>
và một phân phối có điều kiện tương ứng trên các quan sát khi cho trước <s>giả thiết</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3852"><span class="MJXp-msubsup" id="MJXp-Span-3853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3854" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3855" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3856">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">m</span><span class="MJXp-mo" id="MJXp-Span-3858">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">h^{(m)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3859"><span class="MJXp-msubsup" id="MJXp-Span-3860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3861" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3862" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3863">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3864">c</span><span class="MJXp-mo" id="MJXp-Span-3865">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">h^{(c)}</script></span> là một phân phối Gaussian nhiều biến:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3866"><span class="MJXp-msubsup" id="MJXp-Span-3867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3869" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3870">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3871">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-3872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3873">x</span><span class="MJXp-mrow" id="MJXp-Span-3874"><span class="MJXp-mo" id="MJXp-Span-3875" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-3876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3877" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3878" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3879">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880">m</span><span class="MJXp-mo" id="MJXp-Span-3881">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3882" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3884" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3885" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3886">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3887">c</span><span class="MJXp-mo" id="MJXp-Span-3888">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3889" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3890" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3891"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3892">N</span></span><span class="MJXp-mstyle" id="MJXp-Span-3893"><span class="MJXp-mrow" id="MJXp-Span-3894"><span class="MJXp-mo" id="MJXp-Span-3895" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3896">x</span><span class="MJXp-mo" id="MJXp-Span-3897" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-3898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3899" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3906">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3907">c</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3901">x</span><span class="MJXp-mrow" id="MJXp-Span-3902"><span class="MJXp-mo" id="MJXp-Span-3903">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3904">h</span></span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-3908"><span class="MJXp-mrow" id="MJXp-Span-3909"><span class="MJXp-mo" id="MJXp-Span-3910" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3911"><span><span class="MJXp-mo" id="MJXp-Span-3912" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3913" style="margin-left: 0px;">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3915" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3916" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-3917">:</span><span class="MJXp-mo" id="MJXp-Span-3918">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3919">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3921" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3923"><span class="MJXp-mo" id="MJXp-Span-3924">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3925">m</span><span class="MJXp-mo" id="MJXp-Span-3926">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922">j</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-3927"><span class="MJXp-mrow" id="MJXp-Span-3928"><span class="MJXp-mo" id="MJXp-Span-3929" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3930" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3932" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3939">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3940">c</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3934">x</span><span class="MJXp-mrow" id="MJXp-Span-3935"><span class="MJXp-mo" id="MJXp-Span-3936">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3937">h</span></span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-3941"><span class="MJXp-mrow" id="MJXp-Span-3942"><span class="MJXp-mo" id="MJXp-Span-3943" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3944" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mspace" id="MJXp-Span-3945" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3947">20.47</span><span class="MJXp-mo" id="MJXp-Span-3948" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-201">p_{mc}(x|h^{(m)},h^{(c)}) = \mathcal{N}\bigg(x;C_{x|h}^{mc}\bigg(\sum_jW_{:,j}h_j^{(m)}\bigg),C_{x|h}^{mc}\bigg).\qquad(20.47) </script></span></p><p>Chú ý rằng ma trận hiệp phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3949"><span class="MJXp-msubsup" id="MJXp-Span-3950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3951" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3958">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3959">c</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3953">x</span><span class="MJXp-mrow" id="MJXp-Span-3954"><span class="MJXp-mo" id="MJXp-Span-3955">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956">h</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-3961"><span class="MJXp-mrow" id="MJXp-Span-3962"><span class="MJXp-mo" id="MJXp-Span-3963" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3964"><span class="MJXp-mo" id="MJXp-Span-3965" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3966" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-3967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3968" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3970"><span class="MJXp-mo" id="MJXp-Span-3971">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3972">c</span><span class="MJXp-mo" id="MJXp-Span-3973">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3969">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3975" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3976" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3977">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3978">j</span><span class="MJXp-mo" id="MJXp-Span-3979">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3981" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3982" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3983">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3984">j</span><span class="MJXp-mo" id="MJXp-Span-3985">)</span><span class="MJXp-mo" id="MJXp-Span-3986">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-3987" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3988">I</span><span class="MJXp-msubsup" id="MJXp-Span-3989"><span class="MJXp-mstyle" id="MJXp-Span-3990" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-3991"><span class="MJXp-mo" id="MJXp-Span-3992" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3993" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3994">−</span><span class="MJXp-mn" id="MJXp-Span-3995">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">C_{x|h}^{mc} = \Big(\sum_jh_j^{(c)}r^{(j)}r^{(j)\intercal} + I\Big)^{-1}</script></span> không chéo và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3997">W</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">W</script></span> là ma trận trọng số liên kết với mô hình RBM Gaussian trung bình có điều kiện. Khó để huấn luyện mcRBM bằng phân kì tương phản (contrastive divergence - CD) hoặc phân kì tương phản liên tục (persistent contrastive divergence - PCD) do cấu trúc điều kiện hiệp phương sai không chéo của nó. CD và PCD đòi hỏi lấy mẫu từ phân phối kết hợp của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3999">x</span><span class="MJXp-mo" id="MJXp-Span-4000" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4002" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4003" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4004">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4005">m</span><span class="MJXp-mo" id="MJXp-Span-4006">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4007" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4009" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4010" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4011">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4012">c</span><span class="MJXp-mo" id="MJXp-Span-4013">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">x, h^{(m)}, h^{(c)}</script></span> mà trong một RBM chuẩn được thực hiện bằng lấy mẫu Gibbs trên các phân phối có điều kiện. Tuy nhiên, trong mcRBM, lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4014"><span class="MJXp-msubsup" id="MJXp-Span-4015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4016" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4017" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4018">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4019">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-4020" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4021">x</span><span class="MJXp-mrow" id="MJXp-Span-4022"><span class="MJXp-mo" id="MJXp-Span-4023" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4025" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4026" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4027">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4028">m</span><span class="MJXp-mo" id="MJXp-Span-4029">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4030" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4032" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4033" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4034">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4035">c</span><span class="MJXp-mo" id="MJXp-Span-4036">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4037" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">p_{mc}(x|h^{(m)},h^{(c)})</script></span> đòi hỏi việc tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4038"><span class="MJXp-mo" id="MJXp-Span-4039" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4041" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4042" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4043">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4044">c</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4045"><span class="MJXp-mo" id="MJXp-Span-4046" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4047" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4048">−</span><span class="MJXp-mn" id="MJXp-Span-4049">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">(C^{mc})^{-1}</script></span> tại mọi lần lặp trong <s>lúc</s> quá trình học. Đây có thể là gánh nặng tính toán không thực tế cho những quan sát lớn hơn. Ranzato and Hinton (2010) tránh lấy mẫu trực tiếp từ phân phối có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4050"><span class="MJXp-msubsup" id="MJXp-Span-4051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4052" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4053" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4054">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4055">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-4056" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4057">x</span><span class="MJXp-mrow" id="MJXp-Span-4058"><span class="MJXp-mo" id="MJXp-Span-4059" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4061" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4062" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4063">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4064">m</span><span class="MJXp-mo" id="MJXp-Span-4065">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4066" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4068" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4069" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4070">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4071">c</span><span class="MJXp-mo" id="MJXp-Span-4072">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4073" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">p_{mc}(x|h^{(m)},h^{(c)})</script></span> bằng cách lấy mẫu trực tiếp từ <s>lề</s>phân phối biên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4075">p</span><span class="MJXp-mo" id="MJXp-Span-4076" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4077">x</span><span class="MJXp-mo" id="MJXp-Span-4078" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">p(x)</script></span> sử dụng Hamilton (lai) Monte Carlo (Neal, 1993) trên năng lượng tự do mcRBM.<br>
<strong>Tích trung bình của Phân phối t-Student</strong> Tích trung bình của mô hình <s>trung bình</s> phân phối t-Student (mPoT) (Ranzato et al., 2010b) <s>mở rộng</s>kế thừa mô hình PoT (Welling et al., 2003a) theo cách tương tự như mcRBM <s>mở rộng</s> kế thừa cRBM. Nó thu được bằng cách <s>bao gồm</s> thêm các giá trị trung bình Gaussian khác 0 bằng việc tính tổng của các đơn vị ẩn giống-RBM. Giống như mcRBM, phân phối có điều kiện PoT trên các quan sát là một phân phối Gaussian đa biến (với ma trận hiệp phương sai không chéo); tuy nhiên, không giống với mcRBM, phân bổ điều kiện bổ sung trên các biến ẩn được đưa ra bởi các phân phối Gamma độc lập có điều kiện. Phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4079"><span class="MJXp-mrow" id="MJXp-Span-4080"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4081">G</span></span><span class="MJXp-mo" id="MJXp-Span-4082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4083">k</span><span class="MJXp-mo" id="MJXp-Span-4084" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4085">θ</span><span class="MJXp-mo" id="MJXp-Span-4086" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">\mathcal{G}(k,\theta)</script></span> là một phân phối xác suất trên tập số thực dương, với <s>kì vọng</s> giá trị trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4088">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4089">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">k\theta</script></span>. Có thể hiểu ý tưởng cơ bản của mô hình mPoT mà không cần thiết <s>để có</s> phải hiểu chi tiết <s>hơn</s> về phân phối Gamma.<br>
Hàm năng lượng của mPoT<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4090"><span class="MJXp-mtable" id="MJXp-Span-4091"><span><span class="MJXp-mtr" id="MJXp-Span-4092" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4093" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-4094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4095" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4096" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4098">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4099">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4100">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-4101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4102">x</span><span class="MJXp-mo" id="MJXp-Span-4103" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4105" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4106" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4107">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4108">m</span><span class="MJXp-mo" id="MJXp-Span-4109">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4110" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4112" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4113" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4114">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4115">c</span><span class="MJXp-mo" id="MJXp-Span-4116">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4117" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-4118" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4120">20.48</span><span class="MJXp-mo" id="MJXp-Span-4121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4122" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4123" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4126" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4127" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-4128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4129">x</span><span class="MJXp-mo" id="MJXp-Span-4130" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4132" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4133" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4134">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4135">m</span><span class="MJXp-mo" id="MJXp-Span-4136">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4137" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4138" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-4139"><span><span class="MJXp-mo" id="MJXp-Span-4140" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4141" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-4142"><span class="MJXp-mrow" id="MJXp-Span-4143"><span class="MJXp-mo" id="MJXp-Span-4144" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4146" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4148"><span class="MJXp-mo" id="MJXp-Span-4149">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4150">c</span><span class="MJXp-mo" id="MJXp-Span-4151">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4147">j</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-4152"><span class="MJXp-mrow" id="MJXp-Span-4153"><span class="MJXp-mo" id="MJXp-Span-4154" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-4155">1</span><span class="MJXp-mo" id="MJXp-Span-4156" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4157" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4158">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4159">2</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-4160"><span class="MJXp-mrow" id="MJXp-Span-4161"><span class="MJXp-mo" id="MJXp-Span-4162" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4164" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4165" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4166">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4167">j</span><span class="MJXp-mo" id="MJXp-Span-4168">)</span><span class="MJXp-mo" id="MJXp-Span-4169">⊺</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4170">x</span><span class="MJXp-msubsup" id="MJXp-Span-4171"><span class="MJXp-mstyle" id="MJXp-Span-4172" style="margin-right: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-4173"><span class="MJXp-mo" id="MJXp-Span-4174" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4175" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mstyle" id="MJXp-Span-4176"><span class="MJXp-mrow" id="MJXp-Span-4177"><span class="MJXp-mo" id="MJXp-Span-4178" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4179" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-4180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4181">1</span><span class="MJXp-mo" id="MJXp-Span-4182" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4183">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4184">j</span><span class="MJXp-mo" id="MJXp-Span-4185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-4186">log</span><span class="MJXp-mo" id="MJXp-Span-4187" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-4188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4189" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4191"><span class="MJXp-mo" id="MJXp-Span-4192">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4193">c</span><span class="MJXp-mo" id="MJXp-Span-4194">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4190">j</span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-4195"><span class="MJXp-mrow" id="MJXp-Span-4196"><span class="MJXp-mo" id="MJXp-Span-4197" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4198" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-4199" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4200" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4201">20.49</span><span class="MJXp-mo" id="MJXp-Span-4202" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-211">\begin{eqnarray}E_{mPoT}(x,h^{(m)},h^{(c)}) \qquad (20.48) \\=E_m(x,h^{(m)}) + \sum_j\bigg(h_j^{(c)}\bigg(1+\frac{1}{2}\Big(r^{(j)\intercal}x\Big)^2\bigg) + (1-\gamma j)\log h_j^{(c)}\bigg), \qquad (20.49)\end{eqnarray}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4203"><span class="MJXp-msubsup" id="MJXp-Span-4204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4205" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4206" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4207">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4208">j</span><span class="MJXp-mo" id="MJXp-Span-4209">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">r^{(j)}</script></span> là vector trọng số hiệp phương sai liên kết với đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4210"><span class="MJXp-msubsup" id="MJXp-Span-4211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4212" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4214"><span class="MJXp-mo" id="MJXp-Span-4215">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4216">c</span><span class="MJXp-mo" id="MJXp-Span-4217">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4213">j</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">h_j^{(c)}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4218"><span class="MJXp-msubsup" id="MJXp-Span-4219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4220" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4221" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-4222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4223">x</span><span class="MJXp-mo" id="MJXp-Span-4224" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4226" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4227" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4228">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4229">m</span><span class="MJXp-mo" id="MJXp-Span-4230">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4231" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">E_m(x,h^{(m)})</script></span> giống như đã được định nghĩa trong <s>công thức</s> phương trình 20.44<br>
Giống như mcRBM, hàm năng lượng mô hình mPoT xác định một Gaussian nhiều biến, với một phân phối có điều kiện trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4233">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">x</script></span> có ma trận hiệp phương sai không chéo. Quá trình học trong mô hình mPoT giống như mcRBM, phức tạp do không thể lấy mẫu từ phân phối Gaussian có điều kiện và không chéo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4234"><span class="MJXp-msubsup" id="MJXp-Span-4235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4236" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4237" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4238">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4239">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4240">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4241">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-4242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4243">x</span><span class="MJXp-mrow" id="MJXp-Span-4244"><span class="MJXp-mo" id="MJXp-Span-4245" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-4246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4247" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4248" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4249">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4250">m</span><span class="MJXp-mo" id="MJXp-Span-4251">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4252" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4254" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4255" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4256">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4257">c</span><span class="MJXp-mo" id="MJXp-Span-4258">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4259" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">p_{mPoT}(x|h^{(m)},h^{(c)})</script></span>, vì vậy Ranzato et al. (2010b) cũng chủ trương lấy mẫu trực tiếp từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4261">p</span><span class="MJXp-mo" id="MJXp-Span-4262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4263">x</span><span class="MJXp-mo" id="MJXp-Span-4264" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">p(x)</script></span> thông qua Hamilton (lai) Monte Carlo.<br>
<strong>Máy Boltzmann hạn chế Spike và Slab</strong> Máy Boltzmann hạn chế Spike và Slab (Courville et al., 2011) hay ssRBM đề xuất một phương pháp khác để mô hình hóa cấu trúc hiệp phương sai của dữ liệu có giá trị <s>kiểu</s> thực. So với mcRBM, ssRBM có lợi điểm là không yêu cầu nghịch đảo ma trận cũng như các phương pháp Hamilton Monte Carlo. Giống như mô hình mcRBM và mPoT, các đơn vị ẩn nhị phân mã hoá hiệp phương sai có điều kiện qua các <s>pixel</s> điểm ảnh thông qua việc sử dụng các biến phụ trợ kiểu thực.<br>
RBM Spike và Slab có 2 tập đơn vị ẩn: các đơn vị spike <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4266">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">h</script></span> kiểu nhị phân và các đơn vị slab <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4268">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">s</script></span> kiểu thực. Trung bình của đơn vị <s>thấy được</s> khả kiến được điều chỉnh <s>điều kiện</s> trên đơn vị ẩn cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4269"><span class="MJXp-mo" id="MJXp-Span-4270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4271">h</span><span class="MJXp-mo" id="MJXp-Span-4272" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4273">s</span><span class="MJXp-mo" id="MJXp-Span-4274" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4276" style="margin-right: 0.05em;">W</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4277" style="vertical-align: 0.5em;">⊺</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">(h\odot s)W^\intercal</script></span>. Nói cách khác, mỗi cột <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4278"><span class="MJXp-msubsup" id="MJXp-Span-4279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4280" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4281" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-4282">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4283">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">W_{:i}</script></span> xác định một thành phần có thể xuất hiện ở đầu vào khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4284"><span class="MJXp-msubsup" id="MJXp-Span-4285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4286" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4287" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4288" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4289">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">h_i = 1</script></span>. Biến spike tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4290"><span class="MJXp-msubsup" id="MJXp-Span-4291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4292" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4293" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">h_i</script></span> xác định <s>sự tồn tại của</s> thành phần có tồn tại hay không. Biến slab tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4294"><span class="MJXp-msubsup" id="MJXp-Span-4295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4296" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4297" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">s_i</script></span> xác định độ lớn, nếu thành phần có tồn tại. Khi một biến spike được kích hoạt, biến slab tương ứng cộng phương sai vào đầu vào<s>vào sai số</s> theo trục của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4298"><span class="MJXp-msubsup" id="MJXp-Span-4299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4300" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4301" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-4302">:</span><span class="MJXp-mo" id="MJXp-Span-4303">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4304">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">W_{:,i}</script></span>. Điều này cho phép ta mô hình hóa hiệp phương sai <s>số</s> của đầu vào. May thay, <s>sự</s> phương pháp phân kì tương phản và phân kì tương phản liên tục <s>với</s> của lấy mẫu Gibbs vẫn áp dụng được. Không cần nghịch đảo bất kì ma trận nào.<br>
Mô hình ssRBM được định nghĩa thông qua hàm năng lượng:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4305"><span class="MJXp-mtable" id="MJXp-Span-4306"><span><span class="MJXp-mtr" id="MJXp-Span-4307" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4308" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-4309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4310" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4311" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4312">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4313">s</span></span></span><span class="MJXp-mo" id="MJXp-Span-4314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4315">x</span><span class="MJXp-mo" id="MJXp-Span-4316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4317">s</span><span class="MJXp-mo" id="MJXp-Span-4318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319">h</span><span class="MJXp-mo" id="MJXp-Span-4320" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4321" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4322" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-4323"><span><span class="MJXp-mo" id="MJXp-Span-4324" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4325" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4327" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4328" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-4329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4330" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4331" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-4332">:</span><span class="MJXp-mo" id="MJXp-Span-4333">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4334">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4336" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4337" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4339" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4340" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4341" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4342" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4343">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4344">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4346" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4347" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mstyle" id="MJXp-Span-4348"><span class="MJXp-mrow" id="MJXp-Span-4349"><span class="MJXp-mo" id="MJXp-Span-4350" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-4351">Λ</span><span class="MJXp-mo" id="MJXp-Span-4352" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-4353"><span><span class="MJXp-mo" id="MJXp-Span-4354" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4355" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4356"><span class="MJXp-mi" id="MJXp-Span-4357" style="margin-right: 0.05em;">Φ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4358" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4361" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mstyle" id="MJXp-Span-4362"><span class="MJXp-mrow" id="MJXp-Span-4363"><span class="MJXp-mo" id="MJXp-Span-4364" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4365">x</span><span class="MJXp-mspace" id="MJXp-Span-4366" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4368">20.50</span><span class="MJXp-mo" id="MJXp-Span-4369" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-226">\begin{eqnarray}E_{ss}(x,s,h) = -\sum_i x^\intercal W_{:,i}s_ih_i+\frac{1}{2}x^\intercal\bigg(\Lambda + \sum_i\Phi_ih_i\bigg)x\qquad(20.50)\end{eqnarray}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4370"><span class="MJXp-mtable" id="MJXp-Span-4371"><span><span class="MJXp-mtr" id="MJXp-Span-4372" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4373" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4374" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-4375" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4376">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4377">2</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-4378"><span><span class="MJXp-mo" id="MJXp-Span-4379" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4380" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4382" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4383" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4385" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-4387">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4386">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4388" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-4389"><span><span class="MJXp-mo" id="MJXp-Span-4390" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4391" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4394" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4396" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4397" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4399" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4400" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4402" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4403" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4404" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-4405"><span><span class="MJXp-mo" id="MJXp-Span-4406" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4407" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4409" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4410" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4412" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4413" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4414" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-4415"><span><span class="MJXp-mo" id="MJXp-Span-4416" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4419" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4420" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4422" style="margin-right: 0.05em;">μ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-4424">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4423">i</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4426" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4427" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4428" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-4429" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4431">20.51</span><span class="MJXp-mo" id="MJXp-Span-4432" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-227">\begin{eqnarray}+ \frac{1}{2}\sum_i\alpha_is_i^2 - \sum_i\alpha_i\mu_is_ih_i - \sum_ib_ih_i + \sum_i\alpha_i\mu_i^2h_i, \qquad(20.51)\end{eqnarray}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4433"><span class="MJXp-msubsup" id="MJXp-Span-4434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4435" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4436" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">b_i</script></span> là sai lệch của spike <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4437"><span class="MJXp-msubsup" id="MJXp-Span-4438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4439" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4440" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">h_i</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4441"><span class="MJXp-mi" id="MJXp-Span-4442">Λ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">\Lambda</script></span> là ma trận độ chính xác chéo trên quan sát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4444">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">x</script></span>. Tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4445"><span class="MJXp-msubsup" id="MJXp-Span-4446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4447" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4448" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4449" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-4450">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">\alpha_i > 0</script></span> là độ chính xác vô hướng cho biến slab kiểu thực <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4451"><span class="MJXp-msubsup" id="MJXp-Span-4452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4453" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4454" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-233-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-233">s_i</script></span>. Tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4455"><span class="MJXp-msubsup" id="MJXp-Span-4456"><span class="MJXp-mi" id="MJXp-Span-4457" style="margin-right: 0.05em;">Φ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4458" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">\Phi_i</script></span> là một ma trận chéo không âm định nghĩa một hàm phạt điều biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4460">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">h</script></span> bậc hai trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4462">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">x</script></span>. Mỗi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4464">m</span><span class="MJXp-msubsup" id="MJXp-Span-4465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4466" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4467" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">mu_i</script></span> là tham số trung bình của biến slab <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4468"><span class="MJXp-msubsup" id="MJXp-Span-4469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4470" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4471" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">s_i</script></span>.</p><p>Với phân phối kết hợp được định nghĩa thông qua hàm năng lượng, ~~dẫn xuất của ~~việc suy diễn phân phối có điều kiện ssRBM tương đối <s>minh bạch</s>dễ dàng. Ví dụ, bằng cách tách biệt các biến slab <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4473">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">s</script></span>, phân phối có điều kiện trên các quan sát cho <s>bởi</s> trước các biến nhị phân spike <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4475">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">h</script></span> được cho bởi<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4476"><span class="MJXp-mtable" id="MJXp-Span-4477"><span><span class="MJXp-mtr" id="MJXp-Span-4478" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4479" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-4480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4481" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4482" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4483">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4484">s</span></span></span><span class="MJXp-mo" id="MJXp-Span-4485" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4486">x</span><span class="MJXp-mrow" id="MJXp-Span-4487"><span class="MJXp-mo" id="MJXp-Span-4488" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4489">h</span><span class="MJXp-mo" id="MJXp-Span-4490" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4491" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4492" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4493">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4494">P</span><span class="MJXp-mo" id="MJXp-Span-4495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4496">h</span><span class="MJXp-mo" id="MJXp-Span-4497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4498" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4499">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4500">Z</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4501" style="margin-left: 0em; margin-right: 0.111em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi" id="MJXp-Span-4502">exp</span><span class="MJXp-mo" id="MJXp-Span-4503" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4504" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-4505" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4506">E</span><span class="MJXp-mo" id="MJXp-Span-4507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4508">x</span><span class="MJXp-mo" id="MJXp-Span-4509" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4510">s</span><span class="MJXp-mo" id="MJXp-Span-4511" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4512">h</span><span class="MJXp-mo" id="MJXp-Span-4513" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4514" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4515">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4516">s</span><span class="MJXp-mspace" id="MJXp-Span-4517" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4518" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4519">20.52</span><span class="MJXp-mo" id="MJXp-Span-4520" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4521" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4522" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4524"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4525">N</span></span><span class="MJXp-mstyle" id="MJXp-Span-4526"><span class="MJXp-mrow" id="MJXp-Span-4527"><span class="MJXp-mo" id="MJXp-Span-4528" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4529">x</span><span class="MJXp-mo" id="MJXp-Span-4530" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-4531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4532" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4539">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4540">s</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4534">x</span><span class="MJXp-mrow" id="MJXp-Span-4535"><span class="MJXp-mo" id="MJXp-Span-4536">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4537">h</span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-4541"><span><span class="MJXp-mo" id="MJXp-Span-4542" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4543" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4545" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4546" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-4547">:</span><span class="MJXp-mo" id="MJXp-Span-4548">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4549">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4551" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4552" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4554" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4555" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4556" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4558" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4565">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4566">s</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4560">x</span><span class="MJXp-mrow" id="MJXp-Span-4561"><span class="MJXp-mo" id="MJXp-Span-4562">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4563">h</span></span></span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-4567"><span class="MJXp-mrow" id="MJXp-Span-4568"><span class="MJXp-mo" id="MJXp-Span-4569" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-4570" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4572">20.53</span><span class="MJXp-mo" id="MJXp-Span-4573" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4574" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-241">\begin{eqnarray} p_{ss}(x|h) = \frac{1}{P(h)}\frac{1}{Z}\int\exp\{-E(x,s,h)\}ds\qquad(20.52) \\= \mathcal{N}\bigg(x;C_{x|h}^{ss}\sum_iW_{:,i}\mu_ih_i, C_{x|h}^{ss} \bigg) \qquad(20.53).\end{eqnarray} </script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4575"><span class="MJXp-msubsup" id="MJXp-Span-4576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4577" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4584">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4585">s</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4579">x</span><span class="MJXp-mrow" id="MJXp-Span-4580"><span class="MJXp-mo" id="MJXp-Span-4581">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4582">h</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4586" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-4588">Λ</span><span class="MJXp-mo" id="MJXp-Span-4589" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4590"><span class="MJXp-mo" id="MJXp-Span-4591" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4592" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4593"><span class="MJXp-mi" id="MJXp-Span-4594" style="margin-right: 0.05em;">Φ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4595" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4597" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4598" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4599" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4600"><span class="MJXp-mo" id="MJXp-Span-4601" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4602" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4604" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4606"><span class="MJXp-mo" id="MJXp-Span-4607">−</span><span class="MJXp-mn" id="MJXp-Span-4608">1</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4605">i</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4610" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4611" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4613" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4614" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-4615">:</span><span class="MJXp-mo" id="MJXp-Span-4616">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4617">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4619" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-4624">⊺</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4620"><span class="MJXp-mo" id="MJXp-Span-4621">:</span><span class="MJXp-mo" id="MJXp-Span-4622">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4623">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4625"><span class="MJXp-mo" id="MJXp-Span-4626" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4627" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4628">−</span><span class="MJXp-mn" id="MJXp-Span-4629">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">C_{x|h}^{ss} = (\Lambda + \sum_i\Phi_ih_i-\sum_i\alpha_i^{-1}h_iW_{:,i}W_{:,i}^\intercal)^{-1}</script></span>. Đẳng thức cuối cùng chỉ xảy ra khi ma trận hiệp phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4630"><span class="MJXp-msubsup" id="MJXp-Span-4631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4632" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4639">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4640">s</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4634">x</span><span class="MJXp-mrow" id="MJXp-Span-4635"><span class="MJXp-mo" id="MJXp-Span-4636">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4637">h</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">C_{x|h}^{ss}</script></span> xác định dương.</p><p><s>Giam bởi</s>Sự lọc các biến spike nghĩa là phân phối <s>lề</s>biên thật sự trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4642">h</span><span class="MJXp-mo" id="MJXp-Span-4643" style="margin-left: 0.267em; margin-right: 0.267em;">⊙</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4644">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">h\odot s</script></span> thưa. Điều này khác với mã hoá thưa, khi các mẫu từ mô hình “gần như không bao giờ” (theo lí thuyết đo lường) chứa các giá trị 0 trong mã hoá, và suy luận MAP cần thiết để áp đặt sự thưa.<br>
So sánh với mcRBM và mPoT, ssRBM tham số hoá hiệp phương sai điều kiện của quan sát theo một cách khác biệt hoàn toàn<s>đáng kể</s>. Cả mcRBM và mPoT đều mô hình cấu trúc hiệp phương sai <s>số</s> của quan sát <s>về</s> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4645"><span class="MJXp-mo" id="MJXp-Span-4646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4647"><span class="MJXp-mo" id="MJXp-Span-4648" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4649" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-4650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4651" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4653"><span class="MJXp-mo" id="MJXp-Span-4654">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4655">c</span><span class="MJXp-mo" id="MJXp-Span-4656">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4652">j</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4658" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4659" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4660">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4661">j</span><span class="MJXp-mo" id="MJXp-Span-4662">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4664" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4665" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4666">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4667">j</span><span class="MJXp-mo" id="MJXp-Span-4668">)</span><span class="MJXp-mo" id="MJXp-Span-4669">⊺</span></span></span><span class="MJXp-mo" id="MJXp-Span-4670" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4671">I</span><span class="MJXp-mo" id="MJXp-Span-4672" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">(\sum_jh_j^{(c)}r^{(j)}r^{(j)\intercal} + I)</script></span>, sử dụng hàm kích hoạt của các đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4673"><span class="MJXp-msubsup" id="MJXp-Span-4674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4675" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4676" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-4677" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-4678">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">h_j > 0</script></span> để đảm bảo các ràng buộc trên hiệp phương sai <s>số</s> có điều kiện theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4679"><span class="MJXp-msubsup" id="MJXp-Span-4680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4681" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4682" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4683">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4684">j</span><span class="MJXp-mo" id="MJXp-Span-4685">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">r^{(j)}</script></span>. Ngược lại, ssRBM xác định hiệp phương sai có điều kiện của quan sát bằng cách sử dụng hàm kích hoạt spike ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4686"><span class="MJXp-msubsup" id="MJXp-Span-4687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4688" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4689" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4690" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4691">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">h_i=1</script></span> để kẹp ma trận độ chính xác theo hướng xác định bởi vector trọng số tương ứng. Hiệp phương sai điều kiện ssRBM tương tự như cái được tạo ra từ một mô hình khác: tích <s>xác suất</s> của <s>phân tích</s> thành phần xác suất đặc trưng (PoPPCA) (Williams and Agakov, 2002). Trong thiết lập quá đầy, các kích hoạt thưa với tham số hoá ssRBM cho phép phương sai có nghĩa <s>đáng kể</s> (vượt quá phương sai danh nghĩa cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4692"><span class="MJXp-msubsup" id="MJXp-Span-4693"><span class="MJXp-mi" id="MJXp-Span-4694" style="margin-right: 0.05em;">Λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4695" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4696">−</span><span class="MJXp-mn" id="MJXp-Span-4697">1</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">\Lambda^{-1}</script></span>) chỉ theo các hướng được chọn của hàm kích hoạt thưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4698"><span class="MJXp-msubsup" id="MJXp-Span-4699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4700" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4701" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">h_i</script></span>. Trong mô hình mcRBM và mPoT, một biểu diễn quá đầy nghĩa là để nắm bắt các sự biến thiên <s>động</s> theo một hướng nhất định trong không gian quan sát <s>thì</s> <s>phải</s> yêu cầu loại bỏ tất cả ràng buộc với hình chiếu dương trên hướng đó. Điều này nghĩa là những mô hình này không phù hợp với thiết lập quá đủ.</p><p>Bất lợi căn bản của ssRBM là một vài thiết lập của các tham số có thể làm cho ma trận hiệp phương sai tương ứng không xác định dương. Một ma trận hiệp phương sai như vậy ~~đặt <s>khiến nhiều xác suất ~~ lên</s> các giá trị không chuẩn hoá và có sai số lớn so với giá trị trung bình <s>xa với</s> <s>kì vọng</s>, làm cho tích phân trên tất cả các kết quả trở nên <s>có thể</s> phân kì. Nhìn chung có thể tránh vấn đề này bằng cách áp dụng các thủ thuật heuristic đơn giản. Chưa có lời giải thoả mãn về mặt lí thuyết. Sử dụng tối ưu hoá ràng buộc để tránh các <s>khu vực</s> miền mà tại đó xác suất không xác định ~~là ~~ thì khó khăn nếu không quá cẩn trọng và đồng thời ngăn mô hình hội tụ vào các miền có giá trị tốt của <s>vùng</s> không gian tham số <s>tốt</s>.</p><p>Về mặt chất lượng, các biến thể tích chập của ssRBM tạo ra các mẫu hình ảnh tự nhiên rất tốt. Một số ví dụ được thể hiện trên hình 16.1</p><p>ssRBM cho phép mở rộng theo nhiều cách<s>cho phép nhiều mở rộng</s>. Bao gồm giao tiếp bậc cao và ~~pooling ~~phép gộp trung bình của biến slab cho phép mô hình học các đặc trưng <s>tính</s> cho bộ phân lớp khi dữ liệu có nhãn khan hiếm. Thêm một số hạng <s>thuật ngữ</s> vào hàm năng lượng mà ngăn hàm phân <s>chia</s> hoạch trở nên không xác định <s>kết quả</s> tạo ra <s>trong</s> một mô hình mã hoá thưa, mã hoá thưa spike và slab (Goodfellow et al., 2013d), còn được biết đến với tên S3C.</p><h1 id="206-Các-máy-Boltzmann-chậptích-chập"><a class="anchor hidden-xs" href="#206-Các-máy-Boltzmann-chậptích-chập" title="206-Các-máy-Boltzmann-chậptích-chập"><span class="octicon octicon-link"></span></a>20.6 Các máy Boltzmann <s>chập</s>tích chập</h1><p>Như đã thảo luận ở chương 9, <s>input</s> dữ liệu đầu vào với số chiều lớn như hình ảnh có thể đòi hỏi tiêu tốn nhiều tài nguyên <s>gây ra</s> <s>căng thẳng</s> về <s>yêu cầu</s> tính toán, bộ nhớ và <s>các yêu cầu</s> thống kê của các mô hình <s>học</s> máy học. Thay thế phép nhân ma trận bằng phép tích chập rời rạc với một lõi nhỏ là cách tiêu chuẩn để giải quyết bài toán này cho các đầu vào có bất biến về cấu trúc không gian hoặc thời gian.<br>
Desjardins and Bengio (2008) <s>cho thấy</s>chứng minh rằng phương pháp này áp dụng tốt với RBM.</p><p>Mạng tích chập đa tầng (Deep Convolutional Network) thường cần phép gộp <s>tổng hợp</s> để làm giảm kích thước không gian <s>qua</s> của các tầng kề nhau. <s>Bước</s> Mạng tích chập lan truyền <s>thuận</s>tiến sử dụng <s>phép</s> <s>tổng hợp</s> hàm gộp như là phép lấy cực đại của các phần tử. Không rõ làm cách nào để khái quát hóa điều này thành thiết lập của mô hình <s>dựa trên</s> hướng năng lượng. Ta có thể giới thiệu một đơn vị gộp <s>tổng hợp</s> nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4703">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">p</script></span> trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4705">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">n</script></span> đơn vị dò nhị phân <em><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4707">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">d</script></span></em> và <s>thực thi</s> ràng buộc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4714">p</span><span class="MJXp-mo" id="MJXp-Span-4715" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4716"><span class="MJXp-mo" id="MJXp-Span-4717" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4718" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-4719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4720" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4721" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">p = \max_id_i</script></span> bằng cách thiết lập hàm năng lượng trở thành <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4722"><span class="MJXp-mi" id="MJXp-Span-4723">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">\infty</script></span> bất cứ khi nào ràng buộc bị vi phạm. Tuy nhiên, quy mô của việc này bị hạn chế vì nó đòi hỏi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4724"><span class="MJXp-msubsup" id="MJXp-Span-4725"><span class="MJXp-mn" id="MJXp-Span-4726" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4727" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">2^n</script></span> thiết lập khác nhau cho hàm năng lượng <s>khác nhau</s> để tính toán hằng số chuẩn hoá. Với một phép <s>tổng hợp</s> gộp <s>trên</s> có kích thước mỗi đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4728"><span class="MJXp-mn" id="MJXp-Span-4729">3</span><span class="MJXp-mo" id="MJXp-Span-4730" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-4731">3</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">3\times 3</script></span>, cần <s>đánh giá</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4732"><span class="MJXp-msubsup" id="MJXp-Span-4733"><span class="MJXp-mn" id="MJXp-Span-4734" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4735" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-4736" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4737">512</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">2^9 = 512</script></span> hàm năng lượng cho mỗi đơn vị gộp <s>tổng hợp</s>.</p><p>Lee et al. (2009) đề xuất một giải pháp cho vấn đề này gọi là <strong><s>tổng hợp</s> phép gộp xác suất cực đại</strong> (probabilistic max pooling), (chú ý phân biệt với phép gộp ngẫu nhiên <em>stochastic pooling</em>, một kĩ thuật để xây dựng các mạng tích chập lan truyền <s>thuận</s>tiến). Chiến lược của <s>tổng hợp xác suất cực đại</s> phép gộp xác suất cực đại là hạn chế các đơn vị dò (detector) sao cho mỗi thời điểm chỉ có tối đa một đơn vị được kích hoạt. Nghĩa là chỉ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4739">n</span><span class="MJXp-mo" id="MJXp-Span-4740" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4741">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">n + 1</script></span> trạng thái (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4743">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">n</script></span> một trạng thái <s>tương ứng với đúng</s> một đơn vị dò trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4745">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">n</script></span> đơn vị dò ở trạng thái bật và một trạng thái ứng với tất cả các đơn vị ở trạng thái tắt). Đơn vị gộp <s>tổng hợp</s> được bật khi và chỉ khi <s>nếu và chỉ nếu</s> một trong các đơn vị dò ở trạng thái bật. Trạng thái ở đó tất cả các đơn vị dò đều tắt được gán mức năng lượng 0. Ta có thể xem như đang mô tả một mô hình với chỉ một biến có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4747">n</span><span class="MJXp-mo" id="MJXp-Span-4748" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4749">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-262">n + 1</script></span> trạng thái, hoặc tương đương mô hình có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4751">n</span><span class="MJXp-mo" id="MJXp-Span-4752" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4753">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">n + 1</script></span> biến được gán mức năng lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4754"><span class="MJXp-mi" id="MJXp-Span-4755">∞</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">\infty</script></span> cho tất cả trừ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4757">n</span><span class="MJXp-mo" id="MJXp-Span-4758" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4759">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-265">n + 1</script></span> bộ giá trị.</p><p><s>Trong khi</s> Ngoài sự hiệu quả, <s>việc tổng hợp</s> phép gộp xác suất cực đại buộc các đơn vị dò loại trừ lẫn nhau, có thể là một ràng buộc cơ chế kiểm soát hữu ích trong một vài bối cảnh hoặc là một giới hạn có hại về năng lực mô hình trong một vài bối cảnh khác. Nó cũng không hỗ trợ các <s>vùng tổng hợp</s> miền gộp chồng lấn lên nhau. Các <s>vùng tổng hợp</s> miền gộp chồng lấn lên nhau thường được yêu cầu có được hiệu suất tốt nhất từ <s>việc lan truyền <s>thuận</s>tiến các mạng chập</s> mạng tích chập lan truyền <s>thuận</s>tiến nên ràng buộc này có lẽ làm giảm đáng kể hiệu năng của máy tích chập Boltzmann <s>chập</s>.</p><p>Lee et al. (2009) đã chứng tỏ rằng phép gộp xác suất cực đại <s>xác suất tổng hợp cực đại</s> có thể được sử dụng để xây dựng các máy tích chập Boltzmann <s>chập</s> đa tầng<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4760"><span class="MJXp-msubsup" id="MJXp-Span-4761"><span class="MJXp-mi" id="MJXp-Span-4762" style="margin-right: 0.05em;"></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4763" style="vertical-align: 0.5em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">^3</script></span>. Mô hình này có khả năng thực hiện các thao tác như điền vào các phần còn thiếu của đầu vào. <s>Trong khi hấp dẫn trí tuệ</s><s>Ngoài việc thu hút về mặt trí tuệ, mô</s>Mô hình này đang gặp thách thức <s>trong</s> <s>vận hành</s> áp dụng thực tế và thường không thực hiện phân lớp tốt so với các mạng tích chập truyền thống được huấn luyện có giám sát.<br>
Nhiều mô hình mạng chập hoạt động tốt như nhau với kích thước không gian đầu vào khác nhau.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4764"><span class="MJXp-msubsup" id="MJXp-Span-4765"><span class="MJXp-mi" id="MJXp-Span-4766" style="margin-right: 0.05em;"></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4767" style="vertical-align: 0.5em;">3</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">^3</script></span> Bài công bổ mô tả mô hình như là một “mạng phân phối đa tầng”, nhưng vì nó có thể được mô tả như là một mô hình vô hướng thuần tuý với một trường trung bình hoàn thiện theo từng lớp được cập nhập tại các điểm cố định và có chi phí tính toán lớn, định nghĩa của máy Boltzmann đa tầng là phù hợp nhất với mô hình này.<br>
---------------------------------------------------------------------------<br>
\ Huy Thai ket thuc dich o day (676 - 680)<br>
---------------------------------------------------------------------------</p><p>.</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-20-Mô-hình-sinh-đa-tầng" title="Chương 20: Mô hình sinh đa tầng">Chương 20: Mô hình sinh đa tầng</a></li>
<li><a href="#201-Các-máy-Mô-hình-Boltzmann" title="20.1 Các máy Mô hình Boltzmann">20.1 Các máy Mô hình Boltzmann</a></li>
<li><a href="#202-Mô-hình-Boltzmann-hạn-chế-RBM" title="20.2 Mô hình Boltzmann hạn chế (RBM)">20.2 Mô hình Boltzmann hạn chế (RBM)</a><ul class="nav">
<li><a href="#2021-Phân-phối-có-điều-kiện" title="20.2.1 Phân phối có điều kiện">20.2.1 Phân phối có điều kiện</a></li>
<li><a href="#2022-Huấn-luyện-máy-Boltzmann-hạn-chế" title="20.2.2 Huấn luyện máy Boltzmann hạn chế">20.2.2 Huấn luyện máy Boltzmann hạn chế</a></li>
</ul>
</li>
<li><a href="#203-Mạng-phân-phối-đa-lớp-tầng" title="20.3 Mạng phân phối đa lớp tầng">20.3 Mạng phân phối đa lớp tầng</a></li>
<li><a href="#204-Máy-Boltzmann-sâu-đa-tầng" title="20.4 Máy Boltzmann sâu đa tầng">20.4 Máy Boltzmann sâu đa tầng</a><ul class="nav">
<li><a href="#2041-Các-tính-chất-đáng-chú-ý" title="20.4.1 Các tính chất đáng chú ý">20.4.1 Các tính chất đáng chú ý</a></li>
<li><a href="#2042-Suy-Diễn-Trường-Trung-Bình-DBM" title="20.4.2 Suy Diễn Trường Trung Bình DBM">20.4.2 Suy Diễn Trường Trung Bình DBM</a></li>
<li><a href="#2043-Quá-trình-học-các-tham-số-của-máy-Boltzman-đa-tầngsâu-DBM" title="20.4.3. Quá trình học các tham số của máy Boltzman đa tầngsâu (DBM)">20.4.3. Quá trình học các tham số của máy Boltzman đa tầngsâu (DBM)</a></li>
<li><a href="#2044-Tiền-huấn-luyện-theo-lớp" title="20.4.4. Tiền huấn luyện theo lớp">20.4.4. Tiền huấn luyện theo lớp</a></li>
<li><a href="#2045-Huấn-luyện-đồng-thời-các-máy-Boltzman-sâuđa-tầng" title="20.4.5. Huấn luyện đồng thời các máy Boltzman sâuđa tầng">20.4.5. Huấn luyện đồng thời các máy Boltzman sâuđa tầng</a></li>
</ul>
</li>
<li><a href="#205-Máy-Boltzmann-cho-dữ-liệu-có-giá-trị-thực-Real-Valued-Data" title="20.5 Máy Boltzmann cho dữ liệu có giá trị thực (Real-Valued Data)">20.5 Máy Boltzmann cho dữ liệu có giá trị thực (Real-Valued Data)</a><ul class="nav">
<li><a href="#2051-Các-máy-Boltzmann-bị-hạn-chế-dạng-Gaussian-Bernoulli" title="20.5.1 Các máy Boltzmann bị hạn chế dạng Gaussian-Bernoulli">20.5.1 Các máy Boltzmann bị hạn chế dạng Gaussian-Bernoulli</a></li>
<li><a href="#2052-Các-mô-hình-không-trực-tiếp-vô-hướng-của-hiệp-phương-sai-có-điều-kiện" title="20.5.2 Các mô hình không trực tiếp vô hướng của hiệp phương sai có điều kiện">20.5.2 Các mô hình không trực tiếp vô hướng của hiệp phương sai có điều kiện</a></li>
</ul>
</li>
<li><a href="#206-Các-máy-Boltzmann-chậptích-chập" title="20.6 Các máy Boltzmann chậptích chập">20.6 Các máy Boltzmann chậptích chập</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Chương-20-Mô-hình-sinh-đa-tầng" title="Chương 20: Mô hình sinh đa tầng">Chương 20: Mô hình sinh đa tầng</a></li>
<li><a href="#201-Các-máy-Mô-hình-Boltzmann" title="20.1 Các máy Mô hình Boltzmann">20.1 Các máy Mô hình Boltzmann</a></li>
<li><a href="#202-Mô-hình-Boltzmann-hạn-chế-RBM" title="20.2 Mô hình Boltzmann hạn chế (RBM)">20.2 Mô hình Boltzmann hạn chế (RBM)</a><ul class="nav">
<li><a href="#2021-Phân-phối-có-điều-kiện" title="20.2.1 Phân phối có điều kiện">20.2.1 Phân phối có điều kiện</a></li>
<li><a href="#2022-Huấn-luyện-máy-Boltzmann-hạn-chế" title="20.2.2 Huấn luyện máy Boltzmann hạn chế">20.2.2 Huấn luyện máy Boltzmann hạn chế</a></li>
</ul>
</li>
<li><a href="#203-Mạng-phân-phối-đa-lớp-tầng" title="20.3 Mạng phân phối đa lớp tầng">20.3 Mạng phân phối đa lớp tầng</a></li>
<li><a href="#204-Máy-Boltzmann-sâu-đa-tầng" title="20.4 Máy Boltzmann sâu đa tầng">20.4 Máy Boltzmann sâu đa tầng</a><ul class="nav">
<li><a href="#2041-Các-tính-chất-đáng-chú-ý" title="20.4.1 Các tính chất đáng chú ý">20.4.1 Các tính chất đáng chú ý</a></li>
<li><a href="#2042-Suy-Diễn-Trường-Trung-Bình-DBM" title="20.4.2 Suy Diễn Trường Trung Bình DBM">20.4.2 Suy Diễn Trường Trung Bình DBM</a></li>
<li><a href="#2043-Quá-trình-học-các-tham-số-của-máy-Boltzman-đa-tầngsâu-DBM" title="20.4.3. Quá trình học các tham số của máy Boltzman đa tầngsâu (DBM)">20.4.3. Quá trình học các tham số của máy Boltzman đa tầngsâu (DBM)</a></li>
<li><a href="#2044-Tiền-huấn-luyện-theo-lớp" title="20.4.4. Tiền huấn luyện theo lớp">20.4.4. Tiền huấn luyện theo lớp</a></li>
<li><a href="#2045-Huấn-luyện-đồng-thời-các-máy-Boltzman-sâuđa-tầng" title="20.4.5. Huấn luyện đồng thời các máy Boltzman sâuđa tầng">20.4.5. Huấn luyện đồng thời các máy Boltzman sâuđa tầng</a></li>
</ul>
</li>
<li><a href="#205-Máy-Boltzmann-cho-dữ-liệu-có-giá-trị-thực-Real-Valued-Data" title="20.5 Máy Boltzmann cho dữ liệu có giá trị thực (Real-Valued Data)">20.5 Máy Boltzmann cho dữ liệu có giá trị thực (Real-Valued Data)</a><ul class="nav">
<li><a href="#2051-Các-máy-Boltzmann-bị-hạn-chế-dạng-Gaussian-Bernoulli" title="20.5.1 Các máy Boltzmann bị hạn chế dạng Gaussian-Bernoulli">20.5.1 Các máy Boltzmann bị hạn chế dạng Gaussian-Bernoulli</a></li>
<li><a href="#2052-Các-mô-hình-không-trực-tiếp-vô-hướng-của-hiệp-phương-sai-có-điều-kiện" title="20.5.2 Các mô hình không trực tiếp vô hướng của hiệp phương sai có điều kiện">20.5.2 Các mô hình không trực tiếp vô hướng của hiệp phương sai có điều kiện</a></li>
</ul>
</li>
<li><a href="#206-Các-máy-Boltzmann-chậptích-chập" title="20.6 Các máy Boltzmann chậptích chập">20.6 Các máy Boltzmann chậptích chập</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
