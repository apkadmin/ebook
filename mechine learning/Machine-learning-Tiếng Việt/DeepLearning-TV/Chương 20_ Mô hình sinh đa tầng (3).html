<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-20-Mô-hình-sinh-đa-tầng">Chương 20: Mô hình sinh đa tầng</h1><p>(Giai đoạn 2)<br>
<a href="https://www.deeplearningbook.org/contents/generative_models.html" target="_blank" rel="noopener">https://www.deeplearningbook.org/contents/generative_models.html</a></p><p>Hung Le Thanh bat dau dich tai day (681 - 685)------</p><p>Nhiều mô hình tích chập hoạt động tốt như nhau với nhiều kích cỡ đầu vào (spatial size) khác nhau. Đối với các máy Boltzmann, thật khó để thay đổi kích thước đầu vào vì nhiều lý do khác nhau. Hàm phân hoạch thay đổi khi kích thước của đầu vào thay đổi. Hơn nữa, nhiều mạng tích chập đạt được kích thước bất biến bằng cách mở rộng kích thước (theo chiều dọc) các vùng gộp của chúng tỷ lệ với kích thước của đầu vào, nhưng mở rộng các vùng gộp của máy Boltzmann là khó khăn. Các mạng tích chập truyền thống có thể sử dụng một số lượng cố định các đơn vị gộp và tự động tăng kích thước của các vùng gộp của chúng để thu được một biểu diễn có kích thước cố định của một đầu vào có kích thước khác nhau <s>của một giá trị biến đổi</s>. Đối với các máy Boltzmann, các khu vực gộp lớn trở nên quá tốn kém đối với phương pháp cơ bản<s>tiếp cận sau đó</s>. Cách tiếp cận của Lee và cộng sự (2009) là làm cho mỗi đơn vị phát hiện <s>của việc làm cho mỗi người trong số các nhà phát hiện</s> trong cùng một vùng gộp <s>tổng hợp</s> loại trừ lẫn nhau <s>độc quyền</s> giải quyết các vấn đề tính toán nhưng vẫn không cho phép các vùng gộp có kích thước khác nhau. Ví dụ, giả sử chúng ta học <s>tìm hiểu</s> một mô hình với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">2</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-4">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main; padding-left: 0.218em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">2 \times 2</script></span> <s>tối đa gộp</s> phép gộp xác suất theo giá trị cực đại trên các đơn vị phát hiện để học bộ phát hiện biên <s>thiết bị dò tìm thấy các máy dò cạnh</s>. Điều này thực thi ràng buộc rằng chỉ một trong các biên <s>giá trị</s> này có thể xuất hiện trong mỗi vùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mn" id="MJXp-Span-6">2</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-8">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.218em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">2 \times 2</script></span>. Nếu sau đó ta <s>chúng tôi</s> tăng kích thước của các ảnh đầu vào lên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mn" id="MJXp-Span-10">50</span><span class="MJXp-mi" id="MJXp-Span-11">%</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-12"><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">50</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Main;">%</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">50\%</script></span> theo mỗi hướng, ta <s>chúng tôi</s> hy vọng số biên <s>cạnh</s> sẽ tăng tương ứng. Thay vào đó, nếu chúng ta tăng kích thước của vùng gộp lên <s>lại</s> 50 phần trăm theo mỗi hướng lên <s>đến</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mn" id="MJXp-Span-13">3</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-15">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-16"><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mn" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.218em;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">3 \times 3</script></span>, thì ràng buộc loại trừ lẫn nhau <s>về độc quyền đặc biệt</s> nay chỉ định rằng <s>là</s> mỗi biên <s>cạnh</s> này chỉ có thể xuất hiện một lần trong vùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mn" id="MJXp-Span-17">3</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-19">3</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-21"><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mn" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.218em;">3</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">3 \times 3</script></span>. Khi chúng ta <s>phát triển</s> tăng kích thước của một hình ảnh đầu vào của mô hình theo cách này, mô hình sinh <s>tạo ra</s> các biên <s>cạnh</s> <s>không có mật độ vô biên</s> với mật độ thấp hơn. Tất nhiên, những vấn đề này chỉ phát sinh khi mô hình phải sử dụng một số lượng vùng gộp biến đổi <s>ariableamounts của pooling</s> để phát ra một vector đầu ra có kích thước cố định <s>ﬁ xed</s>. Các mô hình sử dụng phép gộp xác suất theo giá trị cực đại  <s>có khả năng cộng gộp tối đa</s> có thể vẫn chấp nhận các hình ảnh đầu vào có kích thước khác nhau miễn là đầu ra của mô hình là bản đồ đặc trưng <s>khi đầu ra dài của mô hình là một bản đồ tính năng</s> có thể có cùng tỷ lệ với hình ảnh đầu vào.</p><p>Các điểm ảnh ở biên <s>ranh giới</s> của hình ảnh cũng đặt ra một số khó khăn <s>tính di truyền</s>, điều này càng trở nên trầm trọng hơn bởi thực tế là các kết nối trong một máy Boltzmann là đối xứng. Nếu ta không ngầm thêm đường viền phụ vào đầu vào<s>wedo không hoàn toàn không chèn đầu vào</s>, sẽ có ít đơn vị ẩn hơn các đơn vị khả kiến <s>phần tử hiển thị</s> và các đơn vị khả kiến <s>đơn vị hiển thị</s> ở biên <s>ranh giới</s> của hình ảnh sẽ không được mô hình hóa tốt bởi vì chúng nằm trong trường tiếp nhận của ít đơn vị ẩn hơn. Tuy nhiên, nếu ta ngầm thêm đường viền phụ vào đầu vào <s>nếu chúng ta không hiểu rõ đầu vào</s>, thì các đơn vị ẩn ở biên <s>ranh giới</s> sẽ được điều khiển bởi ít điểm ảnh <s>pixel</s> đầu vào hơn và có thể không kích hoạt khi cần thiết.</p><h1 id="207-Máy-Boltzmann-cho-đầu-ra-có-cấu-trúc-hoặc-đầu-ra-tuần-tự-cấu-trúc-hoặc-SequentialOutputs">20.7 Máy Boltzmann cho đầu ra có cấu trúc hoặc đầu ra tuần tự <s>cấu trúc hoặc SequentialOutputs</s></h1><p>Trong kịch bản đầu ra có cấu trúc, ta muốn huấn luyện <s>chúng tôi muốn đào tạo</s> một mô hình có thể ánh xạ từ một số đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-21">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\boldsymbol x</script></span> <s>fromsome inputxto</s> đến một số đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-23">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\boldsymbol y</script></span> <s>outputy</s>, và các mục nhập khác của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-25">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\boldsymbol y</script></span> <s>củayy</s> liên quan với nhau <s>đếneachother</s> và phải tuân theo một số ràng buộc. Ví dụ: trong tác vụ <s>nhiệm vụ</s> tổng hợp giọng nói, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-27">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\boldsymbol y</script></span> <s>y</s> là một dạng sóng, và toàn bộ dạng sóng phải giống như một lời nói mạch lạc.</p><p>Một cách tự nhiên để biểu diễn <s>đại diện</s> cho các mối quan hệ giữa các mục nhập <s>nằm</s> trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-28"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-29">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\boldsymbol y</script></span> là sử dụng một phân phối xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-32">p</span></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-34">y</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">x</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-41"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-46" style="font-family: MathJax_Main;">y</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\mathcal{p}(\text y \mid x)</script></span>. Các máy Boltzmann, mở rộng đến các mô hình phân phối có điều kiện <s>phân phối mô hình điều kiện</s>, có thể cung cấp mô hình xác suất này.</p><p>Cùng một công cụ mô hình hóa có điều kiện với một máy Boltzmann có thể được sử dụng không chỉ cho các tác vụ <s>nhiệm vụ</s> đầu ra có cấu trúc, mà còn cho tác vụ mô hình hóa chuỗi <s>việc lập mô hình chuỗi</s>. Trong trường hợp thứ hai, thay vì ánh xạ một đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-38"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-39">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\boldsymbol x</script></span> cho một đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-41">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol y</script></span>, mô hình phải ước tính một phân phối xác suất <s>khả năng phân phối</s> trên một chuỗi các biến, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-44">p</span></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mtext" id="MJXp-Span-47" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-48" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-49">(</span><span class="MJXp-mn" id="MJXp-Span-50">1</span><span class="MJXp-mo" id="MJXp-Span-51">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mtext" id="MJXp-Span-56" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-57" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-58">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">τ</span><span class="MJXp-mo" id="MJXp-Span-60">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-57"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-63" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mo" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-72" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-73" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\mathcal{p}(\text x^{(1)}, \dots,\text x^{(\tau)})</script></span>. Máy <s>ConditionalBoltzmann</s> Boltzmann có điều kiện có thể biểu diễn <s>đại diện</s> các yếu tố có dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-mrow" id="MJXp-Span-63"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-64">p</span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mtext" id="MJXp-Span-67" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-68" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-69">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">t</span><span class="MJXp-mo" id="MJXp-Span-71">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mtext" id="MJXp-Span-74" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-75" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-76">(</span><span class="MJXp-mn" id="MJXp-Span-77">1</span><span class="MJXp-mo" id="MJXp-Span-78">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mtext" id="MJXp-Span-83" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-84" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-85">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">t</span><span class="MJXp-mo" id="MJXp-Span-87">−</span><span class="MJXp-mn" id="MJXp-Span-88">1</span><span class="MJXp-mo" id="MJXp-Span-89">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-81"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-87" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mo" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="msubsup" id="MathJax-Span-94" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-95" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-104" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mtext" id="MathJax-Span-105" style="font-family: MathJax_Main;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-106"><span class="mrow" id="MathJax-Span-107"><span class="mo" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-112" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\mathcal{p}(\text x^{(t)} \mid \text x^{(1)}, \dots, \text x^{(t -1)} )</script></span> để hoàn thành tác vụ này.</p><p>Một tác vụ <s>nhiệm vụ</s> mô hình hóa chuỗi quan trọng cho ngành công nghiệp trò chơi điện tử <s>video</s> và phim ảnh là mô hình hóa chuỗi của các góc khớp của bộ xương  <s>chuỗi mô hình hóa ngành công nghiệp của các góc chung của bộ xương</s> được sử dụng để hiển thị các <s>ký tự</s> nhân vật 3-D.Các chuỗi <s>trình tự</s> này thường được thu thập bằng cách sử dụng các hệ thống chụp chuyển động để ghi lại các chuyển động <s>thành phần</s> của diễn viên. Một mô hình xác suất của chuyển động của nhân vật cho phép sinh <s>tạo ra</s> các hình ảnh động mới, trước đây chưa từng thấy, nhưng thực tế. Để giải quyết tác vụ mô hình hóa chuỗi này <s>solvethis nhiệm vụ mô hình trình tự</s>, <em>Taylor et al</em>. (2007) đã giới thiệu một mô hình RBM <s>RBMmodelingp</s> có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mrow" id="MJXp-Span-92"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-93">p</span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-97" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-98">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">t</span><span class="MJXp-mo" id="MJXp-Span-100">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-102"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-103" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-104" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-105">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">t</span><span class="MJXp-mo" id="MJXp-Span-107">−</span><span class="MJXp-mn" id="MJXp-Span-108">1</span><span class="MJXp-mo" id="MJXp-Span-109">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-115" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-116">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">t</span><span class="MJXp-mo" id="MJXp-Span-118">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">m</span><span class="MJXp-mo" id="MJXp-Span-120">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-115"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mo" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="msubsup" id="MathJax-Span-128" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mo" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-140" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mo" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\mathcal{p}(\boldsymbol x^{(t)} \mid \boldsymbol x^{(t-1)}, \dots,\boldsymbol x^{(t-m)})</script></span>  cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">m</script></span> nhỏ. Mô hình là một <s>giá trị</s> RBM trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-124"><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-126">p</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-130" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-131">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">t</span><span class="MJXp-mo" id="MJXp-Span-133">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-154"><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mo" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\mathcal{p}(\boldsymbol x^{(t)})</script></span> có tham số thiên vị là hàm tuyến tính của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">m</script></span> giá trị trước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-138">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">\boldsymbol x</script></span>. Khi ta đặt điều kiện về <s>điều chỉnh các</s> giá trị khác nhau của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-139"><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-141" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-142" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-143">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">t</span><span class="MJXp-mo" id="MJXp-Span-145">−</span><span class="MJXp-mn" id="MJXp-Span-146">1</span><span class="MJXp-mo" id="MJXp-Span-147">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mo" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\boldsymbol x^{(t-1)}</script></span> và các biến trước đó, chúng ta sẽ nhận được một RBM mới trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mtext" id="MJXp-Span-149">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-184"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-185"><span class="mtext" id="MathJax-Span-186" style="font-family: MathJax_Main;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\boldsymbol {\text x}</script></span> <s>giá trị mớiRBM</s>. Các trọng số trong <s>sự thay đổi quá mức RBM</s> RBM trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mrow" id="MJXp-Span-151"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-152">x</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-188"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mtext" id="MathJax-Span-191" style="font-family: MathJax_Main-bold;">x</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\textbf x</script></span> không bao giờ thay đổi, nhưng bằng cách điều chỉnh các giá trị trong quá khứ, chúng ta có thể thay đổi xác suất của các đơn vị ẩn khác nhau trong RBM đang hoạt động. Bằng cách kích hoạt và hủy kích hoạt các tập con riêng biệt của các đơn vị ẩn, chúng ta có thể thực hiện các thay đổi lớn đối với phân bố xác suất được tạo ra trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mrow" id="MJXp-Span-154"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-155">x</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-192"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-193"><span class="texatom" id="MathJax-Span-194"><span class="mrow" id="MathJax-Span-195"><span class="mtext" id="MathJax-Span-196" style="font-family: MathJax_Main-bold;">x</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\textbf x</script></span> <s>gây ra onx</s>. Các biến thể khác của RBM có điều kiện (<em>Mnih et al</em> <s>và cộng sự</s>, 2011) và các biến thể khác của mô hình hóa chuỗi <s>chuỗi mã hóa</s> sử dụng RBM có điều kiện là có thể (<em>Taylor và Hinton</em>, 2009; <em>Sutskeveret et al</em>., 2009; <em>Boulanger-Lewandowski et al</em>., 2012).</p><p>Một tác vụ <s>nhiệm vụ</s> mô hình hóa chuỗi khác là mô hình phân phối theo chuỗi các nốt nhạc được sử dụng để soạn các bài hát. <em>Boulanger-Lewandowski et al</em>. (2012) đã giới thiệu mô hình chuỗi RNN-RBM<s>sequence</s> và áp dụng nó cho tác vụ <s>nhiệm vụ</s> này. RNN-RBM là một mô hình sinh <s>học</s> của một chuỗi các khung <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-159" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-160">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">t</span><span class="MJXp-mo" id="MJXp-Span-162">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-198"><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\boldsymbol x^{(t)}</script></span> <s>framex (t) <s>bao gồm một RNN</s>that</s> phát ra các tham số RBM cho mỗi bước thời gian. Không giống như các phương pháp tiếp cận trước đó mà chỉ có các tham số thiên vị của RBM thay đổi từ bước này sang bước tiếp theo, RNN-RBM sử dụng RNN để phát ra tất cả các tham số của RBM, bao gồm trọng số. Để <s>đào tạo</s> huấn luyện mô hình, ta cần có khả năng truyền ngược gradient của hàm mất mát <s>truyền lại gradientof chức năng mất</s> thông qua RNN. Hàm mất mát <s>Chức năng mất</s> không được áp dụng trực tiếp cho các đầu ra của RNN. Thay vào đó, nó được áp dụng cho RBM. Điều này có nghĩa là chúng ta phải lấy vi phân xấp xỉ <s>cân nhắc</s> sự mất mát đối với các tham số RBM bằng cách sử dụng phân kỳ tương phản <s>liên kết</s> hoặc một thuật toán liên quan. Gradient gần đúng này có thể được truyền ngược <s>lại</s> thông qua RNN bằng cách sử dụng thuật toán truyền ngược thông thường theo thời gian <s>thông thường truyền qua lại thông thường</s>.</p><h1 id="208-Các-máy-Boltzmann-khác">20.8 Các máy Boltzmann khác</h1><p>Nhiều biến thể khác của máy Boltzmann là <s>có thể</s> khả thi.<br>
Máy Boltzmann có thể được mở rộng với các tiêu chí <s>đào tạo</s> huấn luyện khác nhau. Chúng ta đã tập trung vào các máy Boltzmann được <s>đào tạo</s> huấn luyện để tối đa hóa khoảng tiêu chí sinh mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi" id="MJXp-Span-164">log</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-166"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-167">p</span></span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-169">υ</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-209"></span><span class="texatom" id="MathJax-Span-210" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-bold-italic;">υ</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\log \mathcal{p}(\boldsymbol \upsilon)</script></span> <s>tối đa hóa tối đa nhật ký tiêu chí sinh sản p (v)</s>. Ta cũng có thể <s>đào tạo</s> huấn luyện các <s>bộ phân biệt</s> RBM khác nhau <s>RBM phân biệt đối xử</s> nhằm mục đích tối đa hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-171"><span class="MJXp-mi" id="MJXp-Span-172">log</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-174"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-175">p</span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">y</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-179">υ</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-219"></span><span class="texatom" id="MathJax-Span-220" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">υ</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\log \mathcal{p}(y \mid \boldsymbol\upsilon)</script></span> <s>tomaximizelog p (y | v) thay vào đó</s> thay thế (<em>Larochelle và Bengio</em>, 2008). Cách tiếp cận này thường thực hiện tốt nhất khi sử dụng kết hợp tuyến tính của cả hai tiêu chí sinh mẫu và phân biệt <s>sinh sản và phân biệt đối xử</s>. Thật không may, RBM dường như không phải là những người học <s>được</s> giám sát mạnh mẽ như MLP, ít nhất là sử dụng phương pháp hiện có.</p><p>Hầu hết các máy Boltzmann được sử dụng trong thực tế chỉ có các tương tác bậc hai trong các hàm <s>chức năng</s> năng lượng của chúng, nghĩa là các hàm năng lượng của chúng là tổng của nhiều số hạng <s>các phép đo</s>, và mỗi số hạng <s>thuật ngữ</s> riêng lẻ chỉ bao gồm tích <s>sản phẩm</s> giữa hai biến ngẫu nhiên. Một ví dụ về một số hạng <s>thuật ngữ</s> như vậy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-msubsup" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183" style="margin-right: 0.05em;">υ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-184" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">i</span><span class="MJXp-mo" id="MJXp-Span-189">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-193" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-229"><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">υ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.03em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.973em;"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\upsilon_i W_{i,j} h_j</script></span>. Cũng có thể <s>đặt</s> huấn luyện máy Boltzmann <s>đặt hàng</s> bậc cao hơn (<em>Sejnowski</em>, 1987) có các <s>thuật ngữ chức năng</s> số hạng của hàm năng lượng liên quan đến các tích <s>sản phẩm</s> giữa nhiều biến. Tương tác ba chiều giữa một đơn vị ẩn <s>ahidden</s> và hai hình ảnh khác nhau có thể mô hình các phép biến đổi không gian từ khung hình này sang khung hình tiếp theo của một video <s>khung nội tuyến của video sang video tiếp theo</s> (<em>Memisevic và Hinton</em>, 2007, 2010). Phép nhân các biến đơn trội <s>bằng biến lớp một nóng</s> có thể thay đổi mối quan hệ giữa các đơn vị khả kiến <s>hiển thị</s> và đơn vị ẩn phụ thuộc vào lớp nào có mặt (<em>Nair và Hinton</em>, 2009). Một ví dụ gần đây về việc sử dụng tương tác bậc cao hơn là một máy Boltzmann với hai nhóm đơn vị ẩn, một nhóm tương tác với cả các đơn vị <s>nhìn thấy được</s> khả kiến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">υ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">υ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\upsilon</script></span> và nhãn phân lớp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">y</script></span>  và một nhóm khác chỉ tương tác với các giá trị đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">υ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-250"><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic;">υ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">\upsilon</script></span> (<em>Luo et al.</em>, 2011). Điều này có thể được hiểu là khuyến khích một số đơn vị ẩn học <s>tìm hiểu</s> cách mô hình hóa đầu vào bằng cách sử dụng các đặc trưng <s>tính năng</s> có liên quan đến lớp, mà còn học <s>tìm hiểu</s> đơn vị ẩn bổ sung để giải thích các chi tiết phiền toái cần thiết cho các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">υ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">υ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">\upsilon</script></span> thực tế mà không cần xác định lớp của mẫu. Một cách sử dụng khác của tương tác bậc cao hơn là cổng một số đặc trưng <s>tính năng</s>. <em>Sohn et al</em>. (2013) <s>Máy</s> giới thiệu một máy Boltzmann với các tương tác bậc ba và các <s>một</s> biến mặt nạ nhị phân được liên kết với mỗi đơn vị khả kiến <s>nhìn thấy được</s>. Khi các biến mặt nạ này được thiết lập <s>đặt</s> thành không, chúng sẽ loại bỏ sự ảnh hưởng <s>xuất hiện</s> của một đơn vị khả kiến <s>hiển thị</s> trên các đơn vị ẩn. Điều này cho phép các đơn vị khả kiến <s>hiển thị</s> không liên quan đến <s>vấn đề</s> bài toán phân loại được loại bỏ khỏi <s>con đường</s> chuỗi suy luận để ước tính lớp.</p><p>Nói chung, bộ khung máy Boltzmann là một không gian phong phú của các mô hình cho phép nhiều cấu trúc mô hình hơn đã được khám phá cho đến nay. Việc phát triển một dạng mới của máy Boltzmann đòi hỏi nhiều sự <s>quan tâm</s> cẩn thận và sáng tạo hơn so với việc phát triển một tầng <s>lớp</s> mạng neuron mới, bởi vì <s>nó</s> thường khó để tìm ra <s>là</s> một hàm <s>chức năng</s> năng lượng để duy trì tính dễ kiểm soát <s>khả năng kéo</s> của tất cả các phân phối có điều kiện khác nhau cần thiết để sử dụng máy Boltzmann. Bất chấp những nỗ lực bắt buộc này<s>Mặc dù có yêu cầu này</s>, lĩnh vực này vẫn <s>eldeldains</s> mở cửa cho sự đổi mới.</p><h1 id="209-Lan-truyền-ngược-bằng-các-phép-toán-ngẫu-nhiên">20.9 Lan truyền ngược bằng các phép toán ngẫu nhiên</h1><p>Các mạng neuron truyền thống thực hiện một phép biến đổi xác định của các biến đầu vào <s>ra</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-203">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">\boldsymbol x</script></span>. Khi phát triển các mô hình sinh mẫu, chúng ta thường muốn mở rộng các mạng neuron để thực hiện các biến đổi ngẫu nhiên của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-205">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">\boldsymbol x</script></span>. Một cách trực tiếp để làm điều này là tăng thêm mạng neuron với đầu vào bổ sung <s>phụ</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-207">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-261"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">\boldsymbol z</script></span> được lấy mẫu từ một số phân phối xác suất đơn giản, chẳng hạn như phân <s>bố đồng</s> phối đều hoặc phân <s>bố</s> phối Gauss<s>ian</s>. Mạng neuron sau đó có thể tiếp tục thực hiện tính toán xác định nội bộ, nhưng hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mrow" id="MJXp-Span-209"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-210">f</span></span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-212">x</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-214" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-215">z</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-265"><span class="texatom" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-272" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">\mathcal{f}(\boldsymbol x, \, \boldsymbol z)</script></span> sẽ xuất hiện ngẫu nhiên đối với một người quan sát không có quyền truy cập vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-218">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">\boldsymbol z</script></span>. Với điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">f</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-279"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">f</script></span> là liên tục và khả vi <s>có thể xác định được</s>, ta có thể tính toán các gradient cần thiết cho việc huấn luyện sử dụng lan truyền ngược như bình thường.</p><p>Ví dụ, chúng ta hãy xem xét hoạt động bao gồm việc vẽ các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-281"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">y</script></span> từ phân phối Gauss<s>ian</s> với giá trị trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">μ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">μ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">\mu</script></span> <s><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">µ</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-288"><span class="texatom" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mo" id="MathJax-Span-291"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: normal; font-weight: normal;">µ</span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">µ</script></span></s> và phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-231" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-232">2</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-293"><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mn" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">\sigma^{2}</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-233"><span class="MJXp-mtable" id="MJXp-Span-234"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-235" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-236" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">y</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-240">N</span></span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">z</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;">σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-246" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-247">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-299"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-300"><span class="mtable" id="MathJax-Span-301" style="min-width: 13.526em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.526em;"><span style="display: inline-block; position: absolute; width: 5.822em; height: 0px; clip: rect(-0.967em, 1005.71em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -2.907em;"><span style="position: absolute; clip: rect(3.02em, 1005.71em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.822em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1005.71em, 4.421em, -999.997em); top: -3.93em; left: 50%; margin-left: -2.907em;"><span class="mtd" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.272em;">∼</span><span class="texatom" id="MathJax-Span-309" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-315" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="mn" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-20.54"><span class="mrow" id="MathJax-Span-303"><span class="mtext" id="MathJax-Span-304" style="font-family: MathJax_Main;">(20.54)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-43"> y \sim \mathcal{N}(z,\sigma^{2}). 
\tag{20.54} </script></span></p><p>Bởi vì một mẫu riêng lẻ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-322"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">y</script></span> được tạo ra không phải bởi một hàm, mà là bởi một quá trình lấy mẫu có đầu ra thay đổi mỗi khi chúng ta truy vấn, việc này có vẻ khác thường khi lấy các đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">y</script></span> đối với các tham số của phân phối của nó, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">μ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic;">μ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\mu</script></span>  và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-msubsup" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258" style="margin-right: 0.05em;">σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-259" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-260">2</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-332"><span class="msubsup" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mn" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">\sigma^{2}</script></span>. Tuy nhiên, chúng ta có thể viết lại quá trình lấy mẫu để tạo ra một giá trị ngẫu nhiên cơ bản <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">z</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-264"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-265">N</span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">z</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-269">0</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-271">1</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.272em;">∼</span><span class="texatom" id="MathJax-Span-342" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">;</span><span class="mn" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">z \sim \mathcal{N}(z;0,1)</script></span> để lấy mẫu từ phân phối mong muốn:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-273"><span class="MJXp-mtable" id="MJXp-Span-274"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-275" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-276" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">y</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">μ</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">σ</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">z</span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-353"><span class="mtable" id="MathJax-Span-354" style="min-width: 12.664em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.664em;"><span style="display: inline-block; position: absolute; width: 4.96em; height: 0px; clip: rect(-0.913em, 1004.85em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.476em;"><span style="position: absolute; clip: rect(3.289em, 1004.85em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.96em; height: 0px;"><span style="position: absolute; clip: rect(3.235em, 1004.85em, 4.367em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.476em;"><span class="mtd" id="MathJax-Span-358"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">μ</span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-20.55"><span class="mrow" id="MathJax-Span-356"><span class="mtext" id="MathJax-Span-357" style="font-family: MathJax_Main;">(20.55)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-49"> y = \mu + \sigma{z}. \tag{20.55}</script></span><br>
Bây giờ ta có thể lan truyền ngược thông qua phép toán lấy mẫu, bằng cách xem <s>liên quan đến</s> nó như là một phép toán xác định với đầu vào bổ sung <s>phụ</s> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">z</script></span>. Điều quan trọng, đầu vào bổ sung <s>thêm</s> là một biến ngẫu nhiên có phân phối không phải là một hàm của bất kỳ biến nào có đạo hàm mà ta muốn tính toán. Kết quả cho ta biết rằng một sự thay đổi vô cùng nhỏ <s>đặc biệt</s> trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">μ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-372"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">μ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">\mu</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">σ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">\sigma</script></span> sẽ thay đổi đầu ra như thế nào nếu chúng ta có thể lặp lại phép toán lấy mẫu với cùng giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">z</script></span>.</p><p>Việc có thể lan truyền ngược bằng phép toán lấy mẫu này cho phép chúng ta kết hợp nó vào một đồ thị lớn hơn. Chúng ta có thể xây dựng các phần tử của đồ thi trên đầu ra của phân bố lấy mẫu. Ví dụ, chúng ta có thể tính toán các đạo hàm <s>dẫn xuất</s> của một số hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mrow" id="MJXp-Span-294"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-295">J</span></span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">y</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-382"><span class="texatom" id="MathJax-Span-383"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">\mathcal{J}(y)</script></span>. Chúng ta cũng có thể xây dựng các phần tử của đồ thị có đầu ra là các đầu vào hoặc các tham số của phép toán lấy mẫu. Ví dụ, chúng ta có thể xây dựng một đồ thị lớn hơn với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">μ</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-303">f</span></span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-305">x</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-307">θ</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-389"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">μ</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-393" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">\mu = \mathcal{f} (\boldsymbol x ; \boldsymbol\theta)</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">σ</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">g</span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-314">x</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-316">θ</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">\sigma = g(\boldsymbol x; \boldsymbol\theta)</script></span> . Trong đồ thị tăng cường này, chúng ta có thể sử dụng sự lan truyền ngược qua các hàm này để lấy đạo hàm  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.267em; margin-right: 0.05em;">▽</span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mrow" id="MJXp-Span-322"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-323">J</span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">y</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-411"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-412"><span class="msubsup" id="MathJax-Span-413"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1000.81em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main;">▽</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.865em;"><span class="mi" id="MathJax-Span-415" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">\bigtriangledown_\boldsymbol\theta \mathcal{J}(y)</script></span>.</p><p>Nguyên tắc được sử dụng trong ví dụ lấy mẫu Gauss<s>ian</s> này thường được áp dụng nhiều hơn. Chúng ta có thể biểu diễn bất kỳ phân bố xác suất nào của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-327"><span class="MJXp-mrow" id="MJXp-Span-328"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-329">p</span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">y</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-333">θ</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-422"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-423"><span class="texatom" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">\mathcal{p}(y;\boldsymbol\theta)</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mrow" id="MJXp-Span-336"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-337">p</span></span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">y</span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-341">x</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-343">θ</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-433"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">\mathcal{p}(y \mid \boldsymbol x ; \boldsymbol\theta)</script></span> như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mrow" id="MJXp-Span-346"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-347">p</span></span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">y</span><span class="MJXp-mspace" id="MJXp-Span-350" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-351"><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-353" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-354">ω</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-445"><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mspace" id="MathJax-Span-451" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">|</span></span></span><span class="mspace" id="MathJax-Span-455" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-bold-italic;">ω</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">\mathcal{p}(y \,|\, \boldsymbol\omega)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-356"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-357">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-458"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\boldsymbol\omega</script></span> là một biến chứa cả hai tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-359">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-461"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">\boldsymbol\theta</script></span>, và nếu có, đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-361">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">\boldsymbol x</script></span>. Cho một giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-468"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">y</script></span> lấy mẫu từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mrow" id="MJXp-Span-365"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-366">p</span></span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">y</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-370">ω</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-471"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">ω</span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">\mathcal{p}(y \mid \boldsymbol\omega)</script></span>, trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-372"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-373">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">\boldsymbol\omega</script></span> có thể lần lượt là một hàm của các biến khác, chúng ta có thể viết lại</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-374"><span class="MJXp-mtable" id="MJXp-Span-375"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-376" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-377" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-378">y</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-380"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-381">p</span></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-383">y</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-385">ω</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-484"><span class="mtable" id="MathJax-Span-485" style="min-width: 13.311em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.311em;"><span style="display: inline-block; position: absolute; width: 5.606em; height: 0px; clip: rect(-0.913em, 1005.5em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.799em;"><span style="position: absolute; clip: rect(3.128em, 1005.5em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.606em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1005.5em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.799em;"><span class="mtd" id="MathJax-Span-489"><span class="mrow" id="MathJax-Span-490"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-bold-italic;">y</span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main; padding-left: 0.272em;">∼</span><span class="texatom" id="MathJax-Span-493" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-bold-italic;">y</span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">ω</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-20.56"><span class="mrow" id="MathJax-Span-487"><span class="mtext" id="MathJax-Span-488" style="font-family: MathJax_Main;">(20.56)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-67"> \boldsymbol y \sim \mathcal{p} (\boldsymbol y \mid \boldsymbol\omega). \tag{20.56}</script></span></p><p>như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-388"><span class="MJXp-mtable" id="MJXp-Span-389"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-390" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-391" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-392">y</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-394"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-395">f</span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-397">z</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-399">ω</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-503"><span class="mtable" id="MathJax-Span-504" style="min-width: 13.311em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.311em;"><span style="display: inline-block; position: absolute; width: 5.606em; height: 0px; clip: rect(-0.913em, 1005.55em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.799em;"><span style="position: absolute; clip: rect(3.128em, 1005.55em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.606em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1005.55em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.799em;"><span class="mtd" id="MathJax-Span-508"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-bold-italic;">y</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-512" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main; padding-left: 0.272em;">∣</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">ω</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-20.57"><span class="mrow" id="MathJax-Span-506"><span class="mtext" id="MathJax-Span-507" style="font-family: MathJax_Main;">(20.57)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-68"> \boldsymbol y = \mathcal{f} (\boldsymbol z \mid \boldsymbol\omega), \tag{20.57}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-402"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-403">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">\boldsymbol z</script></span> là một nguồn ngẫu nhiên. Sau đó chúng ta có thể tính toán các đạo hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-404"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-405">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">\boldsymbol y</script></span> theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-407">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">\boldsymbol\omega</script></span> bằng cách sử dụng các công cụ truyền thống như thuật toán lan truyền ngược áp dụng cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mrow" id="MJXp-Span-409"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-410">f</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-531"><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">\mathcal{f}</script></span>, miễn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-413">f</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-536"><span class="texatom" id="MathJax-Span-537"><span class="mrow" id="MathJax-Span-538"><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\mathcal{f}</script></span> là liên tục và khả vi ở mọi điểm <s>có thể phân biệt hầu như ở mọi nơi</s>. Quan trọng,<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-415">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">\boldsymbol\omega</script></span> không được là hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-416"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-417">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">\boldsymbol z</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-418"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-419">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">\boldsymbol z</script></span> không phải là hàm của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-421">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">\boldsymbol\omega</script></span>. Kỹ thuật này thường được gọi là thủ thuật tham số hoá <s>thereparametrization</s>, <s>phân tích ngược lại</s> lan truyền ngược ngẫu nhiên hoặc phân tích nhiễu loạn.</p><p>Yêu cầu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mrow" id="MJXp-Span-423"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-424">f</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-553"><span class="texatom" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">\mathcal{f}</script></span> liên tục và khả vi <s>có thể xác định được</s> hiển nhiên yêu cầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-426">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">\boldsymbol y</script></span> phải liên tục. Nếu chúng ta muốn lan truyền ngược qua một quá trình lấy mẫu và tạo ra các mẫu có giá trị rời rạc, thì vẫn có thể ước lượng một gradient trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-428">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-560"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">\boldsymbol\omega</script></span> , sử dụng các thuật toán học tăng cường như các biến thể của thuật toán REINFORCE (<em>Williams</em>, 1992), được thảo luận trong phần 20.9.1.</p><p>Trong các ứng dụng của mạng neuron, chúng ta thường chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-564"><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">z</script></span> được rút ra từ một vài phân bố đơn giản, như <s>đơn vị đồng bộ hoặc đơn vị Gaussian phân phối</s> đơn vị phân phối đều và đơn vị phân phối Gauss, và đạt được phân phối phức tạp hơn bằng cách cho phép phần xác định của mạng định hình lại đầu vào của nó.</p><p>Ý tưởng lan truyền gradients hoặc tối ưu hóa thông qua các phép toán ngẫu nhiên có niên đại từ giữa thế kỷ XX (<em>Price</em> <s>Giá</s>, 1958; <em>Bonnet</em>, 1964) và lần đầu tiên được sử dụng <s>để</s> cho học máy trong bối cảnh học tăng cường (<em>Williams</em>, 1992). Gần đây hơn, nó đã được áp dụng cho các xấp xỉ biến thiên (<em>Opperand Archambeau</em>, 2009) và các mạng thần kinh ngẫu nhiên và mạng neuron sinh mẫu (<em>Bengioet et al</em>., 2013b; <em>Kingma</em>, 2013; <em>Kingma và Welling</em>, 2014b, a; <em>Rezende et al.</em>, 2014; <em>Goodfellow et al.</em>., 2014c). Nhiều mạng, chẳng hạn như các <s>bộ mã hóa tự động</s> bộ tự mã hoá khử nhiễu hoặc mạng được <s>chuẩn hóa với trình đơn thả xuống</s> kiểm soát với cơ chế tắt ngẫu nhiên, cũng được thiết kế tự nhiên để lấy nhiễu làm đầu vào mà không yêu cầu bất kỳ tham số hóa đặc biệt nào làm cho nhiễu không phụ thuộc vào mô hình.</p><p>Hung Le Thanh ket thuc dich tai day (681 - 685)--------</p><h2 id="Tuan-Pham-bắt-đầu-dịch-từ-đây--p686">Tuan Pham bắt đầu dịch từ đây ( p686)</h2><h2 id="2091-Lan-truyền-ngược-bằng-các-phép-tính-ngẫu-nhiên-rời-rạc">20.9.1 Lan truyền ngược bằng các phép tính ngẫu nhiên rời rạc</h2><p>Khi một mô hình phải tìm ra biến rời rạc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-432">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-567"><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">\boldsymbol y</script></span>, kỹ thuật tham số hóa sẽ không áp dụng được. Giả thiết là mô hình nhận dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-434">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">\boldsymbol x</script></span> và tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-435"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-436">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-573"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">\boldsymbol\theta</script></span>, cả hai được gói trong một vec tơ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-438">ω</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-bold-italic;">ω</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">\boldsymbol\omega</script></span>, kèm với một nhiễu ngẫu nhiên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-440">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-579"><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-bold-italic;">z</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">\boldsymbol z</script></span> để tính ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-442">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-bold-italic;">y</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">\boldsymbol y</script></span> :<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-443"><span class="MJXp-mtable" id="MJXp-Span-444"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-445" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-446" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">y</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-449"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-450">f</span></span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-452">z</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-454">ω</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-585"><span class="mtable" id="MathJax-Span-586" style="min-width: 12.557em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.557em;"><span style="display: inline-block; position: absolute; width: 4.852em; height: 0px; clip: rect(-0.913em, 1004.74em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.422em;"><span style="position: absolute; clip: rect(3.128em, 1004.74em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.852em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1004.74em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.422em;"><span class="mtd" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-594" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-595"><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-600" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">ω</span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 3.074em; height: 0px; clip: rect(-0.859em, 1002.97em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.97em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-20.58"><span class="mrow" id="MathJax-Span-588"><span class="mtext" id="MathJax-Span-589" style="font-family: MathJax_Main;">(20.58)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-88"> y = \mathcal{f}(\boldsymbol z;\boldsymbol\omega) \tag{20.58}</script></span></p><p>Do <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-603"><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">y</script></span> rời rạc, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mrow" id="MJXp-Span-459"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-460">f</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-606"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">\mathcal{f}</script></span> phải là một <em>hàm từng bước</em> (step function). Các đạo hàm của hàm từng bước sẽ không hữu dụng trên tất cả mọi điểm. Ngay tại biên của các bước, các đạo hàm là không xác định, tuy nhiên đó chỉ là một vấn đề nhỏ. Vấn đề thực sự là ở chỗ các đạo hàm có giá trị gần như bằng không trên mọi vùng nằm giữa các biên tương ứng với các bước. Các đạo hàm của bất kỳ <s>mọi</s> hàm chi phí nào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-463">J</span></span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-465">y</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-610"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-611"><span class="texatom" id="MathJax-Span-612"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-bold-italic;">y</span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">\mathcal{J}(\boldsymbol y)</script></span> cũng không cung cấp bất kỳ  thông tin nào về cách <s>giúp làm thế nào</s> cập nhật các tham số mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-467"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-468">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-619"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\boldsymbol\theta</script></span>.</p><p>Thuật toán REINFORCE ( viết tắt của cụm từ REward Increment = nonnegative Factor x Offset reinforcement x Characteristic Eligibility) cung cấp một <s>kết cấu định hình</s> bộ khung xác định một nhóm các giải pháp đơn giản nhưng rất mạnh mẽ ( Williams, 1992). Ý tưởng chủ đạo đó là ngay cả khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mrow" id="MJXp-Span-470"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-471">J</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-473"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-474">f</span></span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-476">z</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-478">ω</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-621"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-622"><span class="texatom" id="MathJax-Span-623"><span class="mrow" id="MathJax-Span-624"><span class="mi" id="MathJax-Span-625" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-627"><span class="mrow" id="MathJax-Span-628"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-630" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-631" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">ω</span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">\mathcal{J}(\mathcal{f}(\boldsymbol z; \boldsymbol\omega))</script></span> là một hàm từng bước với những đạo hàm không thực sự hữu ích, <em>chi phí được kỳ vọng</em> (the expected cost) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mrow" id="MJXp-Span-483" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-484">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-485" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-486"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-487">z</span></span><span class="MJXp-mo" id="MJXp-Span-488">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">p</span><span class="MJXp-mo" id="MJXp-Span-490">(</span><span class="MJXp-mrow" id="MJXp-Span-491"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-492">z</span></span><span class="MJXp-mo" id="MJXp-Span-493">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">J</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">f</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-498">z</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-500">ω</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-94-Frame" tabindex="0" style=""></span><script type="math/tex" id="MathJax-Element-94">\mathbb{E}_{\textbf z\sim p(\textbf z)} J(f(\boldsymbol z; \boldsymbol\omega))</script></span> luôn là một hàm <s>với độ</s> trơn <s>có thể thích ứng với phương pháp</s> tuân theo giảm theo gradient <s>trượt dốc</s>. Cho dù giả thiết này không thể thực hiện <s>được minh chứng đặc biệt trong trường hợp</s> khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-504">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-95-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-95">\boldsymbol y</script></span> có số chiều lớn (hoặc là kết quả của sự kết hợp của nhiều quyết định ngẫu nhiên rời rạc <s>sự kết hợp của nhiều kết quả thu được từ phương pháp ngẫu nhiên rời rạc rải rác</s>), nó có thể được ước lượng <s>phán đoán</s> mà không bị ảnh hưởng của độ chệch bằng việc sử dụng <em>phép trung bình Monte Carlo</em> (Monte Carlo average). Sự ước lượng <s>phán đoán</s> ngẫu nhiên của gradient có thể dùng SGD hay các kỹ thuật tối ưu hoá dựa trên gradient ngẫu nhiên.</p><p>Phiên bản đơn giản nhất của REINFORCE có thể được rút ra bằng cách lấy đạo hàm của chi phí được kỳ vọng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-505"><span class="MJXp-mtable" id="MJXp-Span-506"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-507" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-508" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mrow" id="MJXp-Span-510" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-511">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">z</span></span></span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-515"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-516">J</span></span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-518">y</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mtd" id="MJXp-Span-521" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-522"></span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-524" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-525"><span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-527" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-528">y</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-529"><span class="MJXp-mrow" id="MJXp-Span-530"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-531">J</span></span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-533">y</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-535"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-536">p</span></span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-538">y</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-541" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-542" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mfrac" id="MJXp-Span-543" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-544">∂</span><span class="MJXp-mrow" id="MJXp-Span-545"><span class="MJXp-mi undefined" id="MJXp-Span-546">E</span></span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-549">J</span><span class="MJXp-mo MJXp-cal" id="MJXp-Span-550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-551">y</span><span class="MJXp-mo MJXp-cal" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-554">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-555">ω</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-556" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-557"></span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-559" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-560"><span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562" style="margin-left: 0px;">y</span></span></span><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-564">J</span></span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-566">y</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-568" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-569">∂</span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-571">p</span></span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-573">y</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-575">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-576">ω</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-577" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-578" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-579" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-580"></span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-582" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-583"><span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-left: 0px;">y</span></span></span><span class="MJXp-mrow" id="MJXp-Span-586"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-587">J</span></span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-589">y</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-591"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-592">p</span></span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-594">y</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-596" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-597">∂</span><span class="MJXp-mi" id="MJXp-Span-598">log</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-600"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-601">p</span></span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-603">y</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-605">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-606">ω</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-607" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-608" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-609" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-610"></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span></span><span class="MJXp-mtd" id="MJXp-Span-612" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-613" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-614">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-616"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-618" style="margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-619"><span class="MJXp-mrow" id="MJXp-Span-620" style="margin-right: 0.05em;"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-621">y</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-622" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-623">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">i</span><span class="MJXp-mo" id="MJXp-Span-625">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-626">∼</span><span class="MJXp-mrow" id="MJXp-Span-627"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-628">p</span></span><span class="MJXp-mo" id="MJXp-Span-629">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-630">y</span><span class="MJXp-mo" id="MJXp-Span-631">)</span><span class="MJXp-mo" id="MJXp-Span-632">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">i</span><span class="MJXp-mo" id="MJXp-Span-634">=</span><span class="MJXp-mn" id="MJXp-Span-635">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-637"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-638">J</span></span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-641" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-642" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-643">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">i</span><span class="MJXp-mo" id="MJXp-Span-645">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-647" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-648">∂</span><span class="MJXp-mi" id="MJXp-Span-649">log</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-651"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-652">p</span></span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-654"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-655" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-656" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-657">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">i</span><span class="MJXp-mo" id="MJXp-Span-659">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-661">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-662">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-664" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-665" style="padding-top: 0.3em; text-align: right;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-96">\begin{eqnarray}
\mathbb{E}_{z} [\mathcal{J}(\boldsymbol y)] & = & \sum_{\boldsymbol y} {\mathcal{J}(\boldsymbol y) \mathcal{p}(\boldsymbol y)}, \tag{20.59}\\
\frac{\partial \mathbb{E} [\mathcal{J(\boldsymbol y)}]} {\partial \boldsymbol\omega}
& = & \sum_y \mathcal{J}(\boldsymbol y) \frac{\partial \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega}
\tag{20.60}\\
& = & \sum_y \mathcal{J}(\boldsymbol y) \mathcal{p}(\boldsymbol y) \frac{\partial \log \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega} \tag{20.61}\\ 
& \approx & \frac{1} {m} \sum^m _{\textbf y^{(i)} \sim \mathcal{p}(\boldsymbol y), i=1} \mathcal{J}(\boldsymbol y ^{(i)}) \frac{\partial \log \mathcal{p}(\boldsymbol y^{(i)})} {\partial \boldsymbol\omega} .
\tag{20.62} \\
\\\end{eqnarray}</script></span></p><p>P`hương trình 20.60 dựa trên giả thuyết là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mrow" id="MJXp-Span-667"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-668">J</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-97-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-97">\mathcal{J}</script></span> không tham chiếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-98-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-98">\omega</script></span> một cách trực tiếp. Sẽ không quá khó để mở rộng cách tiếp cận này bằng việc nới lỏng giả thuyết trên đây. Phương trình 20.61 khai thác quy luật đạo hàm đối với logarit, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mfrac" id="MJXp-Span-672" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-673"><span class="MJXp-mi" id="MJXp-Span-674">∂</span></span><span class="MJXp-mi" id="MJXp-Span-675">log</span><span class="MJXp-mo" id="MJXp-Span-676"></span><span class="MJXp-mrow" id="MJXp-Span-677"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-678">p</span></span><span class="MJXp-mo" id="MJXp-Span-679">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-680">y</span><span class="MJXp-mo" id="MJXp-Span-681">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-682">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-683">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-685" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-686">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-688">p</span></span><span class="MJXp-mo" id="MJXp-Span-689">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-690">y</span><span class="MJXp-mo" id="MJXp-Span-691">)</span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-692" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-693"><span class="MJXp-mi" id="MJXp-Span-694">∂</span></span><span class="MJXp-mrow" id="MJXp-Span-695"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-696">p</span></span><span class="MJXp-mo" id="MJXp-Span-697">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-698">y</span><span class="MJXp-mo" id="MJXp-Span-699">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-700">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-701">ω</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-99-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-99">\frac{{\partial} \log \mathcal{p}(\boldsymbol y)}{\partial \boldsymbol\omega}= \frac {1} {\mathcal{p}(\boldsymbol y)}\frac{{\partial} \mathcal{p}(\boldsymbol y)}{\partial \boldsymbol\omega}</script></span>. Phương trình 20.62 cung cấp <em>một ước lượng không chệch</em> ( unbiased estimator) Monte Carlo của gradient.</p><p>Trong phần này, bất cứ khi nào chúng ta viết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mrow" id="MJXp-Span-703"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-704">p</span></span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-706">y</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-100-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-100">\mathcal{p}(\boldsymbol y)</script></span>, chúng ta đều có thể viết một cách tương đương <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mrow" id="MJXp-Span-709"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-710">p</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-712">y</span><span class="MJXp-mspace" id="MJXp-Span-713" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-714"><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mspace" id="MJXp-Span-716" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-717">x</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-101-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-101">\mathcal{p}(\boldsymbol y\,|\,\boldsymbol x)</script></span>. Điều này là bởi vì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-719"><span class="MJXp-mrow" id="MJXp-Span-720"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-721">p</span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-723">y</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-102-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-102">\mathcal{p}(\boldsymbol y)</script></span> được tham số hóa bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-726">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-103-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-103">\boldsymbol\omega</script></span>, mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-728">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-104-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-104">\boldsymbol\omega</script></span> lại liên quan đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-729"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-730">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-105-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-105">\boldsymbol\theta</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-732">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-106-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-106">\boldsymbol x</script></span> nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-734">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-107-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-107">\boldsymbol x</script></span> tồn tại.</p><p>Một trở ngại đối với ước lượng REINFORCE đơn giản đó là nó có phương sai <s>độ <em>xê dịch</em></s> khá lớn, do vậy nhiều mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-735"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-736">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-108-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-108">\boldsymbol y</script></span> cần được lấy để có được một ước lượng tốt của gradient <s>giúp cho sự ước lượng bằng phương pháp trượt đạt kết quả tốt</s>, hoặc tương tự, nếu chỉ có một mẫu được lấy , SGD sẽ hội tụ rất chậm và đòi hỏi một tốc độ học chậm hơn. Có thể giảm đáng kể phương sai <s>độ xê dịch</s> của ước lượng này bằng việc sử dụng phương pháp <em>giảm phương sai</em> (variance reduction)  <s>những kỹ thuật đề cập bởi những nghiên cứu của</s> (Wilson, 1984; L’Ecuyer, 1994).Ý tưởng này <s>sẽ</s> là <s>thay</s> điều chỉnh ước lượng để <s>làm sao</s> giá trị kỳ vọng <s>được mong đợi</s> của nó không thay đổi trong khi phương sai <s>đọ xê dịch</s> được giảm. Trong bối cảnh của REINFORCE, các phương pháp giảm phương sai <s>độ xê dịch này</s> được đề xuất bao gồm sự tính toán một <em>đường cơ sở</em> (baseline) được sử dụng để bù đắp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mrow" id="MJXp-Span-738"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-739">J</span></span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-741">y</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-109-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-109">\mathcal{J}(\boldsymbol y)</script></span>. Lưu ý rằng bất cứ sự bù đắp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mrow" id="MJXp-Span-744"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-745">b</span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-747">ω</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-110-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-110">\mathcal{b}(\boldsymbol\omega)</script></span> nào mà không phụ thuộc vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-749"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-750">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-111-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-111">\boldsymbol y</script></span> cũng có thể không làm thay đổi kỳ vọng <s>sự mong đợi</s> của gradient được ước lượng, bởi vì</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-751"><span class="MJXp-mtable" id="MJXp-Span-752"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-753" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-754" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-757" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-758"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-759">p</span><span class="MJXp-mo MJXp-cal" id="MJXp-Span-760">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-761">y</span><span class="MJXp-mo MJXp-cal" id="MJXp-Span-762">)</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-763"><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mfrac" id="MJXp-Span-765" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-766">∂</span><span class="MJXp-mi" id="MJXp-Span-767">log</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-769"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-770">p</span></span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-772">y</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-774">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-775">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-777" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-778"></span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-780" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-781"><span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-783" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-784">y</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-785"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-786">p</span></span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-788">y</span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-790" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-791">∂</span><span class="MJXp-mi" id="MJXp-Span-792">log</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-794"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-795">p</span></span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-797">y</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-799">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-800">ω</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-801" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-802" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-803" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-804"></span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-806" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-munderover" id="MJXp-Span-807"><span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-809" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-810">y</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-811" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-812">∂</span><span class="MJXp-mrow" id="MJXp-Span-813"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-814">p</span></span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-816">y</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-818">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-819">ω</span></span></span></span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-820" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-821" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-822" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-823"></span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-825" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-826" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-827">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-828">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-829">ω</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-830"><span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-832" style="margin-left: 0px;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-833">y</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-834"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-835">p</span></span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-837">y</span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-840" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-841">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-842">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-843">ω</span></span></span></span></span></span><span class="MJXp-mn" id="MJXp-Span-844">1</span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-846">0</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mtr" id="MJXp-Span-848" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-849" style="padding-top: 0.3em; text-align: right;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-112">\begin{eqnarray}
E_{\mathcal{p(\boldsymbol y)}} \left[ \frac {\partial \log \mathcal{p} (\boldsymbol y)} {\partial \boldsymbol\omega } \right] 
& = & \sum_{\boldsymbol y} \mathcal{p}(\boldsymbol y) \frac {\partial \log \mathcal{p} (\boldsymbol y)} {\partial \boldsymbol\omega} \tag{20.63} \\ 
& = & \sum_{\boldsymbol y} \frac {\partial \mathcal{p} (\boldsymbol y)} {\partial \boldsymbol\omega} \tag{20.64} \\ 
& = & \frac {\partial} {\partial \boldsymbol\omega} \sum_{\boldsymbol y} \mathcal{p} (\boldsymbol y) = \frac {\partial} {\partial \boldsymbol\omega} 1 = 0 , \tag{20.65} \\
\\\end{eqnarray}</script></span><br>
có nghĩa là<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-850"><span class="MJXp-mtable" id="MJXp-Span-851"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-852" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-853" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-856" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-858">p</span></span><span class="MJXp-mo" id="MJXp-Span-859">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-860">y</span><span class="MJXp-mo" id="MJXp-Span-861">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-862"><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-866">J</span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-868">y</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">b</span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-873">ω</span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-876" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-877">∂</span><span class="MJXp-mi" id="MJXp-Span-878">log</span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-880"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-881">p</span></span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-883">y</span><span class="MJXp-mo" id="MJXp-Span-884" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-885">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-886">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-888" style="padding-left: 0em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-889"></span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-891" style="padding-left: 0.278em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-894" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-895"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-896">p</span></span><span class="MJXp-mo" id="MJXp-Span-897">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-898">y</span><span class="MJXp-mo" id="MJXp-Span-899">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-900"><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mrow" id="MJXp-Span-902"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-903">J</span></span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-905">y</span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-907" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-908">∂</span><span class="MJXp-mi" id="MJXp-Span-909">log</span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-911"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-912">p</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-914">y</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-916">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-917">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">b</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-922">ω</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-926" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-927"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-928">p</span></span><span class="MJXp-mo" id="MJXp-Span-929">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-930">y</span><span class="MJXp-mo" id="MJXp-Span-931">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-932"><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mfrac" id="MJXp-Span-934" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-935">∂</span><span class="MJXp-mi" id="MJXp-Span-936">log</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-938"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-939">p</span></span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-941">y</span><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-943">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-944">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-946" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-947" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-948" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-949"></span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-951" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-954" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-955"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-956">p</span></span><span class="MJXp-mo" id="MJXp-Span-957">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-958">y</span><span class="MJXp-mo" id="MJXp-Span-959">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-963">J</span></span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-965">y</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-967" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-968">∂</span><span class="MJXp-mi" id="MJXp-Span-969">log</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-972">p</span></span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-974">y</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-976">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-977">ω</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-980" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-981" style="padding-top: 0.3em; text-align: right;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">\begin{eqnarray}
E_{\mathcal{p}(\boldsymbol y)} \left[ (\mathcal{J}(\boldsymbol y) - b(\boldsymbol\omega)) \frac {\partial \log \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega} \right]
& = & E_{\mathcal{p}(\boldsymbol y)} \left[ \mathcal{J}(\boldsymbol y) \frac {\partial \log \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega} \right] - b(\boldsymbol\omega) E_{\mathcal{p}(\boldsymbol y)} \left[ \frac {\partial \log \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega} \right] 
\tag{20.66} \\
&= & E_{\mathcal{p}(\boldsymbol y)} \left[ \mathcal{J}(\boldsymbol y) \frac {\partial \log \mathcal{p}(\boldsymbol y)} {\partial \boldsymbol\omega} \right] . \tag{20.67} \\
\\\end{eqnarray}</script></span></p><p>Chúng ta cũng có thể tìm được giá trị tối ưu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">b</span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-985">ω</span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-114-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-114">b(\boldsymbol\omega)</script></span> bằng việc tính phương sai <s>độ xê dịch</s> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-987"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-989"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-990">J</span></span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-992">y</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">b</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-997">ω</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-1000" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1001">∂</span><span class="MJXp-mi" id="MJXp-Span-1002">log</span><span class="MJXp-mo" id="MJXp-Span-1003"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">p</span><span class="MJXp-mo" id="MJXp-Span-1005">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1006">y</span><span class="MJXp-mo" id="MJXp-Span-1007">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1008">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1009">ω</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-115-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-115">(\mathcal{J}(\boldsymbol y)-b(\boldsymbol\omega))\frac{\partial \log p(\boldsymbol y)}{\partial \boldsymbol\omega}</script></span> theo giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">p</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1013">y</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-116-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-116">p(\boldsymbol y)</script></span> và tối thiểu hóa với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">b</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1018">ω</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-117-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-117">b(\boldsymbol\omega)</script></span>. Những gì chúng ta thấy là đường cơ sở tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1023" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1025">ω</span><span class="MJXp-msubsup" id="MJXp-Span-1026"><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1028" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-118-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-118">b^*(\boldsymbol\omega)_i</script></span> là khác với mỗi phần tử của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-msubsup" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1032" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-119-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-119">\omega_i</script></span> của vectơ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1034">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-120-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-120">\boldsymbol\omega</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1035"><span class="MJXp-mtable" id="MJXp-Span-1036"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1037" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1038" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1041" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1043">ω</span><span class="MJXp-msubsup" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1046" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1048" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mrow" id="MJXp-Span-1050" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1052" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1054">p</span></span><span class="MJXp-mo" id="MJXp-Span-1055">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1056">y</span><span class="MJXp-mo" id="MJXp-Span-1057">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1058"><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">[</span></span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">J</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1063">y</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-1065" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1066">∂</span><span class="MJXp-mi" id="MJXp-Span-1067">log</span><span class="MJXp-mo" id="MJXp-Span-1068"></span><span class="MJXp-mrow" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1070">p</span></span><span class="MJXp-mo" id="MJXp-Span-1071">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1072">y</span><span class="MJXp-msubsup" id="MJXp-Span-1073"><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1075" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1076">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1079" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">]</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1083" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1085">p</span></span><span class="MJXp-mo" id="MJXp-Span-1086">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1087">y</span><span class="MJXp-mo" id="MJXp-Span-1088">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1089"><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">[</span></span><span class="MJXp-mfrac" id="MJXp-Span-1091" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1092">∂</span><span class="MJXp-mi" id="MJXp-Span-1093">log</span><span class="MJXp-mo" id="MJXp-Span-1094"></span><span class="MJXp-mrow" id="MJXp-Span-1095"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1096">p</span></span><span class="MJXp-mo" id="MJXp-Span-1097">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1098">y</span><span class="MJXp-msubsup" id="MJXp-Span-1099"><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1101" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1102">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1105" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">]</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-121">b^*(\boldsymbol\omega)_i=\frac{{E}_{\mathcal{p}(\boldsymbol y)}\left[(J(\boldsymbol y)\frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i}\right]}{E_{\mathcal{p}(\boldsymbol y)}\left[\frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i}\right]}.\tag{20.68}</script></span></p><p>Ước lượng gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1108"><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-122-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-122">\omega_i</script></span> sẽ trở thành<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1112"><span class="MJXp-mtable" id="MJXp-Span-1113"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1114" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1115" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1118">J</span></span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1120">y</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">b</span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1125">ω</span><span class="MJXp-msubsup" id="MJXp-Span-1126"><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1128" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-1130" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1131">∂</span><span class="MJXp-mi" id="MJXp-Span-1132">log</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1135">p</span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1137">y</span><span class="MJXp-mo" id="MJXp-Span-1138" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1139">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1142" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-123"> (\mathcal{J}(\boldsymbol y)-b(\boldsymbol\omega)_i)\frac{\partial \log \mathcal{p}(\boldsymbol y)}{\partial \omega_i},\tag{20.69}</script></span></p><p>trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">b</span><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1147">ω</span><span class="MJXp-msubsup" id="MJXp-Span-1148"><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1150" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-124-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-124">b(\boldsymbol\omega)_i</script></span> ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-msubsup" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153" style="margin-right: 0.05em;">b</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1154" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1156">ω</span><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-125-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-125">b^*(\boldsymbol\omega)_i</script></span>. Hệ số ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-126-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-126">b</script></span> thường được tính bằng cách thêm các đầu ra bổ sung vào mạng neuron và huấn luyện các đầu ra mới để ước lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-msubsup" id="MJXp-Span-1163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1165" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1167">p</span></span><span class="MJXp-mo" id="MJXp-Span-1168">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1169">y</span><span class="MJXp-mo" id="MJXp-Span-1170">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-1172"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1173">J</span></span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1175">y</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-1177" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1178">∂</span><span class="MJXp-mi" id="MJXp-Span-1179">log</span><span class="MJXp-mo" id="MJXp-Span-1180"></span><span class="MJXp-mrow" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1182">p</span></span><span class="MJXp-mo" id="MJXp-Span-1183">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1184">y</span><span class="MJXp-msubsup" id="MJXp-Span-1185"><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1187" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1188">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1191" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-127-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-127">E_{\mathcal{p}(\boldsymbol y)}[\mathcal{J}(\boldsymbol y) \frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i}]</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1193"><span class="MJXp-msubsup" id="MJXp-Span-1194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1196" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1198">p</span></span><span class="MJXp-mo" id="MJXp-Span-1199">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1200">y</span><span class="MJXp-mo" id="MJXp-Span-1201">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1202"><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">[</span></span><span class="MJXp-mfrac" id="MJXp-Span-1204" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1205">∂</span><span class="MJXp-mi" id="MJXp-Span-1206">log</span><span class="MJXp-mo" id="MJXp-Span-1207"></span><span class="MJXp-mrow" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1209">p</span></span><span class="MJXp-mo" id="MJXp-Span-1210">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1211">y</span><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1214" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1215">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1218" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">]</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-128-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-128">E_{\mathcal{p}(\boldsymbol y)} \left[\frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i} \right]</script></span>  đối với mỗi giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1221">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-129-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-129">\boldsymbol\omega</script></span>. Những đầu ra bổ sung này có thể được học bởi hàm sai số trung bình bình phương, và sử dụng lần lượt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mrow" id="MJXp-Span-1223"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1224">J</span></span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1226">y</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-1228" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1229">∂</span><span class="MJXp-mi" id="MJXp-Span-1230">log</span><span class="MJXp-mo" id="MJXp-Span-1231"></span><span class="MJXp-mrow" id="MJXp-Span-1232"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1233">p</span></span><span class="MJXp-mo" id="MJXp-Span-1234">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1235">y</span><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1238" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1239">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1242" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-130-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-130">\mathcal{J}(\boldsymbol y) \frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1243"><span class="MJXp-mfrac" id="MJXp-Span-1244" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1245">∂</span><span class="MJXp-mi" id="MJXp-Span-1246">log</span><span class="MJXp-mo" id="MJXp-Span-1247"></span><span class="MJXp-mrow" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1249">p</span></span><span class="MJXp-mo" id="MJXp-Span-1250">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1251">y</span><span class="MJXp-msubsup" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1254" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1255">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257" style="margin-right: 0.05em;">ω</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1258" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-131-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-131">\frac{\partial \log \mathcal{p}(\boldsymbol y)^2} {\partial \omega_i}</script></span> để làm mục tiêu khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1260">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-132-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-132">\boldsymbol y</script></span> được lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1261"><span class="MJXp-mrow" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1263">p</span></span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1265">y</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-133-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-133">\mathcal{p}(\boldsymbol y)</script></span> theo một <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1268">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-134-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-134">\boldsymbol\omega</script></span> cho trước. Uớc lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-135-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-135">b</script></span> sau đó có thể được phục hồi bằng việc thay thế các ước lượng này bằng phương trình 20.68. Mnih và Gregor (2014) đã chọn việc sử dụng chỉ một dữ liệu đầu ra được chia sẻ (theo toàn bộ giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-136-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-136">i</script></span> của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1273"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1274">ω</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-137-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol\omega</script></span>) được học theo mục tiêu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1275"><span class="MJXp-mrow" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1277">J</span></span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1279">y</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-138-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-138">\mathcal{J}(\boldsymbol y)</script></span>, sử dụng đường cơ sở <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">b</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1284">ω</span><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mrow" id="MJXp-Span-1288" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1290" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1291"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1292">p</span></span><span class="MJXp-mo" id="MJXp-Span-1293">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1294">y</span><span class="MJXp-mo" id="MJXp-Span-1295">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1298">J</span></span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1300">y</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-139-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-139">b(\boldsymbol\omega)\approx {E}_{\mathcal{p}(\boldsymbol y)}[\mathcal{J}(\boldsymbol y)]</script></span>.</p><p>Các phương pháp giảm phương sai đã được đề cập trong các chủ đề liên quan đến học tăng cường (Sutton <em>et al</em>, 2000; Weaver và Tao, 2001) tiếp nối nghiên cứu trước đó về <em>thưởng nhị phân</em> (binary reward) của Dayan (1990). Những ví dụ khác về việc xu thế sử dụng thuât toán REINFORCE cùng với phương pháp giảm phương sai trong học sâu có thể được tham khảo trong các công trình của:  Bengio <em>et al</em>. (2013b), Mnih và Gregor (2014), Ba <em>et al</em>. (2014), Mnih <em>et al</em>. (2014), hay Xu <em>et al</em>. (2015). Ngoài việc sử dụng một đường cơ sở phụ thuộc vào đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">b</span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1306">ω</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-140-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-140">b(\boldsymbol\omega)</script></span>, Mnih và Gregor(2014) tìm ra rằng độ lớn giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1310"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1311">J</span></span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1313">y</span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">b</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1318">ω</span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-141-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-141">(\mathcal{J}(\boldsymbol y)− b(\boldsymbol\omega))</script></span> có thể được điều chỉnh trong quá trình huấn luyện bằng cách chia độ lệch chuẩn của nó cho <em>trung bình dịch chuyển</em> (moving avera) trong quá trình huấn luyện, như là một loại <em>tốc độ học thích nghi</em> (adaptive learning rate), để chống lại ảnh hưởng của các biến thiên quan trọng xảy ra trong quá trình huấn luyện dựa theo độ lớn của số lượng này. Mnih và Gregor  (2014) đã đặt tên cho khám phá này là <strong>chuẩn hóa phương sai</strong> ( variance normalization).</p><p>Ước lượng dựa trên REINFORCE có thể được hiểu như ước lượng gradient bằng các chọn lựa tương quan của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1322">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-142-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-142">\boldsymbol y</script></span> với những giá trị tương ứng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mrow" id="MJXp-Span-1324"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1325">J</span></span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1327">y</span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-143-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-143">\mathcal{J}(\boldsymbol y)</script></span>. Nêu một giá trị dù tốt của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1330">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-144-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-144">\boldsymbol y</script></span> lại không phù hợp với tham số hóa hiện tại, có thể sẽ mất nhiều thời gian để thu được nó bằng sự may mắn cũng như nhận được tín hiệu cần thiết rằng cấu hình này nên được tăng cường.</p><h1 id="2010-Các-mạng-sinh-mẫu-có-hướng">20.10 Các mạng sinh mẫu có hướng</h1><p>Như đã được thảo luận trong chương 16, những mô hình đồ thị có <s>định</s> hướng tạo nên một lớp nổi bật của các mô hình đồ thị. Trong khi <s>mà</s> các mô hình đồ thị có hướng đã <s>là rất quen thuộc</s> trở nên rất phổ biến trong cộng đồng học máy lớn hơn, đối với cộng đồng học sâu nhỏ hơn các mô hình này cho đến khoảng năm 2013 vẫn còn lu mờ so với các mô hình vô hướng <s>không định hướng</s> như mô hình RBM.</p><p>Trong chương này, chúng ta xem xét <s>ôn lại</s> một vài mô hình đồ thị có <s>định</s> hướng cơ bản được sử dụng một cách truyền thống bởi cộng đồng học sâu.</p><p>Chúng ta đã miêu tả những mạng phân phối đa tầng được xây dưng dưới dạng một mô hình có hướng một phần. Chúng ta cũng đã miêu tả những mô hình mã hóa thưa <s>rời rạc</s> được xem như những mô hình sinh mẫu có hướng không sâu. Chúng thường xuyên được sử dụng như những <em>người học đặc trưng <s>tìm đặc tính</s></em> ( feature learners) trong bối cảnh học sâu, cho dù chúng có xu hướng kém hiệu quả trong việc sinh mẫu và ước lượng mật độ. Bây giờ chúng ta sẽ trình bày về một dạng khác của học sâu, đó là những mô hình có hướng hoàn chỉnh.</p><h2 id="20101-Các-mạng-phân-phối-chữ-S--Sigmoid-belief-networks">20.10.1 Các mạng phân phối chữ S ( Sigmoid belief networks)</h2><p>Các mạng phân phối chữ S (Neal, 1990) là một dạng đơn giản của mô hình đồ thị có hướng cùng với một loại hình đặc biệt của phân phối xác suất có điều kiện. Nói chung, chúng ta có thể xem một mạnối phân phối chữ S như là một vector của những trạng thái <s>biến</s> nhị phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1332">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-145-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-145">\boldsymbol s</script></span>, mà mỗi <s>thành</s> phần tử của một trạng thái <s>biến</s> sẽ chịu ảnh hưởng của các phần tử ở trước đó:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1333"><span class="MJXp-mtable" id="MJXp-Span-1334"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1335" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1336" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1338">p</span></span><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">σ</span><span class="MJXp-mrow" id="MJXp-Span-1346"><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.622em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.489em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-1348"><span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1350" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">j</span><span class="MJXp-mo" id="MJXp-Span-1352">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1356" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">i</span><span class="MJXp-mo" id="MJXp-Span-1358">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1362" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1366" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.622em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.489em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-146"> \mathcal{p}(s_i) = \sigma \left(\sum_{j < i} W_{i,j}s_j+b_i \right).  \tag{20.70} </script></span></p><p>Cấu trúc quen thuộc nhất của mạng phân phối chữ S là cấu trúc được chia ra làm nhiều tầng <s>lớp</s> cùng với việc lấy mẫu di truyền thông qua một chuỗi các tầng <s>lớp</s> ẩn và sau đó kết thúc bằng việc tạo ra tầng khả kiến <s>lớp hiện hữu</s> ở cuối. Cấu trúc này rất giống với mạng phân phối đa tầng <s>mạng sâu</s>, ngoại trừ các đơn vị ở phía đầu của quá trình lấy mẫu độc lập với nhau, không như kiểu lấy mẫu bằng phương pháp máy Boltzmann hạn chế. Một cấu trúc như vậy là rất thú vị vì nhiều lý do. Đó là cấu trúc đó là một xấp xỉ đa năng của những phân phối xác xuất trên những đơn vị khả kiến <s>nút hiện</s> , theo nghĩa là nó có thể tính tốt xấp xỉ của bất cứ phân phối xác xuất nào trên những biến nhị phân tùy ý, với đủ chiều sâu,  thậm chí nếu chiều rộng của các tầng <s>lớp</s> riêng biệt là hạn chế so với kích cỡ của tầng khả kiến ~~lớp hiện ~~(Sutskever and Hinton, 2008).</p><p>Trong khi việc sinh mẫu của các đơn vị khả kiến <s>nút hiện</s> là rất hiệu quả trong mạng phân phối chữ S, hầu hết các hoạt động khác của nó lại không được như vậy. Sự suy luận các đơn vị ẩn dựa trên cơ sở được biết các <s>nút hiện</s> là khó thực hiện. <em>Suy luận trường trung bình</em> ( mean field inference) cũng khó thực hiện vì <em>cận dưới biến phân</em> (the variational lower bound) liên quan đến những kỳ vọng của những nhóm bao gồm các tầng hoàn chỉnh. Vấn đề này vẫn còn đủ khó khăn để hạn chế sự phổ biến của những mạng có hướng rời rạc.</p><p>Một cách tiếp cận để thực hiện suy luận trong một mạng phân phối chữ S là xây dựng một cận dưới khác chuyên dùng cho mạng phân phối chữ S (Saul <em>et al</em>, 1996). Cách tiếp cận này chỉ được áp dụng cho những mạng rất nhỏ. Một cách tiếp cận khác đó là sử dụng những <s>công cụ suy đoán</s> cơ chế suy luận đã được học như được mô tả trong chương 19.5. Máy Helmholtz (Dayan <em>et al</em>., 1995; Dayan và Hinton, 1996) là một mạngS phân phối Sigmoid bao gồm một mạng suy luận các tham số của <em>phân phối trường trung bình</em>luận (the mean ﬁeld distribution) trên các đơn vị <s>nút</s> ẩn. Một số phương pháp hiện đại hơn (Gregor <em>et al</em>., 2014; Mnih và Gregor, 2014) so với mạng phân phối chữ S vẫn sử dụng phương pháp mạng suy luận này. Những kỹ thuật này vẫn còn khó khăn bởi vì tính chất rời rạc của các biến tiềm ẩn. Chúng ta không thể chỉ đơn giản áp dụng lan truyền ngược từ dữ liệu đầu ra của mạng suy luận, mà thay vào đó phải sử dụng một cách hợp lý một kỹ thuật đáng tin cậy để lan truyền ngược qua <s>những công đoạn</s> quá trình lấy mẫu rời rạc, như đã mô tả ở phần 20.9.1. Những cách tiếp cận gần đây đã dựa trên lấy mẫu quan trọng, <em>thuật toán đánh thức giấc ngủ dựa trên việc lấy mẫu quan trọng</em> (reweighted wake-sleep)  <s>Wake-sleep với tham số được cải thiện</s>  hay các máy Helmholtz hai chiều (Bornschein và Bengio, 2015) <s>mô hình máy hai chiều kiểu Helmholt</s> làm cho có thể nhanh chóng huấn luyện mạng phân phối chữ S và đạt được hiệu suất tối tân trên các tác vụ tiêu chuẩn.</p><blockquote>
<p>ND: Thuật toán đánh thức giấc ngủ là một thuật toán học không giám sát cho một mạng neuron đa lớp ngẫu nhiên. Thuật toán điều chỉnh các tham số để tạo ra một ước lượng mật độ tốt. Thuật toán bao gồm hai giai đoạn học: giai đoạn thức tỉnh (wake) và giai đoạn ngủ (sleep) được thực hiện luân phiên. Trong giai đoạn thức tỉnh, các neuron được kích hoạt bởi các <em>kết nối nhận dạng</em> (recognition connections), sau đó các <em>kết nối sinh mẫu</em> (generative connections) sẽ được điều chỉnh để tăng khả năng sinh mẫu gần với thực tế hơn so với tầng dưới. Ngược lại, trong giai đoạn ngủ, các neuron được kích hoạt bởi các kết nối sinh mẫu, trong khi các kết nối nhận dạng được điều chỉnh để tăng khả năng hoạt động chính xác hơn</p>
</blockquote><p>Một trường hợp đặc biệt khác của mạng phân phối chữ S <s>Sigmoid</s> đó là khi không có các biến tiềm ẩn. Học trong trường hợp này là hiệu quả vì không cần phải tách rời những biến tiềm ẩn ra khỏi hàm hợp lý. Một nhóm các mô hình có tên gọi là mạng tự hồi quy đã mở rộng việc áp dụng loại <em>mạng phân phối hoàn toàn khả kiến</em> (fully visible belief network) này với các loại biến khác ngoài biến nhị phân <s>rời rạc</s>, và các cấu trúc khác của các <s>hay như các loại hình</s> phân phối có điều kiện bên cạnh các mối quan hệ logarit tuyến tính. Các mạng tự quy hồi được mô tả trong phần 20.10.7.</p><p>============Tuan Pham  kết thúc dịch ở đây (p690)------------------------<br>
============Lan, Tuấn Phạm bắt đầu dịch trang 690------------------------</p><h2 id="20102-Mạng-sinh-mẫu-khả-vi">20.10.2 Mạng sinh mẫu khả vi</h2><p>Nhiều mô hình sinh mẫu dựa trên ý tưởng sử dụng mạng sinh mẫu khả vi. Các mô hình chuyển đổi mẫu của biến tiềm ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1369"><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1371">z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-147-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-147">\textbf z</script></span> thành mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mrow" id="MJXp-Span-1373"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1374">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-148-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-148">\textbf x</script></span> hoặc thành các phân phối trên mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1375"><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1377">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-149-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-149">\textbf x</script></span> bằng cách sử dụng hàm khả vi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1378"><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1380">g</span></span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1382"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1383">z</span></span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-1385"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1386" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1387" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1388">(</span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1390">g</span></span><span class="MJXp-mo" id="MJXp-Span-1391">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-150-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-150">\mathcal{g}(\textbf z; \boldsymbol\theta ^{(\mathcal{g})})</script></span>, thường được biểu diễn bằng mạng neuron. Lớp mô hình này bao gồm các <em>bộ tự mã hoá biến phân</em> (variational autoencoders) <s>bộ mã hóa tự động biến đổi</s>, với cặp đôi một mạng sinh mẫu và một mạng suy luận; <s>mạng lưới sinh đối thủ</s> mạng đối kháng sinh mẫu, với cặp đôi một mạng sinh mẫu và một mạng phân biệt <s>đối xử</s>; và những kỹ thuật huấn luyện các mạng sinh mẫu <s>lưới sinh phát</s> riêng rẽ.</p><p>Các mạng sinh mẫu <s>lưới sinh</s> là các thủ tục tính toán tham số hoá cần thiết để sinh mẫu, trong đó kiến trúc cung cấp một họ các phân phối khả thi để sinh mẫu từ các phân phối đó và các tham số chọn một phân phối từ bên trong họ đó.</p><p>============Lan, Tuấn Phạm kết thúc dịch trang 690------------------------</p><p>============Lan, Thành Sơn bắt đầu dịch từ đây (p691)------------------</p><p>Ví dụ, quy trình chuẩn để vẽ mẫu từ một phân phối chuẩn với trung bình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1394">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-151-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-151">\boldsymbol\mu</script></span> và hiệp phương sai <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1395"><span class="MJXp-mo" id="MJXp-Span-1396" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-152-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-152">\sum</script></span> là lấy mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-153-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-153">z</script></span> từ phân phối chuẩn với trung bình là không và <s>định nghĩa</s> hiệp phương sai đồng nhất thành một mạng sinh mẫu rất đơn giản. Mạng sinh mẫu này chỉ chứa một tầng affine:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1399"><span class="MJXp-mtable" id="MJXp-Span-1400"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1401" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1402" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1403">x</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1405"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1406">g</span></span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1408">z</span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">μ</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1413"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1414">L</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1415">z</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-154"> \boldsymbol x = \mathcal{g}(\boldsymbol z) = \mu + \textbf L \boldsymbol z \tag{20.71}</script></span><br>
trong đó <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1416"><span class="MJXp-mrow" id="MJXp-Span-1417"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1418">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-155-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-155">\textbf L</script></span> được đưa ra bởi <s>sự phân hủy</s> phân tích Cholesky của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1419"><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-156-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-156">\sum</script></span>.<br>
Các trình sinh số giả ngẫu nhiên cũng có thể sử dụng các phép biến đổi phi tuyến của các phân phối đơn giản. Ví dụ, lấy mẫu biến đổi nghịch đảo (Devroye, 2013) vẽ một vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-157-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-157">z</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">U</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1426">0</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1428">1</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-158-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-158">U(0,1)</script></span> và áp dụng phép biến đổi phi tuyến cho một vô hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-159-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-159">x</script></span>. Trong trường hợp này <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mrow" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1434">g</span></span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">z</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-160-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-160">\mathcal{g}(z)</script></span> được cho bởi nghịch đảo của hàm phân phối tích lũy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1440">F</span></span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">x</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1445"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450" style="margin-right: 0px; margin-left: 0px;">x</span></span><span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0.111em;">∫</span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1447" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1448">−</span><span class="MJXp-mi" id="MJXp-Span-1449">∞</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1452">p</span></span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">υ</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">υ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-161-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-161">\mathcal{F}(x) = \int\limits_{-\infty} ^x \mathcal{p}(\upsilon) d \upsilon</script></span>. Nếu chúng ta có thể chỉ định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mrow" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1460">p</span></span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">x</span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-162-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-162">\mathcal{p}(x)</script></span>, tích hợp trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-163-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-163">x</script></span>, và đảo ngược hàm kết quả, chúng ta có thể lấy mẫu từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1468">p</span></span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">x</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-164-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-164">\mathcal{p}(x)</script></span> mà không cần sử dụng máy học.</p><p>Để tạo mẫu từ các phân phối phức tạp hơn mà khó có thể xác định trực tiếp, khó tích hợp hơn, hoặc kết quả tích phân rất khó nghịch đảo, chúng ta sử dụng mạng <s>chuyển tiếp</s> lan truyền thuận để biểu diễn một họ các tham số của các hàm phi tuyến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mrow" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1474">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-165-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-165">\mathcal{g}</script></span>, và sử dụng dữ liệu huấn luyện để suy luận các tham số chọn chức năng mong muốn.</p><p>Chúng ta có thể nghĩ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mrow" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1477">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">\mathcal{g}</script></span> cung cấp một sự thay đổi phi tuyến của các biến chuyển đổi phân phối trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1478"><span class="MJXp-mrow" id="MJXp-Span-1479"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1480">z</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">\textbf z</script></span> thành phân phối mong muốn trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mrow" id="MJXp-Span-1482"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1483">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">\textbf x</script></span>.</p><p>Nhớ lại từ phương trình 3.47, không thể đảo ngược, <s>có thể thay đổi</s> khả vi, liên tục <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1484"><span class="MJXp-mrow" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1486">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">\mathcal{g}</script></span>,<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1487"><span class="MJXp-mtable" id="MJXp-Span-1488"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1489" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1490" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1491"><span class="MJXp-mrow" id="MJXp-Span-1492" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1493">p</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1494" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1496">z</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1499"><span class="MJXp-mrow" id="MJXp-Span-1500" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1501">p</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1502" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1505">g</span></span><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1507">z</span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1510"><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.068em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">t</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1516" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1517">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">g</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1519">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1520">z</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1521" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.068em;">|</span></span></span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">\mathcal{p}_z(\boldsymbol z) = \mathcal{p}_x (\mathcal{g}(\boldsymbol z)) \left| det (\frac {\partial g} {\partial \boldsymbol z}) \right|. \tag {20.72}</script></span></p><p>Điều này ngầm định áp đặt phân bố xác suất trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1524"><span class="MJXp-mrow" id="MJXp-Span-1525"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-1526">x</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\textbf x</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1527"><span class="MJXp-mtable" id="MJXp-Span-1528"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1529" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1530" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1531"><span class="MJXp-mrow" id="MJXp-Span-1532" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1533">p</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1534" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1536">x</span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1539" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1540"><span class="MJXp-mrow" id="MJXp-Span-1541" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1542">p</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1543" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1547" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1548">−</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1551">x</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1554"><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.068em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">t</span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1560" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1561">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">g</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-1563">∂</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1564">z</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.068em;">|</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-172">\mathcal{p}_x (\boldsymbol x) = \frac{ \mathcal{p}_z (g^{-1} (\boldsymbol x))} {\left| det(\frac{\partial g}{\partial \boldsymbol z}) \right| }. \tag{20.73}</script></span></p><p>Tất nhiên, công thức này có thể khó được ước lượng, phụ thuộc vào lựa chọn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mrow" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1570">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">\mathcal{g}</script></span>, vì vậy ta thường sử dụng phương tiện học tập gián tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1571"><span class="MJXp-mrow" id="MJXp-Span-1572"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1573">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\mathcal{g}</script></span>, thay vì cố gắng tối đa hóa trực tiếp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1574"><span class="MJXp-mi" id="MJXp-Span-1575">log</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1578">p</span></span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1580">x</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">\log \mathcal{p}(\boldsymbol x)</script></span>.</p><p>Trong một số trường hợp, thay vì sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1582"><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1584">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-176-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-176">\mathcal{g}</script></span> để cung cấp một mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1586">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">\boldsymbol x</script></span> trực tiếp, chúng ta sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1587"><span class="MJXp-mrow" id="MJXp-Span-1588"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1589">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">\mathcal{g}</script></span> để xác định phân phối có điều kiện trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1591">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">\boldsymbol x</script></span>. Ví dụ, chúng ta có thể sử dụng một mạng sinh mẫu có lớp cuối bao gồm các đầu ra chữ S để cung cấp các tham số trung bình của các phân phối Bernoulli:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1592"><span class="MJXp-mtable" id="MJXp-Span-1593"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1594" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1595" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1597">p</span></span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1601" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1603">1</span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1605">z</span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1609">g</span></span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611">z</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-180"> \mathcal{p}(x_i = 1 \mid \boldsymbol z) = \mathcal{g}(\boldsymbol z)_i. \tag{20.74}</script></span></p><p>Trong trường hợp này, khi ta sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1616"><span class="MJXp-mrow" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1618">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">\mathcal{g}</script></span> để xác định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1619"><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1621">x</span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1623">z</span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">(\boldsymbol x \mid \boldsymbol z)</script></span>, ta áp đặt phân phối trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-183-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-183">x</script></span> bằng cách tách <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1627"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1628">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-184-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-184">\boldsymbol z</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1629"><span class="MJXp-mtable" id="MJXp-Span-1630"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1631" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1632" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1634">p</span></span><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1636">x</span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1639"><span class="MJXp-mrow" id="MJXp-Span-1640" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1641">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1642" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1643">z</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">p</span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1646">x</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1648">z</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-185"> \mathcal{p}(\boldsymbol  x) = \mathbb{E}_{\boldsymbol z} p(\boldsymbol x \mid \boldsymbol z). \tag{20.75}</script></span></p><p>Cả hai phương pháp đều xác định một phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1651"><span class="MJXp-msubsup" id="MJXp-Span-1652"><span class="MJXp-mrow" id="MJXp-Span-1653" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1654">p</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1655" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1657">x</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">\mathcal{p}_g(\boldsymbol x)</script></span> và cho phép chúng ta đào tạo các tiêu chuẩn khác nhau của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1659"><span class="MJXp-msubsup" id="MJXp-Span-1660"><span class="MJXp-mrow" id="MJXp-Span-1661" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1662">g</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1663" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">\mathcal{g}_g</script></span> sử dụng thủ thuật tái tham số hoá <s>reparametrization</s> của phần 20.9.</p><p>Hai phương pháp tiếp cận khác nhau để xây dựng mạng sinh mẫu - phát ra các tham số của phân phối có điều kiện so với các mẫu phát trực tiếp — có các điểm mạnh và điểm yếu bổ sung. Khi mạng sinh mẫu xác định phân phối có điều kiện trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1665">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\boldsymbol x</script></span>, nó có khả năng sinh dữ liệu rời rạc cũng như dữ liệu liên tục. Khi mạng sinh mẫu cung cấp mẫu trực tiếp, nó có khả năng tạo ra dữ liệu liên tục (chúng ta có thể đưa ra sự rời rạc hoá trong quá trình lan truyền thuận, nhưng làm như vậy có nghĩa là mô hình không thể được đào tạo bằng cách sử dụng lan truyền ngược). Ưu điểm của việc lấy mẫu trực tiếp là chúng ta không còn bị cưỡng chế sử dụng các phân phối có điều kiện mà biểu mẫu có thể dễ dàng được viết xuống và được điều khiển bởi người thiết kế.</p><p>Các phương pháp tiếp cận dựa trên các <s>mạng máy sinh mẫu di động</s> mạng sinh mẫu khả vi có thể được thúc đẩy bởi sự thành công của trượt theo gradient <s>độ dốc</s> được áp dụng <s>để phân loại cho các mạng truyền dữ liệu di động</s> cho các mạng lan truyền thuận để phân loại. Trong bối cảnh học có giám sát, <s>các mạng sâu được đào tạo</s> các mạng lan truyền thuận đa tầng được huấn luyện với việc học dựa trên gradient dường như được thực tế đảm bảo thành công với đủ đơn vị ẩn và đủ dữ liệu huấn luyện. Công thức tương tự này có thể chuyển thành công sang mô hình sinh mẫu không?</p><p>Mô hình sinh mẫu có vẻ khó hiểu hơn so với bộ phân loại hoặc hồi quy vì quá trình học tập đòi hỏi phải tối ưu hóa các tiêu chí khó xử lý. Trong bối cảnh của mạng sinh mẫu <s>di động</s> khả vi, các tiêu chí có thể khó xử lý bởi vì dữ liệu không chỉ định cả đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1666"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1667">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">\boldsymbol z</script></span> và đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1668"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1669">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">\boldsymbol x</script></span> của mạng <s>máy phát</s> sinh mẫu. Trong trường hợp học có giám sát, cả hai đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1671">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">\boldsymbol x</script></span> và kết quả đầu ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1672"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1673">y</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-192-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-192">\boldsymbol y</script></span> đã được đưa ra, và quy trình tối ưu hóa chỉ cần tìm hiểu cách tạo ánh xạ đặc biệt. Trong trường hợp <s>tạo mô hình sinh học</s> của mô hình sinh mẫu, quá trình học cần xác định cách sắp xếp không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1675">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">\boldsymbol z</script></span> theo cách hữu ích và bổ sung cách ánh xạ từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1677">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-194-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-194">\boldsymbol z</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1678"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1679">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-195-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-195">\boldsymbol x</script></span>.</p><p>Dosovitskiy et al.(2015) đã nghiên cứu một vấn đề đơn giản, trong đó sự tương ứng giữa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1680"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1681">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-196-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-196">\boldsymbol z</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1683">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-197-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-197">\boldsymbol x</script></span> được đưa ra. Đặc biệt, dữ liệu huấn luyện là <s>sự kết hợp của computer-renderedimagery of chairs</s> hình ảnh những chiếc ghế được dựng ra bởi máy tính. Các biến tiềm ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1684"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1685">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-198-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-198">\boldsymbol z</script></span> là các tham số được cung cấp cho công cụ dựng hình mô tả sự lựa chọn mô hình ghế để sử dụng, vị trí của ghế và các chi tiết khác ảnh hưởng đến việc dựng hình ảnh. Sử dụng dữ liệu tổng hợp được tạo ra này, <s>mạng chuyển đổi</s> một mạng tích chập có thể tìm hiểu để <s>lập bản đồ mô tả</s> ánh xạ các mô tả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1687">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-199-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-199">\boldsymbol z</script></span> của nội dung của một hình ảnh để <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1689">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-200-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-200">\boldsymbol x</script></span> gần với các hình ảnh được dựng.  Điều này cho thấy các mạng sinh mẫu <s>di động</s> khả vi đương thời có đủ khả năng để trở thành các mô hình sinh mẫu tốt, và các thuật toán tối ưu hóa đương thời có khả năng phù hợp cho chúng. <s>Sự di cư</s> Khó khăn nằm trong việc xác định cách huấn luyện các mạng sinh mẫu khi giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1691">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-201-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-201">\boldsymbol z</script></span> cho mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1693">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-202-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-202">\boldsymbol x</script></span> không được xác định và biết trước mỗi lần.</p><p>-------- Nguyễn Hoàng Dũng dịch phụ từ 693 --------</p><p>Phần tiếp theo sẽ mô tả một số cách tiếp cận việc huấn luyện mạng sinh mẫu khả vi chỉ sử dụng mẫu đã được huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1694"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1695">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-203-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-203">\boldsymbol x</script></span>.</p><h2 id="20103-Bộ-tự-mã-hóa-biến-phân">20.10.3 Bộ tự mã hóa biến phân</h2><p><strong>Bộ tự mã hóa biến phân</strong>, hay còn gọi là VAE (Kingma, 2013; Rezende et al., 2014), là một mô hình có hướng cho phép máy học các suy luận xấp xỉ và có thể được huấn luyện thuần tùy bằng phương pháp dựa trên gradient.</p><p>Để tổng hợp một mẫu từ mô hình, VAE đầu tiên cần trích xuất một mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1696"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1697">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-204-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-204">\boldsymbol z</script></span> từ phân phối mã hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1698"><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mrow" id="MJXp-Span-1700" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1701">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1702" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1703">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1705">z</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-205-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-205">\mathcal{p} _ { \text { model } } (\boldsymbol z )</script></span>. Mẫu này sau đó sẽ được duyệt qua bởi mạng sinh mẫu khả vi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1707"><span class="MJXp-mrow" id="MJXp-Span-1708"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1709">g</span></span><span class="MJXp-mo" id="MJXp-Span-1710" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1711">z</span><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-206-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-206">\mathcal{g} (\boldsymbol z )</script></span>. Cuối cùng, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1713"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1714">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-207-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-207">\boldsymbol x</script></span> là mẫu được tạo ra từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1715"><span class="MJXp-msubsup" id="MJXp-Span-1716"><span class="MJXp-mrow" id="MJXp-Span-1717" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1718">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1719" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1720">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1722">x</span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">g</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1726">z</span><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1730"><span class="MJXp-mrow" id="MJXp-Span-1731" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1732">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1733" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1734">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1736">x</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1738">z</span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-208-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-208">\mathcal{p}_ { \text { model } } (\boldsymbol x; g(\boldsymbol z) ) = \mathcal{p} _ { \text { model } } (\boldsymbol x \mid \boldsymbol z )</script></span>. Tuy nhiên trong quá trình huấn luyện, mạng suy luận xấp xỉ (hay còn gọi là bộ mã hóa) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-mrow" id="MJXp-Span-1741"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1742">q</span></span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1744">z</span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1746">x</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-209-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-209">\mathcal{q} (\boldsymbol z \mid \boldsymbol x )</script></span> được sử dụng để tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1749">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-210-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-210">\boldsymbol z</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1750"><span class="MJXp-msubsup" id="MJXp-Span-1751"><span class="MJXp-mrow" id="MJXp-Span-1752" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1753">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1754" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1755">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1757">x</span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1759">z</span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-211-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-211">\mathcal{p} _ { \text { model } } (\boldsymbol  x \mid \boldsymbol z )</script></span> được xem như là bộ giải mã của mạng.</p><p>Mấu chốt quan trọng nhất đằng sau các bộ tự mã hóa biến phân chính là chúng có thể được huấn luyện bằng cách tối đa hóa cận dưới biến phân <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1761"><span class="MJXp-mrow" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1763">L</span></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">q</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-212-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-212">\mathcal { L } ( q )</script></span> gắn liền với điểm dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1768">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-213-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-213">\boldsymbol x</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1866"><span class="MJXp-mtable" id="MJXp-Span-1867"><span><span class="MJXp-mtr" id="MJXp-Span-1868" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1869" style="text-align: right;"></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1870" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1871" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-1872"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1873">L</span></span><span class="MJXp-mo" id="MJXp-Span-1874" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">q</span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1877" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1878"></span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1880" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1881"><span class="MJXp-mrow" id="MJXp-Span-1882" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1883">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1884" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1885">z</span><span class="MJXp-mo" id="MJXp-Span-1886">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">q</span><span class="MJXp-mo" id="MJXp-Span-1888">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1889">z</span><span class="MJXp-mrow" id="MJXp-Span-1890"><span class="MJXp-mo" id="MJXp-Span-1891">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1892">x</span><span class="MJXp-mo" id="MJXp-Span-1893">)</span></span></span><span class="MJXp-mi" id="MJXp-Span-1894">log</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1898" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1899">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1901">z</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1903">x</span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1906"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1907">H</span></span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">q</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1911"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1912">z</span></span><span class="MJXp-mo" id="MJXp-Span-1913" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1914">x</span><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1916" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1917" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1918" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1919" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1920"></span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1922" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1923"><span class="MJXp-mrow" id="MJXp-Span-1924" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1925">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1926" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1927">z</span><span class="MJXp-mo" id="MJXp-Span-1928">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">q</span><span class="MJXp-mo" id="MJXp-Span-1930">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1931">z</span><span class="MJXp-mrow" id="MJXp-Span-1932"><span class="MJXp-mo" id="MJXp-Span-1933">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1934">x</span><span class="MJXp-mo" id="MJXp-Span-1935">)</span></span></span><span class="MJXp-mi" id="MJXp-Span-1936">log</span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1940" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1941">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1942" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1943">x</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1945">z</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1950" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-1951"><span class="MJXp-mi" id="MJXp-Span-1952">K</span><span class="MJXp-mi" id="MJXp-Span-1953">L</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">q</span><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1958">z</span></span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1960">x</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-msubsup" id="MJXp-Span-1963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1965" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1966">&nbsp;model&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1967"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1968">Z</span></span><span class="MJXp-mo" id="MJXp-Span-1969">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1971"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1972">z</span></span><span class="MJXp-mo" id="MJXp-Span-1973" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mlabeledtr" id="MJXp-Span-1975" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1976" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1977" style="padding-left: 0em; padding-top: 0.3em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1978"></span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span></span><span class="MJXp-mtd" id="MJXp-Span-1980" style="padding-left: 0.278em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1981">log</span><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1985" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1986">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-1987" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1988">x</span><span class="MJXp-mo" id="MJXp-Span-1989" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1991" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1992" style="padding-top: 0.3em; text-align: right;"></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-214">\begin{eqnarray}\\
\mathcal { L } ( q ) 
&=& \mathbb { E } _ { \boldsymbol { z } \sim q ( \boldsymbol { z } | \boldsymbol { x } ) } \log p _ { \text { model } } ( \boldsymbol { z } , \boldsymbol { x } ) + \mathcal { H } ( q ( \mathbf { z } \mid \boldsymbol { x } ) ) \tag{20.76} \\
&=& \mathbb { E } _ { \boldsymbol { z } \sim q ( \boldsymbol { z } | \boldsymbol { x } ) } \log p _ { \text { model } } ( \boldsymbol { x } \mid \boldsymbol { z } ) - D _ { \mathrm { KL } } ( q ( \mathbf { z } \mid \boldsymbol { x } ) \| p _ { \text { model } \mathbf { Z } ) } ( \mathbf { z } ) ) \tag{20.77} \\
& \leq & \log p _ { \text { model } }(\boldsymbol x). \tag{20.78} \\
\\\end{eqnarray}</script></span></p><p>Xét phương trình 20.76, ta phát hiện hạng tử đầu chính là hàm logarit hợp lý chuyển giao giữa các biến khả kiến và biến tiềm ẩn của môt hậu nghiệm xấp xỉ đối với các biến tiềm ẩn (giống với trường hợp của EM, ngoại trừ việc ta sử dụng một hậu nghiệm xấp xỉ thay cho một hậu nghiệm chính xác). Chúng ta cũng phát hiện hạng tử thứ hai, một entropy của hậu nghiệm xấp xỉ. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">q</script></span> được chọn để trở thành phân phối Gauss, với <s>noise</s> nhiễu được thêm vào trong một giá trị trung bình đoán trước, việc tối đa hóa hạng tử entropy sẽ làm tăng độ lệch chuẩn của <s>noise</s> nhiễu. Nói cách khác, hạng tử entropy này kích thích phân phối biến phân gán khối lượng xác suất cao vào nhiều các giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1995"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1996">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">\boldsymbol z</script></span> có thể tổng hợp được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1997"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1998">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">\boldsymbol x</script></span>, thay vì phải suy biến về một điểm ước lượng duy nhất của những giá trị có khả năng cao. Xét phương trình 20.77, ta nhận ra hạng tử đầu tiên là hàm logarit hợp lý tái cấu trúc xuất phát từ các bộ tự mã hóa khác. Hạng tử thứ hai có nhiệm vụ điều khiển phân phối hậu nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1999"><span class="MJXp-mrow" id="MJXp-Span-2000"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2001">q</span></span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2003"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2004">z</span></span><span class="MJXp-mo" id="MJXp-Span-2005" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2006">x</span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">\mathcal{q} (\textbf z \mid \boldsymbol x )</script></span> và mô hình tiên nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2008"><span class="MJXp-msubsup" id="MJXp-Span-2009"><span class="MJXp-mrow" id="MJXp-Span-2010" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2011">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2012" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2013">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2015">z</span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\mathcal{p} _ { \text { model } }(\boldsymbol z)</script></span> xích lại gần nhau.</p><p>Các phương pháp thông thường tiếp cận suy diễn biến phân và học suy luận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">q</script></span> thông qua thuật toán tối ưu hóa, phổ biến với việc lặp lại các phương trình điểm cố định (phần 19.4). Những cách tiếp cận này thường tốn thời gian và yêu cầu khả năng tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2019"><span class="MJXp-msubsup" id="MJXp-Span-2020"><span class="MJXp-mrow" id="MJXp-Span-2021" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2022">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2023" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">z</span><span class="MJXp-mo" id="MJXp-Span-2025">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">q</span></span></span><span class="MJXp-mi" id="MJXp-Span-2027">log</span><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2031" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2032">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-2033" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2034">z</span><span class="MJXp-mo" id="MJXp-Span-2035" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2036">x</span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">\mathbb { E } _ { z  \sim q } \log p _ { \text { model } } ( \boldsymbol { z } , \boldsymbol { x } )</script></span> ở dạng đóng. Ý tưởng chính của bộ tự mã hóa biến phân là việc huấn luyện bộ mã hóa tham số (thường được gọi là mạng suy luận hay mô hình nhận dạng) để sinh ra tham số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">q</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">q</script></span>. Miễn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2040"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2041">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">\boldsymbol z</script></span> là biến số liên tục, chúng ta có thể lan truyền ngược lại các mẫu của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2042"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2043">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">\boldsymbol z</script></span> đã trích xuất từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">q</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2047">z</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2049">x</span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">q</span><span class="MJXp-mo" id="MJXp-Span-2053" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2054">z</span><span class="MJXp-mo" id="MJXp-Span-2055" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">f</span><span class="MJXp-mo" id="MJXp-Span-2057" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2058">x</span><span class="MJXp-mo" id="MJXp-Span-2059" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2060">θ</span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">q(\boldsymbol z \mid \boldsymbol x) = q(\boldsymbol z; f(\boldsymbol x; \boldsymbol\theta))</script></span> để thu được gradient theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2063"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2064">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">\boldsymbol\theta</script></span>. Quá trình học sau đó chỉ duy nhất gồm việc tối đa hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2065"><span class="MJXp-mrow" id="MJXp-Span-2066"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2067">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\mathcal{L}</script></span> theo các tham số của bộ mã hóa và bộ giải mã. Tất cả các kỳ vọng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mrow" id="MJXp-Span-2069"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2070">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">\mathcal{L}</script></span> có thể được xấp xỉ thông qua phép lấy mẫu Monte Carlo.</p><p>Phương pháp tiếp cận của bộ mã hóa biến phân là đơn giản cả về mặt lý thuyết và cách cài đặt. Đồng thời nó cũng đem lại kết quả rất tốt và được xếp vào hàng những phương pháp tối tân cho mô hình sinh mẫu. Điểm yếu lớn nhất chính là việc các mẫu được huấn luyện dựa trên các tấm hình <s>chuẩn thay vì là những tấm hình</s> có xu hướng bị mờ nhòe. Nguyên nhân dẫn đến hiện tượng này hiện chưa được giải thích. Có khả năng sự mờ nhòe chính là hiệu ứng nội tại của hàm hợp lí cực đại, dẫn đến việc cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2071"><span class="MJXp-msubsup" id="MJXp-Span-2072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2074" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2075"><span class="MJXp-mi" id="MJXp-Span-2076">K</span><span class="MJXp-mi" id="MJXp-Span-2077">L</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2078"><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2082" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2083"><span class="MJXp-mi" id="MJXp-Span-2084">d</span><span class="MJXp-mi" id="MJXp-Span-2085">a</span><span class="MJXp-mi" id="MJXp-Span-2086">t</span><span class="MJXp-mi" id="MJXp-Span-2087">a</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-msubsup" id="MJXp-Span-2089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2091" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2092"><span class="MJXp-mi" id="MJXp-Span-2093">m</span><span class="MJXp-mi" id="MJXp-Span-2094">o</span><span class="MJXp-mi" id="MJXp-Span-2095">d</span><span class="MJXp-mi" id="MJXp-Span-2096">e</span><span class="MJXp-mi" id="MJXp-Span-2097">l</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2098" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">D _ { \mathrm { KL } } \left( p _ { \mathrm { data } } \| p _ { \mathrm { model } } \right)</script></span>. Như mô phỏng trong hình 3.6, điều nãy tương ứng việc mô hình sẽ gán xác suất cao cho các điểm có mặt trong tập hợp huấn luyện nhưng đồng thời cũng gán xác suất cao cho các điểm khác. Những điểm khác này bao gồm cả những hình bị mờ nhòe. Một phần lý do khiến mô hình chọn gán <em>hàm khối xác suất</em> (probability mass) cho các hình mờ nhòe thay vì một số phần không gian khác là vì các bộ tự mã hóa biến phân trong thực nghiệm thường mang phép phân phối Gauss cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2099"><span class="MJXp-msubsup" id="MJXp-Span-2100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2102" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2103">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2105">x</span><span class="MJXp-mo" id="MJXp-Span-2106" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">g</span><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2109">z</span><span class="MJXp-mo" id="MJXp-Span-2110" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2111" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">p _ { \text { model } } ( \boldsymbol{x} ; g (\boldsymbol z ) )</script></span>. Cực đại hóa cận dưới hàm hợp lý của phép phân phối giống với việc huấn luyện một bộ tự mã hóa thông thường với sai số trung bình bình phương, theo nghĩa là nó có xu hướng bỏ qua các đặc trưng của đầu vào chỉ chiếm vài điểm ảnh là nguyên nhân của sự thay đổi duy nhất trong độ sáng của các điểm ảnh mà nó chiếm giữ. Đây không chỉ là vấn đề của các VAE mà là của cả mô hình sinh mẫu với vai trò tối ưu hóa hàm logarit hợp lý, hay tương ứng là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2112"><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2115" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2116"><span class="MJXp-mi" id="MJXp-Span-2117">K</span><span class="MJXp-mi" id="MJXp-Span-2118">L</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2119"><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2123" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2124"><span class="MJXp-mi" id="MJXp-Span-2125">d</span><span class="MJXp-mi" id="MJXp-Span-2126">a</span><span class="MJXp-mi" id="MJXp-Span-2127">t</span><span class="MJXp-mi" id="MJXp-Span-2128">a</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2129" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-msubsup" id="MJXp-Span-2130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2132" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2133"><span class="MJXp-mi" id="MJXp-Span-2134">m</span><span class="MJXp-mi" id="MJXp-Span-2135">o</span><span class="MJXp-mi" id="MJXp-Span-2136">d</span><span class="MJXp-mi" id="MJXp-Span-2137">e</span><span class="MJXp-mi" id="MJXp-Span-2138">l</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">D _ { \mathrm { KL } } \left( p _ { \mathrm { data } } \| p _ { \mathrm { model } } \right)</script></span>, theo như lập luận của Theis <em>et al</em>. (2015) và Huszar (2015). Một vấn đề trở ngại nữa của các mô hình VAE tạm thời là chúng thường chỉ sử dụng một tập con nhỏ trong không gian của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2140"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2141">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">\boldsymbol z</script></span>, như thể rằng bộ tự mã hóa không đủ khả năng để chuyển đổi một lượng cần thiết các hướng cục bộ trong không gian đầu vào đến một không gian nơi các phân phối <s>nhỏ lẻ</s> biên phù hợp với yếu tố tiên nghiệm.</p><p>Bộ khung <s>Khuôn mẫu</s> của VAE rất đơn giản để mở rộng với nhiều loại kiến trúc mô hình khác nhau. Đây có thể xem là một lợi thế hơn so với cấu trúc máy Boltzmann, thứ yêu cầu mô hình thiết kế phải thật tỉ mỉ để duy trì tính truy vết. Các mô hình VAEs làm việc tốt với đa dạng nhóm các bộ xử lí khả vi. Một mô hình VAE phức tạp điển hình là mô hình <strong>Tập trung ghi chép truy hồi sâu - Deep recurrent attention writer (DRAW)</strong> (Gregor et al.,2015). Mô hình DRAW sử dụng bộ mã hóa truy hồi và bộ giải mã truy hồi kết hợp với cơ chế tập trung. Quá trình sinh mẫu của mô hình DRAW bao gồm việc tuần tự xét từng điểm nối của hình ảnh và tính toán giá trị của các điểm ảnh tại điểm nối đó. Các VAE có thể được mở rộng để sinh các chuỗi bằng cách định nghĩa các RNN biến phấn (Chung et al., 2015b) sử dụng bộ mã hóa và bộ giải mã truy hồi ở trong <s>khuân mẫu mô hình</s> bộ khung VAE. Việc sinh mẫu từ một RNN thông thường chỉ bao gồm các xử lí không xác định thuộc không gian đầu ra. Các RNN biến phân cũng có các thay đổi ngẫu nhiên ở mức độ cần khả năng trừu tượng cao hơn, thực hiện bởi các biến tiềm ẩn của VAE.</p><p>Bộ khung <s>Khuôn mẫu mô hình</s> VAE đã được mở rộng để tối đa hóa không chỉ với cận dưới biến phân thường thấy, mà còn với hàm mục tiêu của <em>bộ tự mã hóa có trọng số ưu tiên</em> (importance-weighted autoencoder) (Burdaet al., 2015):</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2142"><span class="MJXp-mtable" id="MJXp-Span-2143"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2144" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2145" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2146"><span class="MJXp-mrow" id="MJXp-Span-2147" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2148">L</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2149" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2152">x</span><span class="MJXp-mo" id="MJXp-Span-2153" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154">q</span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2157"><span class="MJXp-mrow" id="MJXp-Span-2158" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2159">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2160" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2161"><span class="MJXp-mrow" id="MJXp-Span-2162" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2163">z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2164" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2165">(</span><span class="MJXp-mn" id="MJXp-Span-2166">1</span><span class="MJXp-mo" id="MJXp-Span-2167">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2168">,</span><span class="MJXp-mo" id="MJXp-Span-2169">…</span><span class="MJXp-mo" id="MJXp-Span-2170">,</span><span class="MJXp-msubsup" id="MJXp-Span-2171"><span class="MJXp-mrow" id="MJXp-Span-2172" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-2173">z</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2174" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2175">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">k</span><span class="MJXp-mo" id="MJXp-Span-2177">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2178">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">q</span><span class="MJXp-mo" id="MJXp-Span-2180">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2181">z</span><span class="MJXp-mrow" id="MJXp-Span-2182"><span class="MJXp-mo" id="MJXp-Span-2183">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2184">x</span><span class="MJXp-mo" id="MJXp-Span-2185">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2186"><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">[</span></span><span class="MJXp-mi" id="MJXp-Span-2188">log</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-2190" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2191">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192">k</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-2193"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2199" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">k</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-2194" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2195" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">i</span><span class="MJXp-mo" id="MJXp-Span-2197">=</span><span class="MJXp-mn" id="MJXp-Span-2198">1</span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2201" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2205">&nbsp;model&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-2206"><span class="MJXp-mo" id="MJXp-Span-2207" style="vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2208">x</span><span class="MJXp-mo" id="MJXp-Span-2209">,</span><span class="MJXp-msubsup" id="MJXp-Span-2210"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2211" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2212" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2213">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">i</span><span class="MJXp-mo" id="MJXp-Span-2215">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">q</span><span class="MJXp-mrow" id="MJXp-Span-2218"><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2220"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2221" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2222" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2223">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">i</span><span class="MJXp-mo" id="MJXp-Span-2225">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2226" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2227">x</span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-233">\mathcal { L } _ { k } ( \boldsymbol { x } , q ) = \mathbb { E } _ { \mathbf { z } ^ { ( 1 ) } , \ldots , \mathbf { z } ^ { ( k ) } \sim q ( \boldsymbol { z } | \boldsymbol { x } ) } \left[ \log \frac { 1 } { k } \sum _ { i = 1 } ^ { k } \frac { p _ { \text { model } \left( \boldsymbol { x } , \boldsymbol { z } ^ { ( i ) } \right) } } { q \left( \boldsymbol { z } ^ { ( i ) } \mid \boldsymbol { x } \right) } \right] . \tag{20.79}</script></span></p><p>Hàm mục tiêu mới này là tương đương với cận dưới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2231"><span class="MJXp-mrow" id="MJXp-Span-2232"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2233">L</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">\mathcal { L }</script></span> thường thấy với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">k</span><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2237">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">k = 1</script></span>. Tuy nhiên, nó cũng có thể được hiểu là hình thành một ước lượng đúng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2238"><span class="MJXp-mi" id="MJXp-Span-2239">log</span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2241"><span class="MJXp-mrow" id="MJXp-Span-2242" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2243">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2244" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2245">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2247">x</span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">\log \mathcal{p} _ { \text { model } } ( \boldsymbol{x} )</script></span> bằng cách sử dụng một bản mẫu có độ ưu tiên lớn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2249"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2250">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">\boldsymbol z</script></span> từ phân phối đề xuất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">q</span><span class="MJXp-mo" id="MJXp-Span-2253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2254">z</span><span class="MJXp-mo" id="MJXp-Span-2255" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2256">x</span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">q(\boldsymbol z \mid \boldsymbol{x})</script></span>. Hàm mục tiêu của bộ tự mã hóa có trọng số ưu tiên cũng chính là cận dưới của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2258"><span class="MJXp-mi" id="MJXp-Span-2259">log</span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2261"><span class="MJXp-mrow" id="MJXp-Span-2262" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2263">p</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2264" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2265">&nbsp;model&nbsp;</span></span></span><span class="MJXp-mo" id="MJXp-Span-2266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2267">x</span><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">\log \mathcal{p} _ { \text { model } } ( \boldsymbol{x} )</script></span> và sẽ càng thắt lại khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">k</script></span> tăng lên.</p><p>Bộ tự mã hóa biến phân có một số liên kết thú vị với MP-DBM và các phương pháp tiếp cận khác có bao gồm lan truyền ngược qua đồ thị suy luận xấp xỉ (Goodfellow <em>et al</em>., 2013b; Stoyanov <em>et al</em>., 2011; Brakel et al., 2013). Những cách tiếp cận trước đây yêu cầu một <s>chương trình biến phân con</s> thủ tục suy luận như phương trình điểm cố định trường trung bình để cung cấp đồ thị tính toán. Bộ tự phân mã hóa biến phân được định nghĩa cho các đồ thị tính toán tuỳ ý, giúp nó ứng dụng dễ dàng cho nhiều loại họ mô hình xác suất, vì ta không cần phải quan tâm mô hình đó có hay không khả năng truy vết các phương trình điểm cố định trường trung bình. Bộ tự mã hóa biến phân cũng có lợi thế trong việc gia tăng một cận của logarit hàm hợp lý của mô hình, trong khi tiêu chí của mô hình MP-DMB và các loại mô hình liên quan tính kinh nghiệm nhiều hơn và có quá ít các diễn giải xác suất đủ để dẫn đến kết quả đúng cho suy luận xấp xỉ. Một bất lợi của bộ tự mã hóa biến phân nằm ở việc nó chỉ học mạng suy luận cho duy nhất một vấn đề, từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2271"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2272">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\boldsymbol x</script></span> suy ra <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2273"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2274">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\boldsymbol z</script></span>. Các phương pháp cũ có khả năng thực hiện suy luận xấp xỉ đối với bất kì một tập con có chứa biến, nếu cho trước các tập con chứa biến khác, bởi vì các phương trình điểm cố định trường trung bình đã xác định cách thức dùng chung các tham số giữa các đồ thị tính tóan cho tất cả những bài toán khác nhau.</p><p>Một tính chất khá hay khác của bộ tự mã hóa biến phân là khả năng đồng thời huấn luyện một bộ mã hóa tham số kết hợp với mạng sinh mẫu buộc mô hình phải học một hệ thống dễ đoán tương ứng mà bộ mã hóa có thể nắm bắt. Điều này đã làm nó trở thành một mô hình học thuật toán đa dạng hoàn hảo. Tham khảo hình 20.6 để thấy ví dụ về sự học đa dạng ở chiều thấp của bộ tự mã hóa biến phân. Trong một trường hợp được miêu tả trên hình, thuật toán đã phát hiện 2 yếu tố biến phân độc lập được thể hiện trên khuôn mặt: góc xoay và biểu cảm.</p><p>================Lan, Thành Sơn kết thúc dịch ở đây (p695)------------<br>
--------------- Phát Võ bắt đầu dịch từ đây ----------------------<br>
----------------Pages: 696-705 ------------------------------<br>
<img src="https://i.imgur.com/ljE0egE.png" alt=""></p><blockquote>
<p>Hình 20.6: Ví dụ của các hệ toạ độ hai chiều cho các đa tạp có số chiều lớn, được học bởi bộ tự mã hoá biến phân (Kingma and Welling, 2014a). Hai chiều có thể được vẽ ra trực tiếp trên giấy để biểu diễn, thế nên chúng ta có thể hiểu được cách mô hình hoạt động như thế nào bằng việc huấn luyện mô hình với mã tiềm ẩn hai chiều, mặc dù biết rằng bản chất chiều của đa tạp dữ liệu lớn hơn rất nhiều. Những hình trên không chỉ là ví dụ từ tập huấn luyện mà còn là những hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2275"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2276">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">\boldsymbol x</script></span> thực sự được sinh ra bởi mô hình <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2277"><span class="MJXp-mrow" id="MJXp-Span-2278"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2279">p</span></span><span class="MJXp-mo" id="MJXp-Span-2280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2281">x</span><span class="MJXp-mo" id="MJXp-Span-2282" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2283">z</span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">\mathcal{p}(\boldsymbol x \mid \boldsymbol z)</script></span> đơn giản bằng cách thay đổi “mã” hai chiều <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2286">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">\boldsymbol z</script></span> (mỗi hình tương ứng với một lựa chọn khác nhau của “mã” <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2287"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2288">z</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-246-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-246">\boldsymbol z</script></span> trên hệ tọa độ đồng nhất hai chiều). (<em>Hình bên trái</em>) Ánh xạ hai chiều của đa tạp Grey face. Một chiều đã được được phát hiện ra (<em>chiều ngang</em>) gần như tương ứng với việc xoay khuôn mặt trong khi chiều còn lại (<em>chiều dọc</em>) tương ứng với các biểu đạt cảm xúc. (<em>Hình bên phải</em>) Ánh xạ hai chiều của đa tạp MNIST.</p>
</blockquote><h2 id="20104-Các-mạng-đối-kháng-sinh-mẫu">20.10.4 Các mạng đối kháng sinh mẫu</h2><p>Các <em>mạng đối kháng sinh mẫu</em>, hay <em>GAN</em> (Generative Adversarial Network) (Goodfellow <em>et al</em>., 2014c) là một hướng tiếp cận mô hình sinh mẫu dựa trên các mạng sinh mẫu khả vi.<br>
Các mạng đối kháng sinh mẫu dựa trên lý thuyết trò chơi trong đó mạng sinh mẫu phải cạnh tranh chống lại đối thủ. Mạng sinh mẫu trực tiếp tạo ra các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2289"><span class="MJXp-mrow" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2291">x</span><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2293"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2294">g</span></span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2296">z</span><span class="MJXp-mo" id="MJXp-Span-2297" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-2298"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2299" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2300" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2301">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">g</span><span class="MJXp-mo" id="MJXp-Span-2303">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">{\boldsymbol x = \mathcal{g}(\boldsymbol z;\boldsymbol\theta^{(g)})}</script></span>. Đối thủ của nó, <em>mạng phân biệt</em> (discriminator network) sẽ cố gắng phân biệt ra đâu là những mẫu được rút ra từ dữ liệu huấn luyện và đâu là những mẫu do mạng sinh mẫu chế ra. Mạng phân biệt cho ra một giá trị tính bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2305"><span class="MJXp-mrow" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">d</span><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2309">x</span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2312" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2313" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2314">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">d</span><span class="MJXp-mo" id="MJXp-Span-2316">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">{d(\boldsymbol x;\boldsymbol\theta^{(d)})}</script></span> chỉ ra xác suất rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2319">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-249-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-249">\boldsymbol x</script></span> là mẫu huấn luyện thật sự chứ không phải là mẫu giả được sinh ra từ mô hình.<br>
Cách đơn giản nhất để giải thích cho việc học trong các mạng đối kháng sinh mẫu là <em>trò chơi tổng-không</em> (zero-sum game) trong đó hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2320"><span class="MJXp-mrow" id="MJXp-Span-2321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">υ</span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2324"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2325" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2326" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2327">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">g</span><span class="MJXp-mo" id="MJXp-Span-2329">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2333" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2334" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2335">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">d</span><span class="MJXp-mo" id="MJXp-Span-2337">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-250-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-250">{\upsilon (\boldsymbol\theta^{(g)}), \boldsymbol\theta^{(d)})}</script></span> quyết định điểm thưởng của mạng phân biệt, còn điểm thưởng của mạng sinh mẫu là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-mrow" id="MJXp-Span-2340"><span class="MJXp-mo" id="MJXp-Span-2341" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">υ</span><span class="MJXp-mo" id="MJXp-Span-2343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2346" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2347">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">g</span><span class="MJXp-mo" id="MJXp-Span-2349">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2350" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2354" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2355">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">d</span><span class="MJXp-mo" id="MJXp-Span-2357">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">{- \upsilon (\theta^{(g)}),\theta^{(d)})}</script></span>. Trong quá trình học, mỗi phe sẽ cố gắng tối đa hóa điểm thưởng của mình, qua đó đến điểm hội tụ</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2372"><span class="MJXp-mtable" id="MJXp-Span-2373"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2374" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2375" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2376"><span class="MJXp-mrow" id="MJXp-Span-2377" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2378">g</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2379" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2381">arg</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-2383"><span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-2386"><span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388" style="margin-left: 0px;">d</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">υ</span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">g</span><span class="MJXp-mo" id="MJXp-Span-2392" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393">d</span><span class="MJXp-mo" id="MJXp-Span-2394" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-252">\mathcal{g}^* = \arg\min_x\max_d \upsilon (g,d) \tag{20.80}</script></span><br>
Lựa chọn mặc định cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">υ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">\upsilon</script></span> là</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2397"><span class="MJXp-mtable" id="MJXp-Span-2398"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2399" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2400" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">υ</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2404" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2405" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2406">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407">g</span><span class="MJXp-mo" id="MJXp-Span-2408">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2410"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2411" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2412" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2413">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">d</span><span class="MJXp-mo" id="MJXp-Span-2415">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2417" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mrow" id="MJXp-Span-2419" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2420">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2421" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2422"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2423">x</span></span><span class="MJXp-mo" id="MJXp-Span-2424">∼</span><span class="MJXp-msubsup" id="MJXp-Span-2425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2427" style="vertical-align: -0.4em;">data</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2428">log</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">d</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2432">x</span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2435"><span class="MJXp-mrow" id="MJXp-Span-2436" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2437">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2438" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2439">x</span><span class="MJXp-mo" id="MJXp-Span-2440">∼</span><span class="MJXp-msubsup" id="MJXp-Span-2441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-2443" style="vertical-align: -0.4em;">model</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-2444">log</span><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2447">1</span><span class="MJXp-mo" id="MJXp-Span-2448" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">d</span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2451">x</span><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2454" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-254"> \upsilon (\boldsymbol\theta ^ {(g)}, \boldsymbol\theta ^ {(d)}) = \mathbb{E}_{\textbf x \sim p_\text {data}} \log d(\boldsymbol x) + \mathbb{E}_{\boldsymbol x \sim p_\text {model}} \log (1-d(\boldsymbol x)). \tag{20.81}</script></span></p><p>Điều này dẫn đến việc mạng phân biệt cố gắng học cách phân loại chính xác các mẫu thật giả. Đồng thời, mạng sinh mẫu cũng cố gắng để lừa mạng phân biệt rằng mẫu mà nó sinh ra là hàng thật. Tại điểm hội tụ, các mẫu của mạng sinh mẫu sẽ không thể phân biệt được với mẫu thật và mạng phân biệt sẽ xác định xác suất <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2455"><span class="MJXp-mn" id="MJXp-Span-2456">1</span><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-2459">2</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">1/2</script></span> tại mọi mẫu. Sau đó mạng phân biệt có thể được gỡ bỏ.</p><p>Động lực chính cho việc thiết kế các mạng đối kháng sinh mẫu là do quá trình học không đòi hỏi việc suy luận đúng hoặc xấp xỉ hàm phân bổ gradient. Khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">a</span><span class="MJXp-msubsup" id="MJXp-Span-2463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2465" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">υ</span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">g</span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">d</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">max_d \upsilon (g,d)</script></span> lồi tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2472"><span class="MJXp-msubsup" id="MJXp-Span-2473"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2474" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2475" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2476">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">g</span><span class="MJXp-mo" id="MJXp-Span-2478">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">\boldsymbol\theta^{(g)}</script></span> (chẳng hạn như trường hợp khi việc tối ưu hóa được thực hiện trực tiếp trong không gian của các hàm mật độ xác suất), phương pháp được đảm bảo là sẽ hội tụ và tiệm cận nhất quán.</p><p>Không may thay, việc học các mạng đối kháng sinh mẫu có thể khó khăn trong thực tế khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-258-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-258">g</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-259-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-259">d</script></span> được biểu diễn bằng các mạng neuron và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">a</span><span class="MJXp-msubsup" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2488" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489">υ</span><span class="MJXp-mo" id="MJXp-Span-2490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491">g</span><span class="MJXp-mo" id="MJXp-Span-2492" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">d</span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-260-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-260">max_d \upsilon(g,d)</script></span> không lồi. Goodfellow(2014) đã nhận định rằng việc không hội tụ là vấn đề có thể khiến các mạng đối kháng sinh mẫu bị vị khớp. Nhìn chung, đồng thời trượt theo gradient trên hàm chi phí của hai phe không đảm bảo rằng sẽ đi đến được điểm cân bằng. Ví dụ, với một hàm giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496">υ</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498">a</span><span class="MJXp-mo" id="MJXp-Span-2499" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">b</span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2502" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2504">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-261-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-261">\upsilon(a,b) = ab</script></span>, khi một phe kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-262-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-262">a</script></span> và phát sinh chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-263-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-263">ab</script></span>, trong khi phe kia kiểm soát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-264-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-264">b</script></span> và nhận chi phí <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2512"><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-265-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-265">-ab</script></span>. Nếu chúng ta mô phỏng mỗi phe bằng cách tạo những bước gradient cực nhỏ, mỗi phe bị mất một khoảng điểm bằng khoảng điểm mà phe kia ăn được thì <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">a</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-266-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-266">a</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">b</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-267-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-267">b</script></span> sẽ rơi vào một quỹ đạo tròn đều, thay vì tiến đến điểm hội tụ tại gốc. Lưu ý rằng các điểm cân bằng của trò chơi minimax không phải là các điểm cực tiểu cục bộ của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">υ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-268-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-268">\upsilon</script></span>. Thay vào đó, chúng là những điểm cực tiểu đồng thời đối với chi phí của cả hai phe. Điều này có nghĩa rằng chúng là điểm yên ngựa của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">υ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-269-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-269">\upsilon</script></span>, là các điểm cực tiểu cục bộ liên quan tới các tham số của phe thứ nhất và là điểm cực đại cục bộ liên quan tới các tham số của phe thứ hai. Có khả năng hai phe sẽ thay phiên nhau tăng giảm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">υ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-270-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-270">\upsilon</script></span> mãi mãi, thay vì rơi đúng vào điểm yên ngựa - nơi cả hai phe không thể giảm giá trị được nữa. Chúng ta chưa biết được rằng vấn đề không hội tụ này sẽ ảnh hưởng đến thế nào đối với các mạng đối kháng sinh mẫu.</p><p>Goodfellow(2014) đã định ra một công thức thay thế cho điểm thưởng, trong đó trò chơi sẽ không còn là tổng-không nữa mà sẽ có cùng một gradient mong đợi dưới dạng học hợp lý cực đại khi mạng phân biệt tối ưu. Bởi vì việc huấn luyện hợp lý cực đại hội tụ, việc tái công thức hoá này của trò chơi mạng đối kháng sinh mẫu cũng sẽ hội tụ nếu có đủ mẫu huấn luyện. Đáng tiếc là việc công thức hoá này có vẻ không cải thiện được việc hội tụ trong thực tế, có khả năng là do việc gần điểm tối ưu của mạng phân biệt hoặc độ lệch cao quanh gradient mong đợi.</p><p>Trong các thử nghiệm thực tế, việc công thức hoá mang hiệu quả tốt nhất của trò chơi mạng đối kháng sinh mẫu là một cách công thức hoá khác không phải tổng-không, cũng không phải hợp lý cực đại, được giới thiệu bởi Goodfellow et al. (2014c) dựa trên suy nghiệm. Trong cách công thức hoá mang hiệu quả tốt nhất này, mạng sinh mẫu nhắm đến việc tăng xác suất logarit khiến mạng phân biệt phạm phải sai lầm, thay vì nhắm đến việc giảm xác suất logarit khiế mạng phân biệt dự đoán đúng. Việc tái công thức hoá này được thúc đẩy đơn thuần bởi việc quan sát thấy rằng nó gây ra đạo hàm của hàm chi phí của mạng sinh mẫu đối với logarit của mạng phân biệt vẫn giữ nguyên độ lớn ngay trong cả trường hợp khi mạng phân biệt tự tin bác bỏ mọi mẫu sinh ra.</p><p>Cân bằng việc học của mạng đối kháng sinh mẫu tồn tại một vấn đề mở. May mắn là việc học mạng đối kháng sinh mẫu có thể hoạt động tốt khi kiến trúc mô hình và các siêu tham số được lựa chọn cẩn thận. Radford et al. (2015) đã ráp ra được một <em>mạng đối kháng sinh mẫu tích chập đa tầng</em> (Deep Convolutional GAN - DCGAN) thực hiện rất tốt các <s>công việc</s> tác vụ tổng hợp hình ảnh và thể hiện rằng không gian biểu diễn tiềm ẩn của nó nắm bắt được các yếu tố quan trọng của sự biến đổi như được chỉ ra ở hình 15.9. Xem hình 20.7 về các ví dụ của các hình ảnh được tạo ra bởi mạng sinh mẫu của mạng đối kháng sinh mẫu tích chập đa tầng.</p><p>Vấn đề học mạng đối kháng sinh mẫu cũng có thể được đơn giản hoá bằng cách tách quá trình sinh mẫu thành nhiều mức độ chi tiết. Ta có thể huấn luyện các mạng đối kháng sinh mẫu có điều kiện (Mirzaand Osindero, 2014) học cách sinh mẫu từ phân phối <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2526"><span class="MJXp-mrow" id="MJXp-Span-2527"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2528">p</span></span><span class="MJXp-mo" id="MJXp-Span-2529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2530">x</span><span class="MJXp-mo" id="MJXp-Span-2531" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2532">y</span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-271-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-271">\mathcal{p}(\boldsymbol x \mid \boldsymbol y)</script></span> thay vì đơn thuần sinh mẫu từ phân phối biên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">p</span><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2537">x</span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-272-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-272">p(\boldsymbol x)</script></span>. Denton <em>et al</em>. (2015) chỉ ra rằng một dãy mạng đối kháng sinh mẫu có điều kiện có thể được huấn luyện để trước tiên sinh ra những phiên bản hình ảnh có độ phân giải cực thấp, sau đó dần tăng cường chi tiết ảnh. Kỹ thuật này được gọi là mô hình <em>mạng đối kháng sinh mẫu Laplace</em> (Laplacian Generative Adversarial Network - LAPGAN) do việc sử dụng tháp Laplace để sinh ra những hình ảnh mang mức độ chi tiết khác nhau. Các mạng sinh mẫu của mạng đối kháng sinh mẫu Laplace có thể đánh lừa cả các mạng phân biệt lẫn quan sát của con người, các đối tượng thử nghiệm đã xác định nhầm tới 40% đầu ra của mạng này là dữ liệu thật. Xem hình 20.7 về các ví dụ của hình ảnh được sinh ra bởi mạng sinh mẫu trong mạng đối kháng sinh mẫu Laplace.</p><p>Một khả năng phi thường của quá trình huấn luyện mạng đối kháng sinh mẫu là nó có thể khớp các phân phối xác suất được gán xác suất 0 cho các điểm huấn luyện. Thay vì tối đa hóa xác suất logarit của các điểm cụ thể, mạng sinh mẫu học cách xác định đa tạp là các điểm tương đồng với các điểm huấn luyện theo một cách nào đó. Một cách khá ngược đời, điều này nghĩa là mô hình có thể gán hợp lý logarit của âm vô cùng cho tập kiểm tra, trong khi vẫn thể hiện ra đa tạp mà mắt người phán đoán rằng đã nắm bắt được bản chất của việc sinh mẫu. Chuyện này chưa rõ là ưu điểm hay nhược điểm, và một điều nữa có thể đảm bảo rằng mạng sinh mẫu gán xác suất khác không cho mọi điểm một cách đơn giản bằng việc khiến lớp cuối cùng của mạng sinh mẫu tăng thêm nhiễu Gauss cho toàn bộ các giá trị được sinh ra. Những mạng sinh mẫu tăng thêm nhiễu Gauss theo cách này sinh ra mẫu thuộc cùng một phân phối, phân phối này có thể đạt được bằng cách dùng mạng sinh mẫu tham số hóa giá trị trung bình của phân phối Gauss có điều kiện.</p><p>Cơ chế tắt ngẫu nhiên có vẻ quan trọng trong mạng phân biệt. Cụ thể, các đơn vị nên được tắt một cách ngẫu nhiên trong lúc tính toán gradent để mạng sinh mẫu theo dõi. Tiếp theo, gradient của phiên bản tất định thuộc mạng phân biệt với các trọng số bị chia hai có vẻ không hiệu quả. Tương tự, không bao giờ dùng cơ chế tắt ngẫu nhiên có vẻ sẽ cho ra các kết quả kém.</p><p>Trong khi bộ khung mạng đối kháng sinh mẫu được thiết kế cho các mạng sinh mẫu khả vi, những nguyên tắc tương tự cũng có thể được sử dụng để huấn luyện nhiều loại mô hình khác. Ví dụ, mô hình tăng cường tự giám sát có thể được dùng để huấn luyện mạng sinh mẫu RBM để đánh lừa mạng phân biệt hồi quy logit (Welling <em>et al</em>., 2002).</p><p><img src="https://i.imgur.com/l5PrFoe.jpg" alt=""></p><blockquote>
<p>Hình 20.7: Các hình ảnh được sinh ra từ các mạng đối kháng sinh mẫu được huấn luyện dựa trên tập dữ liệu LSUN. (<em>Trái</em>) Hình ảnh phòng ngủ được sinh ra bởi mô hình mạng tích chập sâu đối kháng sinh mẫu, được trình bày với sự cho phép của Radfordet al. (2015). (<em>Phải</em>) Hình ảnh nhà thờ được sinh ra bởi mô hình mạng đối kháng sinh mẫu Laplace, được trình bày với sự cho phép của Denton et al. (2015).</p>
</blockquote><h2 id="20105-Các-mạng-tương-hợp-moment-sinh-mẫu">20.10.5 Các mạng tương hợp moment sinh mẫu</h2><p>Các mạng tương hợp moment sinh mẫu (Li <em>et al</em>., 2015; <em>Dziugaite et al</em>.,2015) là một dạng khác của mô hình sinh mẫu dựa trên các mạng sinh mẫu khả vi. Không như bộ tự mã hoá <s>biến đổi</s> biến phân và mạng đối kháng sinh mẫu, chúng không cần ghép cặp mạng sinh mẫu với một mạng khác, kể cả mạng suy luận khi dùng với bộ tự mã hoá <s>biến đổi</s> biến phân hay mạng phân biệt khi dùng với mạng đối kháng sinh mẫu.</p><p>Các mạng tương hợp moment sinh mẫu được huấn luyện bằng kỹ thuật gọi là <em>tương hợp moment</em>. Ý tưởng cơ bản đứng đằng sau tương hợp moment là huấn luyện mạng sinh mẫu theo hướng mà nhiều thống kê của các mẫu được tạo ra bởi mô hình càng giống với các mẫu trong tập huấn luyện càng tốt. Trong phạm vi này, một moment là một kỳ vọng của các luỹ thừa khác nhau của biến ngẫu nhiên. Ví dụ moment bậc một là trung bình, moment bậc hai là trung bình của các giá trị bình phương,… Trong nhiều chiều, từng phần tử của một biến ngẫu nhiên có thể được nâng lên một lũy thừa khác nhau, do đó một moment có thể là bất cứ số lượng nào dưới dạng</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2539"><span class="MJXp-mtable" id="MJXp-Span-2540"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2541" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2542" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mrow" id="MJXp-Span-2544" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2545">E</span></span><span class="MJXp-mi MJXp-bold MJXp-italic MJXp-script" id="MJXp-Span-2546" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-munderover" id="MJXp-Span-2547"><span><span class="MJXp-mo" id="MJXp-Span-2548" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∏</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-left: 0px;">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-2553"><span class="MJXp-msubsup" id="MJXp-Span-2554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2556" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2552">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-273"> \mathbb{E}_\boldsymbol x \prod_i x_i ^ {n_i}, \tag{20.82} </script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2559">n</span><span class="MJXp-mo" id="MJXp-Span-2560" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2561" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2568" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2569" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2572" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2575" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-msubsup" id="MJXp-Span-2576"><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-2578" style="vertical-align: 0.5em;">⊤</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-274-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-274">n = [n_1, n_2,...n_d] ^ \top</script></span> là vector các số nguyên không âm.</p><p>Trong lần khảo sát đầu tiên, hướng tiếp cận này có vẻ bất khả thi để tính toán. Ví dụ nếu chúng ta muốn tương hợp toàn bộ moment dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2579"><span class="MJXp-msubsup" id="MJXp-Span-2580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2582" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-2583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2585" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-275-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-275">x_i x_j</script></span> thì chúng ta cần phải cực tiểu hoá sự chênh lệch giữa các giá trị là bậc hai trong không gian của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2586"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2587">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-276-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-276">\boldsymbol x</script></span>. Hơn nữa, ngay cả khi tương hợp toàn bộ moment bậc một và bậc hai thì cũng chỉ đủ để khớp phân phối Gauss đa biến, vốn chỉ nắm bắt được quan hệ tuyến tính giữa các giá trị. Tham vọng của chúng ta đối với mạng neuron là nắm bắt được những quan hệ phi tuyến tính phức tạp, yêu cầu nhiều moment hơn rất nhiều. Các mạng đối kháng sinh mẫu tránh được vấn đề này của toàn bộ các moment liệt kê bằng cách sử dụng mạng phân biệt cập nhật động mà mạng này tự động tập trung chú ý vào thống kê của bất cứ thống kê nào mà mạng sinh mẫu đang tương hợp kém hiệu quả nhất.</p><p>Thay vào đó, các mạng tương hợp moment sinh mẫu có thể được huấn luyện bằng cách cực tiểu hoá hàm chi phí gọi là <em>chênh lệch trung bình tối đa</em> (maximum mean discrepancy - MMD). Hàm chi phí này đo đạc độ sai lệch trong các moment bậc một trong không gian vô hạn chiều, sử dụng ánh xạ ngầm với không gian đặc trưng được định nghĩa bởi <em>hàm hạch nhân</em> (core function) trên các vector vô hạn chiều có thể xử lý. Chi phí của hàm chênh lệch trung bình tối đa bằng không nếu và chỉ nếu hai phân phối được so sánh là bằng nhau.</p><p>Theo quan sát thì các mẫu từ các mạng tương hợp moment sinh mẫu khá đáng thất vọng. May mắn thay, chúng có thể được cải thiện bằng cách kết hợp mạng sinh mẫu với bộ tự mã hoá. Trước tiên, bộ tự mã hoá được huấn luyện để tái xây dựng tập huấn luyện. Tiếp theo, phần mã hoá của bộ tự mã hoá được sử dụng để biến đổi toàn bộ tập huấn luyện thành không gian mã. Mạng sinh mẫu sau đó được huấn luyện để sinh ra các mẫu mã, thứ có thể được ánh xạ thành các mẫu hình ảnh tốt thông qua phần giải mã.</p><p>Không như các mạng đối kháng sinh mẫu, hàm chi phí được định nghĩa chỉ liên hệ đến lô của các ví dụ từ cả tập huấn luyện và mạng sinh mẫu. Nó nhông thể khiến việc huấn luyện cập nhật dưới dạng hàm số của chỉ một mẫu huấn luyện hoặc chỉ một mẫu từ mạng sinh mẫu. Đây là vì các moment phải được tính toán dưới dạng thực nghiệm trung bình theo nhiều mẫu. Khi kích thước lô quá nhỏ, hàm chênh lệch trung bình tối đa có thể đánh giá thấp số lượng thật sự của sự biến thiên trong các phân phối được lấy mẫu. Không có kích thước lô hữu hạn nào là đủ lớn để loại bỏ vấn đề này hoàn toàn, nhưng các lô lớn hơn sẽ làm giảm số lượng đánh giá thấp hơn. Khi lô quá lớn, quá trình huấn luyện trở nên cực chậm bởi vì nhiều mẫu phải được xử lý để tính toán từng bước gradient nhỏ.</p><p>Giống như với GAN, có thể đào tạo một mạng sinh mẫu sử dụng MMD ngay cả khi mạng sinh mẫu đó gán cho xác suất bằng không cho các điểm huấn luyện.</p><h2 id="20106-Các-mạng-tích-chập-sinh-mẫu">20.10.6 Các mạng tích chập sinh mẫu</h2><p>Khi sinh ra các hình ảnh, thông thường sẽ hữu dụng khi dùng mạng sinh mẫu chứa cấu trúc tích chập (Ví dụ,  Goodfellow <em>et al</em>. [2014c] hoặc Dosovitskiy <em>et al</em>. [2015]). Để làm được điều đó, chúng ta sử dụng “chuyển vị” của toán tử tích chập, được miêu tả ở phần 9.5. Hướng tiếp cận này thường tạo ra nhiều hình ảnh chân thực hơn và dùng ít tham số hơn so với các tầng liên kết đầy đủ mà không có sự chia sẻ tham số.</p><p>Các mạng tích chập cho các tác vụ nhận diện có dòng thông tin từ hình ảnh tới một số tầng tổng kết tại đỉnh mạng lưới, thường là các nhãn lớp. Khi hình ảnh này truyền đi dọc lên mạng lưới, thông tin sẽ bị loại bỏ khi <s>tượng trưng của</s> biểu diễn của hình ảnh trở nên bất biến hơn đối với các phép biến đổi gây suy giảm. Trong mạng sinh mẫu, việc ngược lại mới đúng. Các chi tiết phong phú phải được thêm vào khi <s>tượng trưng</s> biểu diễn của bức ảnh được sinh ra lan truyền khắp mạng lưới, đến cực điểm là <s>tượng trưng</s> biểu diễn cuối cùng của bức ảnh, thứ dĩ nhiên chính là một tấm ảnh với chi tiết phong phú, các vị trí vật thể, kiểu dáng, kết cấu và ánh sáng. Kĩ thuật cốt lõi của việc loại bỏ thông tin trong mạng tích chập nhận diện là tầng gộp. Mạng sinh mẫu thường cần phải thêm vào thông tin. Chúng ta không thể đặt một nghịch đảo của tầng gộp vào mạng sinh mẫu bởi vì hầu hết các hàm gộp không thể nghịch đảo được. Có một toán tử đơn giản hơn để đơn thuần tăng kích thước không gian của đại diện. Một hướng tiếp cận có vẻ có mức hiệu quả chấp nhận được là sử dụng tầng “tách rời” (un-pooling), được giới thiệu bởi Dosovitskiy <em>et al</em>.(2015). Tầng này ứng với nghịch đảo của toán tử gộp cực đại trong một số điều kiện đơn giản nhất định. Thứ nhất, phần sải của toán tử gộp cực đại bị ép bằng chiều rộng của vùng gộp. Thứ hai, đầu vào cực đại trong từng vùng gộp được giả sử là đầu vào của góc trái trên. Cuối cùng, mọi đầu vào không cực đại trong từng vùng gộp được giả sử là không. Đây là những yếu tố giả sử rất mạnh và phi thực tế, nhưng chúng thật sự cho phép toán tử gộp cực đại nghịch đảo được. Toán tử tách rời nghịch đảo chỉ định một tensor gồm các số không, sau đó sao chép từng dữ liệu từ toạ độ không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2589">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-277-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-277">i</script></span> của đầu vào đến toạ độ không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2591">i</span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-278-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-278">i \times k</script></span> của đầu ra. Số nguyên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-279-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-279">k</script></span> định nghĩa kích thước của vùng gộp. Mặc dù các yếu tố giả sử thúc đẩy việc định nghĩa của toán tử tách rời là phi thực tế, các tầng phía sau sẽ có thể học được cách bù đắp cho những đầu ra bất thường của chúng, do đó các mẫu được sinh ra từ mô hình nhìn chung là dễ nhìn.</p><h2 id="20107-Các-mạng-tự-hồi-quy">20.10.7 Các mạng tự hồi quy</h2><p>Các mạng tự hồi quy là các mô hình xác suất có hướng không có các biến ngẫu nhiên tiềm ẩn. Các phân phối xác suất có điều kiện trong những mô hình này được thể hiện bằng các mạng neuron (đôi khi là các mạng neuron cực kỳ đơn giản, ví dụ như hồi quy logit). Cấu trúc đồ thị của những mô hình này là đồ thị đầy đủ. Chúng phân tích xác suất kết hợp trên các biến quan sát được bằng cách sử dụng <em>quy tắc dây chuyền</em> (chain rule) của xác suất để thu lấy tích của dạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">P</span><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2601" style="vertical-align: -0.4em;">d</span></span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606">d</span><span class="MJXp-mo" id="MJXp-Span-2607">−</span><span class="MJXp-mn" id="MJXp-Span-2608">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2613" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-280-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-280">P(x_d \mid x_{d-1}, \dots x_1)</script></span> có điều kiện. Những mô hình như vậy được gọi là những <em>mạng Bayes khả kiến đầy đủ</em> (fully-visible Bayes network - FVBN) và được sử dụng thành công dưới nhiều hình thức, đầu tiên là hồi quy logit cho từng phân phối có điều kiện (Frey, 1998), sau đó là các mạng neuron với các đơn vị ẩn (Bengioand Bengio, 2000b; Larochelle và Murray, 2011). Trong một số dạng mạng tự hồi quy, ví dụ như <em>bộ ước lượng mật độ tự hồi quy neuron</em> (neural auto-regressive density estimator - NADE) (Larochelle và Murray, 2011), được miêu tả ở phần 20.10.10, chúng ta có thể giới thiệu một dạng chia sẻ tham số mang lại cả lợi ích thống kê (ít tham số đơn nhất hơn) lẫn lợi ích tính toán. Đây là một dạng khởi tạo nữa thuộc mô típ học sâu tuần hoàn của việc <em>tái sử dụng đặc trưng</em>.</p><h2 id="20108-Các-mạng-tự-hồi-quy-tuyến-tính">20.10.8 Các mạng tự hồi quy tuyến tính</h2><p>Hình thức đơn giản nhất của mạng tự hồi quy tuyến tính không có các đơn vị ẩn và không chia sẻ các tham số hoặc các đặc trưng. Mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">P</span><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2620" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2621" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-2622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2624" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">i</span><span class="MJXp-mo" id="MJXp-Span-2626">−</span><span class="MJXp-mn" id="MJXp-Span-2627">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2628" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-2630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2632" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-281-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-281">P(x_i \mid x_{i-1},\dots x_1)</script></span> được tham số hoá thành một mô hình tuyến tính (hồi quy tuyến tính cho dữ liệu số thực, hồi quy logit cho dữ liệu nhị phân, hồi quy softmax cho dữ liệu rời rạc). Mô hình này được giới thiệu bởi Frey (1998) và có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635">O</span><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2639" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-282-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-282">O(d^2)</script></span> tham số khi có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642">d</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-283-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-283">d</script></span> biến của mô hình. Mô hình này được minh hoạ ở hình 20.8.</p><p>Nếu các biến là biến liên tục, mô hình tự hồi quy tuyến tính chỉ đơn thuần là một cách khác để công thức hoá phân phối Gauss đa biến, nắm bắt sự tác động qua lại theo cặp giữa các biến có thể quan sát được.</p><p>Các mạng tự hồi quy tuyến tính là cần thiết cho quá trình tổng quát hoá các phương pháp phân loại tuyến tính thành mô hình sinh mẫu. Do đó chúng có cùng ưu, khuyết điểm đối với các bộ phân loại tuyến tính. Và cũng như các bộ phân loại tuyến tính, chúng có thể được huấn luyện với các hàm mất mát lồi và đôi khi thừa nhận các phương pháp giải có nghiệm kín (Như trong trường hợp Gauss). Bản thân mô hình cũng không đưa ra được cách tăng năng suất, do đó năng suất phải được tăng bằng cách kỹ thuật như các triển khai cơ bản của đầu vào hoặc thủ thuật chọn hàm lõi.</p><p><img src="https://i.imgur.com/I1gS7wM.png" alt=""></p><blockquote>
<p>Hình 20.8: <em>Mạng phân phối khả kiến đầy đủ</em> (fully visible belief network) dự đoán biến thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-284-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-284">i</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">i</span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2648">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-285-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-285">i-1</script></span> biến trước. (Hình phía trên) Mô hình đồ thị có hướng cho mạng Bayes khả kiến đầy đủ. (Hình phía dưới) Đồ thị tính toán tương ứng cho mạng Bayes khả kiến đầy đủ logit, khi mỗi dự đoán được tạo ra bởi một máy dự đoán tuyến tính.</p>
</blockquote><h2 id="20109-Các-mạng-tự-hồi-quy-neuron">20.10.9 Các mạng tự hồi quy neuron</h2><p>Các mạng tự hồi quy neuron (Bengio và Bengio, 2000a,b) có cùng một mô hình đồ thị trái-qua-phải như các mạng tự hồi quy logit (hình 20.8) nhưng dùng một cách tham số hoá khác của các phân phối có điều kiện trong kiến trúc mô hình đồ thị đó. Cách tham số hoá mới mạnh mẽ hơn khi năng suất của nó có thể được gia tăng theo nhu cầu, cho phép việc xấp xỉ bất kì phân phối kết hợp nào. Cách tham số hoá mới này còn có thể cải thiện việc tổng quát hoá bằng cách giới thiệu nguyên lý chia sẻ tham số hoặc chia sẻ đặc trưng chung vào học sâu một cách tổng quát. Các mô hình được thúc đẩy bởi mục tiêu tránh thách thức gia tăng số chiều vượt ra khỏi các mô hình đồ thị dạng bảng truyền thống, có cùng một cấu trúc như hình 20.8 mô tả. Trong các mô hình xác suất rời rạc dạng bảng, mỗi phân phối có điều kiện được thể hiện bằng một bảng các xác suất, với một mục nhập và một tham số cho từng cấu hình khả thi của các biến liên quan. Bằng cách sử dụng mạng neuron, ta có được hai ưu điểm sau:</p><ol>
<li>Việc tham số hoá của từng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">P</span><span class="MJXp-mo" id="MJXp-Span-2651" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2654" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2655" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-2656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2658" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">i</span><span class="MJXp-mo" id="MJXp-Span-2660">−</span><span class="MJXp-mn" id="MJXp-Span-2661">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-2664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2666" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-286-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-286">P(x_i \mid x_{i-1},\dots x_1)</script></span> bằng mạng neuron với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-mo" id="MJXp-Span-2669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670">i</span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2672">1</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-287-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-287">(i-1) \times k</script></span> đầu vào và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-288-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-288">k</script></span> đầu ra (nếu các biến là rời rạc và có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2679">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-289-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-289">k</script></span> giá trị được mã hoá đơn trội) cho phép ước tính xác suất có điều kiện mà không yêu cầu một lượng tham số (và mẫu) cấp số mũ, nhưng vẫn có thể nắm bắt được các phụ thuộc bậc cao giữa các biến ngẫu nhiên.</li>
<li>Thay vì có một mạng neuron khác cho việc dự đoán từng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2680"><span class="MJXp-msubsup" id="MJXp-Span-2681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2682" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2683" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-290-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-290">x_i</script></span>, một liên kết trái-qua-phải, được minh hoạ trong hình 20.9, cho phép kết hợp tất cả các mạng neuron thành một. Tương tự, có nghĩa là các đặc trưng tầng ẩn được tính toán để dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2684"><span class="MJXp-msubsup" id="MJXp-Span-2685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2686" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2687" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-291-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-291">x_i</script></span> có thể được tái sử dụng cho việc dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2688"><span class="MJXp-msubsup" id="MJXp-Span-2689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2691" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692">i</span><span class="MJXp-mo" id="MJXp-Span-2693">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694">k</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-292-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-292">x_{i+k}</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2695"><span class="MJXp-mo" id="MJXp-Span-2696" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2697">k</span><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2699">0</span><span class="MJXp-mo" id="MJXp-Span-2700" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-293-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-293">(k > 0)</script></span>. Các đơn vị ẩn do đó được tổ chức thành các <em>nhóm</em> có đặc tính mà mọi đơn vị trong nhóm thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-294-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-294">i</script></span> chỉ lệ thuộc vào giá trị đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2703"><span class="MJXp-msubsup" id="MJXp-Span-2704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2706" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2709" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2712" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-295-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-295">x_1, \dots,x_i</script></span>. Các tham số được sử dụng để tính toán các đơn vị ẩn này được tối ưu kết hợp để cải thiện dự đoán của mọi biến trong chuỗi. Đây là trường hợp của <em>nguyên tắc tái sử dụng</em> diễn ra xuyên suốt việc học sâu trong phạm vi trải dài từ kiến trúc mạng hồi quy và mạng tích chập đến đa tác vụ và học chuyển tiếp.</li>
</ol><p>Mỗi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2714">P</span><span class="MJXp-mo" id="MJXp-Span-2715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2718" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2719" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-2720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2722" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2723">i</span><span class="MJXp-mo" id="MJXp-Span-2724">−</span><span class="MJXp-mn" id="MJXp-Span-2725">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2727" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2728" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2731" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-296-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-296">P(x_i \mid x_{i-1}, \dots ,x_1)</script></span> có thể biểu diễn một phân phối có điều kiện bằng cách cho những đầu ra của các mạng neuron dự đoán <em>các tham số</em> của phân phối có điều kiện của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2733"><span class="MJXp-msubsup" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2736" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-297-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-297">x_i</script></span> như đã được thảo luận ở phần 6.2.1.1. Mặc dù các mạng tự hồi quy nguyên mẫu ban đầu được ước lượng trong phạm vi dữ liệu đa biến rời rạc thuần tuý (với đầu ra hình chữ S cho biến Bernoulli hoặc đầu ra softmax cho biến multinoulli, hay còn gọi là biến phạm trù). Mở rộng những mô hình như vậy đối với các biến liên tục hay các phân phối kết hợp liên quan đến cả các biến liên tục và rời rạc là một điều bình thường.</p><p><img src="https://i.imgur.com/EDw2ArR.png" alt=""></p><blockquote>
<p>Hình 20.9: Mạng tự hồi quy neuron dự đoán biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2737"><span class="MJXp-msubsup" id="MJXp-Span-2738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2740" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-298-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-298">x_i</script></span> từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-299-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-299">i</script></span>-1 biến trước đó nhưng được tham số hoá để các đặc trưng (nhóm các đơn vị ẩn được biểu thị bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2743"><span class="MJXp-msubsup" id="MJXp-Span-2744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2746" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-300-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-300">h_i</script></span>) là các hàm số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2747"><span class="MJXp-msubsup" id="MJXp-Span-2748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2750" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2752" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2755" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2756" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-301-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-301">x_1 ,\dots, x_i</script></span> có thể được tái sử dụng trong việc dự đoán toàn bộ các biến phía sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2757"><span class="MJXp-msubsup" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2760" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761">i</span><span class="MJXp-mo" id="MJXp-Span-2762">+</span><span class="MJXp-mn" id="MJXp-Span-2763">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2764" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2766" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2767" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">i</span><span class="MJXp-mo" id="MJXp-Span-2769">+</span><span class="MJXp-mn" id="MJXp-Span-2770">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2771" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2773" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2776" style="vertical-align: -0.4em;">d</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-302-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-302">x_{i+1}, x_{i+2}, \dots, x_d</script></span>.</p>
</blockquote><h2 id="201010-Bộ-ước-lượng-mật-độ-tự-hồi-quy-neuron">20.10.10 Bộ ước lượng mật độ tự hồi quy neuron</h2><p><em>Bộ ước lượng mật độ tự hồi quy neuron</em> (neural auto-regressive density estimator - NADE) là một dạng rất thành công gần đây của mạng tự hồi quy neuron  (Larochelle và Murray, 2011). Các liên kết vẫn y như mạng tự hồi quy neuron nguyên mẫu của Bengio và Bengio (2000b) nhưng giới thiệu thêm sơ đồ chia sẻ tham số như được minh hoạ ở hình 20.10. Các tham số của các đơn vị ẩn thuộc các nhóm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2778">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-303-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-303">j</script></span> khác nhau sẽ được chia sẻ.</p><p><img src="https://i.imgur.com/ItffzB8.png" alt=""></p><blockquote>
<p>Hình 20.10: Minh hoạ của bộ ước lượng mật độ tự hồi quy neuron. Các đơn vị ẩn được tổ chức thành các nhóm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2779"><span class="MJXp-msubsup" id="MJXp-Span-2780"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2781" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2782" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2783">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2784">j</span><span class="MJXp-mo" id="MJXp-Span-2785">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-304-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-304">\boldsymbol h^{(j)}</script></span> để chỉ những đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2786"><span class="MJXp-msubsup" id="MJXp-Span-2787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2789" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2790" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">s</span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2798" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-305-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-305">x_1 ,dots, x_i</script></span> tham gia vào tính toán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2799"><span class="MJXp-msubsup" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2801" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2802" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2803">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804">i</span><span class="MJXp-mo" id="MJXp-Span-2805">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-306-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-306">\boldsymbol h^{(i)}</script></span> và dự đoán <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807">P</span><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2811" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-2813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2815" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2816">j</span><span class="MJXp-mo" id="MJXp-Span-2817">−</span><span class="MJXp-mn" id="MJXp-Span-2818">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2822">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2823">s</span><span class="MJXp-mo" id="MJXp-Span-2824" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2826" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2827" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2828" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-307-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-307">P(x_j \mid x_{j-1} ,dots, x_1)</script></span> với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2830">j</span><span class="MJXp-mspace" id="MJXp-Span-2831" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2832" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mspace" id="MJXp-Span-2833" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-308-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-308">j\,\ge\,i</script></span>. Bộ ước lượng mật độ tự hồi quy neuron được phân biệt với các mạng tự hồi quy neuron trước đó bằng cách sử dụng mô thức chia sẻ trọng số cụ thể: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2835"><span class="MJXp-msubsup" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 2.036em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-2844"><span class="MJXp-msup" id="MJXp-Span-2845"><span class="MJXp-mi" id="MJXp-Span-2846" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2847" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -1.07em;"><span class="MJXp-mrow" id="MJXp-Span-2838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2839">j</span><span class="MJXp-mo" id="MJXp-Span-2840">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841">k</span><span class="MJXp-mo" id="MJXp-Span-2842">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2848" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2851" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852">k</span><span class="MJXp-mo" id="MJXp-Span-2853">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-309-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-309">W_{j,k,i}^{'} = W_{k,i}</script></span> được chia sẻ (được biểu thị trong hình bằng cách sử dụng cùng một dạng mũi tên cho mọi trường hợp của trọng số được sao chép) với mọi trọng số đi ra từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2855"><span class="MJXp-msubsup" id="MJXp-Span-2856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2858" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-310-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-310">x_i</script></span>, đến đơn vị thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-311-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-311">k</script></span> của bất kì nhóm nào mà <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">j</span><span class="MJXp-mspace" id="MJXp-Span-2863" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mspace" id="MJXp-Span-2865" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-312-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-312">j\,\ge\,i</script></span>. Nhớ rằng vector <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2867"><span class="MJXp-msubsup" id="MJXp-Span-2868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2870" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2871">1</span><span class="MJXp-mo" id="MJXp-Span-2872">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2874" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2877" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2878">2</span><span class="MJXp-mo" id="MJXp-Span-2879">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2881" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885">s</span><span class="MJXp-mo" id="MJXp-Span-2886" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2889" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890">n</span><span class="MJXp-mo" id="MJXp-Span-2891">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-313-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-313">W_{1,i}, W_{2,i} ,dots, W_{n,i}</script></span> được biểu thị là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2893"><span class="MJXp-msubsup" id="MJXp-Span-2894"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2895" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2896" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2897">:</span><span class="MJXp-mo" id="MJXp-Span-2898">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2899">i</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-314-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-314">\boldsymbol W_{:,i}</script></span></p>
</blockquote><p>Các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-msubsup" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 2.036em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-2909"><span class="MJXp-msup" id="MJXp-Span-2910"><span class="MJXp-mi" id="MJXp-Span-2911" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2912" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -1.07em;"><span class="MJXp-mrow" id="MJXp-Span-2903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904">j</span><span class="MJXp-mo" id="MJXp-Span-2905">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906">k</span><span class="MJXp-mo" id="MJXp-Span-2907">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908">i</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-315-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-315">W_{j,k,i}^{'}</script></span> từ đầu vào <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2913"><span class="MJXp-msubsup" id="MJXp-Span-2914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2916" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-316-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-316">x_i</script></span> đến phần tử thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-317-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-317">k</script></span> của nhóm thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920">j</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-318-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-318">j</script></span> thuộc đơn vị ẩn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2921"><span class="MJXp-msubsup" id="MJXp-Span-2922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2925"><span class="MJXp-mo" id="MJXp-Span-2926">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">j</span><span class="MJXp-mo" id="MJXp-Span-2928">)</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">k</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-319-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-319">h_k^{(j)}</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2929"><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">j</span><span class="MJXp-mspace" id="MJXp-Span-2932" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-2933" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mspace" id="MJXp-Span-2934" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935">i</span><span class="MJXp-mo" id="MJXp-Span-2936" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-320-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-320">(j\,\ge\,i)</script></span> được chia sẻ giữa các nhóm:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2937"><span class="MJXp-mtable" id="MJXp-Span-2938"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-2939" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2940" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942" style="margin-right: 0.05em;">W</span><span class="MJXp-script-box" style="height: 2.036em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: 0.05em;"><span class="MJXp-mrow" id="MJXp-Span-2949"><span class="MJXp-msup" id="MJXp-Span-2950"><span class="MJXp-mi" id="MJXp-Span-2951" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2952" style="vertical-align: 0.4em;">′</span></span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -1.07em;"><span class="MJXp-mrow" id="MJXp-Span-2943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">j</span><span class="MJXp-mo" id="MJXp-Span-2945">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946">k</span><span class="MJXp-mo" id="MJXp-Span-2947">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">i</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2953" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2956" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957">k</span><span class="MJXp-mo" id="MJXp-Span-2958">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959">i</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-321-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-321"> W_{j,k,i}^{'} = W_{k,i} \tag{20.83}</script></span></p><p>Các trọng số còn lại, khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961">j</span><span class="MJXp-mo" id="MJXp-Span-2962" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-322-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-322">j < i</script></span>, bằng không.</p><p>Larochelle và Murray (2011) chọn sơ đồ chia sẻ này để sự lan truyền thuận trong mô hình bộ ước lượng mật độ tự hồi quy neuron có thể bắt chước một cách khái quát việc tính toán được thể hiện trong suy luận trường trung bình để lấp đầy những đầu vào bị khiếm khuyết trong máy Boltzmann hạn chế. Suy luận trường trung bình này tương ứng với chạy một mạng truy hồi với các trọng số được chia sẻ, và bước đầu tiên của suy luận này giống với trong bộ ước lượng mật độ tự hồi quy neuron. Khác biệt duy nhất là trong bộ ước lượng mật độ tự hồi quy neuron, trọng số đầu ra kết nối các đơn vị ẩn với đầu ra được tham số hoá một cách độc lập khỏi các trọng số kết nối đơn vị đầu vào với các đơn vị ẩn. Trong máy Boltzmann hạn chế, các trọng số từ-ẩn-đến-đầu-ra là chuyển vị của các trọng số từ-đầu-vào-đến-ẩn. Kiến trúc của bộ ước lượng mật độ tự hồi quy neuron có thể được mở rộng để bắt chước không chỉ 1 bước của suy luận truy hồi trường trung bình mà tới tận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-323-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-323">k</script></span> bước. Hướng tiếp cận này được gọi là <em>bộ ước lượng mật độ tự hồi quy neuron <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-324-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-324">k</script></span></em> (neural auto-regressive density estimator-<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-325-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-325">k</script></span> - NADE-<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2971">k</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-326-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-326">k</script></span>) (Raiko <em>et al</em>., 2014).</p><p>Như đã đề cập trước đó, các mạng tự hồi quy có thể được mở rộng để xử lý dữ liệu có giá trị liên tục. Một cách tham số hoá mật độ liên tục đặc biệt mạnh mẽ và tổng quát là dưới dạng hỗn hợp Gauss (đã giới thiệu ở phần  3.9.6) với hỗn hợp các trọng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2972"><span class="MJXp-msubsup" id="MJXp-Span-2973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2975" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-327-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-327">\alpha_i</script></span> (hệ số hoặc xác xuất tiên nghiệm cho thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-328-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-328">i</script></span>), trung bình có điều kiện của từng thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2978"><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2981" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-329-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-329">\mu_i</script></span> và phương sai có điều kiện của từng thành phần <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984" style="margin-right: 0.05em;">σ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2986">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985">i</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-330-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-330">\sigma_i^2</script></span>. Một mô hình được gọi là <em>bộ ước lượng mật độ tự hồi quy neuron giá trị thực</em> (Real-valued neural autoregressive density-estimator - RNADE) (Uria <em>et al.</em>, 2013) đã dùng cách này để mở rộng bộ ước lượng mật độ tự hồi quy neuron cho các giá trị thực. Như với các mạng mật độ hỗn hợp khác, các tham số của phân phối này là các đầu ra của mạng, với xác suất trọng số hỗn hợp được tạo ra bởi đơn vị softmax và các phương sai được tham số hoá để chúng dương. Trượt gradient ngẫu nhiên có thể tệ đi (numerically ill-behaved) vì sự tương tác giữa các trung bình có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2987"><span class="MJXp-msubsup" id="MJXp-Span-2988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2989" style="margin-right: 0.05em;">μ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2990" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-331-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-331">\mu_i</script></span> và các phương sai có điều kiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2991"><span class="MJXp-msubsup" id="MJXp-Span-2992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993" style="margin-right: 0.05em;">σ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2995">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">i</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-332-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-332">\sigma_i^2</script></span>.<br>
Để giảm thiểu sự khó khăn này, Uria <em>et al</em>. (2013) đã sử dụng <em>gradient-giả</em> (pseudo-gradient) thay thế gradient trong trung bình ở giai đoạn lan truyền ngược.</p><p>Một mở rộng rất thú vị khác của các kiến trúc neuron tự hồi quy loại bỏ sự chọn thứ tự tuỳ ý cho các biến đã quan sát được (Uriaet <em>et al</em>., 2014). Trong các mạng tự hồi quy, ý tưởng huấn luyện mạng để có thể đối phó với bất kỳ thứ tự nào bằng cách lấy mẫu ngẫu nhiên các thứ tự và cung cấp thông tin cho các đơn vị ẩn, chỉ ra đâu là đầu vào đã quan sát được (phía bên phải của thanh điều kiện), đâu là đầu vào đã được dự đoán và do đó đã bị coi là khiếm khuyết (phía bên trái của thanh điều kiện). Điều này tốt bởi vì nó cho phép sử dụng mạng tự hồi quy đã được huấn luyện để <em>thực hiện bất kỳ vấn đề suy luận nào</em> (Ví dụ như dự đoán hay lấy mẫu từ phân phối xác suất trên bất kỳ tập con nào các biến nào) cực kỳ hiệu quả. Cuối cùng, vì nhiều thứ tự của các biến khả thi (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2997">n</span><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-333-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-333">n!</script></span> cho <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3000">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-334-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-334">n</script></span> biến) và từng thứ tự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002">o</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-335-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-335">o</script></span> của các biến tạo ra một <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004">p</span><span class="MJXp-mo" id="MJXp-Span-3005" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3006"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3007">x</span></span><span class="MJXp-mrow" id="MJXp-Span-3008"><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010">o</span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-336-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-336">p(\mathbf{x}|o)</script></span>, chúng ta có thể lập ra một tập hợp các mô hình cho nhiều giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013">o</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-337-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-337">o</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3014"><span class="MJXp-mtable" id="MJXp-Span-3015"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3016" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3017" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019" style="margin-right: 0.05em;">p</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3020" style="vertical-align: -0.4em;">ensemble</span></span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3022"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3023">x</span></span><span class="MJXp-mo" id="MJXp-Span-3024" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3025" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3026" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3027">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028">k</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-3029"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3035" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3036">k</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-3030" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3031" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">i</span><span class="MJXp-mo" id="MJXp-Span-3033">=</span><span class="MJXp-mn" id="MJXp-Span-3034">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3037"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3038">p</span></span><span class="MJXp-mo" id="MJXp-Span-3039" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3040"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-3041">x</span></span><span class="MJXp-mo" id="MJXp-Span-3042" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-3043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3044" style="margin-right: 0.05em;">o</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3045" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3046">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3047">i</span><span class="MJXp-mo" id="MJXp-Span-3048">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3049" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3050" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-338-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-338"> p_\text{ensemble}(\mathbf{x}) = \frac{1}{k} \sum_{i=1}^{k} \mathcal{p}(\mathbf{x} \mid o^{(i)}). \tag{20.84}</script></span><br>
Mô hình tập hợp này thường tổng quát hóa tốt hơn và gán xác suất cao hơn cho tập kiểm tra hơn các mô hình riêng lẻ được định nghĩa bởi một trật tự riêng lẻ.</p><p>Cũng trong bài báo này, các tác giả đã đề xuất các phiên bản “sâu” cho kiến trúc, nhưng không may thay chúng đã ngay lập tức khiến chi phí tính toán cao như mạng neuron tự hồi quy nguyên mẫu (Bengio và Bengio, 2000b). Tầng thứ nhất và tầng đầu ra vẫn có thể được tính toán với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3052">O</span><span class="MJXp-mo" id="MJXp-Span-3053" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3054">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3055">h</span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-339-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-339">O(nh)</script></span> toán tử nhân-cộng như trong bộ ước lượng mật độ tự hồi quy neuron thông thường, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-340-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-340">h</script></span> là số đơn vị ẩn (kích thước của các nhóm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3059"><span class="MJXp-msubsup" id="MJXp-Span-3060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3062" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-341-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-341">h_i</script></span> trong các hình 20.9 và 20.10), trong khi đó lại là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">O</span><span class="MJXp-mo" id="MJXp-Span-3065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3068" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">h</span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-342-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-342">O(n^2h)</script></span> trong bài của Bengio và Bengio (2000b). Với những tầng ẩn khác, chi phí tính toán là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072">O</span><span class="MJXp-mo" id="MJXp-Span-3073" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3075" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3076" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3078" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3079" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3080" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-343-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-343">O(n^2h^2)</script></span> nếu mọi nhóm “trước đó” tại tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-344-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-344">l</script></span> tham gia vào việc dự đoán nhóm “tiếp theo” tại tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084">l</span><span class="MJXp-mo" id="MJXp-Span-3085" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3086">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-345-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-345">l+1</script></span>, giả định có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3088">n</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-346-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-346">n</script></span> nhóm có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-347-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-347">h</script></span> đơn vị ẩn tại mỗi tầng. Việc khiến nhóm thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3092">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-348-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-348">i</script></span> tại tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094">l</span><span class="MJXp-mo" id="MJXp-Span-3095" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3096">1</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-349-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-349">l+1</script></span> chỉ phụ thuộc vào nhóm thứ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3098">i</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-350-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-350">i</script></span> như trong bài của Uria <em>et al.</em> (2014), tại tầng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3100">l</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-351-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-351">l</script></span> giảm nó xuống còn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102">O</span><span class="MJXp-mo" id="MJXp-Span-3103" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">n</span><span class="MJXp-msubsup" id="MJXp-Span-3105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3107" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3108" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-352-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-352">O(nh^2)</script></span>, vốn vẫn thua <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3110">h</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-353-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-353">h</script></span> lần so với bộ ước lượng mật độ tự hồi quy neuron thông thường.</p><h1 id="2011">20.11</h1><p><a href="https://hackmd.io/NJAqVxs_QNun7qgO6P7Weg" target="_blank" rel="noopener">https://hackmd.io/NJAqVxs_QNun7qgO6P7Weg</a></p></div>