<div id="doc" class="markdown-body container-fluid comment-enabled"><h1 id="Chương-8-Tối-ưu-trong-huấn-luyện-các-mô-hình-đa-tầng">Chương 8: Tối ưu trong huấn luyện các mô hình đa tầng</h1><p><strong>Tiệp đang edit</strong><br>
<a href="https://www.deeplearningbook.org/contents/optimization.html" target="_blank" rel="noopener">https://www.deeplearningbook.org/contents/optimization.html</a><br>
(bản trước edit: <a href="https://hackmd.io/Mv0AqM4jTMiflsf60vgPnw" target="_blank" rel="noopener">https://hackmd.io/Mv0AqM4jTMiflsf60vgPnw</a>)</p><p>--------------- duynht bắt đầu dịch từ đây ----------------------</p><p>Các thuật toán học sâu bao gồm việc tối ưu trong nhiều trường hợp. Ví dụ, quá trình suy luận trong các mô hình như phân tích thành phần chính (PCA) đòi hỏi giải quyết một bài toán tối ưu. Ta thường dùng tối ưu dạng giải tích để chứng minh hoặc thiết kế các thuật toán. Trong tất cả các bài toán tối ưu liên quan đến học sâu, vấn đề khó khăn nhất là huấn luyện mạng neuron. Chúng ta thường phải chạy các thuật toán huấn luyện mạng neuron trên nhiều máy tính trong một vài ngày, thậm chí đến cả tháng chỉ để huấn luyện một mạng neuron đơn. Do bài toán tối ưu trong học sâu quá quan trọng và phức tạp, một tập các kĩ thuật tối ưu đặc biệt đã được phát triển riêng để giải quyết bài toán này. Chương này sẽ trình bày những kỹ thuật tối ưu trong huấn luyện mạng neuron.</p><p>Nếu chưa quen thuộc với những nguyên tắc cơ bản của tối ưu dựa trên gradient, bạn đọc có thể xem lại chương 4 để có cái nhìn ngắn gọn về các phương pháp tối ưu nói chung.</p><p>Chương này sẽ tập trung vào một trường hợp cụ thể của tối ưu: tìm các tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\boldsymbol{\theta}</script></span> của một mạng neuron có khả năng làm giảm rõ rệt giá trị của hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">J</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-6">θ</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">J(\boldsymbol{\theta})</script></span>. Quá trình này thường bao gồm một phép đo được đánh giá trên toàn bộ tập huấn luyện cũng như các số hạng kiểm soát bổ sung.</p><p>Chúng tôi sẽ bắt đầu với một mô tả về sự khác biệt giữa tối ưu hoá khi được sử dụng như một thuật toán huấn luyện cho một tác vụ học máy với tối ưu hoá thuần túy. Tiếp theo, chúng tôi trình bày cụ thể những thách thức khiến huấn luyện mạng neuron trở nên khó hơn. Sau đó, chúng tôi giới thiệu vài thuật toán dùng trong thực tế, bao gồm chính các thuật toán tối ưu và một vài chiến lược khởi tạo bộ tham số. Nhiều thuật toán cao cấp hơn có khả năng tự điều chỉnh tốc độ học trong quá trình huấn luyện hoặc khai thác thông tin chứa trong đạo hàm bậc hai của hàm mất mát. Cuối cùng, chúng tôi kết thúc chương bằng cách lượt lại vài chiến thuật tối ưu được hình thành bằng cách kết hợp các thuật toán tối ưu đơn giản thành các thủ tục mức cao hơn.</p><h1 id="81-Tối-ưu-trong-học-máy-khác-tối-ưu-thuần-tuý-như-thế-nào">8.1 Tối ưu trong học máy khác tối ưu thuần tuý như thế nào?</h1><p>Các thuật toán tối ưu trong huấn luyện các mô hình đa tầng khác các thuật toán tối ưu thuần túy trên nhiều phương diện. Tối ưu trong học máy thường là gián tiếp. Trong hầu hết các trường hợp của học máy, ta quan tâm đến một vài thang đo hiệu năng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">P</script></span>, được xác định trên tập kiểm tra và có thể có chi phí tính toán lớn. Do đó, ta chỉ tối ưu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">P</script></span> một cách gián tiếp. Ta cố gắng giảm một hàm mất mát khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">J</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-15">θ</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">J(\boldsymbol{\theta})</script></span> với hi vọng việc đó sẽ cải thiện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">P</script></span>. Điều này trái ngược với bài toán tối ưu thuần tuý, ở đó cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">J</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">J</script></span>  là mục tiêu duy nhất. Các thuật toán tối ưu trong huấn luyện các mô hình đa tầng thường bao gồm một số đặc điểm ứng với những cấu trúc cụ thể của các hàm mục tiêu trong học máy.</p><p>Thông thường, hàm mất mát có thể được viết dưới dạng trung bình trên toàn tập huấn luyện, ví dụ<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-21"><span class="MJXp-mtable" id="MJXp-Span-22"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-23" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-24" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">J</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-27">θ</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mrow" id="MJXp-Span-31" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-32">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-34">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-35">x</span><span class="MJXp-mo" id="MJXp-Span-36">,</span><span class="MJXp-mrow" id="MJXp-Span-37"><span class="MJXp-mi" id="MJXp-Span-38">y</span></span><span class="MJXp-mo" id="MJXp-Span-39">)</span><span class="MJXp-mo" id="MJXp-Span-40">∼</span><span class="MJXp-msubsup" id="MJXp-Span-41"><span class="MJXp-mrow" id="MJXp-Span-42" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-43"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-45" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-46" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-47">data</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">L</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">f</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-52">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-54">θ</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">y</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-29"><span class="mtable" id="MathJax-Span-30" style="min-width: 19.076em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.076em;"><span style="display: inline-block; position: absolute; width: 13.365em; height: 0px; clip: rect(-1.021em, 1013.26em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -6.678em;"><span style="position: absolute; clip: rect(3.02em, 1013.26em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.365em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1013.26em, 4.529em, -999.997em); top: -4.038em; left: 50%; margin-left: -6.678em;"><span class="mtd" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-41" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.367em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.649em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mo" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">y</span></span></span><span class="mo" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.289em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-56"><span class="mrow" id="MathJax-Span-57"><span class="munderover" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.27em, 3.774em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mtext" id="MathJax-Span-63" style="font-size: 50%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main-bold;">;</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.38em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.1"><span class="mrow" id="MathJax-Span-32"><span class="mtext" id="MathJax-Span-33" style="font-family: MathJax_Main;">(8.1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8"> J(\boldsymbol{\theta}) = \mathbb{E}_{(\boldsymbol{x},\mathrm{y}) \sim \hat{p}_{\text{data}}}L(f(\boldsymbol{x; \theta}), y), \tag{8.1}</script></span><br>
với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">L</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">L</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">L</script></span> là hàm mất mát ứng với mỗi mẫu, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">f</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-65">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-67">θ</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main-bold;">;</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">f(\boldsymbol{x; \theta})</script></span> là kết quả đầu ra dự đoán khi đầu vào là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-69"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-70">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\boldsymbol{x}</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-msubsup" id="MJXp-Span-72"><span class="MJXp-mrow" id="MJXp-Span-73" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-74"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-77" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-78">data</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-93"><span class="msubsup" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="munderover" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.595em;"><span class="texatom" id="MathJax-Span-100"><span class="mrow" id="MathJax-Span-101"><span class="mtext" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\hat{p}_{\text{data}}</script></span> là phân phối thực nghiệm. Đối với học có giám sát, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">y</script></span> là đầu ra mục tiêu. Xuyên suốt chương này, chúng tôi sẽ phát triển trường hợp học có giám sát không kiểm soát, ở đó các đối số của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">L</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">L</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">L</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">f</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-86">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-88">θ</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main-bold;">;</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">f(\boldsymbol{x; \theta})</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">y</script></span>. Ta có thể dễ dàng mở rộng trường hợp này, chẳng hạn, đưa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-93">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\boldsymbol{x}</script></span> hoặc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-95">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\boldsymbol{\theta}</script></span> vào làm đối số, hoặc loại bỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">y</script></span>, để phát triển các dạng cơ chế kiểm soát hoặc học không giám sát khác nhau.</p><p>Phương trình (8.1) định nghĩa một hàm mục tiêu đối với tập huấn luyện. Chúng ta sẽ thường ưa chọn việc cực tiểu hóa hàm mục tiêu mà ở đó kỳ vọng được lấy trên toàn bộ <em>phân phối sinh dữ liệu</em> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-102">data</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-131"><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-134"><span class="mrow" id="MathJax-Span-135"><span class="mtext" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">p_{\text{data}}</script></span> thay vì chỉ trên tập huấn luyện hữu hạn:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-103"><span class="MJXp-mtable" id="MJXp-Span-104"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-105" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-106" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">J</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-109" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-111">θ</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mrow" id="MJXp-Span-115" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-116">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-117" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-118">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-119">x</span><span class="MJXp-mo" id="MJXp-Span-120">,</span><span class="MJXp-mrow" id="MJXp-Span-121"><span class="MJXp-mi" id="MJXp-Span-122">y</span></span><span class="MJXp-mo" id="MJXp-Span-123">)</span><span class="MJXp-mo" id="MJXp-Span-124">∼</span><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-127" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-128">data</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">L</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">f</span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-133">x</span><span class="MJXp-mo MJXp-bold" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-135">θ</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">y</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-138"><span class="mtable" id="MathJax-Span-139" style="min-width: 19.453em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.453em;"><span style="display: inline-block; position: absolute; width: 13.742em; height: 0px; clip: rect(-0.967em, 1013.69em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -6.894em;"><span style="position: absolute; clip: rect(3.02em, 1013.69em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.742em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1013.69em, 4.529em, -999.997em); top: -4.038em; left: 50%; margin-left: -6.894em;"><span class="mtd" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-152" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.259em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-156"><span class="mrow" id="MathJax-Span-157"><span class="mo" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">y</span></span></span><span class="mo" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-166"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.38em;"><span class="texatom" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mtext" id="MathJax-Span-170" style="font-size: 50%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">(</span><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main-bold;">;</span><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.38em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.2"><span class="mrow" id="MathJax-Span-141"><span class="mtext" id="MathJax-Span-142" style="font-family: MathJax_Main;">(8.2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-21"> J^*(\boldsymbol{\theta}) = \mathbb{E}_{(\boldsymbol{x},\mathrm{y})\sim p_{\text{data}}}L(f(\boldsymbol{x; \theta}), y). \tag{8.2}</script></span></p><h2 id="811-Cực-tiểu-hóa-rủi-ro-thực-nghiệm">8.1.1 Cực tiểu hóa rủi ro thực nghiệm</h2><p>Mục tiêu của một thuật toán học máy là giảm thiểu sai số tổng quát hoá kỳ vọng cho bởi phương trình (8.2). Đại lượng này được gọi là mức độ <strong>rủi ro</strong> (risk). Ở đây, chúng tôi nhấn mạnh việc kỳ vọng được lấy trên toàn phân phối thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-145">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-147">x</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">y</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-184"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-185"><span class="msubsup" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mtext" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">p_{\text{data}}(\boldsymbol{x}, y)</script></span>. Nếu ta biết phân phối thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-154" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-155">data</span><span class="MJXp-mo" id="MJXp-Span-156">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-157">x</span><span class="MJXp-mo" id="MJXp-Span-158">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-196"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mtext" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">data</span><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">p_{\text{data}(\boldsymbol{x},y})</script></span>, cực tiểu hóa rủi ro sẽ là một bài toán tối ưu có thể giải quyết bằng một thuật toán tối ưu. Ngược lại, khi ta không biết <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-msubsup" id="MJXp-Span-162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-164" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-165">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-167">x</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">y</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-209"><span class="msubsup" id="MathJax-Span-210"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-212"><span class="mrow" id="MathJax-Span-213"><span class="mtext" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">p_{\text{data}}(\boldsymbol{x},y)</script></span> mà chỉ có tập huấn luyện các mẫu từ phân phối này, ta có một bài toán học máy.</p><p>Cách đơn giản nhất để chuyển một bài toán học máy thành một bài toán tối ưu là cực tiểu hóa mất mát kì vọng trên tập huấn luyện. Điều này đồng nghĩa với việc thay thế phân phối thực sự <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-171"><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-175">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-177">x</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">y</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-221"><span class="msubsup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mtext" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">p_{\text{data}}(\boldsymbol{x},y)</script></span> bởi phân phối thực nghiệm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-msubsup" id="MJXp-Span-182"><span class="MJXp-mrow" id="MJXp-Span-183" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-184"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-188">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-190">x</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">y</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-233"><span class="msubsup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="munderover" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.595em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mtext" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\hat{p}_{\text{data}}(\boldsymbol{x},y)</script></span> được xác định thông qua tập huấn luyện. Bây giờ, ta cần cực tiểu hóa <strong>rủi ro thực nghiệm</strong> (empirical risk)<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-194"><span class="MJXp-mtable" id="MJXp-Span-195"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-196" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-197" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mrow" id="MJXp-Span-199" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-200">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-201" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-202">x</span><span class="MJXp-mo" id="MJXp-Span-203">,</span><span class="MJXp-mrow" id="MJXp-Span-204"><span class="MJXp-mi" id="MJXp-Span-205">y</span></span><span class="MJXp-mo" id="MJXp-Span-206">∼</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mrow" id="MJXp-Span-208" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-209"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-211" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-212" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-213">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-214">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-215">x</span><span class="MJXp-mo" id="MJXp-Span-216">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">y</span><span class="MJXp-mo" id="MJXp-Span-218">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">L</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">f</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-224">x</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-226">θ</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">y</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-233" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-234">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-236"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-242" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-238" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">i</span><span class="MJXp-mo" id="MJXp-Span-240">=</span><span class="MJXp-mn" id="MJXp-Span-241">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">L</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">f</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-248"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-249" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-250" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-251">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">i</span><span class="MJXp-mo" id="MJXp-Span-253">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-255">θ</span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-260" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-261">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">i</span><span class="MJXp-mo" id="MJXp-Span-263">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-249"><span class="mtable" id="MathJax-Span-250" style="min-width: 28.828em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.828em;"><span style="display: inline-block; position: absolute; width: 23.063em; height: 0px; clip: rect(-1.775em, 1023.01em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -11.527em;"><span style="position: absolute; clip: rect(2.212em, 1023.01em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 23.063em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1023.01em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -11.527em;"><span class="mtd" id="MathJax-Span-254"><span class="mrow" id="MathJax-Span-255"><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 5.337em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.649em;"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Main;">y</span></span></span><span class="mo" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-268"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.289em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="munderover" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.27em, 3.774em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mtext" id="MathJax-Span-276" style="font-size: 50%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-279" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-296" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-297" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.87em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.428em;"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.03em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.026em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-299" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="texatom" id="MathJax-Span-306"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">L</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="mo" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-324" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-326"><span class="mrow" id="MathJax-Span-327"><span class="mo" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.3"><span class="mrow" id="MathJax-Span-252"><span class="mtext" id="MathJax-Span-253" style="font-family: MathJax_Main;">(8.3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\mathbb{E}_{\boldsymbol{x},\mathrm{y}\sim\hat{p}_{\text{data}}(\boldsymbol{x},y)}[L(f(\boldsymbol{x};\boldsymbol{\theta}), y)] = \frac{1}{m} \sum^{m}_{i=1}L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}), y^{(i)}), \tag{8.3}</script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">m</script></span> là số lượng mẫu huấn luyện.</p><p>Quá trình huấn luyện dựa trên việc cực tiểu hóa sai số huấn luyện trung bình được gọi là <strong>cực tiểu hóa rủi ro thực nghiệm</strong> (empirical risk minimization). Trong trường hợp này, học máy vẫn rất giống với tối ưu hóa thuần tuý. Thay vì tối ưu rủi ro một cách trực tiếp, ta tối ưu rủi ro thực nghiệm và hi vọng rủi ro thực tế cũng sẽ giảm đi đáng kể. Nhiều kết quả lý thuyết xác lập các điều kiện mà ở đó ta có thể kì vọng rủi ro thực sự giảm nhiều.</p><p>Tuy nhiên, cực tiểu hóa rủi ro thực nghiệm dễ gây ra hiện tượng quá khớp. Những mô hình với dung lượng lớn có thể chỉ đơn giản là ghi nhớ tập huấn luyện. Trong nhiều trường hợp, việc cực tiểu hóa rủi ro thực nghiệm là không thực sự khả thi. Những thuật toán tối ưu hiện đại hiệu quả nhất đều dựa trên trượt dốc gradient, nhưng nhiều hàm mất mát hữu dụng, chẳng hạn như mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mn" id="MJXp-Span-269">0</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-271">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-337"><span class="mn" id="MathJax-Span-338" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">0-1</script></span> lại không có đạo hàm mà ta có thể sử dụng (đạo hàm hoặc bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mn" id="MJXp-Span-273">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-342"><span class="mn" id="MathJax-Span-343" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">0</script></span> hoặc không xác định tại mọi điểm). Hai vấn đề trên có nghĩa là, trong ngữ cảnh học sâu, ta hiếm khi sử dụng cực tiểu hóa rủi ro thực nghiệm. Thay vào đó, ta phải dùng một cách tiếp cận hơi khác, mà ở đó đại lượng thực tế ta tối ưu thậm chí khác xa đại lượng mà ta thực sự muốn tối ưu.</p><h2 id="812-Các-hàm-mất-mát-thay-thế-và-kết-thúc-sớm">8.1.2 Các hàm mất mát thay thế và kết thúc sớm</h2><p>Đôi khi, hàm mất mát mà ta thực sự quan tâm (ví dụ, sai số phân loại) không thể được tối ưu hiệu quả. Chẳng hạn, cực tiểu hóa một cách chính xác mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mn" id="MJXp-Span-275">0</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-277">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-345"><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">0-1</script></span> thường là một bài toán khó về mặt tính toán (chi phí là hàm mũ theo số chiều của đầu vào), thậm chí đối với một bộ phân lớp tuyến tính [Marcotte and Savard, 1992]. Trong những tình huống đó, người ta thường xấp xỉ hàm mất mát bởi một <em>hàm mất mát thay thế</em> (surrogate loss function) với những ưu điểm nhất định. Ví dụ, hàm đối của logarit hợp lý (negative log-likelihood) của lớp thực sự thường được dùng thay thế cho mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mn" id="MJXp-Span-279">0</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-281">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-350"><span class="mn" id="MathJax-Span-351" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">0-1</script></span>. Hàm đối của logarit hợp lý cho phép mô hình ước lượng xác suất có điều kiện của các lớp với đầu vào cho trước, và nếu mô hình có thể làm tốt việc đó, nó có thể chọn những lớp có sai số phân loại kì vọng nhỏ nhất.</p><p>Trong một số trường hợp, một hàm mất mát thay thế có khả năng học tốt hơn. Ví dụ, mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mn" id="MJXp-Span-283">0</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-285">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-355"><span class="mn" id="MathJax-Span-356" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">0-1</script></span> của tập kiểm tra thường tiếp tục giảm trong một thời gian dài sau khi mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mn" id="MJXp-Span-287">0</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-289">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-360"><span class="mn" id="MathJax-Span-361" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">0-1</script></span> của tập huấn luyện đã bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mn" id="MJXp-Span-291">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-365"><span class="mn" id="MathJax-Span-366" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">0</script></span>, khi quá trình huấn luyện sử dụng hàm thay thế logarit hợp lý. Nguyên nhân là do khi kỳ vọng mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-292"><span class="MJXp-mn" id="MJXp-Span-293">0</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-295">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-368"><span class="mn" id="MathJax-Span-369" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">0-1</script></span> bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mn" id="MJXp-Span-297">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-372"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-373"><span class="mn" id="MathJax-Span-374" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">0</script></span>, ta có thể cải thiện khả năng kháng nhiễu của bộ phân loại bằng việc đẩy các lớp ra xa nhau hơn, thu được một bộ phân lớp đáng tin cậy và chắn chắn hơn, do đó trích xuất được nhiều thông tin hơn từ dữ liệu huấn luyện hơn so với việc chỉ đơn giản cực tiểu hóa mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mn" id="MJXp-Span-299">0</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-301">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-376"><span class="mn" id="MathJax-Span-377" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-379" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">0-1</script></span> trung bình trên tập huấn luyện.</p><p>Một khác biệt rất quan trọng giữa bài toán tối ưu nói chung và bài toán tối ưu ta dùng trong thuật toán huấn luyện đó là các thuật toán huấn luyện thường không dừng ở một điểm cực tiểu cục bộ. Thay vào đó, một thuật toán học máy thường cực tiểu hóa một hàm mất mát thay thế và dừng lại khi một tiêu chuẩn hội tụ dựa trên kết thúc sớm (xem phần 7.8) được thỏa mãn. Thông thường, tiêu chuẩn kết thúc sớm được thiết lập dựa trên hàm mất mát thực tế, chẳng hạn như mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mn" id="MJXp-Span-303">0</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-305">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-381"><span class="mn" id="MathJax-Span-382" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mn" id="MathJax-Span-384" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">0-1</script></span> được đo trên một tập xác thực, và được thiết kế để khiến thuật toán dừng khi hiện tượng quá khớp bắt đầu xuất hiện. Quá trình huấn luyện thường dừng lại khi hàm mất mát thay thế vẫn có đạo hàm lớn, một điều rất khác so với tối ưu thuần túy, khi một thuật toán tối ưu được xem là hội tụ khi gradient đạt giá trị rất nhỏ.</p><h2 id="813-Các-thuật-toán-theo-lô-và-lô-nhỏ">8.1.3 Các thuật toán theo lô và lô nhỏ</h2><p>Một đặc điểm của các thuật toán học máy tách biệt chúng khỏi các thuật toán tối ưu thông thường là hàm mục tiêu thường phân tích được thành một tổng trên các mẫu huấn luyện. Các thuật toán tối ưu cho học máy thường tính toán mỗi cập nhật cho các tham số dựa trên một giá trị kỳ vọng của hàm chi phí được ước lượng bởi chỉ một tập con của các số hạng trong một hàm chi phí đầy đủ.</p><p>Ví dụ, những bài toán ước lượng hợp lý cực đại, trong không gian logarit, phân tích được thành một tổng đối với mỗi mẫu:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-320"><span class="MJXp-mtable" id="MJXp-Span-321"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-322" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-323" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-324"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-325" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-326" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">L</span></span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munder" id="MJXp-Span-330"><span><span class="MJXp-mi" id="MJXp-Span-331">arg</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-334" style="margin-left: 0px;">θ</span></span></span><span class="MJXp-munderover" id="MJXp-Span-335"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341" style="margin-right: 0px; margin-left: 0px;">m</span></span><span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-337" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">i</span><span class="MJXp-mo" id="MJXp-Span-339">=</span><span class="MJXp-mn" id="MJXp-Span-340">1</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-342">log</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-346" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-mi" id="MJXp-Span-348">m</span><span class="MJXp-mi" id="MJXp-Span-349">o</span><span class="MJXp-mi" id="MJXp-Span-350">d</span><span class="MJXp-mi" id="MJXp-Span-351">e</span><span class="MJXp-mi" id="MJXp-Span-352">l</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-356" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-357">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">i</span><span class="MJXp-mo" id="MJXp-Span-359">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-363" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-364">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">i</span><span class="MJXp-mo" id="MJXp-Span-366">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-368">θ</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-386"><span class="mtable" id="MathJax-Span-387" style="min-width: 23.386em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.386em;"><span style="display: inline-block; position: absolute; width: 17.675em; height: 0px; clip: rect(-1.775em, 1017.62em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -8.834em;"><span style="position: absolute; clip: rect(2.212em, 1017.62em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.675em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1017.62em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -8.834em;"><span class="mtd" id="MathJax-Span-391"><span class="mrow" id="MathJax-Span-392"><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-bold-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="texatom" id="MathJax-Span-395"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munder" id="MathJax-Span-400" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 3.397em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1003.4em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Main;">arg</span><span class="mo" id="MathJax-Span-403"></span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main; padding-left: 0.164em;">max</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.259em, -999.997em); top: -3.122em; left: 1.511em;"><span class="mi" id="MathJax-Span-405" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-406" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Main; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-415"></span><span class="msubsup" id="MathJax-Span-416" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="texatom" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Main;">l</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mo" id="MathJax-Span-432" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-436" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-438"><span class="mrow" id="MathJax-Span-439"><span class="mo" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.4"><span class="mrow" id="MathJax-Span-389"><span class="mtext" id="MathJax-Span-390" style="font-family: MathJax_Main;">(8.4)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">\boldsymbol{\theta}_{ML} = \underset{\boldsymbol{\theta}}{\arg \max} \sum^m_{i=1} \log p_{\mathrm{model}}(\boldsymbol{x}^{(i)}, y^{(i)};\boldsymbol{\theta}). \tag{8.4}</script></span></p><p>Cực đại hóa tổng này tương đương với cực đại hóa kì vọng của phân phối thực nghiệm xác định bởi tập huấn luyện:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-371"><span class="MJXp-mtable" id="MJXp-Span-372"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-373" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-374" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">J</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-377">θ</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mrow" id="MJXp-Span-381" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-382">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-383" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-384"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-385">x</span></span><span class="MJXp-mo" id="MJXp-Span-386">,</span><span class="MJXp-mrow" id="MJXp-Span-387"><span class="MJXp-mi" id="MJXp-Span-388">y</span></span><span class="MJXp-mo" id="MJXp-Span-389">∼</span><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mrow" id="MJXp-Span-391" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-392"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-394" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-395" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-396"><span class="MJXp-mi" id="MJXp-Span-397">d</span><span class="MJXp-mi" id="MJXp-Span-398">a</span><span class="MJXp-mi" id="MJXp-Span-399">t</span><span class="MJXp-mi" id="MJXp-Span-400">a</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-401">log</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-405" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-406"><span class="MJXp-mi" id="MJXp-Span-407">m</span><span class="MJXp-mi" id="MJXp-Span-408">o</span><span class="MJXp-mi" id="MJXp-Span-409">d</span><span class="MJXp-mi" id="MJXp-Span-410">e</span><span class="MJXp-mi" id="MJXp-Span-411">l</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-413">x</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">y</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-417">θ</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-447"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-448"><span class="mtable" id="MathJax-Span-449" style="min-width: 20.477em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.477em;"><span style="display: inline-block; position: absolute; width: 14.766em; height: 0px; clip: rect(-1.021em, 1014.66em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -7.379em;"><span style="position: absolute; clip: rect(3.02em, 1014.66em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.766em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1014.66em, 4.529em, -999.997em); top: -4.038em; left: 50%; margin-left: -7.379em;"><span class="mtd" id="MathJax-Span-453"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-460" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 3.774em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.649em;"><span class="texatom" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="texatom" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Main;">y</span></span></span><span class="mo" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.289em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-475"><span class="mrow" id="MathJax-Span-476"><span class="munderover" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.27em, 3.774em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-size: 50%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-485" style="font-size: 50%; font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-486" style="font-size: 50%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-487" style="font-size: 50%; font-family: MathJax_Main;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Main; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-489"></span><span class="msubsup" id="MathJax-Span-490" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="texatom" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">l</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.38em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.5"><span class="mrow" id="MathJax-Span-451"><span class="mtext" id="MathJax-Span-452" style="font-family: MathJax_Main;">(8.5)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">J(\boldsymbol{\theta}) = \mathbb{E}_{\boldsymbol{\mathrm{x}} ,\mathrm{y}\sim\hat{p}_{\mathrm{data}}}\log p_{\mathrm{model}}(\boldsymbol{x},y;\boldsymbol{\theta}). \tag{8.5}</script></span></p><p>Hầu hết các thuộc tính của hàm mục tiêu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">J</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-509"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-510"><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">J</script></span> được sử dụng bởi phần lớn các thuật toán tối ưu cũng là các kì vọng trên tập huấn luyện. Chẳng hạn, thuộc tính thường dùng nhất là gradient:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-422"><span class="MJXp-mtable" id="MJXp-Span-423"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-424" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-425" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi" id="MJXp-Span-427" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-429">θ</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">J</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-432">θ</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mrow" id="MJXp-Span-436" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-437">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-438" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-439"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-440">x</span></span><span class="MJXp-mo" id="MJXp-Span-441">,</span><span class="MJXp-mrow" id="MJXp-Span-442"><span class="MJXp-mi" id="MJXp-Span-443">y</span></span><span class="MJXp-mo" id="MJXp-Span-444">∼</span><span class="MJXp-msubsup" id="MJXp-Span-445"><span class="MJXp-mrow" id="MJXp-Span-446" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-447"><span><span class="MJXp-over"><span class="MJXp-script" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-449" style="margin-right: 0px; margin-left: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">p</span></span></span></span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-451"><span class="MJXp-mi" id="MJXp-Span-452">d</span><span class="MJXp-mi" id="MJXp-Span-453">a</span><span class="MJXp-mi" id="MJXp-Span-454">t</span><span class="MJXp-mi" id="MJXp-Span-455">a</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-456"><span class="MJXp-mi" id="MJXp-Span-457" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-458" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-459">θ</span></span></span><span class="MJXp-mi" id="MJXp-Span-460">log</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-464" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-465"><span class="MJXp-mi" id="MJXp-Span-466">m</span><span class="MJXp-mi" id="MJXp-Span-467">o</span><span class="MJXp-mi" id="MJXp-Span-468">d</span><span class="MJXp-mi" id="MJXp-Span-469">e</span><span class="MJXp-mi" id="MJXp-Span-470">l</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-472">x</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">y</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-476">θ</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-513"><span class="mtable" id="MathJax-Span-514" style="min-width: 23.063em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.063em;"><span style="display: inline-block; position: absolute; width: 17.352em; height: 0px; clip: rect(-1.021em, 1017.3em, 0.488em, -999.997em); top: 0em; left: 50%; margin-left: -8.672em;"><span style="position: absolute; clip: rect(3.02em, 1017.3em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.352em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1017.3em, 4.529em, -999.997em); top: -4.038em; left: 50%; margin-left: -8.672em;"><span class="mtd" id="MathJax-Span-518"><span class="mrow" id="MathJax-Span-519"><span class="msubsup" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-530" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 3.774em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.649em;"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="texatom" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="mi" id="MathJax-Span-538" style="font-size: 70.7%; font-family: MathJax_Main-bold;">x</span></span></span><span class="mo" id="MathJax-Span-539" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Main;">y</span></span></span><span class="mo" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.289em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-545"><span class="mrow" id="MathJax-Span-546"><span class="munderover" id="MathJax-Span-547"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.27em, 3.774em, -999.997em); top: -4.038em; left: 0.11em;"><span class="mo" id="MathJax-Span-549" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-550"><span class="mrow" id="MathJax-Span-551"><span class="texatom" id="MathJax-Span-552"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-size: 50%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-555" style="font-size: 50%; font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-556" style="font-size: 50%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-557" style="font-size: 50%; font-family: MathJax_Main;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-564"></span><span class="msubsup" id="MathJax-Span-565" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-567"><span class="mrow" id="MathJax-Span-568"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main;">l</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-0.967em, 1001.94em, 0.38em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.6"><span class="mrow" id="MathJax-Span-516"><span class="mtext" id="MathJax-Span-517" style="font-family: MathJax_Main;">(8.6)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})=\mathbb{E}_{\boldsymbol{\mathrm{x}} ,\mathrm{y}\sim\hat{p}_{\mathrm{data}}}\nabla_{\boldsymbol{\theta}}\log p_{\mathrm{model}}(\boldsymbol{x},y;\boldsymbol{\theta}). \tag{8.6}</script></span></p><p>Việc tính toán chính xác kì vọng này là rất tốn kém bởi nó đòi hỏi phải định trị mô hình trên mọi mẫu trong toàn bộ tập dữ liệu. Trên thực tế, ta có thể tính những kỳ vọng này bằng cách lấy ngẫu nhiên một số ít các mẫu trong tập dữ liệu, sau đó tính giá trị trung bình trên các mẫu đó.</p><p>Nhắc lại rằng sai số chuẩn của trung bình (phương trình (5.46)) được ước lượng từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">n</script></span> mẫu có công thức là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">σ</span><span class="MJXp-mrow" id="MJXp-Span-483"><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msqrt" id="MJXp-Span-485"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">n</span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-593"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.811em;"><span class="mrow" id="MathJax-Span-594"><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.559em, 1000.65em, 3.936em, -999.997em); top: -4.415em; left: 0.811em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: -0.105em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: -0.051em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1000.87em, 4.367em, -999.997em); top: -3.93em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">\sigma/\sqrt{n}</script></span>, với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">σ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-597"><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\sigma</script></span> là độ lệch chuẩn thực sự của giá trị các mẫu. Mẫu số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-msqrt" id="MJXp-Span-490"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">n</span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-599"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-600"><span class="msqrt" id="MathJax-Span-601"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.811em;"><span class="mrow" id="MathJax-Span-602"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.559em, 1000.65em, 3.936em, -999.997em); top: -4.415em; left: 0.811em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: -0.105em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.984em; left: -0.051em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.02em, 1000.87em, 4.367em, -999.997em); top: -3.93em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">\sqrt{n}</script></span> cho biết lợi ích thu được là sai số chuẩn trung bình giảm chậm hơn hàm tuyến tính khi dùng nhiều mẫu hơn để ước lượng gradient. So sánh hai ước lượng giả thuyết của gradient, một dựa trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mn" id="MJXp-Span-493">100</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-604"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-605"><span class="mn" id="MathJax-Span-606" style="font-family: MathJax_Main;">100</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">100</script></span> mẫu và một dựa trên <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-494"><span class="MJXp-mn" id="MJXp-Span-495">10</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-497">000</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-607"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-608"><span class="mn" id="MathJax-Span-609" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.164em;">000</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">10,000</script></span> mẫu. Ước lượng thứ hai yêu cầu khối lượng tính toán gấp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mn" id="MJXp-Span-499">100</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-613"><span class="mn" id="MathJax-Span-614" style="font-family: MathJax_Main;">100</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">100</script></span> lần so với ước lượng thứ nhất nhưng chỉ giảm sai số chuẩn của trung bình đi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-500"><span class="MJXp-mn" id="MJXp-Span-501">10</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-616"><span class="mn" id="MathJax-Span-617" style="font-family: MathJax_Main;">10</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">10</script></span> lần. Hầu hết các thuật toán tối ưu hội tụ nhanh hơn nhiều (theo khối lượng tính toán, không phải theo số lần cập nhật) nếu ta sử dụng các xấp xỉ để ước lượng gradient một cách nhanh chóng thay vì tính toán chính xác gradient một cách chậm chạp.</p><p>Một lý do khác thúc đẩy ý tưởng lấy ước lượng thống kê của gradient từ một số ít các mẫu là sự dư thừa trong tập huấn luyện. Trong trường hợp tệ nhất, toàn bộ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-619"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">m</script></span> mẫu trong tập huấn luyện có thể là bản sao chính xác của cùng một mẫu. Một ước lượng dựa trên việc lấy mẫu có thể tính toán chính xác gradient với chỉ với một mẫu, sử dụng khối lượng tính toán ít hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-621"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-622"><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">m</script></span> lần so với cách tiếp cận giản đơn. Trong thực tế, không dễ gặp trường hợp tệ nhất này, nhưng ta có thể bắt gặp một số lượng lớn các mẫu có đóng góp rất giống nhau tới gradient.</p><p>Các thuật toán tối ưu sử dụng toàn bộ tập huấn luyện được gọi là các phương pháp gradient theo <strong>lô</strong> (batch) hay gradient <strong>tất định</strong> (deterministic), bởi chúng xử lý toàn bộ các mẫu huấn luyện cùng lúc trong một lô lớn. Định nghĩa này đôi khi có thể gây nhầm lẫn vì từ “lô”  thường dùng để chỉ những <em>lô nhỏ</em> (minibatch) dùng trong trượt gradient ngẫu nhiên theo lô nhỏ. Thông thường cụm từ “trượt gradient theo lô” (batch gradient descent) hàm ý việc sử dụng toàn bộ tập huấn luyện, trong khi việc dùng từ “lô” để miêu tả một nhóm các mẫu thì không mang hàm ý đó. Chẳng hạn, thông thường ta dùng từ “kích thước lô” (batch size) để miêu tả kích thước của một lô nhỏ.</p><p>Các thuật toán tối ưu chỉ dùng lần lượt mỗi mẫu  đôi khi được gọi là các phương pháp <strong>ngẫu nhiên</strong> (stochastic) và đôi khi là phương pháp <strong>trực tuyến</strong> (online). Từ “trực tuyến” thường được dùng khi các mẫu được lấy từ một luồng liên tục các mẫu được tạo ra thay vì từ một tập huấn luyện cố định.</p><p>Hầu hết các thuật toán sử dụng trong học sâu rơi đâu đó ở giữa, sử dụng nhiều hơn một nhưng ít hơn toàn bộ số lượng mẫu huấn luyện. Chúng được gọi một cách truyền thống là các phương pháp <strong>lô nhỏ</strong> (minibatch) hoặc <strong>lô nhỏ ngẫu nhiên</strong> (stochastic minibatch), và bây giờ phổ biến người ta gọi chúng chỉ đơn giản là phương pháp <strong>ngẫu nhiên</strong>.</p><p>Một ví dụ kinh điển về phương pháp ngẫu nhiên là trượt gradient ngẫu nhiên, được trình bày chi tiết trong phần 8.3.1.</p><p>Các kích thước của lô nhỏ thường chịu ảnh hưởng từ các yếu tố sau:</p><ul>
<li>
<p>Các lô lớn hơn cung cấp ước lượng chính xác hơn của gradient, nhưng với tỉ lệ dưới tuyến tính.</p>
</li>
<li>
<p>Các kiến trúc đa lõi thường không được tận dụng triệt để khi các lô cực nhỏ. Điều này khuyến khích việc sử dụng kích thước lô không nhỏ hơn một đại lượng, dưới đại lượng này không làm tăng tốc độ xử lý.</p>
</li>
<li>
<p>Nếu tất cả các mẫu trong lô được xử lý song song (đây là trường hợp thông dụng), khi đó bộ nhớ tỉ lệ thuận với kích thước lô. Trong nhiều thiết lập phần cứng, đây là nhân tố chủ yếu hạn chế kích thước lô có thể sử dụng.</p>
</li>
<li>
<p>Một số loại phần cứng đạt được thời gian chạy tốt hơn với các kích thước chuyên biệt của mảng. Đặc biệt khi sử dụng GPU, thông thường lô có kích thước là lũy thừa của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mn" id="MJXp-Span-507">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-624"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-625"><span class="mn" id="MathJax-Span-626" style="font-family: MathJax_Main;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">2</script></span> cho thời gian chạy tốt nhất, thường là từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mn" id="MJXp-Span-509">32</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-627"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-628"><span class="mn" id="MathJax-Span-629" style="font-family: MathJax_Main;">32</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">32</script></span> đến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mn" id="MJXp-Span-511">256</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-630"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-631"><span class="mn" id="MathJax-Span-632" style="font-family: MathJax_Main;">256</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">256</script></span>, và đôi khi là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-mn" id="MJXp-Span-513">16</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-634"><span class="mn" id="MathJax-Span-635" style="font-family: MathJax_Main;">16</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">16</script></span> với các các mô hình lớn.</p>
</li>
<li>
<p>Các lô nhỏ có thể gián tiếp tạo ra một cơ chế kiểm soát [Wilson and Martinez, 2003], có thể là do nhiễu mà chúng thêm vào quá trình học. Sai số tổng quát hóa thường đạt giá trị tốt nhất khi kích thước lô bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-514"><span class="MJXp-mn" id="MJXp-Span-515">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-636"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-637"><span class="mn" id="MathJax-Span-638" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">1</script></span>. Huấn luyện với một kích thước lô nhỏ như vậy có thể yêu cầu một tốc độ học nhỏ để duy trì sự ổn định bởi vấn đề phương sai lớn khi ước lượng gradient. Tổng thời gian chạy có thể rất lớn do thuật toán cần thực hiện nhiều bước hơn, bởi tốc độ học nhỏ và phải mất nhiều bước hơn để lượt qua toàn bộ tập huấn luyện.</p>
</li>
</ul><p>Các loại thuật toán khác nhau sử dụng các loại thông tin khác nhau từ lô nhỏ theo nhiều cách khác nhau. Một số thuật toán nhạy cảm hơn với lỗi lấy mẫu so với các thuật toán khác, hoặc bởi vì chúng sử dụng những thông tin khó có thể ước lượng chính xác với một số ít mẫu, hoặc vì chúng sử dụng thông tin theo những cách làm khuếch đại lỗi lấy mẫu nhiều hơn. Các phương pháp tính toán chỉ cập nhật dựa trên gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-517">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-639"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">\boldsymbol{g}</script></span> thường kháng nhiễu khá tốt và có thể xử lý các lô có kích thước nhỏ hơn, như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mn" id="MJXp-Span-519">100</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-643"><span class="mn" id="MathJax-Span-644" style="font-family: MathJax_Main;">100</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">100</script></span>. Các phương pháp bậc hai, cũng sử dụng ma trận Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-521">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\boldsymbol{H}</script></span> và tính toán các cập nhật như <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-525" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-526">−</span><span class="MJXp-mn" id="MJXp-Span-527">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-528">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-648"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-649"><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.03em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.08em;"><span class="texatom" id="MathJax-Span-652"><span class="mrow" id="MathJax-Span-653"><span class="mo" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-656" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">\boldsymbol{H}^{-1}\boldsymbol{g}</script></span>, thường yêu cầu kích thước lô lớn hơn, chẳng hạn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mn" id="MJXp-Span-530">10</span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-532">000</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-658"><span class="mn" id="MathJax-Span-659" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-661" style="font-family: MathJax_Main; padding-left: 0.164em;">000</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">10,000</script></span>. Kích thước lô lớn như vậy là nhằm cực tiểu hóa các biến động trong các ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-msubsup" id="MJXp-Span-534"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-535" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-536" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-537">−</span><span class="MJXp-mn" id="MJXp-Span-538">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-539">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-662"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-663"><span class="msubsup" id="MathJax-Span-664"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.03em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.08em;"><span class="texatom" id="MathJax-Span-666"><span class="mrow" id="MathJax-Span-667"><span class="mo" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">\boldsymbol{H}^{-1}\boldsymbol{g}</script></span>. Giả sử rằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-541">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-672"><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">\boldsymbol{H}</script></span> được ước lượng một cách hoàn hảo nhưng có tính điều hoà kém. Nghĩa là chỉ một thay đổi nhỏ trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-543">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-674"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-675"><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">\boldsymbol{g}</script></span> có thể dẫn tới thay đổi lớn trong <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-544"><span class="MJXp-msubsup" id="MJXp-Span-545"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-546" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-547" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-548">−</span><span class="MJXp-mn" id="MJXp-Span-549">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-550">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-677"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-678"><span class="msubsup" id="MathJax-Span-679"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.03em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.08em;"><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">\boldsymbol{H}^{-1}\boldsymbol{g}</script></span>, ngay cả khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-552">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-686"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-687"><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">\boldsymbol H</script></span> được ước lượng một cách chính xác. Trên thực tế, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-554">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-689"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-690"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">\boldsymbol{H}</script></span> được tính xấp xỉ nên việc cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-557" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-558" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-559">−</span><span class="MJXp-mn" id="MJXp-Span-560">1</span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-561">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-692"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-693"><span class="msubsup" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.03em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.08em;"><span class="texatom" id="MathJax-Span-696"><span class="mrow" id="MathJax-Span-697"><span class="mo" id="MathJax-Span-698" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-699" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">\boldsymbol{H}^{-1}\boldsymbol{g}</script></span> sẽ thậm chí gây ra sai số lớn hơn ta kì vọng khi áp dụng một phép toán kém điều hoà vào ước lượng của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-563">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">\boldsymbol g</script></span>.</p><p>Một điều rất quan trọng là các lô nhỏ cần được chọn một cách ngẫu nhiên. Việc tính toán một ước lượng <em>không chệch</em> (unbiased) của gradient kỳ vọng từ một tập các mẫu yêu cầu các mẫu này phải là độc lập. Chúng ta cũng mong muốn hai ước lượng gradient liên tiếp sẽ độc lập với nhau, do vậy hai lô nhỏ cần phải độc lập với nhau. Nhiều bộ dữ liệu được sắp xếp một cách tự nhiên nhất theo cách mà các mẫu liên tiếp nhau có mối tương quan cao. Ví dụ, chúng ta có thể có một tập dữ liệu y tế với một danh sách dài các kết quả xét nghiệm mẫu máu. Danh sách này có thể được sắp xếp để lần đầu tiên chúng ta lấy năm mẫu máu được lấy ở các thời điểm khác nhau từ bệnh nhân đầu tiên, sau đó lấy ba mẫu máu từ bệnh nhân thứ hai, sau đó lấy các mẫu máu từ bệnh nhân thứ ba,… Nếu chúng ta lấy các mẫu theo đúng thứ tự từ danh sách này thì mỗi lô nhỏ sẽ có độ chệch lớn, bởi mỗi lô sẽ đại diện chủ yếu cho một trong số nhiều bệnh nhân trong tập dữ liệu. Trong các trường hợp này, khi thứ tự của tập dữ liệu có ảnh hưởng đến tính tổng quát của việc lấy mẫu, ta cần xáo trộn các mẫu một cách ngẫu nhiên trước khi chọn các lô nhỏ. Ví dụ, đối với các tập dữ liệu rất lớn, các tập dữ liệu chứa hàng tỷ mẫu trong một trung tâm dữ liệu, sẽ khó để có thể lấy các mẫu thực sự ngẫu nhiên mỗi khi chúng ta muốn xây dựng một lô nhỏ. May mắn thay, trong thực tế, thường thì xáo trộn thứ tự của tập dữ liệu một lần là đủ. Việc này sẽ tạo ra một tập cố định các lô nhỏ của các mẫu liên tiếp được sử dụng cho tất cả các mô hình được huấn luyện sau này, và mỗi mô hình riêng lẻ buộc phải sử dụng lại thứ tự này mỗi khi nó duyệt qua dữ liệu huấn luyện. Cách thực hiện không hoàn toàn ngẫu nhiên này xem chừng không có hại nghiêm trọng. Nhưng nếu không xáo trộn dù chỉ một lần có thể làm giảm nghiêm trọng tính hiệu quả của thuật toán.</p><p>Nhiều bài toán tối ưu trong học máy thực hiện việc chia nhỏ các mẫu đủ tốt để có thể tính toán toàn bộ các cập nhật riêng biệt trên các mẫu khác nhau một cách song song. Nói cách khác, chúng ta có thể tính toán việc cập nhật nhằm cực tiểu hóa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">J</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-567">X</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-709" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">J(\boldsymbol{X})</script></span> cho một lô nhỏ của các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-570">X</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-711"><span class="mi" id="MathJax-Span-712" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\boldsymbol{X}</script></span> cùng thời điểm tính toán cập nhật cho nhiều lô nhỏ khác. Các hướng tiếp cận phân bố song song không đồng bộ như vậy sẽ được thảo luận chi tiết hơn trong mục 12.1.3.</p><p>Một ưu điểm thú vị thúc đẩy việc sử dụng trượt gradient ngẫu nhiên theo lô nhỏ là nó tạo ra gradient thực sự của <em>sai số tổng quát hóa</em> (phương trình 8.2) miễn là không có mẫu nào lặp lại. Hầu hết các triển khai của trượt gradient ngẫu nhiên theo lô nhỏ xáo trộn tập dữ liệu một lần và sau đó duyệt qua nó nhiều lần. Ở lần đầu tiên, mỗi lô nhỏ được sử dụng để tính toán một ước lượng không chệch của sai số tổng quát hóa thực sự. Ở lần thứ hai, ước lượng xuất hiện độ lệch bởi nó được hình thành bằng việc lấy mẫu lại các giá trị đã được sử dụng, thay vì lấy các mẫu mớic đều nhau từ phân phối sinh dữ liệu.</p><p>Thực tế, việc trượt gradient ngẫu nhiên giúp cực tiểu hóa sai số tổng quát hóa dễ được quan sát nhất trong học trực tuyến, ở đó các mẫu hoặc các lô nhỏ được lấy ra từ một <em>luồng</em> (stream) dữ liệu. Nói cách khác, thay vì nhận được một tập huấn luyện với kích cỡ cố định, thuật toán học cũng tương tự như một sinh vật sống nhìn thấy một mẫu mới tại mỗi khoảnh khắc, với các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-573">x</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">y</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-714"><span class="mo" id="MathJax-Span-715" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-717" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-718" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-719" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">(\boldsymbol{x}, y)</script></span> đến từ phân phối sinh dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-msubsup" id="MJXp-Span-578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-580" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-581">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-583">x</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">y</span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-720"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-721"><span class="msubsup" id="MathJax-Span-722"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mtext" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">p_{\text{data}}(\boldsymbol{x}, y )</script></span>. Trong trường hợp này, các mẫu không bao giờ bị lặp lại; mọi kinh nghiệm thu được là một phép lấy mẫu đồng đều từ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-591">data</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-733"><span class="msubsup" id="MathJax-Span-734"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-736"><span class="mrow" id="MathJax-Span-737"><span class="mtext" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">p_{\text{data}}</script></span>.</p><p>Ta có thể dễ dàng suy ra sự tương đương khi cả <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-593">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-739"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-740"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">\boldsymbol{x}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-742"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-743"><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">y</script></span> là rời rạc. Trong trường hợp này, sai số tổng quát hóa (phương trình (8.2)) có thể được viết dưới dạng tổng<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-596"><span class="MJXp-mtable" id="MJXp-Span-597"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-598" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-599" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601" style="margin-right: 0.05em;">J</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-602" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-604">θ</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-607"><span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-610"><span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612" style="margin-left: 0px;">y</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-616">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-618">x</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">y</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">L</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">f</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-626">x</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-628">θ</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">y</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-746"><span class="mtable" id="MathJax-Span-747" style="min-width: 22.74em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.74em;"><span style="display: inline-block; position: absolute; width: 17.029em; height: 0px; clip: rect(-1.506em, 1016.92em, 1.026em, -999.997em); top: 0em; left: 50%; margin-left: -8.51em;"><span style="position: absolute; clip: rect(2.481em, 1016.92em, 5.013em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.029em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1016.92em, 5.445em, -999.997em); top: -4.415em; left: 50%; margin-left: -8.51em;"><span class="mtd" id="MathJax-Span-751"><span class="mrow" id="MathJax-Span-752"><span class="msubsup" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="mo" id="MathJax-Span-755" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-758" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-760" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.259em, -999.997em); top: -2.961em; left: 0.541em;"><span class="mi" id="MathJax-Span-762" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-763" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-764" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.421em, -999.997em); top: -2.961em; left: 0.541em;"><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-766" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-767" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="mtext" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-776" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-777" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-779" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-783" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-786" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.344em, 1001.94em, 0.003em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.415em; right: 0em;"><span class="mtd" id="mjx-eqn-8.7"><span class="mrow" id="MathJax-Span-749"><span class="mtext" id="MathJax-Span-750" style="font-family: MathJax_Main;">(8.7)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-79">J^ ∗ (\boldsymbol{\theta}) =\sum\limits_x\sum\limits_yp_{\text{data}} (\boldsymbol{x}, y) L (f (\boldsymbol{x}; \boldsymbol{\theta}), y), \tag{8.7}</script></span><br>
với gradient chính xác<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-634"><span class="MJXp-mtable" id="MJXp-Span-635"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-636" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-637" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">g</span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi" id="MJXp-Span-641" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-642" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">J</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-645" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-647">θ</span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-650"><span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652" style="margin-left: 0px;">x</span></span></span><span class="MJXp-munderover" id="MJXp-Span-653"><span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655" style="margin-left: 0px;">y</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-659">data</span></span></span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-661">x</span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">y</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-665"><span class="MJXp-mi" id="MJXp-Span-666" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-667" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">L</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">f</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-672">x</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-674">θ</span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">y</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-789"><span class="mtable" id="MathJax-Span-790" style="min-width: 26.996em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.996em;"><span style="display: inline-block; position: absolute; width: 21.285em; height: 0px; clip: rect(-1.506em, 1021.23em, 1.026em, -999.997em); top: 0em; left: 50%; margin-left: -10.665em;"><span style="position: absolute; clip: rect(2.481em, 1021.23em, 5.013em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 21.285em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1021.23em, 5.445em, -999.997em); top: -4.415em; left: 50%; margin-left: -10.665em;"><span class="mtd" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-798" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-801"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="mo" id="MathJax-Span-803" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-808" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.259em, -999.997em); top: -2.961em; left: 0.541em;"><span class="mi" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-811" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.421em, -999.997em); top: -2.961em; left: 0.541em;"><span class="mi" id="MathJax-Span-813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-814" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-815" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mtext" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Main;">data</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-819" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-820" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-824"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-826" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-831" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-832" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-833" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-835" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-837" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.344em, 1001.94em, 0.003em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.415em; right: 0em;"><span class="mtd" id="mjx-eqn-8.8"><span class="mrow" id="MathJax-Span-792"><span class="mtext" id="MathJax-Span-793" style="font-family: MathJax_Main;">(8.8)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">g = \nabla_\theta J^ ∗ (\boldsymbol{\theta}) = \sum\limits_x\sum\limits_yp_{\text{data}} (\boldsymbol{x}, y) \nabla_\theta L (f (\boldsymbol{x}; \boldsymbol{\theta}), y). \tag{8.8}</script></span></p><p>Chúng ta đã thấy khai triển tương tự cho logarit hàm hợp lý trong phương trình (8.5) và phương trình (8.6); ta thấy rằng điều này đúng cho các hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">L</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-839"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-840"><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic;">L</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">L</script></span> khác bên cạnh hàm hợp lý. Một kết quả tương tự có thể được suy ra khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-683">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-842"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">\boldsymbol{x}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-845"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-846"><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">y</script></span> liên tục, dựa trên các <em>giả định mềm</em> (mild assumption) về <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-msubsup" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-689" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">a</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-848"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-849"><span class="msubsup" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="mi" id="MathJax-Span-854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">p_{data}</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">L</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-859"><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">L</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">L</script></span>.</p><blockquote>
<p><em><strong>ND</strong></em>: Giả định mềm là các giả định không quá khắt khe được thêm vào để đơn giản hóa bài toán.</p>
</blockquote><p>Do đó, chúng ta có thể thu được ước lượng không chệch của gradient chính xác của sai số tổng quát hoá bằng phép lấy mẫu các mẫu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-700" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-701">(</span><span class="MJXp-mn" id="MJXp-Span-702">1</span><span class="MJXp-mo" id="MJXp-Span-703">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-709" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-710">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">m</span><span class="MJXp-mo" id="MJXp-Span-712">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-862"><span class="mo" id="MathJax-Span-863" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-864"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-866"><span class="mrow" id="MathJax-Span-867"><span class="mo" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-869" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-870" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-871" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-872" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-873" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-874" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-876"><span class="mrow" id="MathJax-Span-877"><span class="mo" id="MathJax-Span-878" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-881" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">\{x^{(1)}, \ldots, x^{(m)} \}</script></span> với các nhãn mục tiêu tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-msubsup" id="MJXp-Span-715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-717" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-718">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">i</span><span class="MJXp-mo" id="MJXp-Span-720">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-882"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-883"><span class="msubsup" id="MathJax-Span-884"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="texatom" id="MathJax-Span-886"><span class="mrow" id="MathJax-Span-887"><span class="mo" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">y^{(i)}</script></span> từ phân phối sinh dữ liệu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-721"><span class="MJXp-msubsup" id="MJXp-Span-722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-724" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-725"><span class="MJXp-mi" id="MJXp-Span-726">d</span><span class="MJXp-mi" id="MJXp-Span-727">a</span><span class="MJXp-mi" id="MJXp-Span-728">t</span><span class="MJXp-mi" id="MJXp-Span-729">a</span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-891"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-892"><span class="msubsup" id="MathJax-Span-893"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-894" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-895"><span class="mrow" id="MathJax-Span-896"><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Main;">a</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">p_{\mathrm{data}}</script></span>, sau đó tính toán gradient của hàm mất mát đối với các tham số cho lô nhỏ đó:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-730"><span class="MJXp-mtable" id="MJXp-Span-731"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-732" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-733" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-734"><span class="MJXp-munderover" id="MJXp-Span-735"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-736">g</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-739" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-740">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-742"><span class="MJXp-mi" id="MJXp-Span-743" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-744" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-munderover" id="MJXp-Span-745"><span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class="MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747" style="margin-left: 0px;">i</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">L</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">f</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-752"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-753" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-754" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-755">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">i</span><span class="MJXp-mo" id="MJXp-Span-757">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-759">θ</span><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-764" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-765">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">i</span><span class="MJXp-mo" id="MJXp-Span-767">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-904"><span class="mtable" id="MathJax-Span-905" style="min-width: 19.291em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.291em;"><span style="display: inline-block; position: absolute; width: 13.58em; height: 0px; clip: rect(-1.668em, 1013.53em, 1.188em, -999.997em); top: 0em; left: 50%; margin-left: -6.786em;"><span style="position: absolute; clip: rect(2.32em, 1013.53em, 5.175em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.58em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1013.53em, 5.337em, -999.997em); top: -4.146em; left: 50%; margin-left: -6.786em;"><span class="mtd" id="MathJax-Span-909"><span class="mrow" id="MathJax-Span-910"><span class="texatom" id="MathJax-Span-911"><span class="mrow" id="MathJax-Span-912"><span class="munderover" id="MathJax-Span-913"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-914" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-915" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-916" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-917" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-918" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.87em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.428em;"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.03em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.026em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-920"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-923" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-924" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.22em, 4.259em, -999.997em); top: -2.907em; left: 0.595em;"><span class="mi" id="MathJax-Span-925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">L</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-928" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-929" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-930"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-932"><span class="mrow" id="MathJax-Span-933"><span class="mo" id="MathJax-Span-934" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-935" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-936" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-938" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-939" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-941" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-943"><span class="mrow" id="MathJax-Span-944"><span class="mo" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-947" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.05em; height: 0px; clip: rect(-1.075em, 1001.94em, 0.218em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1001.94em, 4.421em, -999.997em); top: -4.146em; right: 0em;"><span class="mtd" id="mjx-eqn-8.9"><span class="mrow" id="MathJax-Span-907"><span class="mtext" id="MathJax-Span-908" style="font-family: MathJax_Main;">(8.9)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-89">\hat{\boldsymbol{g}}= \frac{1}{m}\nabla_\theta\sum\limits_i L (f (\boldsymbol{x}^{(i)}; \boldsymbol{\theta}), y^{(i)}). \tag{8.9}</script></span><br>
Việc cập nhật <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-770"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-771">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-950"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-951"><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">\boldsymbol{\theta}</script></span> theo hướng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-772"><span class="MJXp-mrow" id="MJXp-Span-773"><span class="MJXp-munderover" id="MJXp-Span-774"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-775">g</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-953"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-954"><span class="texatom" id="MathJax-Span-955"><span class="mrow" id="MathJax-Span-956"><span class="munderover" id="MathJax-Span-957"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-958" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">\hat{\boldsymbol{g}}</script></span> sẽ thực hiện trượt gradient ngẫu nhiên đối với sai số tổng quát hoá.</p><p>Tất nhiên, cách diễn giải này chỉ áp dụng khi các mẫu không được sử dụng lại. Tuy nhiên, thông thường, tốt nhất ta nên thực hiện nhiều lần duyệt qua tập huấn luyện, trừ khi tập huấn luyện là cực kỳ lớn. Khi ta sử dụng nhiều lượt huấn luyện như vậy, chỉ có lượt huấn luyện đầu tiên tạo ra gradient không chệch của sai số tổng quát hoá, nhưng dĩ nhiên, các lượt huấn luyện bổ sung thường cung cấp đủ lợi ích do việc sai số huấn luyện giảm để bù lại tác hại chúng gây ra bởi việc tăng khoảng cách giữa sai số huấn luyện và sai số kiểm thử.</p><p>Với một số bộ dữ liệu tăng trưởng về kích thước nhanh hơn khả năng tính toán, việc các ứng dụng học máy chỉ sử dụng mỗi mẫu huấn luyện một lần hoặc thậm chí thực hiện một lần duyệt không đầy đủ qua tập huấn luyện trở nên phổ biến hơn. Khi sử dụng một tập huấn luyện cực lớn, quá khớp không phải là vấn đề, mà vị khớp và hiệu quả tính toán mới là mối quan tâm chủ yếu. Bạn đọc có thể xem thêm sách của Bottou và Bousquet (2008) để tham khảo về tác động của các vấn đề tắc nghẽn trong tính toán đối với sai số tổng quát hoá, khi số lượng các mẫu huấn luyện tăng lên.</p><h1 id="82-Những-thách-thức-trong-tối-ưu-hóa-mạng-neuron">8.2 Những thách thức trong tối ưu hóa mạng neuron</h1><p>Tối ưu hóa nhìn chung là một tác vụ cực kỳ khó. Theo truyền thống, học máy đã tránh được khó khăn trong tối ưu hóa tổng quát bằng cách thiết kế hàm mục tiêu và các ràng buộc một cách cẩn thận để đảm bảo rằng bài toán tối ưu hóa là lồi. Khi huấn luyện mạng neuron, chúng ta phải đối mặt với trường hợp không lồi tổng quát. Ngay cả tối ưu lồi cũng có vấn đề của riêng nó. Trong phần này, chúng tôi sẽ tóm tắt một số thách thức điển hình nhất liên quan đến tối ưu cho các mô hình huấn luyện đa tầng.</p><h2 id="821-Tính-kém-điều-hoà">8.2.1 Tính kém điều hoà</h2><p>Việc tối ưu các hàm lồi đôi khi cũng phát sinh những thách thức. Trong số đó, nổi bật nhất là tính kém điều hoà của ma trận Hesse <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-778">H</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-960"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-961"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\boldsymbol{H}</script></span>. Đây là một vấn đề rất tổng quát trong hầu hết các bài toán tối ưu số, tối ưu lồi hay các trường hợp khác, được mô tả chi tiết hơn trong phần 4.3.1.</p><p>Vấn đề về <em>tính kém điều hoà</em> (ill-conditioning) được cho là thường hiện diện trong các vấn đề gặp phải khi huấn luyện mạng neuron. Tính kém điều hoà có thể khiến việc trượt gradient ngẫu nhiên bị “kẹt”, theo nghĩa là ngay cả những bước lặp rất nhỏ cũng làm tăng hàm chi phí.</p><p>Nhắc lại từ phương trình 4.9 rằng việc khai triển chuỗi Taylor bậc hai của hàm chi phí, dự đoán rằng, bước trượt <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-782">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-963"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-964"><span class="mo" id="MathJax-Span-965" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math-italic;">ϵ</span><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">−\epsilon \boldsymbol{g}</script></span> của gradient sẽ cộng thêm một lượng:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-796"><span class="MJXp-mtable" id="MJXp-Span-797"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-798" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-799" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-800" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-801">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-802">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-805" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-808" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-809">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-810">g</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-815" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-816">g</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-968"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-969"><span class="mtable" id="MathJax-Span-970" style="min-width: 14.173em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.173em;"><span style="display: inline-block; position: absolute; width: 7.438em; height: 0px; clip: rect(-1.398em, 1007.44em, 0.919em, -999.997em); top: 0em; left: 50%; margin-left: -3.715em;"><span style="position: absolute; clip: rect(2.589em, 1007.44em, 4.906em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.438em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1007.44em, 4.852em, -999.997em); top: -3.93em; left: 50%; margin-left: -3.715em;"><span class="mtd" id="MathJax-Span-974"><span class="mrow" id="MathJax-Span-975"><span class="mfrac" id="MathJax-Span-976"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-977" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-978" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-979"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.434em;"><span class="mn" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mrow" id="MathJax-Span-982"><span class="msubsup" id="MathJax-Span-983"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-987" style="font-family: MathJax_Math-bold-italic;">g</span></span><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-989" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="mrow" id="MathJax-Span-990"><span class="msubsup" id="MathJax-Span-991"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mo" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.805em, 1002.48em, 0.488em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.93em; right: 0em;"><span class="mtd" id="mjx-eqn-8.10"><span class="mrow" id="MathJax-Span-972"><span class="mtext" id="MathJax-Span-973" style="font-family: MathJax_Main;">(8.10)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">\frac{1}{2}\epsilon^2\boldsymbol{g^\intercal Hg} - \epsilon \boldsymbol{g^\intercal g} \tag{8.10}</script></span></p><p>vào hàm chi phí. Tính kém điều hoà sẽ trở thành một vấn đề khi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mfrac" id="MJXp-Span-818" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-819">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-820">2</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-823" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-826" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-827">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-828">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-995"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-996"><span class="mfrac" id="MathJax-Span-997"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -3.607em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-999" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.49em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1000"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1001" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.434em;"><span class="mn" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1003"><span class="msubsup" id="MathJax-Span-1004"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1005" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">\frac{1}{2}\epsilon^2\boldsymbol{g^\intercal Hg}</script></span> vượt quá <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-831"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-832" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-bold MJXp-script" id="MJXp-Span-833" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-834">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1009"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1010"><span class="mi" id="MathJax-Span-1011" style="font-family: MathJax_Math-italic;">ϵ</span><span class="mrow" id="MathJax-Span-1012"><span class="msubsup" id="MathJax-Span-1013"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mi" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Main-bold;">⊤</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1016" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">\epsilon \boldsymbol{g^\top g}</script></span>. Để xác định liệu tính kém điều hoà có gây bất lợi cho một tác vụ huấn luyện mạng neuron hay không, người ta có thể theo dõi giá trị bình phương của chuẩn gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-835"><span class="MJXp-msubsup" id="MJXp-Span-836"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-837" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-838" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-839">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1017"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1018"><span class="msubsup" id="MathJax-Span-1019"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1020" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1022" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">\boldsymbol{g^\intercal g}</script></span> và số hạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-msubsup" id="MJXp-Span-841"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-842" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-843" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-844">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-845">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1023"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1024"><span class="msubsup" id="MathJax-Span-1025"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1026" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1028" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\boldsymbol{g^\intercal Hg}</script></span>. Trong nhiều trường hợp, giá trị của chuẩn gradient không giảm đi một cách đáng kể trong suốt quá trình học, trong khi độ lớn của số hạng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-846"><span class="MJXp-msubsup" id="MJXp-Span-847"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-848" style="margin-right: 0.05em;">g</span><span class="MJXp-mo MJXp-bold MJXp-script" id="MJXp-Span-849" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-850">H</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-851">g</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1031"><span class="msubsup" id="MathJax-Span-1032"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1033" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mo" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1035" style="font-family: MathJax_Math-bold-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-bold-italic;">g</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">\boldsymbol{g^\intercal Hg}</script></span> tăng lên nhiều hơn một bậc. Kết quả là quá trình học trở nên rất chậm bất chấp sự hiện diện của một gradient mạnh, bởi tỷ lệ học phải giảm đi để bù đắp cho độ cong thậm chí mạnh hơn. Hình 8.1 cho thấy một ví dụ về việc giá trị gradient tăng đáng kể trong suốt quá trình huấn luyện thành công một mạng neuron.</p><p><img src="https://i.imgur.com/PnDT4ZZ.png" alt=""></p><blockquote>
<p>Hình 8.1: Trượt gradient thường không đạt tới bất kỳ một loại điểm tới hạn nào. Trong ví dụ này, <em>chuẩn gradient</em> (gradient norm) tăng trong suốt quá trình huấn luyện mạng tích chập được sử dụng cho bài toán nhận diện vật thể. (<em>Hình bên trái</em>) Một biểu đồ phân tán biểu diễn phân phối theo thời gian của chuẩn của các gradient riêng biệt. Để bạn đọc dễ quan sát, chúng tôi chỉ biểu diễn một chuẩn gradient đối với mỗi lượt huấn luyện. Giá trị trung bình của tất cả các chuẩn gradient được vẽ dưới dạng một đường cong liền. Có thể thấy giá trị của chuẩn gradient tăng rõ rệt theo thời gian, thay vì giảm như chúng ta mong đợi nếu quá trình huấn luyện hội tụ đến một điểm tới hạn. (<em>Hình bên phải</em>) Dẫu cho giá trị gradient ngày càng tăng, quá trình huấn luyện vẫn tương đối thành công. Sai số phân loại trên tập xác thực giảm dần theo thời gian.</p>
</blockquote><p>Mặc dù tính kém điều hoà hiện diện trong các tác vụ khác ngoài huấn luyện mạng neuron, nhưng các kỹ thuật được sử dụng để khắc phục vấn đề này trong các ngữ cảnh khác ít có khả năng áp dụng được vào các mạng neuron. Chẳng hạn, phương pháp Newton là một công cụ tuyệt vời để cực tiểu hóa các hàm lồi với các ma trận Hesse kém điều hoà, nhưng như chúng tôi sẽ chỉ ra trong các phần tiếp theo, phương pháp của Newton đòi hỏi sự điều chỉnh đáng kể trước khi nó có thể được áp dụng cho các mạng neuron.</p><p>---- Dong kết thúc dịch ở đây  ----</p><p>---- Minh Quang bắt đầu dịch từ đây (trang 281) ----</p><h2 id="822-Cực-tiểu-cục-bộ">8.2.2 Cực tiểu cục bộ</h2><p>Một trong những đặc tính nổi bật nhất của các bài toán tối ưu lồi là nó có thể quy về một bài toán đi tìm một điểm cực tiểu cục bộ. Bất cứ điểm cực tiểu cục bộ nào đảm bảo cũng là một điểm cực tiểu toàn cục (global minimum). Một số hàm lồi có một vùng bằng phẳng tại đáy thay vì có một điểm cực tiểu toàn cục duy nhất, và bất cứ điểm nào tại vùng bằng phẳng này cũng có thể xem như là một lời giải chấp nhận được. Khi tối ưu một hàm lồi, chúng ta có thể đạt được một kết quả tốt nếu có thể tìm được một điểm tới hạn thuộc bất kỳ loại nào.</p><p>Đối với các hàm không lồi, chẳng hạn như các mạng neuron, chúng có thể có nhiểu điểm cực tiểu cục bộ. Trên thực tế, gần như bất kỳ mô hình đa tầng nào cũng đều có một số lượng lớn các điểm cực tiểu cục bộ. Tuy nhiên, như chúng tôi sẽ trình bày sau đây, điều này không phải là một vấn đề lớn.</p><p>Các mạng neuron và bất kỳ mô hình nào với nhiều biến tiềm ẩn được tham số hoá một cách tương đương đều có nhiều điểm cực tiểu cục bộ do vấn đề về <em>tính khả định mô hình</em> (model identifiability). Một mô hình được cho là khả định nếu có một tập huấn luyện đủ lớn có thể loại trừ toàn bộ, ngoại trừ một thiết lập các tham số của mô hình. Các mô hình với các biến tiềm ẩn thường không khả định bởi chúng ta có thể thu được các mô hình tương đương bằng cách hoán đổi các biến tiềm ẩn cho nhau. Chẳng hạn, ta có thể điều chỉnh tầng đầu tiên trong một mạng neuron bằng cách thay vector trọng số đi vào tại đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">i</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1037"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1038"><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math-italic;">i</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">i</script></span> bằng vector trọng số đi vào tại đơn vị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">j</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1040"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1041"><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math-italic;">j</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">j</script></span>, và làm tương tự đối với các vector trọng số đi ra. Nếu ta có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1043"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1044"><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">m</script></span> tầng với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1046"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1047"><span class="mi" id="MathJax-Span-1048" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">n</script></span> đơn vị mỗi tầng, thì ta sẽ có <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">n</span><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0.111em; margin-right: 0.05em;">!</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-864" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1049"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-1052"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.22em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1053" style="font-family: MathJax_Main;">!</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.272em;"><span class="mi" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">n!^m</script></span> cách sắp xếp các đơn vị ẩn. <em>Tính vô khả định</em> (nonidentifiability) kiểu này được gọi là <em>sự đối xứng không gian trọng số</em> (weight space symmetry).</p><p>Ngoài sự đối xứng không gian trọng số , nhiều loại mạng neuron có các nguyên nhân khác gây nên vấn đề vô khả định. Thí dụ, trong bất kỳ mạng chỉnh lưu tuyến tính hoặc mạng cực đại đầu ra nào, ta có thể nhân tỷ lệ toàn bộ các trọng số và hệ số tự do đi vào của một đơn vị cho một hằng số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">α</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1055"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1056"><span class="mi" id="MathJax-Span-1057" style="font-family: MathJax_Math-italic;">α</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\alpha</script></span> nếu ta cũng nhân toàn bộ các trọng số với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-867"><span class="MJXp-mn" id="MJXp-Span-868">1</span><span class="MJXp-mrow" id="MJXp-Span-869"><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">α</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1058"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1059"><span class="mn" id="MathJax-Span-1060" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-1061"><span class="mrow" id="MathJax-Span-1062"><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic;">α</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">1 / \alpha</script></span>. Điều này có nghĩa là – nếu hàm mất mát không bao gồm các số hạng phụ thuộc trực tiếp vào các trọng số, chẳng hạn như suy giảm trọng số, thay vì các đầu ra của mô hình – mọi điểm cực tiểu cục bộ của một mạng chỉnh lưu tuyến tính hoặc mạng cực đại đầu ra sẽ nằm trên một hyperbol có kích thước <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">m</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">n</span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1065"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1066"><span class="mo" id="MathJax-Span-1067" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1068" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1069" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">n</span><span class="mo" id="MathJax-Span-1071" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">(m \times n)</script></span> của các cực tiểu cục bộ tương đương.</p><p>Các vấn đề về tính khả nhận mô hình hàm ý rằng một hàm chi phí của một mạng neuron có thể có một số lượng cực lớn hoặc vô hạn các điểm cực tiểu cục bộ. Tuy nhiên, tất cả các điểm cực tiểu cục bộ phát sinh từ vấn đề vô khả nhận được này là tương đương với nhau đối với giá trị hàm mất mát. Kết quả là, tất cả những điểm cực tiểu cục bộ này không phải là một dạng vấn đề liên quan đến tính không lồi.</p><p>Các điểm cực tiểu cục bộ có thể trở thành vấn đề nếu chúng gây ra chi phí cao so với điểm cực tiểu toàn cục. Người ta có thể xây dựng các mạng neuron nhỏ, thậm chí không bao gồm các đơn vị ẩn, có các điểm cực tiểu cục bộ với chi phí cao hơn điểm cực tiểu toàn cục [Sontag and Sussman, 1989; Brady et al., 1989; Gori and Tesi, 1992]. Nếu các điểm cực tiểu cục bộ với chi phí cao thường xuất hiện, nó cho thấy một vấn đề nghiêm trọng đối với các thuật toán tối ưu dựa trên gradient.</p><p>Liệu các mạng neuron trên thực tế có nhiều cực tiểu cục bộ gây ra hàm chi phí cao, và liệu các thuật toán tối ưu có gặp phải chúng hay không vẫn là các câu hỏi mở. Trong nhiều năm, hầu hết những người thực hành mạng neuron vẫn tin rằng các điểm cực tiểu cục bộ là một vấn đề phổ biến gây khó khăn cho tối ưu mạng neuron. Tuy nhiên, ngày nay, điều đó dường như không đúng. Vấn đề này vẫn đang được nghiên cứu một cách tích cực, nhưng hiện tại các chuyên gia cho rằng, với các mạng neuron đủ lớn, hầu hết các điểm cực tiểu cục bộ đều có một giá trị hàm mất mát nhỏ, và việc đi tìm điểm cực tiểu toàn cục không còn là vấn đề quan trọng nữa, thay vào đó ta sẽ đi tìm một điểm trong không gian tham số có chi phí thấp mặc dù không phải là thấp nhất. [Saxe et al.,2013; Dauphin et al., 2014; Goodfellow et al., 2015; Choromanska et al., 2014].</p><p>Rất nhiều người thực hành mạng neuron cho rằng hầu hết những khó khăn trong việc tối ưu hóa mạng neuron đến từ các điểm cực tiểu cục bộ. Chúng tôi khuyến khích những nhà thực hành kiểm tra lại vấn đề này cho các bài toán cụ thể. Một thí nghiệm có thể bác bỏ quan điểm trên là vẽ biểu đồ giá trị của chuẩn gradient theo thời gian. Nếu chuẩn của gradient không giảm tới một kích thước không đáng kể, có thể kết luận rằng vấn đề không phải là các điểm cực tiểu cục bộ hay bất kỳ loại điểm tới hạn nào khác. Trong không gian với số chiều lớn, rất khó có thể kiểm tra điểm cực tiểu cục bộ có phải là vấn đề hay không. Nhiều cấu trúc khác ngoài các điểm cực tiểu cục bộ cũng có các gradient nhỏ.</p><h2 id="823-Miền-phẳng-điểm-yên-ngựa-và-các-vùng-bằng-phẳng-khác">8.2.3 Miền phẳng, điểm yên ngựa và các vùng bằng phẳng khác</h2><p>Đối với nhiều hàm không lồi trong không gian nhiều chiều, các cực tiểu và cực đại cục bộ trên thực tế hiếm xảy ra so với một loại điểm khác mà gradient cũng bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mn" id="MJXp-Span-879">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1072"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1073"><span class="mn" id="MathJax-Span-1074" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">0</script></span>: điểm yên ngựa (saddle point). Một vài điểm xung quanh điểm yên ngựa có chi phí lớn hơn so với điểm yên ngựa này, trong khi những điểm còn lại có chi phí nhỏ hơn. Tại điểm yên ngựa, ma trận Hesse có cả trị riêng dương và âm. Các điểm nằm dọc theo các vector riêng với các  trị riêng dương có chi phí cao hơn so với tại điểm yên ngựa, trong khi đó các điểm nằm dọc theo các vector riêng với trị riêng âm có chi phí thấp hơn. Ta có thể xem điểm yên ngựa như là một điểm cực tiểu cục bộ dọc theo một mặt cắt ngang của hàm chi phí, và là một điểm cực đại cục bộ dọc theo một mặt cắt ngang khác. Xem minh hoạ trong hình 4.5.</p><p>Nhiều lớp hàm ngẫu nhiên có tính chất như sau: trong không gian số chiều thấp, các điểm cực tiểu cục bộ thường xuyên xuất hiện. Trong không gian số chiều cao, các điểm cực tiểu cục bộ rất hiếm gặp, và các điểm yên ngựa xuất hiện thường xuyên hơn. Cho một hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">f</span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mrow" id="MJXp-Span-884" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-885">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-886" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mrow" id="MJXp-Span-888"><span class="MJXp-mi undefined" id="MJXp-Span-889">R</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1075"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1076"><span class="mi" id="MathJax-Span-1077" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1078" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="msubsup" id="MathJax-Span-1079" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="texatom" id="MathJax-Span-1080"><span class="mrow" id="MathJax-Span-1081"><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.703em;"><span class="mi" id="MathJax-Span-1083" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main; padding-left: 0.272em;">→</span><span class="texatom" id="MathJax-Span-1085" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-family: MathJax_AMS;">R</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">f : \mathbb{R}^n \rightarrow \mathbb{R}</script></span> thuộc loại này, tỷ lệ kỳ vọng giữa số lượng điểm yên ngựa và số lượng điểm cực tiểu cục bộ tăng theo lũy thừa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1088"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1089"><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">n</script></span>. Để hiểu một cách trực quan về tính chất trên, ta thấy rằng ma trận Hesse tại một điểm cực tiểu cục bộ chỉ bao gồm trị riêng dương. Trong khi ma trận Hesse tại điểm yên ngựa bao gồm cả trị riêng dương lẫn âm. Tưởng tượng rằng dấu của mỗi trị riêng được tạo ra bằng cách tung một đồng xu. Trong không gian một chiều, dễ dàng thu được một điểm cực tiểu cục bộ bằng cách tung đồng xu và có một lần mặt sấp. Trong không gian <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1091"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1092"><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">n</script></span> chiều, khả năng tất cả các lần tung đồng xu là sấp giảm theo hàm mũ. Tham khảo [Dauphin et al. (2014)] về các nghiên cứu lý thuyết liên quan.</p><p>Một tính chất đáng kinh ngạc của nhiều hàm ngẫu nhiên là xác suất các trị riêng của ma trận Hesse là dương tăng dần khi khi ta tiếp cận các vùng có chi phí thấp. Liên tưởng đến việc tung đồng xu, điều này có nghĩa là xác suất đồng xu tung được <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1094"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1095"><span class="mi" id="MathJax-Span-1096" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">n</script></span> mặt sấp sẽ tăng lên nếu ta đang ở điểm tới hạn có chi phí thấp. Nó cũng có nghĩa là các điểm cực tiểu cục bộ nhiều khả năng sẽ có chi phí thấp thay vì chi phí cao. Các điểm tới hạn có chi phí cao nhiều khả năng là điểm yên ngựa. Các điểm tới hạn có chi phí cực cao nhiều khả năng là điểm cực đại cục bộ.</p><p>Điều này xảy ra đối với nhiều lớp hàm ngẫu nhiên. Nhưng liệu nó có xảy ra đối với mạng neuron hay không? Baldi và Hornik (1989) đã chứng minh rằng <em>bộ tự mã hóa nông</em> (shallow autoencoders) (mạng lan truyền thuận được huấn luyện để sao chép đầu vào tới đầu ra, được mô tả trong Chương 14) không chứa các hàm phi tuyến có các cực tiểu toàn cục và điểm yên ngựa nhưng không có các cực tiểu cục bộ mà có chi phí cao hơn cực tiểu toàn cục. Họ quan sát (mà không chứng minh) thấy rằng những kết quả trên có thể mở rộng cho cả các mạng nhiều tầng hơn mà không chứa các hàm phi tuyến. Đầu ra của các mạng nói trên là một hàm tuyến tính của đầu vào của chúng, tuy nhiên chúng cũng đóng vai trò hữu dụng để nghiên cứu các mạng neuron phi tuyến bởi vì hàm mất mát ở đây là một hàm không lồi đôi với các tham số của chúng. Các mạng này về cơ bản chỉ là nhiều ma trận kết nối lại với nhau. Saxe và cộng sự (2013) cung cấp lời giải chính xác cho quá trình học hoàn chỉnh của các mạng nói trên và cho thấy rằng việc học trong những mô hình này nắm bắt được phần nhiều những đặc trưng định tính quan sát được trong quá trình huấn luyện mô hình đa tầng chứa các hàm kích hoạt phi tuyến. Dauphin và cộng sự (2014) cho thấy, thông qua thực nghiệm, rằng các mạng neuron thực sự cũng có các hàm mất mát chứa nhiều điểm yên ngựa với chi phí cao. Choromanska và cộng sự (2014) cung cấp thêm một số biện luận về mặt lý thuyết, cho thấy rằng một lớp khác của các hàm ngẫu nhiên số chiều cao liên quan đến mạng neuron cũng có tính chất nói trên.</p><p>Như vậy, sự gia tăng số lượng điểm yên ngựa có ý nghĩa gì đối với các thuật toán huấn luyện? Đối với các kĩ thuật tối ưu cấp một, gồm các thuật toán chỉ sử dụng thông tin về gradient, thì tình trạng này không có ý nghĩa rõ ràng. Gradient có thể trở nên rất nhỏ gần điểm yên ngựa. Mặc khác, trượt gradient trong thực nghiệm dường như có khả năng thoát khỏi điểm yên ngựa trong nhiều trường hợp. Goodfellow và cộng sự (2015) cung cấp những biểu đồ hiển thị quỹ đạo học của các mạng neuron hiện đại, với một ví dụ được cho trong hình 8.2. Những hình ảnh hiển thị này cho thấy tính bằng phẳng của hàm chi phí gần một điểm yên ngựa nổi trội, mà tại đó toàn bộ các trọng số bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mn" id="MJXp-Span-897">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1097"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1098"><span class="mn" id="MathJax-Span-1099" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">0</script></span>, nhưng chúng cũng cho thấy quỹ đạo trượt gradient thoát khỏi vùng này một cách nhanh chóng. Goodfellow và cộng sự (2015) cũng chỉ ra rằng trượt gradient liên tục theo thời gian, về mặt giải tích, bị đẩy ra, thay vì bị hút vào, một điểm yên ngựa gần đó, nhưng tình hình có thể khác đi đối với các tình huống thực tế hơn sử dụng trượt gradient.</p><p><img src="https://i.imgur.com/yADUhML.png" alt=""></p><blockquote>
<p>Hình 8.2: Hình ảnh mô tả hàm chi phí của một mạng neuron. Những hình ảnh này có vẻ tương đồng đối với các mạng neuron lan truyền thuận, mạng tích chập và mạng truy hồi áp dụng trong các bài toán nhận diện vật thể thực tế và xử lý ngôn ngữ tự nhiên. Đáng ngạc nhiên, những hình ảnh này thông thường không cho thấy sự hiện diện của nhiều trở ngại rõ ràng. Trước khi chứng kiến sự thành công của trượt gradient ngẫu nhiên trong việc huấn luyện các mô hình rất lớn, bắt đầu vào khoảng năm 2012, bề mặt hàm chi phí của mạng neuron thường được cho là là có nhiều cấu trúc không lồi hơn những gì thấy được từ các hình chiếu này. Trở ngại chính được cho thấy trong hình chiếu này là một điểm yên ngựa có chi phí cao nằm gần nơi các tham số được khởi tạo, tuy nhiên, như được chỉ ra trong đường màu xanh, quỹ đạo của trượt gradient ngẫu nhiên trong quá trình huấn luyện thoát khỏi điểm yên ngựa này một cách dễ dàng. Hầu hết thời gian huấn luyện xảy ra trong quá trình đi ngang qua vùng thung lũng tương đối bằng phẳng của hàm chi phí, có lẽ bởi sự nhiễu loạn cao trong gradient, tính kém điều hoà của ma trận Hesse trong vùng này, hoặc đơn giản chỉ là vì cần phải đi vòng quanh vùng “núi” cao hiển hiện trong hình này qua một đường vòng cung gián tiếp. Hình ảnh này được điều chỉnh có sự cho phép của Goodfellow và cộng sự (2015).</p>
</blockquote><p>Đối với phương pháp Newton, các điểm yên ngựa rõ ràng gây nên một vấn đề. Trượt gradient được thiết kế để di chuyển “xuống đồi” và không được thiết kế để tìm một điểm tới hạn. Tuy nhiên, phương pháp Newton được thiết kế để tìm kiếm một điểm mà gradient bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-898"><span class="MJXp-mn" id="MJXp-Span-899">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1100"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1101"><span class="mn" id="MathJax-Span-1102" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">0</script></span>. Nếu không được điều chỉnh phù hợp, nó có thể nhảy tới điểm yên ngựa. Sự bùng nổ của điểm yên ngựa trong không gian số chiều cao được cho là có thể giải thích lí do các phương pháp đạo hàm bậc hai đã không thành công trong việc thay thế phương pháp trượt gradient trong huấn luyện mạng neuron. Dauphin và cộng sự (2014) đã giới thiệu <em>phương pháp Newton thoát điểm yên ngựa</em> (saddle-free Newton method) cho các phương pháp tối ưu bậc hai và đã cho thấy rằng nó cải tiến đáng kể so với phiên bản truyền thống. Các phương pháp đạo hàm bậc hai vẫn còn nhiều khó khăn để có thể để mở rộng cho mạng neuron lớn, tuy nhiên cách tiếp cận bằng phương pháp Newton thoát điểm yên ngựa này khá hứa hẹn nếu nó có thể mở rộng cho các mạng lớn được.</p><p>Bên cạnh các điểm cực tiểu và các điểm yên ngựa, tồn tại một số loại điểm khác có gradient bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mn" id="MJXp-Span-901">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1103"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1104"><span class="mn" id="MathJax-Span-1105" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">0</script></span>. Điểm cực đại khá giống điểm yên ngựa nhìn từ khía cạnh tối ưu – nhiều thuật toán không bị thu hút bởi chúng, nhưng phương pháp Newton chưa cải tiến thì có. Điểm cực đại của nhiều lớp hàm ngẫu nhiên trở nên rất hiếm gặp trong không gian đa chiều, giống như điểm cực tiểu vậy.</p><p>Cũng có thể tồn tại những vùng rộng và bằng phẳng có giá trị không đổi. Ở những vị trí này, toàn bộ gradient và ma trận Hesse đều bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mn" id="MJXp-Span-903">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1106"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1107"><span class="mn" id="MathJax-Span-1108" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">0</script></span>. Các vị trí suy biến như vậy gây ra những vấn đề chính cho các thuật toán tối ưu số. Trong một bài toán tối ưu lồi, một vùng rộng và bằng phẳng phải bao gồm toàn bộ các điểm cực tiểu toàn cục, nhưng trong một bài toán tối ưu hoá nói chung, một vùng như vậy có thể tương ứng với một giá trị lớn của hàm mục tiêu.</p><h2 id="824-Vách-đứng-và-bùng-nổ-gradient">8.2.4 Vách đứng và bùng nổ gradient</h2><p>Các mạng neuron đa tầng thường có các vùng cực dốc giống như những vách đá dựng đứng, như mô tả trong hình 8.3. Đây là kết quả của phép nhân của nhiều tham số lớn với nhau. Trên bề mặt của một cấu trúc vách đá cực dốc, mỗi bước cập nhật gradient có thể di chuyển các tham số ra rất xa, thường ra  hoàn toàn khỏi cấu trúc vách đứng.</p><p><img src="https://i.imgur.com/taHHITX.png" alt=""></p><blockquote>
<p>Hình 8.3: Hàm mục tiêu cho các mạng neuron phi tuyến đa tầng hoặc cho các mạng neuron truy hồi thông thường chứa các phi tuyến nhọn trong không gian tham số do kết quả của phép nhân nhiều tham số với nhau. Các phi tuyến tính này làm phát sinh các giá trị đạo hàm rất cao tại một số nơi. Khi các tham số đến gần một vùng dựng đứng như vậy, một bước cập nhật của phép trượt gradient có thể “phóng” các giá trị tham số đi rất xa, và làm mất hầu hết các thành quả tối ưu đã đạt được trước đó. Hình ảnh được cung cấp có sự cho phép của Pascanu và cộng sự (2013).</p>
</blockquote><p>Vách đứng có thể rất nguy hiểm trong trường hợp chúng ta tiếp cận nó, cả từ phía trên lẫn phía dưới. Tuy nhiên thật may là chúng ta có thể tránh được những hậu quả nghiêm trọng nhất của nó, sử dụng kỹ thuật <em>xén gradient cảm tính</em> (gradient clipping heuristic) được mô tả trong mục 10.11.1. Ý tưởng cơ bản là, gradient không chỉ ra kích thước bước trượt tối ưu, mà nó chỉ chỉ ra hướng trượt tối ưu trong một không gian vô hạn. Trong khi thuật toán trượt gradient cổ điển đề xuất sử dụng một bước trượt rất lớn, thì xén gradient cảm tính can thiệp để giảm nhỏ bước trượt, từ đó giảm khả năng thuật toán nhảy ra khỏi vùng gradient sâu nhất. Cấu trúc vách đá rất thường xuyên xuất hiện ở trong các hàm chi phí của các mạng neuron truy hồi, bởi lẽ những mô hình này sử dụng hàm nhân của nhiều hạng tử, với mỗi hạng tử ứng với một bước thời gian. Và khi thực hiện nhân trên một chuỗi thời gian rất dài thì kết quả thường bị đội lên rất cao.<br>
---- Minh Quang kết thúc dịch từ đây (trang 285) —</p><p>---- Minh Tuấn bắt đầu dịch từ đây ------</p><h2 id="825-Phụ-thuộc-dài-hạn">8.2.5 Phụ thuộc dài hạn</h2><p>Một thử thách khác mà các thuật toán tối ưu phải vượt qua, phát sinh khi các đồ thị tính toán trở nên rất sâu. Các mạng lan truyền thuận nhiều tầng có những đồ thị tính toán sâu như vậy. Điều tương tự cũng xảy ra với những mạng truy hồi, sẽ được mô tả trong chương 10, xây dựng một đồ thị tính toán rất sâu bằng cách áp dụng cùng một thao tác cho mỗi đơn vị thời gian trong một khoảng thời gian dài. Việc áp dụng các tham số giống nhau lặp đi lặp lại gây ra những khó khăn đặc biệt rõ rệt.</p><p>Chẳng hạn, giả sử có một đồ thị tính toán chứa một đường đi trên đó ta lặp lại phép nhân với ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-905">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1109"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">\boldsymbol W</script></span> nhiều lần. Sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">t</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1112"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1113"><span class="mi" id="MathJax-Span-1114" style="font-family: MathJax_Math-italic;">t</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">t</script></span> bước, điều này tương đương với việc nhân với ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-msubsup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-911" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">t</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1115"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1116"><span class="msubsup" id="MathJax-Span-1117"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.19em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.296em;"><span class="texatom" id="MathJax-Span-1119"><span class="mrow" id="MathJax-Span-1120"><span class="mi" id="MathJax-Span-1121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">\boldsymbol{W}^{t}</script></span>. Giả sử <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-914">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1122"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1123"><span class="mi" id="MathJax-Span-1124" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">\boldsymbol W</script></span> có một phân tích riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-916">W</span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-918">V</span><span class="MJXp-mtext" id="MJXp-Span-919">diag</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-921">λ</span><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-923"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-924" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-925" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-926">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">t</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1125"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1126"><span class="mi" id="MathJax-Span-1127" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1128" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1129" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1130" style="font-family: MathJax_Main;">diag</span><span class="mo" id="MathJax-Span-1131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1132" style="font-family: MathJax_Math-bold-italic;">λ</span><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1134"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1135" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.026em;"><span class="texatom" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="mo" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">\boldsymbol W = \boldsymbol V\text{diag}(\boldsymbol \lambda)\boldsymbol V^{-t}</script></span> . Trong trường hợp đơn giản này, dễ thấy<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-928"><span class="MJXp-mtable" id="MJXp-Span-929"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-930" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-931" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">W</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-936"><span class="MJXp-mrow" id="MJXp-Span-937" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-939">V</span><span class="MJXp-mtext" id="MJXp-Span-940">diag</span><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-942">λ</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-944"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-945" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-946" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-947">−</span><span class="MJXp-mn" id="MJXp-Span-948">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-950" style="vertical-align: 0.82em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-952">V</span><span class="MJXp-mtext" id="MJXp-Span-953">diag</span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-955">λ</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-958" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">t</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-962" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-963">−</span><span class="MJXp-mn" id="MJXp-Span-964">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1140"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1141"><span class="mtable" id="MathJax-Span-1142" style="min-width: 25.11em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.11em;"><span style="display: inline-block; position: absolute; width: 18.429em; height: 0px; clip: rect(-1.129em, 1018.32em, 0.595em, -999.997em); top: 0em; left: 50%; margin-left: -9.211em;"><span style="position: absolute; clip: rect(2.858em, 1018.32em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 18.429em; height: 0px;"><span style="position: absolute; clip: rect(2.751em, 1018.32em, 4.475em, -999.997em); top: -3.877em; left: 50%; margin-left: -9.211em;"><span class="mtd" id="MathJax-Span-1146"><span class="mrow" id="MathJax-Span-1147"><span class="msubsup" id="MathJax-Span-1148"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.19em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1149" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.296em;"><span class="mi" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1151" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-1152" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 7.384em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1006.9em, 4.475em, -999.997em); top: -3.984em; left: 0em;"><span class="mrow" id="MathJax-Span-1153"><span class="mo" id="MathJax-Span-1154" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="mi" id="MathJax-Span-1155" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1156" style="font-family: MathJax_Main;">diag</span><span class="mo" id="MathJax-Span-1157" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1158" style="font-family: MathJax_Math-bold-italic;">λ</span><span class="mo" id="MathJax-Span-1159" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1160"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.026em;"><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="mo" id="MathJax-Span-1164" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1165" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1166" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 7.061em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1168" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1169" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1170" style="font-family: MathJax_Main;">diag</span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1172" style="font-family: MathJax_Math-bold-italic;">λ</span><span class="msubsup" id="MathJax-Span-1173"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1174" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="texatom" id="MathJax-Span-1175"><span class="mrow" id="MathJax-Span-1176"><span class="mi" id="MathJax-Span-1177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1178"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math-bold-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 1.026em;"><span class="texatom" id="MathJax-Span-1180"><span class="mrow" id="MathJax-Span-1181"><span class="mo" id="MathJax-Span-1182" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1184" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.805em, 1002.48em, 0.541em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.877em; right: 0em;"><span class="mtd" id="mjx-eqn-8.11"><span class="mrow" id="MathJax-Span-1144"><span class="mtext" id="MathJax-Span-1145" style="font-family: MathJax_Main;">(8.11)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-122">\boldsymbol W^t = \left(\boldsymbol V\text{diag}(\boldsymbol \lambda)\boldsymbol V^{-1}\right)^t = \boldsymbol V\text{diag}(\boldsymbol \lambda)^{t}\boldsymbol V^{-1}. \tag{8.11}</script></span></p><p>Bất kỳ trị riêng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-msubsup" id="MJXp-Span-967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-969" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1185"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1186"><span class="msubsup" id="MathJax-Span-1187"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">\lambda_i</script></span> nào không gần với giá trị tuyệt đối của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-970"><span class="MJXp-mn" id="MJXp-Span-971">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1190"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1191"><span class="mn" id="MathJax-Span-1192" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">1</script></span> sẽ biến mất nếu độ lớn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-972"><span class="MJXp-msubsup" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-975" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1193"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1194"><span class="msubsup" id="MathJax-Span-1195"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1196" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">\lambda_i</script></span> nhỏ hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mn" id="MJXp-Span-977">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1199"><span class="mn" id="MathJax-Span-1200" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">1</script></span> hoặc sẽ tăng đột biến nếu độ lớn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-978"><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;">λ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1201"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1202"><span class="msubsup" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">\lambda_i</script></span> lớn hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mn" id="MJXp-Span-983">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1206"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1207"><span class="mn" id="MathJax-Span-1208" style="font-family: MathJax_Main;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">1</script></span>. Vấn đề tiêu biến gradient và bùng nổ gradient ý nói tới hiện tượng gradient khi đi qua một đồ thị tính toán cũng sẽ bị nhân tỉ lệ với diag<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">λ</span><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-989" style="vertical-align: 0.5em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-129-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1209"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1210"><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math-italic;">λ</span><span class="msubsup" id="MathJax-Span-1213"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1214" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.38em;"><span class="mi" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">(\lambda)^t</script></span>. Tiêu biến gradient sẽ khiến việc tìm ra hướng cập nhật các tham số để cực tiểu hóa hàm chi phí trở nên khó khăn, trong khi đó việc bùng nổ các gradient có thể khiến cho quá trình học trở nên không ổn định. Những cấu trúc vách đứng được mô tả ở trên khi ta nói đến kĩ thuật siết gradient là một ví dụ của hiện tượng bùng nổ gradient.</p><p>Phép nhân lặp lại nhiều lần với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-990"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-991">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-130-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1216"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1217"><span class="mi" id="MathJax-Span-1218" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">\boldsymbol W</script></span> tại mỗi bước được mô tả ở đây rất giống với thuật toán thuộc họ <em>phương pháp luỹ thừa</em> (power method) được sử dụng để tìm trị riêng lớn nhất của một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-992"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-993">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-131-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1219"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1220"><span class="mi" id="MathJax-Span-1221" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">\boldsymbol W</script></span> và vector riêng tương ứng. Theo quan điểm này, sẽ không ngạc nhiên khi cuối cùng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-994"><span class="MJXp-msubsup" id="MJXp-Span-995"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-996" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-997" style="vertical-align: 0.5em;">⊺</span></span><span class="MJXp-msubsup" id="MJXp-Span-998"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-999" style="margin-right: 0.05em;">W</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1000" style="vertical-align: 0.5em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-132-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1222"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1223"><span class="msubsup" id="MathJax-Span-1224"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="mo" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: MathJax_AMS;">⊺</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1227"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.19em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1228" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 1.296em;"><span class="mi" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">\boldsymbol x^\intercal\boldsymbol W^t</script></span> sẽ loại bỏ toàn bộ những thành phần của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1002">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-133-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1230"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1231"><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math-bold-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">\boldsymbol x</script></span>  trực giao với vector riêng chính của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1004">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-134-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1233"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1234"><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math-bold-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-134">\boldsymbol W</script></span>.</p><p>Các mạng truy hồi sử dụng cùng một ma trận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">W</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-135-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1236"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-135">W</script></span> tại mỗi bước, nhưng các mạng lan truyền thuận thì không, do đó ngay cả các mạng lan truyền thuận có số tầng rất lớn cũng có thể tránh được vấn đề tiêu biến và bùng nổ gradient (Sussillo, 2014).</p><p>Chúng tôi sẽ hoãn lại việc thảo luận về các thách thức trong huấn luyện các mạng truy hồi cho đến phần 10.7, sau khi các mạng truy hồi được mô tả chi tiết hơn ở những phần sau.</p><h2 id="826-Gradient-không-chính-xác">8.2.6 Gradient không chính xác</h2><p>Hầu hết các thuật toán được thiết kế với giả định rằng chúng ta tính được chính xác gradient và ma trận Hesse. Nhưng thực tế là ta thường chỉ có các ước lượng có nhiễu hoặc bị chệch của những đại lượng này. Hầu hết các thuật toán học sâu phụ thuộc vào cách ước lượng theo lấy mẫu, sử dụng một lô nhỏ của dữ liệu huấn luyện để tính gradient.</p><p>Trong các trường hợp khác, hàm mục tiêu cần được cực tiểu hóa thường có chi phí tính toán lớn. Khi đó gradient của nó cũng thường sẽ có chi phí tính toán lớn. Đối với những hàm mục tiêu như vậy ta chỉ có thể tính gradient một cách xấp xỉ. Những vấn đề này hầu hết nảy sinh trong các mô hình nâng cao được đề cập trong phần III. Ví dụ, kĩ thuật phân kỳ tương phản (contrastive divergence) cho ta xấp xỉ gradient của logarit hàm hợp lý trong một máy Boltzmann.</p><p>Nhiều thuật toán tối ưu mạng neuron được thiết kế để tính tới sự không hoàn chỉnh của các phép đánh giá gradient. Vấn đề này có thể tránh bằng cách chọn một hàm mất mát thay thế dễ xấp xỉ hơn hàm mất mát thực sự.</p><h2 id="827-Sự-liên-đới-yếu-giữa-cấu-trúc-cục-bộ-và-cấu-trúc-toàn-cục">8.2.7 Sự liên đới yếu giữa cấu trúc cục bộ và cấu trúc toàn cục</h2><p>Cho tới phần này, nhiều vấn đề chúng tôi đã thảo luận tương ứng với các tính chất của hàm mất mát tại một điểm – khó tạo một bước nhảy nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">J</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1010">θ</span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-136-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1239"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">J(\boldsymbol{\theta})</script></span> kém điều hoà (poorly conditioned) tại điểm hiện tại <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1013">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-137-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1245"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-137">\boldsymbol \theta</script></span>, hoặc nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1014"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1015">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-138-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-138">\boldsymbol \theta</script></span> nằm tại một dốc đứng, hoặc nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1017">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-139-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1251"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">\boldsymbol \theta</script></span> là một điểm yên ngựa khiến việc trượt gradient khó có khả năng xảy ra.</p><p>Có thể khắc phục tất cả các vấn đề này tại một điểm nhưng vẫn tạo ra kết quả nghèo nàn nếu hướng cải thiện trong một lân cận không phải là hướng đi tới vùng ở xa có giá trị hàm chi phí thấp hơn nhiều.</p><p>Goodfellow và cộng sự (2015) cho rằng phần lớn thời gian huấn luyện là do độ dài của quỹ đạo đi tới nghiệm. Hình 8.2 chỉ ra rằng quỹ đạo học dùng phần lớn thời gian để đi theo một vòng cung rộng quanh vùng có dạng đỉnh núi.</p><p>Nhiều nghiên cứu về các vấn đề phức tạp trong tối ưu hóa tập trung vào việc quá trình huấn luyện kết thúc ở một cực tiểu toàn cục, cực tiểu cục bộ hoặc điểm yên ngựa, nhưng trên thực tế, mạng neuron thường không đi tới các điểm tới hạn ở bất kỳ dạng nào. Hình 8.1 chỉ ra rằng mạng neuron thường không tiến tới vùng có gradient nhỏ. Đôi khi, một hàm chi phí không có điểm tới hạn nào. Ví dụ, hàm mất mát <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1018"><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi" id="MJXp-Span-1020">log</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">p</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">y</span><span class="MJXp-mrow" id="MJXp-Span-1025"><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1027">x</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1029">θ</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-140-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1254"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1255"><span class="mo" id="MathJax-Span-1256" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Main; padding-left: 0.164em;">log</span><span class="mo" id="MathJax-Span-1258"></span><span class="mi" id="MathJax-Span-1259" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"><span class="mo" id="MathJax-Span-1264" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1265" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1266" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-1268" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-140">-\log p(y | \boldsymbol{x}; \boldsymbol{\theta})</script></span> không có điểm tối ưu toàn cục và chỉ tiệm cận tới một điểm mà tại đó mô hình trở nên tự tin hơn. Với một bộ phân lớp với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-141-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1269"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1270"><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-141">y</script></span> rời rạc và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">p</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">y</span><span class="MJXp-mrow" id="MJXp-Span-1037"><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1039">x</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-142-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1272"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1277"><span class="mrow" id="MathJax-Span-1278"><span class="mo" id="MathJax-Span-1279" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-142">p(y | \boldsymbol{x})</script></span> được cho bởi một softmax, số đối của logarit hàm hợp lý có thể trở nên nhỏ tùy ý nếu mô hình có thể phân lớp chính xác mọi điểm dữ liệu huấn luyện, nhưng không thể thực sự bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1041"><span class="MJXp-mn" id="MJXp-Span-1042">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-143-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1282"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1283"><span class="mn" id="MathJax-Span-1284" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-143">0</script></span>. Tương tự, một mô hình với giá trị thực <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">p</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">y</span><span class="MJXp-mrow" id="MJXp-Span-1047"><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1049">x</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1053">N</span></span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">y</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">f</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1059">θ</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063" style="margin-right: 0.05em;">β</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1064" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1065">−</span><span class="MJXp-mn" id="MJXp-Span-1066">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-144-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1286"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1290"><span class="mrow" id="MathJax-Span-1291"><span class="mo" id="MathJax-Span-1292" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1295" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-1296" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.164em;"></span></span></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1300" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1301" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1302" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1303" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1304" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1307" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.6em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1308" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1309"><span class="mrow" id="MathJax-Span-1310"><span class="mo" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1313" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-144">p(y | \boldsymbol{x}) = \mathcal{N}(y; f(\boldsymbol{\theta}), \beta^{-1})</script></span> có số đối của logarit hàm hợp lý tiệm cận tới âm vô vùng – nếu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">f</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1071">θ</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-145-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1314"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1315"><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1317" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1318" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1319" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">f(\boldsymbol{\theta})</script></span> có thể dự đoán chính xác giá trị của tất cả các đầu ra huấn luyện <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-146-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1320"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1321"><span class="mi" id="MathJax-Span-1322" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">y</script></span>, thuật toán học sẽ làm tăng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">β</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-147-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1323"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1324"><span class="mi" id="MathJax-Span-1325" style="font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-147">\beta</script></span>  lên vô hạn. Hình 8.4 cho ta một ví dụ về sự thất bại của tối ưu cục bộ trong việc tìm một giá trị hàm chi phí tốt ngay cả khi không có cực tiểu cục bộ hoặc điểm yên ngựa.</p><p><img src="https://i.imgur.com/JQsJsPT.png" alt=""></p><blockquote>
<p>Hình 8.4: Tối ưu hóa dựa trên xuống dốc cục bộ có thể thất bại nếu hướng dốc cục bộ chỉ về phía cực tiểu toàn cục. Ở đây chúng tôi đưa ra một ví dụ cho thấy điều này ra ngay cả khi không tồn tại điểm cực tiểu cục bộ hay điểm yên ngựa.  Trong ví dụ này, hàm chi phí chỉ chứa các điểm tiệm cận tới các gía trị thấp chứ không phải là một cực tiểu. Nguyên nhân chính của sự phức tạp trong trường hợp này là việc điểm khởi tạo nằm ‘sai sườn núi’ và không thể vượt qua được sườn núi đó. Trong không gian nhiều chiều, thuật toán học tập có thể thoát khỏi các sườn núi này, nhưng đường đi của nghiệm có thể rất dài, kéo theo thời gian huấn luyện dài như được mô tả trong hình 8.2.</p>
</blockquote><p>Các nghiên cứu tương lai cần phát triển hơn nữa sự hiểu biết về các nhân tố ảnh hưởng tới độ dài của quỹ đạo học và mô tả tốt hơn đầu ra của cả quá trình.</p><p>Nhiều hướng nghiên cứu hiện nay nhằm tìm các điểm khởi tạo tốt cho các bài toán với cấu trúc toàn cục phức tạp, thay vì phát triển các thuật toán sử dụng các bước di chuyển không cục bộ (nonlocal move).</p><p>Trượt gradient và gần như toàn bộ các thuật toán học tập được sử dụng trong việc huấn luyện mạng neuron một cách hiệu quả đều dựa trên việc tạo ra các di chuyển nhỏ cục bộ. Những phần trước chủ yếu tập trung vào việc tìm hiểu về hướng di chuyển chính xác của các di chuyển nhỏ cục bộ này khó tính toán như thế nào. Chúng ta có thể tính toán một vài tính chất của hàm mục tiêu, như gradient, chỉ cần xấp xỉ, với độ chệch hoặc phương sai trong đánh giá hướng di chuyển nghiệm đúng. Trong những trường hợp này, trượt cục bộ có thể (hoặc không thể) xác định một đường đi đủ ngắn tới một nghiệm chấp nhận được, nhưng chúng ta thực ra không thể đi theo hướng cục bộ đó. Hàm mục tiêu có thể có nhiều vấn đề như kém điều hoà hoặc gradient không liên tục, gây ra các vùng rất nhỏ mà tại đó gradient tạo ra mô hình tốt. Trong những trường hợp này, trượt cục bộ với bước nhảy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-148-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1326"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1327"><span class="mi" id="MathJax-Span-1328" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">\epsilon</script></span> có thể tạo ra một đường đi đủ ngắn tới nghiệm, nhưng chúng ta chỉ có thể tính toán hướng trượt cục bộ với bước nhảy <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">δ</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0.333em; margin-right: 0.333em;">≪</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-149-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1329"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1330"><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1332" style="font-family: MathJax_Main; padding-left: 0.272em;">≪</span><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-149">\delta \ll \epsilon</script></span>. Trong những trường hợp này, trượt cục bộ có thể xác định một đường đi tới nghiệm, nhưng đường đi này bao gồm rất nhiều bước, gây ra chi phí tính toán cao. Đôi khi thông tin cục bộ không mang nhiều thông tin hữu ích, chẳng hạn khi hàm chi phí có một khoảng rộng bằng phẳng, hoặc nếu chúng ta  dừng lại đúng ở một điểm tới hạn (trường hợp này thường chỉ xảy ra với các phương pháp trực tiếp tìm điểm tới hạn như phương pháp Newton). Trong những trường hợp này, trượt cục bộ hoàn toàn không tạo ra một đường đi tới nghiệm. Trong các trường hợp khác, bước nhảy cục bộ có thể quá lớn dẫn tới việc xuống dốc nhưng không hướng về phía bất kì lời giải nào, như trong hình 8.4, hoặc theo một đường đi dài không cần thiết tới nghiệm, như trong hình 8.2. Hiện tại, chúng ta không hiểu vấn đề nào liên quan nhất đến khó khăn trong tối ưu hóa mạng neuron. Nhiều nghiên cứu đang tập trung giải quyết vấn đề này.</p><p>Bất chấp vấn đề nào trên đây là nghiêm trọng nhất, tất cả có thể tránh được nếu tồn tại một vùng không gian kết nối trực tiếp tới nghiệm bởi một đường đi mà trượt cục bộ có thể bám theo, và nếu chúng ta có thể khởi tạo điểm ban đầu bên trong một vùng ổn định.  Điểm cuối cùng này gợi ý cho chúng ta nghiên cứu việc chọn điểm khởi tạo tốt cho các thuật toán tối ưu hóa truyền thống.</p><h2 id="828-Giới-hạn-lý-thuyết-của-tối-ưu">8.2.8 Giới hạn lý thuyết của tối ưu</h2><p>Nhiều kết quả lý thuyết chỉ ra rằng có những giới hạn của bất kỳ thuật toán tối ưu nào cho mạng neuron [Blum and Rivesst, 1992; Judd, 1989; Wolpert and MacReady, 1997]. Thường thì những kết quả này không ảnh hưởng tới việc sử dụng mạng neuron trên thực tế.</p><p>Một vài kết quả lý thuyết chỉ áp dụng khi các đơn vị trong mạng neuron tạo ra các giá trị rời rạc. Hầu hết các đơn vị mạng neuron tạo ra các giá trị tăng lên một cách mượt mà khiến các phương pháp tối ưu theo dò đường cục bộ khả thi. Một vài kết quả lý tuyết chỉ ra rằng tồn tại một nhóm các bài toán có chi phí tính toán lớn, nhưng rất khó để nói một bài toán cụ thể có rơi vào nhóm này hay không. Các kết quả khác chứng minh rằng việc tìm nghiệm cho một mạng neuron với kích thước nhất định là có chi phí tính toán lớn, nhưng trên thực tế chúng ta có thể tìm một nghiệm dễ dàng bằng việc sử dụng một mạng lớn hơn, ở đó nhiều tham số thiết lập tương ứng với một nghiệm chấp nhận được. Hơn nữa, khi huấn luyện mạng neuron, chúng ta không quan tâm quá nhiều vào việc tìm cực trị chính xác của một hàm số, mà tìm cách giảm giá trị của nó đủ lớn để đạt được một sai số tổng quát hóa tốt. Phân tích lý thuyết của việc liệu rằng một thuật toán tối ưu hóa có đạt được mục tiêu này không là cực kỳ phức tạp. Phát triển các giới hạn thực tế hơn của các thuật toán tối ưu bởi vậy vẫn là một mục tiêu quan trọng trong nghiên cứu học máy.</p><h1 id="83-Các-thuật-toán-cơ-bản">8.3 Các thuật toán cơ bản</h1><p>Chúng ta đã giới thiệu thuật toán trượt gradient (mục 4.3) đi ngược hướng gradient của toàn bộ tập huấn luyện. Thuật toán này có thể được tăng tốc đáng kể bằng cách sử dụng trượt gradient ngẫu nhiên để đi theo gradient của một lô ngẫu nhiên, như đã thảo luận trong mục 5.9 và mục 8.1.3.</p><h2 id="831-Trượt-gradient-ngẫu-nhiên">8.3.1. Trượt gradient ngẫu nhiên</h2><p>Trượt gradient ngẫu nhiên và các biến thể của nó được sử dụng phổ biến nhất trong học máy nói chung và học sâu nói riêng. Như đã thảo luận trong mục 8.1.3, có thể tìm được một ước lượng không chệch của gradient bằng cách lấy trung bình gradient trên một lô nhỏ <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-150-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1334"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1335"><span class="mi" id="MathJax-Span-1336" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">m</script></span> mẫu được lấy phân phối độc lập và đồng nhất từ phân phối sinh dữ liệu.</p><p>Thuật toán 8.1 chỉ ra cách đi xuống dốc theo ước lượng này của gradient.</p><p>Một tham số quan trọng của thuật toán trượt gradident ngẫu nhiên là tốc độ học. Trước đây, chúng ta đã mô tả trượt gradident ngẫu nhiên với tốc độ học cố định <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-151-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1337"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1338"><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-151">\epsilon</script></span>. Trên thực tế, việc giảm dần tốc độ học theo thời gian là cần thiết, bởi vậy ta đặt tốc độ học tại vòng lặp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-152-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1340"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-152">k</script></span> là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-msubsup" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1092" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-153-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1343"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1344"><span class="msubsup" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">\epsilon_k</script></span>.</p><p>Điều này là do bộ ước lượng gradient trong trượt gradident ngẫu nhiên tạo ra nhiễu (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-154-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1348"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1349"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-154">m</script></span> dữ liệu huấn luyện được lấy ngẫu nhiên), nhiễu này không tiêu biến thậm chí khi ta đã nằm trong cực tiểu cục bộ. Trong khi đó, gradient thực sự của toàn bộ hàm chi phí sẽ nhỏ dần và dần tới <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1095"><span class="MJXp-mn" id="MJXp-Span-1096">0</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-155-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1351"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1352"><span class="mn" id="MathJax-Span-1353" style="font-family: MathJax_Main;">0</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-155">0</script></span> khi ta tiến tới điểm cực tiểu sử dụng trượt gradient theo toàn lô (batch gradient descent), do đó trượt gradient theo toàn lô có thể sự dụng được với tốc độ học cố định. Điều kiện đủ để đảm bảo trượt gradident ngẫu nhiên hội tụ là<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1097"><span class="MJXp-mtable" id="MJXp-Span-1098"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1099" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1100" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1101"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1107" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi" id="MJXp-Span-1108">∞</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1103" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">κ</span><span class="MJXp-mo" id="MJXp-Span-1105">=</span><span class="MJXp-mn" id="MJXp-Span-1106">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;">κ</span></span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1113">∞</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1115" style="width: 2.362em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">v</span><span class="MJXp-mrow" id="MJXp-Span-1117"><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">à</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1355"><span class="mtable" id="MathJax-Span-1356" style="min-width: 14.981em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.981em;"><span style="display: inline-block; position: absolute; width: 8.3em; height: 0px; clip: rect(-1.775em, 1008.3em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -4.146em;"><span style="position: absolute; clip: rect(2.212em, 1008.3em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.3em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1008.3em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -4.146em;"><span class="mtd" id="MathJax-Span-1360"><span class="mrow" id="MathJax-Span-1361"><span class="munderover" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1363" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.907em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span class="mo" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.38em;"><span class="texatom" id="MathJax-Span-1369"><span class="mrow" id="MathJax-Span-1370"><span class="mi" id="MathJax-Span-1371" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1372" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1373" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1375" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.272em;">∞</span><span class="mo" id="MathJax-Span-1377" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-1378" style="height: 0em; vertical-align: 0em; width: 2.05em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1379" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">v</span><span class="texatom" id="MathJax-Span-1380"><span class="mrow" id="MathJax-Span-1381"><span class="mo" id="MathJax-Span-1382"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 86%; font-style: normal; font-weight: normal;">à</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.12"><span class="mrow" id="MathJax-Span-1358"><span class="mtext" id="MathJax-Span-1359" style="font-family: MathJax_Main;">(8.12)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-156"> \sum_{\kappa=1}^{\infty} \epsilon_\kappa = \infty,\hspace{1cm} và  \tag{8.12} </script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1119"><span class="MJXp-mtable" id="MJXp-Span-1120"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1121" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1122" style="text-align: center;"><span class="MJXp-munderover" id="MJXp-Span-1123"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1129" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi" id="MJXp-Span-1130">∞</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1125" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">κ</span><span class="MJXp-mo" id="MJXp-Span-1127">=</span><span class="MJXp-mn" id="MJXp-Span-1128">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1134">2</span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">κ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-1136">∞</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1383"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1384"><span class="mtable" id="MathJax-Span-1385" style="min-width: 11.802em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.802em;"><span style="display: inline-block; position: absolute; width: 5.121em; height: 0px; clip: rect(-1.775em, 1005.01em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -2.53em;"><span style="position: absolute; clip: rect(2.212em, 1005.01em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.121em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1005.01em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -2.53em;"><span class="mtd" id="MathJax-Span-1389"><span class="mrow" id="MathJax-Span-1390"><span class="munderover" id="MathJax-Span-1391"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.907em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mi" id="MathJax-Span-1395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span class="mo" id="MathJax-Span-1396" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.38em;"><span class="texatom" id="MathJax-Span-1398"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1401" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1402" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -4.308em; left: 0.434em;"><span class="mn" id="MathJax-Span-1403" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.49em, 4.151em, -999.997em); top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main; padding-left: 0.272em;">&lt;</span><span class="mi" id="MathJax-Span-1406" style="font-family: MathJax_Main; padding-left: 0.272em;">∞</span><span class="mo" id="MathJax-Span-1407" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.13"><span class="mrow" id="MathJax-Span-1387"><span class="mtext" id="MathJax-Span-1388" style="font-family: MathJax_Main;">(8.13)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-157"> \sum_{\kappa=1}^{\infty} \epsilon_\kappa^2 < \infty  \tag{8.13}.</script></span></p><p>---- Minhtuan kết thúc dịch từ đây -----------<br>
---- Minh Quang bắt đầu dịch từ đây (trang 291) ----</p><hr><p><strong>Thuật toán 8.1</strong> Cập nhật trượt gradient ngẫu nhiên (SGD)</p><hr><p><strong>Yêu cầu:</strong> Lịch trình cập nhật tốc độ học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-msubsup" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1141" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1142">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1146" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1147">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-158-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1408"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1409"><span class="msubsup" id="MathJax-Span-1410"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-1412"><span class="mrow" id="MathJax-Span-1413"><span class="mn" id="MathJax-Span-1414" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1415" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1416" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1417" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="texatom" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="mn" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1421" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-158">\epsilon_{1}, \epsilon_{2},\dots</script></span><br>
<strong>Yêu cầu:</strong> Tham số ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1151">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-159-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1423"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1424"><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-159">\boldsymbol{\theta}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mspace" id="MJXp-Span-1153" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-160-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1426"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1427"><span class="mspace" id="MathJax-Span-1428" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">κ</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mn" id="MJXp-Span-1157">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-161-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1429"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1430"><span class="mi" id="MathJax-Span-1431" style="font-family: MathJax_Math-italic;">κ</span><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mn" id="MathJax-Span-1433" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">\kappa \leftarrow 1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1158"><span class="MJXp-mspace" id="MJXp-Span-1159" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-162-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1434"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1435"><span class="mspace" id="MathJax-Span-1436" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">\quad</script></span><strong>while</strong> điều kiện dừng chưa thỏa mãn <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1160"><span class="MJXp-mspace" id="MJXp-Span-1161" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-163-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1437"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1438"><span class="mspace" id="MathJax-Span-1439" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mspace" id="MJXp-Span-1163" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-164-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1440"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1441"><span class="mspace" id="MathJax-Span-1442" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">\quad</script></span>Lấy mẫu một lô nhỏ bao gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-165-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1443"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1444"><span class="mi" id="MathJax-Span-1445" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">m</script></span> mẫu từ tập huấn luyện {<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-msubsup" id="MJXp-Span-1167"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1168" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1169" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1170">(</span><span class="MJXp-mn" id="MJXp-Span-1171">1</span><span class="MJXp-mo" id="MJXp-Span-1172">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1176"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1177" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1178" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1179">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">m</span><span class="MJXp-mo" id="MJXp-Span-1181">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-166-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1446"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1447"><span class="msubsup" id="MathJax-Span-1448"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1450"><span class="mrow" id="MathJax-Span-1451"><span class="mo" id="MathJax-Span-1452" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1453" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-1457" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-1458" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1460"><span class="mrow" id="MathJax-Span-1461"><span class="mo" id="MathJax-Span-1462" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">\boldsymbol{x}^{(1)}, \dots, \boldsymbol{x}^{(m)}</script></span>} với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1182"><span class="MJXp-mspace" id="MJXp-Span-1183" style="width: 2em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-167-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1465"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1466"><span class="mspace" id="MathJax-Span-1467" style="height: 0em; vertical-align: 0em; width: 1.996em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-167">\qquad</script></span>nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1184"><span class="MJXp-msubsup" id="MJXp-Span-1185"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1186" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1187" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1188">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">i</span><span class="MJXp-mo" id="MJXp-Span-1190">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-168-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1468"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1469"><span class="msubsup" id="MathJax-Span-1470"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1471" style="font-family: MathJax_Math-bold-italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1472"><span class="mrow" id="MathJax-Span-1473"><span class="mo" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-168">\boldsymbol{y}^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mspace" id="MJXp-Span-1192" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-169-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1477"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1478"><span class="mspace" id="MathJax-Span-1479" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-169">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1193"><span class="MJXp-mspace" id="MJXp-Span-1194" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-170-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1480"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1481"><span class="mspace" id="MathJax-Span-1482" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-170">\quad</script></span>Tính ước lượng gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-mrow" id="MJXp-Span-1196"><span class="MJXp-munderover" id="MJXp-Span-1197"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1198">g</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1201" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1202">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi" id="MJXp-Span-1205" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-1207"><span class="MJXp-mi" id="MJXp-Span-1208" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1209" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">L</span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">f</span><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1214"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1215" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1216" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1217">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">i</span><span class="MJXp-mo" id="MJXp-Span-1219">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1221">θ</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1226" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1227">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">i</span><span class="MJXp-mo" id="MJXp-Span-1229">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-171-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1483"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1484"><span class="texatom" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="munderover" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-1489" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mfrac" id="MathJax-Span-1491" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.6em, 4.151em, -999.997em); top: -3.661em; left: 50%; margin-left: -0.321em;"><span class="mi" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.76em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.757em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1494"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1495" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1497"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1498" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1501" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1503" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1504"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1506"><span class="mrow" id="MathJax-Span-1507"><span class="mo" id="MathJax-Span-1508" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1511" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1512" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-1513" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1514" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1515" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math-bold-italic;">y</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="texatom" id="MathJax-Span-1517"><span class="mrow" id="MathJax-Span-1518"><span class="mo" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1521" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1522" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-171">\hat{\boldsymbol{g}}\leftarrow \frac{1}{m}\nabla_\theta\Sigma_iL(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mspace" id="MJXp-Span-1232" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-172-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1523"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1524"><span class="mspace" id="MathJax-Span-1525" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-172">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-mspace" id="MJXp-Span-1234" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-173-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1526"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1527"><span class="mspace" id="MathJax-Span-1528" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-173">\quad</script></span> Cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1236">θ</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1238">θ</span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1242" style="vertical-align: -0.4em;">κ</span></span><span class="MJXp-mrow" id="MJXp-Span-1243"><span class="MJXp-munderover" id="MJXp-Span-1244"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1245">g</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-174-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1529"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1530"><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1532" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">θ</span><span class="mo" id="MathJax-Span-1534" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-1535" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1538"><span class="mrow" id="MathJax-Span-1539"><span class="munderover" id="MathJax-Span-1540"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1541" style="font-family: MathJax_Math-bold-italic;">g</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.38em, 3.613em, -999.997em); top: -4.038em; left: 0.057em;"><span class="mo" id="MathJax-Span-1542" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-174">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} - \epsilon_\kappa\hat{\boldsymbol{g}}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-mspace" id="MJXp-Span-1248" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-175-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1543"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1544"><span class="mspace" id="MathJax-Span-1545" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-mspace" id="MJXp-Span-1250" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-176-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1546"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1547"><span class="mspace" id="MathJax-Span-1548" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-176">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">κ</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">κ</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1256">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-177-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1549"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1550"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">κ</span><span class="mo" id="MathJax-Span-1552" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">κ</span><span class="mo" id="MathJax-Span-1554" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-1555" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-177">\kappa \leftarrow \kappa+1</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1257"><span class="MJXp-mspace" id="MJXp-Span-1258" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-178-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1556"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1557"><span class="mspace" id="MathJax-Span-1558" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-178">\quad</script></span><strong>end while</strong></p><hr><p>Trên thực tế, tốc độ học thường được giảm một cách tuyến tính đến vòng lặp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-179-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1559"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1560"><span class="mi" id="MathJax-Span-1561" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-179">\tau</script></span>:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1261"><span class="MJXp-mtable" id="MJXp-Span-1262"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1263" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1264" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-1265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1267" style="vertical-align: -0.4em;">κ</span></span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1270">1</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">α</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1276" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">α</span><span class="MJXp-msubsup" id="MJXp-Span-1279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1281" style="vertical-align: -0.4em;">τ</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1563"><span class="mtable" id="MathJax-Span-1564" style="min-width: 15.574em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.574em;"><span style="display: inline-block; position: absolute; width: 8.893em; height: 0px; clip: rect(-0.913em, 1008.89em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -4.415em;"><span style="position: absolute; clip: rect(3.128em, 1008.89em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.893em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1008.89em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -4.415em;"><span class="mtd" id="MathJax-Span-1568"><span class="mrow" id="MathJax-Span-1569"><span class="msubsup" id="MathJax-Span-1570"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1571" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1573" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-1574" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mn" id="MathJax-Span-1575" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1576" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-1577" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">α</span><span class="mo" id="MathJax-Span-1578" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1579"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mn" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1582" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-1583" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">α</span><span class="msubsup" id="MathJax-Span-1584"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1585" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.859em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-8.14"><span class="mrow" id="MathJax-Span-1566"><span class="mtext" id="MathJax-Span-1567" style="font-family: MathJax_Main;">(8.14)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-180"> \epsilon_\kappa = (1-\alpha)\epsilon_0 + \alpha\epsilon_\tau \tag{8.14} </script></span></p><p>với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">α</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1285" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">κ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">τ</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-181-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1587"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1588"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-1590" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-1591" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.213em;"><span class="mi" id="MathJax-Span-1592" style="font-size: 70.7%; font-family: MathJax_Math-italic;">κ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.38em, 4.151em, -999.997em); top: -3.661em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-1593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.54em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.541em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-181">\alpha = \frac{\kappa}{\tau}</script></span>. Sau vòng lặp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-182-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1594"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1595"><span class="mi" id="MathJax-Span-1596" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-182">\tau</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-183-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1597"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1598"><span class="mi" id="MathJax-Span-1599" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-183">\epsilon</script></span> thường được giữ là hằng số.</p><p>Tốc độ học có thể được chọn bằng cách thử sai và lặp lại, nhưng thông thường tốt nhất là chọn bằng cách theo dõi đồ thị học biểu thị giá trị của hàm mục tiêu theo thời gian. Điều này được xem như là một nghệ thuật hơn là khoa học, và hầu hết các hướng dẫn về chủ đề này thì nên được xem xét một cách cẩn trọng. Khi sử dụng điều chỉnh tốc độ học tuyến tính, các tham số để chọn là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-msubsup" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1295" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-184-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1600"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1601"><span class="msubsup" id="MathJax-Span-1602"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mn" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-184">\epsilon_0</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1296"><span class="MJXp-msubsup" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1299" style="vertical-align: -0.4em;">τ</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-185-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1605"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1606"><span class="msubsup" id="MathJax-Span-1607"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1608" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-185">\epsilon_\tau</script></span>, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-186-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1610"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1611"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-186">\tau</script></span>. Thông thường <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">τ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-187-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1613"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1614"><span class="mi" id="MathJax-Span-1615" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-187">\tau</script></span> có thể được chọn bằng số vòng lặp cần thiết để tạo ra vài trăm lượt huấn luyện. Thông thường <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1307" style="vertical-align: -0.4em;">τ</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-188-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1616"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1617"><span class="msubsup" id="MathJax-Span-1618"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1619" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mi" id="MathJax-Span-1620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-188">\epsilon_\tau</script></span> nên được chọn bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mn" id="MJXp-Span-1309">1</span><span class="MJXp-mi" id="MJXp-Span-1310">%</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-189-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1621"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1622"><span class="mn" id="MathJax-Span-1623" style="font-family: MathJax_Main;">1</span><span class="mi" id="MathJax-Span-1624" style="font-family: MathJax_Main;">%</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-189">1\%</script></span> giá trị của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1311"><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-190-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1626"><span class="msubsup" id="MathJax-Span-1627"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1628" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mn" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-190">\epsilon_0</script></span>. Câu hỏi chính là làm thế nào để chọn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1315"><span class="MJXp-msubsup" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317" style="margin-right: 0.05em;">ϵ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1318" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-191-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1630"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1631"><span class="msubsup" id="MathJax-Span-1632"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1633" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.434em;"><span class="mn" id="MathJax-Span-1634" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-191">\epsilon_0</script></span>. Nếu nó quá lớn, đồ thị học sẽ dao động dữ dội, với hàm chi phí thường tăng đột biến. Dao động vừa phải thì tốt, đặc biệt nếu huấn luyện với một hàm chi phí ngẫu nhiên (stochastic cost function), thí dụ như hàm chi phí xuất phát từ việc sử dụng cơ chế tắt ngẫu nhiên. Nếu tốc độ học quá thấp, quá trình học sẽ diễn ra vô cùng chậm, và nếu tốc độ học ban đầu quá thấp, việc học có thể bị kẹt tại giá trị chi phí cao. Thông thường, tốc độ học  tối ưu ban đầu, liên quan đến tổng thời gian huấn luyện và giá trị chi phí cuối cùng, cao hơn tốc độ học mà cho kết quả tốt nhất vào khoảng sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mn" id="MJXp-Span-1320">100</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-192-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1635"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1636"><span class="mn" id="MathJax-Span-1637" style="font-family: MathJax_Main;">100</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-192">100</script></span> vòng lặp đầu tiên. Vì vậy, thông thường tốt nhất là theo dõi một vài vòng lặp đầu tiên và sử dụng tốc độ học lớn hơn tốc độ học cho kết quả tốt nhất tại thời điểm này, nhưng cũng không nên quá lớn để tránh tạo ra sự mất ổn định nghiêm trọng.</p><p>/----- Tiep checkpoint ------/</p><p>Tính chất quan trọng nhất của trượt gradident ngẫu nhiên và các phương pháp tối uư theo lô nhỏ và hoặc dựa trên gradient trực tuyến là thời gian tính toán cho mỗi cập nhật không tăng với số lượng mẫu trong tập huấn luyện. Điều này cho phép thuật toán tối ưu có thể hội tụ ngay cả khi số lượng mẫu trong tập huấn luyện trở nên rất lớn. Đối với một tập dữ liệu đủ lớn, trượt gradident ngẫu nhiên có thể hội tụ trong một vài dung sai cố định của sai số tập kiểm thử cuối cùng trước khi nó xử lý toàn bộ tập huấn luyện.</p><p>Để nghiên cứu tốc độ hội tụ của một thuật toán tối ưu, ta thường đo lường <em>sai số quá mức</em> (excess error) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">J</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1324">θ</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">i</span><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1331" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">J</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1334">θ</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-193-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1638"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1639"><span class="mi" id="MathJax-Span-1640" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1641" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1642" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1643" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1644" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-1645" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mi" id="MathJax-Span-1646" style="font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-1647"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1651" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-193">J(\boldsymbol{\theta}) - min_\theta J(\boldsymbol{\theta})</script></span>, là giá trị của hàm chi phí hiện tại trừ đi chi phí thấp nhất có thể. Khi trượt gradident ngẫu nhiên được áp dụng cho một bài toán lồi, sai số quá mức có độ phức tạp <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">O</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1339" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1340">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-1341"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-194-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1654"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1655"><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1657" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1658"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.97em, 4.259em, -999.997em); top: -3.499em; left: 50%; margin-left: -0.482em;"><span class="msqrt" id="MathJax-Span-1660"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.984em; left: 0.595em;"><span class="mrow" id="MathJax-Span-1661"><span class="mi" id="MathJax-Span-1662" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.973em, 1000.38em, 1.296em, -999.997em); top: -1.668em; left: 0.595em;"><span style="display: inline-block; overflow: hidden; vertical-align: -0.051em; border-top: 1.3px solid; width: 0.38em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1000.6em, 4.313em, -999.997em); top: -3.984em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Main;">√</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.08em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.08em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1663" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-194">O(\frac{1}{\sqrt{k}})</script></span> sau <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">k</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-195-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1664"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1665"><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic;">k</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">k</script></span> vòng lặp, và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">O</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1349" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1350">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-196-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1667"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1668"><span class="mi" id="MathJax-Span-1669" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1670" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1671"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1672" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.607em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-1673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.49em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-196">O(\frac{1}{k})</script></span> trong trường hợp lồi mạnh (strongly convex). Các giới hạn trên là không thể cải thiện trừ khi ta bổ sung một số giả định. Theo lý thuyết, thuật toán trượt gradient theo toàn bộ lô có tốc độ hội tụ tốt hơn trượt gradient ngẫu nhiên. Tuy nhiên, cận Cramér-Rao [Cramér, 1946; Rao, 1945] nói rằng sai số tổng quát hóa không thể giảm nhanh hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">O</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1356" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1357">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-197-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1675"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1676"><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1678" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1679"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1680" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.607em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.49em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1682" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-197">O(\frac{1}{k})</script></span>. Bottou và Bousquet (2008) cho rằng vì lí do này, không đáng để ta cố gắng tìm kiếm một thuật toán tối ưu hội tụ nhanh hơn <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">O</span><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1363" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1364">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-198-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1683"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1684"><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1686" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1687"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1688" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.607em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.49em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1690" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-198">O(\frac{1}{k})</script></span> cho các tác vụ học máy - việc hội tụ nhanh có lẽ sẽ đi cùng hiện tượng quá khớp. Hơn nữa, phép phân tích tiệm cận làm lu mờ nhiều ưu điểm của trượt gradient ngẫu nhiên sau một số nhỏ các bước. Với các tập dữ liệu lớn, khả năng trượt gradident ngẫu nhiên tạo ra sự tiến triển ban đầu nhanh chóng khi tính gradient cho một lượng rất ít mẫu có lợi ích lớn hơn tính hội tụ tiệm cận chậm của nó. Hầu hết các thuật toán được mô tả trong phần còn lại của chương này đạt được những lợi ích có ý nghĩa trong thực tế nhưng bị mất một hệ số hằng do sự phân tích tiệm cận <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">O</span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-1370" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1371">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-199-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1691"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1692"><span class="mi" id="MathJax-Span-1693" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1694" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1695"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.343em, 1000.33em, 4.151em, -999.997em); top: -4.415em; left: 50%; margin-left: -0.159em;"><span class="mn" id="MathJax-Span-1696" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.151em, -999.997em); top: -3.607em; left: 50%; margin-left: -0.159em;"><span class="mi" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.49em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1698" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-199">O(\frac{1}{k})</script></span>. Ta cũng có thể cân bằng lợi ích giữa trượt gradient theo toàn bộ lô và trượt gradient ngẫu nhiên bằng cách tăng dần kích thước của lô nhỏ trong quá trình học.</p><p>Thông tin thêm về trượt gradident ngẫu nhiên, xem sách của Bottou (1998).</p><h2 id="832-Động-lượng">8.3.2 Động lượng</h2><p>Dù trượt gradient ngẫu nhiên vẫn là một chiến lược tối ưu hoá thường được sử dụng , nhưng việc sử dụng nó trong quá trình học đôi khi khá chậm. Phương pháp động lượng (momentum) [Polyak, 1964] được thiết kế để đẩy nhanh quá trình học, đặc biệt trong bề mặt có độ cong cao, gradient nhỏ nhưng ổn định, hoặc các gradient nhiễu loạn. Thuật toán động lượng tích luỹ một trung bình các bước di chuyển giảm theo cấp số nhân của các gradient trước đó và tiếp tục di chuyển theo hướng của chúng. Hiệu ứng của động lượng được mô tả trong hình 8.5.</p><p><img src="https://i.imgur.com/0VyOj0C.png" alt=""></p><blockquote>
<p>Hình 8.5: Động lượng chủ yếu nhắm vào giải quyết hai vấn đề: kém điều hoà của ma trận Hesse và phương sai trong gradient ngẫu nhiên. Ở đây, chúng tôi mô tả cách động lượng giải quyết vấn đề thứ nhất. Các đường đồng mức mô tả một hàm mất mát bậc hai với ma trận Hesse điều hòa kém. Đường màu đỏ cắt ngang các đường viền biểu thị đường đi trong quá trình học sử dụng động lượng để cực tiểu hoá hàm này. Tại mỗi bước trên đường đi, chúng tôi vẽ một mũi tên biểu thị bước trượt gradient tại điểm đó. Có thể thấy rằng giá trị một hàm mục tiêu bậc hai điều hòa kém trông giống như một thung lũng dài, hẹp hay một hẻm núi với các sườn dốc. Và động lượng đi chính xác theo đường hẻm sâu theo chiều dọc, trong khi đó các bước trượt gradient lãng phí thời gian di chuyển qua lại qua trục hẹp của hẻm núi. So sánh với hình 4.6, biểu diễn hành vi của phép trượt gradient không có động lượng.</p>
</blockquote><p>Về mặt toán học, thuật toán động lượng đưa ra một biến số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1375">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-200-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1699"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1700"><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math-bold-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">\boldsymbol v</script></span> đóng vai trò vận tốc - đó là hướng và tốc độ của các tham số khi di chuyển trong không gian tham số. Vận tốc được thiết lập thành một giá trị trung bình giảm theo cấp số nhân của gradient đối nghịch (negative gradient). Cái tên “động lượng” xuất phát từ một thuật ngữ của vật lý, trong đó gradient đối nghịch là một lực dịch chuyển một hạt qua một không gian tham số, theo các định luật chuyển động của Newton. Động lượng trong vật lý là tích của khối lượng với vận tốc. Trong thuật toán học có động lượng, ta giả định khối lượng là một đơn vị, do đó vector vận tốc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1377">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-201-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1702"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1703"><span class="mi" id="MathJax-Span-1704" style="font-family: MathJax_Math-bold-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-201">\boldsymbol v</script></span> cũng được coi như động lượng của hạt. Một siêu tham số <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">α</span><span class="MJXp-mo" id="MJXp-Span-1380" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1382">0</span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1384">1</span><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-202-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1706"><span class="mi" id="MathJax-Span-1707" style="font-family: MathJax_Math-italic;">α</span><span class="mo" id="MathJax-Span-1708" style="font-family: MathJax_Main; padding-left: 0.272em;">∈</span><span class="mo" id="MathJax-Span-1709" style="font-family: MathJax_Main; padding-left: 0.272em;">[</span><span class="mn" id="MathJax-Span-1710" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1711" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1712" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-1713" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-202">\alpha \in [0, 1)</script></span> xác định mức độ giảm theo cấp số nhân của vận tốc trước đó.</p><p>Quy tắc cập nhật như sau:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1386"><span class="MJXp-mtable" id="MJXp-Span-1387"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1388" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1389" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1390">v</span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1393">v</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-1396"><span class="MJXp-mi" id="MJXp-Span-1397" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1398" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-1400" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-1401" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1402">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">m</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1404"><span><span class="MJXp-over"><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1410" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">m</span></span></span><span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class="MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1406" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">i</span><span class="MJXp-mo" id="MJXp-Span-1408">=</span><span class="MJXp-mn" id="MJXp-Span-1409">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">L</span><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">f</span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1416"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1417" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1418" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1419">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">i</span><span class="MJXp-mo" id="MJXp-Span-1421">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1423">θ</span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1428" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1429">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">i</span><span class="MJXp-mo" id="MJXp-Span-1431">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1434" style="width: 0.167em; height: 0em;"></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1714"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1715"><span class="mtable" id="MathJax-Span-1716" style="min-width: 24.195em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 24.195em;"><span style="display: inline-block; position: absolute; width: 17.46em; height: 0px; clip: rect(-1.775em, 1017.46em, 1.296em, -999.997em); top: 0em; left: 50%; margin-left: -8.726em;"><span style="position: absolute; clip: rect(2.212em, 1017.46em, 5.283em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 17.46em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1017.46em, 5.337em, -999.997em); top: -4.038em; left: 50%; margin-left: -8.726em;"><span class="mtd" id="MathJax-Span-1720"><span class="mrow" id="MathJax-Span-1721"><span class="mi" id="MathJax-Span-1722" style="font-family: MathJax_Math-bold-italic;">v</span><span class="mo" id="MathJax-Span-1723" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mi" id="MathJax-Span-1724" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">α</span><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Math-bold-italic;">v</span><span class="mo" id="MathJax-Span-1726" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">ϵ</span><span class="msubsup" id="MathJax-Span-1728"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.205em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1729" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1731" style="font-family: MathJax_Main;">(</span><span class="mspace" id="MathJax-Span-1732" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span><span class="mfrac" id="MathJax-Span-1733"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1734" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.87em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.428em;"><span class="mi" id="MathJax-Span-1735" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.03em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.026em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1736" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0em;"><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1738"><span class="mrow" id="MathJax-Span-1739"><span class="mi" id="MathJax-Span-1740" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1741" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="texatom" id="MathJax-Span-1743"><span class="mrow" id="MathJax-Span-1744"><span class="mi" id="MathJax-Span-1745" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1746" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">L</span><span class="mo" id="MathJax-Span-1747" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1748" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1750"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1751" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1752"><span class="mrow" id="MathJax-Span-1753"><span class="mo" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1757" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1758" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">θ</span><span class="mo" id="MathJax-Span-1759" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1761" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1762" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="texatom" id="MathJax-Span-1763"><span class="mrow" id="MathJax-Span-1764"><span class="mo" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1767" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1768" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1769" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1770" style="height: 0em; vertical-align: 0em; width: 0.164em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.967em, 1002.48em, 0.326em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -4.038em; right: 0em;"><span class="mtd" id="mjx-eqn-8.15"><span class="mrow" id="MathJax-Span-1718"><span class="mtext" id="MathJax-Span-1719" style="font-family: MathJax_Main;">(8.15)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-203">\boldsymbol{v} \leftarrow \alpha \boldsymbol{v} - \epsilon\nabla_\theta ( \,\frac{1}{m}\sum_{i=1}^{m}L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}), y^{(i)})     ) \, \tag{8.15} </script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1435"><span class="MJXp-mtable" id="MJXp-Span-1436"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1437" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1438" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1439">θ</span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1441">θ</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1443">v</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1771"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1772"><span class="mtable" id="MathJax-Span-1773" style="min-width: 11.156em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.156em;"><span style="display: inline-block; position: absolute; width: 4.475em; height: 0px; clip: rect(-0.913em, 1004.42em, 0.434em, -999.997em); top: 0em; left: 50%; margin-left: -2.206em;"><span style="position: absolute; clip: rect(3.128em, 1004.42em, 4.259em, -999.997em); top: -3.984em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.475em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1004.42em, 4.259em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.206em;"><span class="mtd" id="MathJax-Span-1777"><span class="mrow" id="MathJax-Span-1778"><span class="mi" id="MathJax-Span-1779" style="font-family: MathJax_Math-bold-italic;">θ</span><span class="mo" id="MathJax-Span-1780" style="font-family: MathJax_Main; padding-left: 0.272em;">←</span><span class="mi" id="MathJax-Span-1781" style="font-family: MathJax_Math-bold-italic; padding-left: 0.272em;">θ</span><span class="mo" id="MathJax-Span-1782" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mi" id="MathJax-Span-1783" style="font-family: MathJax_Math-bold-italic; padding-left: 0.218em;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.535em; height: 0px; clip: rect(-0.859em, 1002.48em, 0.434em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.074em, 1002.48em, 4.421em, -999.997em); top: -3.984em; right: 0em;"><span class="mtd" id="mjx-eqn-8.16"><span class="mrow" id="MathJax-Span-1775"><span class="mtext" id="MathJax-Span-1776" style="font-family: MathJax_Main;">(8.16)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-204">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} + \boldsymbol{v} \tag{8.16} </script></span></p><hr><p><strong>Thuật toán 8.2</strong> Trượt gradient ngẫu nhiên với động lượng</p><hr><p><strong>Yêu cầu:</strong> <em>Tốc độ học <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">ϵ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-205-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1784"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1785"><span class="mi" id="MathJax-Span-1786" style="font-family: MathJax_Math-italic;">ϵ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-205">\epsilon</script></span></em> , tham số động lượng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">α</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-206-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1787"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1788"><span class="mi" id="MathJax-Span-1789" style="font-family: MathJax_Math-italic;">α</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-206">\alpha</script></span><br>
<strong>Yêu cầu:</strong> Tham số ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1449">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-207-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1790"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1791"><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-bold-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-207">\boldsymbol{\theta}</script></span>, vận tốc ban đầu <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1451">v</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-208-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1793"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1794"><span class="mi" id="MathJax-Span-1795" style="font-family: MathJax_Math-bold-italic;">v</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-208">\boldsymbol{v}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1452"><span class="MJXp-mspace" id="MJXp-Span-1453" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-209-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1796"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1797"><span class="mspace" id="MathJax-Span-1798" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-209">\quad</script></span><strong>while</strong> điều kiện dừng chưa thỏa mãn <strong>do</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mspace" id="MJXp-Span-1455" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-210-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1799"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1800"><span class="mspace" id="MathJax-Span-1801" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-210">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1456"><span class="MJXp-mspace" id="MJXp-Span-1457" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-211-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1802"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1803"><span class="mspace" id="MathJax-Span-1804" style="height: 0em; vertical-align: 0em; width: 1.026em; display: inline-block; overflow: hidden;"></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-211">\quad</script></span>Lấy mẫu một lô nhỏ gồm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">m</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-212-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1805"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1806"><span class="mi" id="MathJax-Span-1807" style="font-family: MathJax_Math-italic;">m</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-212">m</script></span> mẫu từ tập huấn luyện {<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-msubsup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1464">(</span><span class="MJXp-mn" id="MJXp-Span-1465">1</span><span class="MJXp-mo" id="MJXp-Span-1466">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1472" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1473">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">m</span><span class="MJXp-mo" id="MJXp-Span-1475">)</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-213-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1808"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 116%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1809"><span class="msubsup" id="MathJax-Span-1810"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1811" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1812"><span class="mrow" id="MathJax-Span-1813"><span class="mo" id="MathJax-Span-1814" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1816" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1817" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1818" style="font-family: MathJax_Main; padding-left: 0.164em;">…</span><span class="mo" id="MathJax-Span-1819" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-1820" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.888em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.649em;"><span class="texatom" id="MathJax-Span-1822"><span class="mrow" id="MathJax-Span-1823"><span class="mo" id="MathJax-Span-1824" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1826" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-213">\boldsymbol x^{(1)}, \dots,  \boldsymbol x^{(m)}</script></span>} với<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1476"><span class="MJXp-mspace" id="MJXp-Span-1477" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-214-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-214">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1478"><span class="MJXp-mspace" id="MJXp-Span-1479" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-215-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-215">\quad</script></span>nhãn tương ứng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1480"><span class="MJXp-msubsup" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1482" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1483" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1484">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">i</span><span class="MJXp-mo" id="MJXp-Span-1486">)</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-216-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-216">\boldsymbol y^{(i)}</script></span>.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mspace" id="MJXp-Span-1488" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-217-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-217">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-mspace" id="MJXp-Span-1490" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-218-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-218">\quad</script></span>Tính toán ước lượng gradient: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mrow" id="MJXp-Span-1492"><span class="MJXp-munderover" id="MJXp-Span-1493"><span><span class="MJXp-over"><span style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">g</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mfrac" id="MJXp-Span-1497" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1498">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1500"><span class="MJXp-mi" id="MJXp-Span-1501" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1502" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-1503"><span class="MJXp-mi" id="MJXp-Span-1504" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1505" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">L</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">f</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1511" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1512" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1513">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">i</span><span class="MJXp-mo" id="MJXp-Span-1515">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">θ</span><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1521" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1522" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1523">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">i</span><span class="MJXp-mo" id="MJXp-Span-1525">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-219-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-219">\hat{g}\leftarrow \frac{1}{m}\nabla_\theta\Sigma_iL(f(\boldsymbol{x}^{(i)};\theta),\boldsymbol{y}^{(i)})</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1527"><span class="MJXp-mspace" id="MJXp-Span-1528" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-220-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-220">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1529"><span class="MJXp-mspace" id="MJXp-Span-1530" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-221-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-221">\quad</script></span>Tính toán cập nhật vận tốc: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1532">v</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">α</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1535">v</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">ϵ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1538">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-222-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-222">\boldsymbol{v} \leftarrow \alpha \boldsymbol{v} - \epsilon \boldsymbol{g}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1539"><span class="MJXp-mspace" id="MJXp-Span-1540" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-223-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-223">\quad</script></span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1541"><span class="MJXp-mspace" id="MJXp-Span-1542" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-224-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-224">\quad</script></span>Cập nhật: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1544">θ</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1546">θ</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1548">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-225-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-225">\boldsymbol{\theta} \leftarrow \boldsymbol{\theta} + \boldsymbol{v}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1549"><span class="MJXp-mspace" id="MJXp-Span-1550" style="width: 1em; height: 0em;"></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-226-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-226">\quad</script></span><strong>end while</strong></p><hr><p>Vận tốc <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1552">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-227-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-227">\boldsymbol v</script></span> cộng dồn các thành phần gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi" id="MJXp-Span-1555" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-1558" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-1559" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1560">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">m</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1562"><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class="MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">m</span></span></span></span></span><span class="MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">i</span><span class="MJXp-mo" id="MJXp-Span-1566">=</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">L</span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">f</span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1576" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1577">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">i</span><span class="MJXp-mo" id="MJXp-Span-1579">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1581">θ</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1586" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1587">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">i</span><span class="MJXp-mo" id="MJXp-Span-1589">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-228-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-228">\nabla_\theta ( \,\frac{1}{m}\sum_{i=1}^{m}L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}), \boldsymbol{y}^{(i)}))</script></span>. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-229-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-229">\alpha</script></span> càng lớn so với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-230-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-230">\epsilon</script></span>, các gradient trước đó càng tác động nhiều đến hướng hiện tại. Thuật toán trượt gradident ngẫu nhiên với động lượng được mô tả cụ thể trong Thuật toán 8.2.</p><p>Trước đây, độ dài của các bước nhảy đơn giản là chuẩn của gradient nhân với tốc độ học. Với động lượng, độ dài của bước nhảy phụ thuộc vào mức độ đồng hướng của một chuỗi gradient. Kích thước của bước nhảy là lớn nhất khi nhiều gradient liên tiếp cùng chỉ theo một hướng. Nếu thuật toán động lượng luôn quan sát thấy gradient <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1597">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-231-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-231">\boldsymbol g</script></span>, thì nó sẽ tăng tốc theo hướng của gradient đối nghịch <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1598"><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1600">g</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-232-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-232">-\boldsymbol g</script></span>, cho đến khi nó đạt được vận tốc cuối cùng nơi mà độ dài của mỗi bước nhảy là:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1601"><span class="MJXp-mtable" id="MJXp-Span-1602"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1603" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1604" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1605" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">ϵ</span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1609"><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1611">g</span><span class="MJXp-mrow" id="MJXp-Span-1612"><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1614"><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1616">1</span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">α</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-233">\frac{\epsilon||\boldsymbol g||}{1-\alpha} \tag {8.17} </script></span></p><p>Do đó, ta có thể chọn tham số động lượng theo <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1619"><span class="MJXp-mfrac" id="MJXp-Span-1620" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1621">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1622">1</span><span class="MJXp-mo" id="MJXp-Span-1623">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">α</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-234-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-234">\frac{1}{1-\alpha}</script></span>. Chẳng hạn, giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">α</span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1628">0.9</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-235-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-235">\alpha = 0.9</script></span> tương ứng với việc tốc độ có thể tăng tối đa <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1629"><span class="MJXp-mn" id="MJXp-Span-1630">10</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-236-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-236">10</script></span> lần ứng với thuật toán trượt gradient.</p><p>Giá trị thường được chọn của <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-237-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-237">\alpha</script></span> trong thực tế là <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1633"><span class="MJXp-mn" id="MJXp-Span-1634">0.5</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-238-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-238">0.5</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-mn" id="MJXp-Span-1636">0.9</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-239-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-239">0.9</script></span> và <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1637"><span class="MJXp-mn" id="MJXp-Span-1638">0.99</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-240-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-240">0.99</script></span>. Giống như tốc độ học, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-241-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-241">\alpha</script></span> cũng có thể thay đổi theo thời gian. Nó thường bắt đầu với một giá trị nhỏ và sau đó tăng dần lên. Việc điều chỉnh <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">α</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-242-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-242">\alpha</script></span> theo thời gian kém quan trọng hơn việc giảm giá trị <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-243-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-243">\epsilon</script></span> theo thời gian.</p><p>Ta có thể coi thuật toán động lượng như một phép mô phỏng một hạt tuân theo quy luật động lực học của Newton trong thời gian liên tục. Thuật ngữ vật lý có thể giúp ta hiểu một cách trực quan hơn về hành vi của các thuật toán trượt gradient và động lượng.</p><p>Vị trí của hạt tại một điểm bất kì trong thời gian được cho bởi <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1645"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1646">θ</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">t</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-244-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-244">\boldsymbol{\theta}(t)</script></span>. Hạt có tổng lực bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1651">f</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">t</span><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-245-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-245">\boldsymbol f(t)</script></span>. Lực này làm cho hạt có gia tốc:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1655"><span class="MJXp-mtable" id="MJXp-Span-1656"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1657" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1658" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1659">f</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">t</span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1664" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1665"><span class="MJXp-mi" id="MJXp-Span-1666" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1667" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1668">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1671" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1672">θ</span><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">t</span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-246">\boldsymbol f(t) = \frac{\partial^2}{\partial t^2}\boldsymbol{\theta}(t) \tag{8.18} </script></span></p><p>Thay vì xem đây như là một phương trình vi phân bậc hai, ta có thể đưa ra biến <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1677">v</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">t</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-247-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-247">\boldsymbol v(t)</script></span> đại diện cho vận tốc của hạt tại thời điểm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">t</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-248-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-248">t</script></span> và viết lại phương trình động lực học Newton như là một phương trình vi phân bậc một:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1683"><span class="MJXp-mtable" id="MJXp-Span-1684"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1685" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1686" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1687">v</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">t</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1692" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1693">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1694">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">t</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1696">θ</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">t</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-249">\boldsymbol v(t) = \frac{\partial}{\partial t}\boldsymbol{\theta}(t), \tag{8.19} </script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1701"><span class="MJXp-mtable" id="MJXp-Span-1702"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1703" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1704" style="text-align: center;"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1705">f</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">t</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1710" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1711">∂</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1712">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">t</span></span></span></span></span></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1714">v</span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">t</span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-250">\boldsymbol f(t) = \frac{\partial}{\partial t}\boldsymbol{v}(t). \tag{8.20} </script></span></p><p>Thuật toán động lượng sau đó sẽ bao gồm việc giải các phương trình vi phân bằng mô phỏng số học. Một phương pháp tính toán để giải các phương trình vi phân là phương pháp Euler, bao gồm việc mô phỏng động lực học xác định bởi phương trình bằng cách di chuyển một lượng hữu hạn các bước nhỏ theo hướng của mỗi gradient.</p><p>Điều này giải thích cho dạng căn bản của cập nhật động lượng, nhưng cụ thể các lực là gì? Một lực tỷ lệ với gradient đối nghịch của hàm mất mát: <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1721"><span class="MJXp-mi" id="MJXp-Span-1722" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1723" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">J</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1726">θ</span><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-251-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-251">-\nabla_\theta J(\boldsymbol{\theta})</script></span>. Lực này đẩy hạt xuống đồi dọc theo bề mặt hàm mất mát. Thuật toán trượt gradient chỉ đơn giản là đi từng bước dựa trên từng gradient, nhưng thuật toán động lượng, dưới góc độ động lực học Newton, sử dụng lực này để thay đổi vận tốc của hạt. Ta có thể xem hạt như là một quả bóng khúc côn cầu trượt trên mặt băng. Bất cứ khi nào nó trượt xuống một phần dốc của bề mặt, nó sẽ tăng tốc và tiếp tục trượt theo hướng đó cho đến khi bắt đầu trượt đến một bề mặt cao hơn.</p><p>Có một lực khác là cần thiết. Nếu chỉ có duy nhất một lực là gradient của hàm chi phí, hạt sẽ không bao giờ ngừng lại. Tưởng tượng một quả bóng băng trượt xuống một mặt của thung lũng và đi lên mặt bên kia, lắc qua lắc lại không ngừng mãi mãi, nếu như bề mặt băng giá không có ma sát. Để giải quyết vấn đề này, ta thêm vào một lực nữa, tỷ lệ với <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1730">v</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">t</span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-252-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-252">-\boldsymbol{v}(t)</script></span>. Trong thuật ngữ vật lý, lực này tương ứng với <em>sức cản nhớt</em> (viscous drag), như thể hạt này phải di chuyển qua một môi trường cản như si-rô. Điều này khiến cho hạt dần dần mất đi năng lượng qua thời gian, và cuối cùng hội tụ tại điểm một cực tiểu cục bộ.</p><p>Tại sao chúng ta cần sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1736">v</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">t</span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-253-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-253">-\boldsymbol{v}(t)</script></span> và sức cản nhớt? Một phần của lý do của việc sử dụng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-1742">v</span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">t</span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-254-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-254">-\boldsymbol{v}(t)</script></span> là sự tiện lợi về mặt toán học – làm việc với một lũy thừa nguyên của vận tốc là khá dễ dàng. Tuy nhiên, các hệ thống vật lý khác cũng có các loại lực cản khác dựa trên luỹ thừa nguyên của vận tốc. Thí dụ, một hạt vận chuyển qua không khí sẽ bị một lực cản không khí, với lực tỷ lệ với bình phương của vận tốc, trong khi một hạt chuyển động dọc theo mặt đất sẽ chịu một lực cản ma sát khô, với lực là một hằng số. Ta có thể bỏ qua các lựa chọn này. Lực cản không khí tỷ lệ với bình phương vận tốc, trở nên rất yếu khi vận tốc nhỏ. Nó không đủ mạnh để ép các hạt vào trạng thái nghỉ ngơi. Một hạt với vận tốc ban đầu khác <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1746"><span class="MJXp-mn" id="MJXp-Span-1747">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-255-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-255">0</script></span> mà chỉ chịu lực cản không khí thì sẽ di chuyển khỏi vị trí ban đầu của nó vĩnh viễn, với khoảng cách từ điểm bắt đầu tăng theo hàm <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">O</span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1751">log</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">t</span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-256-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-256">O(\log t)</script></span>. Do đó, ta buộc phải sử dụng một vận tốc với số mũ thấp hơn. Nếu số mũ bằng <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mn" id="MJXp-Span-1756">0</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-257-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-257">0</script></span>, biểu diễn lực ma sát khô, thì lực này là quá mạnh. Khi lực gâyK ra bởi gradient của hàm chi phí là nhỏ, lực ma sát có thể khiến cho hạt dừng lại trước khi tới điểm cực tiểu cục bộ. Sức cản nhớt có thể giúp ta tránh được cả hai vấn đề trên - nó đủ yếu để gradient có thể tiếp tục chuyển động cho đến khi đạt được một cực tiểu, và đủ mạnh để ngừng chuyển động nếu gradient không di chuyển đúng hướng.</p><p>---- Minh Quang kết thúc dịch từ đây (trang 295) —<br>
------------ Hung Le -------------</p></div>